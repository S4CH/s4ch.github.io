<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>How Attackers Are Weaponizing OAuth to Silently Take Over Microsoft Outlook Accounts | CyFun</title><meta name=keywords content="oauth,microsoft,phishing,threat-analysis,incident-response"><meta name=description content="Investigation into sophisticated OAuth phishing campaigns targeting Microsoft Outlook accounts that bypass traditional security controls."><meta name=author content><link rel=canonical href=https://s4ch.github.io/research/oath-exploited-by-attackers/><link crossorigin=anonymous href=/assets/css/stylesheet.c5de734fbd88c3d21543485ffbcb1ccdda89a86a780cf987fa00199c41dbc947.css integrity="sha256-xd5zT72Iw9IVQ0hf+8sczdqJqGp4DPmH+gAZnEHbyUc=" rel="preload stylesheet" as=style><link rel=icon href=https://s4ch.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s4ch.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s4ch.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s4ch.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s4ch.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s4ch.github.io/research/oath-exploited-by-attackers/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="How Attackers Are Weaponizing OAuth to Silently Take Over Microsoft Outlook Accounts"><meta property="og:description" content="Investigation into sophisticated OAuth phishing campaigns targeting Microsoft Outlook accounts that bypass traditional security controls."><meta property="og:type" content="article"><meta property="og:url" content="https://s4ch.github.io/research/oath-exploited-by-attackers/"><meta property="article:section" content="research"><meta property="article:published_time" content="2024-11-26T06:30:05+00:00"><meta property="article:modified_time" content="2025-08-18T19:06:49+05:30"><meta name=twitter:card content="summary"><meta name=twitter:title content="How Attackers Are Weaponizing OAuth to Silently Take Over Microsoft Outlook Accounts"><meta name=twitter:description content="Investigation into sophisticated OAuth phishing campaigns targeting Microsoft Outlook accounts that bypass traditional security controls."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Research","item":"https://s4ch.github.io/research/"},{"@type":"ListItem","position":2,"name":"How Attackers Are Weaponizing OAuth to Silently Take Over Microsoft Outlook Accounts","item":"https://s4ch.github.io/research/oath-exploited-by-attackers/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"How Attackers Are Weaponizing OAuth to Silently Take Over Microsoft Outlook Accounts","name":"How Attackers Are Weaponizing OAuth to Silently Take Over Microsoft Outlook Accounts","description":"Investigation into sophisticated OAuth phishing campaigns targeting Microsoft Outlook accounts that bypass traditional security controls.","keywords":["oauth","microsoft","phishing","threat-analysis","incident-response"],"articleBody":"TL;DR Last week, while investigating some suspicious Microsoft Outlook activity for a client at iZOOlogic, I stumbled upon something that made my heart sink for a while. What started as a routine incident response engagement turned into the discovery of one of the most sophisticated OAuth phishing campaigns I‚Äôve seen in my experience so far of security research.\nHere‚Äôs the kicker - this attack doesn‚Äôt steal your password. It doesn‚Äôt care about your MFA. Instead, it tricks you into granting a malicious application complete access to your mailbox, and it does it so smoothly that most users won‚Äôt think twice before clicking ‚ÄúAccept.‚Äù\nLet me walk you through what I found.\nThe Attack Landscape: Beyond Traditional Phishing In my little years of security research, I‚Äôve watched attackers evolve from simple credential theft to something far more sophisticated. The modern attack doesn‚Äôt break down the front door anymore - it walks right in through the reception area with a visitor‚Äôs badge.\nMicrosoft 365 has become the perfect hunting ground. Why? Because it‚Äôs not just an email platform - it‚Äôs an interconnected ecosystem of productivity tools that are essentially a treasure trove of corporate intelligence.\nThe new attack methodology is brutally simple yet incredibly complex. Imagine an attack that:\nCompletely bypasses traditional security controls Maintains persistent access even after password resets Uses the platform‚Äôs own authentication mechanisms against itself Here‚Äôs how these advanced Adversary-in-the-Middle (AiTM) attacks work:\nAn attacker sends a meticulously crafted phishing email - so good it would make a social engineer weep with joy. The victim clicks a link that looks legitimate, landing on what appears to be a standard Microsoft login page. A threat actor-controlled proxy server sits in the middle, capturing every single authentication request and token. Multifactor authentication? Doesn‚Äôt matter. These proxies can forward MFA tokens in real-time. The most terrifying part? Microsoft 365‚Äôs default session token configuration gives attackers a 90-day window of opportunity. Ninety. Entire. Days. Of. Access.\nThis isn‚Äôt theoretical. This is happening right now, to organizations who think they‚Äôre protected.\nThe Attack That Keeps Me Up at Night It started with a suspicious OAuth consent screen that one of our clients‚Äô employees reported. At first glance, it looked like any other Microsoft application requesting access - clean interface, professional design, all the hallmarks of legitimacy. But something felt off.\nSource : Virustotal Scan\nI got zero detection over Virustotal which made me excited in the first place.\nDigging into the HTTP traffic, I found the initial redirect chain:\nhttp://nqvntxrfe6yx.deusgolf.com/account-lock-with-token/?em=[redacted] Now, if you‚Äôre in security, alarm bells should be ringing. That subdomain is clearly generated by DGAs. But what caught my attention was where it led.\nüí° Domain Generation Algorithms (DGAs) are sophisticated techniques used by threat actors to dynamically generate a large number of domain names. If one domain is blocked, hundreds of backup domains are ready. Generates domains algorithmically using: Time-based seeds Cryptographic hash functions Predefined generation rules Evasion advantage: Constantly rotating domains makes tracking difficult Bypasses traditional IP/domain blacklisting Reduces detection probability by security tools The attackers had set up an intricate infrastructure that leveraged Microsoft‚Äôs own OAuth endpoints. They weren‚Äôt trying to steal credentials - they were after something far more valuable: persistent mailbox access through OAuth permissions.\nDown the Rabbit Hole The more I dug, the more impressed and concerned too I became. The attack flow is brilliant in its simplicity:\nThe victim receives an urgent email about their account being locked Clicking the link takes them through a legitimate Microsoft login flow They‚Äôre presented with a consent screen requesting mailbox permissions Once granted, the attacker has persistent access - even if the victim changes their password But here‚Äôs where it gets really interesting. Looking at the OAuth permission request: { \"requested_permissions\": [ \"User.Read\", \"offline_access\", \"Mail.ReadWrite\" ] } See that offline_access scope? That‚Äôs the real danger here. It allows the attacker to obtain refresh tokens that don‚Äôt expire. Even if the victim realizes something‚Äôs wrong and changes their password, the attacker retains access until those OAuth permissions are explicitly revoked.\nFlow of the attack üí° Switch to light mode for more visibility stateDiagram-v2 [*] --\u003e VictimEmail : Receives Urgent Email note right of VictimEmail Fabricated message about account lock end note VictimEmail --\u003e MicrosoftLoginPage : Clicks Malicious Link MicrosoftLoginPage --\u003e OAuthConsentScreen : Legitimate Microsoft Login note right of OAuthConsentScreen Carefully crafted consent screen requesting mailbox permissions end note OAuthConsentScreen --\u003e AttackerAccess : User Grants Permissions note right of AttackerAccess Attacker gains: - Mail.ReadWrite access - Offline refresh tokens end note AttackerAccess --\u003e PersistentAccess : Maintains Access note right of PersistentAccess Access remains even if: - Password changed - MFA enabled end note PersistentAccess --\u003e [*] : Ongoing Mailbox Compromise The Infrastructure The attackers weren‚Äôt amateurs. Their infrastructure showed careful planning:\nThe callback domain - c.oinbase.top - is a clever piece of typosquatting. Notice the missing ‚Äòc‚Äô in what should be ‚Äòcoinbase‚Äô? In a consent screen URL, that‚Äôs easy to miss. The single-character subdomain further minimizes suspicion.\nThey also implemented sophisticated browser fingerprinting. Here‚Äôs a snippet of what they collect:\n{ \"deviceMemory\": 8, \"hardwareConcurrency\": 12, \"timezone\": \"Asia/Calcutta\", \"userAgent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36\", \"platform\": \"Win32\", \"language\": \"en-US\", \"languages\": [\"en-US\"], \"cookiesEnabled\": true, \"extensions\": \"No extensions detected\", \"screen\": { \"width\": 1920, \"height\": 1080, \"availWidth\": 1920, \"availHeight\": 1032, \"colorDepth\": 24, \"pixelDepth\": 24 }, \"window\": { \"innerWidth\": 1044, \"innerHeight\": 944, \"outerWidth\": 0, \"outerHeight\": 0 }, \"timezoneOffset\": -330, \"maxTouchPoints\": 0, \"referrer\": \"https://account.live.com/\", \"battery\": null, \"mediaDevices\": null, \"permissions\": {}, \"plugins\": [ \"PDF Viewer\", \"Chrome PDF Viewer\", \"Chromium PDF Viewer\", \"Microsoft Edge PDF Viewer\", \"WebKit built-in PDF\" ], \"mimeTypes\": [ \"application/pdf\", \"text/pdf\" ] } This isn‚Äôt just for show - it‚Äôs actively used to detect and evade security sandboxes and automated analysis tools. If the fingerprint doesn‚Äôt match their target profile, the attack simply doesn‚Äôt trigger.\nWhy This Keeps Me Awake at Night From the beginning of Jan 2024, I‚Äôve seen countless phishing campaigns. But this one‚Äôs different. Here‚Äôs why:\nIt completely bypasses MFA - because you‚Äôre logging into a legitimate Microsoft page from your regular browser. Password changes don‚Äôt help - the OAuth tokens persist It‚Äôs nearly impossible to detect with traditional security tools Most organizations aren‚Äôt monitoring for suspicious OAuth grants The worst part? This campaign is still active, and it‚Äôs evolving. We‚Äôve seen the attackers rotate through different domains and adjust their tactics to evade detection.\nProtecting Your Organization So what can you do? Here‚Äôs what I recommend:\nImplement strict OAuth governance. Microsoft 365 lets you restrict which applications can request OAuth permissions. Use it. Here‚Äôs a PowerShell script to help you audit your current OAuth grants: Connect-AzureAD Get-AzureADServicePrincipal -All $true | Where-Object {$_.AppId -eq \"7a420f30-3dbf-4023-898f-f61bcb8cf6c5\"} | Select DisplayName, AppId, PublisherName Monitor for suspicious OAuth activities. Look for: New application consent grants, especially those requesting mail access Applications with unusual redirect URIs Multiple consent grants from the same application in a short time period Apply the following Sigma Rule: title: Suspicious OAuth App Consent description: Detects suspicious OAuth consent grants status: experimental author: CyFun logsource: product: azure service: auditlogs detection: selection: eventType: 'Add OAuth2PermissionGrant' permissions: - 'Mail.ReadWrite' - 'offline_access' condition: selection falsepositives: - Legitimate mail migration tools - Approved third-party email clients level: high Finally, train your users. They need to understand that permissions matter just as much as passwords. A legitimate Microsoft application shouldn‚Äôt be asking for mailbox access unless there‚Äôs a clear business need.\nIOCs For the blue teamers out there, here are the key indicators we‚Äôve observed:\nDomain: nqvntxrfe6yx.deusgolf.com OAuth callback: c.oinbase.top Client ID: 7a420f30-3dbf-4023-898f-f61bcb8cf6c5 Final Thoughts This campaign represents a significant evolution in phishing tactics. It‚Äôs sophisticated, effective, and unfortunately, likely to be widely copied. The days of simple credential phishing are giving way to more sophisticated OAuth-based attacks.\nI‚Äôll update this post as we discover more about this campaign. In the meantime, check your OAuth permissions, implement proper monitoring, and stay safe out there.\n‚ùó The post above reflects my personal perspective, which is based on the analysis shared in my iZOOlogic Threat Advisory titled OAuth Exploited: Silent Takeover of Microsoft Outlook Accounts. ","wordCount":"1342","inLanguage":"en","datePublished":"2024-11-26T06:30:05Z","dateModified":"2025-08-18T19:06:49+05:30","mainEntityOfPage":{"@type":"WebPage","@id":"https://s4ch.github.io/research/oath-exploited-by-attackers/"},"publisher":{"@type":"Organization","name":"CyFun","logo":{"@type":"ImageObject","url":"https://s4ch.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://s4ch.github.io/ accesskey=h title="CyFun (Alt + H)">CyFun</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://s4ch.github.io/about/ title=About><span>About</span></a></li><li><a href=https://s4ch.github.io/contact/ title=Contact><span>Contact</span></a></li><li><a href=https://s4ch.github.io/research/ title=Research><span>Research</span></a></li><li><a href=https://s4ch.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://s4ch.github.io/writeups/ title=Writeups><span>Writeups</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">How Attackers Are Weaponizing OAuth to Silently Take Over Microsoft Outlook Accounts</h1><div class=post-meta>&lt;span title='2024-11-26 06:30:05 +0000 UTC'>November 26, 2024&lt;/span>&amp;nbsp;¬∑&amp;nbsp;7 min&amp;nbsp;¬∑&amp;nbsp;1342 words&amp;nbsp;¬∑&amp;nbsp;
&lt;a href="https://s4ch.github.io/tags/oauth/" class="post-tag" title="oauth">oauth&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/microsoft/" class="post-tag" title="microsoft">microsoft&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/phishing/" class="post-tag" title="phishing">phishing&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/threat-analysis/" class="post-tag" title="threat-analysis">threat-analysis&lt;/a>
,
&lt;a href="https://s4ch.github.io/tags/incident-response/" class="post-tag" title="incident-response">incident-response&lt;/a>
&amp;nbsp;¬∑&amp;nbsp;
&lt;a href="https://s4ch.github.io/categories/research/" class="post-tag" title="research">research&lt;/a>
&amp;nbsp;¬∑&amp;nbsp;&lt;a href=".RelPermalink">permalink&lt;/a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#tldr>TL;DR</a></li><li><a href=#the-attack-landscape-beyond-traditional-phishing>The Attack Landscape: Beyond Traditional Phishing</a></li><li><a href=#the-attack-that-keeps-me-up-at-night>The Attack That Keeps Me Up at Night</a></li><li><a href=#down-the-rabbit-hole>Down the Rabbit Hole</a></li><li><a href=#flow-of-the-attack>Flow of the attack</a></li><li><a href=#the-infrastructure>The Infrastructure</a></li><li><a href=#why-this-keeps-me-awake-at-night>Why This Keeps Me Awake at Night</a></li><li><a href=#protecting-your-organization>Protecting Your Organization</a></li><li><a href=#iocs>IOCs</a></li><li><a href=#final-thoughts>Final Thoughts</a></li></ul></nav></div></details></div><div class=post-content><h2 id=tldr>TL;DR<a hidden class=anchor aria-hidden=true href=#tldr>#</a></h2><p>Last week, while investigating some suspicious Microsoft Outlook activity for a client at iZOOlogic, I stumbled upon something that made my heart sink for a while. What started as a routine incident response engagement turned into the discovery of one of the most sophisticated OAuth phishing campaigns I&rsquo;ve seen in my experience so far of security research.</p><p>Here&rsquo;s the kicker - this attack doesn&rsquo;t steal your password. It doesn&rsquo;t care about your MFA. Instead, it tricks you into granting a malicious application complete access to your mailbox, and it does it so smoothly that most users won&rsquo;t think twice before clicking &ldquo;Accept.&rdquo;</p><p>Let me walk you through what I found.</p><h2 id=the-attack-landscape-beyond-traditional-phishing>The Attack Landscape: Beyond Traditional Phishing<a hidden class=anchor aria-hidden=true href=#the-attack-landscape-beyond-traditional-phishing>#</a></h2><p>In my little years of security research, I&rsquo;ve watched attackers evolve from simple credential theft to something far more sophisticated. The modern attack doesn&rsquo;t break down the front door anymore - it walks right in through the reception area with a visitor&rsquo;s badge.</p><p>Microsoft 365 has become the perfect hunting ground. Why? Because it&rsquo;s not just an email platform - it&rsquo;s an interconnected ecosystem of productivity tools that are essentially a treasure trove of corporate intelligence.</p><p>The new attack methodology is brutally simple yet incredibly complex. Imagine an attack that:</p><ul><li>Completely bypasses traditional security controls</li><li>Maintains persistent access even after password resets</li><li>Uses the platform&rsquo;s own authentication mechanisms against itself</li></ul><p>Here&rsquo;s how these advanced Adversary-in-the-Middle (AiTM) attacks work:</p><ol><li>An attacker sends a meticulously crafted phishing email - so good it would make a social engineer weep with joy.</li><li>The victim clicks a link that looks legitimate, landing on what appears to be a standard Microsoft login page.</li><li>A threat actor-controlled proxy server sits in the middle, capturing every single authentication request and token.</li><li>Multifactor authentication? Doesn&rsquo;t matter. These proxies can forward MFA tokens in real-time.</li></ol><p>The most terrifying part? Microsoft 365&rsquo;s default session token configuration gives attackers a 90-day window of opportunity. Ninety. Entire. Days. Of. Access.</p><p>This isn&rsquo;t theoretical. This is happening right now, to organizations who think they&rsquo;re protected.</p><h2 id=the-attack-that-keeps-me-up-at-night>The Attack That Keeps Me Up at Night<a hidden class=anchor aria-hidden=true href=#the-attack-that-keeps-me-up-at-night>#</a></h2><p>It started with a suspicious OAuth consent screen that one of our clients&rsquo; employees reported. At first glance, it looked like any other Microsoft application requesting access - clean interface, professional design, all the hallmarks of legitimacy. But something felt off.</p><p><img loading=lazy src=/images/Pasted%20image%2020241126150729.png alt=virustotal>
Source : <a href=https://www.virustotal.com/gui/url/2f1a5442fab8acc180824c5d22a4be207194eb5d6dbe5452c468415dfc0f4391>Virustotal Scan</a></p><p>I got zero detection over Virustotal which made me excited in the first place.</p><p>Digging into the HTTP traffic, I found the initial redirect chain:</p><pre tabindex=0><code>http://nqvntxrfe6yx.deusgolf.com/account-lock-with-token/?em=[redacted]
</code></pre><p>Now, if you&rsquo;re in security, alarm bells should be ringing. That subdomain is clearly generated by DGAs. But what caught my attention was where it led.</p><blockquote class="alert alert-tip"><p class=alert-heading>üí°
Domain Generation Algorithms (DGAs) are sophisticated techniques used by threat actors to dynamically generate a large number of domain names. If one domain is blocked, hundreds of backup domains are ready.</p><ul><li>Generates domains algorithmically using:<ul><li>Time-based seeds</li><li>Cryptographic hash functions</li><li>Predefined generation rules</li></ul></li><li>Evasion advantage:<ul><li>Constantly rotating domains makes tracking difficult</li><li>Bypasses traditional IP/domain blacklisting</li><li>Reduces detection probability by security tools</li></ul></li></ul></blockquote><p>The attackers had set up an intricate infrastructure that leveraged Microsoft&rsquo;s own OAuth endpoints. They weren&rsquo;t trying to steal credentials - they were after something far more valuable: persistent mailbox access through OAuth permissions.</p><h2 id=down-the-rabbit-hole>Down the Rabbit Hole<a hidden class=anchor aria-hidden=true href=#down-the-rabbit-hole>#</a></h2><p><img loading=lazy src=/images/Pasted%20image%2020241127125804.png alt=outlookpage></p><p>The more I dug, the more impressed and concerned too I became. The attack flow is brilliant in its simplicity:</p><ol><li>The victim receives an urgent email about their account being locked</li><li>Clicking the link takes them through a legitimate Microsoft login flow</li><li>They&rsquo;re presented with a consent screen requesting mailbox permissions</li><li>Once granted, the attacker has persistent access - even if the victim changes their password</li></ol><p>But here&rsquo;s where it gets really interesting. Looking at the OAuth permission request:
<img loading=lazy src=/images/Pasted%20image%2020241127125144.png alt=burp2></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;requested_permissions&#34;</span>: [
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;User.Read&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;offline_access&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Mail.ReadWrite&#34;</span>
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>See that <code>offline_access</code> scope? That&rsquo;s the real danger here. It allows the attacker to obtain refresh tokens that don&rsquo;t expire. Even if the victim realizes something&rsquo;s wrong and changes their password, the attacker retains access until those OAuth permissions are explicitly revoked.</p><h2 id=flow-of-the-attack>Flow of the attack<a hidden class=anchor aria-hidden=true href=#flow-of-the-attack>#</a></h2><blockquote class="alert alert-tip"><p class=alert-heading>üí°
Switch to light mode for more visibility</p></blockquote><pre class=mermaid>stateDiagram-v2
    [*] --&gt; VictimEmail : Receives Urgent Email
    note right of VictimEmail
        Fabricated message about 
        account lock
    end note

    VictimEmail --&gt; MicrosoftLoginPage : Clicks Malicious Link
    
    MicrosoftLoginPage --&gt; OAuthConsentScreen : Legitimate Microsoft Login
    note right of OAuthConsentScreen
        Carefully crafted consent screen
        requesting mailbox permissions
    end note

    OAuthConsentScreen --&gt; AttackerAccess : User Grants Permissions
    note right of AttackerAccess
        Attacker gains:
        - Mail.ReadWrite access
        - Offline refresh tokens
    end note

    AttackerAccess --&gt; PersistentAccess : Maintains Access
    note right of PersistentAccess
        Access remains even if:
        - Password changed
        - MFA enabled
    end note

    PersistentAccess --&gt; [*] : Ongoing Mailbox Compromise
  </pre><h2 id=the-infrastructure>The Infrastructure<a hidden class=anchor aria-hidden=true href=#the-infrastructure>#</a></h2><p>The attackers weren&rsquo;t amateurs. Their infrastructure showed careful planning:</p><p>The callback domain - <code>c.oinbase.top</code> - is a clever piece of typosquatting. Notice the missing &lsquo;c&rsquo; in what should be &lsquo;coinbase&rsquo;? In a consent screen URL, that&rsquo;s easy to miss. The single-character subdomain further minimizes suspicion.</p><p><img loading=lazy src=/images/Pasted%20image%2020241127125432.png alt=burp1></p><p>They also implemented sophisticated browser fingerprinting. Here&rsquo;s a snippet of what they collect:</p><p><img loading=lazy src=/images/Pasted%20image%2020241127125510.png alt=burp3></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;deviceMemory&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>8</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;hardwareConcurrency&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>12</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;timezone&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Asia/Calcutta&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;userAgent&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;platform&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Win32&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;language&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;en-US&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;languages&#34;</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#34;en-US&#34;</span>],
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;cookiesEnabled&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;extensions&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;No extensions detected&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;screen&#34;</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;width&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1920</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;height&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1080</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;availWidth&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1920</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;availHeight&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1032</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;colorDepth&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>24</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;pixelDepth&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>24</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;window&#34;</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;innerWidth&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1044</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;innerHeight&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>944</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;outerWidth&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;outerHeight&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;timezoneOffset&#34;</span><span style=color:#f92672>:</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>330</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;maxTouchPoints&#34;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;referrer&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;https://account.live.com/&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;battery&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;mediaDevices&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;permissions&#34;</span><span style=color:#f92672>:</span> {},
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;plugins&#34;</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;PDF Viewer&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Chrome PDF Viewer&#34;</span>, 
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Chromium PDF Viewer&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Microsoft Edge PDF Viewer&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;WebKit built-in PDF&#34;</span>
</span></span><span style=display:flex><span>  ],
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;mimeTypes&#34;</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;application/pdf&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;text/pdf&#34;</span>
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>This isn&rsquo;t just for show - it&rsquo;s actively used to detect and evade security sandboxes and automated analysis tools. If the fingerprint doesn&rsquo;t match their target profile, the attack simply doesn&rsquo;t trigger.</p><h2 id=why-this-keeps-me-awake-at-night>Why This Keeps Me Awake at Night<a hidden class=anchor aria-hidden=true href=#why-this-keeps-me-awake-at-night>#</a></h2><p>From the beginning of Jan 2024, I&rsquo;ve seen countless phishing campaigns. But this one&rsquo;s different. Here&rsquo;s why:</p><ol><li>It completely bypasses MFA - because you&rsquo;re logging into a legitimate Microsoft page from your regular browser.</li><li>Password changes don&rsquo;t help - the OAuth tokens persist</li><li>It&rsquo;s nearly impossible to detect with traditional security tools</li><li>Most organizations aren&rsquo;t monitoring for suspicious OAuth grants</li></ol><p>The worst part? This campaign is still active, and it&rsquo;s evolving. We&rsquo;ve seen the attackers rotate through different domains and adjust their tactics to evade detection.</p><h2 id=protecting-your-organization>Protecting Your Organization<a hidden class=anchor aria-hidden=true href=#protecting-your-organization>#</a></h2><p>So what can you do? Here&rsquo;s what I recommend:</p><ol><li>Implement strict OAuth governance. Microsoft 365 lets you restrict which applications can request OAuth permissions. Use it. Here&rsquo;s a PowerShell script to help you audit your current OAuth grants:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>Connect-AzureAD
</span></span><span style=display:flex><span>Get-AzureADServicePrincipal -All $true | 
</span></span><span style=display:flex><span>Where-Object {$_.AppId <span style=color:#f92672>-eq</span> <span style=color:#e6db74>&#34;7a420f30-3dbf-4023-898f-f61bcb8cf6c5&#34;</span>} |
</span></span><span style=display:flex><span>Select DisplayName, AppId, PublisherName
</span></span></code></pre></div><ol start=2><li>Monitor for suspicious OAuth activities. Look for:</li></ol><ul><li>New application consent grants, especially those requesting mail access</li><li>Applications with unusual redirect URIs</li><li>Multiple consent grants from the same application in a short time period</li></ul><ol start=3><li>Apply the following Sigma Rule:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>   <span style=color:#f92672>title</span>: <span style=color:#ae81ff>Suspicious OAuth App Consent</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>description</span>: <span style=color:#ae81ff>Detects suspicious OAuth consent grants</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>status</span>: <span style=color:#ae81ff>experimental</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>author</span>: <span style=color:#ae81ff>CyFun</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>     <span style=color:#f92672>product</span>: <span style=color:#ae81ff>azure</span>
</span></span><span style=display:flex><span>     <span style=color:#f92672>service</span>: <span style=color:#ae81ff>auditlogs</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>detection</span>:
</span></span><span style=display:flex><span>     <span style=color:#f92672>selection</span>:
</span></span><span style=display:flex><span>       <span style=color:#f92672>eventType</span>: <span style=color:#e6db74>&#39;Add OAuth2PermissionGrant&#39;</span>
</span></span><span style=display:flex><span>       <span style=color:#f92672>permissions</span>: 
</span></span><span style=display:flex><span>         - <span style=color:#e6db74>&#39;Mail.ReadWrite&#39;</span>
</span></span><span style=display:flex><span>         - <span style=color:#e6db74>&#39;offline_access&#39;</span>
</span></span><span style=display:flex><span>     <span style=color:#f92672>condition</span>: <span style=color:#ae81ff>selection</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>falsepositives</span>:
</span></span><span style=display:flex><span>     - <span style=color:#ae81ff>Legitimate mail migration tools</span>
</span></span><span style=display:flex><span>     - <span style=color:#ae81ff>Approved third-party email clients</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>level</span>: <span style=color:#ae81ff>high</span>
</span></span></code></pre></div><p>Finally, train your users. They need to understand that permissions matter just as much as passwords. A legitimate Microsoft application shouldn&rsquo;t be asking for mailbox access unless there&rsquo;s a clear business need.</p><h2 id=iocs>IOCs<a hidden class=anchor aria-hidden=true href=#iocs>#</a></h2><p>For the blue teamers out there, here are the key indicators we&rsquo;ve observed:</p><ul><li>Domain: nqvntxrfe6yx.deusgolf.com</li><li>OAuth callback: c.oinbase.top</li><li>Client ID: 7a420f30-3dbf-4023-898f-f61bcb8cf6c5</li></ul><h2 id=final-thoughts>Final Thoughts<a hidden class=anchor aria-hidden=true href=#final-thoughts>#</a></h2><p>This campaign represents a significant evolution in phishing tactics. It&rsquo;s sophisticated, effective, and unfortunately, likely to be widely copied. The days of simple credential phishing are giving way to more sophisticated OAuth-based attacks.</p><p>I&rsquo;ll update this post as we discover more about this campaign. In the meantime, check your OAuth permissions, implement proper monitoring, and stay safe out there.</p><blockquote class="alert alert-caution"><p class=alert-heading>‚ùó
The post above reflects my personal perspective, which is based on the analysis shared in my iZOOlogic Threat Advisory titled <a href=https://izoologic.com/threat-advisory/oauth-exploited-silent-takeover-of-microsoft-outlook-accounts/>OAuth Exploited: Silent Takeover of Microsoft Outlook Accounts</a>.</p></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=https://s4ch.github.io/tags/oauth/>Oauth</a></li><li><a href=https://s4ch.github.io/tags/microsoft/>Microsoft</a></li><li><a href=https://s4ch.github.io/tags/phishing/>Phishing</a></li><li><a href=https://s4ch.github.io/tags/threat-analysis/>Threat-Analysis</a></li><li><a href=https://s4ch.github.io/tags/incident-response/>Incident-Response</a></li></ul><nav class=paginav><a class=prev href=https://s4ch.github.io/research/ebpf-jit-compiler-internals-understanding-constant-blinding/><span class=title>¬´ Prev</span><br><span>eBPF JIT Compiler Internals: Understanding Constant Blinding Implementation</span>
</a><a class=next href=https://s4ch.github.io/research/bucket-allocators/><span class=title>Next ¬ª</span><br><span>Novel approach to tackle UAF Bugs in the Linux Kernel</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://s4ch.github.io/>CyFun</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script></html>