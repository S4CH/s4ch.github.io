"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[3991],{3905:(n,e,a)=>{a.d(e,{Zo:()=>d,kt:()=>p});var r=a(67294);function t(n,e,a){return e in n?Object.defineProperty(n,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[e]=a,n}function x(n,e){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.push.apply(a,r)}return a}function c(n){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?x(Object(a),!0).forEach((function(e){t(n,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):x(Object(a)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(a,e))}))}return n}function s(n,e){if(null==n)return{};var a,r,t=function(n,e){if(null==n)return{};var a,r,t={},x=Object.keys(n);for(r=0;r<x.length;r++)a=x[r],e.indexOf(a)>=0||(t[a]=n[a]);return t}(n,e);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(n);for(r=0;r<x.length;r++)a=x[r],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(n,a)&&(t[a]=n[a])}return t}var f=r.createContext({}),i=function(n){var e=r.useContext(f),a=e;return n&&(a="function"==typeof n?n(e):c(c({},e),n)),a},d=function(n){var e=i(n.components);return r.createElement(f.Provider,{value:e},n.children)},o="mdxType",m={inlineCode:"code",wrapper:function(n){var e=n.children;return r.createElement(r.Fragment,{},e)}},_=r.forwardRef((function(n,e){var a=n.components,t=n.mdxType,x=n.originalType,f=n.parentName,d=s(n,["components","mdxType","originalType","parentName"]),o=i(a),_=t,p=o["".concat(f,".").concat(_)]||o[_]||m[_]||x;return a?r.createElement(p,c(c({ref:e},d),{},{components:a})):r.createElement(p,c({ref:e},d))}));function p(n,e){var a=arguments,t=e&&e.mdxType;if("string"==typeof n||t){var x=a.length,c=new Array(x);c[0]=_;var s={};for(var f in e)hasOwnProperty.call(e,f)&&(s[f]=e[f]);s.originalType=n,s[o]="string"==typeof n?n:t,c[1]=s;for(var i=2;i<x;i++)c[i]=a[i];return r.createElement.apply(null,c)}return r.createElement.apply(null,a)}_.displayName="MDXCreateElement"},78359:(n,e,a)=>{a.r(e),a.d(e,{assets:()=>f,contentTitle:()=>c,default:()=>m,frontMatter:()=>x,metadata:()=>s,toc:()=>i});var r=a(87462),t=(a(67294),a(3905));const x={},c="Reversing ELF",s={unversionedId:"Tryhackme/Reversing ELF/Reversing ELF",id:"Tryhackme/Reversing ELF/Reversing ELF",title:"Reversing ELF",description:"Room for beginner Reverse Engineering CTF players",source:"@site/writeups/Tryhackme/Reversing ELF/Reversing ELF.md",sourceDirName:"Tryhackme/Reversing ELF",slug:"/Tryhackme/Reversing ELF/",permalink:"/writeups/Tryhackme/Reversing ELF/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Reverse Engineering",permalink:"/writeups/Tryhackme/Reverse Engineering/"},next:{title:"RootMe",permalink:"/writeups/Tryhackme/RootMe/"}},f={},i=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Crackme1",id:"task-1-crackme1",level:2},{value:"Task 2 Crackme2",id:"task-2-crackme2",level:2},{value:"Task 3 Crackme3",id:"task-3-crackme3",level:2},{value:"Task 4 Crackme4",id:"task-4-crackme4",level:2},{value:"Task 5 Crackme5",id:"task-5-crackme5",level:2},{value:"Task 6 Crackme6",id:"task-6-crackme6",level:2},{value:"Task 7 Crackme7",id:"task-7-crackme7",level:2},{value:"Task 8 Crackme8",id:"task-8-crackme8",level:2}],d={toc:i},o="wrapper";function m(n){let{components:e,...x}=n;return(0,t.kt)(o,(0,r.Z)({},d,x,{components:e,mdxType:"MDXLayout"}),(0,t.kt)("h1",{id:"reversing-elf"},"Reversing ELF"),(0,t.kt)("p",null,"Room for beginner Reverse Engineering CTF players"),(0,t.kt)("p",null,(0,t.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/reverselfiles"},"Reversing ELF")),(0,t.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"Reverse Engineering"),(0,t.kt)("li",{parentName:"ul"},"Cryptography",(0,t.kt)("ul",{parentName:"li"},(0,t.kt)("li",{parentName:"ul"},"Base64"),(0,t.kt)("li",{parentName:"ul"},"Hex")))),(0,t.kt)("hr",null),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Reversing ELF$ chmod +x crackme*\nkali@kali:~/CTFs/tryhackme/Reversing ELF$ ls -la\ntotal 92\ndrwxr-xr-x   2 kali kali 4096 Oct 18 20:24 .\ndrwxr-xr-x 150 kali kali 4096 Oct 18 20:20 ..\n-rwxr-xr-x   1 kali kali 7192 Oct 18 20:21 crackme1\n-rwxr-xr-x   1 kali kali 5884 Oct 18 20:22 crackme2\n-rwxr-xr-x   1 kali kali 9632 Oct 18 20:24 crackme3\n-rwxr-xr-x   1 kali kali 8740 Oct 18 20:24 crackme4\n-rwxr-xr-x   1 kali kali 8968 Oct 18 20:24 crackme5\n-rwxr-xr-x   1 kali kali 8635 Oct 18 20:24 crackme6\n-rwxr-xr-x   1 kali kali 6372 Oct 18 20:23 crackme7\n-rwxr-xr-x   1 kali kali 5884 Oct 18 20:23 crackme8\n-rw-r--r--   1 kali kali  956 Oct 18 20:23 README.md\n")),(0,t.kt)("h2",{id:"task-1-crackme1"},"Task 1 Crackme1"),(0,t.kt)("p",null,"Let's start with a basic warmup, can you run the binary?"),(0,t.kt)("ol",null,(0,t.kt)("li",{parentName:"ol"},"What is the flag?")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Reversing ELF$ ./crackme1\nflag{not_that_kind_of_elf}\n")),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"flag{not_that_kind_of_elf}")),(0,t.kt)("h2",{id:"task-2-crackme2"},"Task 2 Crackme2"),(0,t.kt)("p",null,"Find the super-secret password! and use it to obtain the flag"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Reversing ELF$ strings crackme2\n/lib/ld-linux.so.2\nlibc.so.6\n_IO_stdin_used\nputs\nprintf\nmemset\nstrcmp\n__libc_start_main\n/usr/local/lib:$ORIGIN\n__gmon_start__\nGLIBC_2.0\nPTRh\nj3jA\n[^_]\nUWVS\nt$,U\n[^_]\nUsage: %s password\nsuper_secret_password\nAccess denied.\nAccess granted.\n;*2$"(\nGCC: (Ubuntu 5.4.0-6ubuntu1~16.04.9) 5.4.0 20160609\ncrtstuff.c\n__JCR_LIST__\nderegister_tm_clones\n__do_global_dtors_aux\ncompleted.7209\n__do_global_dtors_aux_fini_array_entry\nframe_dummy\n__frame_dummy_init_array_entry\nconditional1.c\ngiveFlag\n__FRAME_END__\n__JCR_END__\n__init_array_end\n_DYNAMIC\n__init_array_start\n__GNU_EH_FRAME_HDR\n_GLOBAL_OFFSET_TABLE_\n__libc_csu_fini\nstrcmp@@GLIBC_2.0\n_ITM_deregisterTMCloneTable\n__x86.get_pc_thunk.bx\nprintf@@GLIBC_2.0\n_edata\n__data_start\nputs@@GLIBC_2.0\n__gmon_start__\n__dso_handle\n_IO_stdin_used\n__libc_start_main@@GLIBC_2.0\n__libc_csu_init\nmemset@@GLIBC_2.0\n_fp_hw\n__bss_start\nmain\n_Jv_RegisterClasses\n__TMC_END__\n_ITM_registerTMCloneTable\n.symtab\n.strtab\n.shstrtab\n.interp\n.note.ABI-tag\n.note.gnu.build-id\n.gnu.hash\n.dynsym\n.dynstr\n.gnu.version\n.gnu.version_r\n.rel.dyn\n.rel.plt\n.init\n.plt.got\n.text\n.fini\n.rodata\n.eh_frame_hdr\n.eh_frame\n.init_array\n.fini_array\n.jcr\n.dynamic\n.got.plt\n.data\n.bss\n.comment\n')),(0,t.kt)("ol",null,(0,t.kt)("li",{parentName:"ol"},"What is the super secret password ?")),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"super_secret_password")),(0,t.kt)("ol",{start:2},(0,t.kt)("li",{parentName:"ol"},"What is the flag ?")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Reversing ELF$ ./crackme2 super_secret_password\nAccess granted.\nflag{if_i_submit_this_flag_then_i_will_get_points}\n")),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"flag{if_i_submit_this_flag_then_i_will_get_points}")),(0,t.kt)("h2",{id:"task-3-crackme3"},"Task 3 Crackme3"),(0,t.kt)("p",null,"Use basic reverse engineering skills to obtain the flag"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Reversing ELF$ strings crackme3\n/lib/ld-linux.so.2\n__gmon_start__\nlibc.so.6\n_IO_stdin_used\nputs\nstrlen\nmalloc\nstderr\nfwrite\nfprintf\nstrcmp\n__libc_start_main\nGLIBC_2.0\nPTRh\niD$$\nD$,;D$\nUWVS\n[^_]\nUsage: %s PASSWORD\nmalloc failed\nZjByX3kwdXJfNWVjMG5kX2xlNTVvbl91bmJhc2U2NF80bGxfN2gzXzdoMW5nNQ==\nCorrect password!\nCome on, even my aunt Mildred got this one!\nABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\n;*2$"8\nGCC: (Ubuntu/Linaro 4.6.3-1ubuntu5) 4.6.3\n.shstrtab\n.interp\n.note.ABI-tag\n.note.gnu.build-id\n.gnu.hash\n.dynsym\n.dynstr\n.gnu.version\n.gnu.version_r\n.rel.dyn\n.rel.plt\n.init\n.text\n.fini\n.rodata\n.eh_frame_hdr\n.eh_frame\n.ctors\n.dtors\n.jcr\n.dynamic\n.got\n.got.plt\n.data\n.bss\n.comment\n')),(0,t.kt)("ol",null,(0,t.kt)("li",{parentName:"ol"},"What is the flag?")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Reversing ELF$ echo 'ZjByX3kwdXJfNWVjMG5kX2xlNTVvbl91bmJhc2U2NF80bGxfN2gzXzdoMW5nNQ==' | base64 -d\nf0r_y0ur_5ec0nd_le55on_unbase64_4ll_7h3_7h1ng5\n")),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"f0r_y0ur_5ec0nd_le55on_unbase64_4ll_7h3_7h1ng5")),(0,t.kt)("h2",{id:"task-4-crackme4"},"Task 4 Crackme4"),(0,t.kt)("p",null,"Analyze and find the password for the binary?"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Reversing ELF$ r2 -d crackme4\nProcess with PID 16212 started...\n= attach 16212 16212\nbin.baddr 0x00400000\nUsing 0x400000\nasm.bits 64\nWarning: r_bin_file_hash: file exceeds bin.hashlimit\n[0x7faccdd68090]> aaa\n[x] Analyze all flags starting with sym. and entry0 (aa)\n[x] Analyze function calls (aac)\n[x] Analyze len bytes of instructions for references (aar)\n[x] Check for objc references\n[x] Check for vtables\n[TOFIX: aaft can't run in debugger mode.ions (aaft)\n[x] Type matching analysis for all functions (aaft)\n[x] Propagate noreturn information\n[x] Use -AA or aaaa to perform additional experimental analysis.\n[0x7faccdd68090]> afl\n0x00400540    1 41           entry0\n0x00400510    1 6            sym.imp.__libc_start_main\n0x00400570    4 41           sym.deregister_tm_clones\n0x004005a0    4 57           sym.register_tm_clones\n0x004005e0    3 28           entry.fini0\n0x00400600    4 45   -> 42   entry.init0\n0x004007d0    1 2            sym.__libc_csu_fini\n0x0040062d    4 77           sym.get_pwd\n0x004007d4    1 9            sym._fini\n0x0040067a    6 156          sym.compare_pwd\n0x00400760    4 101          sym.__libc_csu_init\n0x00400716    4 74           main\n0x004004b0    3 26           sym._init\n0x00400530    1 6            loc.imp.__gmon_start\n0x004004e0    1 6            sym.imp.puts\n0x004004f0    1 6            sym.imp.__stack_chk_fail\n0x00400500    1 6            sym.imp.printf\n0x00400520    1 6            sym.imp.strcmp\n[0x7faccdd68090]> pdf @main\n            ; DATA XREF from entry0 @ 0x40055d\n\u250c 74: int main (int argc, char **argv, char **envp);\n\u2502           ; var int64_t var_10h @ rbp-0x10\n\u2502           ; var int64_t var_4h @ rbp-0x4\n\u2502           ; arg int argc @ rdi\n\u2502           ; arg char **argv @ rsi\n\u2502           0x00400716      55             push rbp\n\u2502           0x00400717      4889e5         mov rbp, rsp\n\u2502           0x0040071a      4883ec10       sub rsp, 0x10\n\u2502           0x0040071e      897dfc         mov dword [var_4h], edi     ; argc\n\u2502           0x00400721      488975f0       mov qword [var_10h], rsi    ; argv\n\u2502           0x00400725      837dfc02       cmp dword [var_4h], 2\n\u2502       \u250c\u2500< 0x00400729      741b           je 0x400746\n\u2502       \u2502   0x0040072b      488b45f0       mov rax, qword [var_10h]\n\u2502       \u2502   0x0040072f      488b00         mov rax, qword [rax]\n\u2502       \u2502   0x00400732      4889c6         mov rsi, rax\n\u2502       \u2502   0x00400735      bf10084000     mov edi, str.Usage_:__s_password__This_time_the_string_is_hidden_and_we_used_strcmp ; 0x400810 ; \"Usage : %s password\\nThis time the string is hidden and we used strcmp\\n\"\n\u2502       \u2502   0x0040073a      b800000000     mov eax, 0\n\u2502       \u2502   0x0040073f      e8bcfdffff     call sym.imp.printf         ; int printf(const char *format)\n\u2502      \u250c\u2500\u2500< 0x00400744      eb13           jmp 0x400759\n\u2502      \u2502\u2514\u2500> 0x00400746      488b45f0       mov rax, qword [var_10h]\n\u2502      \u2502    0x0040074a      4883c008       add rax, 8\n\u2502      \u2502    0x0040074e      488b00         mov rax, qword [rax]\n\u2502      \u2502    0x00400751      4889c7         mov rdi, rax\n\u2502      \u2502    0x00400754      e821ffffff     call sym.compare_pwd\n\u2502      \u2502    ; CODE XREF from main @ 0x400744\n\u2502      \u2514\u2500\u2500> 0x00400759      b800000000     mov eax, 0\n\u2502           0x0040075e      c9             leave\n\u2514           0x0040075f      c3             ret\n[0x7faccdd68090]> psf @ sym.\nsym..comment                sym..interp                 sym..note.ABI_tag           sym..note.gnu.build_id      sym..gnu.hash\nsym..dynsym                 sym..dynstr                 sym..gnu.version            sym..gnu.version_r          sym..rela.dyn\nsym..rela.plt               sym..init                   sym._init                   sym..plt                    sym.imp.puts\nsym.imp.__stack_chk_fail    sym.imp.printf              sym.imp.__libc_start_main   sym.imp.strcmp              sym..text\nsym._start                  sym.deregister_tm_clones    sym.register_tm_clones      sym.__do_global_dtors_aux   sym.frame_dummy\nsym.get_pwd                 sym.compare_pwd             sym.main                    sym.__libc_csu_init         sym.__libc_csu_fini\nsym..fini                   sym._fini                   sym..rodata                 sym..eh_frame_hdr           sym..eh_frame\nsym..init_array             sym..fini_array             sym..jcr                    sym..dynamic                sym..got\nsym..got.plt                sym..data                   sym..bss\n[0x7faccdd68090]> psf @ sym.compare_pwd\nUH\\x89\\xe5H\\x83\\xec0H\\x89}\\xd8dH\\x8b\\x04%(\n[0x7faccdd68090]> pdf @sym.compare_pwd\n            ; CALL XREF from main @ 0x400754\n\u250c 156: sym.compare_pwd (int64_t arg1);\n\u2502           ; var int64_t var_28h @ rbp-0x28\n\u2502           ; var int64_t var_20h @ rbp-0x20\n\u2502           ; var int64_t var_18h @ rbp-0x18\n\u2502           ; var int64_t var_10h @ rbp-0x10\n\u2502           ; var int64_t var_eh @ rbp-0xe\n\u2502           ; var int64_t var_8h @ rbp-0x8\n\u2502           ; arg int64_t arg1 @ rdi\n\u2502           0x0040067a      55             push rbp\n\u2502           0x0040067b      4889e5         mov rbp, rsp\n\u2502           0x0040067e      4883ec30       sub rsp, 0x30\n\u2502           0x00400682      48897dd8       mov qword [var_28h], rdi    ; arg1\n\u2502           0x00400686      64488b042528.  mov rax, qword fs:[0x28]\n\u2502           0x0040068f      488945f8       mov qword [var_8h], rax\n\u2502           0x00400693      31c0           xor eax, eax\n\u2502           0x00400695      48b8495d7b49.  movabs rax, 0x7b175614497b5d49\n\u2502           0x0040069f      488945e0       mov qword [var_20h], rax\n\u2502           0x004006a3      48b857414751.  movabs rax, 0x547b175651474157\n\u2502           0x004006ad      488945e8       mov qword [var_18h], rax\n\u2502           0x004006b1      66c745f05340   mov word [var_10h], 0x4053  ; 'S@'\n\u2502           0x004006b7      c645f200       mov byte [var_eh], 0\n\u2502           0x004006bb      488d45e0       lea rax, qword [var_20h]\n\u2502           0x004006bf      4889c7         mov rdi, rax\n\u2502           0x004006c2      e866ffffff     call sym.get_pwd\n\u2502           0x004006c7      488b55d8       mov rdx, qword [var_28h]\n\u2502           0x004006cb      488d45e0       lea rax, qword [var_20h]\n\u2502           0x004006cf      4889d6         mov rsi, rdx\n\u2502           0x004006d2      4889c7         mov rdi, rax\n\u2502           0x004006d5      e846feffff     call sym.imp.strcmp         ; int strcmp(const char *s1, const char *s2)\n\u2502           0x004006da      85c0           test eax, eax\n\u2502       \u250c\u2500< 0x004006dc      750c           jne 0x4006ea\n\u2502       \u2502   0x004006de      bfe8074000     mov edi, str.password_OK    ; 0x4007e8 ; \"password OK\"\n\u2502       \u2502   0x004006e3      e8f8fdffff     call sym.imp.puts           ; int puts(const char *s)\n\u2502      \u250c\u2500\u2500< 0x004006e8      eb16           jmp 0x400700\n\u2502      \u2502\u2514\u2500> 0x004006ea      488b45d8       mov rax, qword [var_28h]\n\u2502      \u2502    0x004006ee      4889c6         mov rsi, rax\n\u2502      \u2502    0x004006f1      bff4074000     mov edi, str.password___s__not_OK ; 0x4007f4 ; \"password \\\"%s\\\" not OK\\n\"\n\u2502      \u2502    0x004006f6      b800000000     mov eax, 0\n\u2502      \u2502    0x004006fb      e800feffff     call sym.imp.printf         ; int printf(const char *format)\n\u2502      \u2502    ; CODE XREF from sym.compare_pwd @ 0x4006e8\n\u2502      \u2514\u2500\u2500> 0x00400700      488b45f8       mov rax, qword [var_8h]\n\u2502           0x00400704      644833042528.  xor rax, qword fs:[0x28]\n\u2502       \u250c\u2500< 0x0040070d      7405           je 0x400714\n\u2502       \u2502   0x0040070f      e8dcfdffff     call sym.imp.__stack_chk_fail ; void __stack_chk_fail(void)\n\u2502       \u2514\u2500> 0x00400714      c9             leave\n\u2514           0x00400715      c3             ret\n[0x7faccdd68090]> db 0x004006d2\n[0x7faccdd68090]> dc\nUsage : ./crackme4 password\nThis time the string is hidden and we used strcmp\n[0x7faccdc54759]> ood 'argument'\nPTRACE_CONT: No such process\nchild received signal 9\nProcess with PID 16229 started...\n= attach 16229 16229\nFile dbg:///home/kali/CTFs/tryhackme/Reversing\\ ELF/crackme4  'argument' reopened in read-write mode\nUnable to find filedescriptor 3\nUnable to find filedescriptor 3\n16229\n[0x7f7aadbef090]> db 0x004006d2\nBreakpoint already set at this address.\nCannot set breakpoint at '0x004006d2'\n[0x7f7aadbef090]> dc\nhit breakpoint at: 4006d2\n[0x004006d2]> px @rdi\n- offset -       0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF\n0x7ffd78dbed10  6d79 5f6d 3072 335f 7365 6375 7233 5f70  my_m0r3_secur3_p\n0x7ffd78dbed20  7764 0000 0000 0000 00a9 aa1f 41f1 ea4a  wd..........A..J\n0x7ffd78dbed30  50ed db78 fd7f 0000 5907 4000 0000 0000  P..x....Y.@.....\n0x7ffd78dbed40  48ee db78 fd7f 0000 0000 0000 0200 0000  H..x............\n0x7ffd78dbed50  6007 4000 0000 0000 ca6c a3ad 7a7f 0000  `.@......l..z...\n0x7ffd78dbed60  48ee db78 fd7f 0000 0000 0000 0200 0000  H..x............\n0x7ffd78dbed70  1607 4000 0000 0000 0000 0000 0000 0000  ..@.............\n0x7ffd78dbed80  0000 0000 0000 0000 720d 5f63 5ce5 f87a  ........r._c\\..z\n0x7ffd78dbed90  4005 4000 0000 0000 0000 0000 0000 0000  @.@.............\n0x7ffd78dbeda0  0000 0000 0000 0000 0000 0000 0000 0000  ................\n0x7ffd78dbedb0  720d 5fb7 6b14 0285 720d 99b4 9abe 0d84  r._.k...r.......\n0x7ffd78dbedc0  0000 0000 0000 0000 0000 0000 0000 0000  ................\n0x7ffd78dbedd0  0000 0000 0000 0000 0000 0000 0000 0000  ................\n0x7ffd78dbede0  0000 0000 0000 0000 0000 0000 0000 0000  ................\n0x7ffd78dbedf0  0000 0000 0000 0000 0000 0000 0000 0000  ................\n0x7ffd78dbee00  0000 0000 0000 0000 4005 4000 0000 0000  ........@.@.....\n")),(0,t.kt)("ol",null,(0,t.kt)("li",{parentName:"ol"},"What is the password ?")),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"my_m0r3_secur3_pwd")),(0,t.kt)("h2",{id:"task-5-crackme5"},"Task 5 Crackme5"),(0,t.kt)("p",null,"What will be the input of the file to get output Good game ?"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Reversing ELF$ ./crackme5\nEnter your input:\ntest\nAlways dig deeper\n")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Reversing ELF$ r2 -d crackme5\nProcess with PID 16279 started...\n= attach 16279 16279\nbin.baddr 0x00400000\nUsing 0x400000\nasm.bits 64\nWarning: r_bin_file_hash: file exceeds bin.hashlimit\n[0x7f2bf6774090]> aaa\n[x] Analyze all flags starting with sym. and entry0 (aa)\n[x] Analyze function calls (aac)\n[x] Analyze len bytes of instructions for references (aar)\n[x] Check for objc references\n[x] Check for vtables\n[TOFIX: aaft can't run in debugger mode.ions (aaft)\n[x] Type matching analysis for all functions (aaft)\n[x] Propagate noreturn information\n[x] Use -AA or aaaa to perform additional experimental analysis.\n[0x7f2bf6774090]> afl\n0x004005e0    1 41           entry0\n0x004005a0    1 6            sym.imp.__libc_start_main\n0x00400610    4 50   -> 41   sym.deregister_tm_clones\n0x00400650    4 58   -> 55   sym.register_tm_clones\n0x00400690    3 28           entry.fini0\n0x004006b0    4 38   -> 35   entry.init0\n0x00400940    1 2            sym.__libc_csu_fini\n0x00400944    1 9            sym._fini\n0x004006d6    7 157          sym.strcmp\n0x004008d0    4 101          sym.__libc_csu_init\n0x00400773    6 251          main\n0x0040086e    4 93           sym.check\n0x00400528    3 26           sym._init\n0x00400560    1 6            sym.imp.strncmp\n0x00400570    1 6            sym.imp.puts\n0x00400580    1 6            sym.imp.strlen\n0x00400590    1 6            sym.imp.__stack_chk_fail\n0x004005b0    1 6            sym.imp.atoi\n0x004005c0    1 6            sym.imp.__isoc99_scanf\n[0x7f2bf6774090]> pdf @main\n            ; DATA XREF from entry0 @ 0x4005fd\n            ; CALL XREF from sym.check @ 0x4008c3\n\u250c 251: int main (int argc, char **argv, char **envp);\n\u2502           ; var int64_t var_70h @ rbp-0x70\n\u2502           ; var int64_t var_64h @ rbp-0x64\n\u2502           ; var int64_t var_54h @ rbp-0x54\n\u2502           ; var int64_t var_50h @ rbp-0x50\n\u2502           ; var int64_t var_30h @ rbp-0x30\n\u2502           ; var int64_t var_2fh @ rbp-0x2f\n\u2502           ; var int64_t var_2eh @ rbp-0x2e\n\u2502           ; var int64_t var_2dh @ rbp-0x2d\n\u2502           ; var int64_t var_2ch @ rbp-0x2c\n\u2502           ; var int64_t var_2bh @ rbp-0x2b\n\u2502           ; var int64_t var_2ah @ rbp-0x2a\n\u2502           ; var int64_t var_29h @ rbp-0x29\n\u2502           ; var int64_t var_28h @ rbp-0x28\n\u2502           ; var int64_t var_27h @ rbp-0x27\n\u2502           ; var int64_t var_26h @ rbp-0x26\n\u2502           ; var int64_t var_25h @ rbp-0x25\n\u2502           ; var int64_t var_24h @ rbp-0x24\n\u2502           ; var int64_t var_23h @ rbp-0x23\n\u2502           ; var int64_t var_22h @ rbp-0x22\n\u2502           ; var int64_t var_21h @ rbp-0x21\n\u2502           ; var int64_t var_20h @ rbp-0x20\n\u2502           ; var int64_t var_1fh @ rbp-0x1f\n\u2502           ; var int64_t var_1eh @ rbp-0x1e\n\u2502           ; var int64_t var_1dh @ rbp-0x1d\n\u2502           ; var int64_t var_1ch @ rbp-0x1c\n\u2502           ; var int64_t var_1bh @ rbp-0x1b\n\u2502           ; var int64_t var_1ah @ rbp-0x1a\n\u2502           ; var int64_t var_19h @ rbp-0x19\n\u2502           ; var int64_t var_18h @ rbp-0x18\n\u2502           ; var int64_t var_17h @ rbp-0x17\n\u2502           ; var int64_t var_16h @ rbp-0x16\n\u2502           ; var int64_t var_15h @ rbp-0x15\n\u2502           ; var int64_t var_8h @ rbp-0x8\n\u2502           ; arg int argc @ rdi\n\u2502           ; arg char **argv @ rsi\n\u2502           0x00400773      55             push rbp\n\u2502           0x00400774      4889e5         mov rbp, rsp\n\u2502           0x00400777      4883ec70       sub rsp, 0x70\n\u2502           0x0040077b      897d9c         mov dword [var_64h], edi    ; argc\n\u2502           0x0040077e      48897590       mov qword [var_70h], rsi    ; argv\n\u2502           0x00400782      64488b042528.  mov rax, qword fs:[0x28]\n\u2502           0x0040078b      488945f8       mov qword [var_8h], rax\n\u2502           0x0040078f      31c0           xor eax, eax\n\u2502           0x00400791      c645d04f       mov byte [var_30h], 0x4f    ; 'O' ; 79\n\u2502           0x00400795      c645d166       mov byte [var_2fh], 0x66    ; 'f' ; 102\n\u2502           0x00400799      c645d264       mov byte [var_2eh], 0x64    ; 'd' ; 100\n\u2502           0x0040079d      c645d36c       mov byte [var_2dh], 0x6c    ; 'l' ; 108\n\u2502           0x004007a1      c645d444       mov byte [var_2ch], 0x44    ; 'D' ; 68\n\u2502           0x004007a5      c645d553       mov byte [var_2bh], 0x53    ; 'S' ; 83\n\u2502           0x004007a9      c645d641       mov byte [var_2ah], 0x41    ; 'A' ; 65\n\u2502           0x004007ad      c645d77c       mov byte [var_29h], 0x7c    ; '|' ; 124\n\u2502           0x004007b1      c645d833       mov byte [var_28h], 0x33    ; '3' ; 51\n\u2502           0x004007b5      c645d974       mov byte [var_27h], 0x74    ; 't' ; 116\n\u2502           0x004007b9      c645da58       mov byte [var_26h], 0x58    ; 'X' ; 88\n\u2502           0x004007bd      c645db62       mov byte [var_25h], 0x62    ; 'b' ; 98\n\u2502           0x004007c1      c645dc33       mov byte [var_24h], 0x33    ; '3' ; 51\n\u2502           0x004007c5      c645dd32       mov byte [var_23h], 0x32    ; '2' ; 50\n\u2502           0x004007c9      c645de7e       mov byte [var_22h], 0x7e    ; '~' ; 126\n\u2502           0x004007cd      c645df58       mov byte [var_21h], 0x58    ; 'X' ; 88\n\u2502           0x004007d1      c645e033       mov byte [var_20h], 0x33    ; '3' ; 51\n\u2502           0x004007d5      c645e174       mov byte [var_1fh], 0x74    ; 't' ; 116\n\u2502           0x004007d9      c645e258       mov byte [var_1eh], 0x58    ; 'X' ; 88\n\u2502           0x004007dd      c645e340       mov byte [var_1dh], 0x40    ; '@' ; 64\n\u2502           0x004007e1      c645e473       mov byte [var_1ch], 0x73    ; 's' ; 115\n\u2502           0x004007e5      c645e558       mov byte [var_1bh], 0x58    ; 'X' ; 88\n\u2502           0x004007e9      c645e660       mov byte [var_1ah], 0x60    ; '`' ; 96\n\u2502           0x004007ed      c645e734       mov byte [var_19h], 0x34    ; '4' ; 52\n\u2502           0x004007f1      c645e874       mov byte [var_18h], 0x74    ; 't' ; 116\n\u2502           0x004007f5      c645e958       mov byte [var_17h], 0x58    ; 'X' ; 88\n\u2502           0x004007f9      c645ea74       mov byte [var_16h], 0x74    ; 't' ; 116\n\u2502           0x004007fd      c645eb7a       mov byte [var_15h], 0x7a    ; 'z' ; 122\n\u2502           0x00400801      bf54094000     mov edi, str.Enter_your_input: ; 0x400954 ; \"Enter your input:\"\n\u2502           0x00400806      e865fdffff     call sym.imp.puts           ; int puts(const char *s)\n\u2502           0x0040080b      488d45b0       lea rax, qword [var_50h]\n\u2502           0x0040080f      4889c6         mov rsi, rax\n\u2502           0x00400812      bf66094000     mov edi, 0x400966\n\u2502           0x00400817      b800000000     mov eax, 0\n\u2502           0x0040081c      e89ffdffff     call sym.imp.__isoc99_scanf ; int scanf(const char *format)\n\u2502           0x00400821      488d55d0       lea rdx, qword [var_30h]\n\u2502           0x00400825      488d45b0       lea rax, qword [var_50h]\n\u2502           0x00400829      4889d6         mov rsi, rdx\n\u2502           0x0040082c b    4889c7         mov rdi, rax\n\u2502           0x0040082f      e8a2feffff     call sym.strcmp             ; int strcmp(const char *s1, const char *s2)\n\u2502           0x00400834      8945ac         mov dword [var_54h], eax\n\u2502           0x00400837      837dac00       cmp dword [var_54h], 0\n\u2502       \u250c\u2500< 0x0040083b      750c           jne 0x400849\n\u2502       \u2502   0x0040083d      bf69094000     mov edi, str.Good_game      ; 0x400969 ; \"Good game\"\n\u2502       \u2502   0x00400842      e829fdffff     call sym.imp.puts           ; int puts(const char *s)\n\u2502      \u250c\u2500\u2500< 0x00400847      eb0a           jmp 0x400853\n\u2502      \u2502\u2514\u2500> 0x00400849      bf73094000     mov edi, str.Always_dig_deeper ; 0x400973 ; \"Always dig deeper\"\n\u2502      \u2502    0x0040084e      e81dfdffff     call sym.imp.puts           ; int puts(const char *s)\n\u2502      \u2502    ; CODE XREF from main @ 0x400847\n\u2502      \u2514\u2500\u2500> 0x00400853      b800000000     mov eax, 0\n\u2502           0x00400858      488b4df8       mov rcx, qword [var_8h]\n\u2502           0x0040085c      6448330c2528.  xor rcx, qword fs:[0x28]\n\u2502       \u250c\u2500< 0x00400865      7405           je 0x40086c\n\u2502       \u2502   0x00400867      e824fdffff     call sym.imp.__stack_chk_fail ; void __stack_chk_fail(void)\n\u2502       \u2514\u2500> 0x0040086c      c9             leave\n\u2514           0x0040086d      c3             ret\n[0x7f2bf6774090]> db 0x0040082c\n[0x7f2bf6774090]> dc\nEnter your input:\ntest\nhit breakpoint at: 40082c\n[0x0040082c]> px @rsi\n- offset -       0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF\n0x7ffceb8b40e0  4f66 646c 4453 417c 3374 5862 3332 7e58  OfdlDSA|3tXb32~X\n0x7ffceb8b40f0  3374 5840 7358 6034 7458 747a 0000 0000  3tX@sX`4tXtz....\n0x7ffceb8b4100  0042 8beb fc7f 0000 003b dea8 9703 1c9d  .B.......;......\n0x7ffceb8b4110  d008 4000 0000 0000 cabc 5bf6 2b7f 0000  ..@.......[.+...\n0x7ffceb8b4120  0842 8beb fc7f 0000 0000 0000 0100 0000  .B..............\n0x7ffceb8b4130  7307 4000 0000 0000 0000 0000 0000 0000  s.@.............\n0x7ffceb8b4140  0000 0000 0000 0000 ba8c 3f6a f4d1 8b6a  ..........?j...j\n0x7ffceb8b4150  e005 4000 0000 0000 0000 0000 0000 0000  ..@.............\n0x7ffceb8b4160  0000 0000 0000 0000 0000 0000 0000 0000  ................\n0x7ffceb8b4170  ba8c dff9 6206 7295 ba8c 9902 c33d dc94  ....b.r......=..\n0x7ffceb8b4180  0000 0000 0000 0000 0000 0000 0000 0000  ................\n0x7ffceb8b4190  0000 0000 0000 0000 0000 0000 0000 0000  ................\n0x7ffceb8b41a0  0000 0000 0000 0000 0000 0000 0000 0000  ................\n0x7ffceb8b41b0  0000 0000 0000 0000 0000 0000 0000 0000  ................\n0x7ffceb8b41c0  0000 0000 0000 0000 e005 4000 0000 0000  ..........@.....\n0x7ffceb8b41d0  0042 8beb fc7f 0000 0000 0000 0000 0000  .B..............\n")),(0,t.kt)("ol",null,(0,t.kt)("li",{parentName:"ol"},"What is the input ?")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Reversing ELF$ ./crackme5\nEnter your input:\nOfdlDSA|3tXb32~X3tX@sX`4tXtz\nGood game\n")),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"OfdlDSA|3tXb32~X3tX@sX"),"4tXtz`"),(0,t.kt)("h2",{id:"task-6-crackme6"},"Task 6 Crackme6"),(0,t.kt)("p",null,"Analyze the binary for the easy password"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Reversing ELF$ r2 -d crackme6\nProcess with PID 16349 started...\n= attach 16349 16349\nbin.baddr 0x00400000\nUsing 0x400000\nasm.bits 64\nWarning: r_bin_file_hash: file exceeds bin.hashlimit\n[0x7ff486423090]> aaa\n[x] Analyze all flags starting with sym. and entry0 (aa)\n[x] Analyze function calls (aac)\n[x] Analyze len bytes of instructions for references (aar)\n[x] Check for objc references\n[x] Check for vtables\n[TOFIX: aaft can\'t run in debugger mode.ions (aaft)\n[x] Type matching analysis for all functions (aaft)\n[x] Propagate noreturn information\n[x] Use -AA or aaaa to perform additional experimental analysis.\n[0x7ff486423090]> afl\n0x00400490    1 41           entry0\n0x00400470    1 6            sym.imp.__libc_start_main\n0x004004c0    4 41           sym.deregister_tm_clones\n0x004004f0    4 57           sym.register_tm_clones\n0x00400530    3 28           entry.fini0\n0x00400550    4 45   -> 42   entry.init0\n0x004007d0    1 2            sym.__libc_csu_fini\n0x004007d4    1 9            sym._fini\n0x004006d1    4 64           sym.compare_pwd\n0x00400760    4 101          sym.__libc_csu_init\n0x00400711    4 74           main\n0x0040057d   28 340          sym.my_secure_test\n0x00400418    3 26           sym._init\n0x00400480    1 6            loc.imp.__gmon_start\n0x00400450    1 6            sym.imp.puts\n0x00400460    1 6            sym.imp.printf\n[0x7ff486423090]> pdf @main\n            ; DATA XREF from entry0 @ 0x4004ad\n\u250c 74: int main (int argc, char **argv, char **envp);\n\u2502           ; var int64_t var_10h @ rbp-0x10\n\u2502           ; var int64_t var_4h @ rbp-0x4\n\u2502           ; arg int argc @ rdi\n\u2502           ; arg char **argv @ rsi\n\u2502           0x00400711      55             push rbp\n\u2502           0x00400712      4889e5         mov rbp, rsp\n\u2502           0x00400715      4883ec10       sub rsp, 0x10\n\u2502           0x00400719      897dfc         mov dword [var_4h], edi     ; argc\n\u2502           0x0040071c      488975f0       mov qword [var_10h], rsi    ; argv\n\u2502           0x00400720      837dfc02       cmp dword [var_4h], 2\n\u2502       \u250c\u2500< 0x00400724      741b           je 0x400741\n\u2502       \u2502   0x00400726      488b45f0       mov rax, qword [var_10h]\n\u2502       \u2502   0x0040072a      488b00         mov rax, qword [rax]\n\u2502       \u2502   0x0040072d      4889c6         mov rsi, rax\n\u2502       \u2502   0x00400730      bf10084000     mov edi, str.Usage_:__s_password__Good_luck__read_the_source ; 0x400810 ; "Usage : %s password\\nGood luck, read the source\\n"\n\u2502       \u2502   0x00400735      b800000000     mov eax, 0\n\u2502       \u2502   0x0040073a      e821fdffff     call sym.imp.printf         ; int printf(const char *format)\n\u2502      \u250c\u2500\u2500< 0x0040073f      eb13           jmp 0x400754\n\u2502      \u2502\u2514\u2500> 0x00400741      488b45f0       mov rax, qword [var_10h]\n\u2502      \u2502    0x00400745      4883c008       add rax, 8\n\u2502      \u2502    0x00400749      488b00         mov rax, qword [rax]\n\u2502      \u2502    0x0040074c      4889c7         mov rdi, rax\n\u2502      \u2502    0x0040074f      e87dffffff     call sym.compare_pwd\n\u2502      \u2502    ; CODE XREF from main @ 0x40073f\n\u2502      \u2514\u2500\u2500> 0x00400754      b800000000     mov eax, 0\n\u2502           0x00400759      c9             leave\n\u2514           0x0040075a      c3             ret\n[0x7ff486423090]> pdf @sym.comare_pwd\nInvalid address (sym.comare_pwd)\n|ERROR| Invalid command \'pdf @sym.comare_pwd\' (0x70)\n[0x7ff486423090]> pdf @sym.compare_pwd\n            ; CALL XREF from main @ 0x40074f\n\u250c 64: sym.compare_pwd (int64_t arg1);\n\u2502           ; var int64_t var_8h @ rbp-0x8\n\u2502           ; arg int64_t arg1 @ rdi\n\u2502           0x004006d1      55             push rbp\n\u2502           0x004006d2      4889e5         mov rbp, rsp\n\u2502           0x004006d5      4883ec10       sub rsp, 0x10\n\u2502           0x004006d9      48897df8       mov qword [var_8h], rdi     ; arg1\n\u2502           0x004006dd      488b45f8       mov rax, qword [var_8h]\n\u2502           0x004006e1      4889c7         mov rdi, rax\n\u2502           0x004006e4      e894feffff     call sym.my_secure_test\n\u2502           0x004006e9      85c0           test eax, eax\n\u2502       \u250c\u2500< 0x004006eb      750c           jne 0x4006f9\n\u2502       \u2502   0x004006ed      bfe8074000     mov edi, str.password_OK    ; 0x4007e8 ; "password OK"\n\u2502       \u2502   0x004006f2      e859fdffff     call sym.imp.puts           ; int puts(const char *s)\n\u2502      \u250c\u2500\u2500< 0x004006f7      eb16           jmp 0x40070f\n\u2502      \u2502\u2514\u2500> 0x004006f9      488b45f8       mov rax, qword [var_8h]\n\u2502      \u2502    0x004006fd      4889c6         mov rsi, rax\n\u2502      \u2502    0x00400700      bff4074000     mov edi, str.password___s__not_OK ; 0x4007f4 ; "password \\"%s\\" not OK\\n"\n\u2502      \u2502    0x00400705      b800000000     mov eax, 0\n\u2502      \u2502    0x0040070a      e851fdffff     call sym.imp.printf         ; int printf(const char *format)\n\u2502      \u2502    ; CODE XREF from sym.compare_pwd @ 0x4006f7\n\u2502      \u2514\u2500\u2500> 0x0040070f      c9             leave\n\u2514           0x00400710      c3             ret\n[0x7ff486423090]> pdf @sym.my_secure_test\n            ; CALL XREF from sym.compare_pwd @ 0x4006e4\n\u250c 340: sym.my_secure_test (int64_t arg1);\n\u2502           ; var int64_t var_8h @ rbp-0x8\n\u2502           ; arg int64_t arg1 @ rdi\n\u2502           0x0040057d      55             push rbp\n\u2502           0x0040057e      4889e5         mov rbp, rsp\n\u2502           0x00400581      48897df8       mov qword [var_8h], rdi     ; arg1\n\u2502           0x00400585      488b45f8       mov rax, qword [var_8h]\n\u2502           0x00400589      0fb600         movzx eax, byte [rax]\n\u2502           0x0040058c      84c0           test al, al\n\u2502       \u250c\u2500< 0x0040058e      740b           je 0x40059b\n\u2502       \u2502   0x00400590      488b45f8       mov rax, qword [var_8h]\n\u2502       \u2502   0x00400594      0fb600         movzx eax, byte [rax]\n\u2502       \u2502   0x00400597      3c31           cmp al, 0x31                ; 49\n\u2502      \u250c\u2500\u2500< 0x00400599      740a           je 0x4005a5\n\u2502      \u2502\u2514\u2500> 0x0040059b      b8ffffffff     mov eax, 0xffffffff         ; -1\n\u2502      \u2502\u250c\u2500< 0x004005a0      e92a010000     jmp 0x4006cf\n\u2502      \u2514\u2500\u2500> 0x004005a5      488b45f8       mov rax, qword [var_8h]\n\u2502       \u2502   0x004005a9      4883c001       add rax, 1\n\u2502       \u2502   0x004005ad      0fb600         movzx eax, byte [rax]\n\u2502       \u2502   0x004005b0      84c0           test al, al\n\u2502      \u250c\u2500\u2500< 0x004005b2      740f           je 0x4005c3\n\u2502      \u2502\u2502   0x004005b4      488b45f8       mov rax, qword [var_8h]\n\u2502      \u2502\u2502   0x004005b8      4883c001       add rax, 1\n\u2502      \u2502\u2502   0x004005bc      0fb600         movzx eax, byte [rax]\n\u2502      \u2502\u2502   0x004005bf      3c33           cmp al, 0x33                ; 51\n\u2502     \u250c\u2500\u2500\u2500< 0x004005c1      740a           je 0x4005cd\n\u2502     \u2502\u2514\u2500\u2500> 0x004005c3      b8ffffffff     mov eax, 0xffffffff         ; -1\n\u2502     \u2502\u250c\u2500\u2500< 0x004005c8      e902010000     jmp 0x4006cf\n\u2502     \u2514\u2500\u2500\u2500> 0x004005cd      488b45f8       mov rax, qword [var_8h]\n\u2502      \u2502\u2502   0x004005d1      4883c002       add rax, 2\n\u2502      \u2502\u2502   0x004005d5      0fb600         movzx eax, byte [rax]\n\u2502      \u2502\u2502   0x004005d8      84c0           test al, al\n\u2502     \u250c\u2500\u2500\u2500< 0x004005da      740f           je 0x4005eb\n\u2502     \u2502\u2502\u2502   0x004005dc      488b45f8       mov rax, qword [var_8h]\n\u2502     \u2502\u2502\u2502   0x004005e0      4883c002       add rax, 2\n\u2502     \u2502\u2502\u2502   0x004005e4      0fb600         movzx eax, byte [rax]\n\u2502     \u2502\u2502\u2502   0x004005e7      3c33           cmp al, 0x33                ; 51\n\u2502    \u250c\u2500\u2500\u2500\u2500< 0x004005e9      740a           je 0x4005f5\n\u2502    \u2502\u2514\u2500\u2500\u2500> 0x004005eb      b8ffffffff     mov eax, 0xffffffff         ; -1\n\u2502    \u2502\u250c\u2500\u2500\u2500< 0x004005f0      e9da000000     jmp 0x4006cf\n\u2502    \u2514\u2500\u2500\u2500\u2500> 0x004005f5      488b45f8       mov rax, qword [var_8h]\n\u2502     \u2502\u2502\u2502   0x004005f9      4883c003       add rax, 3\n\u2502     \u2502\u2502\u2502   0x004005fd      0fb600         movzx eax, byte [rax]\n\u2502     \u2502\u2502\u2502   0x00400600      84c0           test al, al\n\u2502    \u250c\u2500\u2500\u2500\u2500< 0x00400602      740f           je 0x400613\n\u2502    \u2502\u2502\u2502\u2502   0x00400604      488b45f8       mov rax, qword [var_8h]\n\u2502    \u2502\u2502\u2502\u2502   0x00400608      4883c003       add rax, 3\n\u2502    \u2502\u2502\u2502\u2502   0x0040060c      0fb600         movzx eax, byte [rax]\n\u2502    \u2502\u2502\u2502\u2502   0x0040060f      3c37           cmp al, 0x37                ; 55\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500< 0x00400611      740a           je 0x40061d\n\u2502   \u2502\u2514\u2500\u2500\u2500\u2500> 0x00400613      b8ffffffff     mov eax, 0xffffffff         ; -1\n\u2502   \u2502\u250c\u2500\u2500\u2500\u2500< 0x00400618      e9b2000000     jmp 0x4006cf\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500> 0x0040061d      488b45f8       mov rax, qword [var_8h]\n\u2502    \u2502\u2502\u2502\u2502   0x00400621      4883c004       add rax, 4\n\u2502    \u2502\u2502\u2502\u2502   0x00400625      0fb600         movzx eax, byte [rax]\n\u2502    \u2502\u2502\u2502\u2502   0x00400628      84c0           test al, al\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500< 0x0040062a      740f           je 0x40063b\n\u2502   \u2502\u2502\u2502\u2502\u2502   0x0040062c      488b45f8       mov rax, qword [var_8h]\n\u2502   \u2502\u2502\u2502\u2502\u2502   0x00400630      4883c004       add rax, 4\n\u2502   \u2502\u2502\u2502\u2502\u2502   0x00400634      0fb600         movzx eax, byte [rax]\n\u2502   \u2502\u2502\u2502\u2502\u2502   0x00400637      3c5f           cmp al, 0x5f                ; 95\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500< 0x00400639      740a           je 0x400645\n\u2502  \u2502\u2514\u2500\u2500\u2500\u2500\u2500> 0x0040063b      b8ffffffff     mov eax, 0xffffffff         ; -1\n\u2502  \u2502\u250c\u2500\u2500\u2500\u2500\u2500< 0x00400640      e98a000000     jmp 0x4006cf\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500> 0x00400645      488b45f8       mov rax, qword [var_8h]\n\u2502   \u2502\u2502\u2502\u2502\u2502   0x00400649      4883c005       add rax, 5\n\u2502   \u2502\u2502\u2502\u2502\u2502   0x0040064d      0fb600         movzx eax, byte [rax]\n\u2502   \u2502\u2502\u2502\u2502\u2502   0x00400650      84c0           test al, al\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500< 0x00400652      740f           je 0x400663\n\u2502  \u2502\u2502\u2502\u2502\u2502\u2502   0x00400654      488b45f8       mov rax, qword [var_8h]\n\u2502  \u2502\u2502\u2502\u2502\u2502\u2502   0x00400658      4883c005       add rax, 5\n\u2502  \u2502\u2502\u2502\u2502\u2502\u2502   0x0040065c      0fb600         movzx eax, byte [rax]\n\u2502  \u2502\u2502\u2502\u2502\u2502\u2502   0x0040065f      3c70           cmp al, 0x70                ; 112\n\u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500< 0x00400661      7407           je 0x40066a\n\u2502 \u2502\u2514\u2500\u2500\u2500\u2500\u2500\u2500> 0x00400663      b8ffffffff     mov eax, 0xffffffff         ; -1\n\u2502 \u2502\u250c\u2500\u2500\u2500\u2500\u2500\u2500< 0x00400668      eb65           jmp 0x4006cf\n\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500> 0x0040066a      488b45f8       mov rax, qword [var_8h]\n\u2502  \u2502\u2502\u2502\u2502\u2502\u2502   0x0040066e      4883c006       add rax, 6\n\u2502  \u2502\u2502\u2502\u2502\u2502\u2502   0x00400672      0fb600         movzx eax, byte [rax]\n\u2502  \u2502\u2502\u2502\u2502\u2502\u2502   0x00400675      84c0           test al, al\n\u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500< 0x00400677      740f           je 0x400688\n\u2502 \u2502\u2502\u2502\u2502\u2502\u2502\u2502   0x00400679      488b45f8       mov rax, qword [var_8h]\n\u2502 \u2502\u2502\u2502\u2502\u2502\u2502\u2502   0x0040067d      4883c006       add rax, 6\n\u2502 \u2502\u2502\u2502\u2502\u2502\u2502\u2502   0x00400681      0fb600         movzx eax, byte [rax]\n\u2502 \u2502\u2502\u2502\u2502\u2502\u2502\u2502   0x00400684      3c77           cmp al, 0x77                ; 119\n\u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500< 0x00400686      7407           je 0x40068f\n\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500> 0x00400688      b8ffffffff     mov eax, 0xffffffff         ; -1\n\u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500< 0x0040068d      eb40           jmp 0x4006cf\n\u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500> 0x0040068f      488b45f8       mov rax, qword [var_8h]\n\u2502 \u2502\u2502\u2502\u2502\u2502\u2502\u2502   0x00400693      4883c007       add rax, 7\n\u2502 \u2502\u2502\u2502\u2502\u2502\u2502\u2502   0x00400697      0fb600         movzx eax, byte [rax]\n\u2502 \u2502\u2502\u2502\u2502\u2502\u2502\u2502   0x0040069a      84c0           test al, al\n\u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500< 0x0040069c      740f           je 0x4006ad\n\u2502 \u2502\u2502\u2502\u2502\u2502\u2502\u2502   0x0040069e      488b45f8       mov rax, qword [var_8h]\n\u2502 \u2502\u2502\u2502\u2502\u2502\u2502\u2502   0x004006a2      4883c007       add rax, 7\n\u2502 \u2502\u2502\u2502\u2502\u2502\u2502\u2502   0x004006a6      0fb600         movzx eax, byte [rax]\n\u2502 \u2502\u2502\u2502\u2502\u2502\u2502\u2502   0x004006a9      3c64           cmp al, 0x64                ; 100\n\u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500< 0x004006ab      7407           je 0x4006b4\n\u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500> 0x004006ad      b8ffffffff     mov eax, 0xffffffff         ; -1\n\u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500< 0x004006b2      eb1b           jmp 0x4006cf\n\u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500> 0x004006b4      488b45f8       mov rax, qword [var_8h]\n\u2502 \u2502\u2502\u2502\u2502\u2502\u2502\u2502   0x004006b8      4883c008       add rax, 8\n\u2502 \u2502\u2502\u2502\u2502\u2502\u2502\u2502   0x004006bc      0fb600         movzx eax, byte [rax]\n\u2502 \u2502\u2502\u2502\u2502\u2502\u2502\u2502   0x004006bf      84c0           test al, al\n\u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500< 0x004006c1      7407           je 0x4006ca\n\u2502 \u2502\u2502\u2502\u2502\u2502\u2502\u2502   0x004006c3      b8ffffffff     mov eax, 0xffffffff         ; -1\n\u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500< 0x004006c8      eb05           jmp 0x4006cf\n\u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500> 0x004006ca      b800000000     mov eax, 0\n\u2502 \u2502\u2502\u2502\u2502\u2502\u2502\u2502   ; XREFS: CODE 0x004005a0  CODE 0x004005c8  CODE 0x004005f0  CODE 0x00400618  CODE 0x00400640  CODE 0x00400668\n\u2502 \u2502\u2502\u2502\u2502\u2502\u2502\u2502   ; XREFS: CODE 0x0040068d  CODE 0x004006b2  CODE 0x004006c8\n\u2502 \u2514\u2514\u2514\u2514\u2514\u2514\u2514\u2500> 0x004006cf      5d             pop rbp\n\u2514           0x004006d0      c3             ret\n')),(0,t.kt)("ol",null,(0,t.kt)("li",{parentName:"ol"},"What is the password ?")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-py"},"0x31\n0x33\n0x33\n0x37\n0x5f\n0x70\n0x77\n0x64\n")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Reversing ELF$ ./crackme6 1337_pwd\npassword OK\n")),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"1337_pwd")),(0,t.kt)("h2",{id:"task-7-crackme7"},"Task 7 Crackme7"),(0,t.kt)("p",null,"Analyze the binary to get the flag"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Reversing ELF$ r2 -d -A crackme7\nProcess with PID 16809 started...\n= attach 16809 16809\nbin.baddr 0x08048000\nUsing 0x8048000\nasm.bits 32\nglibc.fc_offset = 0x00148\nWarning: r_bin_file_hash: file exceeds bin.hashlimit\n[x] Analyze all flags starting with sym. and entry0 (aa)\n[x] Analyze function calls (aac)\n[x] Analyze len bytes of instructions for references (aar)\n[x] Check for objc references\n[x] Check for vtables\n[TOFIX: aaft can\'t run in debugger mode.ions (aaft)\n[x] Type matching analysis for all functions (aaft)\n[x] Propagate noreturn information\n[x] Use -AA or aaaa to perform additional experimental analysis.\n[0xf7ee50b0]> pdf @main\n            ; DATA XREF from entry0 @ 0x80483d7\n\u250c 491: int main (int argc, char **argv, char **envp);\n\u2502           ; var int32_t var_78h @ ebp-0x78\n\u2502           ; var int32_t var_14h @ ebp-0x14\n\u2502           ; var int32_t var_10h @ ebp-0x10\n\u2502           ; var int32_t var_ch @ ebp-0xc\n\u2502           ; var int32_t var_8h @ ebp-0x8\n\u2502           ; arg int32_t arg_4h @ esp+0x94\n\u2502           0x080484bb      8d4c2404       lea ecx, dword [arg_4h]\n\u2502           0x080484bf      83e4f0         and esp, 0xfffffff0\n\u2502           0x080484c2      ff71fc         push dword [ecx - 4]\n\u2502           0x080484c5      55             push ebp\n\u2502           0x080484c6      89e5           mov ebp, esp\n\u2502           0x080484c8      57             push edi\n\u2502           0x080484c9      51             push ecx\n\u2502           0x080484ca      83ec70         sub esp, 0x70\n\u2502           ; CODE XREFS from main @ 0x8048590, 0x8048643\n\u2502      \u250c\u250c\u2500> 0x080484cd      83ec0c         sub esp, 0xc\n\u2502      \u254e\u254e   0x080484d0      68e0870408     push str.Menu:_____1__Say_hello___2__Add_numbers___3__Quit ; 0x80487e0 ; "Menu:\\n\\n[1] Say hello\\n[2] Add numbers\\n[3] Quit"\n\u2502      \u254e\u254e   0x080484d5      e896feffff     call sym.imp.puts           ; int puts(const char *s)\n\u2502      \u254e\u254e   0x080484da      83c410         add esp, 0x10\n\u2502      \u254e\u254e   0x080484dd      83ec0c         sub esp, 0xc\n\u2502      \u254e\u254e   0x080484e0      680e880408     push str.                   ; 0x804880e ; "\\n[>] "\n\u2502      \u254e\u254e   0x080484e5      e876feffff     call sym.imp.printf         ; int printf(const char *format)\n\u2502      \u254e\u254e   0x080484ea      83c410         add esp, 0x10\n\u2502      \u254e\u254e   0x080484ed      83ec08         sub esp, 8\n\u2502      \u254e\u254e   0x080484f0      8d45f4         lea eax, dword [var_ch]\n\u2502      \u254e\u254e   0x080484f3      50             push eax\n\u2502      \u254e\u254e   0x080484f4      6814880408     push 0x8048814\n\u2502      \u254e\u254e   0x080484f9      e8a2feffff     call sym.imp.__isoc99_scanf ; int scanf(const char *format)\n\u2502      \u254e\u254e   0x080484fe      83c410         add esp, 0x10\n\u2502      \u254e\u254e   0x08048501      83f801         cmp eax, 1                  ; 1\n\u2502     \u250c\u2500\u2500\u2500< 0x08048504      741a           je 0x8048520\n\u2502     \u2502\u254e\u254e   0x08048506      83ec0c         sub esp, 0xc\n\u2502     \u2502\u254e\u254e   0x08048509      6817880408     push str.Unknown_input      ; 0x8048817 ; "Unknown input!"\n\u2502     \u2502\u254e\u254e   0x0804850e      e85dfeffff     call sym.imp.puts           ; int puts(const char *s)\n\u2502     \u2502\u254e\u254e   0x08048513      83c410         add esp, 0x10\n\u2502     \u2502\u254e\u254e   0x08048516      b801000000     mov eax, 1\n\u2502    \u250c\u2500\u2500\u2500\u2500< 0x0804851b      e97c010000     jmp 0x804869c\n\u2502    \u2502\u2514\u2500\u2500\u2500> 0x08048520      8b45f4         mov eax, dword [var_ch]\n\u2502    \u2502 \u254e\u254e   0x08048523      83f801         cmp eax, 1                  ; 1\n\u2502    \u2502\u250c\u2500\u2500\u2500< 0x08048526      756d           jne 0x8048595\n\u2502    \u2502\u2502\u254e\u254e   0x08048528      83ec0c         sub esp, 0xc\n\u2502    \u2502\u2502\u254e\u254e   0x0804852b      6826880408     push str.What_is_your_name  ; 0x8048826 ; "What is your name? "\n\u2502    \u2502\u2502\u254e\u254e   0x08048530      e82bfeffff     call sym.imp.printf         ; int printf(const char *format)\n\u2502    \u2502\u2502\u254e\u254e   0x08048535      83c410         add esp, 0x10\n\u2502    \u2502\u2502\u254e\u254e   0x08048538      8d5588         lea edx, dword [var_78h]\n\u2502    \u2502\u2502\u254e\u254e   0x0804853b      b800000000     mov eax, 0\n\u2502    \u2502\u2502\u254e\u254e   0x08048540      b919000000     mov ecx, 0x19               ; 25\n\u2502    \u2502\u2502\u254e\u254e   0x08048545      89d7           mov edi, edx\n\u2502    \u2502\u2502\u254e\u254e   0x08048547      f3ab           rep stosd dword es:[edi], eax\n\u2502    \u2502\u2502\u254e\u254e   0x08048549      83ec08         sub esp, 8\n\u2502    \u2502\u2502\u254e\u254e   0x0804854c      8d4588         lea eax, dword [var_78h]\n\u2502    \u2502\u2502\u254e\u254e   0x0804854f      50             push eax\n\u2502    \u2502\u2502\u254e\u254e   0x08048550      683a880408     push str.99s                ; 0x804883a ; "%99s"\n\u2502    \u2502\u2502\u254e\u254e   0x08048555      e846feffff     call sym.imp.__isoc99_scanf ; int scanf(const char *format)\n\u2502    \u2502\u2502\u254e\u254e   0x0804855a      83c410         add esp, 0x10\n\u2502    \u2502\u2502\u254e\u254e   0x0804855d      83f801         cmp eax, 1                  ; 1\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500< 0x08048560      741a           je 0x804857c\n\u2502   \u2502\u2502\u2502\u254e\u254e   0x08048562      83ec0c         sub esp, 0xc\n\u2502   \u2502\u2502\u2502\u254e\u254e   0x08048565      683f880408     push str.Unable_to_read_name ; 0x804883f ; "Unable to read name!"\n\u2502   \u2502\u2502\u2502\u254e\u254e   0x0804856a      e801feffff     call sym.imp.puts           ; int puts(const char *s)\n\u2502   \u2502\u2502\u2502\u254e\u254e   0x0804856f      83c410         add esp, 0x10\n\u2502   \u2502\u2502\u2502\u254e\u254e   0x08048572      b801000000     mov eax, 1\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500< 0x08048577      e920010000     jmp 0x804869c\n\u2502  \u2502\u2514\u2500\u2500\u2500\u2500\u2500> 0x0804857c      83ec08         sub esp, 8\n\u2502  \u2502 \u2502\u2502\u254e\u254e   0x0804857f      8d4588         lea eax, dword [var_78h]\n\u2502  \u2502 \u2502\u2502\u254e\u254e   0x08048582      50             push eax\n\u2502  \u2502 \u2502\u2502\u254e\u254e   0x08048583      6854880408     push str.Hello___s          ; 0x8048854 ; "Hello, %s!\\n"\n\u2502  \u2502 \u2502\u2502\u254e\u254e   0x08048588      e8d3fdffff     call sym.imp.printf         ; int printf(const char *format)\n\u2502  \u2502 \u2502\u2502\u254e\u254e   0x0804858d      83c410         add esp, 0x10\n\u2502  \u2502 \u2502\u2502\u2514\u2500\u2500< 0x08048590      e938ffffff     jmp 0x80484cd\n\u2502  \u2502 \u2502\u2514\u2500\u2500\u2500> 0x08048595      8b45f4         mov eax, dword [var_ch]\n\u2502  \u2502 \u2502  \u254e   0x08048598      83f802         cmp eax, 2                  ; 2\n\u2502  \u2502 \u2502 \u250c\u2500\u2500< 0x0804859b      0f85a7000000   jne 0x8048648\n\u2502  \u2502 \u2502 \u2502\u254e   0x080485a1      83ec0c         sub esp, 0xc\n\u2502  \u2502 \u2502 \u2502\u254e   0x080485a4      6860880408     push str.Enter_first_number: ; 0x8048860 ; "Enter first number: "\n\u2502  \u2502 \u2502 \u2502\u254e   0x080485a9      e8b2fdffff     call sym.imp.printf         ; int printf(const char *format)\n\u2502  \u2502 \u2502 \u2502\u254e   0x080485ae      83c410         add esp, 0x10\n\u2502  \u2502 \u2502 \u2502\u254e   0x080485b1      83ec08         sub esp, 8\n\u2502  \u2502 \u2502 \u2502\u254e   0x080485b4      8d45f0         lea eax, dword [var_10h]\n\u2502  \u2502 \u2502 \u2502\u254e   0x080485b7      50             push eax\n\u2502  \u2502 \u2502 \u2502\u254e   0x080485b8      6875880408     push 0x8048875\n\u2502  \u2502 \u2502 \u2502\u254e   0x080485bd      e8defdffff     call sym.imp.__isoc99_scanf ; int scanf(const char *format)\n\u2502  \u2502 \u2502 \u2502\u254e   0x080485c2      83c410         add esp, 0x10\n\u2502  \u2502 \u2502 \u2502\u254e   0x080485c5      83f801         cmp eax, 1                  ; 1\n\u2502  \u2502 \u2502\u250c\u2500\u2500\u2500< 0x080485c8      741a           je 0x80485e4\n\u2502  \u2502 \u2502\u2502\u2502\u254e   0x080485ca      83ec0c         sub esp, 0xc\n\u2502  \u2502 \u2502\u2502\u2502\u254e   0x080485cd      6878880408     push str.Unable_to_read_number ; 0x8048878 ; "Unable to read number!"\n\u2502  \u2502 \u2502\u2502\u2502\u254e   0x080485d2      e899fdffff     call sym.imp.puts           ; int puts(const char *s)\n\u2502  \u2502 \u2502\u2502\u2502\u254e   0x080485d7      83c410         add esp, 0x10\n\u2502  \u2502 \u2502\u2502\u2502\u254e   0x080485da      b801000000     mov eax, 1\n\u2502  \u2502\u250c\u2500\u2500\u2500\u2500\u2500< 0x080485df      e9b8000000     jmp 0x804869c\n\u2502  \u2502\u2502\u2502\u2514\u2500\u2500\u2500> 0x080485e4      83ec0c         sub esp, 0xc\n\u2502  \u2502\u2502\u2502 \u2502\u254e   0x080485e7      688f880408     push str.Enter_second_number: ; 0x804888f ; "Enter second number: "\n\u2502  \u2502\u2502\u2502 \u2502\u254e   0x080485ec      e86ffdffff     call sym.imp.printf         ; int printf(const char *format)\n\u2502  \u2502\u2502\u2502 \u2502\u254e   0x080485f1      83c410         add esp, 0x10\n\u2502  \u2502\u2502\u2502 \u2502\u254e   0x080485f4      83ec08         sub esp, 8\n\u2502  \u2502\u2502\u2502 \u2502\u254e   0x080485f7      8d45ec         lea eax, dword [var_14h]\n\u2502  \u2502\u2502\u2502 \u2502\u254e   0x080485fa      50             push eax\n\u2502  \u2502\u2502\u2502 \u2502\u254e   0x080485fb      6875880408     push 0x8048875\n\u2502  \u2502\u2502\u2502 \u2502\u254e   0x08048600      e89bfdffff     call sym.imp.__isoc99_scanf ; int scanf(const char *format)\n\u2502  \u2502\u2502\u2502 \u2502\u254e   0x08048605      83c410         add esp, 0x10\n\u2502  \u2502\u2502\u2502 \u2502\u254e   0x08048608      83f801         cmp eax, 1                  ; 1\n\u2502  \u2502\u2502\u2502\u250c\u2500\u2500\u2500< 0x0804860b      7417           je 0x8048624\n\u2502  \u2502\u2502\u2502\u2502\u2502\u254e   0x0804860d      83ec0c         sub esp, 0xc\n\u2502  \u2502\u2502\u2502\u2502\u2502\u254e   0x08048610      6878880408     push str.Unable_to_read_number ; 0x8048878 ; "Unable to read number!"\n\u2502  \u2502\u2502\u2502\u2502\u2502\u254e   0x08048615      e856fdffff     call sym.imp.puts           ; int puts(const char *s)\n\u2502  \u2502\u2502\u2502\u2502\u2502\u254e   0x0804861a      83c410         add esp, 0x10\n\u2502  \u2502\u2502\u2502\u2502\u2502\u254e   0x0804861d      b801000000     mov eax, 1\n\u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500< 0x08048622      eb78           jmp 0x804869c\n\u2502 \u2502\u2502\u2502\u2502\u2514\u2500\u2500\u2500> 0x08048624      8b55f0         mov edx, dword [var_10h]\n\u2502 \u2502\u2502\u2502\u2502 \u2502\u254e   0x08048627      8b45ec         mov eax, dword [var_14h]\n\u2502 \u2502\u2502\u2502\u2502 \u2502\u254e   0x0804862a      8d0c02         lea ecx, dword [edx + eax]\n\u2502 \u2502\u2502\u2502\u2502 \u2502\u254e   0x0804862d      8b55ec         mov edx, dword [var_14h]\n\u2502 \u2502\u2502\u2502\u2502 \u2502\u254e   0x08048630      8b45f0         mov eax, dword [var_10h]\n\u2502 \u2502\u2502\u2502\u2502 \u2502\u254e   0x08048633      51             push ecx\n\u2502 \u2502\u2502\u2502\u2502 \u2502\u254e   0x08048634      52             push edx\n\u2502 \u2502\u2502\u2502\u2502 \u2502\u254e   0x08048635      50             push eax\n\u2502 \u2502\u2502\u2502\u2502 \u2502\u254e   0x08048636      68a5880408     push str.d____d____d        ; 0x80488a5 ; "%d + %d = %d\\n"\n\u2502 \u2502\u2502\u2502\u2502 \u2502\u254e   0x0804863b      e820fdffff     call sym.imp.printf         ; int printf(const char *format)\n\u2502 \u2502\u2502\u2502\u2502 \u2502\u254e   0x08048640      83c410         add esp, 0x10\n\u2502 \u2502\u2502\u2502\u2502 \u2502\u2514\u2500< 0x08048643      e985feffff     jmp 0x80484cd\n\u2502 \u2502\u2502\u2502\u2502 \u2514\u2500\u2500> 0x08048648      8b45f4         mov eax, dword [var_ch]\n\u2502 \u2502\u2502\u2502\u2502      0x0804864b      83f803         cmp eax, 3                  ; 3\n\u2502 \u2502\u2502\u2502\u2502  \u250c\u2500< 0x0804864e      7512           jne 0x8048662\n\u2502 \u2502\u2502\u2502\u2502  \u2502   0x08048650      83ec0c         sub esp, 0xc\n\u2502 \u2502\u2502\u2502\u2502  \u2502   0x08048653      68b3880408     push str.Goodbye            ; 0x80488b3 ; "Goodbye!"\n\u2502 \u2502\u2502\u2502\u2502  \u2502   0x08048658      e813fdffff     call sym.imp.puts           ; int puts(const char *s)\n\u2502 \u2502\u2502\u2502\u2502  \u2502   0x0804865d      83c410         add esp, 0x10\n\u2502 \u2502\u2502\u2502\u2502 \u250c\u2500\u2500< 0x08048660      eb35           jmp 0x8048697\n\u2502 \u2502\u2502\u2502\u2502 \u2502\u2514\u2500> 0x08048662      8b45f4         mov eax, dword [var_ch]\n\u2502 \u2502\u2502\u2502\u2502 \u2502    0x08048665      3d697a0000     cmp eax, 0x7a69\n\u2502 \u2502\u2502\u2502\u2502 \u2502\u250c\u2500< 0x0804866a      7517           jne 0x8048683\n\u2502 \u2502\u2502\u2502\u2502 \u2502\u2502   0x0804866c      83ec0c         sub esp, 0xc\n\u2502 \u2502\u2502\u2502\u2502 \u2502\u2502   0x0804866f      68bc880408     push str.Wow_such_h4x0r     ; 0x80488bc ; "Wow such h4x0r!"\n\u2502 \u2502\u2502\u2502\u2502 \u2502\u2502   0x08048674      e8f7fcffff     call sym.imp.puts           ; int puts(const char *s)\n\u2502 \u2502\u2502\u2502\u2502 \u2502\u2502   0x08048679      83c410         add esp, 0x10\n\u2502 \u2502\u2502\u2502\u2502 \u2502\u2502   0x0804867c      e825000000     call sym.giveFlag\n\u2502 \u2502\u2502\u2502\u2502\u250c\u2500\u2500\u2500< 0x08048681      eb14           jmp 0x8048697\n\u2502 \u2502\u2502\u2502\u2502\u2502\u2502\u2514\u2500> 0x08048683      8b45f4         mov eax, dword [var_ch]\n\u2502 \u2502\u2502\u2502\u2502\u2502\u2502    0x08048686      83ec08         sub esp, 8\n\u2502 \u2502\u2502\u2502\u2502\u2502\u2502    0x08048689      50             push eax\n\u2502 \u2502\u2502\u2502\u2502\u2502\u2502    0x0804868a      68cc880408     push str.Unknown_choice:__d ; 0x80488cc ; "Unknown choice: %d\\n"\n\u2502 \u2502\u2502\u2502\u2502\u2502\u2502    0x0804868f      e8ccfcffff     call sym.imp.printf         ; int printf(const char *format)\n\u2502 \u2502\u2502\u2502\u2502\u2502\u2502    0x08048694      83c410         add esp, 0x10\n\u2502 \u2502\u2502\u2502\u2502\u2502\u2502    ; CODE XREFS from main @ 0x8048660, 0x8048681\n\u2502 \u2502\u2502\u2502\u2502\u2514\u2514\u2500\u2500> 0x08048697      b800000000     mov eax, 0\n\u2502 \u2502\u2502\u2502\u2502      ; CODE XREFS from main @ 0x804851b, 0x8048577, 0x80485df, 0x8048622\n\u2502 \u2514\u2514\u2514\u2514\u2500\u2500\u2500\u2500> 0x0804869c      8d65f8         lea esp, dword [var_8h]\n\u2502           0x0804869f      59             pop ecx\n\u2502           0x080486a0      5f             pop edi\n\u2502           0x080486a1      5d             pop ebp\n\u2502           0x080486a2      8d61fc         lea esp, dword [ecx - 4]\n\u2514           0x080486a5      c3             ret\n')),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},'\u2502 \u2502\u2502\u2502\u2502 \u2502    0x08048665      3d697a0000     cmp eax, 0x7a69\n\u2502 \u2502\u2502\u2502\u2502 \u2502\u250c\u2500< 0x0804866a      7517           jne 0x8048683\n\u2502 \u2502\u2502\u2502\u2502 \u2502\u2502   0x0804866c      83ec0c         sub esp, 0xc\n\u2502 \u2502\u2502\u2502\u2502 \u2502\u2502   0x0804866f      68bc880408     push str.Wow_such_h4x0r     ; 0x80488bc ; "Wow such h4x0r!"\n')),(0,t.kt)("ol",null,(0,t.kt)("li",{parentName:"ol"},"What is the flag ?")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Reversing ELF$ python3\nPython 3.8.2 (default, Apr  1 2020, 15:52:55)\n[GCC 9.3.0] on linux\nType "help", "copyright", "credits" or "license" for more information.\n>>> bytes.fromhex(\'7a69\').decode(\'utf-8\')\n>>> print(int(\'7a69\', 16))\n31337\n>>>\n')),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Reversing ELF$ ./crackme7\nMenu:\n\n[1] Say hello\n[2] Add numbers\n[3] Quit\n\n[>] zi\nUnknown input!\nkali@kali:~/CTFs/tryhackme/Reversing ELF$ ./crackme7\nMenu:\n\n[1] Say hello\n[2] Add numbers\n[3] Quit\n\n[>] 31337\nWow such h4x0r!\nflag{much_reversing_very_ida_wow}\n")),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"flag{much_reversing_very_ida_wow}")),(0,t.kt)("h2",{id:"task-8-crackme8"},"Task 8 Crackme8"),(0,t.kt)("p",null,"Analyze the binary and obtain the flag"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},'[0xf7ef50b0]> pdf @main\n            ; DATA XREF from entry0 @ 0x80483b7\n\u250c 137: int main (int argc, char **argv, char **envp);\n\u2502           ; var int32_t var_4h @ ebp-0x4\n\u2502           ; arg int32_t arg_4h @ esp+0x24\n\u2502           0x0804849b      8d4c2404       lea ecx, dword [arg_4h]\n\u2502           0x0804849f      83e4f0         and esp, 0xfffffff0\n\u2502           0x080484a2      ff71fc         push dword [ecx - 4]\n\u2502           0x080484a5      55             push ebp\n\u2502           0x080484a6      89e5           mov ebp, esp\n\u2502           0x080484a8      51             push ecx\n\u2502           0x080484a9      83ec04         sub esp, 4\n\u2502           0x080484ac      89c8           mov eax, ecx\n\u2502           0x080484ae      833802         cmp dword [eax], 2\n\u2502       \u250c\u2500< 0x080484b1      741d           je 0x80484d0\n\u2502       \u2502   0x080484b3      8b4004         mov eax, dword [eax + 4]\n\u2502       \u2502   0x080484b6      8b00           mov eax, dword [eax]\n\u2502       \u2502   0x080484b8      83ec08         sub esp, 8\n\u2502       \u2502   0x080484bb      50             push eax\n\u2502       \u2502   0x080484bc      6860860408     push str.Usage:__s_password ; 0x8048660 ; "Usage: %s password\\n"\n\u2502       \u2502   0x080484c1      e87afeffff     call sym.imp.printf         ; int printf(const char *format)\n\u2502       \u2502   0x080484c6      83c410         add esp, 0x10\n\u2502       \u2502   0x080484c9      b801000000     mov eax, 1\n\u2502      \u250c\u2500\u2500< 0x080484ce      eb4c           jmp 0x804851c\n\u2502      \u2502\u2514\u2500> 0x080484d0      8b4004         mov eax, dword [eax + 4]\n\u2502      \u2502    0x080484d3      83c004         add eax, 4\n\u2502      \u2502    0x080484d6      8b00           mov eax, dword [eax]\n\u2502      \u2502    0x080484d8      83ec0c         sub esp, 0xc\n\u2502      \u2502    0x080484db      50             push eax\n\u2502      \u2502    0x080484dc      e89ffeffff     call sym.imp.atoi           ; int atoi(const char *str)\n\u2502      \u2502    0x080484e1      83c410         add esp, 0x10\n\u2502      \u2502    0x080484e4      3d0df0feca     cmp eax, 0xcafef00d\n\u2502      \u2502\u250c\u2500< 0x080484e9      7417           je 0x8048502\n\u2502      \u2502\u2502   0x080484eb      83ec0c         sub esp, 0xc\n\u2502      \u2502\u2502   0x080484ee      6874860408     push str.Access_denied.     ; 0x8048674 ; "Access denied."\n\u2502      \u2502\u2502   0x080484f3      e858feffff     call sym.imp.puts           ; int puts(const char *s)\n\u2502      \u2502\u2502   0x080484f8      83c410         add esp, 0x10\n\u2502      \u2502\u2502   0x080484fb      b801000000     mov eax, 1\n\u2502     \u250c\u2500\u2500\u2500< 0x08048500      eb1a           jmp 0x804851c\n\u2502     \u2502\u2502\u2514\u2500> 0x08048502      83ec0c         sub esp, 0xc\n\u2502     \u2502\u2502    0x08048505      6883860408     push str.Access_granted.    ; 0x8048683 ; "Access granted."\n\u2502     \u2502\u2502    0x0804850a      e841feffff     call sym.imp.puts           ; int puts(const char *s)\n\u2502     \u2502\u2502    0x0804850f      83c410         add esp, 0x10\n\u2502     \u2502\u2502    0x08048512      e80d000000     call sym.giveFlag\n\u2502     \u2502\u2502    0x08048517      b800000000     mov eax, 0\n\u2502     \u2502\u2502    ; CODE XREFS from main @ 0x80484ce, 0x8048500\n\u2502     \u2514\u2514\u2500\u2500> 0x0804851c      8b4dfc         mov ecx, dword [var_4h]\n\u2502           0x0804851f      c9             leave\n\u2502           0x08048520      8d61fc         lea esp, dword [ecx - 4]\n\u2514           0x08048523      c3             ret\n')),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"\u2502      \u2502    0x080484dc      e89ffeffff     call sym.imp.atoi           ; int atoi(const char *str)\n\u2502      \u2502    0x080484e1      83c410         add esp, 0x10\n\u2502      \u2502    0x080484e4      3d0df0feca     cmp eax, 0xcafef00d\n")),(0,t.kt)("ol",null,(0,t.kt)("li",{parentName:"ol"},"What is the flag ?")),(0,t.kt)("p",null,(0,t.kt)("a",{parentName:"p",href:"https://www.rapidtables.com/convert/number/hex-to-decimal.html"},"https://www.rapidtables.com/convert/number/hex-to-decimal.html")),(0,t.kt)("p",null,(0,t.kt)("img",{src:a(92871).Z,width:"487",height:"791"})),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Reversing ELF$ ./crackme8 -889262067\nAccess granted.\nflag{at_least_this_cafe_wont_leak_your_credit_card_numbers}\n")),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"flag{at_least_this_cafe_wont_leak_your_credit_card_numbers}")))}m.isMDXComponent=!0},92871:(n,e,a)=>{a.d(e,{Z:()=>r});const r=a.p+"assets/images/2020-10-18_21-40-a01e1fbbeb4f60053cfebf91bfb38831.png"}}]);